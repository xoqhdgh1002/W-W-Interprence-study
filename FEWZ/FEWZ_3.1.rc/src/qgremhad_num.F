CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCC Numerator functions CCCCCCCCCCCCCCCCCCCCCCCCCC

      double precision function qgrmnum1e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = t1**2
      t3 = t2*t1
      t4 = l3-1
      t5 = t4**2
      t6 = t3*t5
      t7 = 1/s3vr
      t8 = t7*s3l2p
      t10 = s4l2p*t7
      t13 = 512.D0/3.D0*t6*t8+512.D0/3.D0*t6*t10
      t14 = s1vr**2
      t18 = t5*t4
      t19 = t3*t18
      t20 = t7*s34r
      t21 = t20*s2l2
      t23 = 512.D0/3.D0*t19*t21
      t24 = t2**2
      t25 = t18*t24
      t28 = -t25*t8-t25*t10
      t38 = t5**2
      t39 = t24*t38
      t40 = s34r**2
      t41 = t7*t40
      t42 = t41*s2l2
      t45 = t24*t1
      t46 = t45*t38
      t54 = t7*s3l1p
      t56 = s4l1p*t7
      t59 = 512.D0/3.D0*t6*t54+512.D0/3.D0*t6*t56
      t63 = t20*s2l1
      t65 = 512.D0/3.D0*t19*t63
      t68 = -t25*t54-t25*t56
      t88 = z*l3
      t89 = t88*t3
      t90 = t5*t7
      t91 = t14*s1vr
      t98 = z*t18
      t99 = t98*t24
      t100 = l3*t7
      t101 = t100*s34r
      t110 = t38*t7
      t117 = s13r**2
      t119 = l3*t2
      t120 = t4*t7
      t124 = t4*t2
      t127 = l3*t3
      t129 = t127*t90*s34r
      t133 = s23r**2
      t137 = t127*t5
      t141 = t100*t40
      t143 = 1024.D0/3.D0*t25*t141
      t148 = t100*s2l2
      t149 = t124*t148
      t150 = t4*t3
      t151 = t100*s3l2p
      t152 = t150*t151
      t153 = l3*s4l2p
      t154 = t153*t7
      t155 = t150*t154
      t159 = t124*l3
      t160 = t7*s2l2
      t165 = z*t1
      t166 = t165*t120
      t168 = -1024.D0/3.D0*t129+512.D0/3.D0*t166
      t170 = t5*t24
      t173 = t170*t151+t170*t154
      t174 = 512.D0/3.D0*t173
      t176 = 3*z
      t177 = -1+t176
      t178 = t177*t2
      t179 = t120*s3l2p
      t183 = t4*s4l2p*t7
      t193 = 512.D0/3.D0*t129-1024.D0/3.D0*t166
      t197 = 4*z
      t198 = -1+t197
      t199 = t198*t2
      t206 = t198*t5
      t207 = t206*t2
      t210 = t18*t45
      t213 = t210*t151+t210*t154
      t216 = 6*z
      t218 = (t216-2)*t3
      t219 = t90*s3l2p
      t222 = t177*t3
      t223 = t5*s4l2p
      t224 = t223*t7
      t232 = 512.D0/3.D0*t129+512.D0/3.D0*t166
      t236 = z*t2
      t243 = t2*t7
      t247 = t143+512.D0/3.D0*t206*t243*s34r
      t252 = t198*t3
      t260 = l3*t45
      t261 = t40*s34r
      t262 = t110*t261
      t264 = t18*t7
      t268 = 512.D0/3.D0*t260*t262+512.D0/3.D0*t222*t264*t40
      t270 = t24*t2
      t271 = t38*t270
      t277 = t177*t24
      t288 = t100*s2l1
      t289 = t124*t288
      t290 = t100*s3l1p
      t291 = t150*t290
      t293 = l3*s4l1p*t7
      t294 = t150*t293
      t298 = t7*s2l1
      t305 = t170*t290+t170*t293
      t306 = 512.D0/3.D0*t305
      t308 = t120*s3l1p
      t312 = t4*s4l1p*t7
      t333 = t210*t290+t210*t293
      t336 = t90*s3l1p
      t339 = t5*s4l1p
      t340 = t339*t7
      t383 = t4*z
      t384 = t383*t3
      t385 = l3**2
      t386 = t385*t7
      t390 = z*t5
      t391 = t390*t24
      t392 = t386*s34r
      t393 = t391*t392
      t395 = t4*t24
      t396 = t395*t151
      t399 = 512.D0/3.D0*t395*t154
      t400 = 1024.D0/3.D0*t396+t399
      t404 = t56*s3l2p
      t406 = 512.D0/3.D0*l3*t4*t24*t404
      t407 = z**2
      t408 = t407*t4
      t426 = t170*l3
      t427 = t10*s34r
      t430 = -t1
      t431 = t430*t2
      t434 = 1024.D0/3.D0*t137*t21-512.D0/3.D0*t426*t427+512.D0/3.D0*t43
     #1*t183
      t436 = t56*s34r
      t440 = -512.D0/3.D0*t426*t436+512.D0/3.D0*t431*t312
      t442 = t98*t45
      t443 = t386*t40
      t445 = 1024.D0/3.D0*t442*t443
      t446 = t5*t45
      t447 = t446*t151
      t449 = t260*t224
      t454 = t446*l3*t404
      t456 = 2*z
      t457 = -1+t456
      t464 = t10*s3l1p
      t466 = 512.D0/3.D0*t150*t464
      t468 = 512.D0/3.D0*t150*t404
      t470 = s4l2p*s4l1p*t7
      t472 = 1024.D0/3.D0*t150*t470
      t498 = t210*l3
      t502 = t430*t3
      t503 = t502*t5
      t518 = t18*t270
      t521 = l3*t18
      t523 = t270*s4l2p*t7
      t549 = t385*t2
      t552 = t150*t392
      t553 = t165*t100
      t564 = t385*t24
      t565 = t90*t40
      t566 = t564*t565
      t568 = t383*t2
      t570 = 2048.D0/3.D0*t568*t101
      t573 = t133*s23r
      t584 = t386*t261
      t586 = 1024.D0/3.D0*t210*t584
      t593 = t549*t160
      t594 = t3*t385
      t595 = t594*t8
      t596 = t594*t10
      t601 = -512.D0/3.D0*t552-512.D0/3.D0*t553
      t603 = t386*s3l2p
      t604 = t395*t603
      t606 = t385*t4
      t609 = t606*t24*s4l2p*t7
      t612 = (1024.D0/3.D0*t604+512.D0/3.D0*t609)*s34r
      t617 = t119*z*s4l2p*t7
      t627 = 512.D0/3.D0*t553
      t628 = 2560.D0/3.D0*t552+t627
      t634 = t127*t8
      t641 = t407*t7
      t643 = 512*t566+512.D0/3.D0*t124*t101-512.D0/3.D0*t641
      t651 = -2048.D0/3.D0*t446*t603-1024.D0/3.D0*t446*t385*s4l2p*t7
      t654 = (-3+t456)*t4
      t655 = t654*t3
      t660 = t457*z
      t661 = t1*t7
      t662 = t661*s3l2p
      t666 = t1*s4l2p*t7
      t675 = -2048.D0/3.D0*t552+t627
      t677 = z*t7
      t679 = t119*t677*s3l2p
      t685 = t457*t4
      t690 = -2560.D0/3.D0*t566+1024.D0/3.D0*t685*t2*t101+1024.D0/3.D0*t
     #641
      t696 = (-3+t216)*t4*t3
      t699 = -2+5*z
      t701 = t699*t4*t3
      t706 = t177*z
      t713 = t176-2
      t718 = t706*t4
      t720 = t718*t661*s34r
      t722 = -t586+512.D0/3.D0*t713*t5*t3*t141+512.D0/3.D0*t720
      t726 = t385*t18
      t733 = (-3+t197)*t5*t24
      t737 = -t713*t5*t24
      t744 = (-2+t197)*t4*z
      t745 = t243*s3l2p
      t748 = t685*z
      t750 = t2*s4l2p*t7
      t764 = -512.D0/3.D0*t199*t4*t101-512.D0/3.D0*t641
      t766 = t150*l3
      t767 = -t198
      t768 = t767*t7
      t777 = t407*t1
      t784 = t699*t5
      t788 = -512.D0/3.D0*t784*t3*t141-512.D0/3.D0*t720
      t790 = t784*t24
      t803 = t457*t18
      t812 = -512.D0/3.D0*t803*t24*t100*t261-512.D0/3.D0*t457*t5*z*t243*
     #t40
      t814 = t803*t45
      t820 = t660*t3
      t828 = t549*t298
      t829 = t594*t54
      t830 = t594*t56
      t835 = t386*s3l1p
      t836 = t395*t835
      t840 = t606*t24*s4l1p*t7
      t843 = (1024.D0/3.D0*t836+512.D0/3.D0*t840)*s34r
      t848 = t119*z*s4l1p*t7
      t873 = -2048.D0/3.D0*t446*t835-1024.D0/3.D0*t446*t385*s4l1p*t7
      t879 = t661*s3l1p
      t883 = t1*s4l1p*t7
      t893 = t119*t677*s3l1p
      t928 = t243*s3l1p
      t932 = t2*s4l1p*t7
      t984 = z*t3
      t986 = t385*l3*t7
      t992 = t383*t24*t986*s34r
      t998 = -1024.D0/3.D0*t564*t8-512.D0/3.D0*t564*t10
      t1001 = 512.D0/3.D0*t564*t404
      t1009 = 512.D0/3.D0*t127*t8*s2l1
      t1012 = 512.D0/3.D0*t127*t54*s2l2
      t1018 = 512.D0/3.D0*t127*t10
      t1022 = 512.D0/3.D0*t127*t404
      t1065 = 512.D0/3.D0*(-z+t407)*z*t1*l3*t7
      t1069 = 1024.D0/3.D0*t766*t21
      t1070 = z-2
      t1072 = t1070*t4*t3
      t1078 = 512.D0/3.D0*t236*t10
      t1081 = t395*t290
      t1087 = 512.D0/3.D0*t236*t56
      t1096 = t24*t7*s3l2p
      t1101 = t153*s4l1p
      t1103 = 1024.D0/3.D0*t395*t1101
      t1111 = 512.D0/3.D0*t236*t464
      t1113 = 512.D0/3.D0*t236*t404
      t1115 = 1024.D0/3.D0*t236*t470
      t1130 = -t1070
      t1132 = t1130*t4*t3
      t1151 = t1130*l3
      t1169 = t1151*t24
      s2 = ((t13*t14+(-t13*s23r+t23+1024.D0/3.D0*t28*s34r)*s1vr+(-t23-51
     #2.D0/3.D0*t28*s34r)*s23r-512.D0/3.D0*t39*t42+(512.D0/3.D0*t46*t8+5
     #12.D0/3.D0*t46*t10)*t40)*s1l1+(t59*t14+(-t59*s23r+t65+1024.D0/3.D0
     #*t68*s34r)*s1vr+(-t65-512.D0/3.D0*t68*s34r)*s23r-512.D0/3.D0*t39*t
     #41*s2l1+(512.D0/3.D0*t46*t54+512.D0/3.D0*t46*t56)*t40)*s1l2+512.D0
     #/3.D0*t89*t90*t91+(-512.D0/3.D0*t89*t90*s23r-1024.D0/3.D0*t99*t101
     #)*t14+(512.D0/3.D0*t99*t100*s34r*s23r+512.D0/3.D0*t88*t45*t110*t40
     #)*s1vr)*t117
      s9 = (1024.D0/3.D0*t119*t120*t91+(-2048.D0/3.D0*t124*t100*s23r-204
     #8.D0/3.D0*t129)*t14+(1024.D0/3.D0*t119*t120*t133+2048.D0/3.D0*t137
     #*t20*s23r+t143)*s1vr)*s1l2+(512.D0/3.D0*t149-512.D0/3.D0*t152-512.
     #D0/3.D0*t155)*t91+(-1024.D0/3.D0*t159*t160*s23r+t168*s2l2+t174*s34
     #r-512.D0/3.D0*t178*t179-512.D0/3.D0*t178*t183)*t14+((512.D0/3.D0*t
     #149+512.D0/3.D0*t152+512.D0/3.D0*t155)*t133+(t193*s2l2+1024.D0/3.D
     #0*t173*s34r+512.D0/3.D0*t199*t179+512.D0/3.D0*t199*t183)*s23r-512.
     #D0/3.D0*t207*t21+512.D0/3.D0*t213*t40+(512.D0/3.D0*t218*t219+1024.
     #D0/3.D0*t222*t224)*s34r)*s1vr
      s8 = s9+(t232*s2l2-t174*s34r-512.D0/3.D0*t236*t179-512.D0/3.D0*t23
     #6*t183)*t133+(t247*s2l2-1024.D0/3.D0*t213*t40+(-512.D0/3.D0*t252*t
     #219-512.D0/3.D0*t252*t224)*s34r)*s23r+t268*s2l2+(-512.D0/3.D0*t271
     #*t151-512.D0/3.D0*t271*t154)*t261+(-512.D0/3.D0*t277*t264*s3l2p-51
     #2.D0/3.D0*t277*t18*s4l2p*t7)*t40
      s9 = s1l1
      s7 = s8*s9
      s8 = ((512.D0/3.D0*t289-512.D0/3.D0*t291-512.D0/3.D0*t294)*t91+(-1
     #024.D0/3.D0*t159*t298*s23r+t168*s2l1+t306*s34r-512.D0/3.D0*t178*t3
     #08-512.D0/3.D0*t178*t312)*t14+((512.D0/3.D0*t289+512.D0/3.D0*t291+
     #512.D0/3.D0*t294)*t133+(t193*s2l1+1024.D0/3.D0*t305*s34r+512.D0/3.
     #D0*t199*t308+512.D0/3.D0*t199*t312)*s23r-512.D0/3.D0*t207*t63+512.
     #D0/3.D0*t333*t40+(512.D0/3.D0*t218*t336+1024.D0/3.D0*t222*t340)*s3
     #4r)*s1vr+(t232*s2l1-t306*s34r-512.D0/3.D0*t236*t308-512.D0/3.D0*t2
     #36*t312)*t133+(t247*s2l1-1024.D0/3.D0*t333*t40+(-512.D0/3.D0*t252*
     #t336-512.D0/3.D0*t252*t340)*s34r)*s23r+t268*s2l1+(-512.D0/3.D0*t27
     #1*t290-512.D0/3.D0*t271*t293)*t261+(-512.D0/3.D0*t277*t264*s3l1p-5
     #12.D0/3.D0*t277*t18*s4l1p*t7)*t40)*s1l2
      s6 = s7+s8
      s7 = s6+(-1024.D0/3.D0*t384*t386*s23r+512.D0/3.D0*t393+t400*s3l1p+
     #t406-512.D0/3.D0*t119*t408*t7)*t91
      s5 = s7+(1024.D0/3.D0*t384*t386*t133+(-t400*s3l1p-t406+512.D0/3.D0
     #*t119*t383*t7)*s23r+t434*s2l1+t440*s2l2-t445+((-2048.D0/3.D0*t447-
     #1024.D0/3.D0*t449)*s3l1p-1024.D0/3.D0*t454+512.D0/3.D0*t6*t457*t88
     #*t7)*s34r-t466-t468-t472)*t14+((512.D0/3.D0*t393-512.D0/3.D0*t119*
     #z*t4*t430*t7)*t133+(-t434*s2l1-t440*s2l2+t445+((1024.D0/3.D0*t447+
     #512.D0/3.D0*t449)*s3l1p+512.D0/3.D0*t454)*s34r+t466+t468+t472)*s23
     #r+(-1024.D0/3.D0*t25*l3*t42+512.D0/3.D0*t498*t10*t40-512.D0/3.D0*t
     #503*t427)*s2l1+(512.D0/3.D0*t498*t56*t40-512.D0/3.D0*t503*t436)*s2
     #l2+512.D0/3.D0*z*t385*t270*t262+((1024.D0/3.D0*t518*t151+512.D0/3.
     #D0*t521*t523)*s3l1p+512.D0/3.D0*t521*t270*t404-512.D0/3.D0*t45*z*t
     #521*t7)*t40+(512.D0/3.D0*t170*t464+512.D0/3.D0*t170*t404+1024.D0/3
     #.D0*t170*t470)*s34r)*s1vr
      s6 = s13r
      s4 = s5*s6
      s8 = ((-1024.D0/3.D0*t549*t7*s23r-1024.D0/3.D0*t552-1024.D0/3.D0*t
     #553)*t91+(2048.D0/3.D0*t549*t7*t133+(4096.D0/3.D0*t552+2048.D0/3.D
     #0*t553)*s23r+2048.D0/3.D0*t566+t570)*t14+(-1024.D0/3.D0*t549*t7*t5
     #73+(-1024*t552-1024.D0/3.D0*t553)*t133+(-1024*t566-t570)*s23r-t586
     #-1024.D0/3.D0*t89*t565)*s1vr)*s1l2+((-512.D0/3.D0*t593+512.D0/3.D0
     #*t595+512.D0/3.D0*t596)*s23r+t601*s2l2+t612+512.D0/3.D0*t119*t8+51
     #2.D0/3.D0*t617)*t91
      s7 = s8+((1024.D0/3.D0*t593-512.D0/3.D0*t595-512.D0/3.D0*t596)*t13
     #3+(t628*s2l2+(-2560.D0/3.D0*t604-512*t609)*s34r+512.D0/3.D0*t634)*
     #s23r+t643*s2l2+t651*t40+(512.D0/3.D0*t655*t151-512.D0/3.D0*t155)*s
     #34r+512.D0/3.D0*t660*t662+512.D0/3.D0*t660*t666)*t14+(-512.D0/3.D0
     #*t549*t160*t573+(t675*s2l2+t612-1024.D0/3.D0*t679-1024.D0/3.D0*t61
     #7)*t133+(t690*s2l2-t651*t40+(-512.D0/3.D0*t696*t151-512.D0/3.D0*t7
     #01*t154)*s34r-512.D0/3.D0*t706*t662-512.D0/3.D0*t706*t666)*s23r+t7
     #22*s2l2+(1024.D0/3.D0*t518*t603+512.D0/3.D0*t726*t523)*t261+(-512.
     #D0/3.D0*t733*t151+512.D0/3.D0*t737*t154)*t40+(-512.D0/3.D0*t744*t7
     #45-1024.D0/3.D0*t748*t750)*s34r)*s1vr+(-512.D0/3.D0*t165*t148+512.
     #D0/3.D0*t679+512.D0/3.D0*t617)*t573
      s6 = s7+(t764*s2l2+(-512.D0/3.D0*t766*t768*s3l2p-512.D0/3.D0*t766*
     #t767*s4l2p*t7)*s34r+512.D0/3.D0*t777*t8+512.D0/3.D0*t777*t10)*t133
     #+(t788*s2l2+(512.D0/3.D0*t790*t151+512.D0/3.D0*t790*t154)*t40+(512
     #.D0/3.D0*t718*t745+512.D0/3.D0*t718*t750)*s34r)*s23r+t812*s2l2+(51
     #2.D0/3.D0*t814*t151+512.D0/3.D0*t814*t154)*t261+(512.D0/3.D0*t820*
     #t219+512.D0/3.D0*t820*t224)*t40
      s7 = s1l1
      s5 = s6*s7
      s3 = s4+s5
      s1 = s2+s3
      s3 = s1
      s7 = ((-512.D0/3.D0*t828+512.D0/3.D0*t829+512.D0/3.D0*t830)*s23r+t
     #601*s2l1+t843+512.D0/3.D0*t119*t54+512.D0/3.D0*t848)*t91+((1024.D0
     #/3.D0*t828-512.D0/3.D0*t829-512.D0/3.D0*t830)*t133+(t628*s2l1+(-25
     #60.D0/3.D0*t836-512*t840)*s34r+512.D0/3.D0*t127*t54)*s23r+t643*s2l
     #1+t873*t40+(512.D0/3.D0*t655*t290-512.D0/3.D0*t294)*s34r+512.D0/3.
     #D0*t660*t879+512.D0/3.D0*t660*t883)*t14
      s6 = s7+(-512.D0/3.D0*t549*t298*t573+(t675*s2l1+t843-1024.D0/3.D0*
     #t893-1024.D0/3.D0*t848)*t133+(t690*s2l1-t873*t40+(-512.D0/3.D0*t69
     #6*t290-512.D0/3.D0*t701*t293)*s34r-512.D0/3.D0*t706*t879-512.D0/3.
     #D0*t706*t883)*s23r+t722*s2l1+(1024.D0/3.D0*t726*t270*t7*s3l1p+512.
     #D0/3.D0*t726*t270*s4l1p*t7)*t261+(-512.D0/3.D0*t733*t290+512.D0/3.
     #D0*t737*t293)*t40+(-512.D0/3.D0*t744*t928-1024.D0/3.D0*t748*t932)*
     #s34r)*s1vr+(-512.D0/3.D0*t165*t288+512.D0/3.D0*t893+512.D0/3.D0*t8
     #48)*t573
      s5 = s6+(t764*s2l1+(-512.D0/3.D0*t766*t768*s3l1p-512.D0/3.D0*t766*
     #t767*s4l1p*t7)*s34r+512.D0/3.D0*t777*t54+512.D0/3.D0*t777*t56)*t13
     #3+(t788*s2l1+(512.D0/3.D0*t790*t290+512.D0/3.D0*t790*t293)*t40+(51
     #2.D0/3.D0*t718*t928+512.D0/3.D0*t718*t932)*s34r)*s23r+t812*s2l1+(5
     #12.D0/3.D0*t814*t290+512.D0/3.D0*t814*t293)*t261+(512.D0/3.D0*t820
     #*t336+512.D0/3.D0*t820*t340)*t40
      s6 = s1l2
      s4 = s5*s6
      s2 = s3+s4
      s3 = s2+(512.D0/3.D0*t984*t986*t133+(512.D0/3.D0*t992+t998*s3l1p-t
     #1001+512.D0/3.D0*t407*t2*t386)*s23r-t1009-t1012+(-1024.D0/3.D0*t88
     #*t3*t7*s3l2p-t1018)*s3l1p-t1022)*t91
      s4 = s3
      s6 = (-512.D0/3.D0*t984*t986*t573+(-1024.D0/3.D0*t992-t998*s3l1p+t
     #1001-512.D0/3.D0*t549*t677)*t133+(-512.D0/3.D0*t390*t45*t986*t40+(
     #(1024.D0/3.D0*t385*t45*t179+512.D0/3.D0*t606*t45*s4l2p*t7)*s3l1p+5
     #12.D0/3.D0*t606*t45*t404-1024.D0/3.D0*t383*t594*t7)*s34r-1024.D0/3
     #.D0*t502*l3*t8*s3l1p+t1065)*s23r+(-t1069+(512.D0/3.D0*t396+512.D0/
     #3.D0*t1072*t154)*s34r+t1078)*s2l1+((512.D0/3.D0*t1081+512.D0/3.D0*
     #t1072*t293)*s34r+t1087)*s2l2-512.D0/3.D0*t391*t443+((1024.D0/3.D0*
     #t457*l3*t4*t1096+t399)*s3l1p+t406+(t1103+512.D0/3.D0*t119*t408)*t7
     #)*s34r+t1111+t1113+t1115)*t14
      s7 = (-512.D0/3.D0*t984*t386*t573+(t1009+t1012-512.D0/3.D0*t654*z*
     #t594*t20+(1024.D0/3.D0*t634+t1018)*s3l1p+t1022-t1065)*t133+((t1069
     #+(512.D0/3.D0*t396+512.D0/3.D0*t1132*t154)*s34r-t1078)*s2l1+((512.
     #D0/3.D0*t1081+512.D0/3.D0*t1132*t293)*s34r-t1087)*s2l2-512.D0/3.D0
     #*(-3+z)*z*t5*t564*t41+((1024.D0/3.D0*t1151*t4*t1096+t399)*s3l1p+t4
     #06+(-t1103-512.D0/3.D0*t407*z*t4*t119)*t7)*s34r-t1111-t1113-t1115)
     #*s23r+(1024.D0/3.D0*t426*t42+512.D0/3.D0*t1169*t223*t41+512.D0/3.D
     #0*t568*t430*s4l2p*t20)*s2l1+(512.D0/3.D0*t1169*t339*t41+512.D0/3.D
     #0*t568*t430*s4l1p*t20)*s2l2+512.D0/3.D0*t442*t584+(1024.D0/3.D0*t4
     #30*l3*t5*t45*t7*s3l2p*s3l1p+(-1024.D0/3.D0*t446*t1101-512.D0/3.D0*
     #t5*t407*t127)*t7)*t40+(-512.D0/3.D0*t384*t464-512.D0/3.D0*t384*t40
     #4-1024.D0/3.D0*t384*t470)*s34r)*s1vr
      s5 = s6+s7
      taux1 = s4+s5
      t1 = -1+z
      t2 = t1**2
      t3 = t2*t1
      t4 = l3-1
      t5 = t4**2
      t6 = t3*t5
      t7 = 1/s3vr
      t8 = t7*s3l2p
      t10 = s4l2p*t7
      t13 = 2048.D0/3.D0*t6*t8+2048.D0/3.D0*t6*t10
      t14 = s1vr**2
      t16 = -t13
      t18 = t5*t4
      t19 = t3*t18
      t20 = t7*s34r
      t23 = 2048.D0/3.D0*t19*t20*s2l2
      t24 = t2**2
      t25 = t18*t24
      t28 = -t25*t8-t25*t10
      t34 = -2048.D0/3.D0*t28
      t38 = t5**2
      t39 = t24*t38
      t40 = s34r**2
      t41 = t7*t40
      t45 = t24*t1
      t46 = t45*t38
      t54 = t7*s3l1p
      t56 = s4l1p*t7
      t59 = -2048.D0/3.D0*t6*t54-2048.D0/3.D0*t6*t56
      t61 = -t59
      t65 = 2048.D0/3.D0*t19*t20*s2l1
      t68 = t25*t54+t25*t56
      t74 = -2048.D0/3.D0*t68
      t105 = s13r**2
      t107 = t4*t2
      t108 = l3*t7
      t109 = t108*s2l2
      t112 = t4*t3
      t113 = t108*s3l2p
      t114 = t112*t113
      t117 = l3*s4l2p*t7
      t118 = t112*t117
      t121 = t14*s1vr
      t123 = -t4
      t124 = 2*t123
      t125 = t124*t2
      t127 = t124*t3
      t129 = t123*t3
      t130 = t129*t117
      t134 = l3*t3
      t135 = t5*t7
      t137 = t134*t135*s34r
      t139 = z*t1
      t140 = t4*t7
      t141 = t139*t140
      t143 = -2048*t137+2048.D0/3.D0*t141
      t145 = t5*t24
      t146 = t145*t113
      t148 = t145*t117
      t152 = 3*z
      t153 = -1+t152
      t154 = t153*t2
      t155 = t140*s3l2p
      t158 = -t153
      t159 = t158*t2
      t161 = t4*s4l2p*t7
      t166 = t107*l3
      t167 = t7*s2l2
      t168 = s23r**2
      t173 = 4096.D0/3.D0*t137-4096.D0/3.D0*t141
      t175 = t145*l3
      t177 = t175*t10*s34r
      t179 = 4*z
      t180 = -1+t179
      t181 = t180*t2
      t188 = t108*t40
      t189 = t25*t188
      t191 = t2*t7
      t193 = t180*t5*t191*s34r
      t195 = 2048.D0/3.D0*t189-2048.D0/3.D0*t193
      t197 = t18*t45
      t198 = t197*l3
      t204 = (6*z-2)*t3
      t205 = t135*s3l2p
      t208 = t158*t3
      t210 = t5*s4l2p*t7
      t218 = 2048.D0/3.D0*t137+2048.D0/3.D0*t141
      t223 = z*t2
      t232 = 4096.D0/3.D0*t189+2048.D0/3.D0*t193
      t234 = t197*t113
      t235 = t197*t117
      t239 = t180*t3
      t247 = l3*t45
      t249 = t40*s34r
      t252 = t18*t7
      t256 = 2048.D0/3.D0*t247*t38*t7*t249-2048.D0/3.D0*t208*t252*t40
      t258 = t24*t2
      t259 = t38*t258
      t265 = t158*t24
      t276 = t108*s2l1
      t279 = t108*s3l1p
      t280 = t112*t279
      t283 = l3*s4l1p*t7
      t284 = t112*t283
      t290 = t129*t283
      t296 = t145*t279
      t298 = t145*t283
      t302 = t140*s3l1p
      t306 = t4*s4l1p*t7
      t311 = t7*s2l1
      t318 = t175*t56*s34r
      t331 = t135*s3l1p
      t335 = t5*s4l1p*t7
      t355 = t197*t279
      t356 = t197*t283
      t384 = t112*l3
      t385 = t8*s2l1
      t387 = t54*s2l2
      t390 = l3*t4*t24
      t391 = t10*s3l1p
      t392 = t390*t391
      t393 = t56*s3l2p
      t394 = t390*t393
      t398 = t129*l3
      t408 = 1-2*z
      t409 = t408*t2
      t411 = 2048.D0/3.D0*t409*t155
      t413 = 2048.D0/3.D0*t409*t161
      t418 = 2048.D0/3.D0*t409*t302
      t420 = 2048.D0/3.D0*t409*t306
      t423 = t5*t45
      t424 = t423*l3
      t427 = t424*t391-t424*t393
      t453 = -2048.D0/3.D0*t427
      t461 = t408*t3
      t481 = l3*t18*t258
      t491 = l3**2
      t492 = t491*t2
      t493 = t492*t167
      t495 = t3*t491
      t496 = t495*t8
      t498 = t495*t10
      t502 = t491*t7
      t503 = t502*s34r
      t504 = t112*t503
      t505 = t139*t108
      t507 = -2048.D0/3.D0*t504-2048.D0/3.D0*t505
      t509 = t123*t24
      t510 = t502*s3l2p
      t512 = t491*t4
      t519 = -1-z
      t520 = t519*l3
      t521 = t191*s3l2p
      t523 = 2048.D0/3.D0*t520*t521
      t524 = l3*t2
      t526 = z*s4l2p*t7
      t527 = t524*t526
      t528 = 2048.D0/3.D0*t527
      t538 = 8192.D0/3.D0*t504+2048.D0/3.D0*t505
      t541 = 5*t123*t24
      t544 = t124*t24
      t546 = t491*s4l2p*t7
      t553 = t491*t24
      t554 = t135*t40
      t555 = t553*t554
      t559 = t108*s34r
      t562 = z**2
      t563 = t562*t7
      t565 = 4096.D0/3.D0*t555-2048.D0/3.D0*t519*t4*t2*t559-2048.D0/3.D0
     #*t563
      t569 = -t423*t510-t423*t546
      t572 = 3*t123
      t573 = t572*t3
      t579 = -t408*z
      t580 = t1*t7
      t581 = t580*s3l2p
      t584 = t408*z
      t586 = t1*s4l2p*t7
      t593 = t168*s23r
      t597 = 2048.D0/3.D0*t573*t503+2048.D0/3.D0*t505
      t599 = t572*t24
      t605 = z*t7
      t607 = t524*t605*s3l2p
      t612 = t152-2
      t618 = -2048*t555+2048.D0/3.D0*t612*t4*t2*t559+4096.D0/3.D0*t563
      t625 = (-3+t179)*t4*t3
      t628 = (-2+t179)*t4
      t629 = t628*t3
      t634 = t153*z
      t647 = t634*t4
      t649 = t647*t580*s34r
      t651 = -2048.D0/3.D0*t197*t502*t249+4096.D0/3.D0*t1*t3*t5*t188+204
     #8.D0/3.D0*t649
      t655 = t491*t18
      t664 = 3*t1*t5*t24
      t668 = -t612*t5*t24
      t673 = t628*z
      t676 = t584*t4
      t678 = t2*s4l2p*t7
      t692 = -2048.D0/3.D0*t181*t4*t559-2048.D0/3.D0*t563
      t695 = t180*t4*t3
      t701 = t562*t1
      t710 = (-2+5*z)*t5
      t714 = -2048.D0/3.D0*t710*t3*t188-2048.D0/3.D0*t649
      t716 = t710*t24
      t736 = 2048.D0/3.D0*t408*t24*t18*t108*t249+2048.D0/3.D0*t584*t2*t5
     #54
      t739 = t408*t45*t18
      t745 = t584*t3
      t753 = t492*t311
      t755 = t495*t54
      t757 = t495*t56
      t763 = t502*s3l1p
      t771 = t191*s3l1p
      t773 = 2048.D0/3.D0*t520*t771
      t776 = t524*z*s4l1p*t7
      t777 = 2048.D0/3.D0*t776
      t790 = t491*s4l1p*t7
      t801 = t423*t763+t423*t790
      t808 = t580*s3l1p
      t812 = t1*s4l1p*t7
      t828 = t524*t605*s3l1p
      t867 = t2*s4l1p*t7
      t924 = 2048.D0/3.D0*t495*t385-2048.D0/3.D0*t495*t387+2048.D0/3.D0*
     #t553*t391-2048.D0/3.D0*t553*t393
      t926 = t509*t491
      t927 = t8*s34r
      t929 = t524*t8
      t933 = t54*s34r
      t935 = t524*t54
      t940 = 2048.D0/3.D0*t134*t391
      t942 = 2048.D0/3.D0*t134*t393
      t947 = t544*t491
      t957 = t123*t45*t491
      t965 = t423*t491
      t971 = (z-2)*t4*t3
      t973 = t134*z
      t974 = t973*t161
      t979 = 2048.D0/3.D0*t223*t8
      t981 = 2048.D0/3.D0*t223*t10
      t988 = t973*t306
      t993 = 2048.D0/3.D0*t223*t54
      t995 = 2048.D0/3.D0*t223*t56
      t998 = -t392+t394
      t1005 = -t1*t4*t3
      t1025 = z*t5*t24
      t1030 = t4*z
      t1031 = t3*t7
      s2 = ((t13*t14+(t16*s23r+t23+4096.D0/3.D0*t28*s34r)*s1vr+(-t23+t34
     #*s34r)*s23r-2048.D0/3.D0*t39*t41*s2l2+(2048.D0/3.D0*t46*t8+2048.D0
     #/3.D0*t46*t10)*t40)*s1l1+(t59*t14+(t61*s23r-t65+4096.D0/3.D0*t68*s
     #34r)*s1vr+(t65+t74*s34r)*s23r+2048.D0/3.D0*t39*t41*s2l1+(-2048.D0/
     #3.D0*t46*t54-2048.D0/3.D0*t46*t56)*t40)*s1l2+(t13*s2l1+t59*s2l2)*t
     #14+((t16*s2l1+t61*s2l2)*s23r-t34*s34r*s2l1-t74*s34r*s2l2)*s1vr)*t1
     #05
      s7 = ((2048.D0/3.D0*t107*t109-4096.D0/3.D0*t114-2048.D0/3.D0*t118)
     #*t121+((2048.D0/3.D0*t125*t109-2048.D0/3.D0*t127*t113-2048.D0/3.D0
     #*t130)*s23r+t143*s2l2+(2048*t146+2048.D0/3.D0*t148)*s34r-2048.D0/3
     #.D0*t154*t155+2048.D0/3.D0*t159*t161)*t14+(2048.D0/3.D0*t166*t167*
     #t168+(t173*s2l2+2048.D0/3.D0*t177+2048.D0/3.D0*t181*t155+2048.D0/3
     #.D0*t181*t161)*s23r+t195*s2l2+2048.D0/3.D0*t198*t10*t40+(2048.D0/3
     #.D0*t204*t205-4096.D0/3.D0*t208*t210)*s34r)*s1vr+(t218*s2l2+(-2048
     #.D0/3.D0*t146-2048.D0/3.D0*t148)*s34r-2048.D0/3.D0*t223*t155-2048.
     #D0/3.D0*t223*t161)*t168+(t232*s2l2+(-4096.D0/3.D0*t234-4096.D0/3.D
     #0*t235)*t40+(-2048.D0/3.D0*t239*t205-2048.D0/3.D0*t239*t210)*s34r)
     #*s23r+t256*s2l2+(-2048.D0/3.D0*t259*t113-2048.D0/3.D0*t259*t117)*t
     #249+(2048.D0/3.D0*t265*t252*s3l2p+2048.D0/3.D0*t265*t18*s4l2p*t7)*
     #t40)*s1l1
      s8 = ((-2048.D0/3.D0*t107*t276+4096.D0/3.D0*t280+2048.D0/3.D0*t284
     #)*t121+((-2048.D0/3.D0*t125*t276+2048.D0/3.D0*t127*t279+2048.D0/3.
     #D0*t290)*s23r-t143*s2l1+(-2048*t296-2048.D0/3.D0*t298)*s34r+2048.D
     #0/3.D0*t154*t302-2048.D0/3.D0*t159*t306)*t14+(-2048.D0/3.D0*t166*t
     #311*t168+(-t173*s2l1-2048.D0/3.D0*t318-2048.D0/3.D0*t181*t302-2048
     #.D0/3.D0*t181*t306)*s23r-t195*s2l1-2048.D0/3.D0*t198*t56*t40+(-204
     #8.D0/3.D0*t204*t331+4096.D0/3.D0*t208*t335)*s34r)*s1vr+(-t218*s2l1
     #+(2048.D0/3.D0*t296+2048.D0/3.D0*t298)*s34r+2048.D0/3.D0*t223*t302
     #+2048.D0/3.D0*t223*t306)*t168+(-t232*s2l1+(4096.D0/3.D0*t355+4096.
     #D0/3.D0*t356)*t40+(2048.D0/3.D0*t239*t331+2048.D0/3.D0*t239*t335)*
     #s34r)*s23r-t256*s2l1+(2048.D0/3.D0*t259*t279+2048.D0/3.D0*t259*t28
     #3)*t249+(-2048.D0/3.D0*t265*t252*s3l1p-2048.D0/3.D0*t265*t18*s4l1p
     #*t7)*t40)*s1l2
      s6 = s7+s8
      s5 = s6+(-2048.D0/3.D0*t384*t385+2048.D0/3.D0*t384*t387-2048.D0/3.
     #D0*t392+2048.D0/3.D0*t394)*t121+((2048.D0/3.D0*t398*t10*s2l1-2048.
     #D0/3.D0*t398*t56*s2l2+2048.D0/3.D0*t392-2048.D0/3.D0*t394)*s23r+(-
     #4096.D0/3.D0*t177+t411+t413)*s2l1+(4096.D0/3.D0*t318-t418-t420)*s2
     #l2+4096.D0/3.D0*t427*s34r)*t14+(((2048.D0/3.D0*t114+2048.D0/3.D0*t
     #118)*s2l1+(-2048.D0/3.D0*t280-2048.D0/3.D0*t284)*s2l2)*t168+(((409
     #6.D0/3.D0*t146+2048*t148)*s34r-t411-t413)*s2l1+((-4096.D0/3.D0*t29
     #6-2048*t298)*s34r+t418+t420)*s2l2+t453*s34r)*s23r+((2048.D0/3.D0*t
     #234+4096.D0/3.D0*t235)*t40+(-2048.D0/3.D0*t461*t205-2048.D0/3.D0*t
     #461*t210)*s34r)*s2l1+((-2048.D0/3.D0*t355-4096.D0/3.D0*t356)*t40+(
     #2048.D0/3.D0*t461*t331+2048.D0/3.D0*t461*t335)*s34r)*s2l2+(-2048.D
     #0/3.D0*t481*t391+2048.D0/3.D0*t481*t393)*t40)*s1vr
      s6 = s13r
      s4 = s5*s6
      s8 = ((-2048.D0/3.D0*t493+4096.D0/3.D0*t496+2048.D0/3.D0*t498)*s23
     #r+t507*s2l2+(-2048.D0/3.D0*t509*t510+2048.D0/3.D0*t512*t24*s4l2p*t
     #7)*s34r-t523+t528)*t121+((4096.D0/3.D0*t493-2048*t496-4096.D0/3.D0
     #*t498)*t168+(t538*s2l2+(2048.D0/3.D0*t541*t510+4096.D0/3.D0*t544*t
     #546)*s34r+t523-t528)*s23r+t565*s2l2+4096.D0/3.D0*t569*t40+(2048.D0
     #/3.D0*t573*t113+2048.D0/3.D0*t130)*s34r+2048.D0/3.D0*t579*t581-204
     #8.D0/3.D0*t584*t586)*t14
      s7 = s8+((-2048.D0/3.D0*t493+2048.D0/3.D0*t496+2048.D0/3.D0*t498)*
     #t593+(t597*s2l2+(-2048.D0/3.D0*t599*t510-2048.D0/3.D0*t599*t546)*s
     #34r-2048.D0/3.D0*t607-t528)*t168+(t618*s2l2-2048*t569*t40+(-2048.D
     #0/3.D0*t625*t113-2048.D0/3.D0*t629*t117)*s34r-2048.D0/3.D0*t634*t5
     #81-2048.D0/3.D0*t634*t586)*s23r+t651*s2l2+(2048.D0/3.D0*t18*t258*t
     #510+2048.D0/3.D0*t655*t258*s4l2p*t7)*t249+(-2048.D0/3.D0*t664*t113
     #+2048.D0/3.D0*t668*t117)*t40+(-2048.D0/3.D0*t673*t521+4096.D0/3.D0
     #*t676*t678)*s34r)*s1vr+(-2048.D0/3.D0*t139*t109+2048.D0/3.D0*t607+
     #2048.D0/3.D0*t527)*t593
      s6 = s7+(t692*s2l2+(2048.D0/3.D0*t695*t113+2048.D0/3.D0*t695*t117)
     #*s34r+2048.D0/3.D0*t701*t8+2048.D0/3.D0*t701*t10)*t168+(t714*s2l2+
     #(2048.D0/3.D0*t716*t113+2048.D0/3.D0*t716*t117)*t40+(2048.D0/3.D0*
     #t647*t521+2048.D0/3.D0*t647*t678)*s34r)*s23r+t736*s2l2+(-2048.D0/3
     #.D0*t739*t113-2048.D0/3.D0*t739*t117)*t249+(-2048.D0/3.D0*t745*t20
     #5-2048.D0/3.D0*t745*t210)*t40
      s7 = s1l1
      s5 = s6*s7
      s3 = s4+s5
      s1 = s2+s3
      s3 = s1
      s7 = ((2048.D0/3.D0*t753-4096.D0/3.D0*t755-2048.D0/3.D0*t757)*s23r
     #-t507*s2l1+(2048.D0/3.D0*t509*t763-2048.D0/3.D0*t512*t24*s4l1p*t7)
     #*s34r+t773-t777)*t121+((-4096.D0/3.D0*t753+2048*t755+4096.D0/3.D0*
     #t757)*t168+(-t538*s2l1+(-2048.D0/3.D0*t541*t763-4096.D0/3.D0*t544*
     #t790)*s34r-t773+t777)*s23r-t565*s2l1+4096.D0/3.D0*t801*t40+(-2048.
     #D0/3.D0*t573*t279-2048.D0/3.D0*t290)*s34r-2048.D0/3.D0*t579*t808+2
     #048.D0/3.D0*t584*t812)*t14
      s6 = s7+((2048.D0/3.D0*t753-2048.D0/3.D0*t755-2048.D0/3.D0*t757)*t
     #593+(-t597*s2l1+(2048.D0/3.D0*t599*t763+2048.D0/3.D0*t599*t790)*s3
     #4r+2048.D0/3.D0*t828+t777)*t168+(-t618*s2l1-2048*t801*t40+(2048.D0
     #/3.D0*t625*t279+2048.D0/3.D0*t629*t283)*s34r+2048.D0/3.D0*t634*t80
     #8+2048.D0/3.D0*t634*t812)*s23r-t651*s2l1+(-2048.D0/3.D0*t655*t258*
     #t7*s3l1p-2048.D0/3.D0*t655*t258*s4l1p*t7)*t249+(2048.D0/3.D0*t664*
     #t279-2048.D0/3.D0*t668*t283)*t40+(2048.D0/3.D0*t673*t771-4096.D0/3
     #.D0*t676*t867)*s34r)*s1vr+(2048.D0/3.D0*t139*t276-2048.D0/3.D0*t82
     #8-2048.D0/3.D0*t776)*t593
      s5 = s6+(-t692*s2l1+(-2048.D0/3.D0*t695*t279-2048.D0/3.D0*t695*t28
     #3)*s34r-2048.D0/3.D0*t701*t54-2048.D0/3.D0*t701*t56)*t168+(-t714*s
     #2l1+(-2048.D0/3.D0*t716*t279-2048.D0/3.D0*t716*t283)*t40+(-2048.D0
     #/3.D0*t647*t771-2048.D0/3.D0*t647*t867)*s34r)*s23r-t736*s2l1+(2048
     #.D0/3.D0*t739*t279+2048.D0/3.D0*t739*t283)*t249+(2048.D0/3.D0*t745
     #*t331+2048.D0/3.D0*t745*t335)*t40
      s6 = s1l2
      s4 = s5*s6
      s2 = s3+s4
      s3 = s2+(t924*s23r+(-2048.D0/3.D0*t926*t927+2048.D0/3.D0*t929)*s2l
     #1+(2048.D0/3.D0*t926*t933-2048.D0/3.D0*t935)*s2l2+t940-t942)*t121
      s4 = s3
      s6 = (-t924*t168+((2048.D0/3.D0*t947*t927-2048.D0/3.D0*t929)*s2l1+
     #(-2048.D0/3.D0*t947*t933+2048.D0/3.D0*t935)*s2l2+(2048.D0/3.D0*t95
     #7*t391-2048.D0/3.D0*t957*t393)*s34r-t940+t942)*s23r+(-2048.D0/3.D0
     #*t965*t8*t40+(2048.D0/3.D0*t971*t113+2048.D0/3.D0*t974)*s34r+t979+
     #t981)*s2l1+(2048.D0/3.D0*t965*t54*t40+(-2048.D0/3.D0*t971*t279-204
     #8.D0/3.D0*t988)*s34r-t993-t995)*s2l2+4096.D0/3.D0*t998*s34r)*t14
      s7 = ((((2048.D0/3.D0*t1005*t113-2048.D0/3.D0*t974)*s34r-t979-t981
     #)*s2l1+((-2048.D0/3.D0*t1005*t279+2048.D0/3.D0*t988)*s34r+t993+t99
     #5)*s2l2-2048.D0/3.D0*t998*s34r)*s23r+((-2048.D0/3.D0*t423*t113-204
     #8.D0/3.D0*t1025*t117)*t40+(-2048.D0/3.D0*t1030*t1031*s3l2p-2048.D0
     #/3.D0*t112*t526)*s34r)*s2l1+((2048.D0/3.D0*t247*t331+2048.D0/3.D0*
     #t1025*t283)*t40+(2048.D0/3.D0*t1030*t1031*s3l1p+2048.D0/3.D0*t1030
     #*t3*s4l1p*t7)*s34r)*s2l2-t453*t40)*s1vr
      s5 = s6+s7
      taux2 = s4+s5

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,5.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = -l3+1
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet2 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,7.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = -l3+1
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet4 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      qgrmnum1e0 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcof
     #f4
      RETURN
      END

      double precision function qgrmnum1e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = t1**2
      t3 = t2*t1
      t4 = l3-1
      t5 = t4**2
      t6 = t3*t5
      t7 = 1/s3vr
      t8 = t7*s3l2p
      t9 = t6*t8
      t10 = s4l2p*t7
      t11 = t6*t10
      t13 = -512.D0/3.D0*t9-512.D0/3.D0*t11
      t14 = s1vr**2
      t18 = t5*t4
      t19 = t3*t18
      t20 = t7*s34r
      t21 = t20*s2l2
      t22 = t19*t21
      t23 = 512.D0/3.D0*t22
      t24 = t2**2
      t25 = t18*t24
      t28 = t25*t8+t25*t10
      t35 = -512.D0/3.D0*t28*s34r
      t38 = t5**2
      t39 = t24*t38
      t40 = s34r**2
      t41 = t7*t40
      t45 = t24*t1
      t46 = t45*t38
      t54 = t7*s3l1p
      t56 = s4l1p*t7
      t59 = -512.D0/3.D0*t6*t54-512.D0/3.D0*t6*t56
      t61 = -t59
      t63 = t20*s2l1
      t65 = 512.D0/3.D0*t19*t63
      t68 = t25*t54+t25*t56
      t75 = -512.D0/3.D0*t68*s34r
      t88 = z*l3
      t89 = t88*t3
      t90 = t5*t7
      t91 = t14*s1vr
      t98 = t2*t5
      t99 = t7*s2l2
      t104 = -1024.D0/3.D0*t98*t99+512.D0/3.D0*t9+512.D0/3.D0*t11
      t107 = z*t18
      t109 = l3*t7
      t110 = t109*s34r
      t111 = t107*t24*t110
      t113 = -t1
      t115 = t98*t7
      t117 = 512.D0/3.D0*t113*z*t115
      t131 = t38*t7
      t132 = t131*t40
      t135 = 2*z
      t136 = 1-t135
      t145 = z**2
      t148 = t20*s23r
      t155 = s13r**2
      t157 = l3*t2
      t158 = t4*t7
      t162 = t4*t2
      t165 = l3*t3
      t166 = t90*s34r
      t167 = t165*t166
      t171 = s23r**2
      t175 = t165*t5
      t178 = t109*t40
      t179 = t25*t178
      t180 = 1024.D0/3.D0*t179
      t185 = t4*t3
      t186 = t185*l3
      t190 = -t4
      t191 = t190*t3
      t192 = t109*s3l2p
      t193 = t191*t192
      t195 = l3*s4l2p
      t196 = t195*t7
      t198 = 512.D0/3.D0*t191*t196
      t202 = -1-z
      t203 = t202*t1
      t204 = t203*t158
      t206 = 1024.D0/3.D0*t167+512.D0/3.D0*t204
      t208 = t5*t24
      t209 = t208*t192
      t210 = t208*t196
      t214 = z*t2
      t215 = t158*s3l2p
      t218 = 3*z
      t219 = -1+t218
      t220 = t219*t2
      t222 = t4*s4l2p*t7
      t227 = t185*t192
      t228 = t185*t196
      t234 = -512.D0/3.D0*t167-1024.D0/3.D0*t204
      t240 = 4*z
      t242 = (-1-t240)*t2
      t245 = t214*t222
      t250 = t214*t166
      t251 = 2048.D0/3.D0*t250
      t252 = -512.D0/3.D0*t179+t251
      t254 = t18*t45
      t255 = t254*t192
      t257 = t254*t196
      t259 = -1024.D0/3.D0*t255-512.D0/3.D0*t257
      t263 = (1-6*z)*t3
      t264 = t90*s3l2p
      t267 = t219*t3
      t269 = t5*s4l2p*t7
      t277 = -512.D0/3.D0*t167+512.D0/3.D0*t204
      t282 = t214*t4
      t283 = -t162-t282
      t284 = t283*t7
      t292 = -t180-t251
      t297 = z*t3
      t299 = t297*t269
      t306 = t40*s34r
      t307 = t131*t306
      t309 = t18*t7
      t310 = t309*t40
      t313 = -512.D0/3.D0*l3*t45*t307-512.D0/3.D0*t267*t310
      t315 = t24*t2
      t316 = t38*t315
      t322 = t219*t24
      t336 = t109*s3l1p
      t337 = t191*t336
      t340 = l3*s4l1p*t7
      t341 = t191*t340
      t346 = t208*t336
      t347 = t208*t340
      t351 = t158*s3l1p
      t355 = t4*s4l1p*t7
      t361 = t185*t340
      t372 = t214*t355
      t377 = t254*t336
      t379 = t254*t340
      t381 = -1024.D0/3.D0*t377-512.D0/3.D0*t379
      t383 = t90*s3l1p
      t386 = t5*s4l1p
      t387 = t386*t7
      t410 = t297*t387
      t432 = 2*t190
      t435 = l3**2
      t436 = t435*t7
      t437 = t14**2
      t441 = t4*z
      t442 = t441*t3
      t446 = t109*s2l2
      t448 = 1024.D0/3.D0*t162*t446
      t452 = t54*s2l2
      t455 = z*t5
      t456 = t455*t24
      t457 = t436*s34r
      t458 = t456*t457
      t461 = l3*t4*t24
      t462 = t10*s3l1p
      t464 = 512.D0/3.D0*t461*t462
      t465 = t56*s3l2p
      t467 = 512.D0/3.D0*t461*t465
      t468 = t4*t24
      t469 = t195*s4l1p
      t470 = t468*t469
      t471 = 1024.D0/3.D0*t470
      t481 = t432*t3
      t498 = z*t1
      t499 = t498*t158
      t503 = 512*t209
      t507 = -t219
      t508 = t507*t2
      t510 = 512.D0/3.D0*t508*t215
      t511 = 512.D0/3.D0*t245
      t514 = 512*t346
      t519 = 512.D0/3.D0*t508*t351
      t520 = 512.D0/3.D0*t372
      t525 = t107*t45*t436*t40
      t527 = t5*t45
      t528 = t527*l3
      t529 = t528*t462
      t531 = t528*t465
      t533 = t527*t469
      t545 = t185*t10
      t547 = -1024.D0/3.D0*t185*t8-512.D0/3.D0*t545
      t549 = t185*t465
      t550 = 512.D0/3.D0*t549
      t551 = 3*t145
      t554 = t498*t7
      t593 = s4l2p*s4l1p
      t602 = 1+4*t145-t218
      t614 = t507*t3
      t634 = l3*t18*t315
      t639 = t18*t315
      t641 = t145*l3
      t668 = t145*z
      t670 = t1*t7
      t678 = -1+t240
      t679 = t678*t145
      t681 = t2*t7
      t696 = t435*t2
      t699 = t185*t457
      t700 = t498*t109
      t707 = -t699-t700
      t710 = t435*t24
      t711 = t90*t40
      t712 = t710*t711
      t713 = 2048.D0/3.D0*t712
      t715 = 2048.D0/3.D0*t282*t110
      t718 = t171*s23r
      t729 = t254*t436*t306
      t737 = t3*t435
      t741 = t737*t8
      t742 = t737*t10
      t746 = t185*t435
      t749 = t436*s3l2p
      t751 = 512.D0/3.D0*t468*t749
      t752 = t435*t4
      t754 = t24*s4l2p*t7
      t756 = 1024.D0/3.D0*t752*t754
      t759 = z*t7
      t761 = t157*t759*s3l2p
      t763 = z*s4l2p
      t765 = t157*t763*t7
      t766 = 512.D0/3.D0*t765
      t772 = t1*l3
      t773 = t772*t7
      t775 = 1024.D0/3.D0*t699+1024.D0/3.D0*t773
      t777 = t752*t24
      t781 = 5*z
      t782 = 1-t781
      t783 = t782*t2
      t787 = (2-t218)*t2
      t797 = (-z-t145)*t7
      t799 = -512.D0/3.D0*(-z-2)*t4*t2*t110-512.D0/3.D0*t797
      t801 = t527*t749
      t805 = t527*t435*s4l2p*t7
      t809 = -t678
      t810 = t809*t7
      t817 = t145*t1
      t820 = -t136
      t821 = t820*z
      t835 = -512.D0/3.D0*t699+512.D0/3.D0*(-3-z)*t1*t109
      t844 = 2*t202
      t849 = 1024.D0/3.D0*t844*t4*t2*t110+1024.D0/3.D0*t797
      t857 = (2-10*z)*t4*t3
      t859 = 8*z
      t862 = (4-t859)*t4*t3
      t867 = -1-t218
      t868 = t867*z
      t872 = t817*t10
      t881 = t4*t145
      t882 = t670*s34r
      t884 = 512*t881*t882
      t885 = 512.D0/3.D0*t729+512.D0/3.D0*t867*t5*t3*t178-t884
      t889 = t435*t18
      t896 = 2-t781
      t898 = t896*t5*t24
      t902 = 3*t1*t5*t24
      t908 = t809*t4*z
      t909 = t681*s3l2p
      t913 = t820*t4*z
      t915 = t2*s4l2p*t7
      t923 = t157*z
      t924 = -t157-t923
      t925 = t924*t7
      t935 = -512.D0/3.D0*t242*t4*t110-512.D0/3.D0*t797
      t940 = -2*t186+t185*l3*t809
      t941 = t940*t7
      t948 = -t498-t817
      t949 = t948*t7
      t957 = t782*t5
      t961 = -512.D0/3.D0*t957*t3*t178+t884
      t963 = t957*t24
      t976 = t820*t18
      t982 = t681*t40
      t985 = 512.D0/3.D0*t976*t24*t109*t306+512.D0/3.D0*t820*t5*z*t982
      t987 = t976*t45
      t993 = t821*t3
      s2 = ((1024.D0/3.D0*t696*t7*s23r+1024.D0/3.D0*t699+1024.D0/3.D0*t7
     #00)*t91+(-2048.D0/3.D0*t696*t7*t171+2048.D0/3.D0*t707*s23r-t713-t7
     #15)*t14+(1024.D0/3.D0*t696*t7*t718-1024.D0/3.D0*t707*t171+(1024.D0
     #/3.D0*t712+t715)*s23r+1024.D0/3.D0*t729+1024.D0/3.D0*t89*t711)*s1v
     #r)*s1l2-512.D0/3.D0*t737*t8*t437
      s3 = s2+((512.D0/3.D0*t741-512.D0/3.D0*t742)*s23r-512.D0/3.D0*t746
     #*t21+(t751-t756)*s34r+512.D0/3.D0*t761-t766)*t91
      s1 = s3+(-512.D0/3.D0*t737*t8*t171+(t775*s2l2+1024.D0/3.D0*t777*t1
     #0*s34r+512.D0/3.D0*t783*t192+512.D0/3.D0*t787*t196)*s23r+t799*s2l2
     #+(512.D0/3.D0*t801+2048.D0/3.D0*t805)*t40+(512.D0/3.D0*t186*t810*s
     #3l2p+1024.D0/3.D0*t228)*s34r-1024.D0/3.D0*t817*t8-512.D0/3.D0*t821
     #*t1*s4l2p*t7)*t14+((512.D0/3.D0*t741+512.D0/3.D0*t742)*t718+(t835*
     #s2l2+(t751+t756)*s34r+2560.D0/3.D0*t761-512.D0/3.D0*t783*t196)*t17
     #1+(t849*s2l2+(-512.D0/3.D0*t801-512.D0/3.D0*t805)*t40+(-512.D0/3.D
     #0*t857*t192-512.D0/3.D0*t862*t196)*s34r-512.D0/3.D0*t868*t670*s3l2
     #p+512*t872)*s23r+t885*s2l2+(-512.D0/3.D0*t639*t749-1024.D0/3.D0*t8
     #89*t315*s4l2p*t7)*t306+(-512.D0/3.D0*t898*t192+512.D0/3.D0*t902*t1
     #96)*t40+(-512.D0/3.D0*t908*t909+1024.D0/3.D0*t913*t915)*s34r)*s1vr
      t999 = s1+(-512.D0/3.D0*t203*t446+512.D0/3.D0*t925*s3l2p+512.D0/3.
     #D0*t924*s4l2p*t7)*t718+(t935*s2l2+(512.D0/3.D0*t941*s3l2p+512.D0/3
     #.D0*t940*s4l2p*t7)*s34r+512.D0/3.D0*t949*s3l2p+512.D0/3.D0*t948*s4
     #l2p*t7)*t171+(t961*s2l2+(512.D0/3.D0*t963*t192+512.D0/3.D0*t963*t1
     #96)*t40+(-512*t881*t909-512*t881*t915)*s34r)*s23r+t985*s2l2+(-512.
     #D0/3.D0*t987*t192-512.D0/3.D0*t987*t196)*t306+(-512.D0/3.D0*t993*t
     #264-512.D0/3.D0*t993*t269)*t40
      t1004 = t737*t54
      t1005 = t737*t56
      t1011 = t436*s3l1p
      t1013 = 512.D0/3.D0*t468*t1011
      t1014 = t24*s4l1p
      t1017 = 1024.D0/3.D0*t752*t1014*t7
      t1021 = t157*t759*s3l1p
      t1025 = t157*z*s4l1p*t7
      t1026 = 512.D0/3.D0*t1025
      t1043 = t527*t1011
      t1047 = t527*t435*s4l1p*t7
      t1088 = t817*t56
      t1093 = t315*t7
      t1108 = t681*s3l1p
      t1111 = t2*s4l1p
      t1112 = t1111*t7
      t1167 = t435*l3
      t1168 = t1167*t7
      t1176 = 512.D0/3.D0*t737*t452
      t1179 = t1168*s34r
      t1182 = t8*s3l1p
      t1183 = t710*t1182
      t1184 = 1024.D0/3.D0*t1183
      t1185 = t145*t2
      t1197 = t441*t24*t1179
      t1200 = t710*t593
      t1202 = t1185*t435
      t1215 = t136*l3
      t1229 = t455*t45*t1168*t40
      t1231 = t435*t45
      t1234 = 2048.D0/3.D0*t1231*t4*t1182
      t1240 = t165*t8
      t1243 = (3-z)*t3
      t1251 = t668*t1
      t1276 = t820*t2
      t1303 = (5-z)*t3
      t1312 = 1024.D0/3.D0*t165*t593
      t1324 = 1024.D0/3.D0*t554
      t1327 = t527*t435
      t1331 = t113*t4
      t1332 = t1331*t3
      t1336 = 1024.D0/3.D0*t89*t222
      t1339 = 2*t113
      t1340 = t1339*t2
      t1342 = 512.D0/3.D0*t1340*t8
      t1343 = 512.D0/3.D0*t872
      t1352 = 1024.D0/3.D0*t89*t355
      t1356 = 512.D0/3.D0*t1340*t54
      t1357 = 512.D0/3.D0*t1088
      t1377 = t468*t192
      t1381 = (5-t135)*l3*t4
      t1386 = t1014*t8
      t1398 = z-2
      t1402 = 1024.D0/3.D0*t1398*t2*t8-1024.D0/3.D0*t915
      t1405 = 1024.D0/3.D0*t1111*t8
      t1407 = 1024.D0/3.D0*t214*t593
      t1408 = 2*t145
      s1 = 1024.D0/3.D0*t297*t1168*t718+((1024.D0/3.D0*t696*t99+512.D0/3
     #.D0*t741)*s2l1+t1176+4096.D0/3.D0*t1197-t1184+(1024.D0/3.D0*t1200-
     #1024.D0/3.D0*t1202)*t7)*t171+(((-1024*t190*t3*t457+1024.D0/3.D0*t7
     #73)*s2l2-512.D0/3.D0*t1276*t192-1024.D0/3.D0*t765)*s2l1+(-512.D0/3
     #.D0*t1276*t336-1024.D0/3.D0*t1025)*s2l2+3584.D0/3.D0*t1229+(-t1234
     #+(1024.D0/3.D0*t752*t45*s4l2p*s4l1p+512.D0/3.D0*t3*(-t859-5)*t441*
     #t435)*t7)*s34r+(-4096.D0/3.D0*t1240-512.D0/3.D0*t1303*t196)*s3l1p-
     #512.D0/3.D0*t1303*l3*t465+(-t1312+512.D0/3.D0*(-2+t240-5*t145)*z*t
     #772)*t7)*s23r+((t713+1024.D0/3.D0*t162*t110-t1324)*s2l2-512.D0/3.D
     #0*t1327*t8*t40+(512.D0/3.D0*t1332*t192-t1336)*s34r-t1342-t1343)*s2
     #l1+(-512.D0/3.D0*t1327*t54*t40+(512.D0/3.D0*t1332*t336-t1352)*s34r
     #-t1356-t1357)*s2l2
      t1414 = s1+512.D0/3.D0*z*t1167*t18*t1093*t306+(-1024.D0/3.D0*t5*t3
     #15*t435*t1182+512.D0/3.D0*(-5-t218)*z*t5*t710*t7)*t40+((-4096.D0/3
     #.D0*t1377-512.D0/3.D0*t1381*t754)*s3l1p-512.D0/3.D0*t1381*t1386+(-
     #t471+512.D0/3.D0*(-2-2*z-2*t145)*t4*t923)*t7)*s34r+t1402*s3l1p-t14
     #05+(-t1407+512.D0/3.D0*(1+t1408-t135)*t145)*t7
      t1426 = 9*z
      t1470 = -z+4
      t1472 = t1470*l3*t4
      t1508 = t1339*t7
      t1512 = -t282+t214*t1331
      t1536 = t7*t306
      t1543 = t1398*l3*t45
      t1586 = t145**2
      s3 = ((t13*t14+(-t13*s23r-t23+1024.D0/3.D0*t28*s34r)*s1vr+(t23+t35
     #)*s23r+512.D0/3.D0*t39*t41*s2l2+(-512.D0/3.D0*t46*t8-512.D0/3.D0*t
     #46*t10)*t40)*s1l1+(t59*t14+(t61*s23r-t65+1024.D0/3.D0*t68*s34r)*s1
     #vr+(t65+t75)*s23r+512.D0/3.D0*t39*t41*s2l1+(-512.D0/3.D0*t46*t54-5
     #12.D0/3.D0*t46*t56)*t40)*s1l2-1024.D0/3.D0*t89*t90*t91+(1024.D0/3.
     #D0*t89*t90*s23r+t104*s2l1+t61*s2l2+2048.D0/3.D0*t111-t117)*t14+((-
     #t104*s2l1+t59*s2l2-1024.D0/3.D0*t111+t117)*s23r+(1024.D0/3.D0*t22+
     #t35)*s2l1+t75*s2l2-1024.D0/3.D0*t88*t45*t132+512.D0/3.D0*t136*z*t1
     #8*t3*t7*s34r)*s1vr+512.D0/3.D0*t145*t3*t18*t148+512.D0/3.D0*t145*t
     #24*t132)*t155
      s11 = (-1024.D0/3.D0*t157*t158*t91+(2048.D0/3.D0*t162*t109*s23r+20
     #48.D0/3.D0*t167)*t14+(-1024.D0/3.D0*t157*t158*t171-2048.D0/3.D0*t1
     #75*t148-t180)*s1vr)*s1l2+512.D0/3.D0*t186*t10*t91+((-1024.D0/3.D0*
     #t193-t198)*s23r+t206*s2l2+(512.D0/3.D0*t209-512.D0/3.D0*t210)*s34r
     #+512*t214*t215+512.D0/3.D0*t220*t222)*t14+((-1024.D0/3.D0*t227-102
     #4.D0/3.D0*t228)*t171+(t234*s2l2+(-2048.D0/3.D0*t209-512*t210)*s34r
     #+512.D0/3.D0*t242*t215-2048.D0/3.D0*t245)*s23r+t252*s2l2+t259*t40+
     #(512.D0/3.D0*t263*t264-1024.D0/3.D0*t267*t269)*s34r)*s1vr
      s10 = s11+(t277*s2l2+(512.D0/3.D0*t209+512.D0/3.D0*t210)*s34r-512.
     #D0/3.D0*t284*s3l2p-512.D0/3.D0*t283*s4l2p*t7)*t171+(t292*s2l2+(102
     #4.D0/3.D0*t255+1024.D0/3.D0*t257)*t40+(2048.D0/3.D0*t297*t264+2048
     #.D0/3.D0*t299)*s34r)*s23r+t313*s2l2+(512.D0/3.D0*t316*t192+512.D0/
     #3.D0*t316*t196)*t306+(512.D0/3.D0*t322*t309*s3l2p+512.D0/3.D0*t322
     #*t18*s4l2p*t7)*t40
      s11 = s1l1
      s9 = s10*s11
      s10 = (512.D0/3.D0*t186*t56*t91+((-1024.D0/3.D0*t337-512.D0/3.D0*t
     #341)*s23r+t206*s2l1+(512.D0/3.D0*t346-512.D0/3.D0*t347)*s34r+512*t
     #214*t351+512.D0/3.D0*t220*t355)*t14+((-1024.D0/3.D0*t185*t336-1024
     #.D0/3.D0*t361)*t171+(t234*s2l1+(-2048.D0/3.D0*t346-512*t347)*s34r+
     #512.D0/3.D0*t242*t351-2048.D0/3.D0*t372)*s23r+t252*s2l1+t381*t40+(
     #512.D0/3.D0*t263*t383-1024.D0/3.D0*t267*t387)*s34r)*s1vr+(t277*s2l
     #1+(512.D0/3.D0*t346+512.D0/3.D0*t347)*s34r-512.D0/3.D0*t284*s3l1p-
     #512.D0/3.D0*t283*s4l1p*t7)*t171+(t292*s2l1+(1024.D0/3.D0*t377+1024
     #.D0/3.D0*t379)*t40+(2048.D0/3.D0*t297*t383+2048.D0/3.D0*t410)*s34r
     #)*s23r+t313*s2l1+(512.D0/3.D0*t316*t336+512.D0/3.D0*t316*t340)*t30
     #6+(512.D0/3.D0*t322*t309*s3l1p+512.D0/3.D0*t322*t18*s4l1p*t7)*t40)
     #*s1l2
      s8 = s9+s10
      s7 = s8+512.D0/3.D0*t432*z*t3*t436*t437+(1024*t442*t436*s23r+(t448
     #+512.D0/3.D0*t227)*s2l1+512.D0/3.D0*t186*t452+1024*t458+t464+t467+
     #(t471+512.D0/3.D0*t157*t441)*t7)*t91+(-2048.D0/3.D0*t442*t436*t171
     #+((512.D0/3.D0*t481*t192-512.D0/3.D0*t228)*s2l1+(512.D0/3.D0*t481*
     #t336-512.D0/3.D0*t361)*s2l2-3584.D0/3.D0*t458-t464-t467+(-t471-512
     #.D0/3.D0*t157*t441*t136)*t7)*s23r+((1024.D0/3.D0*t167+1024.D0/3.D0
     #*t499)*s2l2+(-t503-512.D0/3.D0*t210)*s34r+t510-t511)*s2l1+((-t514-
     #512.D0/3.D0*t347)*s34r+t519-t520)*s2l2-1024*t525+(-1024.D0/3.D0*t5
     #29-1024.D0/3.D0*t531+(-2048.D0/3.D0*t533+512.D0/3.D0*t6*t202*z*l3)
     #*t7)*s34r+t547*s3l1p-t550+512.D0/3.D0*(-t551+t218-1)*t4*t554)*t14
      s9 = s7
      s13 = ((-t448-512.D0/3.D0*t193-t198)*s2l1+(-512.D0/3.D0*t337-512.D
     #0/3.D0*t341)*s2l2-512.D0/3.D0*t458+512.D0/3.D0*(t157*t441*t202+t15
     #7*t441*t113)*t7)*t171+(((-1024*t167-1024.D0/3.D0*t499)*s2l2+(t503+
     #1024.D0/3.D0*t210)*s34r-t510+t511)*s2l1+((t514+1024.D0/3.D0*t347)*
     #s34r-t519+t520)*s2l2+512.D0/3.D0*t525+(512.D0/3.D0*t529+512.D0/3.D
     #0*t531+1024.D0/3.D0*t528*t593*t7)*s34r-t547*s3l1p+t550+512.D0/3.D0
     #*t602*t4*t554)*s23r+((-2048.D0/3.D0*t179-1024.D0/3.D0*t250)*s2l2-t
     #259*t40+(-512.D0/3.D0*t614*t264+512.D0/3.D0*t299)*s34r)*s2l1
      s12 = s13+(-t381*t40+(-512.D0/3.D0*t614*t383+512.D0/3.D0*t410)*s34
     #r)*s2l2+1024.D0/3.D0*z*t435*t315*t307+(512.D0/3.D0*t634*t462+512.D
     #0/3.D0*t634*t465+(1024.D0/3.D0*t639*t469+1024.D0/3.D0*t25*t641)*t7
     #)*t40+((1024.D0/3.D0*t208*t8+512.D0/3.D0*t208*t10)*s3l1p+512.D0/3.
     #D0*t208*t465-512.D0/3.D0*(-6*t145-1+t240)*z*t115)*s34r
      s13 = s1vr
      s11 = s12*s13
      s12 = (-512.D0/3.D0*t5*t145*t3*t110-512.D0/3.D0*t4*t668*t670)*t171
      s10 = s11+s12
      s8 = s9+s10
      s6 = s8+(-1024.D0/3.D0*t25*t145*t178-512.D0/3.D0*t679*t5*t681*s34r
     #)*s23r-512.D0/3.D0*t641*t45*t307+512.D0/3.D0*t507*t145*t3*t310
      s7 = s13r
      s5 = s6*s7
      s6 = t999*s1l1
      s4 = s5+s6
      s2 = s3+s4
      s4 = s2
      s8 = -512.D0/3.D0*t737*t54*t437+((512.D0/3.D0*t1004-512.D0/3.D0*t1
     #005)*s23r-512.D0/3.D0*t746*t63+(t1013-t1017)*s34r+512.D0/3.D0*t102
     #1-t1026)*t91
      s9 = s8+(-512.D0/3.D0*t737*t54*t171+(t775*s2l1+1024.D0/3.D0*t777*t
     #56*s34r+512.D0/3.D0*t783*t336+512.D0/3.D0*t787*t340)*s23r+t799*s2l
     #1+(512.D0/3.D0*t1043+2048.D0/3.D0*t1047)*t40+(512.D0/3.D0*t186*t81
     #0*s3l1p+1024.D0/3.D0*t361)*s34r-1024.D0/3.D0*t817*t54-512.D0/3.D0*
     #t821*t1*s4l1p*t7)*t14
      s7 = s9+((512.D0/3.D0*t1004+512.D0/3.D0*t1005)*t718+(t835*s2l1+(t1
     #013+t1017)*s34r+2560.D0/3.D0*t1021-512.D0/3.D0*t783*t340)*t171+(t8
     #49*s2l1+(-512.D0/3.D0*t1043-512.D0/3.D0*t1047)*t40+(-512.D0/3.D0*t
     #857*t336-512.D0/3.D0*t862*t340)*s34r-512.D0/3.D0*t868*t670*s3l1p+5
     #12*t1088)*s23r+t885*s2l1+(-512.D0/3.D0*t889*t1093*s3l1p-1024.D0/3.
     #D0*t889*t315*s4l1p*t7)*t306+(-512.D0/3.D0*t898*t336+512.D0/3.D0*t9
     #02*t340)*t40+(-512.D0/3.D0*t908*t1108+1024.D0/3.D0*t913*t1112)*s34
     #r)*s1vr+(-512.D0/3.D0*t203*t109*s2l1+512.D0/3.D0*t925*s3l1p+512.D0
     #/3.D0*t924*s4l1p*t7)*t718
      s6 = s7+(t935*s2l1+(512.D0/3.D0*t941*s3l1p+512.D0/3.D0*t940*s4l1p*
     #t7)*s34r+512.D0/3.D0*t949*s3l1p+512.D0/3.D0*t948*s4l1p*t7)*t171+(t
     #961*s2l1+(512.D0/3.D0*t963*t336+512.D0/3.D0*t963*t340)*t40+(-512*t
     #881*t1108-512*t881*t1112)*s34r)*s23r+t985*s2l1+(-512.D0/3.D0*t987*
     #t336-512.D0/3.D0*t987*t340)*t306+(-512.D0/3.D0*t993*t383-512.D0/3.
     #D0*t993*t387)*t40
      s7 = s1l2
      s5 = s6*s7
      s3 = s4+s5
      s1 = s3+(1024.D0/3.D0*t297*t1168*s23r-512.D0/3.D0*t737*t8*s2l1-t11
     #76-512.D0/3.D0*t190*z*t24*t1179-t1184+512.D0/3.D0*t1185*t436)*t437
     #+(-2048.D0/3.D0*t297*t1168*t171+(-1024.D0/3.D0*t696*t99*s2l1-1536*
     #t1197+2048.D0/3.D0*t1183+(-1024.D0/3.D0*t1200-512.D0/3.D0*t1202)*t
     #7)*s23r+((-2048.D0/3.D0*t699-1024.D0/3.D0*t700)*s2l2+1024.D0/3.D0*
     #t777*t8*s34r-512.D0/3.D0*t1215*t909+t766)*s2l1+(1024.D0/3.D0*t777*
     #t54*s34r-512.D0/3.D0*t1215*t1108+t1026)*s2l2-1024.D0/3.D0*t1229+(t
     #1234+512*t441*t737*t7)*s34r+(1024*t1240+512.D0/3.D0*t1243*t196)*s3
     #l1p+512.D0/3.D0*t1243*l3*t465+1024.D0/3.D0*t1251*t109)*t91
      s3 = s1+t1414*t14
      s4 = s3
      s9 = 1024.D0/3.D0*t1185*t436*t718+((1024.D0/3.D0*t157*t99+t766)*s2
     #l1+512.D0/3.D0*t923*t56*s2l2-512.D0/3.D0*(-2-t1426)*t4*z*t737*t20+
     #(1024.D0/3.D0*t1240+1024.D0/3.D0*t165*t10)*s3l1p+1024.D0/3.D0*t165
     #*t465+(t1312-512.D0/3.D0*(-2+t240-t1408)*z*t772)*t7)*t171
      s8 = s9+(((2048.D0/3.D0*t185*t110+t1324)*s2l2+(-512.D0/3.D0*t89*t2
     #15+t1336)*s34r+t1342+t1343)*s2l1+((-512.D0/3.D0*t89*t351+t1352)*s3
     #4r+t1356+t1357)*s2l2-512.D0/3.D0*(-4-t1426)*z*t5*t710*t41+((2048.D
     #0/3.D0*t1377+512.D0/3.D0*t1472*t754)*s3l1p+512.D0/3.D0*t1472*t1386
     #+(2048.D0/3.D0*t470+512.D0/3.D0*t1470*t4*t923)*t7)*s34r-t1402*s3l1
     #p+t1405+(t1407-512.D0/3.D0*(t551+1-t135)*t145)*t7)*s23r+((1024.D0/
     #3.D0*t208*t178+1024.D0/3.D0*t214*t158*s34r)*s2l2+(-512.D0/3.D0*t45
     #6*t192+512.D0/3.D0*t456*t196)*t40+(512.D0/3.D0*t185*t1508*s3l2p-51
     #2.D0/3.D0*t1512*s4l2p*t7)*s34r)*s2l1
      s7 = s8+((-512.D0/3.D0*t456*t336+512.D0/3.D0*t456*t340)*t40+(512.D
     #0/3.D0*t185*t1508*s3l1p-512.D0/3.D0*t1512*s4l1p*t7)*s34r)*s2l2-512
     #.D0/3.D0*t844*z*t18*t1231*t1536+((1024.D0/3.D0*t527*t192-512.D0/3.
     #D0*t1543*t269)*s3l1p-512.D0/3.D0*t1543*t386*t8+(1024.D0/3.D0*t533-
     #512.D0/3.D0*(-2-t218+t1408)*z*t175)*t7)*t40+((-1024.D0/3.D0*t185*t
     #1398*t7*s3l2p+1024.D0/3.D0*t545)*s3l1p+1024.D0/3.D0*t549+(1024.D0/
     #3.D0*t185*t763*s4l1p-512.D0/3.D0*t602*t145*t4*t1)*t7)*s34r
      s8 = s1vr
      s6 = s7*s8
      s7 = 512.D0/3.D0*t1251*t109*t718
      s5 = s6+s7
      s2 = s4+s5
      taux1 = s2+(512.D0/3.D0*t679*t4*t157*t20+512.D0/3.D0*t1586*t7)*t17
     #1+(-512.D0/3.D0*t896*t145*t5*t165*t41+512.D0/3.D0*t219*t668*t4*t88
     #2)*s23r-512.D0/3.D0*t136*t18*t145*l3*t24*t1536-512.D0/3.D0*t136*t5
     #*t668*t982
      t1 = -1+z
      t2 = t1**2
      t3 = t2*t1
      t4 = l3-1
      t5 = t4**2
      t6 = t3*t5
      t7 = 1/s3vr
      t8 = t7*s3l2p
      t10 = s4l2p*t7
      t13 = -8192.D0/3.D0*t6*t8-8192.D0/3.D0*t6*t10
      t14 = s1vr**2
      t16 = -t13
      t18 = t5*t4
      t19 = t3*t18
      t20 = t7*s34r
      t23 = 8192.D0/3.D0*t19*t20*s2l2
      t24 = t2**2
      t25 = t18*t24
      t28 = t25*t8+t25*t10
      t34 = -8192.D0/3.D0*t28
      t38 = t5**2
      t39 = t24*t38
      t40 = s34r**2
      t41 = t7*t40
      t45 = t24*t1
      t46 = t45*t38
      t54 = t7*s3l1p
      t56 = s4l1p*t7
      t59 = 8192.D0/3.D0*t6*t54+8192.D0/3.D0*t6*t56
      t61 = -t59
      t65 = 8192.D0/3.D0*t19*t20*s2l1
      t68 = -t25*t54-t25*t56
      t74 = -8192.D0/3.D0*t68
      t105 = s13r**2
      t107 = t2*t4
      t108 = l3*t7
      t109 = t108*s2l2
      t112 = t4*t3
      t113 = t108*s3l2p
      t114 = t112*t113
      t117 = l3*s4l2p*t7
      t118 = t112*t117
      t121 = t14*s1vr
      t123 = 7*t4
      t124 = t123*t2
      t126 = 9*t4
      t127 = t126*t3
      t130 = 5*t4*t3
      t135 = l3*t3
      t136 = t5*t7
      t138 = t135*t136*s34r
      t140 = 4*z
      t141 = -1-t140
      t142 = t141*t1
      t143 = t4*t7
      t144 = t142*t143
      t145 = 2048.D0/3.D0*t144
      t146 = 8192*t138+t145
      t148 = t5*t24
      t149 = t148*t113
      t151 = t148*t117
      t155 = 12*z
      t156 = 3-t155
      t157 = t156*t2
      t158 = t143*s3l2p
      t161 = -4+t155
      t162 = t161*t2
      t163 = t4*s4l2p
      t164 = t163*t7
      t169 = t107*l3
      t170 = t7*s2l2
      t171 = s23r**2
      t177 = -6144*t138-4096.D0/3.D0*t144
      t183 = 16*z
      t184 = 2-t183
      t185 = t184*t2
      t188 = 3-t183
      t189 = t188*t2
      t194 = t108*t40
      t195 = t25*t194
      t198 = t2*t7
      t201 = 2048.D0/3.D0*t188*t5*t198*s34r
      t202 = -10240.D0/3.D0*t195-t201
      t204 = t18*t45
      t205 = t204*t113
      t207 = t204*t117
      t213 = (7-24*z)*t3
      t214 = t136*s3l2p
      t217 = t161*t3
      t219 = t5*s4l2p*t7
      t227 = -8192.D0/3.D0*t138+t145
      t232 = z*t2
      t235 = -t107-4*t232*t4
      t236 = t235*t7
      t245 = -16384.D0/3.D0*t195+t201
      t250 = t188*t3
      t260 = t40*s34r
      t264 = t18*t7
      t268 = -8192.D0/3.D0*l3*t45*t38*t7*t260-2048.D0/3.D0*t217*t264*t40
      t270 = t24*t2
      t271 = t38*t270
      t277 = t161*t24
      t288 = t108*s2l1
      t291 = t108*s3l1p
      t292 = t112*t291
      t295 = l3*s4l1p*t7
      t296 = t112*t295
      t308 = t148*t291
      t310 = t148*t295
      t314 = t143*s3l1p
      t317 = t4*s4l1p
      t318 = t317*t7
      t323 = t7*s2l1
      t341 = t204*t291
      t343 = t204*t295
      t347 = t136*s3l1p
      t351 = t5*s4l1p*t7
      t399 = t112*l3
      t407 = l3*t4*t24
      t408 = t10*s3l1p
      t409 = t407*t408
      t410 = 4096.D0/3.D0*t409
      t411 = t56*s3l2p
      t412 = t407*t411
      t413 = 4096.D0/3.D0*t412
      t417 = -t4*t3
      t419 = 4*t4
      t420 = t419*t3
      t432 = t148*l3
      t436 = 9*z
      t437 = -4+t436
      t438 = t437*t2
      t440 = 2048.D0/3.D0*t438*t158
      t442 = 2048.D0/3.D0*t438*t164
      t449 = 2048.D0/3.D0*t438*t314
      t451 = 2048.D0/3.D0*t438*t318
      t454 = t5*t45
      t455 = t454*l3
      t458 = -t455*t408+t455*t411
      t484 = -4096.D0/3.D0*t458
      t492 = t437*t3
      t512 = l3*t18*t270
      t522 = l3**2
      t523 = t522*t2
      t524 = t523*t170
      t526 = t3*t522
      t527 = t526*t8
      t529 = t526*t10
      t535 = t522*t7
      t536 = t535*s34r
      t539 = z*t1
      t542 = 2048.D0/3.D0*t419*t3*t536+8192.D0/3.D0*t539*t108
      t544 = t123*t24
      t545 = t535*s3l2p
      t548 = t522*t4
      t551 = t548*t24*s4l2p*t7
      t555 = 6*z
      t556 = 1+t555
      t557 = t556*l3
      t558 = t198*s3l2p
      t561 = l3*t2
      t563 = z*s4l2p*t7
      t564 = t561*t563
      t575 = 5*z
      t576 = -2+t575
      t580 = -12288*t112*t536-2048.D0/3.D0*t576*t1*t108
      t583 = 28*t4*t24
      t586 = t126*t24
      t588 = t522*s4l2p*t7
      t593 = z*t7
      t600 = t522*t24
      t601 = t136*t40
      t602 = t600*t601
      t606 = t108*s34r
      t610 = t141*z*t7
      t612 = -22528.D0/3.D0*t602-2048.D0/3.D0*t556*t4*t2*t606-2048.D0/3.
     #D0*t610
      t614 = t454*t545
      t616 = t454*t588
      t622 = (6+t140)*t4*t3
      t624 = 3*t4
      t625 = t624*t3
      t630 = 8*z
      t632 = (3-t630)*z
      t633 = t1*t7
      t634 = t633*s3l2p
      t637 = -4+t630
      t638 = t637*z
      t640 = t1*s4l2p*t7
      t647 = t171*s23r
      t649 = 15*t4
      t652 = -1-z
      t657 = 2048.D0/3.D0*t649*t3*t536+2048*t652*t1*t108
      t659 = t649*t24
      t662 = 12*t4*t24
      t668 = (-2-t575)*t2
      t672 = (-1-t575)*t2
      t684 = 12288*t602+2048.D0/3.D0*(2-t436)*t4*t2*t606+4096.D0/3.D0*t6
     #10
      t693 = (7-15*z)*t4*t3
      t698 = (6-17*z)*t4*t3
      t704 = (2-t155)*z
      t707 = t156*z
      t715 = 5-t555
      t720 = t707*t4
      t722 = t720*t633*s34r
      t724 = 14336.D0/3.D0*t204*t535*t260+2048.D0/3.D0*t715*t5*t3*t194+2
     #048.D0/3.D0*t722
      t729 = t522*t18
      t739 = (9-10*z)*t5*t24
      t743 = (-7+t155)*t5*t24
      t750 = (7-t183)*z*t4
      t753 = t638*t4
      t755 = t2*s4l2p*t7
      t765 = -t561-4*t561*z
      t766 = t765*t7
      t776 = -2048.D0/3.D0*t185*t4*t606-2048.D0/3.D0*t610
      t779 = t184*t4*t3
      t785 = z**2
      t788 = -t539-4*t785*t1
      t789 = t788*t7
      t799 = (7-20*z)*t5
      t803 = -2048.D0/3.D0*t799*t3*t194-2048.D0/3.D0*t722
      t805 = t799*t24
      t825 = 2048.D0/3.D0*t637*t24*t18*t108*t260+2048.D0/3.D0*t638*t2*t6
     #01
      t828 = t637*t45*t18
      t834 = t638*t3
      t842 = t523*t323
      t844 = t526*t54
      t846 = t526*t56
      t852 = t535*s3l1p
      t857 = t548*t24*s4l1p*t7
      t861 = t198*s3l1p
      t865 = z*s4l1p*t7
      t866 = t561*t865
      t880 = t522*s4l1p*t7
      t893 = t454*t852
      t895 = t454*t880
      t904 = t633*s3l1p
      t908 = t1*s4l1p*t7
      t966 = t2*s4l1p*t7
      t1024 = -4096*t527-2048.D0/3.D0*t529
      t1028 = 4096*t844+2048.D0/3.D0*t846
      t1031 = 2048*t600*t408
      t1033 = 2048*t600*t411
      t1037 = 6*t4*t24
      t1043 = (z+4)*l3
      t1070 = t662*t522
      t1074 = (z-6)*t2
      t1078 = (2-3*z)*t2
      t1091 = t624*t45*t522
      t1098 = z*l3*t3
      t1111 = (9-t575)*t4*t3
      t1115 = -t576*t4*t3
      t1121 = 10240.D0/3.D0*t232*t8
      t1122 = -t1
      t1124 = 4*t1122*t1
      t1126 = 2048.D0/3.D0*t1124*t563
      t1139 = 10240.D0/3.D0*t232*t54
      t1141 = 2048.D0/3.D0*t1124*t865
      t1148 = 2048.D0/3.D0*t232*t408
      t1150 = 2048.D0/3.D0*t232*t411
      t1156 = 2*t1122*t2
      t1167 = l3*t24
      t1176 = (-7+t630)*t4*t3
      t1180 = (-t555+4)*t4*t3
      t1196 = -t652*l3*t24
      t1207 = t715*l3*t24
      t1211 = (2-t140)*l3*t24
      t1216 = t4*z
      t1217 = t3*t7
      t1223 = t1216*t3
      t1225 = t232*t4*t1122-3*t1223
      s2 = ((t13*t14+(t16*s23r-t23+16384.D0/3.D0*t28*s34r)*s1vr+(t23+t34
     #*s34r)*s23r+8192.D0/3.D0*t39*t41*s2l2+(-8192.D0/3.D0*t46*t8-8192.D
     #0/3.D0*t46*t10)*t40)*s1l1+(t59*t14+(t61*s23r+t65+16384.D0/3.D0*t68
     #*s34r)*s1vr+(-t65+t74*s34r)*s23r-8192.D0/3.D0*t39*t41*s2l1+(8192.D
     #0/3.D0*t46*t54+8192.D0/3.D0*t46*t56)*t40)*s1l2+(t13*s2l1+t59*s2l2)
     #*t14+((t16*s2l1+t61*s2l2)*s23r-t34*s34r*s2l1-t74*s34r*s2l2)*s1vr)*
     #t105
      s9 = (-2048*t107*t109+6144*t114+10240.D0/3.D0*t118)*t121+((2048.D0
     #/3.D0*t124*t109-2048.D0/3.D0*t127*t113-2048.D0/3.D0*t130*t117)*s23
     #r+t146*s2l2+(-28672.D0/3.D0*t149-4096*t151)*s34r-2048.D0/3.D0*t157
     #*t158+2048.D0/3.D0*t162*t164)*t14+(-8192.D0/3.D0*t169*t170*t171+(t
     #177*s2l2+(2048.D0/3.D0*t149-2048*t151)*s34r+2048.D0/3.D0*t185*t158
     #+2048.D0/3.D0*t189*t164)*s23r+t202*s2l2+(2048.D0/3.D0*t205-2048*t2
     #07)*t40+(2048.D0/3.D0*t213*t214-4096.D0/3.D0*t217*t219)*s34r)*s1vr
     #+(t227*s2l2+(8192.D0/3.D0*t149+8192.D0/3.D0*t151)*s34r-2048.D0/3.D
     #0*t236*s3l2p-2048.D0/3.D0*t235*s4l2p*t7)*t171
      s8 = s9+(t245*s2l2+(16384.D0/3.D0*t205+16384.D0/3.D0*t207)*t40+(-2
     #048.D0/3.D0*t250*t214-2048.D0/3.D0*t250*t219)*s34r)*s23r+t268*s2l2
     #+(8192.D0/3.D0*t271*t113+8192.D0/3.D0*t271*t117)*t260+(2048.D0/3.D
     #0*t277*t264*s3l2p+2048.D0/3.D0*t277*t18*s4l2p*t7)*t40
      s9 = s1l1
      s7 = s8*s9
      s10 = (2048*t107*t288-6144*t292-10240.D0/3.D0*t296)*t121+((-2048.D
     #0/3.D0*t124*t288+2048.D0/3.D0*t127*t291+2048.D0/3.D0*t130*t295)*s2
     #3r-t146*s2l1+(28672.D0/3.D0*t308+4096*t310)*s34r+2048.D0/3.D0*t157
     #*t314-2048.D0/3.D0*t162*t318)*t14+(8192.D0/3.D0*t169*t323*t171+(-t
     #177*s2l1+(-2048.D0/3.D0*t308+2048*t310)*s34r-2048.D0/3.D0*t185*t31
     #4-2048.D0/3.D0*t189*t318)*s23r-t202*s2l1+(-2048.D0/3.D0*t341+2048*
     #t343)*t40+(-2048.D0/3.D0*t213*t347+4096.D0/3.D0*t217*t351)*s34r)*s
     #1vr+(-t227*s2l1+(-8192.D0/3.D0*t308-8192.D0/3.D0*t310)*s34r+2048.D
     #0/3.D0*t236*s3l1p+2048.D0/3.D0*t235*s4l1p*t7)*t171
      s9 = s10+(-t245*s2l1+(-16384.D0/3.D0*t341-16384.D0/3.D0*t343)*t40+
     #(2048.D0/3.D0*t250*t347+2048.D0/3.D0*t250*t351)*s34r)*s23r-t268*s2
     #l1+(-8192.D0/3.D0*t271*t291-8192.D0/3.D0*t271*t295)*t260+(-2048.D0
     #/3.D0*t277*t264*s3l1p-2048.D0/3.D0*t277*t18*s4l1p*t7)*t40
      s10 = s1l2
      s8 = s9*s10
      s6 = s7+s8
      s7 = s6+(10240.D0/3.D0*t399*t8*s2l1-10240.D0/3.D0*t399*t54*s2l2+t4
     #10-t413)*t121
      s5 = s7+(((2048.D0/3.D0*t417*t113+2048.D0/3.D0*t420*t117)*s2l1+(-2
     #048.D0/3.D0*t417*t291-2048.D0/3.D0*t420*t295)*s2l2-t410+t413)*s23r
     #+(4096*t432*t10*s34r+t440+t442)*s2l1+(-4096*t432*t56*s34r-t449-t45
     #1)*s2l2+8192.D0/3.D0*t458*s34r)*t14+(((-8192.D0/3.D0*t114-8192.D0/
     #3.D0*t118)*s2l1+(8192.D0/3.D0*t292+8192.D0/3.D0*t296)*s2l2)*t171+(
     #((-6144*t149-20480.D0/3.D0*t151)*s34r-t440-t442)*s2l1+((6144*t308+
     #20480.D0/3.D0*t310)*s34r+t449+t451)*s2l2+t484*s34r)*s23r+((-10240.
     #D0/3.D0*t205-4096*t207)*t40+(-2048.D0/3.D0*t492*t214-2048.D0/3.D0*
     #t492*t219)*s34r)*s2l1+((10240.D0/3.D0*t341+4096*t343)*t40+(2048.D0
     #/3.D0*t492*t347+2048.D0/3.D0*t492*t351)*s34r)*s2l2+(4096.D0/3.D0*t
     #512*t408-4096.D0/3.D0*t512*t411)*t40)*s1vr
      s6 = s13r
      s4 = s5*s6
      s8 = ((2048*t524-20480.D0/3.D0*t527-4096*t529)*s23r+t542*s2l2+(-20
     #48.D0/3.D0*t544*t545-8192.D0/3.D0*t551)*s34r-2048.D0/3.D0*t557*t55
     #8-8192.D0/3.D0*t564)*t121+((-14336.D0/3.D0*t524+28672.D0/3.D0*t527
     #+20480.D0/3.D0*t529)*t171+(t580*s2l2+(2048.D0/3.D0*t583*t545+4096.
     #D0/3.D0*t586*t588)*s34r+10240.D0/3.D0*t561*t593*s3l2p+2048*t564)*s
     #23r+t612*s2l2+(28672.D0/3.D0*t614+16384.D0/3.D0*t616)*t40+(2048.D0
     #/3.D0*t622*t113+2048.D0/3.D0*t625*t117)*s34r+2048.D0/3.D0*t632*t63
     #4-2048.D0/3.D0*t638*t640)*t14
      s7 = s8+((8192.D0/3.D0*t524-8192.D0/3.D0*t527-8192.D0/3.D0*t529)*t
     #647+(t657*s2l2+(-2048.D0/3.D0*t659*t545-2048.D0/3.D0*t662*t588)*s3
     #4r-2048.D0/3.D0*t668*t113-2048.D0/3.D0*t672*t117)*t171+(t684*s2l2+
     #(-12288*t614-8192*t616)*t40+(-2048.D0/3.D0*t693*t113-2048.D0/3.D0*
     #t698*t117)*s34r-2048.D0/3.D0*t704*t634-2048.D0/3.D0*t707*t640)*s23
     #r+t724*s2l2+(-14336.D0/3.D0*t18*t270*t545-8192.D0/3.D0*t729*t270*s
     #4l2p*t7)*t260+(-2048.D0/3.D0*t739*t113+2048.D0/3.D0*t743*t117)*t40
     #+(-2048.D0/3.D0*t750*t558+4096.D0/3.D0*t753*t755)*s34r)*s1vr+(-204
     #8.D0/3.D0*t142*t109+2048.D0/3.D0*t766*s3l2p+2048.D0/3.D0*t765*s4l2
     #p*t7)*t647
      s6 = s7+(t776*s2l2+(2048.D0/3.D0*t779*t113+2048.D0/3.D0*t779*t117)
     #*s34r+2048.D0/3.D0*t789*s3l2p+2048.D0/3.D0*t788*s4l2p*t7)*t171+(t8
     #03*s2l2+(2048.D0/3.D0*t805*t113+2048.D0/3.D0*t805*t117)*t40+(2048.
     #D0/3.D0*t720*t558+2048.D0/3.D0*t720*t755)*s34r)*s23r+t825*s2l2+(-2
     #048.D0/3.D0*t828*t113-2048.D0/3.D0*t828*t117)*t260+(-2048.D0/3.D0*
     #t834*t214-2048.D0/3.D0*t834*t219)*t40
      s7 = s1l1
      s5 = s6*s7
      s3 = s4+s5
      s1 = s2+s3
      s3 = s1
      s7 = ((-2048*t842+20480.D0/3.D0*t844+4096*t846)*s23r-t542*s2l1+(20
     #48.D0/3.D0*t544*t852+8192.D0/3.D0*t857)*s34r+2048.D0/3.D0*t557*t86
     #1+8192.D0/3.D0*t866)*t121+((14336.D0/3.D0*t842-28672.D0/3.D0*t844-
     #20480.D0/3.D0*t846)*t171+(-t580*s2l1+(-2048.D0/3.D0*t583*t852-4096
     #.D0/3.D0*t586*t880)*s34r-10240.D0/3.D0*t561*t593*s3l1p-2048*t866)*
     #s23r-t612*s2l1+(-28672.D0/3.D0*t893-16384.D0/3.D0*t895)*t40+(-2048
     #.D0/3.D0*t622*t291-2048.D0/3.D0*t625*t295)*s34r-2048.D0/3.D0*t632*
     #t904+2048.D0/3.D0*t638*t908)*t14
      s6 = s7+((-8192.D0/3.D0*t842+8192.D0/3.D0*t844+8192.D0/3.D0*t846)*
     #t647+(-t657*s2l1+(2048.D0/3.D0*t659*t852+2048.D0/3.D0*t662*t880)*s
     #34r+2048.D0/3.D0*t668*t291+2048.D0/3.D0*t672*t295)*t171+(-t684*s2l
     #1+(12288*t893+8192*t895)*t40+(2048.D0/3.D0*t693*t291+2048.D0/3.D0*
     #t698*t295)*s34r+2048.D0/3.D0*t704*t904+2048.D0/3.D0*t707*t908)*s23
     #r-t724*s2l1+(14336.D0/3.D0*t729*t270*t7*s3l1p+8192.D0/3.D0*t729*t2
     #70*s4l1p*t7)*t260+(2048.D0/3.D0*t739*t291-2048.D0/3.D0*t743*t295)*
     #t40+(2048.D0/3.D0*t750*t861-4096.D0/3.D0*t753*t966)*s34r)*s1vr+(20
     #48.D0/3.D0*t142*t288-2048.D0/3.D0*t766*s3l1p-2048.D0/3.D0*t765*s4l
     #1p*t7)*t647
      s5 = s6+(-t776*s2l1+(-2048.D0/3.D0*t779*t291-2048.D0/3.D0*t779*t29
     #5)*s34r-2048.D0/3.D0*t789*s3l1p-2048.D0/3.D0*t788*s4l1p*t7)*t171+(
     #-t803*s2l1+(-2048.D0/3.D0*t805*t291-2048.D0/3.D0*t805*t295)*t40+(-
     #2048.D0/3.D0*t720*t861-2048.D0/3.D0*t720*t966)*s34r)*s23r-t825*s2l
     #1+(2048.D0/3.D0*t828*t291+2048.D0/3.D0*t828*t295)*t260+(2048.D0/3.
     #D0*t834*t347+2048.D0/3.D0*t834*t351)*t40
      s6 = s1l2
      s4 = s5*s6
      s2 = s3+s4
      s3 = s2+((t1024*s2l1+t1028*s2l2-t1031+t1033)*s23r+((-2048.D0/3.D0*
     #t1037*t545+2048.D0/3.D0*t551)*s34r-2048.D0/3.D0*t1043*t558+2048.D0
     #/3.D0*t564)*s2l1+((2048.D0/3.D0*t1037*t852-2048.D0/3.D0*t857)*s34r
     #+2048.D0/3.D0*t1043*t861-2048.D0/3.D0*t866)*s2l2-2048.D0/3.D0*t135
     #*t408+2048.D0/3.D0*t135*t411)*t121
      s4 = s3
      s6 = ((-t1024*s2l1-t1028*s2l2+t1031-t1033)*t171+((2048.D0/3.D0*t10
     #70*t8*s34r-2048.D0/3.D0*t1074*t113+2048.D0/3.D0*t1078*t117)*s2l1+(
     #-2048.D0/3.D0*t1070*t54*s34r+2048.D0/3.D0*t1074*t291-2048.D0/3.D0*
     #t1078*t295)*s2l2+(2048.D0/3.D0*t1091*t408-2048.D0/3.D0*t1091*t411)
     #*s34r+2048.D0/3.D0*t1098*t408-2048.D0/3.D0*t1098*t411)*s23r+((4096
     #*t614-2048.D0/3.D0*t616)*t40+(2048.D0/3.D0*t1111*t113+2048.D0/3.D0
     #*t1115*t117)*s34r-t1121+t1126)*s2l1+((-4096*t893+2048.D0/3.D0*t895
     #)*t40+(-2048.D0/3.D0*t1111*t291-2048.D0/3.D0*t1115*t295)*s34r+t113
     #9-t1141)*s2l2+(2048*t409-2048*t412)*s34r+t1148-t1150)*t14
      s7 = (((4096.D0/3.D0*t135*t8-2048.D0/3.D0*t1156*t117)*s2l1+(-4096.
     #D0/3.D0*t135*t54+2048.D0/3.D0*t1156*t295)*s2l2-2048.D0/3.D0*t1167*
     #t408+2048.D0/3.D0*t1167*t411)*t171+(((2048.D0/3.D0*t1176*t113-2048
     #.D0/3.D0*t1180*t117)*s34r+t1121-t1126)*s2l1+((-2048.D0/3.D0*t1176*
     #t291+2048.D0/3.D0*t1180*t295)*s34r-t1139+t1141)*s2l2+(-2048.D0/3.D
     #0*t1196*t163*t54+2048.D0/3.D0*t1196*t317*t8)*s34r-t1148+t1150)*s23
     #r+((-2048.D0/3.D0*t1207*t214-2048.D0/3.D0*t1211*t219)*t40+(10240.D
     #0/3.D0*t1216*t1217*s3l2p-2048.D0/3.D0*t1225*s4l2p*t7)*s34r)*s2l1+(
     #(2048.D0/3.D0*t1207*t347+2048.D0/3.D0*t1211*t351)*t40+(-10240.D0/3
     #.D0*t1216*t1217*s3l1p+2048.D0/3.D0*t1225*s4l1p*t7)*s34r)*s2l2-t484
     #*t40+(-2048.D0/3.D0*t1223*t408+2048.D0/3.D0*t1223*t411)*s34r)*s1vr
      s5 = s6+s7
      taux2 = s4+s5

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,5.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = -l3+1
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet2 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,7.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = -l3+1
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet4 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      qgrmnum1e1 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcof
     #f4
      RETURN
      END

      double precision function qgrmnum1e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = t1**2
      t3 = l3-1
      t4 = t3**2
      t5 = t2*t4
      t6 = 1/s3vr
      t7 = t6*s2l2
      t10 = t2*t1
      t11 = t10*t4
      t12 = t6*s3l2p
      t13 = t11*t12
      t15 = s4l2p*t6
      t16 = t11*t15
      t18 = 1024.D0/3.D0*t5*t7-512.D0/3.D0*t13-512.D0/3.D0*t16
      t20 = t6*s3l1p
      t22 = s4l1p*t6
      t25 = -512.D0/3.D0*t11*t20-512.D0/3.D0*t11*t22
      t27 = z-2
      t31 = 512.D0/3.D0*t27*z*t5*t6
      t33 = s1vr**2
      t41 = t4*t3
      t43 = t6*s34r
      t44 = t43*s2l2
      t47 = t2**2
      t48 = t41*t47
      t63 = 2*z*t1
      t65 = t6*t10
      t71 = z**2
      t78 = t4**2
      t79 = t78*t6
      t80 = s34r**2
      t85 = s13r**2
      t87 = t2*t3
      t88 = l3*t6
      t89 = t88*s2l2
      t90 = t87*t89
      t91 = t3*t10
      t92 = t88*s3l2p
      t93 = t91*t92
      t96 = t33*s1vr
      t98 = 1024.D0/3.D0*t90
      t100 = l3*s4l2p
      t101 = t100*t6
      t102 = t91*t101
      t103 = 512.D0/3.D0*t102
      t106 = l3*t10
      t107 = t4*t6
      t109 = t106*t107*s34r
      t111 = t1*t3
      t112 = t111*t6
      t114 = 1024.D0/3.D0*t109+512.D0/3.D0*t112
      t116 = t4*t47
      t117 = t116*l3
      t118 = t12*s34r
      t121 = t87*t12
      t127 = s23r**2
      t130 = -1024.D0/3.D0*t109-1024.D0/3.D0*t112
      t132 = t116*t92
      t134 = t116*t101
      t139 = t87*t15
      t143 = t88*t80
      t147 = -512.D0/3.D0*t48*t143-512.D0/3.D0*t5*t43
      t149 = t47*t1
      t151 = t41*t149*l3
      t152 = t12*t80
      t172 = t88*s2l1
      t173 = t87*t172
      t174 = t88*s3l1p
      t175 = t91*t174
      t182 = l3*s4l1p*t6
      t183 = t91*t182
      t188 = t20*s34r
      t191 = t87*t20
      t199 = t116*t174
      t201 = t116*t182
      t206 = t87*t22
      t211 = t20*t80
      t218 = t6*s2l1
      t231 = t3*z
      t232 = t231*t10
      t233 = l3**2
      t234 = t233*t6
      t235 = t33**2
      t244 = t91*l3
      t248 = t4*z
      t249 = t248*t47
      t250 = t234*s34r
      t251 = t249*t250
      t252 = 512.D0/3.D0*t251
      t253 = l3*t2
      t254 = t253*z
      t255 = 3*z
      t266 = t12*s2l1
      t269 = t20*s2l2
      t279 = 2*z
      t280 = -1+t279
      t282 = t111*t280*t6
      t289 = t280*t2
      t290 = t3*t6
      t291 = t290*s3l2p
      t293 = 512.D0/3.D0*t289*t291
      t295 = 512.D0/3.D0*t91*t15
      t300 = t290*s3l1p
      t301 = t289*t300
      t302 = t91*t22
      t309 = z*t41*t149*t234*t80
      t311 = 5*z
      t314 = z*l3
      t315 = t314*t43
      t318 = 4*z
      t319 = 3*t71
      t322 = z*t1
      t323 = t322*t6
      t331 = -t175-t183
      t335 = z+1
      t347 = -512.D0/3.D0*t132-512.D0/3.D0*t134
      t352 = -512.D0/3.D0*t199-512.D0/3.D0*t201
      t365 = -2-4*t71+t255
      t374 = t280*t10
      t391 = t47*t2
      t393 = t80*s34r
      t394 = t79*t393
      t400 = t47*l3
      t401 = t6*t80
      t409 = t2*t6
      t410 = t409*s34r
      t417 = t88*s34r
      t419 = -t335
      t430 = t71*z
      t449 = t10*t233
      t453 = t233*t2
      t454 = t453*t7
      t456 = t449*t12
      t457 = 512*t456
      t458 = t449*t15
      t462 = t322*t89
      t464 = t3*t47
      t465 = t464*t233
      t466 = t465*t118
      t468 = t335*l3
      t474 = 1024.D0/3.D0*t454
      t475 = 1024.D0/3.D0*t458
      t478 = t91*t250
      t479 = 1024.D0/3.D0*t478
      t480 = t279+1
      t484 = -t479-512.D0/3.D0*t480*t1*t88
      t486 = t234*s3l2p
      t487 = t464*t486
      t489 = t233*t3
      t492 = t489*t47*s4l2p*t6
      t493 = 1024.D0/3.D0*t492
      t496 = 3+t279
      t497 = t496*t2
      t506 = t231*t2
      t507 = t506*t417
      t509 = z*t6
      t510 = 512.D0/3.D0*t509
      t511 = -1024.D0/3.D0*t507-t510
      t513 = t149*t4
      t514 = t513*t233
      t518 = t480*t3*t10
      t523 = t322*t12
      t524 = 512.D0/3.D0*t523
      t527 = t454-t456-t458
      t529 = t127*s23r
      t531 = 2+z
      t535 = t479+512.D0/3.D0*t531*t1*t88
      t541 = (3+z)*t2
      t544 = t531*t2
      t549 = t233*t47
      t550 = t107*t80
      t558 = 512.D0/3.D0*t549*t550+1024.D0/3.D0*t335*t3*t2*t417+1024.D0/
     #3.D0*t509
      t568 = t496*t3*t10
      t571 = t531*t3*t10
      t578 = 512.D0/3.D0*t322*t15
      t581 = t314*t10
      t584 = t322*t290*s34r
      t586 = 512.D0/3.D0*t581*t550+512.D0/3.D0*t584
      t596 = t1*l3
      t598 = t253*t12
      t599 = t253*t15
      t605 = -1024.D0/3.D0*t87*t417-t510
      t614 = -512.D0/3.D0*t11*t143-512.D0/3.D0*t584
      t618 = z*t2
      t621 = t3*s4l2p*t6
      t622 = t618*t621
      t633 = t453*t218
      t635 = t449*t20
      t636 = 512*t635
      t637 = t449*t22
      t643 = t465*t188
      t651 = 1024.D0/3.D0*t637
      t655 = t234*s3l1p
      t656 = t464*t655
      t660 = t489*t47*s4l1p*t6
      t661 = 1024.D0/3.D0*t660
      t679 = t322*t20
      t680 = 512.D0/3.D0*t679
      t711 = 512.D0/3.D0*t322*t22
      t724 = t253*t20
      t725 = t253*t22
      t740 = t3*s4l1p*t6
      t741 = t618*t740
      t749 = z*t10
      t750 = t233*l3
      t751 = t750*t6
      t762 = t751*s34r
      t765 = t15*s3l1p
      t766 = t549*t765
      t767 = 512.D0/3.D0*t766
      t768 = t22*s3l2p
      t769 = t549*t768
      t770 = 512.D0/3.D0*t769
      t771 = t71*t2
      t785 = t231*t47*t762
      t789 = s4l2p*s4l1p
      t791 = 1024.D0/3.D0*t549*t789
      t815 = t248*t149*t751*t80
      t817 = t489*t149
      t819 = 1024.D0/3.D0*t817*t765
      t821 = 1024.D0/3.D0*t817*t768
      t827 = t106*t765
      t828 = 512.D0/3.D0*t827
      t829 = t106*t768
      t830 = 512.D0/3.D0*t829
      t858 = t27*t2
      t877 = 6*z
      t890 = 1024.D0/3.D0*t106*t789
      t907 = 512.D0/3.D0*t618*t12
      t915 = 512.D0/3.D0*t618*t20
      t925 = t233*t4*t391
      t937 = l3*t3*t47
      t938 = t937*t765
      t939 = t937*t768
      t940 = 2*t71
      t991 = t27*t3*t10
      t1051 = t6*t393
      t1058 = t106*t401
      t1064 = t1*t6*s34r
      t1089 = t71**2
      s3 = ((t18*s2l1+t25*s2l2-t31)*t33+((-t18*s2l1-t25*s2l2+t31)*s23r+(
     #-1024.D0/3.D0*t10*t41*t44+(512.D0/3.D0*t48*t12+512.D0/3.D0*t48*t15
     #)*s34r)*s2l1+(512.D0/3.D0*t48*t20+512.D0/3.D0*t48*t22)*s34r*s2l2+5
     #12.D0/3.D0*t63*t41*t65*s34r)*s1vr-512.D0/3.D0*t71*t10*t41*t43*s23r
     #-512.D0/3.D0*t71*t47*t79*t80)*t85
      s9 = ((-512.D0/3.D0*t90+512.D0/3.D0*t93)*t96+((t98-1024.D0/3.D0*t9
     #3-t103)*s23r+t114*s2l2-1024.D0/3.D0*t117*t118-512.D0/3.D0*t121)*t3
     #3+((-512.D0/3.D0*t90+512.D0/3.D0*t93+512.D0/3.D0*t102)*t127+(t130*
     #s2l2+(1024.D0/3.D0*t132+512.D0/3.D0*t134)*s34r+1024.D0/3.D0*t121+5
     #12.D0/3.D0*t139)*s23r+t147*s2l2+512.D0/3.D0*t151*t152+512.D0/3.D0*
     #t11*t118)*s1vr+(512.D0/3.D0*t111*t7-512.D0/3.D0*t121-512.D0/3.D0*t
     #139)*t127+(512.D0/3.D0*t5*t44+(-512.D0/3.D0*t13-512.D0/3.D0*t16)*s
     #34r)*s23r)*s1l1
      s10 = ((-512.D0/3.D0*t173+512.D0/3.D0*t175)*t96+((1024.D0/3.D0*t17
     #3-1024.D0/3.D0*t175-512.D0/3.D0*t183)*s23r+t114*s2l1-1024.D0/3.D0*
     #t117*t188-512.D0/3.D0*t191)*t33+((-512.D0/3.D0*t173+512.D0/3.D0*t1
     #75+512.D0/3.D0*t183)*t127+(t130*s2l1+(1024.D0/3.D0*t199+512.D0/3.D
     #0*t201)*s34r+1024.D0/3.D0*t191+512.D0/3.D0*t206)*s23r+t147*s2l1+51
     #2.D0/3.D0*t151*t211+512.D0/3.D0*t11*t188)*s1vr+(512.D0/3.D0*t111*t
     #218-512.D0/3.D0*t191-512.D0/3.D0*t206)*t127+(512.D0/3.D0*t5*t43*s2
     #l1+t25*s34r)*s23r)*s1l2
      s8 = s9+s10
      s7 = s8+512.D0/3.D0*t232*t234*t235+(-1024.D0/3.D0*t232*t234*s23r+(
     #-t98+t103)*s2l1+512.D0/3.D0*t244*t22*s2l2+t252-512.D0/3.D0*t254*t3
     #*(2-t255)*t6)*t96+(512.D0/3.D0*t232*t234*t127+(512.D0/3.D0*t244*t2
     #66+512.D0/3.D0*t244*t269-1024.D0/3.D0*t251-512*t253*t71*t3*t6)*s23
     #r+((1024.D0/3.D0*t109-1024.D0/3.D0*t282)*s2l2-512.D0/3.D0*t117*t15
     #*s34r+t293+t295)*s2l1+(-512.D0/3.D0*t117*t22*s34r+512.D0/3.D0*t301
     #+512.D0/3.D0*t302)*s2l2-2560.D0/3.D0*t309+512.D0/3.D0*t11*(-2-t311
     #)*t315+512.D0/3.D0*(2-t318+t319)*t3*t323)*t33
      s6 = s7+(((t98-512.D0/3.D0*t93-t103)*s2l1+512.D0/3.D0*t331*s2l2+t2
     #52+512.D0/3.D0*(-t106*t231+t253*t231*t335)*t6)*t127+(((1024.D0/3.D
     #0*t109+1024.D0/3.D0*t282)*s2l2+t347*s34r-t293-t295)*s2l1+(t352*s34
     #r-512.D0/3.D0*t301-512.D0/3.D0*t302)*s2l2+2048.D0/3.D0*t309+512.D0
     #/3.D0*(z+6)*t10*t4*t315+512.D0/3.D0*t365*t3*t323)*s23r+(1024.D0/3.
     #D0*t289*t4*t44+(-512.D0/3.D0*t374*t107*s3l2p-512.D0/3.D0*t116*t15)
     #*s34r)*s2l1+(-512.D0/3.D0*t374*t107*s3l1p-512.D0/3.D0*t116*t22)*s3
     #4r*s2l2+512*z*t233*t391*t394-512.D0/3.D0*(-4-z)*z*t41*t400*t401-51
     #2.D0/3.D0*(2-t311+6*t71)*z*t4*t410)*s1vr+(512.D0/3.D0*t4*t71*t10*t
     #417-512.D0/3.D0*t419*t3*t71*t1*t6)*t127+(1024.D0/3.D0*t48*t71*t143
     #+2048.D0/3.D0*t430*t4*t410)*s23r+512.D0/3.D0*t71*l3*t149*t394+512.
     #D0/3.D0*(-1+t255)*t71*t10*t41*t6*t80
      s7 = s13r
      s5 = s6*s7
      s8 = 512.D0/3.D0*t449*t12*t235+((512.D0/3.D0*t454-t457-512.D0/3.D0
     #*t458)*s23r+512.D0/3.D0*t462-1024.D0/3.D0*t466-512.D0/3.D0*t468*t4
     #09*s3l2p)*t96+((-t474+t457+t475)*t127+(t484*s2l2+(2048.D0/3.D0*t48
     #7+t493)*s34r+512.D0/3.D0*t497*t92+512.D0/3.D0*t468*t2*s4l2p*t6)*s2
     #3r+t511*s2l2+512.D0/3.D0*t514*t152+512.D0/3.D0*t518*t88*s3l2p*s34r
     #+t524)*t33
      s7 = s8+(512.D0/3.D0*t527*t529+(t535*s2l2+(-1024.D0/3.D0*t487-1024
     #.D0/3.D0*t492)*s34r-512.D0/3.D0*t541*t92-512.D0/3.D0*t544*t101)*t1
     #27+(t558*s2l2+(-512.D0/3.D0*t513*t486-512.D0/3.D0*t513*t233*s4l2p*
     #t6)*t80+(-512.D0/3.D0*t568*t92-512.D0/3.D0*t571*t101)*s34r-1024.D0
     #/3.D0*t523-t578)*s23r+t586*s2l2-512.D0/3.D0*t249*t88*s3l2p*t80-512
     #.D0/3.D0*t506*t118)*s1vr+(-512.D0/3.D0*t596*t7+512.D0/3.D0*t598+51
     #2.D0/3.D0*t599)*t529+(t605*s2l2+(1024.D0/3.D0*t93+1024.D0/3.D0*t10
     #2)*s34r+t524+t578)*t127+(t614*s2l2-t347*t80+(512.D0/3.D0*t618*t291
     #+512.D0/3.D0*t622)*s34r)*s23r
      s8 = s1l1
      s6 = s7*s8
      s4 = s5+s6
      s2 = s3+s4
      s4 = s2
      s7 = 512.D0/3.D0*t449*t20*t235+((512.D0/3.D0*t633-t636-512.D0/3.D0
     #*t637)*s23r+512.D0/3.D0*t322*t172-1024.D0/3.D0*t643-512.D0/3.D0*t4
     #68*t409*s3l1p)*t96+((-1024.D0/3.D0*t633+t636+t651)*t127+(t484*s2l1
     #+(2048.D0/3.D0*t656+t661)*s34r+512.D0/3.D0*t497*t174+512.D0/3.D0*t
     #468*t2*s4l1p*t6)*s23r+t511*s2l1+512.D0/3.D0*t514*t211+512.D0/3.D0*
     #t518*t88*s3l1p*s34r+t680)*t33
      s6 = s7+((512.D0/3.D0*t633-512.D0/3.D0*t635-512.D0/3.D0*t637)*t529
     #+(t535*s2l1+(-1024.D0/3.D0*t656-1024.D0/3.D0*t660)*s34r-512.D0/3.D
     #0*t541*t174-512.D0/3.D0*t544*t182)*t127+(t558*s2l1+(-512.D0/3.D0*t
     #513*t655-512.D0/3.D0*t513*t233*s4l1p*t6)*t80+(-512.D0/3.D0*t568*t1
     #74-512.D0/3.D0*t571*t182)*s34r-1024.D0/3.D0*t679-t711)*s23r+t586*s
     #2l1-512.D0/3.D0*t249*t88*s3l1p*t80-512.D0/3.D0*t506*t188)*s1vr+(-5
     #12.D0/3.D0*t596*t218+512.D0/3.D0*t724+512.D0/3.D0*t725)*t529+(t605
     #*s2l1-1024.D0/3.D0*t331*s34r+t680+t711)*t127+(t614*s2l1-t352*t80+(
     #512.D0/3.D0*t618*t300+512.D0/3.D0*t741)*s34r)*s23r
      s7 = s1l2
      s5 = s6*s7
      s3 = s4+s5
      s1 = s3+(-512.D0/3.D0*t749*t751*s23r+512.D0/3.D0*t449*t266+512.D0/
     #3.D0*t449*t269-1024.D0/3.D0*t3*z*t47*t762-t767-t770-1024.D0/3.D0*t
     #771*t234)*t235+(1024.D0/3.D0*t749*t751*t127+(1024.D0/3.D0*t527*s2l
     #1+(-1024.D0/3.D0*t635-1024.D0/3.D0*t637)*s2l2+2048.D0/3.D0*t785+10
     #24.D0/3.D0*t766+1024.D0/3.D0*t769+(t791+512*t453*z)*t6)*s23r+(1024
     #.D0/3.D0*t462-512.D0/3.D0*t466-512.D0/3.D0*t598-512.D0/3.D0*t253*z
     #*s4l2p*t6)*s2l1+(-512.D0/3.D0*t643-512.D0/3.D0*t724-512.D0/3.D0*t2
     #53*z*s4l1p*t6)*s2l2+2048.D0/3.D0*t815+(t819+t821+2560.D0/3.D0*t231
     #*t449*t6)*s34r+t828+t830-1024.D0/3.D0*t771*t88)*t96
      s4 = s1
      s7 = -512.D0/3.D0*t749*t751*t529+((-t474+512.D0/3.D0*t456+t475)*s2
     #l1+(512.D0/3.D0*t635+t651)*s2l2-1024.D0/3.D0*t785-t767-t770+(-t791
     #+512.D0/3.D0*t453*t63)*t6)*t127+(((-1024.D0/3.D0*t478-1024.D0/3.D0
     #*t596*t6)*s2l2+(512.D0/3.D0*t487+t493)*s34r-512.D0/3.D0*t858*t92+1
     #024.D0/3.D0*t599)*s2l1+((512.D0/3.D0*t656+t661)*s34r-512.D0/3.D0*t
     #858*t174+1024.D0/3.D0*t725)*s2l2-512*t815+(-t819-t821+(-1024.D0/3.
     #D0*t489*t149*s4l2p*s4l1p+512.D0/3.D0*t10*(t877-10)*t231*t233)*t6)*
     #s34r-1024.D0/3.D0*t827-1024.D0/3.D0*t829+(-t890+512.D0/3.D0*(-4+t2
     #55)*z*t596)*t6)*s23r+((-1024.D0/3.D0*t507+1024.D0/3.D0*t323)*s2l2+
     #(512.D0/3.D0*t93+512.D0/3.D0*t581*t621)*s34r-t907+t578)*s2l1
      s6 = s7+((512.D0/3.D0*t175+512.D0/3.D0*t581*t740)*s34r-t915+t711)*
     #s2l2-1024.D0/3.D0*z*t750*t41*t391*t6*t393+(-512.D0/3.D0*t925*t765-
     #512.D0/3.D0*t925*t768+512.D0/3.D0*(-8+t877)*z*t4*t549*t6)*t80+(-51
     #2.D0/3.D0*t938-512.D0/3.D0*t939+512.D0/3.D0*(-4+z+t940)*t3*z*t253*
     #t6)*s34r+512.D0/3.D0*(-2-2*t71+2*z)*t71*t6
      s7 = t33
      s5 = s6*s7
      s3 = s4+s5
      s4 = s3
      s8 = -512.D0/3.D0*t453*t509*t529+((-1024.D0/3.D0*t253*t7+512.D0/3.
     #D0*t106*t12+512.D0/3.D0*t858*t101)*s2l1+(512.D0/3.D0*t106*t20+512.
     #D0/3.D0*t858*t182)*s2l2-512.D0/3.D0*t280*t3*z*t449*t43+t828+t830+(
     #t890-512.D0/3.D0*(t318-4-t319)*z*t596)*t6)*t127+(((-1024.D0/3.D0*t
     #91*t417-1024.D0/3.D0*t323)*s2l2+(512.D0/3.D0*t464*t92+512.D0/3.D0*
     #t991*t101)*s34r+t907-t578)*s2l1+((512.D0/3.D0*t464*t174+512.D0/3.D
     #0*t991*t182)*s34r+t915-t711)*s2l2-512.D0/3.D0*(-5+t877)*z*t4*t549*
     #t401+(512.D0/3.D0*t938+512.D0/3.D0*t939+(1024.D0/3.D0*t464*t100*s4
     #l1p-512.D0/3.D0*(8*z-8-5*t71)*t3*t254)*t6)*s34r-512.D0/3.D0*(z-2-t
     #319)*t71*t6)*s23r+(-1024.D0/3.D0*t506*t44+(512.D0/3.D0*t231*t65*s3
     #l2p-512.D0/3.D0*t622)*s34r)*s2l1
      s7 = s8+(512.D0/3.D0*t231*t65*s3l1p-512.D0/3.D0*t741)*s34r*s2l2-51
     #2.D0/3.D0*(-3+t318)*z*t41*t149*t233*t1051-512.D0/3.D0*(-4+t318-t94
     #0)*z*t4*t1058-512.D0/3.D0*t365*t71*t3*t1064
      s8 = s1vr
      s6 = s7*s8
      s7 = 512.D0/3.D0*t419*t71*t1*t88*t529
      s5 = s6+s7
      s2 = s4+s5
      taux1 = s2+(512.D0/3.D0*(-1-t318)*t71*t3*t253*t43+512.D0/3.D0*t419
     #*t430*t6)*t127+(512.D0/3.D0*(1-t311)*t71*t4*t1058-512*t1089*t3*t10
     #64)*s23r-512.D0/3.D0*t280*t41*t71*t400*t1051-512.D0/3.D0*t280*t4*t
     #430*t409*t80
      t1 = -1+z
      t2 = t1**2
      t3 = t2*t1
      t4 = l3-1
      t5 = t4**2
      t6 = t3*t5
      t7 = 1/s3vr
      t8 = t7*s3l2p
      t10 = s4l2p*t7
      t12 = t6*t8+t6*t10
      t13 = 10240.D0/3.D0*t12
      t14 = s1vr**2
      t18 = t5*t4
      t19 = t3*t18
      t20 = t7*s34r
      t23 = 10240.D0/3.D0*t19*t20*s2l2
      t24 = t2**2
      t25 = t18*t24
      t28 = -t25*t8-t25*t10
      t38 = t5**2
      t39 = t24*t38
      t40 = s34r**2
      t41 = t7*t40
      t45 = t24*t1
      t46 = t45*t38
      t54 = t7*s3l1p
      t56 = s4l1p*t7
      t58 = -t6*t54-t6*t56
      t59 = 10240.D0/3.D0*t58
      t65 = 10240.D0/3.D0*t19*t20*s2l1
      t68 = t25*t54+t25*t56
      t88 = 8192.D0/3.D0*t12
      t90 = 8192.D0/3.D0*t58
      t109 = s13r**2
      t111 = t2*t4
      t112 = l3*t7
      t113 = t112*s2l2
      t115 = 8192.D0/3.D0*t111*t113
      t116 = t4*t3
      t117 = t112*s3l2p
      t118 = t116*t117
      t121 = l3*s4l2p*t7
      t122 = t116*t121
      t125 = t14*s1vr
      t127 = -t4
      t128 = 8*t127
      t129 = t128*t2
      t132 = 10*t127*t3
      t135 = 6*t127*t3
      t140 = l3*t3
      t141 = t5*t7
      t143 = t140*t141*s34r
      t145 = 5*z
      t146 = 4+t145
      t147 = t146*t1
      t148 = t4*t7
      t149 = t147*t148
      t150 = 2048.D0/3.D0*t149
      t151 = -10240*t143+t150
      t153 = t5*t24
      t154 = t153*t117
      t156 = t153*t121
      t160 = 15*z
      t161 = -1+t160
      t162 = t161*t2
      t163 = t148*s3l2p
      t166 = 5-t160
      t167 = t166*t2
      t168 = t4*s4l2p
      t169 = t168*t7
      t177 = s23r**2
      t181 = 20480.D0/3.D0*t143-4096.D0/3.D0*t149
      t183 = t153*l3
      t187 = 20*z
      t188 = 3+t187
      t189 = t188*t2
      t192 = -1+t187
      t193 = t192*t2
      t198 = t112*t40
      t199 = t25*t198
      t202 = t2*t7
      t205 = 2048.D0/3.D0*t192*t5*t202*s34r
      t206 = 4096*t199-t205
      t208 = t18*t45
      t209 = t208*t117
      t211 = t208*t121
      t217 = (-6+30*z)*t3
      t218 = t141*s3l2p
      t221 = t166*t3
      t222 = t5*s4l2p
      t223 = t222*t7
      t231 = 10240.D0/3.D0*t143+t150
      t233 = -t154-t156
      t237 = z*t2
      t238 = t237*t4
      t240 = 4*t111+5*t238
      t241 = t240*t7
      t250 = 20480.D0/3.D0*t199+t205
      t252 = -t209-t211
      t255 = t192*t3
      t265 = t40*s34r
      t269 = t18*t7
      t273 = 10240.D0/3.D0*l3*t45*t38*t7*t265-2048.D0/3.D0*t221*t269*t40
      t275 = t24*t2
      t276 = t38*t275
      t282 = t166*t24
      t293 = t112*s2l1
      t295 = 8192.D0/3.D0*t111*t293
      t296 = t112*s3l1p
      t297 = t116*t296
      t300 = l3*s4l1p*t7
      t301 = t116*t300
      t313 = t153*t296
      t315 = t153*t300
      t319 = t148*s3l1p
      t322 = t4*s4l1p
      t323 = t322*t7
      t345 = t208*t296
      t347 = t208*t300
      t351 = t141*s3l1p
      t354 = t5*s4l1p
      t355 = t354*t7
      t364 = t313+t315
      t376 = t345+t347
      t413 = 4*t4
      t414 = t413*t3
      t416 = 5*t127
      t417 = t416*t3
      t433 = 9*z
      t434 = -t433+4
      t435 = t434*t2
      t437 = 2048.D0/3.D0*t435*t163
      t438 = 10*z
      t439 = 4-t438
      t440 = t439*t2
      t442 = 2048.D0/3.D0*t440*t169
      t450 = 2048.D0/3.D0*t435*t319
      t452 = 2048.D0/3.D0*t440*t323
      t480 = t434*t3
      t482 = t439*t3
      t503 = l3**2
      t504 = t3*t503
      t505 = t14**2
      t509 = t503*t2
      t511 = t509*t7*s2l2
      t512 = 8192.D0/3.D0*t511
      t513 = t504*t8
      t515 = t504*t10
      t519 = t503*t7
      t520 = t519*s34r
      t521 = t116*t520
      t522 = z*t1
      t525 = -8192.D0/3.D0*t521-8192.D0/3.D0*t522*t112
      t527 = t128*t24
      t528 = t519*s3l2p
      t531 = t503*t4
      t538 = 8*z
      t540 = (1-t538)*l3
      t541 = t202*s3l2p
      t544 = l3*t2
      t546 = z*s4l2p*t7
      t547 = t544*t546
      t557 = 4*z
      t562 = 45056.D0/3.D0*t521-2048.D0/3.D0*(-t557+5)*t1*t112
      t565 = 34*t127*t24
      t569 = 12*t127*t24
      t571 = t503*s4l2p*t7
      t572 = t569*t571
      t578 = (2-3*z)*t2
      t585 = t503*t24
      t586 = t141*t40
      t587 = t585*t586
      t592 = t112*s34r
      t596 = t146*z*t7
      t598 = 28672.D0/3.D0*t587-2048.D0/3.D0*(4-t538)*t4*t2*t592-2048.D0
     #/3.D0*t596
      t600 = t5*t45
      t601 = t600*t528
      t603 = t600*t571
      t607 = t140*z
      t611 = -t413*t3
      t617 = (-1+t438)*z
      t618 = t1*t7
      t619 = t618*s3l2p
      t622 = 5-t438
      t623 = t622*z
      t625 = t1*s4l2p*t7
      t633 = t177*s23r
      t642 = 12288*t127*t3*t520+2048.D0/3.D0*(t145+9)*t1*t112
      t645 = 16*t127*t24
      t651 = (5+t438)*t2
      t655 = (1+t438)*t2
      t668 = -16384*t587+2048.D0/3.D0*(8+11*z)*t4*t2*t592+4096.D0/3.D0*t
     #596
      t677 = (-1+22*z)*t4*t3
      t679 = 25*z
      t682 = (-8+t679)*t4*t3
      t688 = (3+t160)*z
      t691 = t161*z
      t699 = 6*z
      t705 = t691*t4
      t707 = t705*t618*s34r
      t709 = -20480.D0/3.D0*t208*t519*t265+2048.D0/3.D0*(t699-1)*t5*t3*t
     #198+2048.D0/3.D0*t707
      t714 = t503*t18
      t724 = (12*z-6)*t5*t24
      t728 = (9-t160)*t5*t24
      t735 = (-6+t187)*z*t4
      t738 = t623*t4
      t740 = t2*s4l2p*t7
      t751 = 4*t544+5*t544*z
      t752 = t751*t7
      t762 = -2048.D0/3.D0*t189*t4*t592-2048.D0/3.D0*t596
      t765 = t188*t4*t3
      t772 = z**2
      t775 = 4*t522+5*t772*t1
      t776 = t775*t7
      t785 = (-6+t679)*t5
      t789 = -2048.D0/3.D0*t785*t3*t198-2048.D0/3.D0*t707
      t791 = t785*t24
      t811 = 2048.D0/3.D0*t622*t24*t18*t112*t265+2048.D0/3.D0*t623*t2*t5
     #86
      t814 = t622*t45*t18
      t820 = t623*t3
      t832 = t509*t7*s2l1
      t833 = 8192.D0/3.D0*t832
      t834 = t504*t54
      t836 = t504*t56
      t842 = t519*s3l1p
      t851 = t202*s3l1p
      t855 = z*s4l1p*t7
      t856 = t544*t855
      t870 = t503*s4l1p*t7
      t871 = t569*t870
      t883 = t600*t842
      t885 = t600*t870
      t895 = t618*s3l1p
      t899 = t1*s4l1p*t7
      t957 = t2*s4l1p*t7
      t1014 = t504*t8*s2l1
      t1016 = t504*t54*s2l2
      t1022 = t10*s3l1p
      t1024 = 2048*t585*t1022
      t1025 = t56*s3l2p
      t1027 = 2048*t585*t1025
      t1030 = t416*t24
      t1032 = 3*t127
      t1033 = t1032*t24
      t1039 = (-3-z)*l3
      t1056 = 2048.D0/3.D0*t607*t1022
      t1058 = 2048.D0/3.D0*t607*t1025
      t1066 = 14*t127*t24
      t1069 = -t1032*t24
      t1074 = 2*z
      t1076 = (6-t1074)*t2
      t1080 = (t538-3)*t2
      t1097 = t1032*t45*t503
      t1111 = (-7+t145)*t4*t3
      t1115 = (-3+t433)*t4*t3
      t1121 = 10240.D0/3.D0*t237*t8
      t1123 = (-4+t145)*t1
      t1125 = 2048.D0/3.D0*t1123*t546
      t1138 = 10240.D0/3.D0*t237*t54
      t1140 = 2048.D0/3.D0*t1123*t855
      t1145 = (-1+t1074)*l3*t24
      t1154 = 2048.D0/3.D0*t237*t1022
      t1156 = 2048.D0/3.D0*t237*t1025
      t1162 = (-3+t557)*t2
      t1177 = (7-t433)*t4*t3
      t1181 = (t433-6)*t4*t3
      t1196 = l3*t4*t24
      t1206 = (-4+t699)*l3*t24
      t1210 = (-3+t145)*l3*t24
      t1215 = t4*z
      t1216 = t3*t7
      t1220 = -t1
      t1224 = t1215*t3
      t1226 = t238-3*t237*t4*t1220+2*t1224
      t1250 = t1220*l3*t45
      s3 = ((t13*t14+(-t13*s23r+t23+20480.D0/3.D0*t28*s34r)*s1vr+(-t23-1
     #0240.D0/3.D0*t28*s34r)*s23r-10240.D0/3.D0*t39*t41*s2l2+(10240.D0/3
     #.D0*t46*t8+10240.D0/3.D0*t46*t10)*t40)*s1l1+(t59*t14+(-t59*s23r-t6
     #5+20480.D0/3.D0*t68*s34r)*s1vr+(t65-10240.D0/3.D0*t68*s34r)*s23r+1
     #0240.D0/3.D0*t39*t41*s2l1+(-10240.D0/3.D0*t46*t54-10240.D0/3.D0*t4
     #6*t56)*t40)*s1l2+(t88*s2l1+t90*s2l2)*t14+((-t88*s2l1-t90*s2l2)*s23
     #r+8192.D0/3.D0*t28*s34r*s2l1+8192.D0/3.D0*t68*s34r*s2l2)*s1vr)*t10
     #9
      s7 = ((t115-22528.D0/3.D0*t118-14336.D0/3.D0*t122)*t125+((2048.D0/
     #3.D0*t129*t113-2048.D0/3.D0*t132*t117-2048.D0/3.D0*t135*t121)*s23r
     #+t151*s2l2+(34816.D0/3.D0*t154+6144*t156)*s34r-2048.D0/3.D0*t162*t
     #163+2048.D0/3.D0*t167*t169)*t14+((t115+2048.D0/3.D0*t118+2048.D0/3
     #.D0*t122)*t177+(t181*s2l2+8192.D0/3.D0*t183*t10*s34r+2048.D0/3.D0*
     #t189*t163+2048.D0/3.D0*t193*t169)*s23r+t206*s2l2+(-2048.D0/3.D0*t2
     #09+2048*t211)*t40+(2048.D0/3.D0*t217*t218-4096.D0/3.D0*t221*t223)*
     #s34r)*s1vr+(t231*s2l2+10240.D0/3.D0*t233*s34r-2048.D0/3.D0*t241*s3
     #l2p-2048.D0/3.D0*t240*s4l2p*t7)*t177+(t250*s2l2+20480.D0/3.D0*t252
     #*t40+(-2048.D0/3.D0*t255*t218-2048.D0/3.D0*t255*t223)*s34r)*s23r+t
     #273*s2l2+(-10240.D0/3.D0*t276*t117-10240.D0/3.D0*t276*t121)*t265+(
     #2048.D0/3.D0*t282*t269*s3l2p+2048.D0/3.D0*t282*t18*s4l2p*t7)*t40)*
     #s1l1
      s8 = ((-t295+22528.D0/3.D0*t297+14336.D0/3.D0*t301)*t125+((-2048.D
     #0/3.D0*t129*t293+2048.D0/3.D0*t132*t296+2048.D0/3.D0*t135*t300)*s2
     #3r-t151*s2l1+(-34816.D0/3.D0*t313-6144*t315)*s34r+2048.D0/3.D0*t16
     #2*t319-2048.D0/3.D0*t167*t323)*t14+((-t295-2048.D0/3.D0*t297-2048.
     #D0/3.D0*t301)*t177+(-t181*s2l1-8192.D0/3.D0*t183*t56*s34r-2048.D0/
     #3.D0*t189*t319-2048.D0/3.D0*t193*t323)*s23r-t206*s2l1+(2048.D0/3.D
     #0*t345-2048*t347)*t40+(-2048.D0/3.D0*t217*t351+4096.D0/3.D0*t221*t
     #355)*s34r)*s1vr+(-t231*s2l1+10240.D0/3.D0*t364*s34r+2048.D0/3.D0*t
     #241*s3l1p+2048.D0/3.D0*t240*s4l1p*t7)*t177+(-t250*s2l1+20480.D0/3.
     #D0*t376*t40+(2048.D0/3.D0*t255*t351+2048.D0/3.D0*t255*t355)*s34r)*
     #s23r-t273*s2l1+(10240.D0/3.D0*t276*t296+10240.D0/3.D0*t276*t300)*t
     #265+(-2048.D0/3.D0*t282*t269*s3l1p-2048.D0/3.D0*t282*t18*s4l1p*t7)
     #*t40)*s1l2
      s6 = s7+s8
      s5 = s6+((-14336.D0/3.D0*t118+4096.D0/3.D0*t122)*s2l1+(14336.D0/3.
     #D0*t297-4096.D0/3.D0*t301)*s2l2)*t125+(((2048.D0/3.D0*t414*t117+20
     #48.D0/3.D0*t417*t121)*s2l1+(-2048.D0/3.D0*t414*t296-2048.D0/3.D0*t
     #417*t300)*s2l2)*s23r+((2048*t154-4096*t156)*s34r+t437+t442)*s2l1+(
     #(-2048*t313+4096*t315)*s34r-t450-t452)*s2l2)*t14+(((2048*t118+2048
     #*t122)*s2l1+(-2048*t297-2048*t301)*s2l2)*t177+((-14336.D0/3.D0*t23
     #3*s34r-t437-t442)*s2l1+(-14336.D0/3.D0*t364*s34r+t450+t452)*s2l2)*
     #s23r+(-8192.D0/3.D0*t252*t40+(-2048.D0/3.D0*t480*t218-2048.D0/3.D0
     #*t482*t223)*s34r)*s2l1+(-8192.D0/3.D0*t376*t40+(2048.D0/3.D0*t480*
     #t351+2048.D0/3.D0*t482*t355)*s34r)*s2l2)*s1vr
      s6 = s13r
      s4 = s5*s6
      s2 = s3+s4
      s3 = s2
      s8 = 2048.D0/3.D0*t504*t8*t505+((-t512+22528.D0/3.D0*t513+6144*t51
     #5)*s23r+t525*s2l2+(-2048.D0/3.D0*t527*t528+4096*t531*t24*s4l2p*t7)
     #*s34r-2048.D0/3.D0*t540*t541+10240.D0/3.D0*t547)*t125
      s9 = s8+((16384.D0/3.D0*t511-10240*t513-8192*t515)*t177+(t562*s2l2
     #+(2048.D0/3.D0*t565*t528+4096.D0/3.D0*t572)*s34r+2048.D0/3.D0*t578
     #*t117-2048*t544*t10)*s23r+t598*s2l2+(-38912.D0/3.D0*t601-8192*t603
     #)*t40+(-4096*t607*t163+2048.D0/3.D0*t611*t121)*s34r+2048.D0/3.D0*t
     #617*t619-2048.D0/3.D0*t623*t625)*t14
      s7 = s9+((-t512+2048*t513+2048*t515)*t633+(t642*s2l2+(-2048.D0/3.D
     #0*t645*t528-2048.D0/3.D0*t572)*s34r-2048.D0/3.D0*t651*t117-2048.D0
     #/3.D0*t655*t121)*t177+(t668*s2l2+(47104.D0/3.D0*t601+10240*t603)*t
     #40+(-2048.D0/3.D0*t677*t117-2048.D0/3.D0*t682*t121)*s34r-2048.D0/3
     #.D0*t688*t619-2048.D0/3.D0*t691*t625)*s23r+t709*s2l2+(20480.D0/3.D
     #0*t18*t275*t528+4096*t714*t275*s4l2p*t7)*t265+(-2048.D0/3.D0*t724*
     #t117+2048.D0/3.D0*t728*t121)*t40+(-2048.D0/3.D0*t735*t541+4096.D0/
     #3.D0*t738*t740)*s34r)*s1vr+(-2048.D0/3.D0*t147*t113+2048.D0/3.D0*t
     #752*s3l2p+2048.D0/3.D0*t751*s4l2p*t7)*t633
      s6 = s7+(t762*s2l2+(2048.D0/3.D0*t765*t117+2048.D0/3.D0*t765*t121)
     #*s34r+2048.D0/3.D0*t776*s3l2p+2048.D0/3.D0*t775*s4l2p*t7)*t177+(t7
     #89*s2l2+(2048.D0/3.D0*t791*t117+2048.D0/3.D0*t791*t121)*t40+(2048.
     #D0/3.D0*t705*t541+2048.D0/3.D0*t705*t740)*s34r)*s23r+t811*s2l2+(-2
     #048.D0/3.D0*t814*t117-2048.D0/3.D0*t814*t121)*t265+(-2048.D0/3.D0*
     #t820*t218-2048.D0/3.D0*t820*t223)*t40
      s7 = s1l1
      s5 = s6*s7
      s9 = -2048.D0/3.D0*t504*t54*t505+((t833-22528.D0/3.D0*t834-6144*t8
     #36)*s23r-t525*s2l1+(2048.D0/3.D0*t527*t842-4096*t531*t24*s4l1p*t7)
     #*s34r+2048.D0/3.D0*t540*t851-10240.D0/3.D0*t856)*t125
      s10 = s9+((-16384.D0/3.D0*t832+10240*t834+8192*t836)*t177+(-t562*s
     #2l1+(-2048.D0/3.D0*t565*t842-4096.D0/3.D0*t871)*s34r-2048.D0/3.D0*
     #t578*t296+2048*t544*t56)*s23r-t598*s2l1+(38912.D0/3.D0*t883+8192*t
     #885)*t40+(4096*t607*t319-2048.D0/3.D0*t611*t300)*s34r-2048.D0/3.D0
     #*t617*t895+2048.D0/3.D0*t623*t899)*t14
      s8 = s10+((t833-2048*t834-2048*t836)*t633+(-t642*s2l1+(2048.D0/3.D
     #0*t645*t842+2048.D0/3.D0*t871)*s34r+2048.D0/3.D0*t651*t296+2048.D0
     #/3.D0*t655*t300)*t177+(-t668*s2l1+(-47104.D0/3.D0*t883-10240*t885)
     #*t40+(2048.D0/3.D0*t677*t296+2048.D0/3.D0*t682*t300)*s34r+2048.D0/
     #3.D0*t688*t895+2048.D0/3.D0*t691*t899)*s23r-t709*s2l1+(-20480.D0/3
     #.D0*t714*t275*t7*s3l1p-4096*t714*t275*s4l1p*t7)*t265+(2048.D0/3.D0
     #*t724*t296-2048.D0/3.D0*t728*t300)*t40+(2048.D0/3.D0*t735*t851-409
     #6.D0/3.D0*t738*t957)*s34r)*s1vr+(2048.D0/3.D0*t147*t293-2048.D0/3.
     #D0*t752*s3l1p-2048.D0/3.D0*t751*s4l1p*t7)*t633
      s7 = s8+(-t762*s2l1+(-2048.D0/3.D0*t765*t296-2048.D0/3.D0*t765*t30
     #0)*s34r-2048.D0/3.D0*t776*s3l1p-2048.D0/3.D0*t775*s4l1p*t7)*t177+(
     #-t789*s2l1+(-2048.D0/3.D0*t791*t296-2048.D0/3.D0*t791*t300)*t40+(-
     #2048.D0/3.D0*t705*t851-2048.D0/3.D0*t705*t957)*s34r)*s23r-t811*s2l
     #1+(2048.D0/3.D0*t814*t296+2048.D0/3.D0*t814*t300)*t265+(2048.D0/3.
     #D0*t820*t351+2048.D0/3.D0*t820*t355)*t40
      s8 = s1l2
      s6 = s7*s8
      s4 = s5+s6
      s1 = s3+s4
      s2 = s1+(2048.D0/3.D0*t1014-2048.D0/3.D0*t1016)*t505
      s3 = s2+((14336.D0/3.D0*t1014-14336.D0/3.D0*t1016+t1024-t1027)*s23
     #r+((-2048.D0/3.D0*t1030*t528+2048.D0/3.D0*t1033*t571)*s34r-2048.D0
     #/3.D0*t1039*t541-8192.D0/3.D0*t547)*s2l1+((2048.D0/3.D0*t1030*t842
     #-2048.D0/3.D0*t1033*t870)*s34r+2048.D0/3.D0*t1039*t851+8192.D0/3.D
     #0*t856)*s2l2-t1056+t1058)*t125
      s4 = s3
      s6 = ((-16384.D0/3.D0*t1014+16384.D0/3.D0*t1016-t1024+t1027)*t177+
     #(((2048.D0/3.D0*t1066*t528+2048.D0/3.D0*t1069*t571)*s34r-2048.D0/3
     #.D0*t1076*t117+2048.D0/3.D0*t1080*t121)*s2l1+((-2048.D0/3.D0*t1066
     #*t842-2048.D0/3.D0*t1069*t870)*s34r+2048.D0/3.D0*t1076*t296-2048.D
     #0/3.D0*t1080*t300)*s2l2+(2048.D0/3.D0*t1097*t1022-2048.D0/3.D0*t10
     #97*t1025)*s34r)*s23r+((-4096*t601+2048*t603)*t40+(2048.D0/3.D0*t11
     #11*t117+2048.D0/3.D0*t1115*t121)*s34r+t1121+t1125)*s2l1+((4096*t88
     #3-2048*t885)*t40+(-2048.D0/3.D0*t1111*t296-2048.D0/3.D0*t1115*t300
     #)*s34r-t1138-t1140)*s2l2+(2048.D0/3.D0*t1145*t168*t54-2048.D0/3.D0
     #*t1145*t322*t8)*s34r-t1154+t1156)*t14
      s7 = (((-2048*t140*t8-2048.D0/3.D0*t1162*t121)*s2l1+(2048*t140*t54
     #+2048.D0/3.D0*t1162*t300)*s2l2+t1056-t1058)*t177+(((2048.D0/3.D0*t
     #1177*t117-2048.D0/3.D0*t1181*t121)*s34r-t1121-t1125)*s2l1+((-2048.
     #D0/3.D0*t1177*t296+2048.D0/3.D0*t1181*t300)*s34r+t1138+t1140)*s2l2
     #+(2048.D0/3.D0*t1196*t1022-2048.D0/3.D0*t1196*t1025)*s34r+t1154-t1
     #156)*s23r+((-2048.D0/3.D0*t1206*t218-2048.D0/3.D0*t1210*t223)*t40+
     #(-10240.D0/3.D0*t1215*t1216*s3l2p-2048.D0/3.D0*t1226*s4l2p*t7)*s34
     #r)*s2l1+((2048.D0/3.D0*t1206*t351+2048.D0/3.D0*t1210*t355)*t40+(10
     #240.D0/3.D0*t1215*t1216*s3l1p+2048.D0/3.D0*t1226*s4l1p*t7)*s34r)*s
     #2l2+(2048.D0/3.D0*t1250*t222*t54-2048.D0/3.D0*t1250*t354*t8)*t40+(
     #2048.D0/3.D0*t1224*t1022-2048.D0/3.D0*t1224*t1025)*s34r)*s1vr
      s5 = s6+s7
      taux2 = s4+s5

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,5.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = -l3+1
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet2 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,7.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = -l3+1
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet4 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      qgrmnum1e2 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcof
     #f4
      RETURN
      END

      double precision function qgrmnum1e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = z*l3
      t2 = -1+z
      t3 = t2**2
      t4 = t2*t3
      t5 = t1*t4
      t6 = l3-1
      t7 = t6**2
      t8 = 1/s3vr
      t9 = t7*t8
      t10 = s1vr**2
      t11 = t10*s1vr
      t18 = t7*t6
      t19 = z*t18
      t20 = t3**2
      t22 = l3*t8
      t24 = t19*t20*t22*s34r
      t26 = t3*z
      t27 = t26*t9
      t34 = t20*t2
      t36 = t7**2
      t38 = s34r**2
      t49 = s13r**2
      t51 = z*t6
      t52 = t51*t4
      t53 = l3**2
      t54 = t53*t8
      t59 = l3*t4*t51*t8
      t63 = s23r**2
      t64 = t54*t63
      t67 = z*t7
      t68 = t67*t20
      t76 = t8*s34r
      t80 = t6*t8
      t85 = t54*s34r
      t90 = t19*t34
      t91 = t54*t38
      t98 = t22*t38
      t107 = z**2
      t108 = t6*t107
      t109 = t2*t8
      t113 = t7*t107
      t121 = t53*l3
      t122 = t121*t8
      t124 = t51*t20*t122*s34r
      t125 = t107*t3
      t126 = t125*t54
      t129 = t10**2
      t135 = t67*t34
      t137 = t135*t122*t38
      t139 = 2*z
      t145 = (-1+t139)*t6*z*t4*t53*t76
      t147 = t107*t2
      t155 = 3*z+t107
      t158 = t2*l3*t8
      t173 = l3*t3
      t176 = t173*t107*t80*s34r
      t182 = t63*s23r
      t205 = t113*t4*t98
      t207 = t109*s34r
      t216 = t107*z
      s1 = (512.D0/3.D0*t5*t9*t11+(-512.D0/3.D0*t5*t9*s23r-1024.D0/3.D0*
     #t24-512.D0/3.D0*t27)*t10+((512.D0/3.D0*t24+512.D0/3.D0*t27)*s23r+5
     #12.D0/3.D0*t1*t34*t36*t8*t38+512.D0/3.D0*t19*t4*t8*s34r)*s1vr)*t49
     #+((-512.D0/3.D0*t52*t54*s23r-512.D0/3.D0*t59)*t11+(512.D0/3.D0*t52
     #*t64+1024.D0/3.D0*t68*t54*s34r*s23r+1024.D0/3.D0*t4*t7*t2*t1*t76+5
     #12.D0/3.D0*t26*t80)*t10+((-512.D0/3.D0*t68*t85+512.D0/3.D0*t59)*t6
     #3+(-512.D0/3.D0*t90*t91+512.D0/3.D0*z*t2*t80)*s23r-512.D0/3.D0*t90
     #*t98-512.D0/3.D0*z*t4*t9*s34r)*s1vr-512.D0/3.D0*t108*t109*t63-512.
     #D0/3.D0*t113*t3*t76*s23r)*s13r+(-512.D0/3.D0*t124+512.D0/3.D0*t126
     #)*t129+((512.D0/3.D0*t124-1024.D0/3.D0*t126)*s23r+1024.D0/3.D0*t13
     #7-512.D0/3.D0*t145-1024.D0/3.D0*t147*t22)*t11
      taux1 = s1+(1024.D0/3.D0*t125*t64+(-512.D0/3.D0*t137+512.D0/3.D0*t
     #145+512.D0/3.D0*t155*z*t158)*s23r-512.D0/3.D0*z*t121*t18*t20*t3*t8
     #*t38*s34r+512.D0/3.D0*t135*t91+512*t176+512.D0/3.D0*t107*t8)*t10+(
     #-512.D0/3.D0*t125*t54*t182+(-512.D0/3.D0*t108*t4*t85-512.D0/3.D0*(
     #t139+t107)*z*t158)*t63+(-512.D0/3.D0*t155*t6*z*t173*t76-512.D0/3.D
     #0*(z+1)*t107*t8)*s23r-512.D0/3.D0*t205-512.D0/3.D0*t108*t207)*s1vr
     #+512.D0/3.D0*t147*t22*t182+(1024.D0/3.D0*t176+512.D0/3.D0*t216*t8)
     #*t63+(512.D0/3.D0*t205+512.D0/3.D0*t6*t216*t207)*s23r
      t1 = -1+z
      t2 = t1**2
      t3 = t2*t1
      t4 = l3-1
      t5 = t4**2
      t6 = t3*t5
      t7 = 1/s3vr
      t8 = t7*s3l2p
      t10 = s4l2p*t7
      t12 = -t6*t8-t6*t10
      t13 = 4096.D0/3.D0*t12
      t14 = s1vr**2
      t18 = t5*t4
      t19 = t3*t18
      t20 = t7*s34r
      t23 = 4096.D0/3.D0*t19*t20*s2l2
      t24 = t2**2
      t25 = t18*t24
      t28 = t25*t8+t25*t10
      t33 = -t28
      t38 = t5**2
      t39 = t24*t38
      t40 = s34r**2
      t41 = t7*t40
      t45 = t24*t1
      t46 = t45*t38
      t54 = t7*s3l1p
      t56 = s4l1p*t7
      t58 = t6*t54+t6*t56
      t59 = 4096.D0/3.D0*t58
      t65 = 4096.D0/3.D0*t19*t20*s2l1
      t68 = -t25*t54-t25*t56
      t73 = -t68
      t89 = -2048.D0/3.D0*t12
      t92 = -2048.D0/3.D0*t58
      t111 = s13r**2
      t113 = t2*t4
      t114 = l3*t7
      t115 = t114*s2l2
      t116 = t113*t115
      t118 = t4*t3
      t119 = t114*s3l2p
      t120 = t118*t119
      t123 = l3*s4l2p*t7
      t124 = t118*t123
      t127 = t14*s1vr
      t129 = 2*t4
      t130 = t129*t2
      t132 = -t129
      t133 = t132*t3
      t135 = -t4
      t136 = t135*t3
      t141 = l3*t3
      t142 = t5*t7
      t144 = t141*t142*s34r
      t146 = 2*z
      t147 = -5-t146
      t148 = t147*t1
      t149 = t4*t7
      t150 = t148*t149
      t151 = 2048.D0/3.D0*t150
      t152 = 8192.D0/3.D0*t144+t151
      t154 = t5*t24
      t155 = t154*l3
      t159 = 6*z
      t160 = -3-t159
      t161 = t160*t2
      t162 = t149*s3l2p
      t166 = -1+3*z
      t167 = t166*t2
      t168 = t4*s4l2p
      t169 = t168*t7
      t178 = s23r**2
      t181 = 4096.D0/3.D0*t144-4096.D0/3.D0*t150
      t183 = t154*t119
      t184 = 4096*t183
      t185 = t154*t123
      t190 = -8-8*z
      t191 = t190*t2
      t194 = 8*z
      t195 = -3-t194
      t196 = t195*t2
      t201 = t114*t40
      t202 = t25*t201
      t204 = t2*t7
      t206 = t195*t5*t204*s34r
      t208 = 2048.D0/3.D0*t202-2048.D0/3.D0*t206
      t210 = t18*t45
      t211 = t210*t119
      t213 = t210*t123
      t217 = 12*z
      t219 = (-1-t217)*t3
      t220 = t142*s3l2p
      t223 = t166*t3
      t225 = t5*s4l2p*t7
      t233 = -4096.D0/3.D0*t144+t151
      t239 = z*t2
      t240 = t239*t4
      t242 = -5*t113-2*t240
      t243 = t242*t7
      t253 = -8192.D0/3.D0*t202+2048.D0/3.D0*t206
      t258 = t195*t3
      t268 = t40*s34r
      t271 = t18*t7
      t275 = -4096.D0/3.D0*l3*t45*t38*t7*t268-4096.D0/3.D0*t223*t271*t40
      t277 = t24*t2
      t278 = t38*t277
      t284 = t166*t24
      t295 = t114*s2l1
      t296 = t113*t295
      t298 = t114*s3l1p
      t299 = t118*t298
      t302 = l3*s4l1p*t7
      t303 = t118*t302
      t318 = t149*s3l1p
      t321 = t4*s4l1p
      t322 = t321*t7
      t334 = t154*t298
      t335 = 4096*t334
      t336 = t154*t302
      t348 = t210*t298
      t350 = t210*t302
      t354 = t142*s3l1p
      t358 = t5*s4l1p*t7
      t407 = 8192.D0/3.D0*t124
      t411 = 8192.D0/3.D0*t303
      t416 = 5*t135
      t417 = t416*t3
      t431 = 4*z
      t432 = 1-t431
      t433 = t432*t2
      t435 = 2048.D0/3.D0*t433*t162
      t436 = -t1
      t437 = t436*t2
      t439 = 2048.D0/3.D0*t437*t169
      t446 = 2048.D0/3.D0*t433*t318
      t448 = 2048.D0/3.D0*t437*t322
      t479 = t432*t3
      t481 = t436*t3
      t503 = l3**2
      t504 = t3*t503
      t505 = t14**2
      t509 = t503*t2
      t511 = t509*t7*s2l2
      t513 = t504*t8
      t514 = 10240.D0/3.D0*t513
      t515 = t504*t10
      t519 = z*t1
      t523 = 6*t135*t24
      t524 = t503*t7
      t525 = t524*s3l2p
      t526 = t523*t525
      t528 = t503*t4
      t531 = t528*t24*s4l2p*t7
      t535 = t436*l3
      t536 = t204*s3l2p
      t539 = l3*t2
      t541 = z*s4l2p*t7
      t542 = t539*t541
      t550 = t524*s34r
      t556 = -4096.D0/3.D0*t118*t550-2048.D0/3.D0*t160*t1*t114
      t559 = 8*t135*t24
      t563 = 3*t4*t24
      t565 = t503*s4l2p*t7
      t571 = (1-t194)*l3
      t575 = 5*t436*t2
      t583 = t114*s34r
      t586 = t147*z*t7
      t588 = -2048.D0/3.D0*(-t146-4)*t4*t2*t583-2048.D0/3.D0*t586
      t590 = t5*t45
      t591 = t590*t525
      t592 = 2048*t591
      t593 = t590*t565
      t599 = (-t159-1)*t4*t3
      t605 = (-3-t431)*z
      t606 = t1*t7
      t607 = t606*s3l2p
      t610 = -1+t146
      t611 = t610*z
      t613 = t1*s4l2p*t7
      t622 = t178*s23r
      t625 = 7*z
      t630 = 2048.D0/3.D0*t133*t550+2048.D0/3.D0*(-8-t625)*t1*t114
      t632 = t132*t24
      t639 = (-5-9*z)*t2
      t645 = t503*t24
      t655 = -2048.D0/3.D0*t645*t142*t40+2048.D0/3.D0*(-t217-10)*t4*t2*t
     #583+4096.D0/3.D0*t586
      t663 = (-5-18*z)*t4*t3
      t668 = (6-15*z)*t4*t3
      t674 = (-8-t159)*z
      t677 = t160*z
      t682 = 5*z
      t687 = t677*t4
      t689 = t687*t606*s34r
      t691 = 2048.D0/3.D0*(-2-t682)*t5*t3*t201+2048.D0/3.D0*t689
      t694 = t503*t18*t277
      t699 = z*t5*t24
      t704 = 3*t1*t5*t24
      t711 = (-1-t194)*z*t4
      t715 = t610*t4*z
      t717 = t2*s4l2p*t7
      t728 = -5*t539-2*t539*z
      t729 = t728*t7
      t739 = -2048.D0/3.D0*t191*t4*t583-2048.D0/3.D0*t586
      t742 = t190*t4*t3
      t749 = z**2
      t752 = -5*t519-2*t749*t1
      t753 = t752*t7
      t763 = (-1-10*z)*t5
      t767 = -2048.D0/3.D0*t763*t3*t201-2048.D0/3.D0*t689
      t769 = t763*t24
      t782 = t610*t18
      t791 = 4096.D0/3.D0*t782*t24*t114*t268+4096.D0/3.D0*t610*t5*z*t204
     #*t40
      t793 = t782*t45
      t799 = t611*t3
      t811 = t509*t7*s2l1
      t813 = t504*t54
      t814 = 10240.D0/3.D0*t813
      t815 = t504*t56
      t821 = t524*s3l1p
      t822 = t523*t821
      t826 = t528*t24*s4l1p*t7
      t830 = t204*s3l1p
      t834 = z*s4l1p*t7
      t835 = t539*t834
      t848 = t503*s4l1p*t7
      t861 = t590*t821
      t862 = 2048*t861
      t863 = t590*t848
      t871 = t606*s3l1p
      t875 = t1*s4l1p*t7
      t926 = t2*s4l1p*t7
      t988 = t10*s3l1p
      t990 = 2048.D0/3.D0*t645*t988
      t991 = t56*s3l2p
      t993 = 2048.D0/3.D0*t645*t991
      t997 = 10240.D0/3.D0*t515
      t1001 = 10240.D0/3.D0*t815
      t1007 = 7*t135*t24
      t1014 = (-3-t146)*l3
      t1031 = t135*t45*t503
      t1039 = (-t146+3)*t3*l3
      t1041 = 2048.D0/3.D0*t1039*t988
      t1043 = 2048.D0/3.D0*t1039*t991
      t1054 = t416*t24
      t1061 = (-z+6)*t2
      t1065 = (-t682-3)*t2
      t1083 = (6-t431)*t3*l3
      t1096 = (-7+t146)*t4*t3
      t1100 = (-t625-3)*t4*t3
      t1106 = 2048*t239*t8
      t1108 = (-t146-1)*t1
      t1110 = 2048.D0/3.D0*t1108*t541
      t1123 = 2048*t239*t54
      t1125 = 2048.D0/3.D0*t1108*t834
      t1129 = t503*t5*t277
      t1137 = (-t431+5)*l3*t24
      t1143 = 2048.D0/3.D0*t1137*t168*t54-2048.D0/3.D0*t1137*t321*t8
      t1146 = 4096.D0/3.D0*t239*t988
      t1148 = 4096.D0/3.D0*t239*t991
      t1165 = 7*t4*t436*t3
      t1169 = (-6-t146)*t4*t3
      t1189 = 2*t1*l3*t24
      t1192 = t1014*t24
      t1197 = t4*z
      t1198 = t3*t7
      t1206 = -3*t240+2*t239*t4*t436
      t1231 = t277*l3*t5
      t1237 = t118*z
      s3 = ((t13*t14+(-t13*s23r-t23+8192.D0/3.D0*t28*s34r)*s1vr+(t23+409
     #6.D0/3.D0*t33*s34r)*s23r+4096.D0/3.D0*t39*t41*s2l2+(-4096.D0/3.D0*
     #t46*t8-4096.D0/3.D0*t46*t10)*t40)*s1l1+(t59*t14+(-t59*s23r+t65+819
     #2.D0/3.D0*t68*s34r)*s1vr+(-t65+4096.D0/3.D0*t73*s34r)*s23r-4096.D0
     #/3.D0*t39*t41*s2l1+(4096.D0/3.D0*t46*t54+4096.D0/3.D0*t46*t56)*t40
     #)*s1l2+(t89*s2l1+t92*s2l2)*t14+((-t89*s2l1-t92*s2l2)*s23r+2048.D0/
     #3.D0*t33*s34r*s2l1+2048.D0/3.D0*t73*s34r*s2l2)*s1vr)*t111
      s9 = (-2048*t116+2048.D0/3.D0*t120+4096.D0/3.D0*t124)*t127+((2048.
     #D0/3.D0*t130*t115-2048.D0/3.D0*t133*t119-2048.D0/3.D0*t136*t123)*s
     #23r+t152*s2l2-4096.D0/3.D0*t155*t10*s34r-2048.D0/3.D0*t161*t162+40
     #96.D0/3.D0*t167*t169)*t14+((2048.D0/3.D0*t116-2048*t120-2048*t124)
     #*t178+(t181*s2l2+(-t184-10240.D0/3.D0*t185)*s34r+2048.D0/3.D0*t191
     #*t162+2048.D0/3.D0*t196*t169)*s23r+t208*s2l2+(-2048*t211-4096.D0/3
     #.D0*t213)*t40+(2048.D0/3.D0*t219*t220-8192.D0/3.D0*t223*t225)*s34r
     #)*s1vr+(t233*s2l2+(4096.D0/3.D0*t183+4096.D0/3.D0*t185)*s34r-2048.
     #D0/3.D0*t243*s3l2p-2048.D0/3.D0*t242*s4l2p*t7)*t178
      s8 = s9+(t253*s2l2+(8192.D0/3.D0*t211+8192.D0/3.D0*t213)*t40+(-204
     #8.D0/3.D0*t258*t220-2048.D0/3.D0*t258*t225)*s34r)*s23r+t275*s2l2+(
     #4096.D0/3.D0*t278*t119+4096.D0/3.D0*t278*t123)*t268+(4096.D0/3.D0*
     #t284*t271*s3l2p+4096.D0/3.D0*t284*t18*s4l2p*t7)*t40
      s9 = s1l1
      s7 = s8*s9
      s10 = (2048*t296-2048.D0/3.D0*t299-4096.D0/3.D0*t303)*t127+((-2048
     #.D0/3.D0*t130*t295+2048.D0/3.D0*t133*t298+2048.D0/3.D0*t136*t302)*
     #s23r-t152*s2l1+4096.D0/3.D0*t155*t56*s34r+2048.D0/3.D0*t161*t318-4
     #096.D0/3.D0*t167*t322)*t14+((-2048.D0/3.D0*t296+2048*t299+2048*t30
     #3)*t178+(-t181*s2l1+(t335+10240.D0/3.D0*t336)*s34r-2048.D0/3.D0*t1
     #91*t318-2048.D0/3.D0*t196*t322)*s23r-t208*s2l1+(2048*t348+4096.D0/
     #3.D0*t350)*t40+(-2048.D0/3.D0*t219*t354+8192.D0/3.D0*t223*t358)*s3
     #4r)*s1vr+(-t233*s2l1+(-4096.D0/3.D0*t334-4096.D0/3.D0*t336)*s34r+2
     #048.D0/3.D0*t243*s3l1p+2048.D0/3.D0*t242*s4l1p*t7)*t178
      s9 = s10+(-t253*s2l1+(-8192.D0/3.D0*t348-8192.D0/3.D0*t350)*t40+(2
     #048.D0/3.D0*t258*t354+2048.D0/3.D0*t258*t358)*s34r)*s23r-t275*s2l1
     #+(-4096.D0/3.D0*t278*t298-4096.D0/3.D0*t278*t302)*t268+(-4096.D0/3
     #.D0*t284*t271*s3l1p-4096.D0/3.D0*t284*t18*s4l1p*t7)*t40
      s10 = s1l2
      s8 = s9*s10
      s6 = s7+s8
      s5 = s6+((4096.D0/3.D0*t120-t407)*s2l1+(-4096.D0/3.D0*t299+t411)*s
     #2l2)*t127+(((2048.D0/3.D0*t417*t119+2048.D0/3.D0*t124)*s2l1+(-2048
     #.D0/3.D0*t417*t298-2048.D0/3.D0*t303)*s2l2)*s23r+((-t184+2048*t185
     #)*s34r+t435+t439)*s2l1+((t335-2048*t336)*s34r-t446-t448)*s2l2)*t14
     #+(((2048*t120+2048*t124)*s2l1+(-2048*t299-2048*t303)*s2l2)*t178+((
     #(14336.D0/3.D0*t183+8192.D0/3.D0*t185)*s34r-t435-t439)*s2l1+((-143
     #36.D0/3.D0*t334-8192.D0/3.D0*t336)*s34r+t446+t448)*s2l2)*s23r+((81
     #92.D0/3.D0*t211+2048.D0/3.D0*t213)*t40+(-2048.D0/3.D0*t479*t220-20
     #48.D0/3.D0*t481*t225)*s34r)*s2l1+((-8192.D0/3.D0*t348-2048.D0/3.D0
     #*t350)*t40+(2048.D0/3.D0*t479*t354+2048.D0/3.D0*t481*t358)*s34r)*s
     #2l2)*s1vr
      s6 = s13r
      s4 = s5*s6
      s2 = s3+s4
      s3 = s2
      s8 = -2048*t504*t8*t505+((2048*t511+t514-2048.D0/3.D0*t515)*s23r-2
     #048.D0/3.D0*t519*t115+(-2048.D0/3.D0*t526-8192.D0/3.D0*t531)*s34r-
     #2048.D0/3.D0*t535*t536-4096.D0/3.D0*t542)*t127
      s9 = s8+((-4096.D0/3.D0*t511-t514-4096.D0/3.D0*t515)*t178+(t556*s2
     #l2+(2048.D0/3.D0*t559*t525+4096.D0/3.D0*t563*t565)*s34r+2048.D0/3.
     #D0*t571*t536+2048.D0/3.D0*t575*t123)*s23r+t588*s2l2+(-t592+16384.D
     #0/3.D0*t593)*t40+(2048.D0/3.D0*t599*t119+t407)*s34r+2048.D0/3.D0*t
     #605*t607-4096.D0/3.D0*t611*t613)*t14
      s7 = s9+((-2048.D0/3.D0*t511+2048*t513+2048*t515)*t622+(t630*s2l2+
     #(-2048.D0/3.D0*t526-2048.D0/3.D0*t632*t565)*s34r-2048.D0/3.D0*t639
     #*t119+6144*t542)*t178+(t655*s2l2+(t592-10240.D0/3.D0*t593)*t40+(-2
     #048.D0/3.D0*t663*t119-2048.D0/3.D0*t668*t123)*s34r-2048.D0/3.D0*t6
     #74*t607-2048.D0/3.D0*t677*t613)*s23r+t691*s2l2-8192.D0/3.D0*t694*t
     #10*t268+(6144*t699*t119+4096.D0/3.D0*t704*t123)*t40+(-2048.D0/3.D0
     #*t711*t536+8192.D0/3.D0*t715*t717)*s34r)*s1vr+(-2048.D0/3.D0*t148*
     #t115+2048.D0/3.D0*t729*s3l2p+2048.D0/3.D0*t728*s4l2p*t7)*t622
      s6 = s7+(t739*s2l2+(2048.D0/3.D0*t742*t119+2048.D0/3.D0*t742*t123)
     #*s34r+2048.D0/3.D0*t753*s3l2p+2048.D0/3.D0*t752*s4l2p*t7)*t178+(t7
     #67*s2l2+(2048.D0/3.D0*t769*t119+2048.D0/3.D0*t769*t123)*t40+(2048.
     #D0/3.D0*t687*t536+2048.D0/3.D0*t687*t717)*s34r)*s23r+t791*s2l2+(-4
     #096.D0/3.D0*t793*t119-4096.D0/3.D0*t793*t123)*t268+(-4096.D0/3.D0*
     #t799*t220-4096.D0/3.D0*t799*t225)*t40
      s7 = s1l1
      s5 = s6*s7
      s9 = 2048*t504*t54*t505+((-2048*t811-t814+2048.D0/3.D0*t815)*s23r+
     #2048.D0/3.D0*t519*t295+(2048.D0/3.D0*t822+8192.D0/3.D0*t826)*s34r+
     #2048.D0/3.D0*t535*t830+4096.D0/3.D0*t835)*t127
      s10 = s9+((4096.D0/3.D0*t811+t814+4096.D0/3.D0*t815)*t178+(-t556*s
     #2l1+(-2048.D0/3.D0*t559*t821-4096.D0/3.D0*t563*t848)*s34r-2048.D0/
     #3.D0*t571*t830-2048.D0/3.D0*t575*t302)*s23r-t588*s2l1+(t862-16384.
     #D0/3.D0*t863)*t40+(-2048.D0/3.D0*t599*t298-t411)*s34r-2048.D0/3.D0
     #*t605*t871+4096.D0/3.D0*t611*t875)*t14
      s8 = s10+((2048.D0/3.D0*t811-2048*t813-2048*t815)*t622+(-t630*s2l1
     #+(2048.D0/3.D0*t822+2048.D0/3.D0*t632*t848)*s34r+2048.D0/3.D0*t639
     #*t298-6144*t835)*t178+(-t655*s2l1+(-t862+10240.D0/3.D0*t863)*t40+(
     #2048.D0/3.D0*t663*t298+2048.D0/3.D0*t668*t302)*s34r+2048.D0/3.D0*t
     #674*t871+2048.D0/3.D0*t677*t875)*s23r-t691*s2l1+8192.D0/3.D0*t694*
     #t56*t268+(-6144*t699*t298-4096.D0/3.D0*t704*t302)*t40+(2048.D0/3.D
     #0*t711*t830-8192.D0/3.D0*t715*t926)*s34r)*s1vr+(2048.D0/3.D0*t148*
     #t295-2048.D0/3.D0*t729*s3l1p-2048.D0/3.D0*t728*s4l1p*t7)*t622
      s7 = s8+(-t739*s2l1+(-2048.D0/3.D0*t742*t298-2048.D0/3.D0*t742*t30
     #2)*s34r-2048.D0/3.D0*t753*s3l1p-2048.D0/3.D0*t752*s4l1p*t7)*t178+(
     #-t767*s2l1+(-2048.D0/3.D0*t769*t298-2048.D0/3.D0*t769*t302)*t40+(-
     #2048.D0/3.D0*t687*t830-2048.D0/3.D0*t687*t926)*s34r)*s23r-t791*s2l
     #1+(4096.D0/3.D0*t793*t298+4096.D0/3.D0*t793*t302)*t268+(4096.D0/3.
     #D0*t799*t354+4096.D0/3.D0*t799*t358)*t40
      s8 = s1l2
      s6 = s7*s8
      s4 = s5+s6
      s1 = s3+s4
      s2 = s1+(-2048*t504*t8*s2l1+2048*t504*t54*s2l2-t990+t993)*t505
      s3 = s2+(((8192.D0/3.D0*t513+t997)*s2l1+(-8192.D0/3.D0*t813-t1001)
     #*s2l2)*s23r+((-2048.D0/3.D0*t1007*t525+4096.D0/3.D0*t531)*s34r-204
     #8.D0/3.D0*t1014*t536+10240.D0/3.D0*t542)*s2l1+((2048.D0/3.D0*t1007
     #*t821-4096.D0/3.D0*t826)*s34r+2048.D0/3.D0*t1014*t830-10240.D0/3.D
     #0*t835)*s2l2+(-4096.D0/3.D0*t1031*t988+4096.D0/3.D0*t1031*t991)*s3
     #4r-t1041+t1043)*t127
      s4 = s3
      s6 = (((-2048.D0/3.D0*t513-t997)*s2l1+(2048.D0/3.D0*t813+t1001)*s2
     #l2+t990-t993)*t178+(((2048.D0/3.D0*t1054*t525+2048.D0/3.D0*t1007*t
     #565)*s34r-2048.D0/3.D0*t1061*t119+2048.D0/3.D0*t1065*t123)*s2l1+((
     #-2048.D0/3.D0*t1054*t821-2048.D0/3.D0*t1007*t848)*s34r+2048.D0/3.D
     #0*t1061*t298-2048.D0/3.D0*t1065*t302)*s2l2+2048.D0/3.D0*t1083*t988
     #-2048.D0/3.D0*t1083*t991)*s23r+((-8192.D0/3.D0*t591-4096.D0/3.D0*t
     #593)*t40+(2048.D0/3.D0*t1096*t119+2048.D0/3.D0*t1100*t123)*s34r+t1
     #106+t1110)*s2l1+((8192.D0/3.D0*t861+4096.D0/3.D0*t863)*t40+(-2048.
     #D0/3.D0*t1096*t298-2048.D0/3.D0*t1100*t302)*s34r-t1123-t1125)*s2l2
     #+(-2048.D0/3.D0*t1129*t988+2048.D0/3.D0*t1129*t991)*t40+t1143*s34r
     #-t1146+t1148)*t14
      s7 = (((-2048*t141*t8+2048*t539*t10)*s2l1+(2048*t141*t54-2048*t539
     #*t56)*s2l2-t1041+t1043)*t178+(((2048.D0/3.D0*t1165*t119-2048.D0/3.
     #D0*t1169*t123)*s34r-t1106-t1110)*s2l1+((-2048.D0/3.D0*t1165*t298+2
     #048.D0/3.D0*t1169*t302)*s34r+t1123+t1125)*s2l2-t1143*s34r+t1146-t1
     #148)*s23r+((-4096.D0/3.D0*t1189*t220-2048.D0/3.D0*t1192*t225)*t40+
     #(-2048*t1197*t1198*s3l2p-2048.D0/3.D0*t1206*s4l2p*t7)*s34r)*s2l1+(
     #(4096.D0/3.D0*t1189*t354+2048.D0/3.D0*t1192*t358)*t40+(2048*t1197*
     #t1198*s3l1p+2048.D0/3.D0*t1206*s4l1p*t7)*s34r)*s2l2+(4096.D0/3.D0*
     #t1231*t988-4096.D0/3.D0*t1231*t991)*t40+(4096.D0/3.D0*t1237*t988-4
     #096.D0/3.D0*t1237*t991)*s34r)*s1vr
      s5 = s6+s7
      taux2 = s4+s5

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,5.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = -l3+1
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet2 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,7.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = -l3+1
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet4 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      qgrmnum1e3 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcof
     #f4
      RETURN
      END

      double precision function qgrmnum1e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux1 = 0
      t1 = -1+z
      t2 = t1**2
      t3 = t2*t1
      t4 = l3-1
      t5 = t4**2
      t6 = t3*t5
      t7 = 1/s3vr
      t8 = t7*s3l2p
      t10 = s4l2p*t7
      t13 = -4096.D0/3.D0*t6*t8-4096.D0/3.D0*t6*t10
      t15 = t7*s3l1p
      t17 = s4l1p*t7
      t20 = 4096.D0/3.D0*t6*t15+4096.D0/3.D0*t6*t17
      t23 = s1vr**2
      t31 = t5*t4
      t32 = t2**2
      t33 = t31*t32
      t49 = s13r**2
      t51 = t2*t4
      t52 = l3*t7
      t53 = t52*s2l2
      t54 = t51*t53
      t55 = t4*t3
      t56 = t52*s3l2p
      t57 = t55*t56
      t60 = t23*s1vr
      t65 = l3*s4l2p*t7
      t66 = t55*t65
      t70 = l3*t3
      t71 = t5*t7
      t73 = t70*t71*s34r
      t75 = t1*t4
      t76 = t75*t7
      t78 = 8192.D0/3.D0*t73+4096.D0/3.D0*t76
      t80 = t5*t32
      t81 = t80*l3
      t82 = t8*s34r
      t85 = t51*t8
      t91 = s23r**2
      t94 = -8192.D0/3.D0*t73-8192.D0/3.D0*t76
      t96 = t80*t56
      t98 = t80*t65
      t103 = t51*t10
      t107 = s34r**2
      t108 = t52*t107
      t110 = t2*t5
      t111 = t7*s34r
      t114 = -4096.D0/3.D0*t33*t108-4096.D0/3.D0*t110*t111
      t116 = t32*t1
      t118 = t31*t116*l3
      t119 = t107*t8
      t126 = t7*s2l2
      t139 = t52*s2l1
      t140 = t51*t139
      t141 = t52*s3l1p
      t142 = t55*t141
      t149 = l3*s4l1p*t7
      t150 = t55*t149
      t156 = t15*s34r
      t159 = t51*t15
      t168 = t80*t141
      t170 = t80*t149
      t175 = t51*t17
      t181 = t15*t107
      t188 = t7*s2l1
      t201 = t57+t66
      t202 = 4096.D0/3.D0*t201
      t204 = -t142-t150
      t205 = 4096.D0/3.D0*t204
      t211 = 2*z
      t212 = -1+t211
      t213 = t212*t2
      t214 = t4*t7
      t215 = t214*s3l2p
      t216 = t213*t215
      t217 = t55*t10
      t223 = t214*s3l1p
      t224 = t213*t223
      t225 = t55*t17
      t255 = t10*t107
      t258 = t212*t3
      t267 = t17*t107
      t282 = l3**2
      t283 = t3*t282
      t284 = t23**2
      t288 = t282*t2
      t289 = t288*t126
      t291 = t283*t8
      t292 = 4096*t291
      t293 = t283*t10
      t294 = 4096.D0/3.D0*t293
      t297 = z*t1
      t300 = t4*t32
      t301 = t300*t282
      t302 = t301*t82
      t304 = z+1
      t305 = t304*l3
      t306 = t2*t7
      t316 = t282*t7
      t319 = 8192.D0/3.D0*t55*t316*s34r
      t320 = t211+1
      t324 = -t319-4096.D0/3.D0*t320*t1*t52
      t326 = t316*s3l2p
      t327 = t300*t326
      t329 = t282*t4
      t332 = t329*t32*s4l2p*t7
      t336 = 3+t211
      t337 = t336*t2
      t343 = 4096.D0/3.D0*t305*t2*s4l2p*t7
      t346 = t4*z
      t347 = t346*t2
      t348 = t52*s34r
      t351 = z*t7
      t352 = 4096.D0/3.D0*t351
      t353 = -8192.D0/3.D0*t347*t348-t352
      t355 = t116*t5
      t356 = t355*t282
      t360 = t320*t4*t3
      t365 = t297*t8
      t366 = 4096.D0/3.D0*t365
      t371 = t91*s23r
      t373 = 2+z
      t377 = t319+4096.D0/3.D0*t373*t1*t52
      t379 = -t327-t332
      t383 = (3+z)*t2
      t386 = t373*t2
      t391 = t282*t32
      t392 = t71*t107
      t401 = 4096.D0/3.D0*t391*t392+8192.D0/3.D0*t304*t4*t2*t348+8192.D0
     #/3.D0*t351
      t411 = t336*t4*t3
      t414 = t373*t4*t3
      t421 = 4096.D0/3.D0*t297*t10
      t428 = t297*t214*s34r
      t430 = 4096.D0/3.D0*z*l3*t3*t392+4096.D0/3.D0*t428
      t433 = z*t5*t32
      t442 = t1*l3
      t444 = l3*t2
      t445 = t444*t8
      t446 = t444*t10
      t452 = -8192.D0/3.D0*t51*t348-t352
      t460 = -4096.D0/3.D0*t6*t108-4096.D0/3.D0*t428
      t465 = z*t2
      t469 = t465*t4*s4l2p*t7
      t480 = t288*t188
      t482 = t283*t15
      t483 = 4096*t482
      t484 = t283*t17
      t485 = 4096.D0/3.D0*t484
      t490 = t301*t156
      t503 = t316*s3l1p
      t504 = t300*t503
      t508 = t329*t32*s4l1p*t7
      t517 = 4096.D0/3.D0*t305*t2*s4l1p*t7
      t528 = t297*t15
      t529 = 4096.D0/3.D0*t528
      t537 = t504+t508
      t562 = 4096.D0/3.D0*t297*t17
      t576 = t444*t15
      t577 = t444*t17
      t595 = t465*t4*s4l1p*t7
      t607 = t10*s3l1p
      t608 = t391*t607
      t609 = t17*s3l2p
      t610 = t391*t609
      t636 = t329*t116
      t640 = -8192.D0/3.D0*t636*t607+8192.D0/3.D0*t636*t609
      t642 = t70*t607
      t643 = 4096.D0/3.D0*t642
      t644 = t70*t609
      t645 = 4096.D0/3.D0*t644
      t662 = (z-2)*t2
      t681 = t304*t4*t3
      t687 = 4096.D0/3.D0*t465*t8
      t695 = 4096.D0/3.D0*t465*t15
      t700 = t282*t5*t32*t2
      t707 = l3*t4*t32
      t711 = 4096.D0/3.D0*t707*t607-4096.D0/3.D0*t707*t609
      t745 = t3*t7
      s3 = ((t13*s2l1+t20*s2l2)*t23+((-t13*s2l1-t20*s2l2)*s23r+(4096.D0/
     #3.D0*t33*t8+4096.D0/3.D0*t33*t10)*s34r*s2l1+(-4096.D0/3.D0*t33*t15
     #-4096.D0/3.D0*t33*t17)*s34r*s2l2)*s1vr)*t49
      s7 = ((-4096.D0/3.D0*t54+4096.D0/3.D0*t57)*t60+((8192.D0/3.D0*t54-
     #8192.D0/3.D0*t57-4096.D0/3.D0*t66)*s23r+t78*s2l2-8192.D0/3.D0*t81*
     #t82-4096.D0/3.D0*t85)*t23+((-4096.D0/3.D0*t54+4096.D0/3.D0*t57+409
     #6.D0/3.D0*t66)*t91+(t94*s2l2+(8192.D0/3.D0*t96+4096.D0/3.D0*t98)*s
     #34r+8192.D0/3.D0*t85+4096.D0/3.D0*t103)*s23r+t114*s2l2+4096.D0/3.D
     #0*t118*t119+4096.D0/3.D0*t6*t82)*s1vr+(4096.D0/3.D0*t75*t126-4096.
     #D0/3.D0*t85-4096.D0/3.D0*t103)*t91+(4096.D0/3.D0*t110*t111*s2l2+t1
     #3*s34r)*s23r)*s1l1
      s8 = ((4096.D0/3.D0*t140-4096.D0/3.D0*t142)*t60+((-8192.D0/3.D0*t1
     #40+8192.D0/3.D0*t142+4096.D0/3.D0*t150)*s23r-t78*s2l1+8192.D0/3.D0
     #*t81*t156+4096.D0/3.D0*t159)*t23+((4096.D0/3.D0*t140-4096.D0/3.D0*
     #t142-4096.D0/3.D0*t150)*t91+(-t94*s2l1+(-8192.D0/3.D0*t168-4096.D0
     #/3.D0*t170)*s34r-8192.D0/3.D0*t159-4096.D0/3.D0*t175)*s23r-t114*s2
     #l1-4096.D0/3.D0*t118*t181-4096.D0/3.D0*t6*t156)*s1vr+(-4096.D0/3.D
     #0*t75*t188+4096.D0/3.D0*t159+4096.D0/3.D0*t175)*t91+(-4096.D0/3.D0
     #*t110*t111*s2l1+t20*s34r)*s23r)*s1l2
      s6 = s7+s8
      s5 = s6+((t202*s2l1+t205*s2l2)*s23r+(4096.D0/3.D0*t81*t10*s34r+409
     #6.D0/3.D0*t216+4096.D0/3.D0*t217)*s2l1+(-4096.D0/3.D0*t81*t17*s34r
     #-4096.D0/3.D0*t224-4096.D0/3.D0*t225)*s2l2)*t23+((-t202*s2l1-t205*
     #s2l2)*t91+(((-4096.D0/3.D0*t96-8192.D0/3.D0*t98)*s34r-4096.D0/3.D0
     #*t216-4096.D0/3.D0*t217)*s2l1+((4096.D0/3.D0*t168+8192.D0/3.D0*t17
     #0)*s34r+4096.D0/3.D0*t224+4096.D0/3.D0*t225)*s2l2)*s23r+(-4096.D0/
     #3.D0*t118*t255+(-4096.D0/3.D0*t258*t71*s3l2p-4096.D0/3.D0*t80*t10)
     #*s34r)*s2l1+(4096.D0/3.D0*t118*t267+(4096.D0/3.D0*t258*t71*s3l1p+4
     #096.D0/3.D0*t80*t17)*s34r)*s2l2)*s1vr
      s6 = s13r
      s4 = s5*s6
      s2 = s3+s4
      s3 = s2
      s7 = 4096.D0/3.D0*t283*t8*t284+((4096.D0/3.D0*t289-t292-t294)*s23r
     #+4096.D0/3.D0*t297*t53-8192.D0/3.D0*t302-4096.D0/3.D0*t305*t306*s3
     #l2p)*t60+((-8192.D0/3.D0*t289+t292+8192.D0/3.D0*t293)*t91+(t324*s2
     #l2+(16384.D0/3.D0*t327+8192.D0/3.D0*t332)*s34r+4096.D0/3.D0*t337*t
     #56+t343)*s23r+t353*s2l2+4096.D0/3.D0*t356*t119+4096.D0/3.D0*t360*t
     #52*s3l2p*s34r+t366)*t23
      s6 = s7+((4096.D0/3.D0*t289-4096.D0/3.D0*t291-4096.D0/3.D0*t293)*t
     #371+(t377*s2l2+8192.D0/3.D0*t379*s34r-4096.D0/3.D0*t383*t56-4096.D
     #0/3.D0*t386*t65)*t91+(t401*s2l2+(-4096.D0/3.D0*t355*t326-4096.D0/3
     #.D0*t355*t282*s4l2p*t7)*t107+(-4096.D0/3.D0*t411*t56-4096.D0/3.D0*
     #t414*t65)*s34r-8192.D0/3.D0*t365-t421)*s23r+t430*s2l2-4096.D0/3.D0
     #*t433*t52*s3l2p*t107-4096.D0/3.D0*t347*t82)*s1vr+(-4096.D0/3.D0*t4
     #42*t126+4096.D0/3.D0*t445+4096.D0/3.D0*t446)*t371+(t452*s2l2+8192.
     #D0/3.D0*t201*s34r+t366+t421)*t91+(t460*s2l2+(4096.D0/3.D0*t96+4096
     #.D0/3.D0*t98)*t107+(4096.D0/3.D0*t465*t215+4096.D0/3.D0*t469)*s34r
     #)*s23r
      s7 = s1l1
      s5 = s6*s7
      s8 = -4096.D0/3.D0*t283*t15*t284+((-4096.D0/3.D0*t480+t483+t485)*s
     #23r-4096.D0/3.D0*t297*t139+8192.D0/3.D0*t490+4096.D0/3.D0*t305*t30
     #6*s3l1p)*t60+((8192.D0/3.D0*t480-t483-8192.D0/3.D0*t484)*t91+(-t32
     #4*s2l1+(-16384.D0/3.D0*t504-8192.D0/3.D0*t508)*s34r-4096.D0/3.D0*t
     #337*t141-t517)*s23r-t353*s2l1-4096.D0/3.D0*t356*t181-4096.D0/3.D0*
     #t360*t52*s3l1p*s34r-t529)*t23
      s7 = s8+((-4096.D0/3.D0*t480+4096.D0/3.D0*t482+4096.D0/3.D0*t484)*
     #t371+(-t377*s2l1+8192.D0/3.D0*t537*s34r+4096.D0/3.D0*t383*t141+409
     #6.D0/3.D0*t386*t149)*t91+(-t401*s2l1+(4096.D0/3.D0*t355*t503+4096.
     #D0/3.D0*t355*t282*s4l1p*t7)*t107+(4096.D0/3.D0*t411*t141+4096.D0/3
     #.D0*t414*t149)*s34r+8192.D0/3.D0*t528+t562)*s23r-t430*s2l1+4096.D0
     #/3.D0*t433*t52*s3l1p*t107+4096.D0/3.D0*t347*t156)*s1vr+(4096.D0/3.
     #D0*t442*t188-4096.D0/3.D0*t576-4096.D0/3.D0*t577)*t371+(-t452*s2l1
     #+8192.D0/3.D0*t204*s34r-t529-t562)*t91+(-t460*s2l1+(-4096.D0/3.D0*
     #t168-4096.D0/3.D0*t170)*t107+(-4096.D0/3.D0*t465*t223-4096.D0/3.D0
     #*t595)*s34r)*s23r
      s8 = s1l2
      s6 = s7*s8
      s4 = s5+s6
      s1 = s3+s4
      s2 = s1+(4096.D0/3.D0*t283*t8*s2l1-4096.D0/3.D0*t283*t15*s2l2+4096
     #.D0/3.D0*t608-4096.D0/3.D0*t610)*t284
      s3 = s2+(((-8192.D0/3.D0*t291-t294)*s2l1+(8192.D0/3.D0*t482+t485)*
     #s2l2-8192.D0/3.D0*t608+8192.D0/3.D0*t610)*s23r+(-4096.D0/3.D0*t302
     #-4096.D0/3.D0*t445-4096.D0/3.D0*t444*z*s4l2p*t7)*s2l1+(4096.D0/3.D
     #0*t490+4096.D0/3.D0*t576+4096.D0/3.D0*t444*z*s4l1p*t7)*s2l2+t640*s
     #34r-t643+t645)*t60
      s4 = s3
      s6 = (((4096.D0/3.D0*t291+4096.D0/3.D0*t293)*s2l1+(-4096.D0/3.D0*t
     #482-4096.D0/3.D0*t484)*s2l2+4096.D0/3.D0*t608-4096.D0/3.D0*t610)*t
     #91+((-4096.D0/3.D0*t379*s34r-4096.D0/3.D0*t662*t56+t343)*s2l1+(-40
     #96.D0/3.D0*t537*s34r+4096.D0/3.D0*t662*t141-t517)*s2l2-t640*s34r+8
     #192.D0/3.D0*t642-8192.D0/3.D0*t644)*s23r+((4096.D0/3.D0*t57+4096.D
     #0/3.D0*t681*t65)*s34r-t687+t421)*s2l1+((-4096.D0/3.D0*t142-4096.D0
     #/3.D0*t681*t149)*s34r+t695-t562)*s2l2+(4096.D0/3.D0*t700*t607-4096
     #.D0/3.D0*t700*t609)*t107+t711*s34r)*t23
      s7 = (((4096.D0/3.D0*t70*t8-4096.D0/3.D0*t446)*s2l1+(-4096.D0/3.D0
     #*t70*t15+4096.D0/3.D0*t577)*s2l2-t643+t645)*t91+(((4096.D0/3.D0*t3
     #00*t56-8192.D0/3.D0*t66)*s34r+t687-t421)*s2l1+((-4096.D0/3.D0*t300
     #*t141+8192.D0/3.D0*t150)*s34r-t695+t562)*s2l2-t711*s34r)*s23r+(-40
     #96.D0/3.D0*t81*t255+(4096.D0/3.D0*t346*t745*s3l2p-4096.D0/3.D0*t46
     #9)*s34r)*s2l1+(4096.D0/3.D0*t81*t267+(-4096.D0/3.D0*t346*t745*s3l1
     #p+4096.D0/3.D0*t595)*s34r)*s2l2)*s1vr
      s5 = s6+s7
      taux2 = s4+s5

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,5.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = -l3+1
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet2 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,7.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = -l3+1
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet4 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      qgrmnum1e4 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcof
     #f4
      RETURN
      END

      double precision function qgrmnum2e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = t1**2
      t3 = l3-1
      t4 = t3**2
      t5 = t2*t4
      t6 = 1/s3vr
      t7 = t6*s2l2
      t8 = t5*t7
      t10 = t2*t1
      t11 = t10*t4
      t12 = t6*s3l2p
      t13 = t11*t12
      t14 = 384*t13
      t15 = s4l2p*t6
      t16 = t11*t15
      t17 = 192*t16
      t19 = s1vr**2
      t24 = t4*t3
      t25 = t10*t24
      t26 = t6*s34r
      t27 = t26*s2l2
      t28 = t25*t27
      t29 = 384*t28
      t30 = t2**2
      t31 = t24*t30
      t32 = t31*t12
      t34 = t31*t15
      t46 = t4**2
      t47 = t30*t46
      t48 = s34r**2
      t49 = t6*t48
      t53 = t30*t1
      t54 = t53*t46
      t62 = t6*s2l1
      t63 = t5*t62
      t65 = t6*s3l1p
      t66 = t11*t65
      t67 = 384*t66
      t68 = s4l1p*t6
      t69 = t11*t68
      t70 = 192*t69
      t76 = t26*s2l1
      t77 = t25*t76
      t79 = t31*t65
      t81 = t31*t68
      t103 = z*l3
      t104 = t103*t10
      t105 = t4*t6
      t106 = t19*s1vr
      t114 = z*t24
      t115 = t114*t30
      t116 = l3*t6
      t117 = t116*s34r
      t120 = t30*t4
      t127 = t68*s3l2p
      t148 = t46*t6
      t152 = t53*t24
      t166 = s13r**2
      t168 = t3*t2
      t172 = l3*t10
      t173 = t105*s34r
      t174 = t172*t173
      t178 = t172*t4
      t181 = t116*t48
      t182 = t31*t181
      t188 = t3*t10
      t189 = t188*l3
      t194 = t168*t116*s2l2
      t196 = t116*s3l2p
      t197 = t188*t196
      t198 = 192*t197
      t199 = l3*s4l2p
      t200 = t199*t6
      t202 = 192*t188*t200
      t205 = t178*t27
      t207 = t120*t196
      t209 = t120*t200
      t213 = 4*z
      t214 = 2-t213
      t215 = t214*t3
      t216 = t2*t6
      t217 = t216*s3l2p
      t220 = 2*z
      t221 = -1+t220
      t222 = t221*t3
      t223 = t2*s4l2p
      t224 = t223*t6
      t231 = s23r**2
      t234 = -t221
      t236 = t1*t6
      t239 = -960*t174-192*t234*t3*t236
      t245 = 5*z
      t246 = 3-t245
      t247 = t246*t3
      t254 = 6*z
      t255 = 1-t254
      t259 = -192*t182-192*t255*t2*t173
      t261 = t152*t196
      t263 = t152*t200
      t268 = (-2+t245)*t10
      t269 = t105*s3l2p
      t272 = 8*z
      t274 = (4-t272)*t10
      t276 = t4*s4l2p*t6
      t286 = -576*t174-192*t168*t6
      t288 = t207+t209
      t292 = 192*t188*t12
      t294 = 192*t188*t15
      t299 = 2-7*z
      t303 = -960*t182+192*t299*t2*t173
      t305 = t261+t263
      t308 = t299*t6
      t319 = l3*t53
      t320 = t48*s34r
      t321 = t148*t320
      t324 = 3-t254
      t326 = t24*t6
      t330 = -384*t319*t321+192*t324*t10*t326*t48
      t332 = t30*t2
      t333 = t46*t332
      t339 = t324*t30
      t340 = t326*s3l2p
      t343 = t24*s4l2p*t6
      t354 = t168*t116*s2l1
      t356 = t116*s3l1p
      t357 = t188*t356
      t358 = 192*t357
      t360 = l3*s4l1p*t6
      t362 = 192*t188*t360
      t367 = t120*t356
      t369 = t120*t360
      t373 = t216*s3l1p
      t377 = t2*s4l1p*t6
      t397 = t152*t356
      t399 = t152*t360
      t403 = t105*s3l1p
      t407 = t4*s4l1p*t6
      t415 = t367+t369
      t419 = 192*t188*t65
      t421 = 192*t188*t68
      t425 = t397+t399
      t444 = t326*s3l1p
      t447 = t24*s4l1p*t6
      t454 = t3*z
      t455 = t454*t10
      t456 = l3**2
      t457 = t456*t6
      t461 = t12*s2l1
      t464 = t65*s2l2
      t467 = z*t4
      t468 = t467*t30
      t469 = t457*s34r
      t470 = t468*t469
      t472 = t3*t30
      t473 = t472*t196
      t475 = t472*t200
      t481 = l3*t3*t30*t127
      t483 = l3*t2
      t484 = z**2
      t487 = t483*t484*t3*t6
      t502 = 3*z
      t503 = 2-t502
      t510 = t120*l3
      t511 = t12*s34r
      t514 = t221*t2
      t515 = t3*t6
      t516 = t515*s3l2p
      t521 = t65*s34r
      t524 = t515*s3l1p
      t531 = t114*t53*t457*t48
      t533 = t4*t53
      t534 = t533*t196
      t536 = t319*t276
      t541 = t533*l3*t127
      t549 = 1+t502
      t552 = t10*t6*s3l2p
      t555 = t10*s4l2p*t6
      t563 = s4l2p*s4l1p*t6
      t590 = z+1
      t591 = t590*t3
      t613 = z*t10
      t616 = 4*t1
      t617 = t616*t10
      t635 = z*t456
      t662 = t456*t2
      t663 = t6*t231
      t666 = t188*t469
      t668 = t1*z
      t669 = t668*t116
      t673 = t456*t30
      t674 = t105*t48
      t675 = t673*t674
      t676 = 576*t675
      t677 = -t502+1
      t678 = t677*t3
      t692 = t152*t457*t320
      t702 = t10*t456
      t706 = t472*t456
      t707 = t706*t511
      t709 = -t1
      t710 = t709*l3
      t711 = t710*t217
      t725 = -768*t666-384*t669
      t727 = t457*s3l2p
      t728 = t472*t727
      t730 = t456*t3
      t733 = t730*t30*s4l2p*t6
      t738 = -t616*t2
      t753 = -672*t675+192*t677*t3*t2*t117
      t755 = t533*t727
      t759 = t533*t456*s4l2p*t6
      t763 = t678*t10
      t772 = t231*s23r
      t778 = 960*t666-192*t669
      t783 = t246*t2
      t786 = t677*t2
      t796 = 1248*t675-192*t168*t117-384*t484*t6
      t804 = (12-20*z)*t3*t10
      t806 = -t254+8
      t808 = t806*t3*t10
      t813 = 2*t484
      t815 = (1-z-t813)*t1
      t832 = t236*s34r
      t835 = 480*t692-192*t590*t4*t10*t181+192*(-3*t484-1+t220)*t3*t832
      t839 = t456*t24
      t849 = (6-9*z)*t4*t30
      t853 = (6-t220)*t4*t30
      t860 = (-1+t213-4*t484)*t3
      t862 = -3+t213
      t864 = t862*z*t3
      t872 = t172*t12
      t873 = t172*t15
      t881 = -192*t247*t2*t117+192*t668*t6
      t883 = t247*t10
      t889 = z*t2
      t893 = 192*t889*t15
      t897 = (5-t272)*t4
      t901 = t214*z*t3
      t904 = -192*t897*t10*t181-192*t901*t832
      t906 = t897*t30
      t919 = -t862
      t920 = t919*l3
      t922 = t326*t320
      t924 = t919*z
      t928 = -192*t920*t30*t922-192*t924*t2*t674
      t930 = t920*t53
      t936 = t924*t10
      t947 = t706*t521
      t949 = t710*t373
      t962 = t457*s3l1p
      t963 = t472*t962
      t967 = t730*t30*s4l1p*t6
      t980 = t533*t962
      t984 = t533*t456*s4l1p*t6
      t1091 = s3l2p*s3l1p
      t1092 = t19**2
      t1097 = 192*t702*t461
      t1099 = 192*t702*t464
      t1102 = t456*l3*t6
      t1105 = 288*t454*t30*t1102*s34r
      t1130 = 192*t873
      t1134 = 192*t172*t127
      t1151 = -t503*t2
      t1171 = t702*t26
      t1177 = t709*t10
      t1185 = z-t484
      t1188 = t1*l3*t6
      t1205 = t1185*t1
      t1269 = (3-z)*t3*t10
      t1273 = t709*t3*t10
      t1279 = (-2+t213-t813)*t1
      t1282 = t709*t1
      t1308 = t199*s4l1p
      t1325 = (-3+t220)*t2
      t1339 = t590*t4*t30
      t1343 = t709*t4*t30
      t1350 = (2*z+2*t484-2)*t3
      t1354 = (z-t484-1)*t3
      t1399 = (-t220-4)*t3
      s4 = ((-192*t8-t14-t17)*t19+((192*t8+192*t13+192*t16)*s23r-t29+(76
     #8*t32+576*t34)*s34r)*s1vr+(576*t28+(-576*t32-576*t34)*s34r)*s23r+3
     #84*t47*t49*s2l2+(-384*t54*t12-384*t54*t15)*t48)*s1l1+((-192*t63-t6
     #7-t70)*t19+((192*t63+192*t66+192*t69)*s23r-384*t77+(768*t79+576*t8
     #1)*s34r)*s1vr+(576*t77+(-576*t79-576*t81)*s34r)*s23r+384*t47*t49*s
     #2l1+(-384*t54*t65-384*t54*t68)*t48)*s1l2+192*t104*t105*t106+((-t14
     #-t17)*s2l1+(-t67-t70)*s2l2+192*t115*t117+(384*t120*t12+192*t120*t1
     #5)*s3l1p+192*t120*t127)*t19+(-768*t115*t116*s34r*s23r+(-t29+(384*t
     #32+192*t34)*s34r)*s2l1+(384*t79+192*t81)*s34r*s2l2-384*t103*t53*t1
     #48*t48+((-384*t152*t12-192*t152*t15)*s3l1p-192*t152*t127)*s34r)*s1
     #vr
      s5 = t166
      s3 = s4*s5
      s7 = (((384*t168*t116*s23r+768*t174)*t19+(-768*t178*t26*s23r-768*t
     #182)*s1vr)*s1l2+576*t189*t12*t106+((576*t194-t198-t202)*s23r+960*t
     #205+(-768*t207-480*t209)*s34r-192*t215*t217+192*t222*t224)*t19+((-
     #384*t194-t198-t202)*t231+(t239*s2l2+(-480*t207+96*t209)*s34r+192*t
     #247*t217+192*t215*t224)*s23r+t259*s2l2+(-192*t261+96*t263)*t48+(-3
     #84*t268*t269+192*t274*t276)*s34r)*s1vr+(t286*s2l2+576*t288*s34r+t2
     #92+t294)*t231+(t303*s2l2+960*t305*t48+(-192*t11*t308*s3l2p-192*t11
     #*t299*s4l2p*t6)*s34r)*s23r+t330*s2l2+(384*t333*t196+384*t333*t200)
     #*t320+(-192*t339*t340-192*t339*t343)*t48)*s1l1
      s8 = (576*t189*t65*t106+((576*t354-t358-t362)*s23r+960*t178*t76+(-
     #768*t367-480*t369)*s34r-192*t215*t373+192*t222*t377)*t19+((-384*t3
     #54-t358-t362)*t231+(t239*s2l1+(-480*t367+96*t369)*s34r+192*t247*t3
     #73+192*t215*t377)*s23r+t259*s2l1+(-192*t397+96*t399)*t48+(-384*t26
     #8*t403+192*t274*t407)*s34r)*s1vr+(t286*s2l1+576*t415*s34r+t419+t42
     #1)*t231+(t303*s2l1+960*t425*t48+(-192*t11*t308*s3l1p-192*t11*t299*
     #s4l1p*t6)*s34r)*s23r+t330*s2l1+(384*t333*t356+384*t333*t360)*t320+
     #(-192*t339*t444-192*t339*t447)*t48)*s1l2
      s6 = s7+s8
      s7 = s6+(-192*t455*t457*s23r+192*t189*t461+192*t189*t464-480*t470+
     #(-768*t473-384*t475)*s3l1p-384*t481+192*t487)*t106
      s8 = s7
      s10 = (-192*t455*t457*t231+((576*t197+t202)*s2l1+(576*t357+t362)*s
     #2l2+864*t470+192*t483*z*t3*t503*t6)*s23r+(-288*t510*t511+192*t514*
     #t516+t294)*s2l1+(-288*t510*t521+192*t514*t524+t421)*s2l2+384*t531+
     #((768*t534+384*t536)*s3l1p+384*t541-960*t484*t4*t172*t6)*s34r+(-38
     #4*t549*t3*t552-384*t454*t555)*s3l1p-384*t455*t127+384*t188*t563)*t
     #19
      s11 = (192*t468*t457*s34r*t231+((384*t205-192*t288*s34r+t292)*s2l1
     #+(-192*t415*s34r+t419)*s2l2+288*t531-96*t11*(-16*z-2)*t103*t26+(38
     #4*t591*t552+192*t591*t555)*s3l1p+192*t591*t10*t127)*s23r+((384*t18
     #2+384*t2*t1*t173)*s2l2-192*t305*t48+(-768*t613*t269-96*t617*t276)*
     #s34r)*s2l1+(-192*t425*t48+(-768*t613*t403-96*t617*t407)*s34r)*s2l2
     #+96*t635*t332*t321-96*(-t272+2)*l3*z*t31*t49+((384*t549*t30*t269+3
     #84*z*t30*t276)*s3l1p+384*t468*t127-384*t120*t563)*s34r)*s1vr
      s9 = s10+s11
      s5 = s8+s9
      s6 = s13r
      s4 = s5*s6
      s2 = s3+s4
      s3 = s2
      s8 = ((-384*t662*t663+(-384*t666-768*t669)*s23r-t676+384*t678*t2*t
     #117)*t19+(384*t483*t663+(t676-384*t215*t2*t117)*s23r+576*t692-384*
     #t677*t4*t10*t181)*s1vr)*s1l2+(-576*t702*t12*s23r-384*t707-192*t711
     #)*t106
      s7 = s8+((-384*t662*t7+576*t702*t12+384*t702*t15)*t231+(t725*s2l2+
     #(1536*t728+672*t733)*s34r+192*t738*t196+192*t483*z*s4l2p*t6)*s23r+
     #t753*s2l2+(960*t755+576*t759)*t48+(96*t763*t196-192*t763*t200)*s34
     #r)*t19+(192*t662*t7*t772+(t778*s2l2+(-480*t728-480*t733)*s34r-192*
     #t783*t196-192*t786*t200)*t231+(t796*s2l2+(-1056*t755-1056*t759)*t4
     #8+(-96*t804*t196-96*t808*t200)*s34r-192*t815*t12-192*t815*t15)*s23
     #r+t835*s2l2+(-576*t24*t332*t727-576*t839*t332*s4l2p*t6)*t320+(-96*
     #t849*t196-96*t853*t200)*t48+(-192*t860*t217+192*t864*t224)*s34r)*s
     #1vr+(192*t483*t7-192*t872-192*t873)*t772
      s6 = s7+(t881*s2l2+(192*t883*t196+192*t883*t200)*s34r-192*t889*t12
     #-t893)*t231+(t904*s2l2+(192*t906*t196+192*t906*t200)*t48+(192*t901
     #*t217+192*t901*t224)*s34r)*s23r+t928*s2l2+(192*t930*t340+192*t930*
     #t343)*t320+(192*t936*t269+192*t936*t276)*t48
      s7 = s1l1
      s5 = s6*s7
      s8 = (-576*t702*t65*s23r-384*t947-192*t949)*t106+((-384*t662*t62+5
     #76*t702*t65+384*t702*t68)*t231+(t725*s2l1+(1536*t963+672*t967)*s34
     #r+192*t738*t356+192*t483*z*s4l1p*t6)*s23r+t753*s2l1+(960*t980+576*
     #t984)*t48+(96*t763*t356-192*t763*t360)*s34r)*t19+(192*t662*t62*t77
     #2+(t778*s2l1+(-480*t963-480*t967)*s34r-192*t783*t356-192*t786*t360
     #)*t231+(t796*s2l1+(-1056*t980-1056*t984)*t48+(-96*t804*t356-96*t80
     #8*t360)*s34r-192*t815*t65-192*t815*t68)*s23r+t835*s2l1+(-576*t839*
     #t332*t6*s3l1p-576*t839*t332*s4l1p*t6)*t320+(-96*t849*t356-96*t853*
     #t360)*t48+(-192*t860*t373+192*t864*t377)*s34r)*s1vr+(192*t483*t62-
     #192*t172*t65-192*t172*t68)*t772
      s7 = s8+(t881*s2l1+(192*t883*t356+192*t883*t360)*s34r-192*t889*t65
     #-192*t889*t68)*t231+(t904*s2l1+(192*t906*t356+192*t906*t360)*t48+(
     #192*t901*t373+192*t901*t377)*s34r)*s23r+t928*s2l1+(192*t930*t444+1
     #92*t930*t447)*t320+(192*t936*t403+192*t936*t407)*t48
      s8 = s1l2
      s6 = s7*s8
      s4 = s5+s6
      s1 = s3+s4
      s2 = s1+384*t673*t6*t1091*t1092
      s3 = s2+((-t1097-t1099-t1105+192*t673*t15*s3l1p+192*t673*t127-192*
     #t484*t2*t457)*s23r+(192*t707-192*t711)*s2l1+(192*t947-192*t949)*s2
     #l2-384*t456*t53*t3*t12*s3l1p*s34r+(1152*t103*t552+t1130)*s3l1p+t11
     #34)*t106
      s4 = s3
      s6 = (192*t613*t1102*t772+(-t1097-t1099+t1105-192*t234*z*t662*t6)*
     #t231+(((-96*t728+192*t733)*s34r-192*t1151*t196)*s2l1+((-96*t963+19
     #2*t967)*s34r-192*t1151*t356)*s2l2+96*t467*t53*t1102*t48-288*t590*z
     #*t3*t1171+(-384*t30*l3*t12-192*t1177*t200)*s3l1p-192*t1177*l3*t127
     #+192*t1185*z*t1188)*s23r+((96*t755+192*t759)*t48+(384*t104*t516+19
     #2*t104*t3*s4l2p*t6)*s34r-192*t1205*t12)*s2l1+((96*t980+192*t984)*t
     #48+(384*t104*t524+192*t104*t3*s4l1p*t6)*s34r-192*t1205*t65)*s2l2-9
     #6*t635*t30*t674+(192*t255*l3*t30*t515*t1091-192*t487)*s34r+(384*t5
     #90*t221*t217+t893)*s3l1p+192*t889*t127)*t19
      s9 = 192*t613*t457*t772+(-192*t172*t461-192*t172*t464+96*(-5+t502)
     #*z*t3*t1171+(-384*t872-t1130)*s3l1p-t1134-192*(t502-t813-1)*z*t118
     #8)*t231+(((96*t1269*t196-192*t1273*t200)*s34r+192*t1279*t12-192*t1
     #282*t15)*s2l1+((96*t1269*t356-192*t1273*t360)*s34r+192*t1279*t65-1
     #92*t1282*t68)*s2l2+96*t484*t456*t30*t674+((-576*t473-96*t475)*s3l1
     #p-96*t481+(384*t472*t1308+96*t806*z*t168*l3)*t6)*s34r+(-384*(2+z)*
     #t10*t12-192*t1325*t15)*s3l1p-192*t1325*t127+384*t223*t68)*s23r+(38
     #4*t168*t27+(96*t1339*t196-192*t1343*t200)*t48+(96*t1350*t217-192*t
     #1354*t224)*s34r)*s2l1
      s8 = s9+((96*t1339*t356-192*t1343*t360)*t48+(96*t1350*t373-192*t13
     #54*t377)*s34r)*s2l2+288*t635*t53*t922+((-192*t534+96*t536)*s3l1p+9
     #6*t541+(384*t533*t1308-96*(-6-t213)*l3*t613*t4)*t6)*t48+((-384*(z-
     #2+t813)*t3*t552-96*t1399*t555)*s3l1p-96*t1399*t10*t127+384*t455*t5
     #63)*s34r
      s9 = s1vr
      s7 = s8*s9
      s5 = s6+s7
      taux3 = s4+s5

CCC Coefficients

      tcoff5 = taux3
      tcoff6 = taux3

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet5 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,5.D0,1.D0,1.D0,Tcoeff*tcoff5)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = -l3+1
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet6 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff6)

CCC Sum

      qgrmnum2e0 = tFjet5*tcoff5+tFjet6*tcoff6
      RETURN
      END

      double precision function qgrmnum2e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = t3*z
      t5 = -1+z
      t6 = t5**2
      t7 = t6*t5
      t8 = 1/s3vr
      t10 = s1vr**2
      t13 = t6**2
      t15 = t2**2
      t17 = t8*s34r
      t22 = s13r**2
      t25 = t2*t6
      t26 = t8*s2l2
      t27 = t25*t26
      t28 = t7*t2
      t29 = t8*s3l2p
      t30 = t28*t29
      t34 = s4l2p*t8
      t35 = t28*t34
      t39 = t7*t3
      t40 = t17*s2l2
      t41 = t39*t40
      t43 = t3*t13
      t44 = t43*t29
      t46 = t43*t34
      t58 = t13*t15
      t59 = s34r**2
      t60 = t8*t59
      t64 = t13*t5
      t65 = t64*t15
      t73 = t8*s2l1
      t74 = t25*t73
      t75 = t8*s3l1p
      t76 = t28*t75
      t80 = s4l1p*t8
      t81 = t28*t80
      t86 = t39*t17*s2l1
      t88 = t43*t75
      t90 = t43*t80
      t112 = z*l3
      t113 = t112*t7
      t114 = t2*t8
      t115 = t10*s1vr
      t130 = t4*t13
      t131 = l3*t8
      t132 = t131*s34r
      t133 = t130*t132
      t135 = t13*t2
      t136 = t34*s3l1p
      t139 = t80*s3l2p
      t142 = s4l2p*s4l1p
      t145 = -1-z
      t146 = t145*z
      t153 = z*t6
      t171 = t15*t8
      t172 = t171*t59
      t175 = t64*t3
      t189 = z**2
      t192 = t17*s23r
      t200 = l3*t7
      t201 = t200*t2
      t206 = t131*t59
      t207 = t43*t206
      t213 = t1*t7
      t214 = t131*s3l2p
      t215 = t213*t214
      t216 = 384*t215
      t217 = l3*s4l2p
      t218 = t217*t8
      t219 = t213*t218
      t220 = 192*t219
      t223 = t1*t6
      t225 = t223*t131*s2l2
      t231 = t114*s34r
      t232 = t200*t231
      t233 = z*t5
      t234 = t1*t8
      t237 = -192*t232-192*t233*t234
      t239 = t135*t214
      t241 = t135*t218
      t245 = t1*z
      t246 = t6*t8
      t247 = t246*s3l2p
      t252 = 384*t225
      t255 = s23r**2
      t258 = t1*t5
      t259 = t258*t8
      t261 = 96*t232-192*t259
      t267 = 4*z
      t268 = -1+t267
      t269 = t268*t1
      t273 = t6*s4l2p*t8
      t274 = t245*t273
      t281 = -192*t207-768*t153*t231
      t283 = t175*t214
      t285 = t175*t218
      t289 = 5*z
      t291 = (-2+t289)*t7
      t292 = t114*s3l2p
      t295 = 7*z
      t297 = (-3+t295)*t7
      t298 = t2*s4l2p
      t299 = t298*t8
      t306 = 576*t232
      t307 = t223*t8
      t309 = t306+192*t307
      t311 = -t239-t241
      t315 = 192*t213*t29
      t321 = 8*z
      t322 = t321-3
      t326 = 1152*t207+192*t322*t6*t231
      t328 = -t283-t285
      t331 = t322*t8
      t342 = l3*t64
      t343 = t59*s34r
      t344 = t171*t343
      t347 = -4+t295
      t349 = t3*t8
      t350 = t349*t59
      t353 = 576*t342*t344+192*t347*t7*t350
      t355 = t13*t6
      t356 = t15*t355
      t362 = t347*t13
      t363 = t349*s3l2p
      t366 = t3*s4l2p*t8
      t373 = t131*s3l1p
      t374 = t213*t373
      t375 = 384*t374
      t376 = l3*s4l1p
      t377 = t376*t8
      t378 = t213*t377
      t379 = 192*t378
      t383 = t223*t131*s2l1
      t390 = t135*t373
      t392 = t135*t377
      t396 = t246*s3l1p
      t413 = t6*s4l1p*t8
      t414 = t245*t413
      t419 = t175*t373
      t421 = t175*t377
      t425 = t114*s3l1p
      t429 = t2*s4l1p*t8
      t437 = -t390-t392
      t441 = 192*t213*t75
      t447 = -t419-t421
      t466 = t349*s3l1p
      t469 = t3*s4l1p*t8
      t476 = l3**2
      t477 = t213*t476
      t478 = z*t8
      t479 = t10**2
      t484 = t476*t8
      t488 = t213*l3
      t495 = z*t2
      t497 = t484*s34r
      t498 = t495*t13*t497
      t500 = t13*t1
      t501 = t500*l3
      t503 = 384*t501*t136
      t505 = 384*t501*t139
      t506 = t217*s4l1p
      t508 = 768*t500*t506
      t509 = 3*z
      t512 = t223*l3
      t528 = (8-10*z)*z
      t530 = l3*t6
      t531 = t530*t8
      t545 = (-5+t295)*t1
      t562 = t4*t64*t484*t59
      t564 = t342*t2
      t565 = t564*t136
      t567 = t564*t139
      t569 = t2*t64
      t570 = t569*t506
      t574 = z*t7
      t575 = t574*t2
      t584 = (-1+t509)*t1*t7
      t589 = 2*z
      t590 = -1+t589
      t593 = t7*s4l2p*s4l1p
      t620 = 12*z
      t626 = -t145
      t627 = t626*t1
      t628 = t627*t7
      t635 = 4*t189
      t645 = 9*z
      t655 = (-5+t620)*t7
      t658 = (-6+t295)*t7
      t684 = 6*z
      t687 = (t684-1)*t13*t2
      t730 = 3-t684
      t742 = t476*t13
      t743 = t114*t59
      t744 = t742*t743
      t745 = 768*t744
      t748 = 384*t245*t6*t132
      t757 = t175*t484*t343
      t765 = t7*t476
      t769 = t484*s3l2p
      t770 = t500*t769
      t771 = 288*t770
      t772 = t476*t1
      t775 = t772*t13*s4l2p*t8
      t776 = 384*t775
      t780 = (t509-2)*t6
      t785 = t765*t29
      t787 = t765*t34
      t791 = t213*t497
      t792 = t5*l3
      t793 = t792*t8
      t795 = 192*t791-192*t793
      t802 = -t730*t6
      t806 = 2*t6*t5
      t816 = 192*t744-192*(2+z)*t1*t6*t132
      t818 = t569*t769
      t819 = 576*t818
      t822 = t569*t476*s4l2p*t8
      t829 = (-10+15*z)*t1*t7
      t836 = 2*t189
      t838 = (-1+t836)*t5
      t843 = t476*t6
      t844 = t255*s23r
      t850 = -480*t791+192*t793
      t855 = -2+t267
      t856 = t855*t6
      t859 = z*s4l2p
      t861 = t530*t859*t8
      t874 = -480*t744+96*(1+t645)*t1*t6*t132+192*t626*z*t8
      t882 = (-18+25*z)*t1*t7
      t884 = 13*z
      t887 = (t884-9)*t1*t7
      t892 = 3*t189
      t894 = (-z-1+t892)*t5
      t910 = t5*t8*s34r
      t913 = -192*t757+96*(-1+t321)*t2*t7*t206+192*(1+t892)*t1*t910
      t918 = t476*t3
      t928 = (17*z-14)*t2*t13
      t932 = (-9+t684)*t2*t13
      t937 = 6*t189
      t939 = (1-t267+t937)*t1
      t941 = -3+t267
      t943 = t941*z*t1
      t950 = t530*t26
      t957 = (-4+t684)*t1
      t960 = t233*t8
      t962 = -192*t957*t6*t132-192*t960
      t964 = t957*t7
      t977 = (-7+t645)*t2
      t980 = -3+t289
      t982 = t980*z*t1
      t985 = -192*t977*t7*t206-192*t982*t910
      t987 = t977*t13
      t1000 = 4*t5
      t1001 = t1000*l3
      t1005 = t1000*z
      t1009 = -192*t1001*t13*t349*t343-192*t1005*t6*t743
      t1011 = t1001*t64
      t1017 = t1005*t7
      t1028 = t484*s3l1p
      t1029 = t500*t1028
      t1030 = 288*t1029
      t1033 = t772*t13*s4l1p*t8
      t1034 = 384*t1033
      t1041 = t765*t75
      t1043 = t765*t80
      t1059 = t569*t1028
      t1060 = 576*t1059
      t1063 = t569*t476*s4l1p*t8
      t1088 = t530*z*s4l1p*t8
      t1108 = t355*t8
      t1174 = t476*l3
      t1183 = t1174*t8
      t1188 = 192*t787
      t1197 = t245*t13*t1183*s34r
      t1201 = t189*t6
      t1213 = t941*t6
      t1227 = t495*t64*t1183*t59
      t1230 = t1*t64*t476
      t1241 = -5+t509
      t1243 = t1241*t7*l3
      t1273 = -3+z
      t1274 = t1273*t6
      t1298 = t1273*t7*l3
      t1306 = 7*t189
      t1329 = (-t684+t635+3)*t5
      t1354 = t135*t60
      t1358 = t1241*t1*t13
      t1371 = (3-t589+t836)*t6
      t1419 = (-6+t509)*t1*t7
      t1423 = (t589+1)*t1
      t1424 = t1423*t7
      t1430 = (-t589+t189)*t5
      t1434 = (z+t189-1)*t5
      t1466 = (1+t189)*t6
      t1474 = t189*z
      t1492 = (-4+t509)*t2*t13
      t1496 = t626*t2*t13
      t1502 = (-2-t295+t1306)*t1
      t1506 = (z+t189+1)*t1
      t1530 = t8*t343
      t1548 = (-t509+t635)*t1*t7
      t1593 = -t941
      s3 = (-192*t4*t7*t8*t10+192*z*t13*t15*t17*s1vr)*t22*s13r
      s7 = ((192*t27+192*t30)*t10+((-192*t27-192*t30-192*t35)*s23r+192*t
     #41+(-768*t44-576*t46)*s34r)*s1vr+(-576*t41+(576*t44+576*t46)*s34r)
     #*s23r-576*t58*t60*s2l2+(576*t65*t29+576*t65*t34)*t59)*s1l1+((192*t
     #74+192*t76)*t10+((-192*t74-192*t76-192*t81)*s23r+192*t86+(-768*t88
     #-576*t90)*s34r)*s1vr+(-576*t86+(576*t88+576*t90)*s34r)*s23r-576*t5
     #8*t60*s2l1+(576*t65*t75+576*t65*t80)*t59)*s1l2+960*t113*t114*t115
      s6 = s7+(384*t113*t114*s23r+(-576*t30-768*t35)*s2l1+(-576*t76-768*
     #t81)*s2l2-1728*t133+192*t135*t136+192*t135*t139+(384*t135*t142-192
     #*t146*t25)*t8)*t10+((192*t133-192*t153*t114)*s23r+(-960*t41+(480*t
     #44+672*t46)*s34r)*s2l1+(480*t88+672*t90)*s34r*s2l2+768*t112*t64*t1
     #72+(-192*t175*t136-192*t175*t139+(-384*t175*t142+192*t130)*t8)*s34
     #r)*s1vr-576*t189*t7*t3*t192-384*t189*t13*t172
      s7 = t22
      s5 = s6*s7
      s10 = ((-384*t201*t17*t10+(384*t201*t192+384*t207)*s1vr)*s1l2+(t21
     #6+t220)*t115+((-192*t225-576*t215-576*t219)*s23r+t237*s2l2+(-864*t
     #239+192*t241)*s34r-576*t245*t247)*t10+((t252+192*t215+t220)*t255+(
     #t261*s2l2+(1248*t239+672*t241)*s34r+192*t269*t247+576*t274)*s23r+t
     #281*s2l2+(1056*t283+192*t285)*t59+(384*t291*t292+192*t297*t299)*s3
     #4r)*s1vr+(t309*s2l2+576*t311*s34r-t315-192*t213*t34)*t255+(t326*s2
     #l2+1152*t328*t59+(-192*t28*t331*s3l2p-192*t28*t322*s4l2p*t8)*s34r)
     #*s23r+t353*s2l2+(-576*t356*t214-576*t356*t218)*t343+(-192*t362*t36
     #3-192*t362*t366)*t59)*s1l1
      s11 = ((t375+t379)*t115+((-192*t383-576*t374-576*t378)*s23r+t237*s
     #2l1+(-864*t390+192*t392)*s34r-576*t245*t396)*t10+((384*t383+192*t3
     #74+t379)*t255+(t261*s2l1+(1248*t390+672*t392)*s34r+192*t269*t396+5
     #76*t414)*s23r+t281*s2l1+(1056*t419+192*t421)*t59+(384*t291*t425+19
     #2*t297*t429)*s34r)*s1vr+(t309*s2l1+576*t437*s34r-t441-192*t213*t80
     #)*t255+(t326*s2l1+1152*t447*t59+(-192*t28*t331*s3l1p-192*t28*t322*
     #s4l1p*t8)*s34r)*s23r+t353*s2l1+(-576*t356*t373-576*t356*t377)*t343
     #+(-192*t362*t466-192*t362*t469)*t59)*s1l2
      s9 = s10+s11
      s8 = s9+192*t477*t478*t479+(-2496*t245*t7*t484*s23r+576*t488*t29*s
     #2l1+576*t488*t75*s2l2-1152*t498-t503-t505+(-t508-192*(1+t509)*z*t5
     #12)*t8)*t115+(((t252+t216+768*t219)*s2l1+(t375+768*t378)*s2l2+1920
     #*t498+192*t528*t1*t531)*s23r+((768*t232-384*t259)*s2l2+(-192*t239+
     #384*t241)*s34r+192*t545*t247+960*t274)*s2l1+((-192*t390+384*t392)*
     #s34r+192*t545*t396+960*t414)*s2l2+1344*t562+(384*t565+384*t567+(76
     #8*t570+96*(-10+t509)*l3*t575)*t8)*s34r-192*t584*t136-192*t584*t139
     #+(-384*t590*t1*t593+192*t590*z*t223)*t8)*t10
      s9 = s8+((192*t498-192*t146*t1*t531)*t255+(((t306+384*t307)*s2l2+2
     #88*t311*s34r-t315)*s2l1+(288*t437*s34r-t441)*s2l2-192*t562-96*t28*
     #(-t620-14)*t112*t17+192*t628*t136+192*t628*t139+(384*t627*t593+192
     #*(-1+t267-t635)*z*t258)*t8)*s23r+((576*t207+192*(t645-5)*t6*t231)*
     #s2l2+288*t328*t59+(-96*t655*t292-96*t658*t299)*s34r)*s2l1+(288*t44
     #7*t59+(-96*t655*t425-96*t658*t429)*s34r)*s2l2-384*z*t476*t355*t344
     #-96*(-14+z)*l3*z*t43*t60+(96*t687*t136+96*t687*t139+(192*t268*t13*
     #t298*s4l1p+192*(-2+t289-8*t189)*z*t25)*t8)*s34r)*s1vr+(576*t2*t189
     #*t7*t132+192*t189*t1*t246)*t255
      s7 = s9+(960*t43*t189*t206-192*(2-t295)*t189*t6*t231)*s23r+384*t18
     #9*l3*t64*t344-192*t730*t189*t7*t350
      s8 = s13r
      s6 = s7*s8
      s4 = s5+s6
      s2 = s3+s4
      s4 = s2
      s8 = (-384*t477*t17*t115+(768*t477*t192+t745+t748)*t10+(-384*t477*
     #t17*t255+(-t745-t748)*s23r-384*t757-384*t575*t206)*s1vr)*s1l2+(-19
     #2*t765*t29*s23r+(t771+t776)*s34r-192*t780*t214)*t115
      s7 = s8+((192*t785+384*t787)*t255+(t795*s2l2+(-384*t770-576*t775)*
     #s34r+192*t802*t214+192*t806*t218)*s23r+t816*s2l2+(-t819-960*t822)*
     #t59+(96*t829*t214-192*t628*t218)*s34r+192*t838*t29)*t10+(-192*t843
     #*t26*t844+(t850*s2l2+(288*t770+288*t775)*s34r-192*t856*t214-384*t8
     #61)*t255+(t874*s2l2+(t819+864*t822)*t59+(-96*t882*t214-96*t887*t21
     #8)*s34r-192*t894*t29-192*t838*t34)*s23r+t913*s2l2+(288*t3*t355*t76
     #9+576*t918*t355*s4l2p*t8)*t343+(-96*t928*t214-96*t932*t218)*t59+(-
     #192*t939*t247-192*t943*t273)*s34r)*s1vr+(-192*t950+192*t200*t29+19
     #2*t200*t34)*t844
      s6 = s7+(t962*s2l2+(192*t964*t214+192*t964*t218)*s34r+192*t153*t29
     #+192*t153*t34)*t255+(t985*s2l2+(192*t987*t214+192*t987*t218)*t59+(
     #192*t982*t247+192*t982*t273)*s34r)*s23r+t1009*s2l2+(192*t1011*t363
     #+192*t1011*t366)*t343+(192*t1017*t292+192*t1017*t299)*t59
      s7 = s1l1
      s5 = s6*s7
      s3 = s4+s5
      s5 = s3
      s8 = (-192*t765*t75*s23r+(t1030+t1034)*s34r-192*t780*t373)*t115+((
     #192*t1041+384*t1043)*t255+(t795*s2l1+(-384*t1029-576*t1033)*s34r+1
     #92*t802*t373+192*t806*t377)*s23r+t816*s2l1+(-t1060-960*t1063)*t59+
     #(96*t829*t373-192*t628*t377)*s34r+192*t838*t75)*t10+(-192*t843*t73
     #*t844+(t850*s2l1+(288*t1029+288*t1033)*s34r-192*t856*t373-384*t108
     #8)*t255+(t874*s2l1+(t1060+864*t1063)*t59+(-96*t882*t373-96*t887*t3
     #77)*s34r-192*t894*t75-192*t838*t80)*s23r+t913*s2l1+(288*t918*t1108
     #*s3l1p+576*t918*t355*s4l1p*t8)*t343+(-96*t928*t373-96*t932*t377)*t
     #59+(-192*t939*t396-192*t943*t413)*s34r)*s1vr+(-192*t530*t73+192*t2
     #00*t75+192*t200*t80)*t844
      s7 = s8+(t962*s2l1+(192*t964*t373+192*t964*t377)*s34r+192*t153*t75
     #+192*t153*t80)*t255+(t985*s2l1+(192*t987*t373+192*t987*t377)*t59+(
     #192*t982*t396+192*t982*t413)*s34r)*s23r+t1009*s2l1+(192*t1011*t466
     #+192*t1011*t469)*t343+(192*t1017*t425+192*t1017*t429)*t59
      s8 = s1l2
      s6 = s7*s8
      s4 = s5+s6
      s1 = s4+(-192*t7*t1174*t478*s23r+192*t742*t136+192*t742*t139)*t479
     #+(1536*t574*t1183*t255+((-384*t785+t1188)*s2l1+(-384*t1041+192*t10
     #43)*s2l2+1728*t1197+(384*t742*t142+768*t1201*t476)*t8)*s23r+(384*t
     #477*t40+(-t771+192*t775)*s34r-192*t1213*t214)*s2l1+((-t1030+192*t1
     #033)*s34r-192*t1213*t373)*s2l2+384*t1227+(-192*t1230*t136-192*t123
     #0*t139+192*(-3+t589)*t476*t1*t574*t8)*s34r+192*t1243*t136+192*t124
     #3*t139)*t115
      s4 = s1
      s7 = -192*t574*t1183*t844+((-384*t843*t26-t1188)*s2l1-192*t765*t80
     #*s2l2-1152*t1197-192*t528*t843*t8)*t255+(((-1152*t791-384*t233*t13
     #1)*s2l2+(t771-t776)*s34r-192*t1274*t214-192*t530*t34)*s2l1+((t1030
     #-t1034)*s34r-192*t1274*t373-192*t530*t80)*s2l2-1344*t1227-96*(6-19
     #*z)*z*t1*t765*t17-192*t1298*t136-192*t1298*t139+(384*t626*t7*t506+
     #192*(-t289+2+t1306)*z*t792)*t8)*s23r+((-t745-384*t627*t6*t132)*s2l
     #2+(288*t818-192*t822)*t59+(384*t628*t214+t220)*s34r-192*t1329*t29)
     #*s2l1+((288*t1059-192*t1063)*t59+(384*t628*t373+t379)*s34r-192*t13
     #29*t75)*s2l2
      s6 = s7-384*z*t1174*t3*t1108*t343-768*t145*t476*z*t1354+(-192*t135
     #8*t217*t75-192*t1358*t376*t29-192*(-z-t937-1)*z*t1*t531)*s34r+192*
     #t1371*t136+192*t1371*t139
      s7 = t10
      s5 = s6*s7
      s3 = s4+s5
      s4 = s3
      s9 = -192*t590*z*t6*t484*t844+((-384*t950-192*t530*t29-192*t861)*s
     #2l1+(-192*t530*t75-192*t1088)*s2l2-2112*t189*t1*t7*t497-192*t200*t
     #136-192*t200*t139+(-384*t200*t142-192*(t589-t189-2)*z*t792)*t8)*t2
     #55
      s8 = s9+(((-1152*t213*t132-384*t960)*s2l2+(96*t1419*t214-192*t1424
     #*t218)*s34r+192*t1430*t29-192*t1434*t34)*s2l1+((96*t1419*t373-192*
     #t1424*t377)*s34r+192*t1430*t75-192*t1434*t80)*s2l2+96*(-6-30*z)*t4
     #76*z*t1354+(-t503-t505+(-t508-96*(-10+t884+t1306)*z*t512)*t8)*s34r
     #-192*t1466*t136-192*t1466*t139+(-384*t626*t6*t142-192*(-1+t589-t18
     #9-2*t1474)*z)*t8)*s23r+((-768*t135*t206-384*t1423*t246*s34r)*s2l2+
     #(96*t1492*t214-192*t1496*t218)*t59+(96*t1502*t247-192*t1506*t273)*
     #s34r)*s2l1
      s7 = s8+((96*t1492*t373-192*t1496*t377)*t59+(96*t1502*t396-192*t15
     #06*t413)*s34r)*s2l2+96*(-4-t620)*t476*z*t175*t1530+(-192*t565-192*
     #t567+(-384*t570-96*(-6+11*z+t635)*l3*t575)*t8)*t59+(-96*t1548*t136
     #-96*t1548*t139+(-384*t213*t859*s4l1p-192*(-z+t635-1-4*t1474)*z*t25
     #8)*t8)*s34r
      s8 = s1vr
      s6 = s7*s8
      s7 = -192*t1201*t131*t844
      s5 = s6+s7
      s2 = s4+s5
      taux3 = s2+(-192*t980*l3*t189*t223*t17-192*t1474*t5*t8)*t255+(192*
     #(5-t321)*t189*l3*t28*t60-192*t855*t1474*t5*t234*s34r)*s23r+192*t15
     #93*l3*t189*t43*t1530+192*t1593*t1474*t6*t743

CCC Coefficients

      tcoff5 = taux3
      tcoff6 = taux3

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet5 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,5.D0,1.D0,1.D0,Tcoeff*tcoff5)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = -l3+1
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet6 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff6)

CCC Sum

      qgrmnum2e1 = tFjet5*tcoff5+tFjet6*tcoff6
      RETURN
      END

      double precision function qgrmnum2e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = t3*z
      t5 = -1+z
      t6 = t5**2
      t7 = t6*t5
      t8 = 1/s3vr
      t9 = t7*t8
      t10 = s1vr**2
      t13 = t6**2
      t15 = t2**2
      t17 = t8*s34r
      t22 = s13r**2
      t25 = z*l3
      t26 = t25*t7
      t27 = t2*t8
      t28 = t10*s1vr
      t36 = l3*t8
      t37 = t36*s34r
      t38 = t4*t13*t37
      t40 = 3*z
      t55 = t13*t5
      t57 = t15*t8
      t58 = s34r**2
      t59 = t57*t58
      t67 = z**2
      t78 = t1*z
      t79 = t78*t7
      t80 = l3**2
      t81 = t80*t8
      t85 = z*t2
      t88 = t85*t13*t81*s34r
      t93 = l3*t6
      t94 = t93*t8
      t99 = s23r**2
      t114 = t4*t55*t81*t58
      t116 = 23*z
      t120 = t7*t2
      t124 = 2*z
      t126 = z+1
      t130 = t5*t1*t8
      t144 = 7*z
      t150 = 2*t67
      t152 = (1+t150-t124)*z
      t158 = t13*t6
      t160 = t58*s34r
      t161 = t57*t160
      t168 = t3*t13
      t169 = t8*t58
      t173 = 5*z
      t178 = t27*s34r
      t218 = t78*t13
      t219 = t80*l3
      t220 = t219*t8
      t221 = t10**2
      t226 = z*t7
      t231 = t218*t220*s34r
      t243 = t85*t55*t220*t58
      t254 = t67*t6
      t265 = t7*t80*t17
      t271 = t5*l3*t8
      t287 = t13*t2*t169
      t293 = t93*t17
      t298 = t99*s23r
      t302 = 13*z
      t323 = t67*z
      t336 = t8*t160
      t340 = 4*t67
      t344 = t120*t169
      t352 = t1*t8*s34r
      t384 = 4*t5
      s3 = (192*t4*t9*t10-192*z*t13*t15*t17*s1vr)*t22*s13r
      s5 = (384*t26*t27*t28+(-384*t26*t27*s23r-1248*t38-192*(1+t40)*z*t6
     #*t2*t8)*t10+((576*t38+192*z*t6*t27)*s23r+864*t25*t55*t59+192*t4*t9
     #*s34r)*s1vr+576*t67*t7*t3*t17*s23r+576*t67*t13*t59)*t22
      s6 = ((-576*t79*t81*s23r-288*t88-192*(-1+t40)*z*t1*t94)*t28+(192*t
     #79*t81*t99+(1344*t88+192*(2+4*z)*z*t1*t94)*s23r+960*t114+96*(-8+t1
     #16)*l3*z*t120*t17+192*(-1+t124)*t126*z*t130)*t10+((-384*t88-192*t9
     #3*z*t1*t126*t8)*t99+(-1056*t114-96*t120*(t144-1)*t25*t17+192*t152*
     #t130)*s23r-672*z*t80*t158*t161-96*(-5+11*z)*l3*z*t168*t169+192*(2-
     #t173+5*t67)*z*t6*t178)*s1vr+(-576*t2*t67*t7*t37-192*t1*t67*t6*t8)*
     #t99+(-1152*t168*t67*t36*t58-192*(8*z-3)*t67*t6*t178)*s23r-576*t67*
     #l3*t55*t161-192*(-4+t144)*t67*t7*t3*t8*t58)*s13r
      s4 = s5+s6
      s2 = s3+s4
      s1 = s2+384*t218*t220*s34r*t221+(192*t226*t220*t99+(-480*t231+576*
     #t5*z*t6*t80*t8)*s23r-768*t243+384*(-3+t124)*t80*t1*t226*t17)*t28+(
     #(96*t231-384*t254*t81)*t99+(480*t243-96*(-19+26*z)*z*t1*t265+192*(
     #-t40+t67+4)*z*t271)*s23r+384*z*t219*t3*t158*t8*t160-96*(-21+20*z)*
     #t80*z*t287-192*(-5-z+t150)*z*t1*t293)*t10
      taux3 = s1+(192*t254*t81*t298+(96*(-5+t302)*z*t1*t265-192*t152*t27
     #1)*t99+(96*(-14+t116)*t80*z*t287-96*(-t302+10+11*t67)*z*t1*t293-19
     #2*(1-t67+2*t323)*z*t8)*s23r+96*(-9+12*z)*t80*z*t55*t3*t336-96*(8-t
     #144+t340)*l3*z*t344-192*(1+t40-t340+4*t323)*z*t5*t352)*s1vr+192*t2
     #54*t36*t298+(192*(-4+6*z)*l3*t67*t6*t1*t17+192*t323*t5*t8)*t99+(19
     #2*(-7+9*z)*t67*l3*t344+192*(-3+t173)*t323*t5*t352)*s23r+192*t384*l
     #3*t67*t168*t336+192*t384*t323*t6*t27*t58

CCC Coefficients

      tcoff5 = taux3
      tcoff6 = taux3

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet5 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,5.D0,1.D0,1.D0,Tcoeff*tcoff5)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = -l3+1
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet6 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff6)

CCC Sum

      qgrmnum2e2 = tFjet5*tcoff5+tFjet6*tcoff6
      RETURN
      END

      double precision function qgrmnum2e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux3 = 0

CCC Coefficients

      tcoff5 = taux3
      tcoff6 = taux3

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet5 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,5.D0,1.D0,1.D0,Tcoeff*tcoff5)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = -l3+1
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet6 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff6)

CCC Sum

      qgrmnum2e3 = tFjet5*tcoff5+tFjet6*tcoff6
      RETURN
      END

      double precision function qgrmnum2e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux3 = 0

CCC Coefficients

      tcoff5 = taux3
      tcoff6 = taux3

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet5 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,5.D0,1.D0,1.D0,Tcoeff*tcoff5)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = -l3+1
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet6 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff6)

CCC Sum

      qgrmnum2e4 = tFjet5*tcoff5+tFjet6*tcoff6
      RETURN
      END

      double precision function qgrmnum3e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = t1**2
      t3 = l3-1
      t4 = t3**2
      t5 = t2*t4
      t6 = 1/s3vr
      t7 = t6*s2l2
      t8 = t5*t7
      t10 = t2*t1
      t11 = t10*t4
      t12 = t6*s3l2p
      t13 = t11*t12
      t15 = s4l2p*t6
      t16 = t11*t15
      t19 = s1vr**2
      t24 = t4*t3
      t25 = t10*t24
      t26 = t6*s34r
      t27 = t26*s2l2
      t28 = t25*t27
      t30 = t2**2
      t31 = t24*t30
      t32 = t31*t12
      t34 = t31*t15
      t46 = t4**2
      t47 = t30*t46
      t48 = s34r**2
      t49 = t6*t48
      t53 = t30*t1
      t54 = t53*t46
      t62 = t6*s2l1
      t63 = t5*t62
      t65 = t6*s3l1p
      t66 = t11*t65
      t68 = s4l1p*t6
      t69 = t11*t68
      t76 = t26*s2l1
      t77 = t25*t76
      t79 = t31*t65
      t81 = t31*t68
      t111 = t30*t4
      t112 = t15*s3l1p
      t115 = t68*s3l2p
      t138 = t53*t24
      t147 = s13r**2
      t149 = t3*t10
      t150 = t149*l3
      t151 = t19*s1vr
      t155 = t3*t2
      t156 = l3*t6
      t158 = t155*t156*s2l2
      t160 = t156*s3l2p
      t161 = t149*t160
      t164 = l3*s4l2p*t6
      t165 = t149*t164
      t169 = t11*l3
      t172 = t111*t160
      t174 = t111*t164
      t178 = 4*z
      t179 = 2-t178
      t180 = t179*t3
      t181 = t2*t6
      t182 = t181*s3l2p
      t185 = 2*z
      t186 = -1+t185
      t187 = t186*t3
      t189 = t2*s4l2p*t6
      t191 = 768*t187*t189
      t198 = s23r**2
      t200 = l3*t10
      t201 = t4*t6
      t202 = t201*s34r
      t204 = 2304*t200*t202
      t207 = t1*t6
      t210 = -t204+768*t186*t3*t207
      t216 = 5*z
      t218 = (3-t216)*t3
      t225 = t156*t48
      t226 = t31*t225
      t228 = 6*z
      t233 = -2304*t226-768*(1-t228)*t2*t202
      t235 = t138*t160
      t237 = t138*t164
      t242 = (2-t216)*t10
      t243 = t201*s3l2p
      t246 = 8*z
      t248 = (4-t246)*t10
      t250 = t4*s4l2p*t6
      t259 = -t204-768*t155*t6
      t261 = t172+t174
      t264 = -t3
      t265 = t264*t10
      t273 = 7*z
      t274 = 2-t273
      t278 = -3840*t226+768*t274*t2*t202
      t280 = t235+t237
      t283 = t274*t6
      t294 = l3*t53
      t296 = t48*s34r
      t300 = 3-t228
      t302 = t24*t6
      t306 = -1536*t294*t46*t6*t296+768*t300*t10*t302*t48
      t308 = t30*t2
      t309 = t46*t308
      t315 = t300*t30
      t316 = t302*s3l2p
      t319 = t24*s4l2p*t6
      t330 = t155*t156*s2l1
      t332 = t156*s3l1p
      t333 = t149*t332
      t336 = l3*s4l1p*t6
      t337 = t149*t336
      t343 = t111*t332
      t345 = t111*t336
      t349 = t181*s3l1p
      t353 = t2*s4l1p*t6
      t355 = 768*t187*t353
      t377 = t138*t332
      t379 = t138*t336
      t383 = t201*s3l1p
      t387 = t4*s4l1p*t6
      t396 = -t343-t345
      t407 = -t377-t379
      t427 = t302*s3l1p
      t430 = t24*s4l1p*t6
      t437 = t12*s2l1
      t439 = t65*s2l2
      t441 = t3*t30
      t442 = t441*l3
      t443 = t442*t112
      t444 = t442*t115
      t449 = 768*t161+768*t165
      t452 = -768*t333-768*t337
      t456 = t111*l3
      t461 = -t179*t2
      t462 = t3*t6
      t463 = t462*s3l2p
      t471 = t462*s3l1p
      t476 = t294*t4
      t479 = -t476*t112+t476*t115
      t482 = t187*t10
      t498 = 3*z
      t500 = (t498-2)*t2
      t522 = (-6+t246)*t10
      t525 = (-6+t178)*t10
      t543 = z*t30*t4
      t553 = l3**2
      t554 = t10*t553
      t558 = t441*t553
      t561 = 384*t558*t12*s34r
      t562 = l3*t2
      t564 = 768*t562*t12
      t567 = t553*t2
      t571 = -t567*t7+t554*t12+t554*t15
      t574 = 8*t264
      t576 = t553*t6
      t579 = 384*t574*t10*t576*s34r
      t580 = t1*z
      t581 = t580*t156
      t583 = t579-1536*t581
      t586 = 5*t264*t30
      t587 = t576*s3l2p
      t590 = t553*s4l2p*t6
      t595 = z+1
      t596 = t595*t2
      t601 = t562*z*s4l2p*t6
      t605 = t553*t30
      t606 = t201*t48
      t607 = t605*t606
      t612 = t462*s34r
      t615 = -1536*t607-768*(t185+1)*l3*t2*t612
      t617 = t4*t53
      t618 = t617*t587
      t619 = t617*t590
      t620 = t618+t619
      t625 = (t273+3)*l3*t10
      t630 = (-1-t498)*l3*t10
      t632 = t3*s4l2p*t6
      t641 = t198*s23r
      t644 = -t579-768*t581
      t647 = 10*t264*t30
      t649 = t574*t30
      t654 = z*t2
      t661 = -t1
      t667 = z**2
      t670 = 5376*t607+1536*t661*l3*t2*t612-1536*t667*t6
      t678 = (-t178+8)*l3*t10
      t682 = 6*t661*l3*t10
      t687 = 2*t667
      t689 = (1-z-t687)*t1
      t707 = t207*s34r
      t710 = 3072*t138*t576*t296+384*(4+t185)*l3*t10*t606+768*(-3*t667-1
     #+t185)*t3*t707
      t715 = t553*t24
      t724 = (-z+8)*l3*t30
      t728 = (6-t185)*t4*t30
      t735 = (-1+t178-4*t667)*t3
      t737 = 3-t178
      t738 = t737*z
      t739 = t738*t2
      t747 = t200*t12
      t757 = -768*t218*t2*t156*s34r+768*t580*t6
      t759 = t218*t10
      t772 = (5-t246)*t4
      t776 = t179*z*t3
      t779 = -768*t772*t10*t225-768*t776*t707
      t781 = t772*t30
      t794 = t737*l3
      t800 = -768*t794*t30*t302*t296-768*t739*t606
      t802 = t794*t53
      t808 = t738*t10
      t821 = 384*t558*t65*s34r
      t823 = 768*t562*t65
      t829 = t567*t62-t554*t65-t554*t68
      t834 = t576*s3l1p
      t837 = t553*s4l1p*t6
      t846 = t562*z*s4l1p*t6
      t852 = t617*t834
      t853 = t617*t837
      t854 = -t852-t853
      t860 = t3*s4l1p*t6
      t924 = t200*t65
      t988 = 2*t3*t30
      t991 = t264*t30
      t1009 = t661*l3*t10
      t1019 = t595*t3*t10
      t1022 = t200*z
      t1039 = t443-t444
      t1045 = (-4+t185)*l3
      t1046 = t1045*t10
      t1050 = t661*t3*t10
      t1056 = t661*t1
      t1077 = t1045*t30
      t1081 = t661*t4*t30
      t1087 = (-t178+t687)*t2
      t1091 = (1+z-t667)*t2
      t1116 = 2*t661*t3*t10
      s2 = (((-768*t8-1536*t13-768*t16)*t19+((768*t8+768*t13+768*t16)*s2
     #3r-1536*t28+(3072*t32+2304*t34)*s34r)*s1vr+(2304*t28+(-2304*t32-23
     #04*t34)*s34r)*s23r+1536*t47*t49*s2l2+(-1536*t54*t12-1536*t54*t15)*
     #t48)*s1l1+((768*t63+1536*t66+768*t69)*t19+((-768*t63-768*t66-768*t
     #69)*s23r+1536*t77+(-3072*t79-2304*t81)*s34r)*s1vr+(-2304*t77+(2304
     #*t79+2304*t81)*s34r)*s23r-1536*t47*t49*s2l1+(1536*t54*t65+1536*t54
     #*t68)*t48)*s1l2+((-2304*t13-1536*t16)*s2l1+(2304*t66+1536*t69)*s2l
     #2-768*t111*t112+768*t111*t115)*t19+(((1536*t13+1536*t16)*s2l1+(-15
     #36*t66-1536*t69)*s2l2)*s23r+(1536*t32+768*t34)*s34r*s2l1+(-1536*t7
     #9-768*t81)*s34r*s2l2+(768*t138*t112-768*t138*t115)*s34r)*s1vr)*t14
     #7
      s7 = (1536*t150*t12*t151+((2304*t158-1536*t161-1536*t165)*s23r+307
     #2*t169*t27+(-3840*t172-1920*t174)*s34r-768*t180*t182+t191)*t19+((-
     #1536*t158+768*t161+768*t165)*t198+(t210*s2l2+(1152*t172+384*t174)*
     #s34r+768*t218*t182+768*t180*t189)*s23r+t233*s2l2+(768*t235+384*t23
     #7)*t48+(1536*t242*t243+768*t248*t250)*s34r)*s1vr+(t259*s2l2+2304*t
     #261*s34r-768*t265*t12-768*t265*t15)*t198+(t278*s2l2+3840*t280*t48+
     #(-768*t11*t283*s3l2p-768*t11*t274*s4l2p*t6)*s34r)*s23r+t306*s2l2+(
     #1536*t309*t160+1536*t309*t164)*t296+(-768*t315*t316-768*t315*t319)
     #*t48)*s1l1
      s8 = (-1536*t150*t65*t151+((-2304*t330+1536*t333+1536*t337)*s23r-3
     #072*t169*t76+(3840*t343+1920*t345)*s34r+768*t180*t349-t355)*t19+((
     #1536*t330-768*t333-768*t337)*t198+(-t210*s2l1+(-1152*t343-384*t345
     #)*s34r-768*t218*t349-768*t180*t353)*s23r-t233*s2l1+(-768*t377-384*
     #t379)*t48+(-1536*t242*t383-768*t248*t387)*s34r)*s1vr+(-t259*s2l1+2
     #304*t396*s34r+768*t265*t65+768*t265*t68)*t198+(-t278*s2l1+3840*t40
     #7*t48+(768*t11*t283*s3l1p+768*t11*t274*s4l1p*t6)*s34r)*s23r-t306*s
     #2l1+(-1536*t309*t332-1536*t309*t336)*t296+(768*t315*t427+768*t315*
     #t430)*t48)*s1l2
      s6 = s7+s8
      s5 = s6+(1536*t150*t437-1536*t150*t439+1536*t443-1536*t444)*t151+(
     #(t449*s2l1+t452*s2l2)*s23r+(1152*t456*t15*s34r+768*t461*t463+t191)
     #*s2l1+(-1152*t456*t68*s34r-768*t461*t471-t355)*s2l2+1536*t479*s34r
     #+768*t482*t112-768*t482*t115)*t19+((-t449*s2l1-t452*s2l2)*t198+((-
     #1920*t261*s34r-768*t500*t463-t191)*s2l1+(-1920*t396*s34r+768*t500*
     #t471+t355)*s2l2-768*t441*t112+768*t441*t115)*s23r+(-1152*t280*t48+
     #(-384*t522*t243-384*t525*t250)*s34r)*s2l1+(-1152*t407*t48+(384*t52
     #2*t383+384*t525*t387)*s34r)*s2l2+(-1536*t543*t112+1536*t543*t115)*
     #s34r)*s1vr
      s6 = s13r
      s4 = s5*s6
      s7 = (-768*t554*t12*s23r+t561-t564)*t151+(1536*t571*t198+(t583*s2l
     #2+(-768*t586*t587-768*t586*t590)*s34r+768*t596*t160+1536*t601)*s23
     #r+t615*s2l2+2304*t620*t48+(384*t625*t463-768*t630*t632)*s34r)*t19+
     #(-768*t571*t641+(t644*s2l2+(384*t647*t587+384*t649*t590)*s34r+768*
     #t654*t160+768*t601)*t198+(t670*s2l2+(-5760*t618-4608*t619)*t48+(-3
     #84*t678*t463-384*t682*t632)*s34r-768*t689*t12-768*t689*t15)*s23r+t
     #710*s2l2+(-2688*t24*t308*t587-2304*t715*t308*s4l2p*t6)*t296+(-384*
     #t724*t243-384*t728*t164)*t48+(-768*t735*t182-768*t739*t632)*s34r)*
     #s1vr+(768*t562*t7-768*t747-768*t200*t15)*t641
      s6 = s7+(t757*s2l2+(768*t759*t160+768*t759*t164)*s34r-768*t654*t12
     #-768*t654*t15)*t198+(t779*s2l2+(768*t781*t160+768*t781*t164)*t48+(
     #768*t776*t182+768*t776*t189)*s34r)*s23r+t800*s2l2+(768*t802*t316+7
     #68*t802*t319)*t296+(768*t808*t243+768*t808*t250)*t48
      s7 = s1l1
      s5 = s6*s7
      s3 = s4+s5
      s1 = s2+s3
      s3 = s1
      s6 = (768*t554*t65*s23r-t821+t823)*t151+(1536*t829*t198+(-t583*s2l
     #1+(768*t586*t834+768*t586*t837)*s34r-768*t596*t332-1536*t846)*s23r
     #-t615*s2l1+2304*t854*t48+(-384*t625*t471+768*t630*t860)*s34r)*t19+
     #(-768*t829*t641+(-t644*s2l1+(-384*t647*t834-384*t649*t837)*s34r-76
     #8*t654*t332-768*t846)*t198+(-t670*s2l1+(5760*t852+4608*t853)*t48+(
     #384*t678*t471+384*t682*t860)*s34r+768*t689*t65+768*t689*t68)*s23r-
     #t710*s2l1+(2688*t715*t308*t6*s3l1p+2304*t715*t308*s4l1p*t6)*t296+(
     #384*t724*t383+384*t728*t336)*t48+(768*t735*t349+768*t739*t860)*s34
     #r)*s1vr+(-768*t562*t62+768*t924+768*t200*t68)*t641
      s5 = s6+(-t757*s2l1+(-768*t759*t332-768*t759*t336)*s34r+768*t654*t
     #65+768*t654*t68)*t198+(-t779*s2l1+(-768*t781*t332-768*t781*t336)*t
     #48+(-768*t776*t349-768*t776*t353)*s34r)*s23r-t800*s2l1+(-768*t802*
     #t427-768*t802*t430)*t296+(-768*t808*t383-768*t808*t387)*t48
      s6 = s1l2
      s4 = s5*s6
      s2 = s3+s4
      s3 = s2+((-768*t554*t437+768*t554*t439-768*t605*t112+768*t605*t115
     #)*s23r+(-t561-t564)*s2l1+(t821+t823)*s2l2-768*t200*t112+768*t200*t
     #115)*t151
      s4 = s3
      s6 = ((((384*t988*t587-768*t991*t590)*s34r-768*t747)*s2l1+((-384*t
     #988*t834+768*t991*t837)*s34r+768*t924)*s2l2+768*t1009*t112-768*t10
     #09*t115)*s23r+(768*t620*t48+(384*t1019*t160+768*t1022*t632)*s34r)*
     #s2l1+(768*t854*t48+(-384*t1019*t332-768*t1022*t860)*s34r)*s2l2+115
     #2*t1039*s34r)*t19
      s7 = ((((384*t1046*t463-768*t1050*t164)*s34r+768*t182-768*t1056*t1
     #5)*s2l1+((-384*t1046*t471+768*t1050*t336)*s34r-768*t349+768*t1056*
     #t68)*s2l2-768*t1039*s34r)*s23r+((384*t1077*t243-768*t1081*t164)*t4
     #8+(384*t1087*t463-768*t1091*t632)*s34r)*s2l1+((-384*t1077*t383+768
     #*t1081*t336)*t48+(-384*t1087*t471+768*t1091*t860)*s34r)*s2l2+768*t
     #479*t48+(384*t1116*t112-384*t1116*t115)*s34r)*s1vr
      s5 = s6+s7
      taux4 = s4+s5

CCC Coefficients

      tcoff7 = taux4
      tcoff8 = taux4

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet7 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,7.D0,1.D0,1.D0,Tcoeff*tcoff7)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = -l3+1
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet8 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff8)

CCC Sum

      qgrmnum3e0 = tFjet7*tcoff7+tFjet8*tcoff8
      RETURN
      END

      double precision function qgrmnum3e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = t1**2
      t3 = l3-1
      t4 = t3**2
      t5 = t2*t4
      t6 = 1/s3vr
      t7 = t6*s2l2
      t8 = t5*t7
      t10 = t2*t1
      t11 = t10*t4
      t12 = t6*s3l2p
      t13 = t11*t12
      t15 = s4l2p*t6
      t16 = t11*t15
      t19 = s1vr**2
      t24 = t4*t3
      t25 = t10*t24
      t26 = t6*s34r
      t27 = t26*s2l2
      t28 = t25*t27
      t30 = t2**2
      t31 = t24*t30
      t32 = t31*t12
      t34 = t31*t15
      t46 = t4**2
      t47 = t30*t46
      t48 = s34r**2
      t49 = t6*t48
      t53 = t30*t1
      t54 = t53*t46
      t62 = t6*s2l1
      t63 = t5*t62
      t65 = t6*s3l1p
      t66 = t11*t65
      t68 = s4l1p*t6
      t69 = t11*t68
      t76 = t26*s2l1
      t77 = t25*t76
      t79 = t31*t65
      t81 = t31*t68
      t111 = t30*t4
      t112 = t15*s3l1p
      t115 = t68*s3l2p
      t138 = t53*t24
      t147 = s13r**2
      t149 = t3*t10
      t150 = l3*t6
      t151 = t150*s3l2p
      t152 = t149*t151
      t155 = l3*s4l2p*t6
      t156 = t149*t155
      t157 = 1536*t156
      t159 = t19*s1vr
      t161 = t3*t2
      t163 = t161*t150*s2l2
      t169 = l3*t10
      t170 = t4*t6
      t171 = t170*s34r
      t172 = t169*t171
      t174 = t1*z
      t175 = t3*t6
      t178 = -14208*t172-768*t174*t175
      t180 = t111*t151
      t182 = t111*t155
      t188 = (15*z-6)*t2
      t189 = t175*s3l2p
      t192 = 6*z
      t194 = (3-t192)*t2
      t196 = t3*s4l2p*t6
      t205 = s23r**2
      t212 = 13824*t172-768*(-2+t192)*t1*t175
      t218 = 19*z
      t220 = (-10+t218)*t2
      t228 = t31*t150*t48
      t235 = 10752*t228-768*(22*z-3)*t2*t171
      t237 = t138*t151
      t239 = t138*t155
      t243 = 20*z
      t245 = (-8+t243)*t10
      t246 = t170*s3l2p
      t251 = (-15+31*z)*t10
      t253 = t4*s4l2p*t6
      t263 = 9216*t172+3072*t161*t6
      t269 = 4*t3*t10
      t282 = 16128*t228+768*(29*z-9)*t2*t171
      t287 = 8*z
      t288 = t287-3
      t290 = 7*z
      t295 = (t10*t288-3*t10*(2-t290))*t4
      t303 = l3*t53
      t305 = t48*s34r
      t310 = -13+25*z
      t312 = t24*t6
      t316 = 6912*t303*t46*t6*t305+768*t310*t10*t312*t48
      t318 = t30*t2
      t319 = t46*t318
      t325 = t310*t30
      t326 = t312*s3l2p
      t329 = t24*s4l2p*t6
      t336 = t150*s3l1p
      t337 = t149*t336
      t340 = l3*s4l1p*t6
      t341 = t149*t340
      t342 = 1536*t341
      t346 = t161*t150*s2l1
      t354 = t111*t336
      t356 = t111*t340
      t360 = t175*s3l1p
      t364 = t3*s4l1p*t6
      t388 = t138*t336
      t390 = t138*t340
      t394 = t170*s3l1p
      t398 = t4*s4l1p*t6
      t435 = t312*s3l1p
      t438 = t24*s4l1p*t6
      t451 = t3*t30
      t452 = t451*l3
      t453 = t452*t112
      t455 = t452*t115
      t474 = -17*z+9
      t475 = t474*t2
      t479 = (5-t287)*t2
      t494 = t303*t4
      t497 = t494*t112-t494*t115
      t502 = (5-t192)*t3*t10
      t521 = 10*z
      t523 = (5-t521)*t2
      t527 = -t288*t2
      t542 = -t1
      t545 = 3*t542*t3*t10
      t558 = (21-32*z)*t10
      t561 = (-t218+18)*t10
      t579 = 12*z
      t582 = (3-t579)*t30*t4
      t592 = l3**2
      t593 = t10*t592
      t594 = t19**2
      t598 = t593*t12
      t600 = t593*t15
      t601 = 1536*t600
      t604 = -t3
      t606 = t604*t10*t592
      t609 = t451*t592
      t610 = t12*s34r
      t613 = 5*z
      t615 = (-t613-1)*t2
      t617 = 768*t615*t151
      t620 = t592*t2
      t621 = t620*t7
      t629 = t592*t6
      t630 = t629*s34r
      t635 = 12672*t3*t10*t630+5376*t174*t150
      t638 = 29*t3*t30
      t639 = t629*s3l2p
      t642 = 23*t3*t30
      t644 = t592*s4l2p*t6
      t650 = (-4-t613)*t2
      t653 = l3*t2
      t660 = t592*t30
      t661 = t170*t48
      t662 = t660*t661
      t666 = t150*s34r
      t669 = 7296*t662+9216*z*t3*t2*t666
      t671 = t4*t53
      t672 = t671*t639
      t674 = t671*t644
      t681 = (-40*z+5)*l3*t10
      t686 = (1+t579)*l3*t10
      t691 = z**2
      t692 = 2*t691
      t694 = (-1+t692)*t1
      t703 = t205*s23r
      t709 = 3*z
      t714 = -16128*t3*t10*t630+768*(1+t709)*t1*t150
      t717 = 40*t3*t30
      t720 = 34*t3*t30
      t726 = (-4+t290)*t2
      t730 = (-2+t613)*t2
      t742 = -26112*t662+384*t149*t666+768*(t290+1)*z*t6
      t750 = (-30+t218)*l3*t10
      t754 = (-25+t243)*l3*t10
      t759 = 2*z
      t762 = (t759-4+9*t691)*t1
      t767 = (-4+8*t691+t709)*t1
      t784 = t175*s34r
      t787 = -13056*t138*t629*t305+384*(-13*z-3)*l3*t10*t661+768*(4+12*t
     #691-t192)*t1*t784
      t792 = t592*t24
      t801 = (-22+t759)*l3*t30
      t805 = (-21+t287)*l3*t30
      t810 = 16*z
      t813 = (4-t810+18*t691)*t2
      t817 = (-12+t810)*z*t2
      t830 = 21*z
      t832 = (-13+t830)*l3
      t838 = -768*t832*t2*t784-3072*t174*t6
      t840 = t832*t10
      t846 = z*t2
      t855 = (-22+33*z)*l3
      t859 = -t474*z
      t863 = -768*t855*t10*t661-768*t859*t1*t784
      t865 = t855*t30
      t871 = t859*t2
      t879 = t810-13
      t884 = t879*z
      t888 = -768*t879*t24*t30*t150*t305-768*t884*t2*t661
      t891 = t879*l3*t53
      t897 = t884*t10
      t908 = t593*t65
      t910 = t593*t68
      t911 = 1536*t910
      t916 = t65*s34r
      t920 = 768*t615*t336
      t923 = t620*t62
      t931 = t629*s3l1p
      t934 = t592*s4l1p*t6
      t949 = t671*t931
      t951 = t671*t934
      t1092 = 7*t604*t30*t592
      t1112 = 14*t604*t30
      t1116 = 6*t3*t30
      t1122 = (6-t613)*t2
      t1143 = (t709-2)*l3*t10
      t1156 = (-1-t192)*l3*t10
      t1159 = 4*z
      t1162 = (-1-t1159)*l3*t10
      t1167 = 4*t691
      t1169 = (-t1167-2+t192)*t1
      t1188 = -t453+t455
      t1200 = 2*t2*t1
      t1220 = (16-14*z)*l3*t10
      t1225 = (-7+t192)*l3*t10
      t1230 = -z+3-t692
      t1231 = t1230*t1
      t1235 = -t1230*t1
      t1255 = t542*t2
      t1264 = (12-t521)*l3*t30
      t1269 = (-5+t1159)*l3*t30
      t1276 = (t830-2-13*t691)*t2
      t1280 = (t1167-3-t613)*t2
      t1305 = (-6+t290)*t3*t10
      s3 = (((3072*t8+5376*t13+2304*t16)*t19+((-3072*t8-3072*t13-3072*t1
     #6)*s23r+5376*t28+(-12288*t32-9216*t34)*s34r)*s1vr+(-9216*t28+(9216
     #*t32+9216*t34)*s34r)*s23r-6912*t47*t49*s2l2+(6912*t54*t12+6912*t54
     #*t15)*t48)*s1l1+((-3072*t63-5376*t66-2304*t69)*t19+((3072*t63+3072
     #*t66+3072*t69)*s23r-5376*t77+(12288*t79+9216*t81)*s34r)*s1vr+(9216
     #*t77+(-9216*t79-9216*t81)*s34r)*s23r+6912*t47*t49*s2l1+(-6912*t54*
     #t65-6912*t54*t68)*t48)*s1l2+((7680*t13+5376*t16)*s2l1+(-7680*t66-5
     #376*t69)*s2l2+2304*t111*t112-2304*t111*t115)*t19+(((-3840*t13-3840
     #*t16)*s2l1+(3840*t66+3840*t69)*s2l2)*s23r+(-4992*t32-3456*t34)*s34
     #r*s2l1+(4992*t79+3456*t81)*s34r*s2l2+(-2304*t138*t112+2304*t138*t1
     #15)*s34r)*s1vr)*t147
      s7 = ((-8448*t152-t157)*t159+((-8448*t163+6912*t152+7680*t156)*s23
     #r+t178*s2l2+(19584*t180+10752*t182)*s34r-768*t188*t189+768*t194*t1
     #96)*t19+((6144*t163-768*t152-768*t156)*t205+(t212*s2l2+(-3840*t180
     #-2304*t182)*s34r+768*t220*t189+768*t188*t196)*s23r+t235*s2l2+(-422
     #4*t237-2304*t239)*t48+(1536*t245*t246+768*t251*t253)*s34r)*s1vr+(t
     #263*s2l2+(-9216*t180-9216*t182)*s34r-768*t269*t12-768*t269*t15)*t2
     #05+(t282*s2l2+(-16128*t237-16128*t239)*t48+(-768*t295*t12-768*t295
     #*t15)*s34r)*s23r+t316*s2l2+(-6912*t319*t151-6912*t319*t155)*t305+(
     #-768*t325*t326-768*t325*t329)*t48)*s1l1
      s8 = ((8448*t337+t342)*t159+((8448*t346-6912*t337-7680*t341)*s23r-
     #t178*s2l1+(-19584*t354-10752*t356)*s34r+768*t188*t360-768*t194*t36
     #4)*t19+((-6144*t346+768*t337+768*t341)*t205+(-t212*s2l1+(3840*t354
     #+2304*t356)*s34r-768*t220*t360-768*t188*t364)*s23r-t235*s2l1+(4224
     #*t388+2304*t390)*t48+(-1536*t245*t394-768*t251*t398)*s34r)*s1vr+(-
     #t263*s2l1+(9216*t354+9216*t356)*s34r+768*t269*t65+768*t269*t68)*t2
     #05+(-t282*s2l1+(16128*t388+16128*t390)*t48+(768*t295*t65+768*t295*
     #t68)*s34r)*s23r-t316*s2l1+(6912*t319*t336+6912*t319*t340)*t305+(76
     #8*t325*t435+768*t325*t438)*t48)*s1l2
      s6 = s7+s8
      s7 = s6+((-7680*t152-t157)*s2l1+(7680*t337+t342)*s2l2-4608*t453+46
     #08*t455)*t159
      s5 = s7+(((-3072*t152-2304*t156)*s2l1+(3072*t337+2304*t341)*s2l2)*
     #s23r+((1920*t180-1536*t182)*s34r+768*t475*t189+768*t479*t196)*s2l1
     #+((-1920*t354+1536*t356)*s34r-768*t475*t360-768*t479*t364)*s2l2+46
     #08*t497*s34r+768*t502*t112-768*t502*t115)*t19+(((2304*t152+2304*t1
     #56)*s2l1+(-2304*t337-2304*t341)*s2l2)*t205+(((5760*t180+6528*t182)
     #*s34r-768*t523*t189-768*t527*t196)*s2l1+((-5760*t354-6528*t356)*s3
     #4r+768*t523*t360+768*t527*t364)*s2l2-768*t545*t112+768*t545*t115)*
     #s23r+((3456*t237+4224*t239)*t48+(-384*t558*t246-384*t561*t253)*s34
     #r)*s2l1+((-3456*t388-4224*t390)*t48+(384*t558*t394+384*t561*t398)*
     #s34r)*s2l2+(-384*t582*t112+384*t582*t115)*s34r)*s1vr
      s6 = s13r
      s4 = s5*s6
      s2 = s3+s4
      s3 = s2
      s8 = 768*t593*t12*t594+((6144*t598+t601)*s23r-768*t606*t27+384*t60
     #9*t610-t617)*t159
      s7 = s8+((5376*t621-9216*t598-8448*t600)*t205+(t635*s2l2+(-768*t63
     #8*t639-768*t642*t644)*s34r+768*t650*t151-6912*t653*z*s4l2p*t6)*s23
     #r+t669*s2l2+(-13056*t672-9216*t674)*t48+(384*t681*t189-768*t686*t1
     #96)*s34r+768*t694*t12)*t19+((-3072*t621+2304*t598+2304*t600)*t703+
     #(t714*s2l2+(384*t717*t639+384*t720*t644)*s34r-768*t726*t151-768*t7
     #30*t155)*t205+(t742*s2l2+(24960*t672+19968*t674)*t48+(-384*t750*t1
     #89-384*t754*t196)*s34r-768*t762*t12-768*t767*t15)*s23r+t787*s2l2+(
     #11904*t24*t318*t639+9216*t792*t318*s4l2p*t6)*t305+(-384*t801*t246-
     #384*t805*t253)*t48+(-768*t813*t189-768*t817*t196)*s34r)*s1vr+(-307
     #2*t653*t7+3072*t169*t12+3072*t169*t15)*t703
      s6 = s7+(t838*s2l2+(768*t840*t189+768*t840*t196)*s34r+3072*t846*t1
     #2+3072*t846*t15)*t205+(t863*s2l2+(768*t865*t246+768*t865*t253)*t48
     #+(768*t871*t189+768*t871*t196)*s34r)*s23r+t888*s2l2+(768*t891*t326
     #+768*t891*t329)*t305+(768*t897*t246+768*t897*t253)*t48
      s7 = s1l1
      s5 = s6*s7
      s9 = -768*t593*t65*t594+((-6144*t908-t911)*s23r+768*t606*t76-384*t
     #609*t916+t920)*t159
      s8 = s9+((-5376*t923+9216*t908+8448*t910)*t205+(-t635*s2l1+(768*t6
     #38*t931+768*t642*t934)*s34r-768*t650*t336+6912*t653*z*s4l1p*t6)*s2
     #3r-t669*s2l1+(13056*t949+9216*t951)*t48+(-384*t681*t360+768*t686*t
     #364)*s34r-768*t694*t65)*t19+((3072*t923-2304*t908-2304*t910)*t703+
     #(-t714*s2l1+(-384*t717*t931-384*t720*t934)*s34r+768*t726*t336+768*
     #t730*t340)*t205+(-t742*s2l1+(-24960*t949-19968*t951)*t48+(384*t750
     #*t360+384*t754*t364)*s34r+768*t762*t65+768*t767*t68)*s23r-t787*s2l
     #1+(-11904*t792*t318*t6*s3l1p-9216*t792*t318*s4l1p*t6)*t305+(384*t8
     #01*t394+384*t805*t398)*t48+(768*t813*t360+768*t817*t364)*s34r)*s1v
     #r+(3072*t653*t62-3072*t169*t65-3072*t169*t68)*t703
      s7 = s8+(-t838*s2l1+(-768*t840*t360-768*t840*t364)*s34r-3072*t846*
     #t65-3072*t846*t68)*t205+(-t863*s2l1+(-768*t865*t394-768*t865*t398)
     #*t48+(-768*t871*t360-768*t871*t364)*s34r)*s23r-t888*s2l1+(-768*t89
     #1*t435-768*t891*t438)*t305+(-768*t897*t394-768*t897*t398)*t48
      s8 = s1l2
      s6 = s7*s8
      s4 = s5+s6
      s1 = s3+s4
      s2 = s1+(768*t593*t12*s2l1-768*t593*t65*s2l2)*t594
      s3 = s2+(((5376*t598+t601)*s2l1+(-5376*t908-t911)*s2l2+2304*t660*t
     #112-2304*t660*t115)*s23r+(-384*t1092*t610-t617)*s2l1+(384*t1092*t9
     #16+t920)*s2l2)*t159
      s4 = s3
      s6 = (((-1536*t598-1536*t600)*s2l1+(1536*t908+1536*t910)*s2l2)*t20
     #5+(((384*t1112*t639-768*t1116*t644)*s34r-768*t1122*t151-768*t653*t
     #15)*s2l1+((-384*t1112*t931+768*t1116*t934)*s34r+768*t1122*t336+768
     #*t653*t68)*s2l2+768*t1143*t112-768*t1143*t115)*s23r+((-3840*t672-3
     #072*t674)*t48+(384*t1156*t189+768*t1162*t196)*s34r-768*t1169*t12)*
     #s2l1+((3840*t949+3072*t951)*t48+(-384*t1156*t360-768*t1162*t364)*s
     #34r+768*t1169*t65)*s2l2+384*t1188*s34r-768*t10*s4l2p*t65+768*t10*s
     #4l1p*t12)*t19
      s7 = (((-768*t1200*t151-768*t1200*t155)*s2l1+(768*t1200*t336+768*t
     #1200*t340)*s2l2+768*t169*t112-768*t169*t115)*t205+(((384*t1220*t18
     #9-768*t1225*t196)*s34r+768*t1231*t12-768*t1235*t15)*s2l1+((-384*t1
     #220*t360+768*t1225*t364)*s34r-768*t1231*t65+768*t1235*t68)*s2l2-23
     #04*t1188*s34r+768*t1255*t112-768*t1255*t115)*s23r+((384*t1264*t246
     #-768*t1269*t253)*t48+(384*t1276*t189-768*t1280*t196)*s34r)*s2l1+((
     #-384*t1264*t394+768*t1269*t398)*t48+(-384*t1276*t360+768*t1280*t36
     #4)*s34r)*s2l2+1536*t497*t48+(384*t1305*t112-384*t1305*t115)*s34r)*
     #s1vr
      s5 = s6+s7
      taux4 = s4+s5

CCC Coefficients

      tcoff7 = taux4
      tcoff8 = taux4

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet7 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,7.D0,1.D0,1.D0,Tcoeff*tcoff7)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = -l3+1
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet8 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff8)

CCC Sum

      qgrmnum3e1 = tFjet7*tcoff7+tFjet8*tcoff8
      RETURN
      END

      double precision function qgrmnum3e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = t1**2
      t3 = l3-1
      t4 = t3**2
      t5 = t2*t4
      t6 = 1/s3vr
      t7 = t6*s2l2
      t8 = t5*t7
      t10 = t2*t1
      t11 = t10*t4
      t12 = t6*s3l2p
      t13 = t11*t12
      t15 = s4l2p*t6
      t16 = t11*t15
      t19 = s1vr**2
      t24 = t4*t3
      t25 = t10*t24
      t26 = t6*s34r
      t27 = t26*s2l2
      t28 = t25*t27
      t30 = t2**2
      t31 = t24*t30
      t32 = t31*t12
      t34 = t31*t15
      t46 = t4**2
      t47 = t30*t46
      t48 = s34r**2
      t49 = t6*t48
      t53 = t30*t1
      t54 = t53*t46
      t62 = t6*s2l1
      t63 = t5*t62
      t65 = t6*s3l1p
      t66 = t11*t65
      t68 = s4l1p*t6
      t69 = t11*t68
      t76 = t26*s2l1
      t77 = t25*t76
      t79 = t31*t65
      t81 = t31*t68
      t111 = t30*t4
      t112 = t15*s3l1p
      t115 = t68*s3l2p
      t138 = t53*t24
      t147 = s13r**2
      t149 = t3*t2
      t150 = l3*t6
      t152 = t149*t150*s2l2
      t154 = t3*t10
      t155 = t150*s3l2p
      t156 = t154*t155
      t159 = l3*s4l2p*t6
      t160 = t154*t159
      t163 = t19*s1vr
      t170 = l3*t10
      t171 = t4*t6
      t172 = t171*s34r
      t173 = t170*t172
      t175 = t1*z
      t176 = t3*t6
      t179 = 16896*t173+2304*t175*t176
      t181 = t111*t155
      t183 = t111*t159
      t187 = 17*z
      t189 = (-t187+4)*t2
      t190 = t176*s3l2p
      t193 = 2*z
      t195 = (-1+t193)*t3
      t204 = 2304*t160
      t206 = s23r**2
      t209 = 4*z
      t214 = -18048*t173-768*(-1-t209)*t1*t176
      t222 = (9-22*z)*t2
      t225 = t3*s4l2p
      t226 = t225*t6
      t232 = t31*t150*t48
      t239 = -10752*t232-768*(-24*z+2)*t2*t172
      t241 = t138*t155
      t242 = 1152*t241
      t243 = t138*t159
      t249 = (10-25*z)*t10
      t250 = t171*s3l2p
      t253 = 37*z
      t255 = (17-t253)*t10
      t257 = t4*s4l2p*t6
      t267 = -11520*t173-3840*t149*t6
      t269 = t181+t183
      t272 = -t3
      t274 = 5*t272*t10
      t287 = -21504*t232+768*(-38*z+13)*t2*t172
      t296 = 7*z
      t301 = (-3*t10*(8*z-3)+2*t10*(2-t296))*t4
      t309 = l3*t53
      t311 = t48*s34r
      t316 = 18-33*z
      t318 = t24*t6
      t322 = -9984*t309*t46*t6*t311+768*t316*t10*t318*t48
      t324 = t30*t2
      t325 = t46*t324
      t331 = t316*t30
      t332 = t318*s3l2p
      t335 = t24*s4l2p*t6
      t343 = t149*t150*s2l1
      t345 = t150*s3l1p
      t346 = t154*t345
      t349 = l3*s4l1p*t6
      t350 = t154*t349
      t361 = t111*t345
      t363 = t111*t349
      t367 = t176*s3l1p
      t378 = 2304*t350
      t389 = t3*s4l1p
      t390 = t389*t6
      t397 = t138*t345
      t398 = 1152*t397
      t399 = t138*t349
      t403 = t171*s3l1p
      t407 = t4*s4l1p*t6
      t416 = -t361-t363
      t444 = t318*s3l1p
      t447 = t24*s4l1p*t6
      t461 = t30*t3*l3
      t462 = t461*t112
      t464 = t461*t115
      t468 = t154*l3
      t469 = t12*s2l1
      t471 = t65*s2l2
      t481 = (-5+11*z)*t2
      t484 = -3+t209
      t485 = t484*t2
      t499 = t309*t4
      t502 = -t499*t112+t499*t115
      t507 = (-5+z)*t3*t10
      t527 = (t296-1)*t2
      t546 = (-3+z)*t3*t10
      t556 = 20*z
      t558 = (-13+t556)*t10
      t562 = (-8+21*z)*t10
      t581 = (-5+t193)*t30*t4
      t591 = l3**2
      t592 = t10*t591
      t593 = t19**2
      t597 = t591*t2
      t598 = t597*t7
      t600 = t592*t12
      t602 = t592*t15
      t606 = t154*t591
      t610 = 9*t272*t30
      t611 = t591*t6
      t612 = t611*s3l2p
      t615 = t272*t30
      t617 = t591*s4l2p*t6
      t618 = t615*t617
      t622 = z*t2
      t634 = t611*s34r
      t639 = 14592*t272*t10*t634-3840*t175*t150
      t642 = 40*t272*t30
      t645 = 30*t272*t30
      t650 = l3*t2
      t653 = t296+3
      t654 = t653*t2
      t659 = t591*t30
      t660 = t171*t48
      t661 = t659*t660
      t667 = t176*s34r
      t670 = -9216*t661-768*(15*z-5)*l3*t2*t667
      t672 = t4*t53
      t673 = t672*t612
      t675 = t672*t617
      t681 = (-12+t253)*l3*t10
      t684 = t170*z
      t685 = t684*t226
      t689 = z**2
      t692 = (3-6*t689)*t1
      t701 = t206*s23r
      t707 = 3*z
      t712 = -21888*t272*t10*t634+768*(-t707-2)*t1*t150
      t715 = 43*t272*t30
      t718 = 39*t272*t30
      t723 = 14*z
      t725 = (10-t723)*t2
      t728 = 9*z
      t730 = (5-t728)*t2
      t745 = 32640*t661+384*(t707-11)*l3*t2*t667-768*t653*z*t6
      t754 = (46-47*z)*l3*t10
      t759 = (39-31*z)*l3*t10
      t766 = (z+5-13*t689)*t1
      t771 = (5-10*t689-t193)*t1
      t790 = 14592*t138*t611*t311+384*(10*z-7)*l3*t10*t660+768*(-5-15*t6
     #89+t209)*t1*t667
      t795 = t591*t24
      t804 = (-t187+26)*l3*t30
      t808 = (29-t723)*l3*t30
      t815 = (-5+t556-26*t689)*t2
      t819 = (15-t556)*z*t2
      t834 = (18-28*z)*l3
      t840 = -768*t834*t2*t667+3840*t175*t6
      t842 = t834*t10
      t856 = (31-43*z)*l3
      t861 = (13-23*z)*z
      t865 = -768*t856*t10*t660-768*t861*t1*t667
      t867 = t856*t30
      t873 = t861*t2
      t881 = -t556+18
      t886 = t881*z
      t890 = -768*t881*t24*t30*t150*t311-768*t886*t2*t660
      t893 = t881*l3*t53
      t899 = t886*t10
      t910 = t597*t62
      t912 = t592*t65
      t914 = t592*t68
      t920 = t611*s3l1p
      t924 = t591*s4l1p*t6
      t925 = t615*t924
      t953 = t672*t920
      t955 = t672*t924
      t961 = t684*t390
      t1079 = t659*t112
      t1081 = t659*t115
      t1098 = 7*t3*t30
      t1104 = 6*z
      t1106 = (1+t1104)*t2
      t1121 = t272*t53*t591
      t1129 = (-t707+1)*l3*t10
      t1145 = 17*t3*t30
      t1153 = 5*t2*t1
      t1175 = -3*t1*l3*t10
      t1188 = (-6+t209)*l3*t10
      t1194 = 4*t689
      t1196 = (-t1104+t1194+1)*t1
      t1215 = z*l3*t30
      t1225 = (-1-2*t689)*t2
      t1233 = -t484*t2
      t1252 = (-10+t187)*l3*t10
      t1257 = (7-t728)*l3*t10
      t1264 = (3*t689-2)*t1
      t1268 = (z+2-t1194)*t1
      t1289 = (-3-t689+t193)*t2
      t1298 = (-4+t728)*l3*t30
      t1304 = (-5*z+4)*l3*t30
      t1312 = (6-19*z+11*t689)*t2
      t1317 = (t209-5*t689+2)*t2
      t1342 = (-t707-t1194+4)*t3*t10
      s3 = (((-3840*t8-5376*t13-1536*t16)*t19+((3840*t8+3840*t13+3840*t1
     #6)*s23r-5376*t28+(15360*t32+11520*t34)*s34r)*s1vr+(11520*t28+(-115
     #20*t32-11520*t34)*s34r)*s23r+9984*t47*t49*s2l2+(-9984*t54*t12-9984
     #*t54*t15)*t48)*s1l1+((3840*t63+5376*t66+1536*t69)*t19+((-3840*t63-
     #3840*t66-3840*t69)*s23r+5376*t77+(-15360*t79-11520*t81)*s34r)*s1vr
     #+(-11520*t77+(11520*t79+11520*t81)*s34r)*s23r-9984*t47*t49*s2l1+(9
     #984*t54*t65+9984*t54*t68)*t48)*s1l2+((-3840*t13-2304*t16)*s2l1+(38
     #40*t66+2304*t69)*s2l2-768*t111*t112+768*t111*t115)*t19+(((1536*t13
     #+1536*t16)*s2l1+(-1536*t66-1536*t69)*s2l2)*s23r+(1920*t32+3456*t34
     #)*s34r*s2l1+(-1920*t79-3456*t81)*s34r*s2l2+(768*t138*t112-768*t138
     #*t115)*s34r)*s1vr)*t147
      s7 = ((-768*t152+9216*t156+3072*t160)*t163+((9216*t152-5376*t156-7
     #680*t160)*s23r+t179*s2l2+(-20352*t181-14592*t183)*s34r-768*t189*t1
     #90+1536*t195*t2*s4l2p*t6)*t19+((-7680*t152-2304*t156-t204)*t206+(t
     #214*s2l2+(-1920*t181-384*t183)*s34r+768*t222*t190+768*t189*t226)*s
     #23r+t239*s2l2+(t242+1536*t243)*t48+(1536*t249*t250+768*t255*t257)*
     #s34r)*s1vr+(t267*s2l2+11520*t269*s34r-768*t274*t12-768*t274*t15)*t
     #206+(t287*s2l2+(21504*t241+21504*t243)*t48+(-768*t301*t12-768*t301
     #*t15)*s34r)*s23r+t322*s2l2+(9984*t325*t155+9984*t325*t159)*t311+(-
     #768*t331*t332-768*t331*t335)*t48)*s1l1
      s8 = ((768*t343-9216*t346-3072*t350)*t163+((-9216*t343+5376*t346+7
     #680*t350)*s23r-t179*s2l1+(20352*t361+14592*t363)*s34r+768*t189*t36
     #7-1536*t195*t2*s4l1p*t6)*t19+((7680*t343+2304*t346+t378)*t206+(-t2
     #14*s2l1+(1920*t361+384*t363)*s34r-768*t222*t367-768*t189*t390)*s23
     #r-t239*s2l1+(-t398-1536*t399)*t48+(-1536*t249*t403-768*t255*t407)*
     #s34r)*s1vr+(-t267*s2l1+11520*t416*s34r+768*t274*t65+768*t274*t68)*
     #t206+(-t287*s2l1+(-21504*t397-21504*t399)*t48+(768*t301*t65+768*t3
     #01*t68)*s34r)*s23r-t322*s2l1+(-9984*t325*t345-9984*t325*t349)*t311
     #+(768*t331*t444+768*t331*t447)*t48)*s1l2
      s6 = s7+s8
      s5 = s6+((6912*t156+t204)*s2l1+(-6912*t346-t378)*s2l2+1536*t462-15
     #36*t464)*t163+((1536*t468*t469-1536*t468*t471)*s23r+(-3072*t269*s3
     #4r+768*t481*t190+768*t485*t226)*s2l1+(-3072*t416*s34r-768*t481*t36
     #7-768*t485*t390)*s2l2+1536*t502*s34r+768*t507*t112-768*t507*t115)*
     #t19+(((-1536*t156-1536*t160)*s2l1+(1536*t346+1536*t350)*s2l2)*t206
     #+(((-2688*t181-4992*t183)*s34r-768*t527*t190-768*t527*t226)*s2l1+(
     #(2688*t361+4992*t363)*s34r+768*t527*t367+768*t527*t390)*s2l2-768*t
     #546*t112+768*t546*t115)*s23r+((-t242-3456*t243)*t48+(-384*t558*t25
     #0-384*t562*t257)*s34r)*s2l1+((t398+3456*t399)*t48+(384*t558*t403+3
     #84*t562*t407)*s34r)*s2l2+(-384*t581*t112+384*t581*t115)*s34r)*s1vr
      s6 = s13r
      s4 = s5*s6
      s2 = s3+s4
      s3 = s2
      s8 = -1536*t592*t12*t593+((768*t598-8448*t600-3840*t602)*s23r-1536
     #*t606*t27+(384*t610*t612+1536*t618)*s34r-5376*t622*t155)*t163
      s7 = s8+((-5376*t598+11520*t600+9984*t602)*t206+(t639*s2l2+(-768*t
     #642*t612-768*t645*t617)*s34r+5376*t650*t12+768*t654*t159)*s23r+t67
     #0*s2l2+(19200*t673+13056*t675)*t48+(384*t681*t190+9984*t685)*s34r+
     #768*t692*t12)*t19+((3840*t598-1536*t600-1536*t602)*t701+(t712*s2l2
     #+(384*t715*t612+384*t718*t617)*s34r-768*t725*t155-768*t730*t159)*t
     #206+(t745*s2l2+(-29184*t673-24960*t675)*t48+(-384*t754*t190-384*t7
     #59*t226)*s34r-768*t766*t12-768*t771*t15)*s23r+t790*s2l2+(-14208*t2
     #4*t324*t612-11520*t795*t324*s4l2p*t6)*t311+(-384*t804*t250-384*t80
     #8*t257)*t48+(-768*t815*t190-768*t819*t226)*s34r)*s1vr+(3840*t650*t
     #7-3840*t170*t12-3840*t170*t15)*t701
      s6 = s7+(t840*s2l2+(768*t842*t190+768*t842*t226)*s34r-3840*t622*t1
     #2-3840*t622*t15)*t206+(t865*s2l2+(768*t867*t250+768*t867*t257)*t48
     #+(768*t873*t190+768*t873*t226)*s34r)*s23r+t890*s2l2+(768*t893*t332
     #+768*t893*t335)*t311+(768*t899*t250+768*t899*t257)*t48
      s7 = s1l1
      s5 = s6*s7
      s9 = 1536*t592*t65*t593+((-768*t910+8448*t912+3840*t914)*s23r+1536
     #*t606*t76+(-384*t610*t920-1536*t925)*s34r+5376*t622*t345)*t163
      s8 = s9+((5376*t910-11520*t912-9984*t914)*t206+(-t639*s2l1+(768*t6
     #42*t920+768*t645*t924)*s34r-5376*t650*t65-768*t654*t349)*s23r-t670
     #*s2l1+(-19200*t953-13056*t955)*t48+(-384*t681*t367-9984*t961)*s34r
     #-768*t692*t65)*t19+((-3840*t910+1536*t912+1536*t914)*t701+(-t712*s
     #2l1+(-384*t715*t920-384*t718*t924)*s34r+768*t725*t345+768*t730*t34
     #9)*t206+(-t745*s2l1+(29184*t953+24960*t955)*t48+(384*t754*t367+384
     #*t759*t390)*s34r+768*t766*t65+768*t771*t68)*s23r-t790*s2l1+(14208*
     #t795*t324*t6*s3l1p+11520*t795*t324*s4l1p*t6)*t311+(384*t804*t403+3
     #84*t808*t407)*t48+(768*t815*t367+768*t819*t390)*s34r)*s1vr+(-3840*
     #t650*t62+3840*t170*t65+3840*t170*t68)*t701
      s7 = s8+(-t840*s2l1+(-768*t842*t367-768*t842*t390)*s34r+3840*t622*
     #t65+3840*t622*t68)*t206+(-t865*s2l1+(-768*t867*t403-768*t867*t407)
     #*t48+(-768*t873*t367-768*t873*t390)*s34r)*s23r-t890*s2l1+(-768*t89
     #3*t444-768*t893*t447)*t311+(-768*t899*t403-768*t899*t407)*t48
      s8 = s1l2
      s6 = s7*s8
      s4 = s5+s6
      s1 = s3+s4
      s2 = s1+(-1536*t592*t469+1536*t592*t471+768*t1079-768*t1081)*t593
      s3 = s2+(((-6144*t600-3072*t602)*s2l1+(6144*t912+3072*t914)*s2l2-1
     #536*t1079+1536*t1081)*s23r+((-384*t1098*t612+768*t618)*s34r-768*t1
     #106*t155)*s2l1+((384*t1098*t920-768*t925)*s34r+768*t1106*t345)*s2l
     #2+(768*t1121*t112-768*t1121*t115)*s34r-768*t1129*t112+768*t1129*t1
     #15)*t163
      s4 = s3
      s6 = (((3072*t600+3072*t602)*s2l1+(-3072*t912-3072*t914)*s2l2)*t20
     #6+(((384*t1145*t612-768*t610*t617)*s34r-768*t1153*t155+768*t650*t1
     #5)*s2l1+((-384*t1145*t920+768*t610*t924)*s34r+768*t1153*t345-768*t
     #650*t68)*s2l2+768*t1175*t112-768*t1175*t115)*s23r+((3456*t673+3840
     #*t675)*t48+(384*t1188*t190+3072*t685)*s34r-768*t1196*t12)*s2l1+((-
     #3456*t953-3840*t955)*t48+(-384*t1188*t367-3072*t961)*s34r+768*t119
     #6*t65)*s2l2+(-2304*t1215*t225*t65+2304*t1215*t389*t12)*s34r-768*t1
     #225*t112+768*t1225*t115)*t19
      s7 = (((-768*t1233*t155-768*t1233*t159)*s2l1+(768*t1233*t345+768*t
     #1233*t349)*s2l2-2304*t170*t112+2304*t170*t115)*t206+(((384*t1252*t
     #190-768*t1257*t226)*s34r+768*t1264*t12-768*t1268*t15)*s2l1+((-384*
     #t1252*t367+768*t1257*t390)*s34r-768*t1264*t65+768*t1268*t68)*s2l2+
     #(-3072*t462+3072*t464)*s34r+768*t1289*t112-768*t1289*t115)*s23r+((
     #384*t1298*t250-768*t1304*t257)*t48+(384*t1312*t190-768*t1317*t226)
     #*s34r)*s2l1+((-384*t1298*t403+768*t1304*t407)*t48+(-384*t1312*t367
     #+768*t1317*t390)*s34r)*s2l2+768*t502*t48+(384*t1342*t112-384*t1342
     #*t115)*s34r)*s1vr
      s5 = s6+s7
      taux4 = s4+s5

CCC Coefficients

      tcoff7 = taux4
      tcoff8 = taux4

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet7 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,7.D0,1.D0,1.D0,Tcoeff*tcoff7)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = -l3+1
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet8 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff8)

CCC Sum

      qgrmnum3e2 = tFjet7*tcoff7+tFjet8*tcoff8
      RETURN
      END

      double precision function qgrmnum3e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = t1**2
      t3 = l3-1
      t4 = t3**2
      t5 = t2*t4
      t6 = 1/s3vr
      t7 = t6*s2l2
      t8 = t5*t7
      t9 = t2*t1
      t10 = t9*t4
      t11 = t6*s3l2p
      t12 = t10*t11
      t15 = s1vr**2
      t17 = s4l2p*t6
      t18 = t10*t17
      t22 = t4*t3
      t23 = t9*t22
      t24 = t6*s34r
      t26 = t23*t24*s2l2
      t28 = t2**2
      t29 = t22*t28
      t30 = t29*t11
      t32 = t29*t17
      t44 = t4**2
      t45 = t28*t44
      t46 = s34r**2
      t47 = t6*t46
      t51 = t28*t1
      t52 = t51*t44
      t60 = t6*s2l1
      t61 = t5*t60
      t62 = t6*s3l1p
      t63 = t10*t62
      t67 = s4l1p*t6
      t68 = t10*t67
      t73 = t23*t24*s2l1
      t75 = t29*t62
      t77 = t29*t67
      t105 = t28*t4
      t106 = t17*s3l1p
      t109 = t67*s3l2p
      t124 = t51*t22
      t133 = s13r**2
      t135 = t3*t2
      t136 = l3*t6
      t138 = t135*t136*s2l2
      t140 = t3*t9
      t141 = t136*s3l2p
      t142 = t140*t141
      t145 = t15*s1vr
      t147 = 3072*t138
      t148 = 4608*t142
      t150 = l3*s4l2p*t6
      t151 = t140*t150
      t152 = 3072*t151
      t155 = l3*t9
      t156 = t4*t6
      t157 = t156*s34r
      t158 = t155*t157
      t159 = t1*z
      t160 = t3*t6
      t163 = -1536*t158-1536*t159*t160
      t165 = t105*t141
      t167 = t105*t150
      t171 = z*t3
      t172 = t2*t6
      t179 = 1536*t151
      t181 = s23r**2
      t187 = -768*t158-1536*t1*t3*t6
      t193 = 4*z
      t195 = (-1+t193)*t2
      t196 = t160*s3l2p
      t206 = t29*t136*t46
      t208 = z*t2
      t211 = -3072*t206-6144*t208*t157
      t213 = t124*t141
      t215 = t124*t150
      t219 = 5*z
      t221 = (-2+t219)*t9
      t222 = t156*s3l2p
      t225 = 7*z
      t227 = (-3+t225)*t9
      t229 = t4*s4l2p*t6
      t239 = 4608*t158+1536*t135*t6
      t245 = 1536*t140*t11
      t247 = 1536*t140*t17
      t252 = 8*z-3
      t256 = 9216*t206+1536*t252*t2*t157
      t261 = t252*t6
      t272 = l3*t51
      t274 = t46*s34r
      t278 = -4+t225
      t280 = t22*t6
      t284 = 4608*t272*t44*t6*t274+1536*t278*t9*t280*t46
      t286 = t28*t2
      t287 = t44*t286
      t293 = t278*t28
      t294 = t280*s3l2p
      t297 = t22*s4l2p*t6
      t305 = t135*t136*s2l1
      t307 = t136*s3l1p
      t308 = t140*t307
      t312 = 3072*t305
      t313 = 4608*t308
      t315 = l3*s4l1p*t6
      t316 = t140*t315
      t317 = 3072*t316
      t322 = t105*t307
      t324 = t105*t315
      t334 = 1536*t316
      t343 = t160*s3l1p
      t354 = t124*t307
      t356 = t124*t315
      t360 = t156*s3l1p
      t364 = t4*s4l1p*t6
      t377 = 1536*t140*t62
      t379 = 1536*t140*t67
      t404 = t280*s3l1p
      t407 = t22*s4l1p*t6
      t418 = t28*t3
      t419 = t418*l3
      t420 = t419*t106
      t422 = t419*t109
      t439 = (-5+t225)*t2
      t442 = -3+t193
      t443 = t442*t2
      t444 = t3*s4l2p
      t445 = t444*t6
      t456 = t3*s4l1p
      t457 = t456*t6
      t462 = t272*t4
      t465 = -t462*t106+t462*t109
      t468 = 3*z
      t469 = -1+t468
      t471 = t469*t3*t9
      t490 = z+1
      t492 = t490*t3*t9
      t505 = (-5+12*z)*t9
      t508 = (-4+z)*t9
      t526 = 6*z
      t529 = (t526-1)*t28*t4
      t539 = l3**2
      t540 = t539*t2
      t541 = t540*t7
      t542 = t9*t539
      t543 = t542*t11
      t544 = t542*t17
      t548 = t539*t6
      t549 = t548*s3l2p
      t550 = t418*t549
      t551 = 2304*t550
      t553 = t539*s4l2p*t6
      t554 = t418*t553
      t559 = (t468-2)*t2
      t568 = t140*t548*s34r
      t571 = 1536*t159*t136
      t572 = 3072*t568-t571
      t579 = (-3+t526)*t2
      t583 = 3*t2*t1
      t588 = t539*t28
      t589 = t156*t46
      t590 = t588*t589
      t593 = t160*s34r
      t596 = 1536*t590-1536*t490*l3*t2*t593
      t598 = t51*t4
      t599 = t598*t549
      t600 = 4608*t599
      t601 = t598*t553
      t605 = 15*z
      t608 = (t605-10)*l3*t9
      t612 = (2+z)*l3
      t613 = t612*t9
      t618 = z**2
      t619 = 2*t618
      t621 = (-1+t619)*t1
      t626 = t181*s23r
      t631 = -3840*t568+t571
      t637 = (-2+t193)*t2
      t640 = t469*t2
      t655 = -3840*t590+768*(11*z-3)*l3*t2*t593+1536*t490*z*t6
      t663 = (-18+25*z)*l3*t9
      t667 = (-13+t605)*l3*t9
      t672 = 3*t618
      t674 = (-z-1+t672)*t1
      t692 = -1536*t124*t548*t274+768*t252*l3*t9*t589+1536*(1+t672)*t1*t
     #593
      t697 = t539*t22
      t707 = (-14+17*z)*l3*t28
      t711 = (-11+t526)*l3*t28
      t718 = (1-t193+6*t618)*t2
      t721 = t442*z*t2
      t728 = l3*t2
      t736 = (-4+t526)*l3
      t741 = -1536*t736*t2*t593-1536*t159*t6
      t743 = t736*t9
      t757 = (-7+9*z)*l3
      t761 = (-3+t219)*z
      t765 = -1536*t757*t9*t589-1536*t761*t1*t593
      t767 = t757*t28
      t773 = t761*t2
      t781 = 4*t1
      t786 = t781*z
      t790 = -1536*t781*t22*t28*t136*t274-1536*t786*t2*t589
      t793 = t781*l3*t51
      t799 = t786*t9
      t807 = t540*t60
      t808 = t542*t62
      t809 = t542*t67
      t813 = t548*s3l1p
      t814 = t418*t813
      t815 = 2304*t814
      t817 = t539*s4l1p*t6
      t818 = t418*t817
      t843 = t598*t813
      t844 = 4608*t843
      t845 = t598*t817
      t964 = t15**2
      t974 = -t551+1536*t554
      t981 = t815-1536*t818
      t988 = t3*t51*t539
      t996 = (-5+t468)*l3*t9
      t1005 = -3+z
      t1006 = t1005*t2
      t1009 = t728*t17
      t1017 = t728*t67
      t1022 = t1005*l3*t9
      t1035 = 4*t490*l3*t9
      t1040 = 4*t618
      t1042 = (-t526+3+t1040)*t1
      t1061 = (-10+t526)*l3*t28
      t1069 = 2*z
      t1071 = (3-t1069+t619)*t2
      t1094 = (-6+t468)*l3*t9
      t1099 = (3+z)*l3*t9
      t1105 = (-t1069+t618)*t1
      t1128 = (1+t618)*t2
      t1137 = (-4+t468)*l3*t28
      t1140 = t612*t28
      t1147 = (-t225-2+7*t618)*t2
      t1151 = (t1069+t618)*t2
      t1177 = (-t468+t1040)*t3*t9
      s3 = (((1536*t8+1536*t12)*t15+((-1536*t8-1536*t12-1536*t18)*s23r+1
     #536*t26+(-6144*t30-4608*t32)*s34r)*s1vr+(-4608*t26+(4608*t30+4608*
     #t32)*s34r)*s23r-4608*t45*t47*s2l2+(4608*t52*t11+4608*t52*t17)*t46)
     #*s1l1+((-1536*t61-1536*t63)*t15+((1536*t61+1536*t63+1536*t68)*s23r
     #-1536*t73+(6144*t75+4608*t77)*s34r)*s1vr+(4608*t73+(-4608*t75-4608
     #*t77)*s34r)*s23r+4608*t45*t47*s2l1+(-4608*t52*t62-4608*t52*t67)*t4
     #6)*s1l2+((-4608*t12-4608*t18)*s2l1+(4608*t63+4608*t68)*s2l2-1536*t
     #105*t106+1536*t105*t109)*t15+((3840*t30+768*t32)*s34r*s2l1+(-3840*
     #t75-768*t77)*s34r*s2l2+(1536*t124*t106-1536*t124*t109)*s34r)*s1vr)
     #*t133
      s7 = ((1536*t138+3072*t142)*t145+((-t147-t148-t152)*s23r+t163*s2l2
     #+(-6912*t165+1536*t167)*s34r-4608*t171*t172*s3l2p)*t15+((t147+1536
     #*t142+t179)*t181+(t187*s2l2+(9984*t165+6912*t167)*s34r+1536*t195*t
     #196+4608*t171*t2*s4l2p*t6)*s23r+t211*s2l2+(8448*t213+3072*t215)*t4
     #6+(3072*t221*t222+1536*t227*t229)*s34r)*s1vr+(t239*s2l2+(-4608*t16
     #5-4608*t167)*s34r-t245-t247)*t181+(t256*s2l2+(-9216*t213-9216*t215
     #)*t46+(-1536*t10*t261*s3l2p-1536*t10*t252*s4l2p*t6)*s34r)*s23r+t28
     #4*s2l2+(-4608*t287*t141-4608*t287*t150)*t274+(-1536*t293*t294-1536
     #*t293*t297)*t46)*s1l1
      s8 = ((-1536*t305-3072*t308)*t145+((t312+t313+t317)*s23r-t163*s2l1
     #+(6912*t322-1536*t324)*s34r+4608*t171*t172*s3l1p)*t15+((-t312-1536
     #*t308-t334)*t181+(-t187*s2l1+(-9984*t322-6912*t324)*s34r-1536*t195
     #*t343-4608*t171*t2*s4l1p*t6)*s23r-t211*s2l1+(-8448*t354-3072*t356)
     #*t46+(-3072*t221*t360-1536*t227*t364)*s34r)*s1vr+(-t239*s2l1+(4608
     #*t322+4608*t324)*s34r+t377+t379)*t181+(-t256*s2l1+(9216*t354+9216*
     #t356)*t46+(1536*t10*t261*s3l1p+1536*t10*t252*s4l1p*t6)*s34r)*s23r-
     #t284*s2l1+(4608*t287*t307+4608*t287*t315)*t274+(1536*t293*t404+153
     #6*t293*t407)*t46)*s1l2
      s6 = s7+s8
      s5 = s6+((t148+t179)*s2l1+(-t313-t334)*s2l2+3072*t420-3072*t422)*t
     #145+(((3072*t142+3072*t151)*s2l1+(-3072*t308-3072*t316)*s2l2)*s23r
     #+((-1536*t165+3072*t167)*s34r+1536*t439*t196+1536*t443*t445)*s2l1+
     #((1536*t322-3072*t324)*s34r-1536*t439*t343-1536*t443*t457)*s2l2+30
     #72*t465*s34r+1536*t471*t106-1536*t471*t109)*t15+((((-2304*t165-768
     #*t167)*s34r-t245-t247)*s2l1+((2304*t322+768*t324)*s34r+t377+t379)*
     #s2l2-1536*t492*t106+1536*t492*t109)*s23r+((-2304*t213-768*t215)*t4
     #6+(-768*t505*t222-768*t508*t229)*s34r)*s2l1+((2304*t354+768*t356)*
     #t46+(768*t505*t360+768*t508*t364)*s34r)*s2l2+(-768*t529*t106+768*t
     #529*t109)*s34r)*s1vr
      s6 = s13r
      s4 = s5*s6
      s2 = s3+s4
      s3 = s2
      s8 = ((-1536*t541-1536*t543+1536*t544)*s23r+(t551+3072*t554)*s34r-
     #1536*t559*t141)*t145+((1536*t541+1536*t543+1536*t544)*t181+(t572*s
     #2l2+(-3072*t550-6144*t554)*s34r+1536*t579*t141+1536*t583*t150)*s23
     #r+t596*s2l2+(-t600-7680*t601)*t46+(768*t608*t196-1536*t613*t445)*s
     #34r+1536*t621*t11)*t15
      s7 = s8+(-1536*t540*t7*t626+(t631*s2l2+(2304*t550+2304*t554)*s34r-
     #1536*t637*t141-1536*t640*t150)*t181+(t655*s2l2+(t600+6912*t601)*t4
     #6+(-768*t663*t196-768*t667*t445)*s34r-1536*t674*t11-1536*t621*t17)
     #*s23r+t692*s2l2+(2304*t22*t286*t549+4608*t697*t286*s4l2p*t6)*t274+
     #(-768*t707*t222-768*t711*t229)*t46+(-1536*t718*t196-1536*t721*t445
     #)*s34r)*s1vr+(-1536*t728*t7+1536*t155*t11+1536*t155*t17)*t626
      s6 = s7+(t741*s2l2+(1536*t743*t196+1536*t743*t445)*s34r+1536*t208*
     #t11+1536*t208*t17)*t181+(t765*s2l2+(1536*t767*t222+1536*t767*t229)
     #*t46+(1536*t773*t196+1536*t773*t445)*s34r)*s23r+t790*s2l2+(1536*t7
     #93*t294+1536*t793*t297)*t274+(1536*t799*t222+1536*t799*t229)*t46
      s7 = s1l1
      s5 = s6*s7
      s9 = ((1536*t807+1536*t808-1536*t809)*s23r+(-t815-3072*t818)*s34r+
     #1536*t559*t307)*t145+((-1536*t807-1536*t808-1536*t809)*t181+(-t572
     #*s2l1+(3072*t814+6144*t818)*s34r-1536*t579*t307-1536*t583*t315)*s2
     #3r-t596*s2l1+(t844+7680*t845)*t46+(-768*t608*t343+1536*t613*t457)*
     #s34r-1536*t621*t62)*t15
      s8 = s9+(1536*t540*t60*t626+(-t631*s2l1+(-2304*t814-2304*t818)*s34
     #r+1536*t637*t307+1536*t640*t315)*t181+(-t655*s2l1+(-t844-6912*t845
     #)*t46+(768*t663*t343+768*t667*t457)*s34r+1536*t674*t62+1536*t621*t
     #67)*s23r-t692*s2l1+(-2304*t697*t286*t6*s3l1p-4608*t697*t286*s4l1p*
     #t6)*t274+(768*t707*t360+768*t711*t364)*t46+(1536*t718*t343+1536*t7
     #21*t457)*s34r)*s1vr+(1536*t728*t60-1536*t155*t62-1536*t155*t67)*t6
     #26
      s7 = s8+(-t741*s2l1+(-1536*t743*t343-1536*t743*t457)*s34r-1536*t20
     #8*t62-1536*t208*t67)*t181+(-t765*s2l1+(-1536*t767*t360-1536*t767*t
     #364)*t46+(-1536*t773*t343-1536*t773*t457)*s34r)*s23r-t790*s2l1+(-1
     #536*t793*t404-1536*t793*t407)*t274+(-1536*t799*t360-1536*t799*t364
     #)*t46
      s8 = s1l2
      s6 = s7*s8
      s4 = s5+s6
      s1 = s3+s4
      s2 = s1+(-1536*t588*t106+1536*t588*t109)*t964
      s3 = s2+((-3072*t542*t11*s2l1+3072*t542*t62*s2l2)*s23r+(t974*s34r-
     #1536*t443*t141)*s2l1+(t981*s34r+1536*t443*t307)*s2l2+(1536*t988*t1
     #06-1536*t988*t109)*s34r-1536*t996*t106+1536*t996*t109)*t145
      s4 = s3
      s6 = (((-t974*s34r-1536*t1006*t141+1536*t1009)*s2l1+(-t981*s34r+15
     #36*t1006*t307-1536*t1017)*s2l2+1536*t1022*t106-1536*t1022*t109)*s2
     #3r+((2304*t599-1536*t601)*t46+(768*t1035*t196+t152)*s34r-1536*t104
     #2*t11)*s2l1+((-2304*t843+1536*t845)*t46+(-768*t1035*t343-t317)*s34
     #r+1536*t1042*t62)*s2l2+(768*t1061*t444*t62-768*t1061*t456*t11)*s34
     #r-1536*t1071*t106+1536*t1071*t109)*t15
      s7 = (((-1536*t728*t11-1536*t1009)*s2l1+(1536*t728*t62+1536*t1017)
     #*s2l2+1536*t155*t106-1536*t155*t109)*t181+(((768*t1094*t196-1536*t
     #1099*t445)*s34r+1536*t1105*t11-1536*t159*t17)*s2l1+((-768*t1094*t3
     #43+1536*t1099*t457)*s34r-1536*t1105*t62+1536*t159*t67)*s2l2+(3072*
     #t420-3072*t422)*s34r+1536*t1128*t106-1536*t1128*t109)*s23r+((768*t
     #1137*t222-1536*t1140*t229)*t46+(768*t1147*t196-1536*t1151*t445)*s3
     #4r)*s2l1+((-768*t1137*t360+1536*t1140*t364)*t46+(-768*t1147*t343+1
     #536*t1151*t457)*s34r)*s2l2-1536*t465*t46+(768*t1177*t106-768*t1177
     #*t109)*s34r)*s1vr
      s5 = s6+s7
      taux4 = s4+s5

CCC Coefficients

      tcoff7 = taux4
      tcoff8 = taux4

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet7 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,7.D0,1.D0,1.D0,Tcoeff*tcoff7)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = -l3+1
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet8 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff8)

CCC Sum

      qgrmnum3e3 = tFjet7*tcoff7+tFjet8*tcoff8
      RETURN
      END

      double precision function qgrmnum3e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux4 = 0

CCC Coefficients

      tcoff7 = taux4
      tcoff8 = taux4

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet7 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,7.D0,1.D0,1.D0,Tcoeff*tcoff7)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = -l3+1
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet8 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff8)

CCC Sum

      qgrmnum3e4 = tFjet7*tcoff7+tFjet8*tcoff8
      RETURN
      END

      double precision function qgrmnum4e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3-1
      t2 = -1+z
      t3 = t2**2
      t4 = t3*t2
      t5 = t1*t4
      t6 = t5*l3
      t7 = 1/s3vr
      t8 = t7*s3l2p
      t9 = s1vr**2
      t10 = t9*s1vr
      t13 = t1**2
      t14 = t3**2
      t15 = t13*t14
      t16 = t15*l3
      t17 = s34r*t9
      t23 = t7*s3l1p
      t31 = l3**2
      t32 = t5*t31
      t33 = z*t7
      t34 = t9**2
      t38 = t33*s23r
      t41 = l3*t7
      t42 = t41*s3l2p
      t45 = l3*s4l2p*t7
      t50 = t41*s3l1p
      t58 = t31*t15
      t60 = t58*t33*s34r
      t62 = t1*t14
      t66 = 64.D0/3.D0*t62*t45
      t67 = 128.D0/3.D0*t62*t42+t66
      t70 = l3*t1*t14
      t71 = s4l1p*t7
      t72 = t71*s3l2p
      t74 = 64.D0/3.D0*t70*t72
      t84 = t7*s34r
      t85 = t84*s2l2
      t88 = s4l2p*t7
      t89 = t88*s34r
      t95 = t71*s34r*s2l2
      t99 = t14*t2
      t102 = s34r**2
      t103 = t33*t102
      t106 = t13*t99
      t125 = t4*t31
      t132 = t32*t85
      t134 = t62*t31
      t136 = t134*t8*s34r
      t138 = t3*l3
      t143 = z*t3
      t149 = t31*t14
      t157 = 64.D0/3.D0*t149*t13*t7*t102+64.D0/3.D0*t1*t3*t41*s34r
      t159 = t106*t31
      t174 = t32*t84*s2l1
      t177 = t134*t23*s34r
      t196 = t31*l3
      t197 = t196*t4
      t203 = t23*s2l2
      t206 = t8*s3l1p
      t208 = 128.D0/3.D0*t149*t206
      t211 = s23r**2
      t212 = t33*t211
      t215 = t88*s2l1
      t218 = t71*s2l2
      t228 = -t2
      t236 = l3*t4
      t264 = z**2
      t270 = t228*t7*s3l2p
      s2 = ((-64.D0/3.D0*t6*t8*t10+64.D0/3.D0*t16*t8*t17)*s1l1+(-64.D0/3
     #.D0*t6*t23*t10+64.D0/3.D0*t16*t23*t17)*s1l2-64.D0/3.D0*t32*t33*t34
     #+(64.D0/3.D0*t32*t38+(64.D0/3.D0*t5*t42+64.D0/3.D0*t5*t45)*s2l1+(6
     #4.D0/3.D0*t5*t50+64.D0/3.D0*t5*l3*s4l1p*t7)*s2l2+128.D0/3.D0*t60+t
     #67*s3l1p+t74)*t10+((-64.D0/3.D0*t60-t67*s3l1p-t74)*s23r+(128.D0/3.
     #D0*t4*t13*l3*t85-64.D0/3.D0*t16*t89)*s2l1-64.D0/3.D0*t16*t95-64.D0
     #/3.D0*t13*t1*t99*t31*t103+((-128.D0/3.D0*t106*t42-64.D0/3.D0*l3*t9
     #9*t13*s4l2p*t7)*s3l1p-64.D0/3.D0*t106*l3*t72)*s34r)*t9)*s13r
      s3 = (-64.D0/3.D0*t125*t8*t34+(128.D0/3.D0*t125*t8*s23r-64.D0/3.D0
     #*t132+128.D0/3.D0*t136+64.D0/3.D0*t138*t8)*t10+((64.D0/3.D0*t132-6
     #4.D0/3.D0*t136+64.D0/3.D0*t143*t42+64.D0/3.D0*t138*t88)*s23r+t157*
     #s2l2-64.D0/3.D0*t159*t8*t102)*t9)*s1l1+(-64.D0/3.D0*t125*t23*t34+(
     #128.D0/3.D0*t125*t23*s23r-64.D0/3.D0*t174+128.D0/3.D0*t177+64.D0/3
     #.D0*t138*t23)*t10+((64.D0/3.D0*t174-64.D0/3.D0*t177+64.D0/3.D0*t14
     #3*t50+64.D0/3.D0*t138*t71)*s23r+t157*s2l1-64.D0/3.D0*t159*t23*t102
     #)*t9)*s1l2
      s1 = s2+s3
      taux5 = s1+(64.D0/3.D0*t197*t38-64.D0/3.D0*t125*t8*s2l1-64.D0/3.D0
     #*t125*t203-t208)*t34+(-64.D0/3.D0*t197*t212+(-64.D0/3.D0*t125*t215
     #-64.D0/3.D0*t125*t218-64.D0/3.D0*t196*t14*z*t1*t7*s34r+t208-64.D0/
     #3.D0*t31*t3*z*t228*t7)*s23r+(-128.D0/3.D0*t132-64.D0/3.D0*t236*t8)
     #*s2l1-64.D0/3.D0*t236*t203+(128.D0/3.D0*t31*t99*t1*t206+64.D0/3.D0
     #*t5*t31*z*t7)*s34r+128.D0/3.D0*t236*t228*t206)*t10+(-64.D0/3.D0*t1
     #25*t212+(-64.D0/3.D0*t236*t215-64.D0/3.D0*t236*t218-64.D0/3.D0*t32
     #*t264*t7*s34r+(-128.D0/3.D0*t236*t270-64.D0/3.D0*t236*t88)*s3l1p-6
     #4.D0/3.D0*t236*t72-128.D0/3.D0*t236*s4l2p*s4l1p*t7)*s23r+(-128.D0/
     #3.D0*t6*t85-64.D0/3.D0*t6*t89)*s2l1-64.D0/3.D0*t6*t95-64.D0/3.D0*t
     #58*t103+((-128.D0/3.D0*t70*t270-t66)*s3l1p-t74)*s34r)*t9
      t1 = l3-1
      t2 = -1+z
      t3 = t2**2
      t4 = t3*t2
      t5 = t1*t4
      t6 = t5*l3
      t7 = 1/s3vr
      t8 = t7*s3l2p
      t9 = s1vr**2
      t10 = t9*s1vr
      t13 = t1**2
      t14 = t3**2
      t16 = t13*t14*l3
      t17 = s34r*t9
      t23 = t7*s3l1p
      t31 = t1*t14
      t32 = t31*l3
      t33 = s4l2p*t7
      t34 = t33*s3l1p
      t35 = t32*t34
      t36 = s4l1p*t7
      t37 = t36*s3l2p
      t38 = t32*t37
      t42 = l3*t7
      t43 = t42*s3l2p
      t47 = t5*l3*s4l2p*t7
      t51 = t42*s3l1p
      t55 = t5*l3*s4l1p*t7
      t64 = t8*s34r*s2l1
      t68 = t23*s34r*s2l2
      t73 = l3*t14*t2*t13
      t83 = l3**2
      t84 = t4*t83
      t87 = t3*l3
      t95 = 256.D0/3.D0*t84*t8+256.D0/3.D0*t84*t33
      t96 = s23r**2
      t98 = t83*t7
      t107 = z*t3
      t115 = t1*t3*l3
      t116 = t7*s34r
      t133 = -256.D0/3.D0*t84*t23-256.D0/3.D0*t84*t36
      t162 = t31*t83
      t167 = l3*t4
      s1 = ((-256.D0/3.D0*t6*t8*t10+256.D0/3.D0*t16*t8*t17)*s1l1+(256.D0
     #/3.D0*t6*t23*t10-256.D0/3.D0*t16*t23*t17)*s1l2+(-256.D0/3.D0*t35+2
     #56.D0/3.D0*t38)*t10+(((256.D0/3.D0*t5*t43+256.D0/3.D0*t47)*s2l1+(-
     #256.D0/3.D0*t5*t51-256.D0/3.D0*t55)*s2l2+256.D0/3.D0*t35-256.D0/3.
     #D0*t38)*s23r+256.D0/3.D0*t16*t64-256.D0/3.D0*t16*t68+(256.D0/3.D0*
     #t73*t34-256.D0/3.D0*t73*t37)*s34r)*t9)*s13r+((-256.D0/3.D0*t84*t33
     #*s23r+256.D0/3.D0*t87*t8)*t10+(t95*t96+((256.D0/3.D0*t31*t98*s3l2p
     #+256.D0/3.D0*t31*t83*s4l2p*t7)*s34r+256.D0/3.D0*t107*t43+256.D0/3.
     #D0*t87*t33)*s23r+256.D0/3.D0*t115*t116*s2l2)*t9)*s1l1
      taux6 = s1+((256.D0/3.D0*t84*t36*s23r-256.D0/3.D0*t87*t23)*t10+(t1
     #33*t96+((-256.D0/3.D0*t31*t98*s3l1p-256.D0/3.D0*t31*t83*s4l1p*t7)*
     #s34r-256.D0/3.D0*t107*t51-256.D0/3.D0*t87*t36)*s23r-256.D0/3.D0*t1
     #15*t116*s2l1)*t9)*s1l2+((-t95*s2l1-t133*s2l2)*s23r-256.D0/3.D0*t16
     #2*t64+256.D0/3.D0*t162*t68+256.D0/3.D0*t167*t34-256.D0/3.D0*t167*t
     #37)*t10+(((-256.D0/3.D0*t167*t8-256.D0/3.D0*t167*t33)*s2l1+(256.D0
     #/3.D0*t167*t23+256.D0/3.D0*t167*t36)*s2l2)*s23r+(-256.D0/3.D0*t31*
     #t43+256.D0/3.D0*t47)*s34r*s2l1+(256.D0/3.D0*t31*t51-256.D0/3.D0*t5
     #5)*s34r*s2l2)*t9

CCC Coefficients

      tcoff9 = taux5
      tcoff10 = taux5
      tcoff11 = taux6
      tcoff12 = taux6

CCC Jet functions

      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet9 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,5.D0,1.D0,1.D0,Tcoeff*tcoff9)
      t2 = -l3+1
      t3 = 1-z
      t5 = t2*t3*s13r
      t6 = t3*l3
      t7 = t6*s23r
      t8 = t6*s1vr
      t11 = t3**2
      t13 = l3*t2*t11*s34r
      tFjet10 = Fjet(var,ndim,z,1/ux,t5,t7,-1-t5-t8+z,t8-t7-t13,t13,t8,-
     #1+z-t8+t13,-t5-t7-t13+z,1+t5+t7,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff10)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet11 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff11)
      t2 = -l3+1
      t3 = 1-z
      t5 = t2*t3*s13r
      t6 = t3*l3
      t7 = t6*s23r
      t8 = t6*s1vr
      t11 = t3**2
      t13 = l3*t2*t11*s34r
      tFjet12 = Fjet(var,ndim,z,1/ux,t5,t7,-1-t5-t8+z,t8-t7-t13,t13,t8,-
     #1+z-t8+t13,-t5-t7-t13+z,1+t5+t7,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff12)

CCC Sum

      qgrmnum4e0 = tFjet9*tcoff9+tFjet10*tcoff10+tFjet11*tcoff11+tFjet12
     #*tcoff12
      RETURN
      END

      double precision function qgrmnum4e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3-1
      t2 = t1**2
      t3 = -1+z
      t4 = t3**2
      t5 = t4*t3
      t6 = t2*t5
      t7 = l3*t6
      t8 = 1/s3vr
      t9 = z*t8
      t10 = s1vr**2
      t11 = t10*s1vr
      t15 = t8*s3l2p
      t17 = s4l2p*t8
      t22 = t8*s3l1p
      t24 = s4l1p*t8
      t29 = t2*t1
      t30 = t4**2
      t33 = s34r*t9
      t39 = s13r**2
      t41 = t5*t1
      t42 = t41*l3
      t46 = l3*t8
      t47 = t46*s3l2p
      t48 = t41*t47
      t49 = l3*s4l2p
      t51 = t41*t49*t8
      t55 = t8*s34r
      t56 = t55*s2l2
      t59 = t30*t2
      t60 = t59*l3
      t71 = t46*s3l1p
      t72 = t41*t71
      t75 = t41*l3*s4l1p*t8
      t79 = t55*s2l1
      t89 = l3**2
      t90 = t41*t89
      t91 = t10**2
      t95 = t9*s23r
      t106 = t30*t1
      t107 = t106*l3
      t108 = t17*s3l1p
      t110 = 64.D0/3.D0*t107*t108
      t111 = t24*s3l2p
      t113 = 64.D0/3.D0*t107*t111
      t114 = t49*s4l1p
      t115 = t106*t114
      t117 = t1*t4
      t118 = z**2
      t119 = l3*t118
      t126 = t59*t89
      t148 = t3*t30
      t151 = s34r**2
      t152 = t9*t151
      t156 = l3*t148*t2
      t161 = t2*t148
      t187 = t89*t30
      t196 = t5*t89
      t208 = t89*t8
      t209 = t208*s3l2p
      t210 = t106*t209
      t213 = t89*s4l2p*t8
      t214 = t106*t213
      t218 = l3*t4
      t219 = z-2
      t220 = t219*t8
      t229 = 2*z
      t230 = -1+t229
      t231 = t230*t8
      t242 = z*t1*t4
      t252 = t106*t47
      t271 = t208*s3l1p
      t272 = t106*t271
      t275 = t89*s4l1p*t8
      t276 = t106*t275
      t314 = t89*l3
      t315 = t314*t5
      t318 = t15*s2l1
      t319 = t196*t318
      t321 = t22*s2l2
      t322 = t196*t321
      t324 = t187*t108
      t326 = t187*t111
      t330 = s23r**2
      t331 = t9*t330
      t347 = t106*t89
      t348 = t15*s34r
      t351 = t5*l3
      t352 = t351*t15
      t356 = t22*s34r
      t364 = t1*t148*t89
      t375 = 128.D0/3.D0*t352
      t376 = 3-z
      t400 = t219*s4l2p*t8
      t416 = t5*t8
      s2 = (-128.D0/3.D0*t7*t9*t11+((64.D0/3.D0*t6*t15+64.D0/3.D0*t6*t17
     #)*s2l1+(64.D0/3.D0*t22*t6+64.D0/3.D0*t24*t6)*s2l2+128.D0/3.D0*t29*
     #t30*l3*t33)*t10)*t39
      s4 = ((64.D0/3.D0*t42*t17*t11+((64.D0/3.D0*t48+64.D0/3.D0*t51)*s23
     #r+64.D0/3.D0*t7*t56-64.D0/3.D0*t60*t17*s34r)*t10)*s1l1+(64.D0/3.D0
     #*t42*t24*t11+((64.D0/3.D0*t72+64.D0/3.D0*t75)*s23r+64.D0/3.D0*t7*t
     #79-64.D0/3.D0*t60*t24*s34r)*t10)*s1l2+64.D0/3.D0*t90*t9*t91+(64.D0
     #/3.D0*t90*t95+(-128.D0/3.D0*t48-64.D0/3.D0*t51)*s2l1+(-128.D0/3.D0
     #*t72-64.D0/3.D0*t75)*s2l2+t110+t113+(128.D0/3.D0*t115+64.D0/3.D0*t
     #117*t119)*t8)*t11+((-64.D0/3.D0*t126*t33-t110-t113+(-128.D0/3.D0*t
     #115+128.D0/3.D0*t41*l3*z)*t8)*s23r+(-128.D0/3.D0*t41*t15-64.D0/3.D
     #0*t41*t17)*s2l1+(-128.D0/3.D0*t41*t22-64.D0/3.D0*t41*t24)*s2l2-64.
     #D0/3.D0*t29*t148*t89*t152+(-64.D0/3.D0*t156*t108-64.D0/3.D0*t156*t
     #111+(-128.D0/3.D0*t161*t114-64.D0/3.D0*t6*t119)*t8)*s34r-64.D0/3.D
     #0*t41*t108-64.D0/3.D0*t41*t111-128.D0/3.D0*t41*s4l2p*s4l1p*t8)*t10
     #)*s13r
      s5 = ((-128.D0/3.D0*t90*t55*t11+(128.D0/3.D0*t90*t55*s23r+128.D0/3
     #.D0*t187*t2*t8*t151)*t10)*s1l2+128.D0/3.D0*t196*t15*t91+((-64*t196
     #*t15-128.D0/3.D0*t196*t17)*s23r-64.D0/3.D0*t90*t56+(-64*t210-64.D0
     #/3.D0*t214)*s34r+64.D0/3.D0*t218*t220*s3l2p)*t11+(((64.D0/3.D0*t21
     #0+64.D0/3.D0*t214)*s34r-64.D0/3.D0*t218*t231*s3l2p-64.D0/3.D0*t218
     #*t230*s4l2p*t8)*s23r-64.D0/3.D0*t242*t46*s34r*s2l2+(64.D0/3.D0*t16
     #1*t209+64.D0/3.D0*t161*t213)*t151+(-64.D0/3.D0*t252+64.D0/3.D0*t51
     #)*s34r)*t10)*s1l1
      s3 = s4+s5
      s1 = s2+s3
      s2 = s1+(128.D0/3.D0*t196*t22*t91+((-64*t196*t22-128.D0/3.D0*t196*
     #t24)*s23r-64.D0/3.D0*t90*t79+(-64*t272-64.D0/3.D0*t276)*s34r+64.D0
     #/3.D0*t218*t220*s3l1p)*t11+(((64.D0/3.D0*t272+64.D0/3.D0*t276)*s34
     #r-64.D0/3.D0*t218*t231*s3l1p-64.D0/3.D0*t218*t230*s4l1p*t8)*s23r-6
     #4.D0/3.D0*t242*t46*s34r*s2l1+(64.D0/3.D0*t161*t271+64.D0/3.D0*t161
     #*t275)*t151+(-64.D0/3.D0*t106*t71+64.D0/3.D0*t75)*s34r)*t10)*s1l2
      s3 = s2+(-64.D0/3.D0*t315*t95+128.D0/3.D0*t319+128.D0/3.D0*t322-64
     #.D0/3.D0*t324-64.D0/3.D0*t326)*t91
      s4 = s3
      s6 = (64.D0/3.D0*t315*t331+(-64.D0/3.D0*t319-64.D0/3.D0*t322+64.D0
     #/3.D0*t314*t30*z*t1*t8*s34r+64.D0/3.D0*t324+64.D0/3.D0*t326-64.D0/
     #3.D0*t89*t4*z*(-3+t229)*t8)*s23r+(-64.D0/3.D0*t347*t348+64*t352)*s
     #2l1+(-64.D0/3.D0*t347*t356+64*t351*t22)*s2l2+(64.D0/3.D0*t364*t108
     #+64.D0/3.D0*t364*t111+64*t41*t89*z*t8)*s34r+(t375+64.D0/3.D0*t351*
     #t376*s4l2p*t8)*s3l1p+64.D0/3.D0*t351*t376*t111)*t11
      s7 = (64.D0/3.D0*t196*t331+(-64.D0/3.D0*t351*t318-64.D0/3.D0*t351*
     #t321-64.D0/3.D0*t90*z*(4-z)*t55+(-t375+64.D0/3.D0*t351*t400)*s3l1p
     #+64.D0/3.D0*t351*t219*t111-64.D0/3.D0*t4*z*l3*t219*t8)*s23r+(-64.D
     #0/3.D0*t107*t348+64.D0/3.D0*t416*s3l2p)*s2l1+(-64.D0/3.D0*t107*t35
     #6+64.D0/3.D0*t416*s3l1p)*s2l2-64*t126*t152+((-128.D0/3.D0*t252+64.
     #D0/3.D0*t107*t400)*s3l1p+64.D0/3.D0*t107*t219*s4l1p*t15+64.D0/3.D0
     #*t117*l3*z*t219*t8)*s34r+64.D0/3.D0*t5*s4l2p*t22+64.D0/3.D0*t5*s4l
     #1p*t15)*t10
      s5 = s6+s7
      taux5 = s4+s5
      t1 = -1+z
      t2 = t1**2
      t3 = t2*t1
      t4 = l3-1
      t5 = t4**2
      t6 = t3*t5
      t7 = 1/s3vr
      t8 = t7*s3l2p
      t10 = s4l2p*t7
      t15 = t7*s3l1p
      t17 = s4l1p*t7
      t23 = s1vr**2
      t25 = s13r**2
      t27 = t4*t3
      t28 = l3*t7
      t29 = t28*s3l2p
      t30 = t27*t29
      t33 = l3*s4l2p*t7
      t34 = t27*t33
      t37 = t23*s1vr
      t39 = -t30-t34
      t42 = l3*t6
      t43 = t7*s34r
      t44 = t43*s2l2
      t47 = t2**2
      t48 = t5*t47
      t49 = t48*t29
      t51 = t48*t33
      t59 = t28*s3l1p
      t60 = t27*t59
      t63 = l3*s4l1p*t7
      t64 = t27*t63
      t68 = t60+t64
      t71 = t43*s2l1
      t74 = t48*t59
      t76 = t48*t63
      t90 = t47*t4
      t91 = t90*l3
      t92 = t10*s3l1p
      t93 = t91*t92
      t94 = 256*t93
      t95 = t17*s3l2p
      t96 = t91*t95
      t97 = 256*t96
      t126 = t47*t1
      t128 = l3*t126*t5
      t142 = l3**2
      t143 = t3*t142
      t144 = t143*t8
      t146 = t143*t10
      t150 = t90*t142
      t152 = t150*t8*s34r
      t154 = l3*t2
      t155 = z+1
      t157 = 2*t154
      t159 = (-t154*t155-t157)*t7
      t164 = -t144-t146
      t166 = s23r**2
      t168 = t27*t142
      t171 = t142*t7
      t182 = -t154*t155
      t187 = (-t182+2*t2*z*l3)*t7
      t190 = -t182+t157
      t198 = s34r**2
      t202 = t2*t4
      t211 = -512.D0/3.D0*t142*t47*t5*t7*t198-256.D0/3.D0*(2*t202*l3*z+2
     #*t202*l3)*t7*s34r
      t214 = t126*t5*t142
      t219 = t90*t29-t34
      t226 = t143*t15
      t228 = t143*t17
      t233 = t150*t15*s34r
      t239 = t226+t228
      t266 = -t90*t59+t64
      t282 = t3*l3
      t283 = t282*t8
      t288 = t282*t15
      t293 = 256.D0/3.D0*t282*t92
      t295 = 256.D0/3.D0*t282*t95
      t310 = t3*t7
      s2 = ((-256.D0/3.D0*t6*t8-256.D0/3.D0*t6*t10)*s2l1+(256.D0/3.D0*t6
     #*t15+256.D0/3.D0*t6*t17)*s2l2)*t23*t25
      s4 = (((1280.D0/3.D0*t30+512.D0/3.D0*t34)*t37+(256.D0/3.D0*t39*s23
     #r+512.D0/3.D0*t42*t44+(-1280.D0/3.D0*t49-512.D0/3.D0*t51)*s34r)*t2
     #3)*s1l1+((-1280.D0/3.D0*t60-512.D0/3.D0*t64)*t37+(256.D0/3.D0*t68*
     #s23r-512.D0/3.D0*t42*t71+(1280.D0/3.D0*t74+512.D0/3.D0*t76)*s34r)*
     #t23)*s1l2+(-512.D0/3.D0*t39*s2l1-512.D0/3.D0*t68*s2l2+t94-t97)*t37
     #+((256*t39*s2l1+256*t68*s2l2-t94+t97)*s23r+((-256*t49-256.D0/3.D0*
     #t51)*s34r+512.D0/3.D0*t27*t8+256.D0/3.D0*t27*t10)*s2l1+((256*t74+2
     #56.D0/3.D0*t76)*s34r-512.D0/3.D0*t27*t15-256.D0/3.D0*t27*t17)*s2l2
     #+(-256*t128*t92+256*t128*t95)*s34r-256.D0/3.D0*t27*t92+256.D0/3.D0
     #*t27*t95)*t23)*s13r
      s5 = (((-256.D0/3.D0*t144+512.D0/3.D0*t146)*s23r-256.D0/3.D0*t152+
     #256.D0/3.D0*t159*s3l2p)*t37+(256*t164*t166+(-512.D0/3.D0*t168*t44+
     #(-512.D0/3.D0*t90*t171*s3l2p-256*t90*t142*s4l2p*t7)*s34r-256.D0/3.
     #D0*t187*s3l2p-256.D0/3.D0*t190*s4l2p*t7)*s23r+t211*s2l2+256.D0/3.D
     #0*t214*t8*t198+256.D0/3.D0*t219*s34r)*t23)*s1l1
      s3 = s4+s5
      s1 = s2+s3
      taux6 = s1+(((256.D0/3.D0*t226-512.D0/3.D0*t228)*s23r+256.D0/3.D0*
     #t233-256.D0/3.D0*t159*s3l1p)*t37+(256*t239*t166+(512.D0/3.D0*t168*
     #t71+(512.D0/3.D0*t90*t171*s3l1p+256*t90*t142*s4l1p*t7)*s34r+256.D0
     #/3.D0*t187*s3l1p+256.D0/3.D0*t190*s4l1p*t7)*s23r-t211*s2l1-256.D0/
     #3.D0*t214*t15*t198+256.D0/3.D0*t266*s34r)*t23)*s1l2+((-512.D0/3.D0
     #*t164*s2l1-512.D0/3.D0*t239*s2l2)*s23r+(512.D0/3.D0*t152-256.D0/3.
     #D0*t283)*s2l1+(-512.D0/3.D0*t233+256.D0/3.D0*t288)*s2l2-t293+t295)
     #*t37+(((512.D0/3.D0*t283+512.D0/3.D0*t282*t10)*s2l1+(-512.D0/3.D0*
     #t288-512.D0/3.D0*t282*t17)*s2l2-t293+t295)*s23r+(512.D0/3.D0*t219*
     #s34r-256.D0/3.D0*t310*s3l2p)*s2l1+(512.D0/3.D0*t266*s34r+256.D0/3.
     #D0*t310*s3l1p)*s2l2+(-256.D0/3.D0*t93+256.D0/3.D0*t96)*s34r+256.D0
     #/3.D0*t3*s4l2p*t15-256.D0/3.D0*t3*s4l1p*t8)*t23

CCC Coefficients

      tcoff9 = taux5
      tcoff10 = taux5
      tcoff11 = taux6
      tcoff12 = taux6

CCC Jet functions

      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet9 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,5.D0,1.D0,1.D0,Tcoeff*tcoff9)
      t2 = -l3+1
      t3 = 1-z
      t5 = t2*t3*s13r
      t6 = t3*l3
      t7 = t6*s23r
      t8 = t6*s1vr
      t11 = t3**2
      t13 = l3*t2*t11*s34r
      tFjet10 = Fjet(var,ndim,z,1/ux,t5,t7,-1-t5-t8+z,t8-t7-t13,t13,t8,-
     #1+z-t8+t13,-t5-t7-t13+z,1+t5+t7,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff10)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet11 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff11)
      t2 = -l3+1
      t3 = 1-z
      t5 = t2*t3*s13r
      t6 = t3*l3
      t7 = t6*s23r
      t8 = t6*s1vr
      t11 = t3**2
      t13 = l3*t2*t11*s34r
      tFjet12 = Fjet(var,ndim,z,1/ux,t5,t7,-1-t5-t8+z,t8-t7-t13,t13,t8,-
     #1+z-t8+t13,-t5-t7-t13+z,1+t5+t7,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff12)

CCC Sum

      qgrmnum4e1 = tFjet9*tcoff9+tFjet10*tcoff10+tFjet11*tcoff11+tFjet12
     #*tcoff12
      RETURN
      END

      double precision function qgrmnum4e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3-1
      t2 = t1**2
      t3 = -1+z
      t4 = t3**2
      t5 = t4*t3
      t6 = t2*t5
      t7 = l3*t6
      t8 = 1/s3vr
      t9 = z*t8
      t10 = s1vr**2
      t11 = t10*s1vr
      t15 = t8*s3l2p
      t17 = s4l2p*t8
      t22 = t8*s3l1p
      t24 = s4l1p*t8
      t29 = t2*t1
      t30 = t4**2
      t33 = s34r*t9
      t39 = s13r**2
      t41 = t5*t1
      t42 = t41*l3
      t46 = l3*t8
      t47 = t46*s3l2p
      t50 = l3*s4l2p*t8
      t51 = t41*t50
      t53 = 64.D0/3.D0*t41*t47+64.D0/3.D0*t51
      t55 = t30*t2
      t56 = t55*l3
      t57 = t15*s34r
      t67 = t46*s3l1p
      t70 = l3*s4l1p*t8
      t71 = t41*t70
      t73 = 64.D0/3.D0*t41*t67+64.D0/3.D0*t71
      t75 = t22*s34r
      t82 = l3**2
      t83 = t41*t82
      t84 = t10**2
      t88 = t9*s23r
      t91 = t15*s2l1
      t94 = t22*s2l2
      t97 = t55*t82
      t98 = t97*t33
      t101 = t1*t4*l3
      t102 = 3*z
      t143 = t3*t30
      t146 = s34r**2
      t147 = t9*t146
      t150 = z**2
      t152 = t150*t8*s34r
      t155 = t17*s3l1p
      t158 = t24*s3l2p
      t169 = t5*t82
      t172 = t30*t1
      t173 = t172*t82
      t174 = t173*t57
      t175 = t5*l3
      t176 = t175*t15
      t184 = s23r**2
      t186 = t82*t8
      t201 = t143*t2
      t202 = t201*t82
      t216 = t173*t75
      t217 = t175*t22
      t251 = t82*l3
      t252 = t251*t5
      t258 = t251*t30*z*t1*t8*s34r
      t262 = t9*t184
      t285 = 2*z
      t288 = t8*s34r
      t304 = t102-2
      t311 = t172*l3
      t313 = t5*t8
      s2 = (-128.D0/3.D0*t7*t9*t11+((64.D0/3.D0*t6*t15+64.D0/3.D0*t6*t17
     #)*s2l1+(64.D0/3.D0*t22*t6+64.D0/3.D0*t24*t6)*s2l2+128.D0/3.D0*t29*
     #t30*l3*t33)*t10)*t39
      s4 = ((-64.D0/3.D0*t42*t15*t11+(t53*s23r+64.D0/3.D0*t56*t57)*t10)*
     #s1l1+(-64.D0/3.D0*t42*t22*t11+(t73*s23r+64.D0/3.D0*t56*t75)*t10)*s
     #1l2+128.D0/3.D0*t83*t9*t84+(64*t83*t88-64.D0/3.D0*t42*t91-64.D0/3.
     #D0*t42*t94+64.D0/3.D0*t98+64.D0/3.D0*t101*z*(-4+t102)*t8)*t11+((-t
     #53*s2l1-t73*s2l2-64*t98+128.D0/3.D0*t41*l3*z*t8)*s23r+((-64.D0/3.D
     #0*t55*t47-64.D0/3.D0*t55*t50)*s34r-128.D0/3.D0*t41*t15-64.D0/3.D0*
     #t41*t17)*s2l1+((-64.D0/3.D0*t55*t67-64.D0/3.D0*t55*t70)*s34r-128.D
     #0/3.D0*t41*t22-64.D0/3.D0*t41*t24)*s2l2-64*t29*t143*t82*t147-64*t7
     #*t152-64.D0/3.D0*t41*t155-64.D0/3.D0*t41*t158-128.D0/3.D0*t41*s4l2
     #p*s4l1p*t8)*t10)*s13r
      s5 = ((64.D0/3.D0*t169*t15*s23r+64.D0/3.D0*t174+64.D0/3.D0*t176)*t
     #11+((-64.D0/3.D0*t169*t15-64.D0/3.D0*t169*t17)*t184+((-128.D0/3.D0
     #*t172*t186*s3l2p-64.D0/3.D0*t172*t82*s4l2p*t8)*s34r-64.D0/3.D0*t17
     #6-64.D0/3.D0*t175*t17)*s23r-64.D0/3.D0*t202*t15*t146+(-64.D0/3.D0*
     #t172*t47+64.D0/3.D0*t51)*s34r)*t10)*s1l1
      s3 = s4+s5
      s1 = s2+s3
      s2 = s1+((64.D0/3.D0*t169*t22*s23r+64.D0/3.D0*t216+64.D0/3.D0*t217
     #)*t11+((-64.D0/3.D0*t169*t22-64.D0/3.D0*t169*t24)*t184+((-128.D0/3
     #.D0*t172*t186*s3l1p-64.D0/3.D0*t172*t82*s4l1p*t8)*s34r-64.D0/3.D0*
     #t217-64.D0/3.D0*t175*t24)*s23r-64.D0/3.D0*t202*t22*t146+(-64.D0/3.
     #D0*t172*t67+64.D0/3.D0*t71)*s34r)*t10)*s1l2
      taux5 = s2+(-128.D0/3.D0*t252*t88-128.D0/3.D0*t258)*t84+(-64.D0/3.
     #D0*t252*t262+(64.D0/3.D0*t169*t91+64.D0/3.D0*t169*t94+64.D0/3.D0*t
     #258-64.D0/3.D0*t82*t4*z*(-4+5*z)*t8)*s23r+(64.D0/3.D0*t174+64.D0/3
     #.D0*t176)*s2l1+(64.D0/3.D0*t216+64.D0/3.D0*t217)*s2l2+128.D0/3.D0*
     #t201*t251*t147+64.D0/3.D0*t83*z*(4-t285)*t288+64.D0/3.D0*t175*t155
     #+64.D0/3.D0*t175*t158)*t11+(-64.D0/3.D0*t169*t262+(64.D0/3.D0*t175
     #*t91+64.D0/3.D0*t175*t94+64.D0/3.D0*t83*t152-64.D0/3.D0*t4*z*l3*t3
     #04*t8)*s23r+(64.D0/3.D0*t311*t57+64.D0/3.D0*t313*s3l2p)*s2l1+(64.D
     #0/3.D0*t311*t75+64.D0/3.D0*t313*s3l1p)*s2l2-64.D0/3.D0*t97*z*(1-t2
     #85)*t8*t146+64.D0/3.D0*t101*z*t304*t288+64.D0/3.D0*t5*s4l2p*t22+64
     #.D0/3.D0*t5*s4l1p*t15)*t10
      t1 = l3-1
      t2 = -1+z
      t3 = t2**2
      t4 = t3*t2
      t5 = t1*t4
      t6 = 1/s3vr
      t7 = l3*t6
      t8 = t7*s3l2p
      t9 = t5*t8
      t12 = l3*s4l2p*t6
      t13 = t5*t12
      t16 = s1vr**2
      t17 = t16*s1vr
      t19 = t1**2
      t21 = t4*t19*l3
      t22 = t6*s34r
      t23 = t22*s2l2
      t26 = t3**2
      t27 = t19*t26
      t28 = t27*t8
      t30 = t27*t12
      t38 = t7*s3l1p
      t39 = t5*t38
      t42 = l3*s4l1p*t6
      t43 = t5*t42
      t47 = t22*s2l1
      t50 = t27*t38
      t52 = t27*t42
      t68 = t1*t26
      t69 = t68*l3
      t70 = s4l2p*t6
      t71 = t70*s3l1p
      t73 = 256.D0/3.D0*t69*t71
      t74 = s4l1p*t6
      t75 = t74*s3l2p
      t77 = 256.D0/3.D0*t69*t75
      t96 = t26*t2
      t98 = l3*t96*t19
      t108 = l3**2
      t109 = t4*t108
      t110 = t6*s3l2p
      t111 = t16**2
      t115 = t109*t110
      t117 = t109*t70
      t121 = t5*t108
      t122 = t121*t23
      t124 = t108*t6
      t125 = t124*s3l2p
      t126 = t68*t125
      t128 = -t1
      t129 = t128*t26
      t131 = t108*s4l2p*t6
      t136 = t3*l3
      t137 = 2*z
      t140 = z+1
      t144 = (-t136*(-3+t137)+2*t136*t140)*t6
      t151 = s23r**2
      t164 = -2*t136*t140
      t166 = (-t136*(3*z-2)+t164)*t6
      t171 = -t136*(-1+t137)+t164
      t177 = t108*t26
      t179 = s34r**2
      t183 = t1*t3
      t192 = 1280.D0/3.D0*t177*t19*t6*t179-256.D0/3.D0*(-t183*l3-4*t183*
     #l3*z)*t6*s34r
      t194 = t96*t19
      t205 = t6*s3l1p
      t209 = t109*t205
      t211 = t109*t74
      t215 = t121*t47
      t217 = t124*s3l1p
      t218 = t68*t217
      t221 = t108*s4l1p*t6
      t258 = t110*s2l1
      t261 = t205*s2l2
      t264 = t177*t71
      t266 = t177*t75
      t273 = l3*t4
      t279 = t128*t96*t108
      t287 = 2*t273
      t288 = -t273*(3-z)+t287
      t298 = -l3*t26-t287
      t309 = -t1*t96*l3-2*t69
      s2 = (((-1280.D0/3.D0*t9-1024.D0/3.D0*t13)*t17+(-1024.D0/3.D0*t21*
     #t23+(1280.D0/3.D0*t28+1024.D0/3.D0*t30)*s34r)*t16)*s1l1+((1280.D0/
     #3.D0*t39+1024.D0/3.D0*t43)*t17+(1024.D0/3.D0*t21*t47+(-1280.D0/3.D
     #0*t50-1024.D0/3.D0*t52)*s34r)*t16)*s1l2+((-256.D0/3.D0*t9-256*t13)
     #*s2l1+(256.D0/3.D0*t39+256*t43)*s2l2-t73+t77)*t17+(((256*t9+256*t1
     #3)*s2l1+(-256*t39-256*t43)*s2l2+t73-t77)*s23r+(256*t28+256*t30)*s3
     #4r*s2l1+(-256*t50-256*t52)*s34r*s2l2+(256.D0/3.D0*t98*t71-256.D0/3
     #.D0*t98*t75)*s34r)*t16)*s13r
      s3 = (-512.D0/3.D0*t109*t110*t111+((1024.D0/3.D0*t115+256.D0/3.D0*
     #t117)*s23r-256.D0/3.D0*t122+(1024.D0/3.D0*t126-256.D0/3.D0*t129*t1
     #31)*s34r+256.D0/3.D0*t144*s3l2p)*t17+((256*t115+256*t117)*t151+(12
     #80.D0/3.D0*t122+(256.D0/3.D0*t126+512.D0/3.D0*t68*t131)*s34r-256.D
     #0/3.D0*t166*s3l2p-256.D0/3.D0*t171*s4l2p*t6)*s23r+t192*s2l2+(-512.
     #D0/3.D0*t194*t125-256.D0/3.D0*t194*t131)*t179)*t16)*s1l1+(512.D0/3
     #.D0*t109*t205*t111+((-1024.D0/3.D0*t209-256.D0/3.D0*t211)*s23r+256
     #.D0/3.D0*t215+(-1024.D0/3.D0*t218+256.D0/3.D0*t129*t221)*s34r-256.
     #D0/3.D0*t144*s3l1p)*t17+((-256*t209-256*t211)*t151+(-1280.D0/3.D0*
     #t215+(-256.D0/3.D0*t218-512.D0/3.D0*t68*t221)*s34r+256.D0/3.D0*t16
     #6*s3l1p+256.D0/3.D0*t171*s4l1p*t6)*s23r-t192*s2l1+(512.D0/3.D0*t19
     #4*t217+256.D0/3.D0*t194*t221)*t179)*t16)*s1l2
      s1 = s2+s3
      taux6 = s1+(-512.D0/3.D0*t109*t258+512.D0/3.D0*t109*t261-256.D0/3.
     #D0*t264+256.D0/3.D0*t266)*t111+((256.D0/3.D0*t264-256.D0/3.D0*t266
     #)*s23r-512.D0/3.D0*t273*t258+512.D0/3.D0*t273*t261+(-256.D0/3.D0*t
     #279*t71+256.D0/3.D0*t279*t75)*s34r-256.D0/3.D0*t288*s4l2p*t205+256
     #.D0/3.D0*t288*s4l1p*t110)*t17+((-256.D0/3.D0*t298*s4l2p*t205+256.D
     #0/3.D0*t298*s4l1p*t110)*s23r+(-256.D0/3.D0*t309*s4l2p*t205+256.D0/
     #3.D0*t309*s4l1p*t110)*s34r)*t16

CCC Coefficients

      tcoff9 = taux5
      tcoff10 = taux5
      tcoff11 = taux6
      tcoff12 = taux6

CCC Jet functions

      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet9 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,5.D0,1.D0,1.D0,Tcoeff*tcoff9)
      t2 = -l3+1
      t3 = 1-z
      t5 = t2*t3*s13r
      t6 = t3*l3
      t7 = t6*s23r
      t8 = t6*s1vr
      t11 = t3**2
      t13 = l3*t2*t11*s34r
      tFjet10 = Fjet(var,ndim,z,1/ux,t5,t7,-1-t5-t8+z,t8-t7-t13,t13,t8,-
     #1+z-t8+t13,-t5-t7-t13+z,1+t5+t7,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff10)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet11 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff11)
      t2 = -l3+1
      t3 = 1-z
      t5 = t2*t3*s13r
      t6 = t3*l3
      t7 = t6*s23r
      t8 = t6*s1vr
      t11 = t3**2
      t13 = l3*t2*t11*s34r
      tFjet12 = Fjet(var,ndim,z,1/ux,t5,t7,-1-t5-t8+z,t8-t7-t13,t13,t8,-
     #1+z-t8+t13,-t5-t7-t13+z,1+t5+t7,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff12)

CCC Sum

      qgrmnum4e2 = tFjet9*tcoff9+tFjet10*tcoff10+tFjet11*tcoff11+tFjet12
     #*tcoff12
      RETURN
      END

      double precision function qgrmnum4e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3-1
      t2 = t1**2
      t3 = -1+z
      t4 = t3**2
      t5 = t4*t3
      t7 = t2*t5*l3
      t8 = 1/s3vr
      t9 = z*t8
      t10 = s1vr**2
      t11 = t10*s1vr
      t14 = t2*t1
      t15 = t4**2
      t23 = s13r**2
      t25 = t5*t1
      t26 = l3**2
      t27 = t25*t26
      t32 = t2*t15*t26
      t33 = s34r*t9
      t34 = t32*t33
      t38 = t25*l3*z*t8
      t48 = s34r**2
      t49 = t9*t48
      t52 = z**2
      t54 = t52*t8*s34r
      t61 = l3*t26
      t63 = s23r**2
      t64 = t9*t63
      t72 = t26*t5
      taux5 = (-64.D0/3.D0*t7*t9*t11+64.D0/3.D0*t14*t15*l3*t9*s34r*t10)*
     #t23+((128.D0/3.D0*t27*t9*s23r+64.D0/3.D0*t34+64.D0/3.D0*t38)*t11+(
     #(-64.D0/3.D0*t34+64.D0/3.D0*t38)*s23r-64.D0/3.D0*t14*t15*t3*t26*t4
     #9-64.D0/3.D0*t7*t54)*t10)*s13r+(-64.D0/3.D0*t61*t5*t64+(-64.D0/3.D
     #0*t61*t15*z*t1*t8*s34r-64.D0/3.D0*t72*t9)*s23r+128.D0/3.D0*t27*t33
     #)*t11+(-64.D0/3.D0*t72*t64+(-64.D0/3.D0*t27*t54-64.D0/3.D0*t5*z*l3
     #*t8)*s23r-64.D0/3.D0*t32*t49+64.D0/3.D0*t25*l3*t33)*t10
      t1 = -1+z
      t2 = t1**2
      t3 = t2*t1
      t4 = l3-1
      t5 = t4**2
      t6 = t3*t5
      t7 = 1/s3vr
      t8 = t7*s3l2p
      t10 = s4l2p*t7
      t15 = t7*s3l1p
      t17 = s4l1p*t7
      t23 = s1vr**2
      t25 = s13r**2
      t27 = t4*t3
      t28 = t27*l3
      t29 = t23*s1vr
      t33 = l3*t7
      t34 = t33*s3l2p
      t35 = t27*t34
      t37 = l3*s4l2p*t7
      t38 = t27*t37
      t39 = t35+t38
      t42 = t2**2
      t43 = t5*t42
      t44 = t43*l3
      t45 = t8*s34r
      t55 = t33*s3l1p
      t56 = t27*t55
      t58 = l3*s4l1p*t7
      t59 = t27*t58
      t60 = -t56-t59
      t63 = t15*s34r
      t78 = t42*t4
      t79 = t78*l3
      t80 = t10*s3l1p
      t82 = 512.D0/3.D0*t79*t80
      t83 = t17*s3l2p
      t85 = 512.D0/3.D0*t79*t83
      t118 = t42*t1
      t120 = l3*t118*t5
      t134 = l3**2
      t135 = t3*t134
      t136 = t23**2
      t140 = t135*t8
      t142 = t135*t10
      t146 = t27*t134
      t147 = t7*s34r
      t150 = 512.D0/3.D0*t146*t147*s2l2
      t151 = t134*t7
      t152 = t151*s3l2p
      t156 = t134*s4l2p*t7
      t161 = t3*l3
      t162 = l3*t2
      t163 = 2*z
      t168 = (-t161+2*t162*(-3+t163))*t7
      t175 = s23r**2
      t177 = t78*t134
      t186 = (-t161+2*t162*(3*z-2))*t7
      t192 = -t161+2*t162*(-1+t163)
      t198 = t134*t42
      t200 = s34r**2
      t207 = -512.D0/3.D0*t198*t5*t7*t200-512.D0/3.D0*t4*t2*t33*s34r
      t209 = t118*t5
      t227 = t135*t15
      t229 = t135*t17
      t235 = 512.D0/3.D0*t146*t147*s2l1
      t236 = t151*s3l1p
      t240 = t134*s4l1p*t7
      t278 = t8*s2l1
      t279 = t135*t278
      t281 = t15*s2l2
      t282 = t135*t281
      t285 = 512.D0/3.D0*t198*t80
      t287 = 512.D0/3.D0*t198*t83
      t306 = t4*t118
      t307 = t306*t134
      t316 = -t161+2*t161*(3-z)
      t329 = l3*t42
      t338 = t3*t7
      t349 = t306*l3
      s2 = ((256*t6*t8+256*t6*t10)*s2l1+(-256*t6*t15-256*t6*t17)*s2l2)*t
     #23*t25
      s4 = ((-256.D0/3.D0*t28*t8*t29+(256*t39*s23r+256.D0/3.D0*t44*t45)*
     #t23)*s1l1+(256.D0/3.D0*t28*t15*t29+(256*t60*s23r-256.D0/3.D0*t44*t
     #63)*t23)*s1l2+((-1280.D0/3.D0*t35-512.D0/3.D0*t38)*s2l1+(1280.D0/3
     #.D0*t56+512.D0/3.D0*t59)*s2l2-t82+t85)*t29+((-256.D0/3.D0*t39*s2l1
     #-256.D0/3.D0*t60*s2l2+t82-t85)*s23r+((-256.D0/3.D0*t43*t34-256.D0/
     #3.D0*t43*t37)*s34r-512*t27*t8-256*t27*t10)*s2l1+((256.D0/3.D0*t43*
     #t55+256.D0/3.D0*t43*t58)*s34r+512*t27*t15+256*t27*t17)*s2l2+(512.D
     #0/3.D0*t120*t80-512.D0/3.D0*t120*t83)*s34r+256*t27*t80-256*t27*t83
     #)*t23)*s13r
      s5 = (1024.D0/3.D0*t135*t8*t136+((-1280.D0/3.D0*t140-512.D0/3.D0*t
     #142)*s23r+t150+(-1280.D0/3.D0*t78*t152-512.D0/3.D0*t78*t156)*s34r+
     #256.D0/3.D0*t168*s3l2p)*t29+((-256.D0/3.D0*t140-256.D0/3.D0*t142)*
     #t175+(-t150+256.D0/3.D0*t177*t10*s34r-256.D0/3.D0*t186*s3l2p-256.D
     #0/3.D0*t192*s4l2p*t7)*s23r+t207*s2l2+(256.D0/3.D0*t209*t152+512.D0
     #/3.D0*t209*t156)*t200+(-256*t78*t34+256*t38)*s34r)*t23)*s1l1
      s3 = s4+s5
      s1 = s2+s3
      s2 = s1+(-1024.D0/3.D0*t135*t15*t136+((1280.D0/3.D0*t227+512.D0/3.
     #D0*t229)*s23r-t235+(1280.D0/3.D0*t78*t236+512.D0/3.D0*t78*t240)*s3
     #4r-256.D0/3.D0*t168*s3l1p)*t29+((256.D0/3.D0*t227+256.D0/3.D0*t229
     #)*t175+(t235-256.D0/3.D0*t177*t17*s34r+256.D0/3.D0*t186*s3l1p+256.
     #D0/3.D0*t192*s4l1p*t7)*s23r-t207*s2l1+(-256.D0/3.D0*t209*t236-512.
     #D0/3.D0*t209*t240)*t200+(256*t78*t55-256*t59)*s34r)*t23)*s1l2
      taux6 = s2+(1024.D0/3.D0*t279-1024.D0/3.D0*t282+t285-t287)*t136+((
     #-256.D0/3.D0*t279+256.D0/3.D0*t282-t285+t287)*s23r+(-256.D0/3.D0*t
     #177*t45+1792.D0/3.D0*t161*t8)*s2l1+(256.D0/3.D0*t177*t63-1792.D0/3
     #.D0*t161*t15)*s2l2+(-512.D0/3.D0*t307*t80+512.D0/3.D0*t307*t83)*s3
     #4r-256.D0/3.D0*t316*s4l2p*t15+256.D0/3.D0*t316*s4l1p*t8)*t29+((-25
     #6.D0/3.D0*t161*t278+256.D0/3.D0*t161*t281-512.D0/3.D0*t329*t80+512
     #.D0/3.D0*t329*t83)*s23r+(-256.D0/3.D0*t79*t45+256*t338*s3l2p)*s2l1
     #+(256.D0/3.D0*t79*t63-256*t338*s3l1p)*s2l2+(-512.D0/3.D0*t349*t80+
     #512.D0/3.D0*t349*t83)*s34r-256*t3*s4l2p*t15+256*t3*s4l1p*t8)*t23

CCC Coefficients

      tcoff9 = taux5
      tcoff10 = taux5
      tcoff11 = taux6
      tcoff12 = taux6

CCC Jet functions

      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet9 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,5.D0,1.D0,1.D0,Tcoeff*tcoff9)
      t2 = -l3+1
      t3 = 1-z
      t5 = t2*t3*s13r
      t6 = t3*l3
      t7 = t6*s23r
      t8 = t6*s1vr
      t11 = t3**2
      t13 = l3*t2*t11*s34r
      tFjet10 = Fjet(var,ndim,z,1/ux,t5,t7,-1-t5-t8+z,t8-t7-t13,t13,t8,-
     #1+z-t8+t13,-t5-t7-t13+z,1+t5+t7,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff10)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet11 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff11)
      t2 = -l3+1
      t3 = 1-z
      t5 = t2*t3*s13r
      t6 = t3*l3
      t7 = t6*s23r
      t8 = t6*s1vr
      t11 = t3**2
      t13 = l3*t2*t11*s34r
      tFjet12 = Fjet(var,ndim,z,1/ux,t5,t7,-1-t5-t8+z,t8-t7-t13,t13,t8,-
     #1+z-t8+t13,-t5-t7-t13+z,1+t5+t7,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff12)

CCC Sum

      qgrmnum4e3 = tFjet9*tcoff9+tFjet10*tcoff10+tFjet11*tcoff11+tFjet12
     #*tcoff12
      RETURN
      END

      double precision function qgrmnum4e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux5 = 0
      t1 = -1+z
      t2 = t1**2
      t3 = t2*t1
      t4 = l3-1
      t5 = t4**2
      t6 = t3*t5
      t7 = 1/s3vr
      t8 = t7*s3l2p
      t10 = s4l2p*t7
      t15 = t7*s3l1p
      t17 = s4l1p*t7
      t23 = s1vr**2
      t25 = s13r**2
      t27 = t4*t3
      t28 = t27*l3
      t29 = t23*s1vr
      t33 = l3*t7
      t34 = t33*s3l2p
      t37 = l3*s4l2p*t7
      t38 = t27*t37
      t40 = 512.D0/3.D0*t27*t34+512.D0/3.D0*t38
      t42 = t2**2
      t43 = t5*t42
      t44 = t43*l3
      t45 = t8*s34r
      t55 = t33*s3l1p
      t58 = l3*s4l1p*t7
      t59 = t27*t58
      t61 = -512.D0/3.D0*t27*t55-512.D0/3.D0*t59
      t63 = t15*s34r
      t70 = t8*s2l1
      t72 = t15*s2l2
      t105 = t10*s3l1p
      t108 = t17*s3l2p
      t115 = l3**2
      t116 = t3*t115
      t119 = t42*t4
      t120 = t119*t115
      t121 = t120*t45
      t122 = t3*l3
      t123 = t122*t8
      t131 = s23r**2
      t133 = t115*t7
      t150 = t42*t1*t5*t115
      t151 = s34r**2
      t165 = t120*t63
      t166 = t122*t15
      t222 = t119*l3
      t224 = t3*t7
      s2 = ((512.D0/3.D0*t6*t8+512.D0/3.D0*t6*t10)*s2l1+(-512.D0/3.D0*t6
     #*t15-512.D0/3.D0*t6*t17)*s2l2)*t23*t25
      s3 = ((-512.D0/3.D0*t28*t8*t29+(t40*s23r+512.D0/3.D0*t44*t45)*t23)
     #*s1l1+(512.D0/3.D0*t28*t15*t29+(t61*s23r-512.D0/3.D0*t44*t63)*t23)
     #*s1l2+(-512.D0/3.D0*t28*t70+512.D0/3.D0*t28*t72)*t29+((-t40*s2l1-t
     #61*s2l2)*s23r+((-512.D0/3.D0*t43*t34-512.D0/3.D0*t43*t37)*s34r-102
     #4.D0/3.D0*t27*t8-512.D0/3.D0*t27*t10)*s2l1+((512.D0/3.D0*t43*t55+5
     #12.D0/3.D0*t43*t58)*s34r+1024.D0/3.D0*t27*t15+512.D0/3.D0*t27*t17)
     #*s2l2+512.D0/3.D0*t27*t105-512.D0/3.D0*t27*t108)*t23)*s13r+((512.D
     #0/3.D0*t116*t8*s23r+512.D0/3.D0*t121+512.D0/3.D0*t123)*t29+((-512.
     #D0/3.D0*t116*t8-512.D0/3.D0*t116*t10)*t131+((-1024.D0/3.D0*t119*t1
     #33*s3l2p-512.D0/3.D0*t119*t115*s4l2p*t7)*s34r-512.D0/3.D0*t123-512
     #.D0/3.D0*t122*t10)*s23r-512.D0/3.D0*t150*t8*t151+(-512.D0/3.D0*t11
     #9*t34+512.D0/3.D0*t38)*s34r)*t23)*s1l1
      s1 = s2+s3
      taux6 = s1+((-512.D0/3.D0*t116*t15*s23r-512.D0/3.D0*t165-512.D0/3.
     #D0*t166)*t29+((512.D0/3.D0*t116*t15+512.D0/3.D0*t116*t17)*t131+((1
     #024.D0/3.D0*t119*t133*s3l1p+512.D0/3.D0*t119*t115*s4l1p*t7)*s34r+5
     #12.D0/3.D0*t166+512.D0/3.D0*t122*t17)*s23r+512.D0/3.D0*t150*t15*t1
     #51+(512.D0/3.D0*t119*t55-512.D0/3.D0*t59)*s34r)*t23)*s1l2+((512.D0
     #/3.D0*t116*t70-512.D0/3.D0*t116*t72)*s23r+(512.D0/3.D0*t121+512.D0
     #/3.D0*t123)*s2l1+(-512.D0/3.D0*t165-512.D0/3.D0*t166)*s2l2-512.D0/
     #3.D0*t122*t105+512.D0/3.D0*t122*t108)*t29+((512.D0/3.D0*t122*t70-5
     #12.D0/3.D0*t122*t72)*s23r+(512.D0/3.D0*t222*t45+512.D0/3.D0*t224*s
     #3l2p)*s2l1+(-512.D0/3.D0*t222*t63-512.D0/3.D0*t224*s3l1p)*s2l2-512
     #.D0/3.D0*t3*s4l2p*t15+512.D0/3.D0*t3*s4l1p*t8)*t23

CCC Coefficients

      tcoff9 = taux5
      tcoff10 = taux5
      tcoff11 = taux6
      tcoff12 = taux6

CCC Jet functions

      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet9 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,5.D0,1.D0,1.D0,Tcoeff*tcoff9)
      t2 = -l3+1
      t3 = 1-z
      t5 = t2*t3*s13r
      t6 = t3*l3
      t7 = t6*s23r
      t8 = t6*s1vr
      t11 = t3**2
      t13 = l3*t2*t11*s34r
      tFjet10 = Fjet(var,ndim,z,1/ux,t5,t7,-1-t5-t8+z,t8-t7-t13,t13,t8,-
     #1+z-t8+t13,-t5-t7-t13+z,1+t5+t7,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff10)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet11 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff11)
      t2 = -l3+1
      t3 = 1-z
      t5 = t2*t3*s13r
      t6 = t3*l3
      t7 = t6*s23r
      t8 = t6*s1vr
      t11 = t3**2
      t13 = l3*t2*t11*s34r
      tFjet12 = Fjet(var,ndim,z,1/ux,t5,t7,-1-t5-t8+z,t8-t7-t13,t13,t8,-
     #1+z-t8+t13,-t5-t7-t13+z,1+t5+t7,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff12)

CCC Sum

      qgrmnum4e4 = tFjet9*tcoff9+tFjet10*tcoff10+tFjet11*tcoff11+tFjet12
     #*tcoff12
      RETURN
      END

      double precision function qgrmnum5e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = l3-1
      t3 = t2*t1
      t4 = t3*s2l2
      t6 = t1**2
      t7 = t2*t6
      t8 = t7*s3l2p
      t10 = s4l2p*t7
      t13 = s1vr**2
      t18 = t2**2
      t19 = t6*t18
      t20 = s34r*s2l2
      t21 = t19*t20
      t22 = 128.D0/3.D0*t21
      t23 = t6*t1
      t24 = t23*t18
      t25 = t24*s3l2p
      t27 = t24*s4l2p
      t34 = t25+t27
      t39 = t18*t2
      t40 = t23*t39
      t41 = s34r**2
      t42 = t41*s2l2
      t45 = t6**2
      t46 = t45*t39
      t54 = t3*s2l1
      t56 = t7*s3l1p
      t58 = s4l1p*t7
      t65 = s34r*s2l1
      t66 = t19*t65
      t68 = t24*s3l1p
      t70 = t24*s4l1p
      t77 = t68+t70
      t82 = t41*s2l1
      t92 = z*t2
      t93 = l3*t6
      t94 = t13*s1vr
      t98 = z*l3
      t102 = s4l2p*s2l1
      t105 = s4l1p*s2l2
      t132 = l3*t1
      t137 = l3*s34r
      t138 = t7*t137
      t158 = -64.D0/3.D0-64.D0/3.D0*z
      t160 = l3*t2
      t161 = t23*s3l2p
      t164 = 64.D0/3.D0*t160*t161*s34r
      t165 = 2*z
      t166 = -4+t165
      t167 = t166*t1
      t169 = 64.D0/3.D0*t167*s3l2p
      t170 = 64.D0/3.D0*t1
      t174 = s23r**2
      t179 = 128.D0/3.D0*t138+128.D0/3.D0
      t182 = t2*t23
      t189 = (-3+z)*t1
      t196 = t166*t2
      t197 = t6*s3l2p
      t206 = s4l2p*t6
      t210 = -3+t165
      t211 = t210*t1
      t212 = t2*s34r
      t216 = t210*t2
      t236 = t23*s3l1p
      t241 = 64.D0/3.D0*t167*s3l1p
      t261 = t6*s3l1p
      t270 = s4l1p*t6
      t290 = z*t6
      t291 = l3**2
      t318 = t93*s34r
      t322 = 64.D0/3.D0*t206*s3l1p
      t324 = 64.D0/3.D0*t270*s3l2p
      t334 = z**2
      s2 = (((64.D0/3.D0*t4+128.D0/3.D0*t8+64.D0/3.D0*t10)*t13+((-64.D0/
     #3.D0*t4-64.D0/3.D0*t8-64.D0/3.D0*t10)*s23r+t22+(-256.D0/3.D0*t25-6
     #4*t27)*s34r)*s1vr+(-64*t21+64*t34*s34r)*s23r-128.D0/3.D0*t40*t42+(
     #128.D0/3.D0*t46*s3l2p+128.D0/3.D0*t46*s4l2p)*t41)*s1l1+((64.D0/3.D
     #0*t54+128.D0/3.D0*t56+64.D0/3.D0*t58)*t13+((-64.D0/3.D0*t54-64.D0/
     #3.D0*t56-64.D0/3.D0*t58)*s23r+128.D0/3.D0*t66+(-256.D0/3.D0*t68-64
     #*t70)*s34r)*s1vr+(-64*t66+64*t77*s34r)*s23r-128.D0/3.D0*t40*t82+(1
     #28.D0/3.D0*t46*s3l1p+128.D0/3.D0*t46*s4l1p)*t41)*s1l2+64.D0/3.D0*t
     #92*t93*t94+(-64.D0/3.D0*t7*t98*s23r-64.D0/3.D0*t7*t102-64.D0/3.D0*
     #t7*t105-128.D0/3.D0*t98*t24*s34r)*t13+(64.D0/3.D0*t98*t23*t18*s34r
     #*s23r+(-t22+64.D0/3.D0*t34*s34r)*s2l1+64.D0/3.D0*t77*s34r*s2l2+64.
     #D0/3.D0*t98*t46*t41)*s1vr)*s13r
      s4 = ((-128.D0/3.D0*t132*t94+(128.D0/3.D0*t132*s23r+128*t138)*t13+
     #(-256.D0/3.D0*t7*t137*s23r-256.D0/3.D0*l3*t23*t18*t41)*s1vr)*s1l2+
     #(-64.D0/3.D0*t132*s2l2-64.D0/3.D0*t93*s3l2p)*t94+(t158*s2l2+t164-t
     #169+t170*s4l2p)*t13+(64.D0/3.D0*t132*s2l2*t174+(t179*s2l2+(-64.D0/
     #3.D0*t160*t161-64.D0/3.D0*t182*l3*s4l2p)*s34r+t169+64.D0/3.D0*t189
     #*s4l2p)*s23r+128.D0/3.D0*t3*t20+(64.D0/3.D0*t196*t197-64*t10)*s34r
     #)*s1vr+(64.D0/3.D0*t1*s2l2-64.D0/3.D0*t197-64.D0/3.D0*t206)*t174+(
     #64.D0/3.D0*t211*t212*s2l2+(-64.D0/3.D0*t216*t197-64.D0/3.D0*t216*t
     #206)*s34r)*s23r-128.D0/3.D0*t19*t42+128.D0/3.D0*t34*t41)*s1l1
      s5 = ((-64.D0/3.D0*t132*s2l1-64.D0/3.D0*t93*s3l1p)*t94+(t158*s2l1+
     #64.D0/3.D0*t160*t236*s34r-t241+t170*s4l1p)*t13+(64.D0/3.D0*t132*s2
     #l1*t174+(t179*s2l1+(-64.D0/3.D0*t160*t236-64.D0/3.D0*t182*l3*s4l1p
     #)*s34r+t241+64.D0/3.D0*t189*s4l1p)*s23r+128.D0/3.D0*t3*t65+(64.D0/
     #3.D0*t196*t261-64*t58)*s34r)*s1vr+(64.D0/3.D0*t1*s2l1-64.D0/3.D0*t
     #261-64.D0/3.D0*t270)*t174+(64.D0/3.D0*t211*t212*s2l1+(-64.D0/3.D0*
     #t216*t261-64.D0/3.D0*t216*t270)*s34r)*s23r-128.D0/3.D0*t19*t82+128
     #.D0/3.D0*t77*t41)*s1l2
      s3 = s4+s5
      s1 = s2+s3
      taux7 = s1-64.D0/3.D0*t290*t291*s23r*t94+(64.D0/3.D0*t290*t291*t17
     #4+(64.D0/3.D0*t93*t102+64.D0/3.D0*t93*t105+64.D0/3.D0*t92*t23*t291
     #*s34r-64.D0/3.D0*t290*l3)*s23r+(128.D0/3.D0*t7*t137*s2l2-t164)*s2l
     #1-64.D0/3.D0*t160*t23*s3l1p*s34r*s2l2-64.D0/3.D0*t92*t318-t322-t32
     #4)*t13+(64.D0/3.D0*t290*l3*t174+(64.D0/3.D0*t206*s2l1+64.D0/3.D0*t
     #270*s2l2+64.D0/3.D0*t334*t2*t318+t322+t324+128.D0/3.D0*t206*s4l1p)
     #*s23r+(128.D0/3.D0*t7*t20+(-64.D0/3.D0*t182*s3l2p+64.D0/3.D0*t10)*
     #s34r)*s2l1+(-64.D0/3.D0*t182*s3l1p+64.D0/3.D0*t58)*s34r*s2l2+64.D0
     #/3.D0*t98*t24*t41)*s1vr
      t1 = 1-z
      t2 = l3-1
      t3 = t1*t2
      t4 = t3*s2l2
      t6 = -t2
      t7 = -t1
      t8 = t7**2
      t9 = t6*t8
      t10 = t9*s3l2p
      t12 = t9*s4l2p
      t15 = s1vr**2
      t20 = t2**2
      t21 = t8*t20
      t23 = t21*s34r*s2l2
      t25 = t8*t7
      t26 = t25*t20
      t27 = t26*s3l2p
      t29 = t26*s4l2p
      t36 = t27+t29
      t41 = t20*t2
      t42 = t25*t41
      t43 = s34r**2
      t44 = t43*s2l2
      t47 = t8**2
      t48 = t47*t41
      t56 = t3*s2l1
      t58 = t9*s3l1p
      t60 = t9*s4l1p
      t68 = t21*s34r*s2l1
      t70 = t26*s3l1p
      t72 = t26*s4l1p
      t79 = -t70-t72
      t84 = t43*s2l1
      t94 = s3l2p*s2l1
      t96 = s3l1p*s2l2
      t101 = t2*t8
      t117 = t7*l3
      t120 = t8*l3
      t121 = t120*s3l2p
      t122 = 512.D0/3.D0*t121
      t124 = t15*s1vr
      t126 = t120*s4l2p
      t130 = l3*s34r
      t133 = 256.D0/3.D0*t9*t130-256.D0/3.D0-256.D0/3.D0*z
      t135 = l3*t2
      t136 = t25*s3l2p
      t140 = 2*z
      t141 = -4+t140
      t142 = t141*t7
      t144 = 256.D0/3.D0*t142*s3l2p
      t149 = t1*l3
      t153 = s23r**2
      t156 = 3*t6*t8
      t159 = -256.D0/3.D0*t156*t130+512.D0/3.D0
      t163 = t2*t25
      t170 = (-3+z)*t7
      t182 = 256.D0/3.D0*l3*t25*t20*t43-512.D0/3.D0*t1*t2*s34r
      t184 = t20*t47
      t189 = t141*t2
      t190 = t8*s3l2p
      t199 = t8*s4l2p
      t203 = -3+t140
      t204 = t203*t7
      t205 = t2*s34r
      t209 = t203*t2
      t225 = t120*s3l1p
      t226 = 512.D0/3.D0*t225
      t229 = t120*s4l1p
      t235 = t25*s3l1p
      t240 = 256.D0/3.D0*t142*s3l1p
      t268 = t8*s3l1p
      t277 = t8*s4l1p
      t310 = t1*t7
      t333 = t6*t25
      s2 = (((-256.D0/3.D0*t4-512.D0/3.D0*t10-256.D0/3.D0*t12)*t15+((256
     #.D0/3.D0*t4+256.D0/3.D0*t10+256.D0/3.D0*t12)*s23r+512.D0/3.D0*t23+
     #(-1024.D0/3.D0*t27-256*t29)*s34r)*s1vr+(-256*t23+256*t36*s34r)*s23
     #r-512.D0/3.D0*t42*t44+(512.D0/3.D0*t48*s3l2p+512.D0/3.D0*t48*s4l2p
     #)*t43)*s1l1+((256.D0/3.D0*t56+512.D0/3.D0*t58+256.D0/3.D0*t60)*t15
     #+((-256.D0/3.D0*t56-256.D0/3.D0*t58-256.D0/3.D0*t60)*s23r-512.D0/3
     #.D0*t68+(1024.D0/3.D0*t70+256*t72)*s34r)*s1vr+(256*t68+256*t79*s34
     #r)*s23r+512.D0/3.D0*t42*t84+(-512.D0/3.D0*t48*s3l1p-512.D0/3.D0*t4
     #8*s4l1p)*t43)*s1l2+(-256.D0/3.D0*t9*t94+256.D0/3.D0*t9*t96)*t15+((
     #-256.D0/3.D0*t101*s3l2p-256.D0/3.D0*t101*s4l2p)*s2l1+(256.D0/3.D0*
     #t101*s3l1p+256.D0/3.D0*t101*s4l1p)*s2l2)*s23r*s1vr)*s13r
      s4 = ((-256.D0/3.D0*t117*s2l2-t122)*t124+((t122+256.D0/3.D0*t126)*
     #s23r+t133*s2l2+256*t135*t136*s34r-t144+256.D0/3.D0*t7*s4l2p)*t15+(
     #(-256.D0/3.D0*t149*s2l2-256.D0/3.D0*t121-256.D0/3.D0*t126)*t153+(t
     #159*s2l2+(-256*t135*t136-512.D0/3.D0*t163*l3*s4l2p)*s34r+t144+256.
     #D0/3.D0*t170*s4l2p)*s23r+t182*s2l2-256.D0/3.D0*t184*l3*s3l2p*t43+(
     #256.D0/3.D0*t189*t190+256.D0/3.D0*t156*s4l2p)*s34r)*s1vr+(-256.D0/
     #3.D0*t1*s2l2-256.D0/3.D0*t190-256.D0/3.D0*t199)*t153+(256.D0/3.D0*
     #t204*t205*s2l2+(-256.D0/3.D0*t209*t190-256.D0/3.D0*t209*t199)*s34r
     #)*s23r-512.D0/3.D0*t21*t44+512.D0/3.D0*t36*t43)*s1l1
      s5 = ((256.D0/3.D0*t117*s2l1+t226)*t124+((-t226-256.D0/3.D0*t229)*
     #s23r-t133*s2l1-256*t135*t235*s34r+t240-256.D0/3.D0*t7*s4l1p)*t15+(
     #(256.D0/3.D0*t149*s2l1+256.D0/3.D0*t225+256.D0/3.D0*t229)*t153+(-t
     #159*s2l1+(256*t135*t235+512.D0/3.D0*t163*l3*s4l1p)*s34r-t240-256.D
     #0/3.D0*t170*s4l1p)*s23r-t182*s2l1+256.D0/3.D0*t184*l3*s3l1p*t43+(-
     #256.D0/3.D0*t189*t268-256.D0/3.D0*t156*s4l1p)*s34r)*s1vr+(256.D0/3
     #.D0*t1*s2l1+256.D0/3.D0*t268+256.D0/3.D0*t277)*t153+(-256.D0/3.D0*
     #t204*t205*s2l1+(256.D0/3.D0*t209*t268+256.D0/3.D0*t209*t277)*s34r)
     #*s23r+512.D0/3.D0*t21*t84+512.D0/3.D0*t79*t43)*s1l2
      s3 = s4+s5
      s1 = s2+s3
      taux8 = s1+(-256.D0/3.D0*t120*t94+256.D0/3.D0*t120*t96)*t124+(((25
     #6.D0/3.D0*t121+256.D0/3.D0*t126)*s2l1+(-256.D0/3.D0*t225-256.D0/3.
     #D0*t229)*s2l2)*s23r+256.D0/3.D0*t310*t94-256.D0/3.D0*t310*t96)*t15
     #+(((256.D0/3.D0*t190+256.D0/3.D0*t199)*s2l1+(-256.D0/3.D0*t268-256
     #.D0/3.D0*t277)*s2l2)*s23r+256.D0/3.D0*t9*s4l2p*s34r*s2l1-256.D0/3.
     #D0*t9*s4l1p*s34r*s2l2+(-256.D0/3.D0*t333*s4l2p*s3l1p+256.D0/3.D0*t
     #333*s4l1p*s3l2p)*s34r)*s1vr

CCC Coefficients

      tcoff13 = taux7
      tcoff14 = taux7
      tcoff15 = taux8
      tcoff16 = taux8

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet13 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff13)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = -l3+1
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet14 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff14)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet15 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff15)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = -l3+1
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet16 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff16)

CCC Sum

      qgrmnum5e0 = tFjet13*tcoff13+tFjet14*tcoff14+tFjet15*tcoff15+tFjet
     #16*tcoff16
      RETURN
      END

      double precision function qgrmnum5e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = t1**2
      t3 = t2*z
      t4 = l3-1
      t5 = t4**2
      t6 = s1vr**2
      t9 = t1*t2
      t11 = t5*t4
      t17 = s13r**2
      t19 = t1*t4
      t20 = t19*s2l2
      t22 = t4*t2
      t23 = t22*s3l2p
      t24 = 128.D0/3.D0*t23
      t25 = t22*s4l2p
      t26 = 64.D0/3.D0*t25
      t32 = t2*t5
      t33 = s34r*s2l2
      t34 = t32*t33
      t35 = 128.D0/3.D0*t34
      t36 = t9*t5
      t37 = t36*s3l2p
      t39 = t36*s4l2p
      t46 = -t37-t39
      t51 = t9*t11
      t52 = s34r**2
      t56 = t2**2
      t57 = t56*t11
      t65 = t19*s2l1
      t67 = t22*s3l1p
      t68 = 128.D0/3.D0*t67
      t69 = t22*s4l1p
      t70 = 64.D0/3.D0*t69
      t77 = t32*s34r*s2l1
      t79 = t36*s3l1p
      t81 = t36*s4l1p
      t88 = -t79-t81
      t107 = z*l3
      t109 = t107*t36*s34r
      t111 = z*t4
      t116 = t1*z
      t133 = z**2
      t134 = t133*t2
      t135 = t5*s34r
      t149 = l3*s34r
      t156 = t5*t52
      t157 = l3*t9*t156
      t163 = t1*l3
      t164 = t163*s2l2
      t166 = l3*t2
      t167 = t166*s3l2p
      t170 = t6*s1vr
      t172 = 128.D0/3.D0*t164
      t173 = 64.D0/3.D0*t167
      t178 = t22*t149
      t180 = 256.D0/3.D0*t178+128.D0/3.D0
      t182 = l3*t4
      t183 = t9*s3l2p
      t187 = 2*z
      t188 = 3-t187
      t189 = t188*t1
      t191 = 64.D0/3.D0*t189*s3l2p
      t194 = s23r**2
      t200 = -320.D0/3.D0*t178-64+64.D0/3.D0*z
      t203 = t4*t9
      t209 = 2-z
      t210 = t209*t1
      t218 = t4*s34r
      t221 = -128.D0/3.D0*t157+64.D0/3.D0*t1**2*t218
      t223 = t5*t56
      t228 = 1-t187
      t229 = t228*t4
      t230 = t2*s3l2p
      t236 = t1*s2l2
      t237 = t2*s4l2p
      t241 = t228*t1
      t254 = t163*s2l1
      t256 = t166*s3l1p
      t267 = t9*s3l1p
      t272 = 64.D0/3.D0*t189*s3l1p
      t294 = t2*s3l1p
      t301 = t2*s4l1p
      t321 = 64.D0/3.D0*t166*s3l1p*s2l2
      t326 = l3**2
      t342 = -t209*t1
      t346 = 64.D0/3.D0*t1*s4l2p
      t350 = t1*s4l1p
      t354 = t166*s34r
      s3 = (64.D0/3.D0*t3*t5*t6-64.D0/3.D0*z*t9*t11*s34r*s1vr)*t17
      s4 = (((-64.D0/3.D0*t20-t24-t26)*t6+((64.D0/3.D0*t20+64.D0/3.D0*t2
     #3+64.D0/3.D0*t25)*s23r-t35+(256.D0/3.D0*t37+64*t39)*s34r)*s1vr+(64
     #*t34+64*t46*s34r)*s23r+128.D0/3.D0*t51*t52*s2l2+(-128.D0/3.D0*t57*
     #s3l2p-128.D0/3.D0*t57*s4l2p)*t52)*s1l1+((-64.D0/3.D0*t65-t68-t70)*
     #t6+((64.D0/3.D0*t65+64.D0/3.D0*t67+64.D0/3.D0*t69)*s23r-128.D0/3.D
     #0*t77+(256.D0/3.D0*t79+64*t81)*s34r)*s1vr+(64*t77+64*t88*s34r)*s23
     #r+128.D0/3.D0*t51*t52*s2l1+(-128.D0/3.D0*t57*s3l1p-128.D0/3.D0*t57
     #*s4l1p)*t52)*s1l2+((-t24-t26)*s2l1+(-t68-t70)*s2l2-128.D0/3.D0*t10
     #9-64.D0/3.D0*t111*t2)*t6+((64.D0/3.D0*t109+64.D0/3.D0*t116*t4)*s23
     #r+(-t35-64.D0/3.D0*t46*s34r)*s2l1-64.D0/3.D0*t88*s34r*s2l2+128.D0/
     #3.D0*t107*t57*t52-64.D0/3.D0*t134*t135)*s1vr+64*t134*t135*s23r+128
     #.D0/3.D0*t133*t9*t11*t52)*s13r
      s2 = s3+s4
      s3 = s2+((-128.D0/3.D0*t22*t149*t6+(128.D0/3.D0*t22*t149*s23r+128.
     #D0/3.D0*t157)*s1vr)*s1l2+(-64.D0/3.D0*t164+128.D0/3.D0*t167)*t170+
     #((t172-t173-64.D0/3.D0*t166*s4l2p)*s23r+t180*s2l2-64*t182*t183*s34
     #r-t191)*t6+(-64.D0/3.D0*t163*s2l2*t194+(t200*s2l2+(128.D0/3.D0*t18
     #2*t183+128.D0/3.D0*t203*l3*s4l2p)*s34r+t191+64.D0/3.D0*t210*s4l2p)
     #*s23r+t221*s2l2+64.D0/3.D0*t223*l3*s3l2p*t52+64.D0/3.D0*t229*t230*
     #s34r)*s1vr+(-64.D0/3.D0*t236+64.D0/3.D0*t230+64.D0/3.D0*t237)*t194
     #+(64.D0/3.D0*t241*t218*s2l2+(-64.D0/3.D0*t229*t230-64.D0/3.D0*t229
     #*t237)*s34r)*s23r)*s1l1
      s1 = s3+((-64.D0/3.D0*t254+128.D0/3.D0*t256)*t170+((128.D0/3.D0*t2
     #54-64.D0/3.D0*t256-64.D0/3.D0*t166*s4l1p)*s23r+t180*s2l1-64*t182*t
     #267*s34r-t272)*t6+(-64.D0/3.D0*t163*s2l1*t194+(t200*s2l1+(128.D0/3
     #.D0*t182*t267+128.D0/3.D0*t203*l3*s4l1p)*s34r+t272+64.D0/3.D0*t210
     #*s4l1p)*s23r+t221*s2l1+64.D0/3.D0*t223*l3*s3l1p*t52+64.D0/3.D0*t22
     #9*t294*s34r)*s1vr+(-64.D0/3.D0*t1*s2l1+64.D0/3.D0*t294+64.D0/3.D0*
     #t301)*t194+(64.D0/3.D0*t241*t218*s2l1+(-64.D0/3.D0*t229*t294-64.D0
     #/3.D0*t229*t301)*s34r)*s23r)*s1l2+((-t172+t173)*s2l1+t321+128.D0/3
     #.D0*t116*l3)*t170
      s2 = s1+(-64.D0/3.D0*t3*t326*t194+((t172+t173)*s2l1+t321-64.D0/3.D
     #0*(3-z)*z*t163)*s23r+((128.D0/3.D0*t178+128.D0/3.D0-128.D0/3.D0*z)
     #*s2l2+64.D0/3.D0*t342*s3l2p-t346)*s2l1+(64.D0/3.D0*t342*s3l1p-64.D
     #0/3.D0*t350)*s2l2-128*t111*t354-128.D0/3.D0*t230*s3l1p+128.D0/3.D0
     #*t133)*t6+(64.D0/3.D0*t228*z*t163*t194+((128.D0/3.D0*t236+64.D0/3.
     #D0*t116*s3l2p+t346)*s2l1+(64.D0/3.D0*t116*s3l1p+64.D0/3.D0*t350)*s
     #2l2+64.D0/3.D0*(5-t187)*z*t4*t354+(128.D0/3.D0*t230+64.D0/3.D0*t23
     #7)*s3l1p+64.D0/3.D0*t301*s3l2p+64.D0/3.D0*(1-4*z+t133)*z)*s23r+(12
     #8.D0/3.D0*t22*t33+64.D0/3.D0*t22*s4l2p*s34r)*s2l1+64.D0/3.D0*t22*s
     #4l1p*s34r*s2l2+256.D0/3.D0*t107*t36*t52+((128.D0/3.D0*t203*s3l2p+6
     #4.D0/3.D0*t203*s4l2p)*s3l1p+64.D0/3.D0*t203*s4l1p*s3l2p+64.D0/3.D0
     #*(-3*z+1)*z*t19)*s34r)*s1vr
      taux7 = s2-64.D0/3.D0*t133*t1*t194+64.D0/3.D0*t188*t133*t1*t218*s2
     #3r+128.D0/3.D0*t134*t156
      t1 = -1+z
      t2 = 4*t1
      t3 = l3-1
      t4 = t2*t3
      t5 = t4*s2l2
      t8 = t1**2
      t9 = 4*t3*t8
      t10 = t9*s3l2p
      t12 = t9*s4l2p
      t15 = s1vr**2
      t20 = t3**2
      t21 = t8*t20
      t23 = t21*s34r*s2l2
      t25 = t8*t1
      t26 = t25*t20
      t27 = t26*s3l2p
      t29 = t26*s4l2p
      t36 = -t27-t29
      t41 = t20*t3
      t42 = t25*t41
      t43 = s34r**2
      t44 = t43*s2l2
      t47 = t8**2
      t48 = t47*t41
      t56 = t4*s2l1
      t58 = t9*s3l1p
      t60 = t9*s4l1p
      t68 = t21*s34r*s2l1
      t70 = t26*s3l1p
      t72 = t26*s4l1p
      t79 = t70+t72
      t84 = t43*s2l1
      t94 = t3*t8
      t95 = t94*s4l2p
      t99 = t94*s4l1p
      t107 = -3*t3*t8
      t132 = -t1
      t133 = 3*t132
      t134 = t133*l3
      t137 = t8*l3
      t138 = t137*s3l2p
      t141 = t15*s1vr
      t143 = t1*l3
      t147 = t137*s4l2p
      t153 = l3*s34r
      t157 = 512.D0/3.D0*t3*t8*t153+1280.D0/3.D0+256*z
      t159 = l3*t3
      t160 = t25*s3l2p
      t162 = t159*t160*s34r
      t164 = 8*z
      t166 = (15-t164)*t1
      t168 = 256.D0/3.D0*t166*s3l2p
      t173 = l3*t2
      t179 = s23r**2
      t186 = -2048.D0/3.D0*t3*t8*t153-768+256.D0/3.D0*z
      t190 = t3*t25
      t198 = (11-4*z)*t1
      t208 = t3*s34r
      t211 = -256.D0/3.D0*l3*t25*t20*t43-256.D0/3.D0*(7-z)*t1*t208
      t213 = t20*t47
      t219 = (13-t164)*t3
      t220 = t8*s3l2p
      t223 = 9*t3*t8
      t233 = t8*s4l2p
      t237 = 10-t164
      t238 = t237*t1
      t242 = t237*t3
      t258 = t137*s3l1p
      t265 = t137*s4l1p
      t271 = t25*s3l1p
      t273 = t159*t271*s34r
      t276 = 256.D0/3.D0*t166*s3l1p
      t306 = t8*s3l1p
      t317 = t8*s4l1p
      t354 = 2*t1**2
      t364 = t233*s3l1p
      t366 = t317*s3l2p
      t370 = t132*t1
      t387 = (1-2*z)*t3
      s2 = (((-256.D0/3.D0*t5-512.D0/3.D0*t10-256.D0/3.D0*t12)*t15+((256
     #.D0/3.D0*t5+256.D0/3.D0*t10+256.D0/3.D0*t12)*s23r-2048.D0/3.D0*t23
     #+(4096.D0/3.D0*t27+1024*t29)*s34r)*s1vr+(1024*t23+1024*t36*s34r)*s
     #23r+2048.D0/3.D0*t42*t44+(-2048.D0/3.D0*t48*s3l2p-2048.D0/3.D0*t48
     #*s4l2p)*t43)*s1l1+((256.D0/3.D0*t56+512.D0/3.D0*t58+256.D0/3.D0*t6
     #0)*t15+((-256.D0/3.D0*t56-256.D0/3.D0*t58-256.D0/3.D0*t60)*s23r+20
     #48.D0/3.D0*t68+(-4096.D0/3.D0*t70-1024*t72)*s34r)*s1vr+(-1024*t68+
     #1024*t79*s34r)*s23r-2048.D0/3.D0*t42*t84+(2048.D0/3.D0*t48*s3l1p+2
     #048.D0/3.D0*t48*s4l1p)*t43)*s1l2+((-256.D0/3.D0*t10-256.D0/3.D0*t9
     #5)*s2l1+(256.D0/3.D0*t58+256.D0/3.D0*t99)*s2l2)*t15+(((-256.D0/3.D
     #0*t107*s3l2p-256.D0/3.D0*t107*s4l2p)*s2l1+(256.D0/3.D0*t107*s3l1p+
     #256.D0/3.D0*t107*s4l1p)*s2l2)*s23r+256.D0/3.D0*t26*s4l2p*s34r*s2l1
     #-256.D0/3.D0*t26*s4l1p*s34r*s2l2)*s1vr)*s13r
      s4 = ((-256.D0/3.D0*t134*s2l2+512*t138)*t141+((256.D0/3.D0*t143*s2
     #l2-1280.D0/3.D0*t138-512.D0/3.D0*t147)*s23r+t157*s2l2-2048.D0/3.D0
     #*t162-t168+256.D0/3.D0*t133*s4l2p)*t15+((-256.D0/3.D0*t173*s2l2+25
     #6*t138+256*t147)*t179+(t186*s2l2+(768*t159*t160+512*t190*l3*s4l2p)
     #*s34r+t168+256.D0/3.D0*t198*s4l2p)*s23r+t211*s2l2+512.D0/3.D0*t213
     #*l3*s3l2p*t43+(256.D0/3.D0*t219*t220+256.D0/3.D0*t223*s4l2p)*s34r)
     #*s1vr+(-256.D0/3.D0*t2*s2l2+1024.D0/3.D0*t220+1024.D0/3.D0*t233)*t
     #179+(256.D0/3.D0*t238*t208*s2l2+(-256.D0/3.D0*t242*t220-256.D0/3.D
     #0*t242*t233)*s34r)*s23r+512*t21*t44+512*t36*t43)*s1l1
      s5 = ((256.D0/3.D0*t134*s2l1-512*t258)*t141+((-256.D0/3.D0*t143*s2
     #l1+1280.D0/3.D0*t258+512.D0/3.D0*t265)*s23r-t157*s2l1+2048.D0/3.D0
     #*t273+t276-256.D0/3.D0*t133*s4l1p)*t15+((256.D0/3.D0*t173*s2l1-256
     #*t258-256*t265)*t179+(-t186*s2l1+(-768*t159*t271-512*t190*l3*s4l1p
     #)*s34r-t276-256.D0/3.D0*t198*s4l1p)*s23r-t211*s2l1-512.D0/3.D0*t21
     #3*l3*s3l1p*t43+(-256.D0/3.D0*t219*t306-256.D0/3.D0*t223*s4l1p)*s34
     #r)*s1vr+(256.D0/3.D0*t2*s2l1-1024.D0/3.D0*t306-1024.D0/3.D0*t317)*
     #t179+(-256.D0/3.D0*t238*t208*s2l1+(256.D0/3.D0*t242*t306+256.D0/3.
     #D0*t242*t317)*s34r)*s23r-512*t21*t84+512*t79*t43)*s1l2
      s3 = s4+s5
      s1 = s2+s3
      taux8 = s1+(512.D0/3.D0*t137*s3l2p*s2l1-512.D0/3.D0*t137*s3l1p*s2l
     #2)*t141+(((-256.D0/3.D0*t138-256.D0/3.D0*t147)*s2l1+(256.D0/3.D0*t
     #258+256.D0/3.D0*t265)*s2l2)*s23r+(512.D0/3.D0*t162+256.D0/3.D0*t35
     #4*s3l2p)*s2l1+(-512.D0/3.D0*t273-256.D0/3.D0*t354*s3l1p)*s2l2-256*
     #t364+256*t366)*t15+(((256.D0/3.D0*t370*s3l2p+256.D0/3.D0*t370*s4l2
     #p)*s2l1+(-256.D0/3.D0*t370*s3l1p-256.D0/3.D0*t370*s4l1p)*s2l2+256.
     #D0/3.D0*t364-256.D0/3.D0*t366)*s23r+(-256.D0/3.D0*t387*t220+256.D0
     #/3.D0*t95)*s34r*s2l1+(256.D0/3.D0*t387*t306-256.D0/3.D0*t99)*s34r*
     #s2l2+(-256.D0/3.D0*t190*s4l2p*s3l1p+256.D0/3.D0*t190*s4l1p*s3l2p)*
     #s34r)*s1vr

CCC Coefficients

      tcoff13 = taux7
      tcoff14 = taux7
      tcoff15 = taux8
      tcoff16 = taux8

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet13 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff13)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = -l3+1
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet14 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff14)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet15 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff15)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = -l3+1
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet16 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff16)

CCC Sum

      qgrmnum5e1 = tFjet13*tcoff13+tFjet14*tcoff14+tFjet15*tcoff15+tFjet
     #16*tcoff16
      RETURN
      END

      double precision function qgrmnum5e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = t1**2
      t3 = t2*z
      t4 = l3-1
      t5 = t4**2
      t6 = s1vr**2
      t9 = t1*t2
      t11 = t5*t4
      t17 = s13r**2
      t19 = z*t4
      t20 = l3*t2
      t21 = t6*s1vr
      t25 = t4*t2
      t26 = z*l3
      t30 = t25*s3l2p
      t31 = t25*s4l2p
      t32 = -t30-t31
      t35 = t25*s3l1p
      t36 = t25*s4l1p
      t37 = -t35-t36
      t40 = t9*t5
      t42 = t26*t40*s34r
      t45 = -t1*z
      t46 = t1*t4
      t52 = t1*z
      t57 = t2*t5
      t58 = s34r*s2l2
      t63 = t40*s3l2p+t40*s4l2p
      t70 = t40*s3l1p+t40*s4l1p
      t74 = t2**2
      t76 = s34r**2
      t80 = z**2
      t81 = t80*t2
      t82 = t5*s34r
      t104 = l3*t4
      t105 = t9*s3l2p
      t107 = t104*t105*s34r
      t110 = 64.D0/3.D0*t1*s3l2p
      t113 = l3*s34r
      t118 = t4*t9
      t128 = t46*t58
      t130 = t5*t74
      t162 = t9*s3l1p
      t164 = t104*t162*s34r
      t167 = 64.D0/3.D0*t1*s3l1p
      t184 = t46*s34r*s2l1
      t209 = l3**2
      t243 = t20*s34r
      t249 = t80*t1
      t250 = s23r**2
      t259 = 2*z
      t265 = t19*t2
      s2 = (-64.D0/3.D0*t3*t5*t6+64.D0/3.D0*z*t9*t11*s34r*s1vr)*t17+(64*
     #t19*t20*t21+(64.D0/3.D0*t25*t26*s23r+64.D0/3.D0*t32*s2l1+64.D0/3.D
     #0*t37*s2l2-256.D0/3.D0*t42-64.D0/3.D0*t45*t46)*t6+((-128.D0/3.D0*t
     #42-64.D0/3.D0*t52*t4)*s23r+(-128.D0/3.D0*t57*t58+64.D0/3.D0*t63*s3
     #4r)*s2l1+64.D0/3.D0*t70*s34r*s2l2+64.D0/3.D0*t26*t74*t11*t76+64.D0
     #/3.D0*t81*t82)*s1vr-64*t81*t82*s23r-128.D0/3.D0*t80*t9*t11*t76)*s1
     #3r
      s1 = s2+(64.D0/3.D0*t20*s3l2p*t21+((-64.D0/3.D0*t20*s3l2p-64.D0/3.
     #D0*t20*s4l2p)*s23r-128.D0/3.D0*t107-t110)*t6+((-64.D0/3.D0*t25*t11
     #3*s2l2+(64.D0/3.D0*t104*t105+64.D0/3.D0*t118*l3*s4l2p)*s34r+t110+6
     #4.D0/3.D0*t1*s4l2p)*s23r-64.D0/3.D0*t128+64.D0/3.D0*t130*l3*s3l2p*
     #t76+(64*t30+128.D0/3.D0*t31)*s34r)*s1vr+(128.D0/3.D0*t128+128.D0/3
     #.D0*t32*s34r)*s23r+128.D0/3.D0*t57*t76*s2l2-128.D0/3.D0*t63*t76)*s
     #1l1+(64.D0/3.D0*t20*s3l1p*t21+((-64.D0/3.D0*t20*s3l1p-64.D0/3.D0*t
     #20*s4l1p)*s23r-128.D0/3.D0*t164-t167)*t6+((-64.D0/3.D0*t25*t113*s2
     #l1+(64.D0/3.D0*t104*t162+64.D0/3.D0*t118*l3*s4l1p)*s34r+t167+64.D0
     #/3.D0*t1*s4l1p)*s23r-64.D0/3.D0*t184+64.D0/3.D0*t130*l3*s3l1p*t76+
     #(64*t35+128.D0/3.D0*t36)*s34r)*s1vr+(128.D0/3.D0*t184+128.D0/3.D0*
     #t37*s34r)*s23r+128.D0/3.D0*t57*t76*s2l1-128.D0/3.D0*t70*t76)*s1l2
      taux7 = s1+(-64*t3*t209*s23r+64.D0/3.D0*t20*s3l2p*s2l1+64.D0/3.D0*
     #t20*s3l1p*s2l2+128.D0/3.D0*t52*l3)*t21+((64*t19*t9*t209*s34r-64.D0
     #/3.D0*(-2+4*z)*z*t1*l3)*s23r+(-64.D0/3.D0*t107+64.D0/3.D0*t2*s3l2p
     #)*s2l1+(-64.D0/3.D0*t164+64.D0/3.D0*t2*s3l1p)*s2l2-64*t19*t243-128
     #.D0/3.D0*z)*t6+(64.D0/3.D0*t249*l3*t250+(64.D0/3.D0*(1+5*z)*z*t4*t
     #243+64.D0/3.D0*(1+t259-t80)*z)*s23r-64.D0/3.D0*t265*s3l2p*s34r*s2l
     #1-64.D0/3.D0*t265*s3l1p*s34r*s2l2+64.D0/3.D0*t26*t40*t76+64.D0/3.D
     #0*t45*t46*s34r)*s1vr+64.D0/3.D0*t249*t250-64.D0/3.D0*(1-t259)*t80*
     #t1*t4*s34r*s23r
      t1 = 1-z
      t2 = 5*t1
      t3 = l3-1
      t4 = t2*t3
      t5 = t4*s2l2
      t7 = -t3
      t9 = -t1
      t10 = t9**2
      t11 = 5*t7*t10
      t12 = t11*s3l2p
      t14 = t11*s4l2p
      t17 = s1vr**2
      t22 = t3**2
      t23 = t10*t22
      t25 = t23*s34r*s2l2
      t27 = t10*t9
      t28 = t27*t22
      t29 = t28*s3l2p
      t31 = t28*s4l2p
      t38 = t29+t31
      t43 = t22*t3
      t44 = t27*t43
      t45 = s34r**2
      t46 = t45*s2l2
      t49 = t10**2
      t50 = t49*t43
      t58 = t4*s2l1
      t60 = t11*s3l1p
      t62 = t11*s4l1p
      t70 = t23*s34r*s2l1
      t72 = t28*s3l1p
      t74 = t28*s4l1p
      t81 = -t72-t74
      t86 = t45*s2l1
      t97 = 6*t7*t10
      t100 = t3*t10
      t101 = t100*s4l2p
      t107 = t100*s4l1p
      t137 = t9*l3
      t140 = t10*l3
      t141 = t140*s3l2p
      t144 = t17*s1vr
      t147 = 4*t1*l3
      t151 = t140*s4l2p
      t152 = 512.D0/3.D0*t151
      t157 = l3*s34r
      t161 = 256*t7*t10*t157-2048.D0/3.D0-512.D0/3.D0*z
      t163 = l3*t3
      t164 = t27*s3l2p
      t166 = t163*t164*s34r
      t168 = 10*z
      t170 = (-16+t168)*t9
      t172 = 256.D0/3.D0*t170*s3l2p
      t177 = l3*t2
      t182 = s23r**2
      t189 = -768*t7*t10*t157+3328.D0/3.D0-256*z
      t193 = t3*t27
      t201 = (-11+5*z)*t9
      t209 = 3*z
      t212 = t3*s34r
      t215 = -256.D0/3.D0*l3*t27*t22*t45-256.D0/3.D0*(-6+t209)*t9*t212
      t217 = t22*t49
      t223 = (-8+t168)*t3
      t224 = t10*s3l2p
      t227 = 4*t7*t10
      t237 = t10*s4l2p
      t241 = -7+t168
      t242 = t241*t9
      t246 = t241*t3
      t262 = t140*s3l1p
      t269 = t140*s4l1p
      t270 = 512.D0/3.D0*t269
      t275 = t27*s3l1p
      t277 = t163*t275*s34r
      t280 = 256.D0/3.D0*t170*s3l1p
      t309 = t10*s3l1p
      t320 = t10*s4l1p
      t356 = 2*z
      t358 = (3-t356)*t9
      t372 = t237*s3l1p
      t374 = t320*s3l2p
      t379 = (1-t356)*t9
      t395 = (t209-2)*t10
      s2 = (((-256.D0/3.D0*t5-512.D0/3.D0*t12-256.D0/3.D0*t14)*t17+((256
     #.D0/3.D0*t5+256.D0/3.D0*t12+256.D0/3.D0*t14)*s23r+2560.D0/3.D0*t25
     #+(-5120.D0/3.D0*t29-1280*t31)*s34r)*s1vr+(-1280*t25+1280*t38*s34r)
     #*s23r-2560.D0/3.D0*t44*t46+(2560.D0/3.D0*t50*s3l2p+2560.D0/3.D0*t5
     #0*s4l2p)*t45)*s1l1+((256.D0/3.D0*t58+512.D0/3.D0*t60+256.D0/3.D0*t
     #62)*t17+((-256.D0/3.D0*t58-256.D0/3.D0*t60-256.D0/3.D0*t62)*s23r-2
     #560.D0/3.D0*t70+(5120.D0/3.D0*t72+1280*t74)*s34r)*s1vr+(1280*t70+1
     #280*t81*s34r)*s23r+2560.D0/3.D0*t44*t86+(-2560.D0/3.D0*t50*s3l1p-2
     #560.D0/3.D0*t50*s4l1p)*t45)*s1l2+((-256.D0/3.D0*t97*s3l2p+1024.D0/
     #3.D0*t101)*s2l1+(256.D0/3.D0*t97*s3l1p-1024.D0/3.D0*t107)*s2l2)*t1
     #7+(((-512.D0/3.D0*t100*s3l2p-512.D0/3.D0*t101)*s2l1+(512.D0/3.D0*t
     #100*s3l1p+512.D0/3.D0*t107)*s2l2)*s23r+(-256.D0/3.D0*t29-1024.D0/3
     #.D0*t31)*s34r*s2l1+(256.D0/3.D0*t72+1024.D0/3.D0*t74)*s34r*s2l2)*s
     #1vr)*s13r
      s4 = ((-256.D0/3.D0*t137*s2l2-1792.D0/3.D0*t141)*t144+((256.D0/3.D
     #0*t147*s2l2+1024.D0/3.D0*t141+t152)*s23r+t161*s2l2+768*t166-t172+5
     #12.D0/3.D0*t9*s4l2p)*t17+((-256.D0/3.D0*t177*s2l2-512.D0/3.D0*t141
     #-t152)*t182+(t189*s2l2+(-768*t163*t164-1792.D0/3.D0*t193*l3*s4l2p)
     #*s34r+t172+256.D0/3.D0*t201*s4l2p)*s23r+t215*s2l2-512.D0/3.D0*t217
     #*l3*s3l2p*t45+(256.D0/3.D0*t223*t224+256.D0/3.D0*t227*s4l2p)*s34r)
     #*s1vr+(-256.D0/3.D0*t2*s2l2-1280.D0/3.D0*t224-1280.D0/3.D0*t237)*t
     #182+(256.D0/3.D0*t242*t212*s2l2+(-256.D0/3.D0*t246*t224-256.D0/3.D
     #0*t246*t237)*s34r)*s23r-512.D0/3.D0*t23*t46+512.D0/3.D0*t38*t45)*s
     #1l1
      s5 = ((256.D0/3.D0*t137*s2l1+1792.D0/3.D0*t262)*t144+((-256.D0/3.D
     #0*t147*s2l1-1024.D0/3.D0*t262-t270)*s23r-t161*s2l1-768*t277+t280-5
     #12.D0/3.D0*t9*s4l1p)*t17+((256.D0/3.D0*t177*s2l1+512.D0/3.D0*t262+
     #t270)*t182+(-t189*s2l1+(768*t163*t275+1792.D0/3.D0*t193*l3*s4l1p)*
     #s34r-t280-256.D0/3.D0*t201*s4l1p)*s23r-t215*s2l1+512.D0/3.D0*t217*
     #l3*s3l1p*t45+(-256.D0/3.D0*t223*t309-256.D0/3.D0*t227*s4l1p)*s34r)
     #*s1vr+(256.D0/3.D0*t2*s2l1+1280.D0/3.D0*t309+1280.D0/3.D0*t320)*t1
     #82+(-256.D0/3.D0*t242*t212*s2l1+(256.D0/3.D0*t246*t309+256.D0/3.D0
     #*t246*t320)*s34r)*s23r+512.D0/3.D0*t23*t86+512.D0/3.D0*t81*t45)*s1
     #l2
      s3 = s4+s5
      s1 = s2+s3
      taux8 = s1+(-512.D0/3.D0*t140*s3l2p*s2l1+512.D0/3.D0*t140*s3l1p*s2
     #l2)*t144+(((-512.D0/3.D0*t141-512.D0/3.D0*t151)*s2l1+(512.D0/3.D0*
     #t262+512.D0/3.D0*t269)*s2l2)*s23r+(-256*t166+256.D0/3.D0*t358*s3l2
     #p-256.D0/3.D0*t1*s4l2p)*s2l1+(256*t277-256.D0/3.D0*t358*s3l1p+256.
     #D0/3.D0*t1*s4l1p)*s2l2+1792.D0/3.D0*t372-1792.D0/3.D0*t374)*t17+((
     #(256.D0/3.D0*t379*s3l2p+256.D0/3.D0*t379*s4l2p)*s2l1+(-256.D0/3.D0
     #*t379*s3l1p-256.D0/3.D0*t379*s4l1p)*s2l2-256*t372+256*t374)*s23r+(
     #-256.D0/3.D0*t395*t3*s3l2p+256.D0/3.D0*t101)*s34r*s2l1+(256.D0/3.D
     #0*t395*t3*s3l1p-256.D0/3.D0*t107)*s34r*s2l2+(-512.D0/3.D0*t193*s4l
     #2p*s3l1p+512.D0/3.D0*t193*s4l1p*s3l2p)*s34r)*s1vr

CCC Coefficients

      tcoff13 = taux7
      tcoff14 = taux7
      tcoff15 = taux8
      tcoff16 = taux8

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet13 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff13)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = -l3+1
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet14 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff14)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet15 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff15)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = -l3+1
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet16 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff16)

CCC Sum

      qgrmnum5e2 = tFjet13*tcoff13+tFjet14*tcoff14+tFjet15*tcoff15+tFjet
     #16*tcoff16
      RETURN
      END

      double precision function qgrmnum5e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3-1
      t2 = t1*z
      t3 = -1+z
      t4 = t3**2
      t5 = l3*t4
      t6 = s1vr**2
      t7 = t6*s1vr
      t11 = z*l3
      t12 = t4*t3
      t13 = t1**2
      t14 = t12*t13
      t18 = t3*z
      t23 = t4**2
      t26 = s34r**2
      t29 = z*t4
      t37 = l3**2
      t76 = z**2
      taux7 = (64.D0/3.D0*t2*t5*t7+(-128.D0/3.D0*t11*t14*s34r-64.D0/3.D0
     #*t18*t1)*t6+(64.D0/3.D0*t11*t23*t13*t1*t26+64.D0/3.D0*t29*t13*s34r
     #)*s1vr)*s13r-64.D0/3.D0*t29*t37*s23r*t7+((64.D0/3.D0*t2*t12*t37*s3
     #4r-64.D0/3.D0*(z-2)*z*t3*l3)*s23r+64.D0/3.D0*t2*t5*s34r)*t6+((64.D
     #0/3.D0*t12*z*t1*l3*s34r+64.D0/3.D0*t18)*s23r-64.D0/3.D0*t11*t14*t2
     #6+64.D0/3.D0*(-1+2*z)*z*t3*t1*s34r)*s1vr-128.D0/3.D0*t76*t3*t1*s34
     #r*s23r-128.D0/3.D0*t76*t4*t13*t26
      t1 = -1+z
      t2 = l3-1
      t3 = t1*t2
      t4 = t3*s2l2
      t6 = t1**2
      t7 = t2*t6
      t8 = t7*s3l2p
      t10 = t7*s4l2p
      t11 = 512.D0/3.D0*t10
      t13 = s1vr**2
      t18 = t2**2
      t19 = t6*t18
      t21 = t19*s34r*s2l2
      t23 = t6*t1
      t24 = t23*t18
      t25 = t24*s3l2p
      t27 = t24*s4l2p
      t35 = -512*t25-512*t27
      t39 = t18*t2
      t40 = t23*t39
      t41 = s34r**2
      t42 = t41*s2l2
      t45 = t6**2
      t46 = t45*t39
      t54 = t3*s2l1
      t56 = t7*s3l1p
      t58 = t7*s4l1p
      t59 = 512.D0/3.D0*t58
      t66 = t19*s34r*s2l1
      t68 = t24*s3l1p
      t70 = t24*s4l1p
      t78 = 512*t68+512*t70
      t82 = t41*s2l1
      t93 = 3*t2*t6
      t120 = t1*l3
      t121 = t120*s2l2
      t123 = t6*l3
      t124 = t123*s3l2p
      t127 = t13*s1vr
      t135 = l3*s34r
      t138 = 512*t7*t135+1024.D0/3.D0
      t140 = l3*t2
      t141 = t23*s3l2p
      t143 = t140*t141*s34r
      t145 = 4*z
      t147 = (3-t145)*t1
      t149 = 256.D0/3.D0*t147*s3l2p
      t152 = s23r**2
      t161 = -768*t2*t6*t135-512+512.D0/3.D0*z
      t164 = t2*t23
      t170 = 2*z
      t172 = (1-t170)*t1
      t183 = t2*s34r
      t186 = -512.D0/3.D0*l3*t23*t18*t41-256.D0/3.D0*(-1-t170)*t1*t183
      t188 = t18*t45
      t194 = (-7-t145)*t2
      t195 = t6*s3l2p
      t199 = -6*t2*t6
      t207 = t6*s4l2p
      t212 = -4-4*z
      t213 = t212*t1
      t217 = t212*t2
      t231 = t120*s2l1
      t233 = t123*s3l1p
      t245 = t23*s3l1p
      t247 = t140*t245*s34r
      t250 = 256.D0/3.D0*t147*s3l1p
      t274 = t6*s3l1p
      t283 = t6*s4l1p
      t313 = (-5+3*z)*t1
      t316 = t1*s4l2p
      t323 = t1*s4l1p
      t328 = 512.D0/3.D0*t207*s3l1p
      t330 = 512.D0/3.D0*t283*s3l2p
      t343 = t2*z
      s2 = (((-512.D0/3.D0*t4-1024.D0/3.D0*t8-t11)*t13+((512.D0/3.D0*t4+
     #512.D0/3.D0*t8+512.D0/3.D0*t10)*s23r-1024.D0/3.D0*t21+(2048.D0/3.D
     #0*t25+512*t27)*s34r)*s1vr+(512*t21+t35*s34r)*s23r+1024.D0/3.D0*t40
     #*t42+(-1024.D0/3.D0*t46*s3l2p-1024.D0/3.D0*t46*s4l2p)*t41)*s1l1+((
     #512.D0/3.D0*t54+1024.D0/3.D0*t56+t59)*t13+((-512.D0/3.D0*t54-512.D
     #0/3.D0*t56-512.D0/3.D0*t58)*s23r+1024.D0/3.D0*t66+(-2048.D0/3.D0*t
     #68-512*t70)*s34r)*s1vr+(-512*t66+t78*s34r)*s23r-1024.D0/3.D0*t40*t
     #82+(1024.D0/3.D0*t46*s3l1p+1024.D0/3.D0*t46*s4l1p)*t41)*s1l2+((-25
     #6.D0/3.D0*t93*s3l2p-256*t10)*s2l1+(256.D0/3.D0*t93*s3l1p+256*t58)*
     #s2l2)*t13+((256.D0/3.D0*t25+256*t27)*s34r*s2l1+(-256.D0/3.D0*t68-2
     #56*t70)*s34r*s2l2)*s1vr)*s13r
      s4 = ((-512.D0/3.D0*t121+1280.D0/3.D0*t124)*t127+((1024.D0/3.D0*t1
     #21-256*t124-256*t123*s4l2p)*s23r+t138*s2l2-2048.D0/3.D0*t143-t149)
     #*t13+(-512.D0/3.D0*t120*s2l2*t152+(t161*s2l2+(1280.D0/3.D0*t140*t1
     #41+1280.D0/3.D0*t164*l3*s4l2p)*s34r+t149+256.D0/3.D0*t172*s4l2p)*s
     #23r+t186*s2l2+256*t188*l3*s3l2p*t41+(256.D0/3.D0*t194*t195+256.D0/
     #3.D0*t199*s4l2p)*s34r)*s1vr+(-512.D0/3.D0*t1*s2l2+512.D0/3.D0*t195
     #+512.D0/3.D0*t207)*t152+(256.D0/3.D0*t213*t183*s2l2+(-256.D0/3.D0*
     #t217*t195-256.D0/3.D0*t217*t207)*s34r)*s23r-512*t19*t42-t35*t41)*s
     #1l1
      s5 = ((512.D0/3.D0*t231-1280.D0/3.D0*t233)*t127+((-1024.D0/3.D0*t2
     #31+256*t233+256*t123*s4l1p)*s23r-t138*s2l1+2048.D0/3.D0*t247+t250)
     #*t13+(512.D0/3.D0*t120*s2l1*t152+(-t161*s2l1+(-1280.D0/3.D0*t140*t
     #245-1280.D0/3.D0*t164*l3*s4l1p)*s34r-t250-256.D0/3.D0*t172*s4l1p)*
     #s23r-t186*s2l1-256*t188*l3*s3l1p*t41+(-256.D0/3.D0*t194*t274-256.D
     #0/3.D0*t199*s4l1p)*s34r)*s1vr+(512.D0/3.D0*t1*s2l1-512.D0/3.D0*t27
     #4-512.D0/3.D0*t283)*t152+(-256.D0/3.D0*t213*t183*s2l1+(256.D0/3.D0
     #*t217*t274+256.D0/3.D0*t217*t283)*s34r)*s23r+512*t19*t82-t78*t41)*
     #s1l2
      s3 = s4+s5
      s1 = s2+s3
      taux8 = s1+(256*t123*s3l2p*s2l1-256*t123*s3l1p*s2l2)*t127+((-256.D
     #0/3.D0*t143+256.D0/3.D0*t313*s3l2p-512.D0/3.D0*t316)*s2l1+(256.D0/
     #3.D0*t247-256.D0/3.D0*t313*s3l1p+512.D0/3.D0*t323)*s2l2-t328+t330)
     #*t13+(((512.D0/3.D0*t1*s3l2p+512.D0/3.D0*t316)*s2l1+(-512.D0/3.D0*
     #t1*s3l1p-512.D0/3.D0*t323)*s2l2+t328-t330)*s23r+(-256.D0/3.D0*t343
     #*t195+t11)*s34r*s2l1+(256.D0/3.D0*t343*t274-t59)*s34r*s2l2)*s1vr

CCC Coefficients

      tcoff13 = taux7
      tcoff14 = taux7
      tcoff15 = taux8
      tcoff16 = taux8

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet13 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff13)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = -l3+1
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet14 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff14)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet15 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff15)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = -l3+1
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet16 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff16)

CCC Sum

      qgrmnum5e3 = tFjet13*tcoff13+tFjet14*tcoff14+tFjet15*tcoff15+tFjet
     #16*tcoff16
      RETURN
      END

      double precision function qgrmnum5e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux7 = 0
      t1 = l3-1
      t2 = -1+z
      t3 = t2**2
      t4 = t1*t3
      t5 = t4*s3l2p
      t6 = t4*s4l2p
      t7 = -t5-t6
      t10 = t4*s3l1p
      t11 = t4*s4l1p
      t12 = t10+t11
      t16 = s1vr**2
      t18 = t2*t3
      t19 = t1**2
      t20 = t18*t19
      t23 = t20*s3l2p+t20*s4l2p
      t29 = -t20*s3l1p-t20*s4l1p
      t37 = l3*t3
      t38 = t16*s1vr
      t47 = t1*l3
      t48 = t18*s3l2p
      t50 = t47*t48*s34r
      t53 = 512.D0/3.D0*t2*s3l2p
      t56 = l3*s34r
      t61 = t18*t1
      t71 = t1*t2
      t73 = t71*s34r*s2l2
      t75 = t3**2
      t76 = t19*t75
      t78 = s34r**2
      t93 = t3*t19
      t110 = t18*s3l1p
      t112 = t47*t110*s34r
      t115 = 512.D0/3.D0*t2*s3l1p
      t132 = t71*s34r*s2l1
      t175 = z*t1*t3
      s2 = ((512.D0/3.D0*t7*s2l1+512.D0/3.D0*t12*s2l2)*t16+(512.D0/3.D0*
     #t23*s34r*s2l1+512.D0/3.D0*t29*s34r*s2l2)*s1vr)*s13r
      s3 = (512.D0/3.D0*t37*s3l2p*t38+((-512.D0/3.D0*t37*s3l2p-512.D0/3.
     #D0*t37*s4l2p)*s23r-1024.D0/3.D0*t50-t53)*t16+((-512.D0/3.D0*t4*t56
     #*s2l2+(512.D0/3.D0*t47*t48+512.D0/3.D0*t61*l3*s4l2p)*s34r+t53+512.
     #D0/3.D0*t2*s4l2p)*s23r-512.D0/3.D0*t73+512.D0/3.D0*t76*l3*s3l2p*t7
     #8+(512*t5+1024.D0/3.D0*t6)*s34r)*s1vr+(1024.D0/3.D0*t73+1024.D0/3.
     #D0*t7*s34r)*s23r+1024.D0/3.D0*t93*t78*s2l2-1024.D0/3.D0*t23*t78)*s
     #1l1+(-512.D0/3.D0*t37*s3l1p*t38+((512.D0/3.D0*t37*s3l1p+512.D0/3.D
     #0*t37*s4l1p)*s23r+1024.D0/3.D0*t112+t115)*t16+((512.D0/3.D0*t4*t56
     #*s2l1+(-512.D0/3.D0*t47*t110-512.D0/3.D0*t61*l3*s4l1p)*s34r-t115-5
     #12.D0/3.D0*t2*s4l1p)*s23r+512.D0/3.D0*t132-512.D0/3.D0*t76*l3*s3l1
     #p*t78+(-512*t10-1024.D0/3.D0*t11)*s34r)*s1vr+(-1024.D0/3.D0*t132+1
     #024.D0/3.D0*t12*s34r)*s23r-1024.D0/3.D0*t93*t78*s2l1-1024.D0/3.D0*
     #t29*t78)*s1l2
      s1 = s2+s3
      taux8 = s1+(512.D0/3.D0*t37*s3l2p*s2l1-512.D0/3.D0*t37*s3l1p*s2l2)
     #*t38+((-512.D0/3.D0*t50+512.D0/3.D0*t3*s3l2p)*s2l1+(512.D0/3.D0*t1
     #12-512.D0/3.D0*t3*s3l1p)*s2l2)*t16+(-512.D0/3.D0*t175*s3l2p*s34r*s
     #2l1+512.D0/3.D0*t175*s3l1p*s34r*s2l2)*s1vr

CCC Coefficients

      tcoff13 = taux7
      tcoff14 = taux7
      tcoff15 = taux8
      tcoff16 = taux8

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet13 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff13)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = -l3+1
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet14 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff14)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet15 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff15)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = -l3+1
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet16 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff16)

CCC Sum

      qgrmnum5e4 = tFjet13*tcoff13+tFjet14*tcoff14+tFjet15*tcoff15+tFjet
     #16*tcoff16
      RETURN
      END

      double precision function qgrmnum6e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = s3vf(z,l1,l2,l3,l4)
      t2 = 1/t1
      t3 = t2*s3l2
      t4 = t3*s2l1
      t5 = s3l1*t2
      t6 = t5*s2l2
      t7 = s4l2*t2
      t8 = t7*s3l1
      t9 = s4l1*t2
      t10 = t9*s3l2
      t13 = s23f(z,l1,l2,l3,l4)
      t15 = t2*s2l2
      t18 = 96*t15
      t19 = 192*t3
      t22 = t2*s2l1
      t25 = 96*t22
      t26 = 192*t5
      t29 = 192*t4
      t30 = 192*t6
      t31 = 384*t8
      t32 = 384*t10
      t33 = t2*z
      t37 = 288*t3
      t38 = 192*t7
      t41 = 288*t5
      t42 = 192*t9
      t49 = s14f(z,l1,l2,l3,l4)
      t50 = t49**2
      t52 = s24f(z,l1,l2,l3,l4)
      t59 = 96*t3
      t60 = 96*t7
      t67 = 192*z
      t69 = (288-t67)*t2
      t70 = t69*s3l2
      t75 = 96*t5
      t76 = 96*t9
      t83 = t69*s3l1
      t88 = 384*t3
      t89 = t88+t38
      t96 = s4l2*s4l1
      t105 = (t75+t42)*s2l2
      t111 = 1-z
      t112 = 192*t111
      t114 = t112*s4l2*t2
      t117 = t112*s4l1
      t122 = -3+2*z
      t133 = t1**2
      t134 = 1/t133
      t135 = t134*s3l2
      t136 = t135*t52
      t138 = 192*t135
      t142 = t134*s3l1
      t143 = t142*t52
      t145 = 192*t142
      t149 = t135*s2l1
      t151 = t142*s2l2
      t154 = s4l2*t134*s3l1
      t157 = s4l1*t134*s3l2
      t163 = 480*t154
      t164 = 480*t157
      t169 = t52**2
      t170 = t2*t169
      t180 = -t15-t3
      t182 = 96*t180*t169
      t185 = (-192+96*z)*t2
      t192 = -t111*t2
      t193 = t192*s2l2
      t196 = 96*t111*t2
      t200 = t112*t2
      t215 = 192-1088.D0/3.D0*z
      t224 = t89*s3l1
      t225 = 192*t10
      t226 = t29+t30+t224+t225
      t232 = 512.D0/3.D0*t22
      t239 = t232+t26
      t240 = t239*t169
      t241 = t192*s2l1
      t257 = 192*t149
      t258 = 192*t151
      t259 = 384*t154
      t260 = 384*t157
      t263 = 576*t149
      t264 = 576*t151
      t271 = t15+t7
      t275 = 512.D0/3.D0*t15
      t276 = t275+t19
      t277 = t276*t52
      t284 = t239*t52
      t287 = 1088.D0/3.D0*t8
      t288 = 1088.D0/3.D0*t10
      t299 = t135*t169
      t300 = -t299-t136
      t304 = t142*t169
      t305 = -t304-t143
      t323 = -t149-t151-t154-t157
      t341 = t276*t169
      s3 = (192*t4+192*t6+192*t8+192*t10)*t13+((96*t15*t13+t18+t19)*s1l1
     #+(96*t22*t13+t25+t26)*s1l2+(t29+t30+t31+t32-192*t33)*t13+(t37+t38)
     #*s2l1+(t41+t42)*s2l2+(384*t3+384*t7)*s3l1+t32)*t50
      s2 = s3+((-192*t52*t13*t2*s1l2+((-t18-t19-t38)*t52+t59+t60)*t13+96
     #*t3*t52-96*t33*s2l2+t70)*s1l1+(((-t25-t26-t42)*t52+t75+t76)*t13+96
     #*t5*t52-96*t33*s2l1+t83)*s1l2+(192*t33*t52+t89*s2l1+(384*t5+t42)*s
     #2l2+576*t8+576*t10+(384*t96+t67)*t2)*t13+((t59+t38)*s2l1+t105+(t19
     #+384*t7)*s3l1+t32)*t52+(t70+t114)*s2l1+(t83+t117*t2)*s2l2+(t88-192
     #*t122*s4l2*t2)*s3l1-192*t122*s4l1*t3)*t49+((-288*t136-t138)*t13*s1
     #l1+(-288*t143-t145)*t13*s1l2+((-480*t149-480*t151-768*t154-768*t15
     #7)*t52-288*t149-288*t151-t163-t164)*t13)*t50
      s1 = s2+((192*t170+192*t52*t2)*t13*s1l2+((-t18-t37-t60)*t52-t18-t5
     #9-t60)*t13+t182+(t185*s2l2+96*t33*s3l2)*t52+96*t193+t196*s3l2)*s1l
     #1+((t200*s3l2-512.D0/3.D0*z*s4l2*t2)*s2l1+(t200*s3l1-512.D0/3.D0*z
     #*s4l1*t2)*s2l2+(128.D0/3.D0*t3+t215*s4l2*t2)*s3l1+t215*s4l1*t3)*t5
     #2+t226*t169+(t88+t114)*s3l1
      s2 = s1+((-192*t5*t169+(t232+512.D0/3.D0*t5+1024.D0/3.D0*t9)*t52)*
     #t13+t240+(-512.D0/3.D0*t241-192*t192*s3l1)*t52)*s1l2+((-192*t136+1
     #92*t135)*t13*s1l1+(-192*t143+192*t142)*t13*s1l2+((-t257-t258-t259-
     #t260)*t52+t263+t264-192*t154-192*t157)*t13)*t50+((512.D0/3.D0*t271
     #*t52*t13+t277)*s1l1+((512.D0/3.D0*t22+512.D0/3.D0*t9)*t52*t13+t284
     #)*s1l2+(t29+t30+t287+t288-1024.D0/3.D0*t33)*t52*t13+(1088.D0/3.D0*
     #t4+1088.D0/3.D0*t6+t224+t225)*t52)*t49
      t356 = s2+(512.D0/3.D0*t300*t13*s1l1+512.D0/3.D0*t305*t13*s1l2+((-
     #640.D0/3.D0*t149-640.D0/3.D0*t151-t259-t260)*t169+(-128.D0/3.D0*t1
     #49-128.D0/3.D0*t151-640.D0/3.D0*t154-640.D0/3.D0*t157)*t52)*t13)*t
     #49+(384*t323*t52-384*t149-384*t151-t259-t260)*t13+(-1024.D0/3.D0*t
     #170*t13*s1l2+(-192*t3*t169+(t275+512.D0/3.D0*t3+1024.D0/3.D0*t7)*t
     #52)*t13+t341+(-512.D0/3.D0*t193-192*t192*s3l2)*t52)*s1l1+(640.D0/3
     #.D0*t323*t169+128.D0/3.D0*t323*t52)*t13+t226*t52
      t383 = (-96*t22-96*t5)*t169
      t394 = 512.D0/3.D0*t7
      t398 = -t26-512.D0/3.D0*t9
      t409 = t8+t10
      t419 = s13f(z,l1,l2,l3,l4)
      t437 = t169*t52
      t467 = t149+t151
      t470 = t50*t49
      s1 = ((480*t299+480*t136+t138)*t13*s1l1+(480*t304+480*t143+t145)*t
     #13*s1l2+((-768*t149-768*t151-672*t154-672*t157)*t52-t263-t264-t163
     #-t164)*t13)*t49+(((-t25-t41-t76)*t52-t25-t75-t76)*t13+t383+(t185*s
     #2l1+96*t33*s3l1)*t52+96*t241+t196*s3l1)*s1l2+(((-1024.D0/3.D0*t15-
     #t19-t394)*s2l1+t398*s2l2-1024.D0/3.D0*t8-1024.D0/3.D0*t10)*t52*t49
     #+(t341+t277)*s1l1+(t240+t284)*s1l2+64.D0/3.D0*t409*t169+(512.D0/3.
     #D0*t4+512.D0/3.D0*t6+64.D0/3.D0*t8+64.D0/3.D0*t10)*t52)*t419+((192
     #*t299+192*t136-192*t135)*t13*s1l1+(192*t304+192*t143-192*t142)*t13
     #*s1l2+((t257+t258-t259-t260)*t52-576*t154-576*t157)*t13)*t49+(640.
     #D0/3.D0*t135*t437+128.D0/3.D0*t299)*t13*s1l1+(640.D0/3.D0*t142*t43
     #7+128.D0/3.D0*t304)*t13*s1l2-384*t300*t13*s1l1
      t520 = s1-384*t305*t13*s1l2+((t19+t394)*s2l1-t398*s2l2+t287+t288+1
     #024.D0/3.D0*t96*t2)*t52*t13+480*t467*t13*t470+t117*t3+t200*s3l2*s2
     #l1+t200*s3l1*s2l2+512.D0/3.D0*t467*t52*t13*t50+((192*t180*s2l1-t30
     #)*t50+(((t18+t19)*t52+t18+t19)*s1l1+((t25+t26)*t52+t25+t26)*s1l2+(
     #(192*t15+t59+t38)*s2l1+t105+t31+t32)*t52+192*t271*s2l1+192*t9*s2l2
     #+t31+t32)*t49+(t182-192*t15*t52-t18+t59)*s1l1+(t383-192*t22*t52-t2
     #5+t75)*s1l2+192*t409*t52+192*t8+t225)*t419
      taux9 = t356+t520
      t1 = s3vf(z,l1,l2,l3,l4)
      t2 = t1**2
      t3 = 1/t2
      t4 = t3*s3l1
      t5 = s24f(z,l1,l2,l3,l4)
      t6 = t5**2
      t7 = t6*t5
      t10 = t4*t6
      t13 = s23f(z,l1,l2,l3,l4)
      t16 = 1/t1
      t17 = t16*s3l2
      t20 = t16*s2l2
      t21 = t20+t17
      t27 = 768*t17
      t28 = 2048.D0/3.D0*t20+t27
      t29 = t28*t6
      t30 = 1-z
      t32 = 8*t30*t16
      t35 = t30*t16
      t42 = t3*s3l2
      t43 = t42*t6
      t44 = t42*t5
      t49 = t5*t4
      t54 = t42*s2l1
      t55 = 768*t54
      t56 = t4*s2l2
      t57 = 768*t56
      t59 = s4l2*t3*s3l1
      t60 = 1536*t59
      t62 = s4l1*t3*s3l2
      t63 = 1536*t62
      t71 = s14f(z,l1,l2,l3,l4)
      t73 = t17*s2l1
      t74 = s3l1*t16
      t75 = t74*s2l2
      t76 = s4l2*t16
      t77 = t76*s3l1
      t78 = s4l1*t16
      t79 = t78*s3l2
      t81 = 768*t73-768*t75-768*t77+768*t79
      t87 = t28*t5
      t90 = t16*s2l1
      t96 = 768*t74
      t97 = -2048.D0/3.D0*t90-t96
      t98 = t97*t5
      t101 = 768*t73
      t102 = 768*t75
      t103 = 4352.D0/3.D0*t77
      t104 = 4352.D0/3.D0*t79
      t110 = 768*t77
      t111 = 768*t79
      t117 = 384*t20
      t118 = 1152*t17
      t119 = 384*t76
      t122 = 384*t17
      t127 = -384*t21*t6
      t129 = (z-2)*t16
      t131 = z*t16
      t137 = -t30*t16
      t154 = 2304*t54
      t155 = 2304*t56
      t161 = t71**2
      t164 = -t54+t56+t59-t62
      t172 = 768*t42
      t177 = 768*t4
      t189 = 1920*t59
      t190 = 1920*t62
      t201 = -t43-t44
      t205 = t10+t49
      t223 = 768*t76
      t233 = 2*z
      t234 = -3+t233
      t235 = t234*t16
      t240 = 384*t90
      t241 = 768*t78
      t245 = 384*t74
      t246 = 384*t78
      t269 = 1152*t74
      t272 = 1536*t77
      t273 = 1536*t79
      t277 = (5-t233)*t16
      t292 = -t234
      t312 = (t122-t223)*s2l1
      t314 = (-t245+t241)*s2l2
      s1 = (-2560.D0/3.D0*t4*t7-512.D0/3.D0*t10)*t13*s1l2+((-768*t17*t6+
     #2048.D0/3.D0*t21*t5)*t13+t29+(256.D0/3.D0*t32*s2l2+768*t35*s3l2)*t
     #5)*s1l1+((768*t43+768*t44-768*t42)*t13*s1l1+(-768*t10-768*t49+768*
     #t4)*t13*s1l2+((t55-t57+t60-t63)*t5+2304*t59-2304*t62)*t13)*t71+t81
     #*t6+(((-2048.D0/3.D0*t20-2048.D0/3.D0*t76)*t5*t13+t87)*s1l1+((2048
     #.D0/3.D0*t90+2048.D0/3.D0*t78)*t5*t13+t98)*s1l2+(t101-t102-t103+t1
     #04)*t5*t13+(256.D0/3.D0*t73-256.D0/3.D0*t75-t110+t111)*t5)*t71+t81
     #*t13+(((-t117-t118-t119)*t5-t117-t122-t119)*t13+t127+(384*t129*s2l
     #2+384*t131*s3l2)*t5+384*t137*s2l2-384*t137*s3l2)*s1l1+((-768*t44+7
     #68*t42)*t13*s1l1+(768*t49-768*t4)*t13*s1l2+((-t55+t57+t60-t63)*t5+
     #t154-t155+768*t59-768*t62)*t13)*t161
      s2 = s1+t81*t5+(2560.D0/3.D0*t164*t6+512.D0/3.D0*t164*t5)*t13+((-1
     #152*t44-t172)*t13*s1l1+(1152*t49+t177)*t13*s1l2+((-1920*t54+1920*t
     #56+3072*t59-3072*t62)*t5-1152*t54+1152*t56+t189-t190)*t13)*t161
      s3 = s2+(1536*t164*t5-1536*t54+1536*t56+t60-t63)*t13+(2048.D0/3.D0
     #*t201*t13*s1l1+2048.D0/3.D0*t205*t13*s1l2+((-2560.D0/3.D0*t54+2560
     #.D0/3.D0*t56+t60-t63)*t6+(-512.D0/3.D0*t54+512.D0/3.D0*t56+2560.D0
     #/3.D0*t59-2560.D0/3.D0*t62)*t5)*t13)*t71
      t320 = s3+((((t117-t27+t223)*t5+768*t20+t122+t119)*t13+384*t17*t5-
     #384*t131*s2l2-384*t235*s3l2)*s1l1+(((-t240+t96-t241)*t5-768*t90-t2
     #45-t246)*t13-384*t5*t74+384*t131*s2l1+384*t235*s3l1)*s1l2+((1536*t
     #17-t223)*s2l1+(-1536*t74+t241)*s2l2-2304*t77+2304*t79)*t13+((t118-
     #t223)*s2l1+(-t269+t241)*s2l2-t272+t273)*t5+(384*t277*s3l2-768*t30*
     #s4l2*t16)*s2l1+(-384*t277*s3l1+768*t30*s4l1*t16)*s2l2-768*t292*s4l
     #2*t74+768*t292*s4l1*t17)*t71+((-384*t20*t13+t117+t27)*s1l1+(384*t9
     #0*t13-t240-t96)*s1l2+(t101-t102-t272+t273)*t13+t312+t314-t272+t273
     #)*t161+768*t35*s3l2*s2l1
      t325 = t27-2048.D0/3.D0*t76
      t328 = -t96+2048.D0/3.D0*t78
      t341 = t54-t56
      t344 = t161*t71
      t355 = 2*t30
      t377 = t97*t6
      t380 = -t77+t79
      t390 = s13f(z,l1,l2,l3,l4)
      t393 = 9*t30*t16
      t409 = 9-17*z
      t420 = -t90-t74
      t459 = -384*t420*t6
      s1 = -768*t35*s3l1*s2l2+(t325*s2l1+t328*s2l2-t103+t104)*t5*t13-153
     #6*t201*t13*s1l1-1536*t205*t13*s1l2+1920*t341*t13*t344+(2560.D0/3.D
     #0*t42*t7+512.D0/3.D0*t43)*t13*s1l1-384*t355*s4l2*t74
      s2 = s1+384*t355*s4l1*t17+2048.D0/3.D0*t341*t5*t13*t161+((-t325*s2
     #l1-t328*s2l2+4096.D0/3.D0*t77-4096.D0/3.D0*t79)*t5*t71+(t29+t87)*s
     #1l1+(t377+t98)*s1l2+256.D0/3.D0*t380*t6+(2048.D0/3.D0*t73-2048.D0/
     #3.D0*t75-256.D0/3.D0*t77+256.D0/3.D0*t79)*t5)*t390
      s3 = s2+((256.D0/3.D0*t393*s3l2+2048.D0/3.D0*z*s4l2*t16)*s2l1+(-25
     #6.D0/3.D0*t393*s3l1-2048.D0/3.D0*z*s4l1*t16)*s2l2-256.D0/3.D0*t409
     #*s4l2*t74+256.D0/3.D0*t409*s4l1*t17)*t5+((768*t74*t6+2048.D0/3.D0*
     #t420*t5)*t13+t377+(-256.D0/3.D0*t32*s2l1-768*t35*s3l1)*t5)*s1l2
      t502 = s3+((1920*t43+1920*t44+t172)*t13*s1l1+(-1920*t10-1920*t49-t
     #177)*t13*s1l2+((-3072*t54+3072*t56+2688*t59-2688*t62)*t5-t154+t155
     #+t189-t190)*t13)*t71+(((t240+t269+t246)*t5+t240+t245+t246)*t13+t45
     #9+(-384*t129*s2l1-384*t131*s3l1)*t5-384*t137*s2l1+384*t137*s3l1)*s
     #1l2+((-768*t73+768*t75)*t161+(((t117+t27)*t5+t117+t27)*s1l1+((-t24
     #0-t96)*t5-t240-t96)*s1l2+(t312+t314-t272+t273)*t5-768*t76*s2l1+768
     #*t78*s2l2-t272+t273)*t71+(t127-768*t20*t5-t117+t122)*s1l1+(t459+76
     #8*t90*t5+t240-t245)*s1l2+768*t380*t5-t110+t111)*t390
      taux10 = t320+t502

CCC Coefficients

      tcoff17 = taux9
      tcoff18 = taux9
      tcoff19 = taux10
      tcoff20 = taux10

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet17 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff17)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      t5 = s14f(z,l1,l2,l3,l4)
      tFjet18 = Fjet(var,ndim,z,1/ux,t2,t3,t4,t5,-1+z-t3-t5-t2-t4,-1+z-t
     #2-t4,-1+z-t3-t5,1+t5+t4,1+t3+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff18)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet19 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff19)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      t5 = s14f(z,l1,l2,l3,l4)
      tFjet20 = Fjet(var,ndim,z,1/ux,t2,t3,t4,t5,-1+z-t3-t5-t2-t4,-1+z-t
     #2-t4,-1+z-t3-t5,1+t5+t4,1+t3+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff20)

CCC Sum

      qgrmnum6e0 = tFjet17*tcoff17+tFjet18*tcoff18+tFjet19*tcoff19+tFjet
     #20*tcoff20
      RETURN
      END

      double precision function qgrmnum6e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = s3vf(z,l1,l2,l3,l4)
      t2 = t1**2
      t3 = 1/t2
      t4 = t3*s3l2
      t5 = s24f(z,l1,l2,l3,l4)
      t6 = t5**2
      t7 = t4*t6
      t9 = t5*t4
      t12 = s23f(z,l1,l2,l3,l4)
      t15 = t3*s3l1
      t16 = t15*t6
      t18 = t15*t5
      t23 = t3*z
      t24 = t23*t6
      t25 = t23*t5
      t28 = t12**2
      t30 = t6*t5
      t31 = t23*t30
      t33 = t4*s2l1
      t34 = 192*t33
      t35 = t15*s2l2
      t36 = 192*t35
      t38 = s4l2*t3*s3l1
      t39 = 384*t38
      t41 = s4l1*t3*s3l2
      t42 = 384*t41
      t43 = 9*z
      t55 = -10*z+12
      t64 = s14f(z,l1,l2,l3,l4)
      t66 = 384*t24
      t67 = 384*t33
      t68 = 384*t35
      t69 = 288*t38
      t70 = 288*t41
      t77 = -1+z
      t78 = t77*z
      t79 = t78*t3
      t83 = t28*t5
      t92 = t64**2
      t94 = 1/t1
      t95 = t94*s2l2
      t96 = 384*t95
      t97 = t94*s3l2
      t98 = 192*t97
      t99 = s4l2*t94
      t100 = 192*t99
      t103 = s3l1*t94
      t104 = s4l1*t94
      t106 = 192*t103-192*t104
      t108 = t99*s3l1
      t110 = t104*s3l2
      t112 = 8*z
      t130 = 768*t25
      t131 = 384*t23
      t135 = s13f(z,l1,l2,l3,l4)
      t137 = t23*t28
      t143 = t92*t64
      t157 = t25+t23
      t163 = 576*t38
      t164 = 576*t41
      t174 = 5*z
      t183 = z*t94
      t185 = 512.D0/3.D0*t183*t83
      t186 = 2*z
      t187 = -t186+6
      t200 = 192*t23
      t204 = 576*t33
      t205 = 576*t35
      t208 = 4*z
      t229 = 384*t94*t6*t12*s1l2
      t230 = 96*t95
      t236 = -t95-t97
      t241 = (-384+96*z)*t94
      t243 = 192*z
      t244 = -96-t243
      t245 = t244*t94
      t249 = t77*t94
      t250 = t249*s2l2
      t254 = 64.D0/3.D0*t95
      t255 = 512.D0/3.D0*t97
      t256 = 64.D0/3.D0*t99
      t268 = (-64+64.D0/3.D0*z)*t94
      t280 = t183*t12
      t284 = 640.D0/3.D0*t31
      t285 = 192*t38
      t286 = 192*t41
      t303 = 128.D0/3.D0*t25
      t313 = 512.D0/3.D0*t99
      t319 = 128.D0/3.D0*t95
      t321 = (-t319-t98)*t5
      t324 = t94*s2l1
      t326 = 512.D0/3.D0*t104
      t333 = 192*t103
      t335 = (-128.D0/3.D0*t324-t333)*t5
      t338 = t183*t6
      t342 = 512.D0/3.D0*t103
      t343 = 64.D0/3.D0*t104
      t346 = 1088.D0/3.D0*t108
      t347 = 1088.D0/3.D0*t110
      t348 = 17*z
      t357 = 64.D0/3.D0*t97
      t360 = t103*s2l2
      t370 = 448.D0/3.D0*t99
      t374 = 448.D0/3.D0*t104
      t377 = 384*t97
      t380 = 192*t110
      t390 = 96*t324
      t396 = -t324-t103
      t403 = t249*s2l1
      t408 = t183*t5*t12
      t410 = t95*s2l1
      t448 = 640.D0/3.D0*t338
      t449 = t183*t5
      t453 = t183*t30
      t455 = t99*s2l1
      t457 = t104*s2l2
      t459 = 64.D0/3.D0*t108
      t460 = 64.D0/3.D0*t110
      s1 = (-t229+((-t230+t98+384*t99)*t5-t230)*t12+96*t236*t6+(t241*s2l
     #2+t245*s3l2)*t5+288*t250)*s1l1+(t229+((-t254+t255+t256)*t6+(-t254-
     #t98-1088.D0/3.D0*t99)*t5)*t12+64.D0/3.D0*t236*t30+(t268*s2l2-128.D
     #0/3.D0*t97)*t6+(128.D0/3.D0*t250+192*t249*s3l2)*t5)*s1l1+(384*t280
     #+384*t183)*t143+(-t284+(t67+t68+t285+t286-64.D0/3.D0*z*t55*t3)*t6+
     #(128.D0/3.D0*t33+128.D0/3.D0*t35-448.D0/3.D0*t38-448.D0/3.D0*t41+1
     #28.D0/3.D0*t79)*t5)*t12+((-640.D0/3.D0*t24-t303)*t12*t64+(-t284-25
     #6*t24-t303)*t12)*t135
      s2 = s1+(((-192*t95-t313)*t5*t12-64.D0/3.D0*t95*t6+t321)*s1l1+((-1
     #92*t324-t326)*t5*t12-64.D0/3.D0*t324*t6+t335)*s1l2+t185+(1024.D0/3
     #.D0*t338+((t319-t255+t256)*s2l1+(-t342+t343)*s2l2-t346-t347+64.D0/
     #3.D0*z*(45-t348)*t94)*t5)*t12+((t319+t357)*s2l1+64.D0/3.D0*t360+12
     #16.D0/3.D0*t183)*t6+((-128.D0/3.D0*(-10+z)*t94*s2l2-1088.D0/3.D0*t
     #97+t370)*s2l1+(-1088.D0/3.D0*t103+t374)*s2l2+(-t377-t100)*s3l1-t38
     #0+64.D0/3.D0*z*(3-26*z)*t94)*t5)*t64+(((-t390+t333+384*t104)*t5-t3
     #90)*t12+96*t396*t6+(t241*s2l1+t245*s3l1)*t5+288*t403)*s1l2
      t504 = s2+(192*t408+(128.D0/3.D0*t410+192*t183)*t5)*t92+(-1024.D0/
     #3.D0*t183*t5*t92+(640.D0/3.D0*t408-448.D0/3.D0*t338+((1280.D0/3.D0
     #*t95+t98+t313)*s2l1+(t333+t326)*s2l2+1024.D0/3.D0*t108+1024.D0/3.D
     #0*t110+64.D0/3.D0*z*(-15+16*z)*t94)*t5)*t64+((-640.D0/3.D0*t95-t98
     #)*t6+t321)*s1l1+((-640.D0/3.D0*t324-t333)*t6+t335)*s1l2+(t448+128.
     #D0/3.D0*t449)*t12+128.D0/3.D0*t453+(-128.D0/3.D0*t455-128.D0/3.D0*
     #t457-t459-t460+64.D0/3.D0*z*(-z-12)*t94)*t6+((1024.D0/3.D0*t95-t25
     #5+128*t99)*s2l1+(-t342+128*t104)*s2l2-t459-t460+64.D0/3.D0*z*(-t43
     #-14)*t94)*t5)*t135+((t96+t357+t370)*s2l1+(64.D0/3.D0*t103+t374)*s2
     #l2+(-1024.D0/3.D0*t97-t313)*s3l1-512.D0/3.D0*t110-64.D0/3.D0*z*(19
     #*z-4)*t94)*t6+(-384*t250+t98+192*s4l2*t77*t94)*s2l1
      t533 = 64.D0/3.D0*t324
      t562 = 192*t25
      t566 = -5+t186
      t569 = 192*z*t566*t3
      t584 = 384*s4l2*s4l1
      t602 = (-448.D0/3.D0+512.D0/3.D0*z)*t94
      t604 = 448.D0/3.D0+t243
      t615 = -1024.D0/3.D0+1088.D0/3.D0*z
      s1 = (-192*t4*t30+448.D0/3.D0*t7)*t12*s1l1+(-192*t15*t30+448.D0/3.
     #D0*t16)*t12*s1l2+(-288*t7-288*t9)*t12*s1l1+(-288*t16-288*t18)*t12*
     #s1l2+576*t338
      t626 = s1+640.D0/3.D0*t453+(192*t103+192*s4l1*t77*t94)*s2l2+(((-t5
     #33+t342+t343)*t6+(-t533-t333-1088.D0/3.D0*t104)*t5)*t12+64.D0/3.D0
     #*t396*t30+(t268*s2l1-128.D0/3.D0*t103)*t6+(128.D0/3.D0*t403+192*t2
     #49*s3l1)*t5)*s1l2+((192*t9-192*t4)*t12*s1l1+(192*t18-192*t15)*t12*
     #s1l2+(-t562-768*t23)*t28+(-t66+(t34+t36+t39+t42+t569)*t5-t204-t205
     #+t285+t286+192*z*(-4+z)*t3)*t12)*t92+(t448+((t96-t255)*s2l1-512.D0
     #/3.D0*t360-t346-t347+(-t584+64.D0/3.D0*z*(2-25*z))*t94)*t5)*t12+((
     #-384*t77*t94*s2l2+t602*s3l2+t604*s4l2*t94)*s2l1+(t602*s3l1+t604*s4
     #l1*t94)*s2l2+t615*s4l2*t103+t615*s4l1*t97-64.D0/3.D0*t78*(-t348-6)
     #*t94)*t5
      t643 = 576*t449
      t645 = 192*t108
      t658 = t135**2
      t661 = 192*t183*t28
      t665 = 384*t108
      t666 = 384*t110
      t673 = 768*t95
      t678 = (-192*t103-192*t104)*s2l2
      t694 = 192*t338
      t706 = 3*z
      t717 = (-t230+t98)*t5
      t718 = 288*t95
      t725 = (-t390+t333)*t5
      t726 = 288*t324
      t729 = t449+t183
      t733 = 480*t455
      t734 = 480*t457
      t745 = (576*t280+384*t449+576*t183)*t92+((480*t449+864*t183)*t12+t
     #694+((-t96-t98-t100)*s2l1+t678-t665-t666-192*z*t566*t94)*t5+(576*t
     #95-t98-t100)*s2l1+t678-t665-t666+192*z*(-t706+4)*t94)*t64+(-192*t2
     #36*t6+t717-t718)*s1l1+(-192*t396*t6+t725-t726)*s1l2+480*t729*t12+6
     #72*t338+(-t733-t734-t645-t380+96*z*(-t706+14)*t94)*t5-t733-t734-t6
     #45-t380+96*z*(-t706+7)*t94
      t805 = -3+t186
      t810 = (-96+t243)*t94
      t812 = -384+t243
      t828 = z**2
      t835 = (((192*t95+192*t97+192*t99)*t5+t230)*t12+t717-t718)*s1l1+((
     #(192*t324+192*t103+192*t104)*t5+t390)*t12+t725-t726)*s1l2+t661+((t
     #673-t98+t100)*s2l1-t106*s2l2-576*t108-576*t110+(-t584+96*z*(11-t11
     #2))*t94)*t12+t694+((t673+t377-t100)*s2l1+(384*t103-192*t104)*s2l2-
     #t665-t666+96*z*(-6*z+13)*t94)*t5+(-384*t805*t94*s2l2+t810*s3l2+t81
     #2*s4l2*t94)*s2l1+(t810*s3l1+t812*s4l1*t94)*s2l2+192*t805*s4l2*t103
     #+192*t805*s4l1*t97-96*z*(-4*t828+11*z-11)*t94
      t844 = -t244
      t849 = ((-t562-t131)*t12*t92+(-192*t24-576*t25-t131)*t12*t64)*t135
     #+(-192*t137+(-384*t25-t34-t36-t200)*t12)*t143+(t643+384*t410-t645-
     #t380+(-t584+96*z*t187)*t94)*t12+(-1024.D0/3.D0*t183*t5*t64-512.D0/
     #3.D0*t338-512.D0/3.D0*t449)*t658+(t661+(t643-192*t97*s2l1-192*t360
     #-t665-t666+96*z*(13-t208)*t94)*t12+t643+(t673-t98-t100)*s2l1+t678-
     #t665-t666+96*z*(-t112+9)*t94)*t92+t745*t135+((-192*t7-192*t9+192*t
     #4)*t12*s1l1+(-192*t16-192*t18+192*t15)*t12*s1l2-576*t157*t28+(-t66
     #+(-t34-t36+t39+t42+t569)*t5+t163+t164+576*t79)*t12)*t64+t835*t64+(
     #192*t729*t64+96*t338+192*t449+96*t183)*t658+t844*s4l1*t97+t844*s4l
     #2*t103
      s1 = ((192*t7+384*t9)*t12*s1l1+(192*t16+384*t18)*t12*s1l2+(-512.D0
     #/3.D0*t24-512.D0/3.D0*t25)*t28+(-384*t31+(t34+t36+t39+t42+128.D0/3
     #.D0*z*(-19+t43)*t3)*t6+(704.D0/3.D0*t33+704.D0/3.D0*t35+704.D0/3.D
     #0*t38+704.D0/3.D0*t41-64.D0/3.D0*z*t55*t3)*t5)*t12)*t64+(-t66+(t67
     #+t68+t69+t70+384*z*(z-2)*t3)*t5+t67+t68+t69+t70+384*t79)*t12+(-512
     #.D0/3.D0*t23*t83+(-t66+(-t34-t36-640.D0/3.D0*t23)*t5)*t12)*t92+((t
     #96+t98-t100)*s2l1+t106*s2l2+96*t108+96*t110+96*z*(-t112+12)*t94)*t
     #5+((-480*t25-288*t23)*t12*t92+(-480*t24-1152*t25-672*t23)*t12*t64+
     #(-t66-t130-t131)*t12)*t135+(-288*t137+(-t130-t34-t36-480*t23)*t12)
     #*t143
      taux9 = s1+((-576*t7-480*t9-192*t4)*t12*s1l1+(-576*t16-480*t18-192
     #*t15)*t12*s1l2+96*t157*t28+(-672*t24+(864*t33+864*t35+t163+t164-96
     #*z*(-7*z+16)*t3)*t5+672*t33+672*t35+t69+t70-96*z*(-t174+9)*t3)*t12
     #)*t64+t185-96*t78*t187*t94+((192*t9+192*t4)*t12*s1l1+(192*t18+192*
     #t15)*t12*s1l2+(-288*t25-t200)*t28+(-768*t24+(t204+t205+768*t38+768
     #*t41-192*z*(-t208+10)*t3)*t5+480*t33+480*t35+t39+t42-96*z*(-t174+1
     #0)*t3)*t12)*t92+t504+t626+t849
      t1 = s3vf(z,l1,l2,l3,l4)
      t2 = t1**2
      t3 = 1/t2
      t4 = t3*s3l2
      t5 = t4*s2l1
      t6 = t3*s3l1
      t7 = t6*s2l2
      t8 = -t5+t7
      t10 = s24f(z,l1,l2,l3,l4)
      t12 = s23f(z,l1,l2,l3,l4)
      t13 = s14f(z,l1,l2,l3,l4)
      t14 = t13**2
      t17 = t10**2
      t18 = t17*t10
      t21 = t4*t17
      t28 = t14*t13
      t32 = t6*t17
      t37 = 1/t1
      t38 = t37*s2l1
      t39 = 2688*t38
      t40 = s3l1*t37
      t44 = 1152*t38
      t45 = 1152*t40
      t48 = 3072*t40
      t53 = (-7*z+10)*t37
      t55 = -1+z
      t57 = 5*t55*t37
      t62 = -t55
      t63 = 3*t62
      t64 = t63*t37
      t71 = t37*s3l2
      t72 = t71*s2l1
      t73 = t40*s2l2
      t74 = t72-t73
      t77 = t37*s2l2
      t78 = 1152*t77
      t79 = 2304*t71
      t84 = 2304*t40
      t89 = 1920*t71
      t90 = s4l2*t37
      t91 = 3072*t90
      t93 = (-t89+t91)*s2l1
      t94 = 1920*t40
      t95 = s4l1*t37
      t96 = 3072*t95
      t98 = (t94-t96)*s2l2
      t99 = t90*s3l1
      t100 = 6144*t99
      t101 = t95*s3l2
      t102 = 6144*t101
      t105 = 768*t71
      t108 = 768*t40
      t113 = 1536*t77
      t116 = 2688*t77
      t119 = 1152*t71
      t122 = 1536*t38
      t129 = t90*s2l1
      t130 = 384*t129
      t131 = t95*s2l2
      t132 = 384*t131
      t133 = 3072*t99
      t134 = 3072*t101
      t138 = s13f(z,l1,l2,l3,l4)
      t141 = 35*t55*t37
      t145 = -17*z-3
      t159 = -29+68*z
      t169 = 8960.D0/3.D0*t40
      t173 = 2816*t38
      t175 = 512*t95
      t184 = (-32-z)*t37
      t191 = 33*t55*t37
      t195 = 4*t55*t37
      t203 = t4*t10
      t205 = 3072*t4
      t210 = t6*t10
      t212 = 3072*t6
      t219 = s4l2*t3*s3l1
      t222 = s4l1*t3*s3l2
      t248 = 3072*t71
      t249 = 8192.D0/3.D0*t90
      t252 = 8192.D0/3.D0*t95
      t263 = 2816*t77
      t265 = (-t263-t248)*t10
      t272 = (t173+t48)*t10
      t277 = 1024.D0/3.D0*t99
      t278 = 1024.D0/3.D0*t101
      t305 = 6144*t219
      t306 = 6144*t222
      t327 = z*t37
      t332 = (9-6*z)*t37
      t351 = 5376*t71
      t355 = 5376*t40
      t369 = 8*z
      t371 = (-14+t369)*t37
      t375 = 4*z-6
      t388 = -12+t369
      t399 = (-t79+1536*t90)*s2l1
      t402 = (t84-1536*t95)*s2l2
      t431 = 3072*t5
      t432 = 3072*t7
      s2 = 2816*t8*t10*t12*t14+(-3328*t4*t18+256.D0/3.D0*t21)*t12*s1l1+4
     #224*t8*t12*t28+(3328*t6*t18-256.D0/3.D0*t32)*t12*s1l2
      s3 = s2+(((-t39-4224*t40)*t10-t44-t45)*t12+(-t39-t48)*t17+(-384*t5
     #3*s2l1+384*t57*s3l1)*t10-384*t64*s2l1+384*t64*s3l1)*s1l2
      s1 = s3+(2304*t74*t14+(((-t78-t79)*t10-t78-t79)*s1l1+((t44+t84)*t1
     #0+t44+t84)*s1l2+(t93+t98+t100-t102)*t10+(-t105+t91)*s2l1+(t108-t96
     #)*s2l2+t100-t102)*t13+((t113+t89)*t17+(t116+t105)*t10+t78-t119)*s1
     #l1+((-t122-t94)*t17+(-t39-t108)*t10-t44+t45)*s1l2+(t130-t132+t133-
     #t134)*t10+t130-t132+t133-t134)*t138+((256.D0/3.D0*t141*s3l2+512.D0
     #/3.D0*t145*s4l2*t37)*s2l1+(-256.D0/3.D0*t141*s3l1-512.D0/3.D0*t145
     #*s4l1*t37)*s2l2-256.D0/3.D0*t159*s4l2*t40+256.D0/3.D0*t159*s4l1*t7
     #1)*t10+(((-256.D0/3.D0*t38-t169+512.D0/3.D0*t95)*t17+(t173+2816*t4
     #0-t175)*t10)*t12+(-256.D0/3.D0*t38-256.D0/3.D0*t40)*t18+(-256.D0/3
     #.D0*t184*s2l1+11008.D0/3.D0*t40)*t17+(-256.D0/3.D0*t191*s2l1-768*t
     #195*s3l1)*t10)*s1l2
      s2 = s1+((-8064*t21-7680*t203-t205)*t12*s1l1+(8064*t32+7680*t210+t
     #212)*t12*s1l2+((12672*t5-12672*t7-10368*t219+10368*t222)*t10+9600*
     #t5-9600*t7-6912*t219+6912*t222)*t12)*t13+((1152*t77*t12-t78-t79)*s
     #1l1+(-1152*t38*t12+t44+t84)*s1l2+(-3072*t72+3072*t73+t100-t102)*t1
     #2+t93+t98+t100-t102)*t14+(((t248-t249)*s2l1+(-t48+t252)*s2l2-16384
     #.D0/3.D0*t99+16384.D0/3.D0*t101)*t10*t13+((-6400.D0/3.D0*t77-t248)
     #*t17+t265)*s1l1+((6400.D0/3.D0*t38+t48)*t17+t272)*s1l2+(256.D0/3.D
     #0*t129-256.D0/3.D0*t131+t277-t278)*t17+((-8192.D0/3.D0*t71+768*t90
     #)*s2l1+(8192.D0/3.D0*t40-768*t95)*s2l2+t277-t278)*t10)*t138
      s3 = s2+((2816*t21+3584*t203)*t12*s1l1+(-2816*t32-3584*t210)*t12*s
     #1l2+((3328*t5-3328*t7-t305+t306)*t17+(4352.D0/3.D0*t5-4352.D0/3.D0
     #*t7-10496.D0/3.D0*t219+10496.D0/3.D0*t222)*t10)*t12)*t13+((((-t113
     #+t248-t91)*t10-t78-t119-1152*t90)*t12+(t113-384*t71)*t10+1152*t327
     #*s2l2-384*t332*s3l2)*s1l1+(((t122-t48+t96)*t10+t44+t45+1152*t95)*t
     #12+(-t122+384*t40)*t10-1152*t327*s2l1+384*t332*s3l1)*s1l2+((-t351+
     #3840*t90)*s2l1+(t355-3840*t95)*s2l2+9216*t99-9216*t101)*t12+((-t35
     #1+t91)*s2l1+(t355-t96)*s2l2+t100-t102)*t10+(384*t371*s3l2-768*t375
     #*s4l2*t37)*s2l1+(-384*t371*s3l1+768*t375*s4l1*t37)*s2l2-768*t388*s
     #4l2*t40+768*t388*s4l1*t71)*t13
      t443 = s3+(t399+t402+t133-t134)*t12+(((t116+4224*t71)*t10+t78+t119
     #)*t12+(t116+t248)*t17+(384*t53*s2l2-384*t57*s3l2)*t10+384*t64*s2l2
     #-384*t64*s3l2)*s1l1+((3072*t203-3072*t4)*t12*s1l1+(-3072*t210+3072
     #*t6)*t12*s1l2+((t431-t432-t305+t306)*t10-9216*t5+9216*t7-3072*t219
     #+3072*t222)*t12)*t14
      t449 = -t63*t37
      t480 = 8960.D0/3.D0*t71
      t487 = 17408.D0/3.D0*t99
      t488 = 17408.D0/3.D0*t101
      t495 = 512*t90
      t540 = 6144*t5
      t541 = 6144*t7
      t542 = 5760*t219
      t543 = 5760*t222
      t617 = -11+t369
      s2 = (t399+t402+4224*t99-4224*t101)*t10+(768*t449*s3l2+1536*t62*s4
     #l2*t37)*s2l1+(-768*t449*s3l1-1536*t62*s4l1*t37)*s2l2+(((6656.D0/3.
     #D0*t77+t249)*t10*t12+256.D0/3.D0*t77*t17+t265)*s1l1+((-6656.D0/3.D
     #0*t38-t252)*t10*t12-256.D0/3.D0*t38*t17+t272)*s1l2+((-t480+256.D0/
     #3.D0*t90)*s2l1+(t169-256.D0/3.D0*t95)*s2l2+t487-t488)*t10*t12-256.
     #D0/3.D0*t74*t17+((-t105-t495)*s2l1+(t108+t175)*s2l2+t133-t134)*t10
     #)*t13
      s1 = s2+((4096*t5-4096*t7-3328*t219+3328*t222)*t17+(2048.D0/3.D0*t
     #5-2048.D0/3.D0*t7+256.D0/3.D0*t219-256.D0/3.D0*t222)*t10)*t12+((42
     #24*t203+t205)*t12*s1l1+(-4224*t210-t212)*t12*s1l2+((8064*t5-8064*t
     #7-12288*t219+12288*t222)*t10+5376*t5-5376*t7-7296*t219+7296*t222)*
     #t12)*t14+((t540-t541-t542+t543)*t10+t540-t541-t542+t543)*t12+(((25
     #6.D0/3.D0*t77+t480-512.D0/3.D0*t90)*t17+(-t263-2816*t71+t495)*t10)
     #*t12+(256.D0/3.D0*t77+256.D0/3.D0*t71)*t18+(256.D0/3.D0*t184*s2l2-
     #11008.D0/3.D0*t71)*t17+(256.D0/3.D0*t191*s2l2+768*t195*s3l2)*t10)*
     #s1l1
      t624 = s1+((-3072*t21-3072*t203+3072*t4)*t12*s1l1+(3072*t32+3072*t
     #210-3072*t6)*t12*s1l2+((-t431+t432-t305+t306)*t10-9216*t219+9216*t
     #222)*t12)*t13+((-t480-t495)*s2l1+(t169+t175)*s2l2+9472.D0/3.D0*t99
     #-9472.D0/3.D0*t101)*t17+((-t480+8704.D0/3.D0*t90)*s2l1+(t169-8704.
     #D0/3.D0*t95)*s2l2+t487-t488)*t10*t12+(-5760*t21-5760*t203)*t12*s1l
     #1+(5760*t32+5760*t210)*t12*s1l2+3072*t8*t12*t28-384*t617*s4l2*t40+
     #384*t617*s4l1*t71
      taux10 = t443+t624

CCC Coefficients

      tcoff17 = taux9
      tcoff18 = taux9
      tcoff19 = taux10
      tcoff20 = taux10

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet17 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff17)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      t5 = s14f(z,l1,l2,l3,l4)
      tFjet18 = Fjet(var,ndim,z,1/ux,t2,t3,t4,t5,-1+z-t3-t5-t2-t4,-1+z-t
     #2-t4,-1+z-t3-t5,1+t5+t4,1+t3+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff18)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet19 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff19)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      t5 = s14f(z,l1,l2,l3,l4)
      tFjet20 = Fjet(var,ndim,z,1/ux,t2,t3,t4,t5,-1+z-t3-t5-t2-t4,-1+z-t
     #2-t4,-1+z-t3-t5,1+t5+t4,1+t3+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff20)

CCC Sum

      qgrmnum6e1 = tFjet17*tcoff17+tFjet18*tcoff18+tFjet19*tcoff19+tFjet
     #20*tcoff20
      RETURN
      END

      double precision function qgrmnum6e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = s3vf(z,l1,l2,l3,l4)
      t2 = t1**2
      t3 = 1/t2
      t4 = t3*s3l1
      t5 = s24f(z,l1,l2,l3,l4)
      t6 = t5**2
      t7 = t6*t5
      t10 = t4*t6
      t13 = s23f(z,l1,l2,l3,l4)
      t16 = 1/t1
      t17 = z*t16
      t18 = t6*t17
      t19 = 96*t18
      t20 = t13**2
      t21 = t17*t20
      t22 = 192*t21
      t23 = t3*s3l2
      t26 = t23*t6
      t31 = z*t3
      t32 = t31*t5
      t33 = 192*t32
      t37 = t31*t6
      t38 = 384*t37
      t39 = 2*z
      t42 = t3*t5
      t44 = 192*z*(-5+t39)*t42
      t52 = s14f(z,l1,l2,l3,l4)
      t53 = t52**2
      t55 = t17*t13
      t57 = t17*t5
      t58 = 384*t57
      t59 = 768*t17
      t64 = 192*t18
      t67 = t16*t5
      t70 = 4*z
      t78 = -384*t57-384*t17
      t89 = s13f(z,l1,l2,l3,l4)
      t93 = 8*z
      t100 = 6*z
      t105 = z**2
      t114 = t32+t31
      t117 = -1+z
      t118 = t117*z
      t119 = t118*t3
      t126 = 192*t17
      t128 = t89**2
      t146 = 192*t37
      t147 = 448.D0/3.D0*t32
      t151 = t31*t7
      t152 = 192*t151
      t160 = t53*t52
      t162 = t23*s2l1
      t164 = t4*s2l2
      t167 = s4l2*t3*s3l1
      t168 = 64.D0/3.D0*t167
      t170 = s4l1*t3*s3l2
      t171 = 64.D0/3.D0*t170
      t175 = 10*z-12
      t189 = t16*s2l2
      t194 = -64.D0/3.D0*t189*t6-192*t189*t5
      t196 = t16*s3l2
      t202 = (-640.D0/3.D0+64.D0/3.D0*z)*t16
      t207 = t117*t16
      t213 = t194*s1l1
      t214 = t16*s2l1
      t219 = -64.D0/3.D0*t214*t6-192*t214*t5
      t220 = t219*s1l2
      t221 = t5*t20
      t223 = 192*t17*t221
      t225 = 128.D0/3.D0*t189
      t226 = s4l2*t16
      t230 = s4l1*t16
      t231 = t230*s2l2
      t233 = 17*z
      t245 = s3l1*t16
      t255 = 512.D0/3.D0*t226
      t258 = 512.D0/3.D0*t231
      t259 = 26*z
      t269 = 192*t31*t20
      t271 = 384*t31
      t278 = 64.D0/3.D0*t162
      t279 = 64.D0/3.D0*t164
      t309 = 9*z
      s1 = (-64.D0/3.D0*t4*t7-192*t10)*t13*s1l2+t19-t22+(-64.D0/3.D0*t23
     #*t7-192*t26)*t13*s1l1+((t33+768*t31)*t20+(t38-t44-192*z*(-4+z)*t3)
     #*t13)*t53+((-384*t55-t58-t59)*t53+((-t58-t59)*t13-t64+192*z*(t39-7
     #)*t67+192*z*(t70-6)*t16)*t52+t78*t13-t19+96*z*(-2+t70)*t67+96*z*(-
     #1+t70)*t16)*t89+(-384*t21+(-1440*t57+96*z*(-15+t93)*t16)*t13-t64+9
     #6*z*(t100-7)*t67-96*z*(4*t105-12*z+5)*t16)*t52+(576*t114*t20+(t38-
     #t44-576*t119)*t13)*t52+(t78*t52-t64-t58-t126)*t128
      s2 = s1+((t33-96*t31)*t20+(768*t37-192*z*(t70-9)*t42-96*z*(t70-7)*
     #t3)*t13)*t53+((t146-t147)*t13*t52+(t152+128.D0/3.D0*t37-t147)*t13)
     #*t89+(-384*t55-384*t17)*t160+(t152+(-512.D0/3.D0*t162-512.D0/3.D0*
     #t164+t168+t171-64.D0/3.D0*(-z*(-10+z)+z*t175)*t3)*t6+(192*t167+192
     #*t170+448.D0/3.D0*t119)*t5)*t13
      s3 = s2+(t194*t13+(-64.D0/3.D0*t189-64.D0/3.D0*t196)*t7+(t202*s2l2
     #-192*t196)*t6+192*t207*s2l2*t5)*s1l1+(t213+t220-t223+(-1280.D0/3.D
     #0*t18+((t225+64.D0/3.D0*t226)*s2l1+64.D0/3.D0*t231+64.D0/3.D0*z*(-
     #36+t233)*t16)*t5)*t13+((t225+64.D0/3.D0*t196)*s2l1+64.D0/3.D0*t245
     #*s2l2-1472.D0/3.D0*t17)*t6+((-128.D0/3.D0*(7+z)*t16*s2l2-t255)*s2l
     #1-t258+64.D0/3.D0*z*(-7+t259)*t16)*t5)*t52
      t331 = s3+(t269+(768*t32+t271)*t13)*t160+(192*t31*t221+(t38+(t278+
     #t279+704.D0/3.D0*t31)*t5)*t13)*t53+(288*t37-288*z*(z-2)*t42-288*t1
     #19)*t13+((-64.D0/3.D0*t26-640.D0/3.D0*t23*t5)*t13*s1l1+(-64.D0/3.D
     #0*t10-640.D0/3.D0*t4*t5)*t13*s1l2+192*t31*t6*t20+(384*t151+(t278+t
     #279-128.D0/3.D0*z*(-19+t309)*t3)*t6+(-192*t162-192*t164-t168-t171+
     #64.D0/3.D0*(-z*(z+8)-z*t175)*t3)*t5)*t13)*t52
      t332 = 576*t32
      t333 = 192*t31
      t337 = 576*t37
      t384 = 576*t57
      t401 = t226*s3l1
      t403 = t230*s3l2
      t412 = 1024.D0/3.D0*t189
      t474 = t17*t5*t13
      t477 = 128.D0/3.D0*t189*s2l1
      t499 = t17*t7
      s1 = ((t332+t333)*t13*t53+(t337+1056*t32+480*t31)*t13*t52+(288*t37
     #+t332+288*t31)*t13)*t89+96*z*(2+z)*t67-96*t118*(t39+1)*t16-t223+((
     #t33+t271)*t13*t53+(t146+t332+t271)*t13*t52)*t89+(t269+(384*t32+t33
     #3)*t13)*t160+(-480*t57+96*z*(-5+t70)*t16)*t13+(1024.D0/3.D0*t17*t5
     #*t52+512.D0/3.D0*t18+512.D0/3.D0*t57)*t128+(-t22+(-t384+96*z*(-14+
     #t70)*t16)*t13-t384+96*z*(t93-10)*t16)*t53
      s2 = s1+((1024.D0/3.D0*t207*s2l2-t255)*s2l1-t258+192*t401+192*t403
     #-64.D0/3.D0*t118*(t233+2)*t16)*t5+(-1600.D0/3.D0*t18+((-t412-t255)
     #*s2l1-t258+64.D0/3.D0*z*(-9+t259)*t16)*t5)*t13+(-192*t37-192*t32)*
     #t20+(t219*t13+(-64.D0/3.D0*t214-64.D0/3.D0*t245)*t7+(t202*s2l1-192
     #*t245)*t6+192*t207*s2l1*t5)*s1l2
      t521 = s2+((-t412-512.D0/3.D0*t196-t255)*s2l1+(-512.D0/3.D0*t245-5
     #12.D0/3.D0*t230)*s2l2+64.D0/3.D0*t401+64.D0/3.D0*t403-64.D0/3.D0*z
     #*(-15*z+12)*t16)*t6-96*t114*t20+((-288*t32-t271)*t20+(t337-96*z*(t
     #100-12)*t42-96*z*(-6+3*z)*t3)*t13)*t52+(-192*t474+(t477-t126)*t5)*
     #t53+(1024.D0/3.D0*t17*t5*t53+(-640.D0/3.D0*t474+448.D0/3.D0*t18+(t
     #477-64.D0/3.D0*z*(-15+16*z)*t16)*t5)*t52+t213+t220+(-t64-64.D0/3.D
     #0*t57)*t13+128.D0/3.D0*t499+(-64.D0/3.D0*t226*s2l1-64.D0/3.D0*t231
     #+64.D0/3.D0*z*(z+12)*t16)*t6+((-t412-192*t226)*s2l1-192*t231+64.D0
     #/3.D0*z*(t309+10)*t16)*t5)*t89-896.D0/3.D0*t499
      taux9 = t331+t521
      t1 = 10*z
      t2 = -t1+13
      t4 = s3vf(z,l1,l2,l3,l4)
      t5 = 1/t4
      t6 = t5*s3l2
      t9 = t4**2
      t10 = 1/t9
      t11 = t10*s3l2
      t12 = t11*s2l1
      t13 = t10*s3l1
      t14 = t13*s2l2
      t15 = t12-t14
      t17 = s24f(z,l1,l2,l3,l4)
      t19 = s23f(z,l1,l2,l3,l4)
      t20 = s14f(z,l1,l2,l3,l4)
      t21 = t20**2
      t25 = s3l1*t5
      t30 = t21*t20
      t32 = t17**2
      t33 = t32*t17
      t36 = t11*t32
      t41 = t11*t17
      t46 = t13*t32
      t47 = t17*t13
      t52 = 3584*t6
      t53 = s4l2*t5
      t57 = 3584*t25
      t58 = s4l1*t5
      t62 = t53*s3l1
      t63 = 21760.D0/3.D0*t62
      t64 = t58*s3l2
      t65 = 21760.D0/3.D0*t64
      t78 = 7680*t12
      t79 = 7680*t14
      t81 = s4l2*t10*s3l1
      t82 = 6528*t81
      t84 = s4l1*t10*s3l2
      t85 = 6528*t84
      t91 = 3840*t11
      t96 = 3840*t13
      t114 = t5*s2l1
      t115 = 2688*t114
      t116 = 4608*t25
      t117 = 1536*t58
      t120 = 384*t114
      t121 = 768*t25
      t129 = (-6+7*z)*t5
      t133 = (-8*z+9)*t5
      t138 = 1-z
      t139 = t138*t5
      t142 = -t138
      t143 = t142*t5
      t156 = 3840*t12
      t157 = 3840*t14
      t158 = 7680*t81
      t159 = 7680*t84
      t178 = 11776.D0/3.D0*t12
      t179 = 11776.D0/3.D0*t14
      t193 = t5*s2l2
      t196 = 5120.D0/3.D0*t53
      t201 = 3072*t193
      t206 = 36*t138*t5
      t210 = 5*t138*t5
      s1 = 384*t2*s4l1*t6+11264.D0/3.D0*t15*t17*t19*t21-384*t2*s4l2*t25+
     #8448*t15*t19*t30+(11776.D0/3.D0*t11*t33-6656.D0/3.D0*t36)*t19*s1l1
     #+(6528*t36+6528*t41)*t19*s1l1+(-6528*t46-6528*t47)*t19*s1l2
      s2 = s1+((t52-8960.D0/3.D0*t53)*s2l1+(-t57+8960.D0/3.D0*t58)*s2l2-
     #t63+t65)*t17*t19+(-11776.D0/3.D0*t13*t33+6656.D0/3.D0*t46)*t19*s1l
     #2+((-t78+t79+t82-t85)*t17-t78+t79+t82-t85)*t19
      s3 = s2+((-4608*t41-t91)*t19*s1l1+(4608*t47+t96)*t19*s1l2+((-10752
     #*t12+10752*t14+15360*t81-15360*t84)*t17-8064*t12+8064*t14+8448*t81
     #-8448*t84)*t19)*t21+(((t115+t116-t117)*t17+t120+t121-t117)*t19+(t1
     #15+4224*t25)*t32+(-384*t129*s2l1+384*t133*s3l1)*t17-384*t139*s2l1+
     #768*t143*s3l1)*s1l2
      t217 = s3+((3840*t36+3840*t41-3840*t11)*t19*s1l1+(-3840*t46-3840*t
     #47+3840*t13)*t19*s1l2+((t156-t157+t158-t159)*t17+11520*t81-11520*t
     #84)*t19)*t20+((-11264.D0/3.D0*t36-20480.D0/3.D0*t41)*t19*s1l1+(112
     #64.D0/3.D0*t46+20480.D0/3.D0*t47)*t19*s1l2+((-t178+t179+t158-t159)
     #*t32+(-t178+t179+4608*t81-4608*t84)*t17)*t19)*t20+(((-t52+1024.D0/
     #3.D0*t53)*t32+(8960.D0/3.D0*t193+11008.D0/3.D0*t6-t196)*t17)*t19+(
     #t201+15616.D0/3.D0*t6)*t32+(256.D0/3.D0*t206*s2l2+768*t210*s3l2)*t
     #17)*s1l1
      t218 = t6*s2l1
      t219 = t25*s2l2
      t223 = 768*t193
      t224 = 1536*t6
      t229 = 768*t114
      t230 = 1536*t25
      t235 = 3072*t6
      t236 = 3840*t53
      t238 = (t235-t236)*s2l1
      t239 = 3072*t25
      t240 = 3840*t58
      t242 = (-t239+t240)*s2l2
      t243 = 7680*t62
      t244 = 7680*t64
      t247 = 2304*t6
      t250 = 2304*t25
      t255 = 1536*t193
      t258 = 1152*t193
      t261 = 384*t193
      t262 = 768*t6
      t265 = 1536*t114
      t268 = 1152*t114
      t273 = t53*s2l1
      t274 = 1920*t273
      t275 = t58*s2l2
      t276 = 1920*t275
      t277 = 3840*t62
      t278 = 3840*t64
      t282 = s13f(z,l1,l2,l3,l4)
      t286 = (41-42*z)*t5
      t290 = 22*z+14
      t304 = 29-85*z
      t314 = 7168.D0/3.D0*t53
      t318 = 7168.D0/3.D0*t58
      t323 = 3840*t6
      t332 = 2*z
      t334 = (-3+t332)*t5
      t341 = 3840*t25
      t357 = 3072*t53
      t361 = 3072*t58
      t368 = 4608*t6
      t376 = (9-t1)*t5
      t380 = -5*z+9
      t393 = 15-t1
      t439 = 5120.D0/3.D0*t58
      t444 = 3072*t114
      t457 = (1-t332)*t5
      t491 = 2688*t193
      t492 = 1536*t53
      t518 = 5120.D0/3.D0*t193
      t519 = 10240.D0/3.D0*t53
      t524 = (t201+t323)*t17
      t527 = 5120.D0/3.D0*t114
      t528 = 10240.D0/3.D0*t58
      t533 = (-t444-t341)*t17
      t598 = 1280.D0/3.D0*t62
      t599 = 1280.D0/3.D0*t64
      s3 = ((-1536*t218+1536*t219)*t21+(((t223+t224)*t17+t223+t224)*s1l1
     #+((-t229-t230)*t17-t229-t230)*s1l2+(t238+t242-t243+t244)*t17+(t247
     #-t236)*s2l1+(-t250+t240)*s2l2-t243+t244)*t20+((-t255-t235)*t32+(-t
     #258-t247)*t17+t261+t262)*s1l1+((t265+t239)*t32+(t268+t250)*t17-t12
     #0-t121)*s1l2+(-t274+t276-t277+t278)*t17-t274+t276-t277+t278)*t282+
     #((256.D0/3.D0*t286*s3l2+512.D0/3.D0*t290*s4l2*t5)*s2l1+(-256.D0/3.
     #D0*t286*s3l1-512.D0/3.D0*t290*s4l1*t5)*s2l2-256.D0/3.D0*t304*s4l2*
     #t25+256.D0/3.D0*t304*s4l1*t6)*t17
      s2 = s3+((2816*t6+t314)*s2l1+(-2816*t25-t318)*s2l2-t277+t278)*t32+
     #((((t255-t323+t236)*t17-t258+t262+768*t53)*t19+(-1920*t193-t224)*t
     #17-384*t334*s2l2-768*t334*s3l2)*s1l1+(((-t265+t341-t240)*t17+t268-
     #t121-768*t58)*t19+(1920*t114+t230)*t17+384*t334*s2l1+768*t334*s3l1
     #)*s1l2+((5376*t6-t357)*s2l1+(-5376*t25+t361)*s2l2-11520*t62+11520*
     #t64)*t19+((t368-t236)*s2l1+(-t116+t240)*s2l2-t243+t244)*t17+(384*t
     #376*s3l2-768*t380*s4l2*t5)*s2l1+(-384*t376*s3l1+768*t380*s4l1*t5)*
     #s2l2-768*t393*s4l2*t25+768*t393*s4l1*t6)*t20
      s1 = s2+((t224-2304*t53)*s2l1+(-t230+2304*t58)*s2l2-t277+t278)*t19
     #+((10752*t36+9600*t41+t91)*t19*s1l1+(-10752*t46-9600*t47-t96)*t19*
     #s1l2+((-16512*t12+16512*t14+12288*t81-12288*t84)*t17-12672*t12+126
     #72*t14+7296*t81-7296*t84)*t19)*t20+(((t57-1024.D0/3.D0*t58)*t32+(-
     #8960.D0/3.D0*t114-11008.D0/3.D0*t25+t439)*t17)*t19+(-t444-15616.D0
     #/3.D0*t25)*t32+(-256.D0/3.D0*t206*s2l1-768*t210*s3l1)*t17)*s1l2+(7
     #68*t457*s3l2+3072*s4l2*t142*t5)*s2l1
      s2 = s1+((-3840*t41+3840*t11)*t19*s1l1+(3840*t47-3840*t13)*t19*s1l
     #2+((-t156+t157+t158-t159)*t17+11520*t12-11520*t14+3840*t81-3840*t8
     #4)*t19)*t21+((t262-t357)*s2l1+(-t121+t361)*s2l2-4992*t62+4992*t64)
     #*t17+(((-t491-t368+t492)*t17-t261-t262+t492)*t19+(-t491-4224*t6)*t
     #32+(384*t129*s2l2-384*t133*s3l2)*t17+384*t139*s2l2-768*t143*s3l2)*
     #s1l1
      s3 = s2+(-768*t457*s3l1-3072*s4l1*t142*t5)*s2l2+(((-t518-t519)*t17
     #*t19+t524)*s1l1+((t527+t528)*t17*t19+t533)*s1l2+(3584*t218-3584*t2
     #19-t63+t65)*t17*t19+((5632.D0/3.D0*t6+t314)*s2l1+(-5632.D0/3.D0*t2
     #5-t318)*s2l2-t277+t278)*t17)*t20
      t612 = s3+((-20992.D0/3.D0*t12+20992.D0/3.D0*t14+11776.D0/3.D0*t81
     #-11776.D0/3.D0*t84)*t32+(-2560.D0/3.D0*t12+2560.D0/3.D0*t14-6656.D
     #0/3.D0*t81+6656.D0/3.D0*t84)*t17)*t19+((-768*t193*t19+t223+t224)*s
     #1l1+(768*t114*t19-t229-t230)*s1l2+(3840*t218-3840*t219-t243+t244)*
     #t19+t238+t242-t243+t244)*t21+(((-t323+t519)*s2l1+(t341-t528)*s2l2+
     #20480.D0/3.D0*t62-20480.D0/3.D0*t64)*t17*t20+((t518+t323)*t32+t524
     #)*s1l1+((-t527-t341)*t32+t533)*s1l2+(-1024.D0/3.D0*t273+1024.D0/3.
     #D0*t275-t598+t599)*t32+((10240.D0/3.D0*t6-t196)*s2l1+(-10240.D0/3.
     #D0*t25+t439)*s2l2-t598+t599)*t17)*t282
      taux10 = t217+t612

CCC Coefficients

      tcoff17 = taux9
      tcoff18 = taux9
      tcoff19 = taux10
      tcoff20 = taux10

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet17 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff17)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      t5 = s14f(z,l1,l2,l3,l4)
      tFjet18 = Fjet(var,ndim,z,1/ux,t2,t3,t4,t5,-1+z-t3-t5-t2-t4,-1+z-t
     #2-t4,-1+z-t3-t5,1+t5+t4,1+t3+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff18)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet19 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff19)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      t5 = s14f(z,l1,l2,l3,l4)
      tFjet20 = Fjet(var,ndim,z,1/ux,t2,t3,t4,t5,-1+z-t3-t5-t2-t4,-1+z-t
     #2-t4,-1+z-t3-t5,1+t5+t4,1+t3+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff20)

CCC Sum

      qgrmnum6e2 = tFjet17*tcoff17+tFjet18*tcoff18+tFjet19*tcoff19+tFjet
     #20*tcoff20
      RETURN
      END

      double precision function qgrmnum6e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = s3vf(z,l1,l2,l3,l4)
      t2 = 1/t1
      t3 = z*t2
      t4 = s24f(z,l1,l2,l3,l4)
      t5 = t4**2
      t6 = t4*t5
      t7 = t3*t6
      t9 = t1**2
      t10 = 1/t9
      t11 = z*t10
      t13 = 64.D0/3.D0*t11*t6
      t20 = z*(-1+z)
      t21 = t4*t10
      t25 = s23f(z,l1,l2,l3,l4)
      t27 = t11*t5
      t28 = 64.D0/3.D0*t27
      t29 = t11*t4
      t30 = 192*t29
      t33 = s14f(z,l1,l2,l3,l4)
      t39 = s13f(z,l1,l2,l3,l4)
      t41 = t3*t5
      t44 = 192*t3*t4
      t52 = t25**2
      t67 = t33**2
      taux9 = 192*t7+(t13-64.D0/3.D0*z*(-10+z)*t10*t5-192*t21*t20)*t25+(
     #(t28+t30)*t25*t33+(t13+640.D0/3.D0*t27+t30)*t25)*t39+((-64.D0/3.D0
     #*t41+t44)*t25+192*t41+t44)*t33+((-t28+512.D0/3.D0*t29)*t52+64.D0/3
     #.D0*z*(z+8)*t21*t25)*t33+(-64.D0/3.D0*t11*t4*t52-64.D0/3.D0*t11*t4
     #*t25)*t67+(64.D0/3.D0*t7+640.D0/3.D0*t41+t44)*t39-64.D0/3.D0*z*(-1
     #8+z)*t2*t5+(192*t27+192*t29)*t52+(1088.D0/3.D0*t41+t44)*t25-192*t2
     #0*t2*t4
      t1 = s3vf(z,l1,l2,l3,l4)
      t2 = 1/t1
      t3 = s4l2*t2
      t4 = s24f(z,l1,l2,l3,l4)
      t5 = s23f(z,l1,l2,l3,l4)
      t6 = t4*t5
      t9 = t2*s2l2
      t10 = t4**2
      t14 = t2*s3l2
      t15 = 1536*t14
      t17 = (1280.D0/3.D0*t9-t15)*t4
      t20 = s4l1*t2
      t23 = t2*s2l1
      t27 = s3l1*t2
      t28 = 1536*t27
      t30 = (-1280.D0/3.D0*t23+t28)*t4
      t33 = 4096.D0/3.D0*t14
      t37 = 4096.D0/3.D0*t27
      t41 = t3*s3l1
      t42 = 8704.D0/3.D0*t41
      t43 = t20*s3l2
      t44 = 8704.D0/3.D0*t43
      t48 = t14*s2l1
      t49 = t27*s2l2
      t53 = 10240.D0/3.D0*t3
      t56 = 10240.D0/3.D0*t20
      t59 = 1536*t41
      t60 = 1536*t43
      t64 = s14f(z,l1,l2,l3,l4)
      t66 = t1**2
      t67 = 1/t66
      t68 = t67*s3l2
      t69 = t68*s2l1
      t71 = t67*s3l1
      t72 = t71*s2l2
      t75 = s4l2*t67*s3l1
      t78 = s4l1*t67*s3l2
      t90 = t68*t4
      t95 = t71*t4
      t100 = 4608*t69
      t101 = 4608*t72
      t108 = 3072*t75
      t109 = 3072*t78
      t113 = t64**2
      t115 = 3072*t69
      t116 = 3072*t72
      t117 = 2304*t75
      t118 = 2304*t78
      t123 = 256*t9
      t127 = 4096.D0/3.D0*t3
      t134 = t4*t10
      t136 = 3*z
      t138 = (2+t136)*t2
      t144 = 1-z
      t146 = 5*t144*t2
      t149 = -t144
      t150 = t149*t2
      t157 = t68*t10
      t162 = t71*t10
      t167 = 1536*t69
      t168 = 1536*t72
      t171 = 4608*t75
      t172 = 4608*t78
      t187 = t3*s2l1
      t188 = t20*s2l2
      t192 = 2304*t9
      t194 = (-t192+t15)*t4
      t195 = 768*t9
      t202 = (-6+t136)*t2
      t204 = 2*z
      t205 = t204+1
      t206 = t205*t2
      t231 = 1536*t48
      t232 = 1536*t49
      t254 = -t69+t72
      s2 = ((4096.D0/3.D0*t3*t6-256*t9*t10+t17)*s1l1+(-4096.D0/3.D0*t20*
     #t6+256*t23*t10+t30)*s1l2+((-t33-256*t3)*s2l1+(t37+256*t20)*s2l2+t4
     #2-t44)*t4*t5+(256*t48-256*t49)*t10+((-t33-t53)*s2l1+(t37+t56)*s2l2
     #+t59-t60)*t4)*t64+((5120*t69-5120*t72-1280*t75+1280*t78)*t10+(1024
     #.D0/3.D0*t69-1024.D0/3.D0*t72+10496.D0/3.D0*t75-10496.D0/3.D0*t78)
     #*t4)*t5+((1536*t90+1536*t68)*t5*s1l1+(-1536*t95-1536*t71)*t5*s1l2+
     #((t100-t101-6144*t75+6144*t78)*t4+3840*t69-3840*t72-t108+t109)*t5)
     #*t113
      s1 = s2+((t115-t116-t117+t118)*t4+t115-t116-t117+t118)*t5+(((-t123
     #+t33)*t10+(1792.D0/3.D0*t9-t15+t127)*t4)*t5+(-256*t9-256*t14)*t134
     #+(256.D0/3.D0*t138*s2l2-3328.D0/3.D0*t14)*t10+(256.D0/3.D0*t146*s2
     #l2+1536*t150*s3l2)*t4)*s1l1+((-1536*t157-1536*t90+1536*t68)*t5*s1l
     #1+(1536*t162+1536*t95-1536*t71)*t5*s1l2+((-t167+t168-t108+t109)*t4
     #-t171+t172)*t5)*t64+((2560.D0/3.D0*t14-t53)*s2l1+(-2560.D0/3.D0*t2
     #7+t56)*s2l2+1280*t41-1280*t43)*t10
      t260 = s1+(-1536*t187+1536*t188+1536*t41-1536*t43)*t5+((t194-t195)
     #*t5+(-t192-768*t14)*t10+(768*t202*s2l2-768*t206*s3l2)*t4+2304*t150
     #*s2l2)*s1l1+((1536*t90-1536*t68)*t5*s1l1+(-1536*t95+1536*t71)*t5*s
     #1l2+((t167-t168-t108+t109)*t4-t100+t101-1536*t75+1536*t78)*t5)*t11
     #3+(t231-t232-768*t41+768*t43)*t4+((-t33-2560.D0/3.D0*t3)*s2l1+(t37
     #+2560.D0/3.D0*t20)*s2l2+t42-t44)*t4*t5+(-2304*t157-2304*t90)*t5*s1
     #l1+(2304*t162+2304*t95)*t5*s1l2+3072*t254*t5*t113*t64
      t273 = 2304*t23
      t275 = (t273-t28)*t4
      t276 = 768*t23
      t292 = -1536*t14+1536*t3
      t293 = t292*s2l1
      t295 = 1536*t27-1536*t20
      t296 = t295*s2l2
      t297 = 3072*t41
      t298 = 3072*t43
      t311 = 2304*t187
      t312 = 2304*t188
      t316 = s13f(z,l1,l2,l3,l4)
      t346 = 4096.D0/3.D0*t20
      t358 = 256*t23
      t365 = 512.D0/3.D0*t41
      t366 = 512.D0/3.D0*t43
      t379 = 8*z
      t381 = (-7+t379)*t2
      t383 = -20-t379
      t396 = -23+34*z
      t485 = (-1+t204)*t2
      t500 = -3+t204
      s1 = (-1280*t68*t134+10496.D0/3.D0*t157)*t5*s1l1+(1280*t71*t134-10
     #496.D0/3.D0*t162)*t5*s1l2+t231-t232+((t275+t276)*t5+(t273+768*t27)
     #*t10+(-768*t202*s2l1+768*t206*s3l1)*t4-2304*t150*s2l1)*s1l2+(((t29
     #3+t296+t297-t298)*t4+t293+t296+t297-t298)*t64+(1536*t14*t10+t194-t
     #192)*s1l1+(-1536*t27*t10+t275+t273)*s1l2+(t311-t312+t59-t60)*t4+t3
     #11-t312+t59-t60)*t316+((-4608*t157-3840*t90-1536*t68)*t5*s1l1+(460
     #8*t162+3840*t95+1536*t71)*t5*s1l2+((6912*t69-6912*t72-t171+t172)*t
     #4+5376*t69-5376*t72-t117+t118)*t5)*t64+((-t231+t232+t297-t298)*t5+
     #t293+t296+t297-t298)*t113
      s2 = s1+(((t15-t127)*s2l1+(-t28+t346)*s2l2-8192.D0/3.D0*t41+8192.D
     #0/3.D0*t43)*t4*t64+((-t123-t15)*t10+t17)*s1l1+((t358+t28)*t10+t30)
     #*s1l2+(256*t187-256*t188+t365-t366)*t10+((-t33-1280.D0/3.D0*t3)*s2
     #l1+(t37+1280.D0/3.D0*t20)*s2l2+t365-t366)*t4)*t316+((512.D0/3.D0*t
     #381*s3l2+512.D0/3.D0*t383*s4l2*t2)*s2l1+(-512.D0/3.D0*t381*s3l1-51
     #2.D0/3.D0*t383*s4l1*t2)*s2l2-256.D0/3.D0*t396*s4l2*t27+256.D0/3.D0
     #*t396*s4l1*t14)*t4+(((t358-t37)*t10+(-1792.D0/3.D0*t23+t28-t346)*t
     #4)*t5+(256*t23+256*t27)*t134+(-256.D0/3.D0*t138*s2l1+3328.D0/3.D0*
     #t27)*t10+(-256.D0/3.D0*t146*s2l1-1536*t150*s3l1)*t4)*s1l2
      t519 = s2+((1792*t157+5632*t90)*t5*s1l1+(-1792*t162-5632*t95)*t5*s
     #1l2+((1280*t69-1280*t72-t108+t109)*t10+(12544.D0/3.D0*t69-12544.D0
     #/3.D0*t72-6400.D0/3.D0*t75+6400.D0/3.D0*t78)*t4)*t5)*t64+(((-t292*
     #t4+t195)*t5+t194-t192)*s1l1+((-t295*t4-t276)*t5+t275+t273)*s1l2+((
     #-t15-3072*t3)*s2l1+(t28+3072*t20)*s2l2+4608*t41-4608*t43)*t5+((307
     #2*t14+1536*t3)*s2l1+(-3072*t27-1536*t20)*s2l2+t297-t298)*t4+(768*t
     #485*s3l2-1536*s4l2*t149*t2)*s2l1+(-768*t485*s3l1+1536*s4l1*t149*t2
     #)*s2l2-1536*t500*s4l2*t27+1536*t500*s4l1*t14)*t64-768*t205*s4l2*t2
     #7+768*t205*s4l1*t14+1792*t254*t4*t5*t113
      taux10 = t260+t519

CCC Coefficients

      tcoff17 = taux9
      tcoff18 = taux9
      tcoff19 = taux10
      tcoff20 = taux10

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet17 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff17)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      t5 = s14f(z,l1,l2,l3,l4)
      tFjet18 = Fjet(var,ndim,z,1/ux,t2,t3,t4,t5,-1+z-t3-t5-t2-t4,-1+z-t
     #2-t4,-1+z-t3-t5,1+t5+t4,1+t3+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff18)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet19 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff19)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      t5 = s14f(z,l1,l2,l3,l4)
      tFjet20 = Fjet(var,ndim,z,1/ux,t2,t3,t4,t5,-1+z-t3-t5-t2-t4,-1+z-t
     #2-t4,-1+z-t3-t5,1+t5+t4,1+t3+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff20)

CCC Sum

      qgrmnum6e3 = tFjet17*tcoff17+tFjet18*tcoff18+tFjet19*tcoff19+tFjet
     #20*tcoff20
      RETURN
      END

      double precision function qgrmnum6e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux9 = 0
      t1 = s3vf(z,l1,l2,l3,l4)
      t2 = 1/t1
      t3 = s4l2*t2
      t4 = t3*s2l1
      t5 = s4l1*t2
      t6 = t5*s2l2
      t7 = t4-t6
      t9 = s24f(z,l1,l2,l3,l4)
      t10 = 4096.D0/3.D0*t7*t9
      t11 = s23f(z,l1,l2,l3,l4)
      t13 = t1**2
      t14 = 1/t13
      t15 = t14*s3l2
      t16 = t9**2
      t17 = t16*t9
      t20 = t15*t16
      t25 = t14*s3l1
      t28 = t25*t16
      t35 = t3*s3l1
      t37 = t5*s3l2
      t41 = t2*s2l1
      t46 = 512.D0/3.D0*t41*t16+1536*t41*t9
      t48 = s3l1*t2
      t53 = (-10+z)*t2
      t60 = (-1+z)*t2
      t66 = t2*s2l2
      t71 = -512.D0/3.D0*t66*t16-1536*t66*t9
      t72 = t71*s1l1
      t73 = t46*s1l2
      t74 = 512.D0/3.D0*t7
      t79 = s13f(z,l1,l2,l3,l4)
      t93 = t15*s2l1
      t94 = t25*s2l2
      t96 = 512.D0/3.D0*t93-512.D0/3.D0*t94
      t101 = s4l2*t14*s3l1
      t102 = 512.D0/3.D0*t101
      t104 = s4l1*t14*s3l2
      t105 = 512.D0/3.D0*t104
      t111 = s14f(z,l1,l2,l3,l4)
      t116 = t2*s3l2
      t158 = t111**2
      s1 = t10*t11+(-512.D0/3.D0*t15*t17-1536*t20)*t11*s1l1+(512.D0/3.D0
     #*t25*t17+1536*t28)*t11*s1l2+(4096.D0/3.D0*t4-4096.D0/3.D0*t6-1536*
     #t35+1536*t37)*t9+(t46*t11+(512.D0/3.D0*t41+512.D0/3.D0*t48)*t17+(-
     #512.D0/3.D0*t53*s2l1+1536*t48)*t16-1536*t60*s2l1*t9)*s1l2+(t72+t73
     #+t74*t16+1536*t7*t9)*t79
      taux10 = s1+((-512.D0/3.D0*t20-5120.D0/3.D0*t15*t9)*t11*s1l1+(512.
     #D0/3.D0*t28+5120.D0/3.D0*t25*t9)*t11*s1l2+(t96*t16+(-1536*t93+1536
     #*t94+t102-t105)*t9)*t11)*t111+(t72+t73-t74*t9*t11+(512.D0/3.D0*t11
     #6*s2l1-512.D0/3.D0*t48*s2l2)*t16+t10)*t111+((-4096.D0/3.D0*t93+409
     #6.D0/3.D0*t94-t102+t105)*t16+(-1536*t101+1536*t104)*t9)*t11+(t71*t
     #11+(-512.D0/3.D0*t66-512.D0/3.D0*t116)*t17+(512.D0/3.D0*t53*s2l2-1
     #536*t116)*t16+1536*t60*s2l2*t9)*s1l1+((-4096.D0/3.D0*t116+4096.D0/
     #3.D0*t3)*s2l1+(4096.D0/3.D0*t48-4096.D0/3.D0*t5)*s2l2-512.D0/3.D0*
     #t35+512.D0/3.D0*t37)*t16+t96*t9*t11*t158

CCC Coefficients

      tcoff17 = taux9
      tcoff18 = taux9
      tcoff19 = taux10
      tcoff20 = taux10

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet17 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff17)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      t5 = s14f(z,l1,l2,l3,l4)
      tFjet18 = Fjet(var,ndim,z,1/ux,t2,t3,t4,t5,-1+z-t3-t5-t2-t4,-1+z-t
     #2-t4,-1+z-t3-t5,1+t5+t4,1+t3+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff18)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet19 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff19)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      t5 = s14f(z,l1,l2,l3,l4)
      tFjet20 = Fjet(var,ndim,z,1/ux,t2,t3,t4,t5,-1+z-t3-t5-t2-t4,-1+z-t
     #2-t4,-1+z-t3-t5,1+t5+t4,1+t3+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff20)

CCC Sum

      qgrmnum6e4 = tFjet17*tcoff17+tFjet18*tcoff18+tFjet19*tcoff19+tFjet
     #20*tcoff20
      RETURN
      END

      double precision function qgrmnum7e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = t1**2
      t3 = t2**2
      t4 = l3**2
      t5 = t3*t4
      t6 = 1/s3vr
      t7 = t6*t5
      t9 = s1vr**2
      t10 = t9*s1vr
      t12 = t7*s3l1p*s23r*t10
      t14 = t6*s3l1p
      t15 = t5*t14
      t16 = 192*t15
      t17 = s4l1p*t6
      t18 = t17*t5
      t21 = s23r**2
      t23 = l3-1
      t24 = t23*t3
      t25 = t24*t4
      t26 = t6*s34r
      t27 = t26*s2l1
      t28 = t25*t27
      t30 = t4*t23
      t31 = t3*t1
      t32 = t30*t31
      t33 = t14*s34r
      t36 = -t1
      t37 = t2*t1
      t38 = t36*t37
      t39 = l3*t6
      t40 = t39*s3l1p
      t49 = t21*s23r
      t52 = t31*t6
      t53 = t52*s3l1p
      t54 = t30*t53
      t56 = t31*t23
      t59 = t56*t4*s4l1p*t6
      t63 = t37*l3
      t64 = t63*t14
      t66 = 2*t1
      t67 = t66*t37
      t69 = l3*s4l1p*t6
      t74 = t23**2
      t75 = t74*t31
      t76 = t4*t6
      t77 = s34r**2
      t79 = t75*t76*t77
      t83 = t39*s34r
      t84 = t66*t23*t37*t83
      t86 = -288*t79+96*t84
      t88 = t4*t74
      t89 = t3*t2
      t90 = t88*t89
      t91 = t14*t77
      t94 = 2-z
      t96 = t94*t3*t23
      t97 = s3l1p*s34r
      t107 = t23*t6
      t111 = t3*t74
      t112 = t111*t83
      t117 = t63*t107*t21
      t119 = t111*l3
      t120 = t26*s23r
      t121 = t119*t120
      t123 = l3*t31
      t124 = t74*t23
      t126 = t124*t6*t77
      t127 = t123*t126
      t133 = t24*l3
      t134 = t6*s3l2p
      t138 = t23*t37
      t139 = t39*s2l2
      t140 = t138*t139
      t142 = t39*s3l2p
      t143 = t24*t142
      t144 = 96*t143
      t146 = l3*s4l2p*t6
      t147 = t24*t146
      t151 = t23*t2
      t152 = t6*s2l2
      t155 = t75*t142
      t159 = t123*t74*s4l2p*t6
      t160 = 192*t159
      t163 = 2+z
      t164 = t163*t23
      t165 = t37*t6
      t166 = t165*s3l2p
      t169 = z*t23
      t170 = t37*s4l2p
      t171 = t170*t6
      t172 = t169*t171
      t173 = 192*t172
      t178 = 192*t147
      t185 = t2*t6
      t188 = -288*t112+96*(-8*z+5)*t23*t185
      t196 = (3-13*z)*t6
      t200 = 6*z
      t201 = -3-t200
      t210 = t74*t6
      t211 = t210*s34r
      t214 = -96*t127+96*(4-z)*t37*t211
      t216 = t124*t89
      t217 = t216*l3
      t218 = t134*t77
      t219 = t217*t218
      t221 = 6-z
      t223 = t221*t3*t74
      t224 = t134*s34r
      t229 = t140-t143-t147
      t233 = 3-t200
      t237 = 1536*t112-192*t233*t23*t185
      t239 = -t155-t159
      t242 = t233*t6
      t253 = 7*z
      t254 = 2-t253
      t258 = 960*t127-192*t254*t37*t211
      t261 = l3*t124
      t263 = t89*s4l2p*t6
      t265 = -t216*t142-t261*t263
      t268 = t254*t6
      t279 = t74**2
      t281 = t89*t6
      t282 = t77*s34r
      t284 = l3*t279*t281*t282
      t285 = t31*t124
      t286 = t6*t77
      t289 = 192*t284+192*t285*t286
      t292 = t279*t3*t37
      t295 = -t292*t142-t292*t146
      t298 = t216*t134
      t299 = s4l2p*t6
      t300 = t216*t299
      t309 = t39*s2l1
      t310 = t138*t309
      t312 = t24*t40
      t313 = 96*t312
      t314 = t24*t69
      t318 = t6*s2l1
      t322 = t123*t210*s3l1p
      t325 = t74*s4l1p*t6
      t326 = t123*t325
      t327 = 192*t326
      t330 = t165*s3l1p
      t334 = t37*s4l1p*t6
      t335 = t169*t334
      t336 = 192*t335
      t341 = 192*t314
      t359 = t217*t91
      t365 = t310-t312-t314
      t369 = -t322-t326
      t382 = t281*s3l1p
      t387 = -t261*t382-t261*t89*s4l1p*t6
      t403 = -t292*t40-t292*t69
      t413 = z*t3
      t414 = t413*t23
      t418 = t134*s2l1
      t419 = t133*t418
      t421 = t14*s2l2
      t422 = t133*t421
      t424 = l3*t23
      t425 = t424*t31
      t426 = t134*s3l1p
      t432 = t414*t76*t21
      t433 = 672*t432
      t436 = z*t74
      t437 = t436*t4
      t438 = t52*s34r
      t439 = t437*t438
      t441 = t52*s3l2p
      t442 = t424*t441
      t445 = t31*s4l2p*t6
      t446 = t424*t445
      t447 = 192*t446
      t450 = t17*s3l2p
      t451 = t425*t450
      t452 = 192*t451
      t461 = -t163*t23
      t465 = 192*t138*t299
      t471 = 192*t138*t17
      t474 = l3*t74
      t475 = t474*t89
      t478 = l3*z
      t484 = 2*z
      t486 = (-5+t484)*t23
      t487 = t3*t6
      t488 = t487*s3l2p
      t491 = t24*t299
      t496 = 384*t24*t450
      t502 = t6*t21
      t506 = 5*t1
      t508 = t506*t23*t37
      t534 = t37*t74
      t535 = t26*s2l2
      t538 = t111*t134
      t540 = t111*t299
      t546 = t111*t14
      t548 = t111*t17
      t556 = -3+z
      t561 = t75*t299
      t565 = t75*t450
      t574 = t37*t4
      t575 = t574*t318
      t576 = 512.D0/3.D0*t575
      t578 = 512.D0/3.D0*t18
      t581 = t107*s34r
      t582 = t5*t581
      t583 = l3*t2
      t584 = z*t6
      t585 = t583*t584
      t587 = -512.D0/3.D0*t582-512.D0/3.D0*t585
      t593 = z*t37
      t596 = 8*t36
      t603 = t17*s34r
      t606 = z*t2
      t616 = 1024.D0/3.D0*t582+512.D0/3.D0*t583*t6
      t618 = 384*t54
      t622 = -8+z
      t623 = t622*t37
      t629 = t606*t6
      t631 = 512.D0/3.D0*t79+512.D0/3.D0*t138*t83-512.D0/3.D0*t629
      t633 = t88*t382
      t636 = t4*t89*t325
      t641 = t622*t23*t3
      t648 = 512.D0/3.D0*t593*t14
      t649 = z**2
      t650 = t649*t2
      t655 = t123*t74
      t659 = t169*t37
      t665 = t3*l3
      t667 = t665*t17
      t672 = 512.D0/3.D0*t84+512.D0/3.D0*t629
      t674 = -t66
      t675 = t674*t6
      t688 = t39*t77
      t692 = 512.D0/3.D0*t75*t688+512.D0/3.D0*t593*t581
      t694 = t36*t6
      t695 = t694*s3l1p
      t698 = t36*s4l1p*t6
      t712 = t665*z
      t716 = z*t31
      t724 = t4*l3
      t725 = t724*t6
      t729 = t5*t134
      t731 = t5*t299
      t743 = t31*t4
      t745 = 384*t743*t426
      t750 = t25*t535
      t752 = t32*t224
      t756 = s34r*s2l2
      t757 = t14*t756
      t760 = t30*t89
      t763 = z*t4
      t769 = -3+t484
      t770 = t769*l3
      t771 = t770*t488
      t772 = t665*t299
      t776 = t665*t450
      t782 = t574*t502
      t784 = 384*t582
      t793 = t574*t6*t49
      t796 = 3*z
      t797 = 2-t796
      t818 = t7*s3l2p*s23r*t10
      t820 = t574*t152
      t827 = t784+96*t585
      t829 = t107*s3l2p
      t830 = t743*t829
      t831 = 384*t830
      t834 = t743*t23*s4l2p*t6
      t839 = (1-t484)*t37
      t842 = 192*t772
      t845 = t133*t224
      t855 = -1-z
      t859 = -960*t582+288*t855*t2*t39
      t864 = t63*t134
      t866 = -t506
      t867 = t866*t37
      t882 = -576*t79+96*(-3-t484)*l3*t37*t581+96*t556*t1*t584
      t884 = t74*t89
      t886 = t884*t76*s3l2p
      t889 = t884*t4*s4l2p*t6
      t895 = (7+t484)*t3*t23
      t897 = 4*z
      t900 = (7-t897)*t3*t23
      t905 = 3*t649
      t907 = (2+t796-t905)*t2
      t910 = 2*t649
      t912 = (2-z-t910)*t2
      t919 = -2*t855*t23
      t920 = t919*t2
      t932 = -t769
      t933 = t932*t2
      t935 = t932*t6
      t936 = t935*s3l2p
      t939 = t932*s4l2p*t6
      t950 = 192*t866*l3*t37*t581+192*t932*t1*t584
      t952 = t866*t6
      t967 = 3*t36
      t976 = 192*t967*t3*t74*t688+192*t797*z*t23*t185*s34r
      t978 = t967*t6
      t987 = t797*t6
      t1003 = 192*t261*t52*t282+192*t436*t165*t77
      t1008 = t111*t584*s3l2p
      t1019 = 1024.D0/3.D0*t585
      t1029 = t424*t37
      t1040 = 512.D0/3.D0*t820
      t1042 = 512.D0/3.D0*t731
      t1058 = t299*s34r
      t1065 = 192*t729
      t1087 = 512.D0/3.D0*t593*t134
      t1118 = t694*s3l2p
      t1121 = t36*s4l2p*t6
      t1135 = 9*z
      t1143 = (4-t253+t905)*t2
      t1160 = 5*z
      t1165 = t797*t37
      t1189 = t478*t74
      t1203 = t534*t152
      t1213 = t3*t124
      t1214 = t1213*t535
      t1216 = t285*t134
      t1218 = t285*t299
      t1224 = -t1203+t538+t540
      t1228 = t1216+t1218
      t1233 = t31*t279
      t1235 = t1233*t286*s2l2
      t1237 = t279*t89
      t1240 = t1237*t134+t1237*t299
      t1245 = t534*t318
      t1255 = t1213*t27
      t1257 = t285*t14
      t1259 = t285*t17
      t1265 = -t1245+t546+t548
      t1269 = t1257+t1259
      t1275 = t1233*t286*s2l1
      t1279 = t1237*t14+t1237*t17
      t1290 = t111*t418
      t1292 = t111*t421
      t1295 = t478*t124*t438
      t1297 = t75*t134
      t1318 = t285*t6
      t1319 = s3l2p*s34r
      t1342 = s13r**2
      t1349 = 512.D0/3.D0*t540
      t1377 = 512.D0/3.D0*t548
      t1402 = t743*t6
      t1403 = s3l2p*s3l1p
      t1407 = t134*t97
      t1415 = 192*t140
      t1416 = 96*t147
      t1422 = s34r*s23r
      t1430 = 192*t310
      t1431 = 96*t314
      t1444 = s23r*t10
      t1446 = t414*t76*t1444
      t1454 = -384*t442-t447
      t1462 = t763*t3*t107*t49
      t1481 = t763*t89*t126
      t1484 = t474*t281*s3l2p
      t1486 = t474*t263
      t1490 = t475*t450
      t1503 = t584*t21
      t1507 = (t200-7)*t37
      t1541 = t674*t2
      t1546 = t133*t33
      t1564 = t724*t3*t1503
      t1598 = -1+t796
      t1599 = t1598*t6
      t1601 = 512.D0/3.D0*t151*t1599
      t1602 = 320*t112+t1601
      t1608 = 1-t897
      t1609 = t1608*t6
      t1610 = t1609*s3l2p
      t1616 = t165*s34r
      t1619 = 512.D0/3.D0*t127+512.D0/3.D0*t436*t1616
      t1631 = -2560.D0/3.D0*t112-t1601
      t1650 = -2048.D0/3.D0*t127+512.D0/3.D0*t1608*t74*t1616
      t1667 = -512.D0/3.D0*t284-512.D0/3.D0*t1213*t584*t77
      t1672 = z*t124
      t1704 = t1609*s3l1p
      t1713 = t111*t584*s3l1p
      t1763 = 64.D0/3.D0*t419
      t1764 = 64.D0/3.D0*t422
      t1765 = 256.D0/3.D0*t439
      t1768 = 128.D0/3.D0*t442+64.D0/3.D0*t446
      t1770 = 64.D0/3.D0*t451
      t1857 = t967*t37
      t1864 = 192*t667
      t1987 = t935*s3l1p
      t1990 = t932*s4l1p*t6
      s4 = (192*t12+((-t16+288*t18)*t21+(480*t28-384*t32*t33-96*t38*t40)
     #*s23r)*t9+((96*t15-96*t18)*t49+(-288*t28+(288*t54-96*t59)*s34r-192
     #*t64+96*t67*t69)*t21+(t86*s2l1+192*t90*t91+96*t96*t39*t97)*s23r)*s
     #1vr)*s1l2
      s8 = (((-576*t63*t107*s23r-384*t112)*t9+(960*t117+1536*t121+384*t1
     #27)*s1vr)*s1l2+288*t133*t134*t10+((-288*t140-t144+288*t147)*s23r-1
     #92*t151*t152+(-576*t155+t160)*s34r+96*t164*t166+t173)*t9+((-96*t14
     #0+960*t143-t178)*t21+(t188*s2l2+(1248*t155-96*t159)*s34r-96*t138*t
     #196*s3l2p-96*t138*t201*s4l2p*t6)*s23r+t214*s2l2+480*t219-96*t223*t
     #224)*s1vr+768*t229*t49+(t237*s2l2+1536*t239*s34r+192*t138*t242*s3l
     #2p+192*t138*t233*s4l2p*t6)*t21+(t258*s2l2+960*t265*t77+(192*t111*t
     #268*s3l2p+192*t111*t254*s4l2p*t6)*s34r)*s23r+t289*s2l2+192*t295*t2
     #82+(-192*t298-192*t300)*t77)*s1l1
      s9 = (288*t133*t14*t10+((-288*t310-t313+288*t314)*s23r-192*t151*t3
     #18+(-576*t322+t327)*s34r+96*t164*t330+t336)*t9+((-96*t310+960*t312
     #-t341)*t21+(t188*s2l1+(1248*t322-96*t326)*s34r-96*t138*t196*s3l1p-
     #96*t138*t201*s4l1p*t6)*s23r+t214*s2l1+480*t359-96*t223*t33)*s1vr+7
     #68*t365*t49+(t237*s2l1+1536*t369*s34r+192*t138*t242*s3l1p+192*t138
     #*t233*s4l1p*t6)*t21+(t258*s2l1+960*t387*t77+(192*t111*t268*s3l1p+1
     #92*t111*t254*s4l1p*t6)*s34r)*s23r+t289*s2l1+192*t403*t282+(-192*t2
     #16*t14-192*t216*t17)*t77)*s1l2
      s7 = s8+s9
      s6 = s7+(96*t414*t76*s23r+96*t419+96*t422+384*t425*t426)*t10+(-t43
     #3+(480*t419+480*t422-96*t439+(-1152*t442-t447)*s3l1p-t452-96*t94*t
     #23*z*t63*t6)*s23r+(-96*t461*t166+t465)*s2l1+(-96*t461*t330+t471)*s
     #2l2+(-384*t475*t426-576*t478*t111*t6)*s34r+(192*t486*t488-384*t491
     #)*s3l1p-t496)*t9+(672*t36*t23*z*t63*t502+(96*t508*t418+96*t508*t42
     #1+96*(13-z)*l3*z*t111*t26+(-192*(-5+t200)*t23*t488-96*t486*t3*s4l2
     #p*t6)*s3l1p-96*t486*t3*t450)*s23r+(384*t534*t535+(-768*t538-192*t5
     #40)*s34r)*s2l1+(-768*t546-192*t548)*s34r*s2l2+576*t478*t31*t126+((
     #-384*t556*t31*t210*s3l2p+576*t561)*s3l1p+576*t565)*s34r)*s1vr
      s7 = s13r
      s5 = s6*s7
      s3 = s4+s5
      s4 = s3+(-64.D0/3.D0*t12+((-t576+640.D0/3.D0*t15+t578)*t21+(t587*s
     #2l1+(640.D0/3.D0*t54+512.D0/3.D0*t59)*s34r+448.D0/3.D0*t593*t40-64
     #.D0/3.D0*t63*t596*s4l1p*t6)*s23r-512.D0/3.D0*t133*t603-512.D0/3.D0
     #*t606*t17)*t9+((t576-t16-t578)*t49+(t616*s2l1+(-t618-1024.D0/3.D0*
     #t59)*s34r+64.D0/3.D0*t623*t40)*t21+(t631*s2l1+(-192*t633-512.D0/3.
     #D0*t636)*t77+(64.D0/3.D0*t641*t40+512.D0/3.D0*t314)*s34r+t648+512.
     #D0/3.D0*t650*t17)*s23r+512.D0/3.D0*t655*t17*t77+512.D0/3.D0*t659*t
     #603)*s1vr+(512.D0/3.D0*t63*t318-512.D0/3.D0*t665*t14-512.D0/3.D0*t
     #667)*t49+(t672*s2l1+(512.D0/3.D0*t133*t675*s3l1p+512.D0/3.D0*t133*
     #t674*s4l1p*t6)*s34r-t648-512.D0/3.D0*t593*t17)*t21+(t692*s2l1+(512
     #.D0/3.D0*t655*t695+512.D0/3.D0*t655*t698)*t77+(512.D0/3.D0*t659*t6
     #95+512.D0/3.D0*t659*t698)*s34r)*s23r)*s1l2
      s2 = s4+(128.D0/3.D0*t712*t134*s3l1p*t21+128.D0/3.D0*t716*t424*t13
     #4*t97*s23r)*s1vr+(-96*t413*t725*t49+((288*t729+192*t731)*s2l1+(288
     #*t15+192*t18)*s2l2-96*t716*t23*t725*s34r-t745+96*t413*t76)*t21+((3
     #84*t750+96*t752)*s2l1+96*t32*t757+(-384*t760*t426-480*t763*t24*t6)
     #*s34r+(192*t771-192*t772)*s3l1p-192*t776)*s23r)*t9
      s4 = s2
      s8 = ((-192*t782+(t784-192*t94*t2*t39)*s23r)*t9+(-192*t793+(-1152*
     #t582+192*t797*t2*t39)*t21+(-960*t79+384*t674*l3*t37*t581)*s23r+384
     #*t111*t688)*s1vr)*s1l2-96*t818+((96*t820-384*t729+96*t731)*t21+(t8
     #27*s2l2+(-t831-192*t834)*s34r+192*t839*t142-t842)*s23r-288*t845+19
     #2*t606*t134)*t9+((-384*t820+384*t729+384*t731)*t49+(t859*s2l2+(960
     #*t830+960*t834)*s34r+288*t864-96*t867*t146)*t21+(t882*s2l2+(576*t8
     #86+576*t889)*t77+(96*t895*t142-96*t900*t146)*s34r+96*t907*t134+96*
     #t912*t299)*s23r+96*t920*t535+(384*t155-t160)*t77+(-96*t919*t166-t1
     #73)*s34r)*s1vr+(192*t933*t139-192*t63*t936-192*t63*t939)*t49
      s7 = s8+(t950*s2l2+(-192*t133*t952*s3l2p-192*t133*t866*s4l2p*t6)*s
     #34r-192*t606*t936-192*t606*t939)*t21+(t976*s2l2+(-192*t655*t978*s3
     #l2p-192*t655*t967*s4l2p*t6)*t77+(-192*t659*t987*s3l2p-192*t659*t79
     #7*s4l2p*t6)*s34r)*s23r+t1003*s2l2+192*t265*t282+(-192*t1008-192*t1
     #11*z*s4l2p*t6)*t77
      s8 = s1l1
      s6 = s7*s8
      s9 = ((-896.D0/3.D0*t782+(-896.D0/3.D0*t582-t1019)*s23r)*t9+(896.D
     #0/3.D0*t793+(1792.D0/3.D0*t582+t1019)*t21+(896.D0/3.D0*t79+1024.D0
     #/3.D0*t1029*t584*s34r)*s23r)*s1vr)*s1l2-64.D0/3.D0*t818+((-t1040+6
     #40.D0/3.D0*t729+t1042)*t21+(t587*s2l2+(640.D0/3.D0*t830+512.D0/3.D
     #0*t834)*s34r+448.D0/3.D0*t478*t166-64.D0/3.D0*t63*t596*s4l2p*t6)*s
     #23r-512.D0/3.D0*t133*t1058-512.D0/3.D0*t606*t299)*t9
      s8 = s9+((t1040-t1065-t1042)*t49+(t616*s2l2+(-t831-1024.D0/3.D0*t8
     #34)*s34r+64.D0/3.D0*t623*t142)*t21+(t631*s2l2+(-192*t886-512.D0/3.
     #D0*t889)*t77+(64.D0/3.D0*t641*t142+512.D0/3.D0*t147)*s34r+t1087+51
     #2.D0/3.D0*t650*t299)*s23r+512.D0/3.D0*t655*t299*t77+512.D0/3.D0*t6
     #59*t1058)*s1vr+(512.D0/3.D0*t63*t152-512.D0/3.D0*t665*t134-512.D0/
     #3.D0*t772)*t49+(t672*s2l2+(512.D0/3.D0*t133*t675*s3l2p+512.D0/3.D0
     #*t133*t674*s4l2p*t6)*s34r-t1087-512.D0/3.D0*t593*t299)*t21+(t692*s
     #2l2+(512.D0/3.D0*t655*t1118+512.D0/3.D0*t655*t1121)*t77+(512.D0/3.
     #D0*t659*t1118+512.D0/3.D0*t659*t1121)*s34r)*s23r
      s9 = s1l1
      s7 = s8*s9
      s5 = s6+s7
      s3 = s4+s5
      s4 = s3+(-96*(-6+t1135-t905)*t2*z*t39*t21+((-96*t1143*t134-192*t17
     #1)*s2l1+(-96*t1143*t14-192*t334)*s2l2-96*(-8+t1135)*t23*z*t63*t26+
     #(192*(4-t1160+t910)*t37*t134+96*t1165*t299)*s3l1p+96*t1165*t450-38
     #4*t170*t17)*s23r+(-384*t138*t535+(576*t24*t134-t465)*s34r)*s2l1+(5
     #76*t24*t14-t471)*s34r*s2l2+192*t1189*t487*t77+((384*t797*t23*t488+
     #384*t491)*s3l1p+t496)*s34r)*s1vr
      s5 = s4
      s7 = (((-192*t1203+288*t538)*t9+((864*t1203-1344*t538-576*t540)*s2
     #3r+288*t1214+(-480*t1216-192*t1218)*s34r)*s1vr+768*t1224*t21+(-768
     #*t1214+768*t1228*s34r)*s23r-192*t1235+192*t1240*t77)*s1l1+((-192*t
     #1245+288*t546)*t9+((864*t1245-1344*t546-576*t548)*s23r+288*t1255+(
     #-480*t1257-192*t1259)*s34r)*s1vr+768*t1265*t21+(-768*t1255+768*t12
     #69*s34r)*s23r-192*t1275+192*t1279*t77)*s1l2+384*t1189*t487*t10+(-8
     #64*t1189*t487*s23r+96*t1290+96*t1292-768*t1295+(-384*t1297-192*t56
     #1)*s3l1p-192*t565)*t9+(768*t1189*t487*t21+(-384*t1290-384*t1292+86
     #4*t1295+(768*t1297+384*t561)*s3l1p+384*t565)*s23r-192*t1318*t1319*
     #s2l1-192*t1318*t97*s2l2+384*t478*t89*t279*t6*t77+((384*t298+192*t3
     #00)*s3l1p+192*t216*t450)*s34r)*s1vr)*t1342
      s8 = (((-512.D0/3.D0*t538+512.D0/3.D0*t540)*t9+((-1024.D0/3.D0*t12
     #03+512*t538+t1349)*s23r-512.D0/3.D0*t1214+1024.D0/3.D0*t285*t224)*
     #s1vr-1024.D0/3.D0*t1224*t21+(512*t1214-512*t1228*s34r)*s23r+512.D0
     #/3.D0*t1235-512.D0/3.D0*t1240*t77)*s1l1+((-512.D0/3.D0*t546+512.D0
     #/3.D0*t548)*t9+((-1024.D0/3.D0*t1245+512*t546+t1377)*s23r-512.D0/3
     #.D0*t1255+1024.D0/3.D0*t285*t33)*s1vr-1024.D0/3.D0*t1265*t21+(512*
     #t1255-512*t1269*s34r)*s23r+512.D0/3.D0*t1275-512.D0/3.D0*t1279*t77
     #)*s1l2)*t1342
      s6 = s7+s8
      s1 = s5+s6
      s3 = s1+(128.D0/3.D0*t1402*t1403*t21+(128.D0/3.D0*t760*t1407-128.D
     #0/3.D0*t712*t426)*s23r)*t9
      s4 = s3+(((-t1415-t1416)*s23r*t9+((t1415-t144-t1416)*t21+96*t655*t
     #299*t1422)*s1vr)*s1l1+((-t1430-t1431)*s23r*t9+((t1430-t313-t1431)*
     #t21+96*t655*t17*t1422)*s1vr)*s1l2+288*t1446+(-t433+((-t144-t178)*s
     #2l1+(-t313-t341)*s2l2-576*t439+t1454*s3l1p-t452)*s23r)*t9+(384*t14
     #62+(-192*t419-192*t422+672*t439-t1454*s3l1p+t452)*t21+((-384*t119*
     #t535+192*t655*t1058)*s2l1+192*t655*t17*t756+288*t1481+((384*t1484+
     #192*t1486)*s3l1p+192*t1490)*s34r)*s23r)*s1vr)*s13r
      s2 = s4+(96*(-9+t200)*t37*t4*t1503+((-96*t1507*t142-192*t63*t299)*
     #s2l1+(-96*t1507*t40-192*t63*t17)*s2l2-864*t414*t76*s34r+(192*(-5+t
     #897)*t3*t142-288*t772)*s3l1p-288*t776+384*t2*t1*t478*t6)*s23r+(-38
     #4*t1029*t535+576*t845+96*t1541*t134)*s2l1+(576*t1546+96*t1541*t14)
     #*s2l2-1152*t425*t1407+192*(-4+t1160)*t37*t426)*t9-128.D0/3.D0*t140
     #2*t1403*t1444
      s4 = s2
      s6 = (96*t1564+384*t1402*t1403*s23r)*t10
      s10 = ((1024.D0/3.D0*t1029*t6*s23r*t9+(-1024.D0/3.D0*t117-1024.D0/
     #3.D0*t121)*s1vr)*s1l2+((t1415-64.D0/3.D0*t143-1088.D0/3.D0*t147)*s
     #23r+(512.D0/3.D0*t155-512.D0/3.D0*t159)*s34r+512.D0/3.D0*t593*t829
     #-512.D0/3.D0*t491)*t9+((448.D0/3.D0*t140-320*t143+64.D0/3.D0*t147)
     #*t21+(t1602*s2l2+(-1984.D0/3.D0*t155+64.D0/3.D0*t159)*s34r+512.D0/
     #3.D0*t138*t1610-1024.D0/3.D0*t172)*s23r+t1619*s2l2-1024.D0/3.D0*t2
     #19+(-1024.D0/3.D0*t1008-t1349)*s34r)*s1vr-1024.D0/3.D0*t229*t49+(t
     #1631*s2l2-2560.D0/3.D0*t239*s34r+512.D0/3.D0*t138*t1599*s3l2p+512.
     #D0/3.D0*t138*t1598*s4l2p*t6)*t21+(t1650*s2l2-2048.D0/3.D0*t265*t77
     #+(-512.D0/3.D0*t111*t1610-512.D0/3.D0*t111*t1608*s4l2p*t6)*s34r)*s
     #23r+t1667*s2l2-512.D0/3.D0*t295*t282+(512.D0/3.D0*t1672*t441+512.D
     #0/3.D0*t1672*t445)*t77)*s1l1
      s11 = (((t1430-64.D0/3.D0*t312-1088.D0/3.D0*t314)*s23r+(512.D0/3.D
     #0*t322-512.D0/3.D0*t326)*s34r+512.D0/3.D0*t593*t107*s3l1p-512.D0/3
     #.D0*t24*t17)*t9+((448.D0/3.D0*t310-320*t312+64.D0/3.D0*t314)*t21+(
     #t1602*s2l1+(-1984.D0/3.D0*t322+64.D0/3.D0*t326)*s34r+512.D0/3.D0*t
     #138*t1704-1024.D0/3.D0*t335)*s23r+t1619*s2l1-1024.D0/3.D0*t359+(-1
     #024.D0/3.D0*t1713-t1377)*s34r)*s1vr-1024.D0/3.D0*t365*t49+(t1631*s
     #2l1-2560.D0/3.D0*t369*s34r+512.D0/3.D0*t138*t1599*s3l1p+512.D0/3.D
     #0*t138*t1598*s4l1p*t6)*t21+(t1650*s2l1-2048.D0/3.D0*t387*t77+(-512
     #.D0/3.D0*t111*t1704-512.D0/3.D0*t111*t1608*s4l1p*t6)*s34r)*s23r+t1
     #667*s2l1-512.D0/3.D0*t403*t282+(512.D0/3.D0*t1672*t53+512.D0/3.D0*
     #t1672*t31*s4l1p*t6)*t77)*s1l2
      s9 = s10+s11
      s8 = s9-128.D0/3.D0*t1446+(256.D0/3.D0*t432+(-t1763-t1764+t1765+t1
     #768*s3l1p+t1770)*s23r)*t9+(-128.D0/3.D0*t1462+(t1763+t1764-t1765-t
     #1768*s3l1p-t1770)*t21+(64.D0/3.D0*t655*t134*s34r*s2l1+64.D0/3.D0*t
     #655*t757-128.D0/3.D0*t1481+((-128.D0/3.D0*t1484-64.D0/3.D0*t1486)*
     #s3l1p-64.D0/3.D0*t1490)*s34r)*s23r)*s1vr
      s9 = s13r
      s7 = s8*s9
      s5 = s6+s7
      s3 = s4+s5
      s4 = s3+(((-384*t782+192*t25*t120)*t9+(384*t793+192*t25*t26*t21-19
     #2*t75*t4*t286*s23r)*s1vr)*s1l2+192*t818+((-t1065+288*t731)*t21+(48
     #0*t750-384*t752-96*t38*t142)*s23r)*t9+((96*t729-96*t731)*t49+(-288
     #*t750+(288*t830-96*t834)*s34r-192*t864+96*t67*t146)*t21+(t86*s2l2+
     #192*t90*t218+96*t96*t39*t1319)*s23r)*s1vr)*s1l1
      s5 = s4+(-96*t413*t76*t49+((-96*t1857*t142+t842)*s2l1+(-96*t1857*t
     #40+t1864)*s2l2+96*t221*z*t23*t5*t26+(-192*t771+480*t772)*s3l1p+480
     #*t776+384*t665*s4l2p*s4l1p*t6)*t21+((384*t133*t535+(96*t442+t178)*
     #s34r)*s2l1+(96*t56*t40+t341)*s34r*s2l2+480*t437*t52*t77+((-192*t77
     #0*t23*t441+288*t446)*s3l1p+288*t451)*s34r)*s23r)*s1vr
      s6 = s5
      s8 = (288*t1564+(-288*t5*t418-288*t5*t421+t745+384*t574*t584)*s23r
     #-192*t63*t418-192*t63*t421+960*t665*t426)*t10
      s11 = -96*t12+((96*t575-384*t15+96*t18)*t21+(t827*s2l1+(-t618-192*
     #t59)*s34r+192*t839*t40-t1864)*s23r-288*t1546+192*t606*t14)*t9+((-3
     #84*t575+384*t15+384*t18)*t49+(t859*s2l1+(960*t54+960*t59)*s34r+288
     #*t64-96*t867*t69)*t21+(t882*s2l1+(576*t633+576*t636)*t77+(96*t895*
     #t40-96*t900*t69)*s34r+96*t907*t14+96*t912*t17)*s23r+96*t920*t27+(3
     #84*t322-t327)*t77+(-96*t919*t330-t336)*s34r)*s1vr+(192*t933*t309-1
     #92*t63*t1987-192*t63*t1990)*t49
      s10 = s11+(t950*s2l1+(-192*t133*t952*s3l1p-192*t133*t866*s4l1p*t6)
     #*s34r-192*t606*t1987-192*t606*t1990)*t21+(t976*s2l1+(-192*t655*t97
     #8*s3l1p-192*t655*t967*s4l1p*t6)*t77+(-192*t659*t987*s3l1p-192*t659
     #*t797*s4l1p*t6)*s34r)*s23r+t1003*s2l1+192*t387*t282+(-192*t1713-19
     #2*t111*z*s4l1p*t6)*t77
      s11 = s1l2
      s9 = s10*s11
      s7 = s8+s9
      taux11 = s6+s7
      t1 = -1+z
      t2 = t1**2
      t3 = t2**2
      t4 = l3-1
      t5 = t4**2
      t6 = t3*t5
      t7 = 1/s3vr
      t8 = t7*s3l2p
      t9 = t6*t8
      t10 = s4l2p*t7
      t11 = t6*t10
      t14 = s1vr**2
      t16 = t2*t1
      t17 = t16*t5
      t18 = t7*s2l2
      t19 = t17*t18
      t22 = 2048.D0/3.D0*t11
      t25 = t4*t5
      t26 = t3*t25
      t27 = t7*s34r
      t28 = t27*s2l2
      t29 = t26*t28
      t31 = t3*t1
      t32 = t31*t25
      t33 = t8*s34r
      t38 = t19-t9-t11
      t40 = s23r**2
      t43 = t32*t8
      t44 = t32*t10
      t45 = -t43-t44
      t50 = t5**2
      t51 = t31*t50
      t52 = s34r**2
      t53 = t7*t52
      t55 = t51*t53*s2l2
      t57 = t3*t2
      t58 = t50*t57
      t61 = -t58*t8-t58*t10
      t66 = t7*s3l1p
      t67 = t6*t66
      t68 = s4l1p*t7
      t69 = t6*t68
      t73 = t7*s2l1
      t74 = t17*t73
      t77 = 2048.D0/3.D0*t69
      t80 = t27*s2l1
      t81 = t26*t80
      t83 = t66*s34r
      t88 = -t74+t67+t69
      t92 = t32*t66
      t93 = t32*t68
      t94 = t92+t93
      t100 = t51*t53*s2l1
      t104 = t58*t66+t58*t68
      t110 = s13r**2
      t112 = t4*t16
      t113 = l3*t7
      t114 = t113*s2l2
      t115 = t112*t114
      t117 = t3*t4
      t118 = t113*s3l2p
      t119 = t117*t118
      t122 = l3*s4l2p*t7
      t123 = t117*t122
      t127 = t31*t5
      t128 = t127*t118
      t129 = l3*t31
      t132 = t129*t5*s4l2p*t7
      t136 = z*t16
      t137 = t4*t7
      t138 = t137*s3l2p
      t145 = -t4
      t147 = 7*t145*t16
      t150 = 15*t145*t3
      t155 = t113*s34r
      t156 = t6*t155
      t158 = t2*t4
      t159 = 3*z
      t160 = -1+t159
      t161 = t160*t7
      t163 = 2048.D0/3.D0*t158*t161
      t164 = 1280*t156+t163
      t171 = 1-4*z
      t172 = t171*t7
      t173 = t172*s3l2p
      t176 = z*t4
      t178 = t16*s4l2p*t7
      t179 = t176*t178
      t185 = t129*t25*t7*t52
      t186 = z*t5
      t187 = t16*t7
      t188 = t187*s34r
      t191 = 2048.D0/3.D0*t185+2048.D0/3.D0*t186*t188
      t193 = t25*t57
      t194 = t193*l3
      t195 = t8*t52
      t196 = t194*t195
      t198 = z*t7
      t200 = t6*t198*s3l2p
      t206 = -t115+t119+t123
      t208 = t40*s23r
      t211 = -10240.D0/3.D0*t156-t163
      t213 = t128+t132
      t230 = -8192.D0/3.D0*t185+2048.D0/3.D0*t171*t5*t188
      t233 = l3*t25
      t237 = t193*t118+t233*t57*s4l2p*t7
      t250 = t57*t7
      t251 = t52*s34r
      t253 = l3*t50*t250*t251
      t257 = -2048.D0/3.D0*t253-2048.D0/3.D0*t26*t198*t52
      t260 = t50*t3*t16
      t263 = t260*t118+t260*t122
      t266 = z*t25
      t267 = t31*t7
      t278 = t113*s2l1
      t279 = t112*t278
      t281 = t113*s3l1p
      t282 = t117*t281
      t285 = l3*s4l1p*t7
      t286 = t117*t285
      t290 = t5*t7
      t292 = t129*t290*s3l1p
      t294 = t5*s4l1p*t7
      t295 = t129*t294
      t317 = t172*s3l1p
      t321 = t16*s4l1p*t7
      t322 = t176*t321
      t328 = t66*t52
      t329 = t194*t328
      t332 = t6*t198*s3l1p
      t338 = t279-t282-t286
      t343 = -t292-t295
      t357 = t250*s3l1p
      t362 = -t233*t357-t233*t57*s4l1p*t7
      t378 = -t260*t281-t260*t285
      t381 = t267*s3l1p
      t391 = t117*l3
      t392 = t8*s2l1
      t393 = t391*t392
      t394 = t66*s2l2
      t395 = t391*t394
      t397 = t4*l3*t31
      t398 = t10*s3l1p
      t399 = t397*t398
      t400 = t68*s3l2p
      t401 = t397*t400
      t403 = -256.D0/3.D0*t393+256.D0/3.D0*t395-256.D0/3.D0*t399+256.D0/
     #3.D0*t401
      t408 = t127*l3
      t409 = s34r*s2l1
      t413 = s34r*s2l2
      t418 = l3*t5*t57
      t421 = t418*t398-t418*t400
      t430 = l3**2
      t431 = t430*t3
      t432 = t431*t7
      t434 = t14*s1vr
      t436 = t432*s3l2p*s23r*t434
      t438 = t16*t430
      t439 = t438*t18
      t440 = 2048.D0/3.D0*t439
      t441 = t431*t8
      t443 = t431*t10
      t444 = 2048.D0/3.D0*t443
      t447 = 8*t145
      t449 = t430*t7
      t450 = t449*s34r
      t453 = l3*t2
      t454 = t453*t198
      t456 = 256.D0/3.D0*t447*t3*t450-2048.D0/3.D0*t454
      t459 = 6*t145*t31
      t460 = t449*s3l2p
      t462 = t447*t31
      t464 = t430*s4l2p*t7
      t465 = t462*t464
      t470 = t187*s3l2p
      t471 = z*l3*t470
      t473 = l3*t16
      t474 = 8*t1
      t481 = t10*s34r
      t484 = z*t2
      t498 = -4096.D0/3.D0*t145*t3*t450+2048.D0/3.D0*t453*t7
      t501 = 14*t145*t31
      t507 = -8+z
      t508 = t507*t16
      t514 = t127*t449*t52
      t519 = t484*t7
      t521 = 2048.D0/3.D0*t514-256.D0/3.D0*t447*t16*t155-2048.D0/3.D0*t5
     #19
      t523 = t5*t57
      t524 = t523*t460
      t526 = t523*t464
      t531 = t507*t4*t3
      t534 = -t447*t3
      t540 = 2048.D0/3.D0*t136*t8
      t541 = z**2
      t542 = t541*t2
      t550 = t176*t16
      t556 = t3*l3
      t558 = t556*t10
      t562 = 2*t1
      t563 = t562*t4
      t565 = t563*t16*t155
      t567 = 2048.D0/3.D0*t565+2048.D0/3.D0*t519
      t569 = -t562
      t570 = t569*t7
      t583 = t113*t52
      t585 = t137*s34r
      t588 = 2048.D0/3.D0*t127*t583+2048.D0/3.D0*t136*t585
      t590 = -t1
      t591 = t590*t7
      t592 = t591*s3l2p
      t595 = t590*s4l2p*t7
      t611 = t432*s3l1p*s23r*t434
      t613 = t438*t73
      t614 = 2048.D0/3.D0*t613
      t615 = t431*t66
      t617 = t431*t68
      t618 = 2048.D0/3.D0*t617
      t623 = t449*s3l1p
      t626 = t430*s4l1p*t7
      t627 = t462*t626
      t631 = t136*t281
      t639 = t68*s34r
      t663 = t430*t5*t357
      t666 = t430*t57*t294
      t676 = 2048.D0/3.D0*t136*t66
      t690 = t556*t68
      t710 = t591*s3l1p
      t713 = t590*s4l1p*t7
      t727 = 2*t145
      t728 = t727*t16
      t734 = -t727
      t735 = t734*t16
      t740 = s34r*s23r
      t765 = 1152*t123
      t769 = 1152*t286
      t772 = 768*t399
      t773 = 768*t401
      t806 = 768*t443
      t809 = t31*t4
      t810 = t809*t430
      t811 = t810*t33
      t813 = t590*t16
      t824 = t734*t3*t430
      t828 = t473*t8
      t830 = t562*t16
      t837 = 768*t514+384*t565
      t839 = t523*t430
      t842 = 2-z
      t844 = t842*t3*t4
      t845 = s3l2p*s34r
      t857 = 768*t617
      t878 = t473*t66
      t888 = s3l1p*s34r
      t912 = t813*l3
      t925 = t569*t16
      t1017 = t127*t398
      t1019 = t127*t400
      t1035 = t32*t7
      t1060 = 768*t213
      t1063 = (2+z)*t4
      t1066 = 768*t179
      t1076 = (-8*z+5)*t4
      t1077 = t2*t7
      t1087 = (3-13*z)*t7
      t1091 = 6*z
      t1092 = -3-t1091
      t1099 = 4-z
      t1101 = t290*s34r
      t1104 = -384*t185+384*t1099*t16*t1101
      t1109 = (6-z)*t3*t5
      t1118 = 3-t1091
      t1122 = 6144*t156-768*t1118*t4*t1077
      t1127 = t1118*t7
      t1139 = 2-7*z
      t1143 = 3840*t185-768*t1139*t16*t1101
      t1145 = -t237
      t1148 = t1139*t7
      t1161 = 768*t253+768*t32*t53
      t1182 = 768*t343
      t1184 = t187*s3l1p
      t1187 = 768*t322
      t1237 = -t362
      t1273 = t842*t4
      t1284 = t727*t3
      t1291 = t1099*t4
      t1294 = (-6+t159)*t4
      t1304 = t563*t3
      t1333 = t431*t585
      t1335 = 384*t1333+384*t454
      t1337 = t430*t31
      t1338 = t1337*t138
      t1342 = t1337*t4*s4l2p*t7
      t1347 = -1-z
      t1348 = 2*t1347
      t1349 = t1348*t16
      t1364 = 3*t1347
      t1368 = -3840*t1333+384*t1364*t2*t113
      t1374 = (5+z)*t16
      t1377 = 2*z
      t1379 = (-1-t1377)*t16
      t1395 = -2304*t514+384*(-5*z-1)*l3*t16*t585-384*(3-z)*t1*t198
      t1402 = -t1364*t3*t4
      t1405 = t171*t3*t4
      t1412 = (2+t159-3*t541)*t2
      t1417 = (2-z-2*t541)*t2
      t1425 = -t1348*t4
      t1426 = t1077*s34r
      t1429 = 768*t583*t6+384*t1425*t1426
      t1439 = 3-t1377
      t1440 = t1439*t2
      t1442 = t1439*t7
      t1443 = t1442*s3l2p
      t1446 = t1439*s4l2p*t7
      t1451 = 5*t590
      t1458 = 768*t1451*l3*t16*t585+768*t1439*t1*t198
      t1460 = t1451*t7
      t1475 = 3*t590
      t1479 = 2-t159
      t1484 = 768*t1475*t3*t5*t583+768*t1479*z*t4*t1426
      t1486 = t1475*t7
      t1495 = t1479*t7
      t1511 = 768*t233*t267*t251+768*t186*t187*t52
      t1531 = t430*t4*t381
      t1533 = t809*t626
      t1589 = t1442*s3l1p
      t1592 = t1439*s4l1p*t7
      t1660 = t562*t2
      s4 = (((-2048.D0/3.D0*t9+2048.D0/3.D0*t11)*t14+((-4096.D0/3.D0*t19
     #+2048*t9+t22)*s23r-2048.D0/3.D0*t29+4096.D0/3.D0*t32*t33)*s1vr+409
     #6.D0/3.D0*t38*t40+(2048*t29+2048*t45*s34r)*s23r+2048.D0/3.D0*t55+2
     #048.D0/3.D0*t61*t52)*s1l1+((2048.D0/3.D0*t67-2048.D0/3.D0*t69)*t14
     #+((4096.D0/3.D0*t74-2048*t67-t77)*s23r+2048.D0/3.D0*t81-4096.D0/3.
     #D0*t32*t83)*s1vr+4096.D0/3.D0*t88*t40+(-2048*t81+2048*t94*s34r)*s2
     #3r-2048.D0/3.D0*t100+2048.D0/3.D0*t104*t52)*s1l2)*t110
      s8 = (((768*t115-256.D0/3.D0*t119-4352.D0/3.D0*t123)*s23r+(2048.D0
     #/3.D0*t128-2048.D0/3.D0*t132)*s34r+2048.D0/3.D0*t136*t138-2048.D0/
     #3.D0*t117*t10)*t14+((-256.D0/3.D0*t147*t114+256.D0/3.D0*t150*t118+
     #256.D0/3.D0*t123)*t40+(t164*s2l2+(-7936.D0/3.D0*t128+256.D0/3.D0*t
     #132)*s34r+2048.D0/3.D0*t112*t173-4096.D0/3.D0*t179)*s23r+t191*s2l2
     #-4096.D0/3.D0*t196+(-4096.D0/3.D0*t200-t22)*s34r)*s1vr+4096.D0/3.D
     #0*t206*t208+(t211*s2l2+10240.D0/3.D0*t213*s34r+2048.D0/3.D0*t112*t
     #161*s3l2p+2048.D0/3.D0*t112*t160*s4l2p*t7)*t40+(t230*s2l2+8192.D0/
     #3.D0*t237*t52+(-2048.D0/3.D0*t6*t173-2048.D0/3.D0*t6*t171*s4l2p*t7
     #)*s34r)*s23r+t257*s2l2+2048.D0/3.D0*t263*t251+(2048.D0/3.D0*t266*t
     #267*s3l2p+2048.D0/3.D0*t266*t31*s4l2p*t7)*t52)*s1l1
      s9 = (((-768*t279+256.D0/3.D0*t282+4352.D0/3.D0*t286)*s23r+(-2048.
     #D0/3.D0*t292+2048.D0/3.D0*t295)*s34r-2048.D0/3.D0*t136*t137*s3l1p+
     #2048.D0/3.D0*t117*t68)*t14+((256.D0/3.D0*t147*t278-256.D0/3.D0*t15
     #0*t281-256.D0/3.D0*t286)*t40+(-t164*s2l1+(7936.D0/3.D0*t292-256.D0
     #/3.D0*t295)*s34r-2048.D0/3.D0*t112*t317+4096.D0/3.D0*t322)*s23r-t1
     #91*s2l1+4096.D0/3.D0*t329+(4096.D0/3.D0*t332+t77)*s34r)*s1vr+4096.
     #D0/3.D0*t338*t208+(-t211*s2l1+10240.D0/3.D0*t343*s34r-2048.D0/3.D0
     #*t112*t161*s3l1p-2048.D0/3.D0*t112*t160*s4l1p*t7)*t40+(-t230*s2l1+
     #8192.D0/3.D0*t362*t52+(2048.D0/3.D0*t6*t317+2048.D0/3.D0*t6*t171*s
     #4l1p*t7)*s34r)*s23r-t257*s2l1+2048.D0/3.D0*t378*t251+(-2048.D0/3.D
     #0*t266*t381-2048.D0/3.D0*t266*t31*s4l1p*t7)*t52)*s1l2
      s7 = s8+s9
      s6 = s7+t403*s23r*t14+(-t403*t40+(256.D0/3.D0*t408*t8*t409-256.D0/
     #3.D0*t408*t66*t413+256.D0/3.D0*t421*s34r)*s23r)*s1vr
      s7 = s13r
      s5 = s6*s7
      s3 = s4+s5
      s4 = s3
      s8 = 256.D0/3.D0*t436+((-t440+512*t441+t444)*t40+(t456*s2l2+(-256.
     #D0/3.D0*t459*t460-256.D0/3.D0*t465)*s34r+1792.D0/3.D0*t471+256.D0/
     #3.D0*t473*t474*s4l2p*t7)*s23r-2048.D0/3.D0*t391*t481-2048.D0/3.D0*
     #t484*t10)*t14+((t440-1792.D0/3.D0*t441-t444)*t208+(t498*s2l2+(256.
     #D0/3.D0*t501*t460+512.D0/3.D0*t465)*s34r+256.D0/3.D0*t508*t118)*t4
     #0+(t521*s2l2+(-1792.D0/3.D0*t524-2048.D0/3.D0*t526)*t52+(256.D0/3.
     #D0*t531*t118+256.D0/3.D0*t534*t122)*s34r+t540+2048.D0/3.D0*t542*t1
     #0)*s23r+2048.D0/3.D0*t408*t10*t52+2048.D0/3.D0*t550*t481)*s1vr
      s7 = s8+(2048.D0/3.D0*t473*t18-2048.D0/3.D0*t556*t8-2048.D0/3.D0*t
     #558)*t208+(t567*s2l2+(2048.D0/3.D0*t391*t570*s3l2p+2048.D0/3.D0*t3
     #91*t569*s4l2p*t7)*s34r-t540-2048.D0/3.D0*t136*t10)*t40+(t588*s2l2+
     #(2048.D0/3.D0*t408*t592+2048.D0/3.D0*t408*t595)*t52+(2048.D0/3.D0*
     #t550*t592+2048.D0/3.D0*t550*t595)*s34r)*s23r
      s8 = s1l1
      s6 = s7*s8
      s9 = -256.D0/3.D0*t611+((t614-512*t615-t618)*t40+(-t456*s2l1+(256.
     #D0/3.D0*t459*t623+256.D0/3.D0*t627)*s34r-1792.D0/3.D0*t631-256.D0/
     #3.D0*t473*t474*s4l1p*t7)*s23r+2048.D0/3.D0*t391*t639+2048.D0/3.D0*
     #t484*t68)*t14+((-t614+1792.D0/3.D0*t615+t618)*t208+(-t498*s2l1+(-2
     #56.D0/3.D0*t501*t623-512.D0/3.D0*t627)*s34r-256.D0/3.D0*t508*t281)
     #*t40+(-t521*s2l1+(1792.D0/3.D0*t663+2048.D0/3.D0*t666)*t52+(-256.D
     #0/3.D0*t531*t281-256.D0/3.D0*t534*t285)*s34r-t676-2048.D0/3.D0*t54
     #2*t68)*s23r-2048.D0/3.D0*t408*t68*t52-2048.D0/3.D0*t550*t639)*s1vr
      s8 = s9+(-2048.D0/3.D0*t473*t73+2048.D0/3.D0*t556*t66+2048.D0/3.D0
     #*t690)*t208+(-t567*s2l1+(-2048.D0/3.D0*t391*t570*s3l1p-2048.D0/3.D
     #0*t391*t569*s4l1p*t7)*s34r+t676+2048.D0/3.D0*t136*t68)*t40+(-t588*
     #s2l1+(-2048.D0/3.D0*t408*t710-2048.D0/3.D0*t408*t713)*t52+(-2048.D
     #0/3.D0*t550*t710-2048.D0/3.D0*t550*t713)*s34r)*s23r
      s9 = s1l2
      s7 = s8*s9
      s5 = s6+s7
      s2 = s4+s5
      s3 = s2+(((384*t728*t114-384*t123)*s23r*t14+((384*t735*t114-384*t1
     #19-384*t123)*t40+384*t408*t10*t740)*s1vr)*s1l1+((-384*t728*t278+38
     #4*t286)*s23r*t14+((-384*t735*t278+384*t282+384*t286)*t40-384*t408*
     #t68*t740)*s1vr)*s1l2+((-768*t119-t765)*s2l1+(768*t282+t769)*s2l2+t
     #772-t773)*s23r*t14+(((-384*t119+384*t123)*s2l1+(384*t282-384*t286)
     #*s2l2-t772+t773)*t40+((384*t128+1152*t132)*s34r*s2l1+(-384*t292-11
     #52*t295)*s34r*s2l2-768*t421*s34r)*s23r)*s1vr)*s13r
      s1 = s3+(-384*t436+((1536*t441+t806)*t40+(768*t811-384*t813*t118)*
     #s23r)*t14+(-768*t431*t8*t208+(384*t824*t28-1152*t811-768*t828+384*
     #t830*t122)*t40+(t837*s2l2-384*t839*t195+384*t844*t113*t845)*s23r)*
     #s1vr)*s1l1+(384*t611+((-1536*t615-t857)*t40+(-768*t810*t83+384*t81
     #3*t281)*s23r)*t14+(768*t431*t66*t208+(-384*t824*t80+1152*t31*t4*t4
     #30*t83+768*t878-384*t830*t285)*t40+(-t837*s2l1+384*t839*t328-384*t
     #844*t113*t888)*s23r)*s1vr)*s1l2+(384*t431*t392-384*t431*t394)*s23r
     #*t434
      s3 = s1+(((768*t441+768*t443)*s2l1+(-768*t615-768*t617)*s2l2)*t40+
     #(-384*t912*t392+384*t912*t394-1152*t556*t398+1152*t556*t400)*s23r)
     #*t14
      s4 = s3+(((-384*t925*t118+768*t558)*s2l1+(384*t925*t281-768*t690)*
     #s2l2)*t40+(-768*t391*t10*t409+768*t391*t68*t413+(768*t399-768*t401
     #)*s34r)*s23r)*s1vr
      s5 = s4
      s7 = (((-768*t19+1152*t9)*t14+((3456*t19-5376*t9-2304*t11)*s23r+11
     #52*t29+(-1920*t43-768*t44)*s34r)*s1vr-3072*t38*t40+(-3072*t29-3072
     #*t45*s34r)*s23r-768*t55-768*t61*t52)*s1l1+((768*t74-1152*t67)*t14+
     #((-3456*t74+5376*t67+2304*t69)*s23r-1152*t81+(1920*t92+768*t93)*s3
     #4r)*s1vr-3072*t88*t40+(3072*t81-3072*t94*s34r)*s23r+768*t100-768*t
     #104*t52)*s1l2+(384*t6*t392-384*t6*t394+768*t1017-768*t1019)*t14+((
     #(-384*t9+1152*t11)*s2l1+(384*t67-1152*t69)*s2l2-1536*t1017+1536*t1
     #019)*s23r-768*t1035*t845*s2l1+768*t1035*t888*s2l2+(-768*t193*t398+
     #768*t193*t400)*s34r)*s1vr)*t110
      s11 = (-384*t391*t8*t434+((-1152*t115+3072*t119+t765)*s23r-768*t15
     #8*t18+t1060*s34r+384*t1063*t470+t1066)*t14+((-384*t115+1920*t119+3
     #84*t123)*t40+(384*t1076*t1077*s2l2+(1536*t128-384*t132)*s34r-384*t
     #112*t1087*s3l2p-384*t112*t1092*s4l2p*t7)*s23r+t1104*s2l2+384*t196-
     #384*t1109*t33)*s1vr-3072*t206*t208+(t1122*s2l2-6144*t213*s34r+768*
     #t112*t1127*s3l2p+768*t112*t1118*s4l2p*t7)*t40+(t1143*s2l2+3840*t11
     #45*t52+(768*t6*t1148*s3l2p+768*t6*t1139*s4l2p*t7)*s34r)*s23r+t1161
     #*s2l2-768*t263*t251+(-768*t193*t8-768*t193*t10)*t52)*s1l1
      s12 = (384*t391*t66*t434+((1152*t279-3072*t282-t769)*s23r+768*t158
     #*t73+t1182*s34r-384*t1063*t1184-t1187)*t14+((384*t279-1920*t282-38
     #4*t286)*t40+(-384*t1076*t1077*s2l1+(-1536*t292+384*t295)*s34r+384*
     #t112*t1087*s3l1p+384*t112*t1092*s4l1p*t7)*s23r-t1104*s2l1-384*t329
     #+384*t1109*t83)*s1vr-3072*t338*t208+(-t1122*s2l1-6144*t343*s34r-76
     #8*t112*t1127*s3l1p-768*t112*t1118*s4l1p*t7)*t40+(-t1143*s2l1+3840*
     #t1237*t52+(-768*t6*t1148*s3l1p-768*t6*t1139*s4l1p*t7)*s34r)*s23r-t
     #1161*s2l1-768*t378*t251+(768*t193*t66+768*t193*t68)*t52)*s1l2
      s10 = s11+s12
      s9 = s10+(384*t393-384*t395)*t434+(((-384*t119-t765)*s2l1+(384*t28
     #2+t769)*s2l2+t772-t773)*s23r+(-384*t1273*t470+384*t728*t10)*s2l1+(
     #384*t1273*t1184-384*t728*t68)*s2l2-768*t1284*t398+768*t1284*t400)*
     #t14+(((384*t1291*t470-384*t1294*t178)*s2l1+(-384*t1291*t1184+384*t
     #1294*t321)*s2l2+384*t1304*t398-384*t1304*t400)*s23r+(-768*t9+1536*
     #t11)*s34r*s2l1+(768*t67-1536*t69)*s34r*s2l2+(-2304*t1017+2304*t101
     #9)*s34r)*s1vr
      s10 = s13r
      s8 = s9*s10
      s6 = s7+s8
      s2 = s5+s6
      s4 = s2
      s8 = -768*t436+((384*t439-1152*t441-t806)*t40+(t1335*s2l2+(-1152*t
     #1338-768*t1342)*s34r-1920*t471+384*t1349*t122)*s23r+1152*t391*t33+
     #768*t484*t8)*t14+((-1536*t439+1536*t441+1536*t443)*t208+(t1368*s2l
     #2+(3840*t1338+3840*t1342)*s34r+384*t1374*t118-384*t1379*t122)*t40+
     #(t1395*s2l2+(2304*t524+2304*t526)*t52+(384*t1402*t118-384*t1405*t1
     #22)*s34r+384*t1412*t8+384*t1417*t10)*s23r+t1429*s2l2-t1060*t52+(-3
     #84*t1425*t470-t1066)*s34r)*s1vr+(768*t1440*t114-768*t473*t1443-768
     #*t473*t1446)*t208
      s7 = s8+(t1458*s2l2+(-768*t391*t1460*s3l2p-768*t391*t1451*s4l2p*t7
     #)*s34r-768*t484*t1443-768*t484*t1446)*t40+(t1484*s2l2+(-768*t408*t
     #1486*s3l2p-768*t408*t1475*s4l2p*t7)*t52+(-768*t550*t1495*s3l2p-768
     #*t550*t1479*s4l2p*t7)*s34r)*s23r+t1511*s2l2+768*t1145*t251+(-768*t
     #200-768*t6*z*s4l2p*t7)*t52
      s8 = s1l1
      s6 = s7*s8
      s9 = 768*t611+((-384*t613+1152*t615+t857)*t40+(-t1335*s2l1+(1152*t
     #1531+768*t1533)*s34r+1920*t631-384*t1349*t285)*s23r-1152*t391*t83-
     #768*t484*t66)*t14+((1536*t613-1536*t615-1536*t617)*t208+(-t1368*s2
     #l1+(-3840*t1531-3840*t1533)*s34r-384*t1374*t281+384*t1379*t285)*t4
     #0+(-t1395*s2l1+(-2304*t663-2304*t666)*t52+(-384*t1402*t281+384*t14
     #05*t285)*s34r-384*t1412*t66-384*t1417*t68)*s23r-t1429*s2l1-t1182*t
     #52+(384*t1425*t1184+t1187)*s34r)*s1vr+(-768*t1440*t278+768*t473*t1
     #589+768*t473*t1592)*t208
      s8 = s9+(-t1458*s2l1+(768*t391*t1460*s3l1p+768*t391*t1451*s4l1p*t7
     #)*s34r+768*t484*t1589+768*t484*t1592)*t40+(-t1484*s2l1+(768*t408*t
     #1486*s3l1p+768*t408*t1475*s4l1p*t7)*t52+(768*t550*t1495*s3l1p+768*
     #t550*t1479*s4l1p*t7)*s34r)*s23r-t1511*s2l1+768*t1237*t251+(768*t33
     #2+768*t6*z*s4l1p*t7)*t52
      s9 = s1l2
      s7 = s8*s9
      s5 = s6+s7
      s3 = s4+s5
      taux12 = s3+(768*t473*t392-768*t473*t394)*t434+(((-768*t828-768*t4
     #73*t10)*s2l1+(768*t878+768*t473*t68)*s2l2)*s23r+384*t1660*t392-384
     #*t1660*t394)*t14+(((-384*t1660*t8-768*t178)*s2l1+(384*t1660*t66+76
     #8*t321)*s2l2)*s23r+768*t112*s4l2p*t80-768*t112*s4l1p*t28+(-768*t11
     #7*t398+768*t117*t400)*s34r)*s1vr

CCC Coefficients

      tcoff21 = taux11
      tcoff22 = taux11
      tcoff23 = taux12
      tcoff24 = taux12

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet21 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff21)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet22 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z
     #-t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff22)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet23 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff23)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet24 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z
     #-t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff24)

CCC Sum

      qgrmnum7e0 = tFjet21*tcoff21+tFjet22*tcoff22+tFjet23*tcoff23+tFjet
     #24*tcoff24
      RETURN
      END

      double precision function qgrmnum7e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = t1**2
      t3 = t2*t1
      t4 = l3**2
      t5 = t3*t4
      t6 = 1/s3vr
      t7 = t6*s23r
      t8 = s1vr**2
      t9 = t8*s1vr
      t11 = t5*t7*t9
      t13 = s23r**2
      t15 = t5*t6*t13
      t17 = t2**2
      t18 = t4*t17
      t19 = l3-1
      t20 = t19*t6
      t21 = t20*s34r
      t22 = t18*t21
      t24 = l3*t2
      t25 = z*t6
      t26 = t24*t25
      t27 = 1024.D0/3.D0*t26
      t32 = t13*s23r
      t34 = t5*t6*t32
      t36 = 768*t22
      t39 = t19**2
      t40 = t17*t1
      t41 = t39*t40
      t42 = t4*t6
      t43 = s34r**2
      t45 = t41*t42*t43
      t47 = t19*l3
      t48 = t47*t3
      t49 = t25*s34r
      t50 = t48*t49
      t58 = t6*s3l2p
      t59 = t8**2
      t63 = t6*s2l2
      t64 = t5*t63
      t66 = t18*t58
      t68 = s4l2p*t6
      t69 = t18*t68
      t73 = t18*t19
      t74 = t6*s34r
      t75 = t74*s2l2
      t76 = t73*t75
      t78 = t40*t19
      t79 = t78*t4
      t80 = t58*s34r
      t81 = t79*t80
      t83 = l3*t3
      t84 = t83*t58
      t94 = 3*z
      t99 = 896.D0/3.D0*t22+128.D0/3.D0*t24*(1+t94)*t6
      t101 = t4*t40
      t102 = t20*s3l2p
      t103 = t101*t102
      t105 = t19*s4l2p
      t106 = t105*t6
      t107 = t101*t106
      t111 = 8*z
      t113 = (-7+t111)*t3
      t114 = l3*t6
      t115 = t114*s3l2p
      t118 = -17+t111
      t126 = t19*t3
      t127 = t114*s34r
      t128 = t126*t127
      t130 = 128.D0/3.D0*t45+64*t128
      t132 = t17*t2
      t133 = t39*t132
      t134 = t133*t4
      t135 = t58*t43
      t136 = t134*t135
      t138 = -t19
      t139 = t138*t17
      t142 = t19*t17
      t143 = l3*s4l2p
      t144 = t143*t6
      t145 = t142*t144
      t149 = z*t2
      t166 = -1216.D0/3.D0*t22+128.D0/3.D0*(-5+z)*t2*t114
      t173 = 192*t83*t68
      t177 = 2*z
      t178 = 5-t177
      t183 = t149*t6
      t185 = -256*t45-64.D0/3.D0*t178*t19*t3*t127+512.D0/3.D0*t183
      t188 = t133*t42*s3l2p
      t192 = t133*t4*s4l2p*t6
      t196 = t142*t115
      t201 = z**2
      t202 = t201*t2
      t205 = -1-z
      t206 = t205*z
      t213 = t39*t19
      t215 = t132*t6
      t216 = t43*s34r
      t217 = t215*t216
      t220 = t39*t17
      t221 = t114*t43
      t222 = t220*t221
      t224 = t19*t2
      t227 = -64.D0/3.D0*t4*t213*t217+320.D0/3.D0*t222+512.D0/3.D0*t224*
     #t49
      t229 = t17*t3
      t231 = t213*t229*t4
      t235 = t41*t115
      t237 = l3*t40
      t240 = t237*t39*s4l2p*t6
      t244 = z*t3
      t247 = z*t19
      t248 = t3*s4l2p
      t249 = t248*t6
      t250 = t247*t249
      t257 = t17*l3
      t258 = t257*t58
      t259 = t257*t68
      t263 = 1-t177
      t268 = 512.D0/3.D0*t263*t19*t3*t127-512.D0/3.D0*t183
      t270 = t257*t19
      t271 = -t1
      t272 = 2*t271
      t275 = -t270+t257*t19*t272
      t276 = t275*t6
      t283 = t244*t58
      t289 = t205*t39
      t292 = t201*t19
      t293 = t2*t6
      t294 = t293*s34r
      t297 = 512.D0/3.D0*t289*t17*t221-512.D0/3.D0*t292*t294
      t299 = t41*l3
      t303 = -2*t299+t41*l3*t271
      t304 = t303*t6
      t311 = t244*t19
      t314 = -t311+t244*t19*t271
      t315 = t314*t6
      t324 = l3*t213
      t325 = t40*t6
      t326 = t325*t216
      t328 = z*t39
      t329 = t3*t6
      t332 = -t324*t326-t328*t329*t43
      t333 = 512.D0/3.D0*t332
      t335 = t213*t132
      t336 = t335*t115
      t338 = t132*s4l2p*t6
      t339 = t324*t338
      t340 = t336+t339
      t344 = t220*t25*s3l2p
      t348 = t344+t220*z*s4l2p*t6
      s2 = (-256.D0/3.D0*t11+(1280.D0/3.D0*t15+(512*t22+t27)*s23r)*t8+(-
     #1024.D0/3.D0*t34+(-t36-t27)*t13+(-1280.D0/3.D0*t45-1024.D0/3.D0*t5
     #0)*s23r)*s1vr)*s1l2-64.D0/3.D0*t18*t58*t59
      s1 = s2+((-128.D0/3.D0*t64+64*t66+128.D0/3.D0*t69)*s23r-64.D0/3.D0
     #*t76+64*t81+64.D0/3.D0*t84)*t9+((640.D0/3.D0*t64-704.D0/3.D0*t66-6
     #40.D0/3.D0*t69)*t13+(t99*s2l2+(-896.D0/3.D0*t103-256*t107)*s34r-64
     #.D0/3.D0*t113*t115-64.D0/3.D0*t83*t118*s4l2p*t6)*s23r+t130*s2l2-64
     #*t136+(-320.D0/3.D0*t139*t115+1024.D0/3.D0*t145)*s34r+512.D0/3.D0*
     #t149*t58+1024.D0/3.D0*t149*t68)*t8+((-512.D0/3.D0*t64+192*t66+512.
     #D0/3.D0*t69)*t32+(t166*s2l2+(1216.D0/3.D0*t103+384*t107)*s34r-t173
     #)*t13+(t185*s2l2+(704.D0/3.D0*t188+640.D0/3.D0*t192)*t43+(-896.D0/
     #3.D0*t196-704*t145)*s34r-512.D0/3.D0*t202*t58+512.D0/3.D0*t206*t2*
     #s4l2p*t6)*s23r+t227*s2l2+64.D0/3.D0*t231*t58*t216+(-896.D0/3.D0*t2
     #35-512*t240)*t43+(-1024.D0/3.D0*t244*t102-512*t250)*s34r)*s1vr
      t351 = s1+(-512.D0/3.D0*t83*t63+512.D0/3.D0*t258+512.D0/3.D0*t259)
     #*t32+(t268*s2l2+(-512.D0/3.D0*t276*s3l2p-512.D0/3.D0*t275*s4l2p*t6
     #)*s34r+512.D0/3.D0*t283+512.D0/3.D0*t244*t68)*t13+(t297*s2l2+(-512
     #.D0/3.D0*t304*s3l2p-512.D0/3.D0*t303*s4l2p*t6)*t43+(-512.D0/3.D0*t
     #315*s3l2p-512.D0/3.D0*t314*s4l2p*t6)*s34r)*s23r+t333*s2l2+512.D0/3
     #.D0*t340*t216+512.D0/3.D0*t348*t43
      t353 = 4*z
      t354 = 3-t353
      t367 = 11*z
      t371 = l3*z
      t372 = t371*t6
      t377 = 2*t201
      t379 = (-t94+t377)*t2
      t385 = t6*s3l1p
      t388 = t3*s4l1p
      t389 = t388*t6
      t393 = 6*z
      t394 = 3-t393
      t397 = t6*t43
      t398 = t101*t397
      t406 = t83*t74
      t410 = (t377+2-t94)*t3
      t411 = t68*s3l1p
      t414 = s4l1p*t6
      t415 = t414*s3l2p
      t420 = t201*z
      t432 = t142*t58
      t433 = t126*t68
      t439 = t142*t385
      t440 = t126*t414
      t445 = z*t4
      t446 = t445*t132
      t447 = t213*t6
      t449 = t446*t447*t216
      t454 = t220*t397
      t459 = (-2-2*t201)*t2
      t465 = t220*t58
      t466 = t220*t68
      t467 = -t465+t466
      t470 = t3*t39
      t471 = t470*t63
      t472 = 384*t471
      t474 = 192*t466
      t477 = t17*t213
      t478 = t477*t75
      t480 = t213*t40
      t481 = t480*t80
      t485 = t471-t465-t466
      t489 = t480*t58
      t490 = t480*t68
      t491 = -t489-t490
      t496 = t39**2
      t497 = t40*t496
      t498 = t397*s2l2
      t499 = t497*t498
      t501 = t496*t132
      t504 = -t501*t58-t501*t68
      t509 = t220*t385
      t510 = t220*t414
      t511 = -t509+t510
      t514 = t6*s2l1
      t515 = t470*t514
      t518 = 192*t510
      t521 = t74*s2l1
      t522 = t477*t521
      t524 = t385*s34r
      t525 = t480*t524
      t529 = t515-t509-t510
      t533 = t480*t385
      t534 = t480*t414
      t535 = -t533-t534
      t541 = t497*t397*s2l1
      t545 = -t501*t385-t501*t414
      t550 = t371*t39
      t551 = t17*t6
      t553 = t550*t551*t9
      t556 = t550*t551*s23r
      t566 = t41*t411
      t568 = t41*t415
      t570 = s4l2p*s4l1p
      t571 = t41*t570
      t572 = 384*t571
      t582 = t550*t551*t13
      t594 = t325*s34r
      t595 = t371*t213*t594
      t621 = t496*t6
      t622 = t621*t43
      t623 = t371*t132*t622
      t641 = t201*t6
      t643 = t470*t641*t13
      t647 = t74*s23r
      t648 = t201*t213*t17*t647
      t650 = t40*t201
      t651 = t650*t622
      t654 = s13r**2
      t672 = -t491
      t699 = -t535
      t715 = 128.D0/3.D0*t471-64.D0/3.D0*t465-64.D0/3.D0*t466
      t717 = -t509-t510
      t718 = 64.D0/3.D0*t717
      t721 = t94-2
      t722 = t3*t721
      t734 = z-2
      t735 = t3*t734
      t750 = z*t213
      t760 = z*t17
      t761 = t4*l3
      t762 = t761*t6
      t764 = t760*t762*t32
      t769 = t18*t385
      t770 = t18*t414
      t774 = z*t40
      t776 = t762*s34r
      t777 = t774*t19*t776
      t779 = t101*t411
      t780 = 64.D0/3.D0*t779
      t781 = t101*t415
      t782 = 64.D0/3.D0*t781
      t785 = t5*t6
      t790 = 128.D0/3.D0*t76
      t801 = t83*t385
      t803 = t257*t414
      t810 = z*t132*t39*t762*t43
      t813 = t19*t132*t4
      t814 = t813*t411
      t815 = t813*t415
      t816 = -4-t393
      t819 = t18*t6
      t826 = (4+z)*t17
      t834 = t257*t570
      t835 = 128.D0/3.D0*t834
      t852 = (t177+1)*t19*t17
      t857 = t329*s3l2p
      t858 = 128.D0/3.D0*t857
      t861 = t385*t43
      t862 = t134*t861
      t864 = t114*s3l1p
      t866 = l3*s4l1p
      t867 = t866*t6
      t868 = t142*t867
      t872 = t329*s3l1p
      t873 = 128.D0/3.D0*t872
      t876 = t328*t4
      t877 = t325*t43
      t878 = t876*t877
      t881 = t47*t325*s3l2p
      t883 = t40*s4l2p
      t889 = t47*t40
      t890 = t889*t415
      t892 = t83*t6
      t899 = 128.D0/3.D0*t735*t58-128.D0/3.D0*t249
      t902 = 128.D0/3.D0*t388*t58
      t903 = t202*t6
      t907 = t420*t3
      t908 = t39*t6
      t912 = t3*t201
      t913 = t114*t32
      t916 = t761*t17
      t918 = t916*t25*t13
      t920 = t58*s2l1
      t921 = t18*t920
      t923 = t385*s2l2
      t924 = t18*t923
      t926 = 192*t779
      t927 = 192*t781
      t933 = t48*t7*t8
      t937 = t220*l3
      t939 = t83*t20*t13+t937*t647
      t944 = t114*s2l2
      t945 = t126*t944
      t955 = t937*t75
      t962 = (-t126-t311)*t6
      t965 = -t126+t142
      t971 = 192*t945
      t976 = t220*t127
      t978 = -1+t94
      t979 = t978*t6
      t981 = 512.D0/3.D0*t224*t979
      t982 = -1216.D0/3.D0*t976-t981
      t988 = 1-t353
      t991 = (-t126+t126*t988)*t6
      t995 = -t126-2*t311
      t1001 = t447*t43
      t1002 = t237*t1001
      t1004 = t328*t3
      t1009 = -640.D0/3.D0*t1002+512.D0/3.D0*(-t470-t1004)*t6*s34r
      t1011 = t335*l3
      t1022 = t945-t196-t145
      t1026 = 2560.D0/3.D0*t976+t981
      t1028 = -t235-t240
      t1040 = t329*s34r
      t1043 = 2048.D0/3.D0*t1002+2048.D0/3.D0*t328*t1040
      t1049 = -t220+t220*t988
      t1050 = t1049*t6
      t1060 = l3*t496*t217
      t1064 = 512.D0/3.D0*t1060-512.D0/3.D0*t205*t17*t1001
      t1066 = t496*t229
      t1069 = -t1066*t115-t1066*t144
      t1073 = -t480-t750*t40
      t1074 = t1073*t6
      t1083 = t114*s2l1
      t1084 = t126*t1083
      t1086 = t142*t864
      t1095 = t937*t521
      t1097 = t908*s3l1p
      t1098 = t237*t1097
      t1101 = t39*s4l1p*t6
      t1102 = t237*t1101
      t1113 = 192*t1084
      t1141 = t1084-t1086-t868
      t1145 = -t1098-t1102
      t1158 = t215*s3l1p
      t1159 = t324*t1158
      t1162 = t324*t132*s4l1p*t6
      t1163 = -t1159-t1162
      t1177 = -t1066*t864-t1066*t867
      t1188 = t445*t17
      t1192 = t760*t19
      t1194 = t1192*t42*s23r
      t1196 = 256.D0/3.D0*t945
      t1197 = 64*t196
      t1201 = t1086+t868
      t1204 = t876*t594
      t1206 = t247*l3
      t1215 = t1192*t42*t13
      t1218 = 4*t19*t17
      t1229 = t889*t411
      t1230 = 64.D0/3.D0*t1229
      t1231 = 64.D0/3.D0*t890
      t1232 = t143*s4l1p
      t1233 = t78*t1232
      t1234 = 128.D0/3.D0*t1233
      t1235 = 35*z
      t1245 = t126*t6
      t1251 = 64.D0/3.D0*t432
      t1252 = 128.D0/3.D0*t433
      t1257 = 64.D0/3.D0*t439
      t1258 = 128.D0/3.D0*t440
      t1261 = t446*t1001
      t1263 = -3+t111
      t1270 = t142*t68
      t1272 = -128.D0/3.D0*t432-64.D0/3.D0*t1270
      t1274 = t142*t415
      t1275 = 64.D0/3.D0*t1274
      t1284 = t1188*t20*t32
      t1285 = 384*t1284
      t1286 = t68*s2l1
      t1289 = t414*s2l2
      t1318 = l3*t39
      t1319 = t1318*t132
      t1320 = t1319*t411
      t1322 = t1319*t415
      t1323 = 64.D0/3.D0*t1322
      t1324 = t133*t1232
      t1343 = t220*t74
      t1349 = t41*t58
      t1356 = -t1163
      t1369 = 192*t445*t229*t621*t216
      t1377 = t41*t68
      t1391 = t48*t641*t32
      t1395 = t201*t39*t17*t127
      t1404 = l3*t201*t213
      t1405 = t1404*t877
      t1416 = t501*l3*t641*t216
      s3 = ((-1024.D0/3.D0*t933+1024.D0/3.D0*t939*s1vr)*s1l2+(-128.D0/3.
     #D0*t945+64.D0/3.D0*t196)*t9+((-320.D0/3.D0*t945-128.D0/3.D0*t196+3
     #20*t145)*s23r+256.D0/3.D0*t955+(-640.D0/3.D0*t235+512.D0/3.D0*t240
     #)*s34r+512.D0/3.D0*t962*s3l2p+512.D0/3.D0*t965*s4l2p*t6)*t8+((-t97
     #1+1088.D0/3.D0*t196+64.D0/3.D0*t145)*t13+(t982*s2l2+(2176.D0/3.D0*
     #t235+64.D0/3.D0*t240)*s34r-512.D0/3.D0*t991*s3l2p-512.D0/3.D0*t995
     #*s4l2p*t6)*s23r+t1009*s2l2+1088.D0/3.D0*t1011*t135+(-1024.D0/3.D0*
     #t289*t551*s3l2p+512*t466)*s34r)*s1vr+1024.D0/3.D0*t1022*t32+(t1026
     #*s2l2+2560.D0/3.D0*t1028*s34r-512.D0/3.D0*t126*t979*s3l2p-512.D0/3
     #.D0*t126*t978*s4l2p*t6)*t13+(t1043*s2l2-2048.D0/3.D0*t340*t43+(512
     #.D0/3.D0*t1050*s3l2p+512.D0/3.D0*t1049*s4l2p*t6)*s34r)*s23r+t1064*
     #s2l2+512.D0/3.D0*t1069*t216+(512.D0/3.D0*t1074*s3l2p+512.D0/3.D0*t
     #1073*s4l2p*t6)*t43)*s1l1
      s4 = ((-128.D0/3.D0*t1084+64.D0/3.D0*t1086)*t9+((-320.D0/3.D0*t108
     #4-128.D0/3.D0*t1086+320*t868)*s23r+256.D0/3.D0*t1095+(-640.D0/3.D0
     #*t1098+512.D0/3.D0*t1102)*s34r+512.D0/3.D0*t962*s3l1p+512.D0/3.D0*
     #t965*s4l1p*t6)*t8+((-t1113+1088.D0/3.D0*t1086+64.D0/3.D0*t868)*t13
     #+(t982*s2l1+(2176.D0/3.D0*t1098+64.D0/3.D0*t1102)*s34r-512.D0/3.D0
     #*t991*s3l1p-512.D0/3.D0*t995*s4l1p*t6)*s23r+t1009*s2l1+1088.D0/3.D
     #0*t1011*t861+(-1024.D0/3.D0*t289*t551*s3l1p+512*t510)*s34r)*s1vr+1
     #024.D0/3.D0*t1141*t32+(t1026*s2l1+2560.D0/3.D0*t1145*s34r-512.D0/3
     #.D0*t126*t979*s3l1p-512.D0/3.D0*t126*t978*s4l1p*t6)*t13+(t1043*s2l
     #1+2048.D0/3.D0*t1163*t43+(512.D0/3.D0*t1050*s3l1p+512.D0/3.D0*t104
     #9*s4l1p*t6)*s34r)*s23r+t1064*s2l1+512.D0/3.D0*t1177*t216+(512.D0/3
     #.D0*t1074*s3l1p+512.D0/3.D0*t1073*s4l1p*t6)*t43)*s1l2
      s2 = s3+s4
      s1 = s2-64.D0/3.D0*t1188*t20*t59+(-320*t1194+(-t1196+t1197+64*t145
     #)*s2l1+64*t1201*s2l2-320.D0/3.D0*t1204+64.D0/3.D0*t1206*t3*(-t111+
     #10)*t6)*t9+(-128.D0/3.D0*t1215+((t1196-t1197-64.D0/3.D0*t1218*t144
     #)*s2l1+(-64*t1086-64.D0/3.D0*t1218*t867)*s2l2-64*t1204+t1230+t1231
     #+(t1234-64.D0/3.D0*(-13+t1235)*z*t48)*t6)*s23r+((512.D0/3.D0*t976-
     #256.D0/3.D0*t1245)*s2l2+320.D0/3.D0*t1028*s34r+t1251-t1252)*s2l1+(
     #320.D0/3.D0*t1145*s34r+t1257-t1258)*s2l2-64*t1261-64.D0/3.D0*t1263
     #*z*t39*t257*t74+t1272*s3l1p-t1275-512.D0/3.D0*t224*z*(-t94+1+t201)
     #*t6)*t8
      s2 = s1+(t1285+(64.D0/3.D0*t270*t1286+64.D0/3.D0*t270*t1289+2752.D
     #0/3.D0*t1204-t1230-t1231+(-t1234-64.D0/3.D0*(23-27*z)*z*t48)*t6)*t
     #13+(((-256.D0/3.D0*t976+256.D0/3.D0*t1245)*s2l2+(128.D0/3.D0*t235+
     #64*t240)*s34r-t1251+t1252)*s2l1+((128.D0/3.D0*t1098+64*t1102)*s34r
     #-t1257+t1258)*s2l2+2176.D0/3.D0*t1261+(-64.D0/3.D0*t1320-t1323+(-1
     #28.D0/3.D0*t1324+64.D0/3.D0*(-36+t1235)*z*t937)*t6)*s34r-t1272*s3l
     #1p+t1275-512.D0/3.D0*(t177+t377-1)*z*t224*t6)*s23r+((-256.D0/3.D0*
     #t1002+256.D0/3.D0*t1343)*s2l2+128.D0/3.D0*t340*t43+(-64.D0/3.D0*t1
     #349+128.D0/3.D0*t466)*s34r)*s2l1+(128.D0/3.D0*t1356*t43+(-64.D0/3.
     #D0*t41*t385+128.D0/3.D0*t510)*s34r)*s2l2+t1369+64.D0/3.D0*(t111-13
     #)*z*t213*t237*t397+((128.D0/3.D0*t1349+64.D0/3.D0*t1377)*s3l1p+64.
     #D0/3.D0*t568-512.D0/3.D0*t978*z*t470*t6)*s34r)*s1vr+1024.D0/3.D0*t
     #1391
      t1421 = s2+(2560.D0/3.D0*t1395+512.D0/3.D0*t292*t2*t978*t6)*t13+(2
     #048.D0/3.D0*t1405-512.D0/3.D0*t988*t201*t39*t1040)*s23r+512.D0/3.D
     #0*t1416+512.D0/3.D0*t420*t17*t1001
      t1423 = s23r*t8
      t1429 = s34r*s23r
      t1454 = 384*t945
      t1455 = 576*t196
      t1456 = 576*t145
      t1460 = 576*t1201*s2l2
      t1461 = 576*t1204
      t1462 = 192*t1229
      t1463 = 192*t890
      t1464 = 384*t1233
      t1465 = -8+t94
      t1498 = -t263
      t1499 = t1498*t19
      t1500 = t1499*t857
      t1510 = t1499*t872
      t1513 = t19*s4l1p*t6
      t1550 = t25*s23r
      t1564 = 192*t145
      t1571 = 192*t250
      t1582 = 576*t976+96*(-4+t393)*t19*t293
      t1590 = (-5+16*z)*t6
      t1594 = 3+t353
      t1603 = t908*s34r
      t1606 = 384*t1002+96*t1498*t3*t1603
      t1612 = -t354
      t1613 = t1612*t17
      t1625 = 7*z
      t1626 = -4+t1625
      t1630 = -1728*t976-192*t1626*t19*t293
      t1632 = -t1028
      t1635 = t1626*t6
      t1649 = -1152*t1002-192*t1263*t3*t1603
      t1653 = t1263*t6
      t1664 = t480*t397
      t1666 = -192*t1060-192*t1664
      t1682 = 192*t868
      t1689 = t247*t389
      t1690 = 192*t1689
      t1725 = -t1145
      t1768 = 192*t1204
      t1769 = 3-t177
      t1771 = t1769*z*t19
      t1792 = -t1769
      t1800 = -t205
      t1801 = 2*t1800
      t1802 = t1801*t19
      t1843 = (-5+t353)*t2
      t1847 = -5+t393
      t1848 = t1847*t19
      t1852 = (-5+t94)*t3
      t1869 = t1848*t17
      t1879 = 9*z
      t1897 = t220*t25*s3l1p
      t1947 = t420*t6
      t1964 = 192*t69
      t1965 = -192*t64+576*t66+t1964
      t1967 = 384*t76
      t1973 = (-6+t94)*t3
      t1984 = 288*t22-288*t892
      t1990 = -4+t94
      t1991 = t1990*t6
      t1992 = t1991*s3l2p
      t1993 = t83*t1992
      t1995 = t978*t3
      t2002 = 384*t45+480*t128
      t2009 = t1465*t17*t19
      s3 = t351*s1l1+(-192*t354*z*t3*t42*t32+(-192*(5-10*z)*z*t4*t142*t7
     #4-96*(t367-9*t201-6)*t2*t372)*t13+((-96*t379*t58+192*t249)*s2l1+(-
     #96*t379*t385+192*t389)*s2l2-192*t394*z*t39*t398-96*(-10+13*z-10*t2
     #01)*t19*z*t406+96*t410*t411+96*t410*t415+(384*t248*s4l1p+96*(-2+t3
     #93-2*t420)*t1*z)*t6)*s23r+(384*t126*t75+(-192*t432+192*t433)*s34r)
     #*s2l1+(-192*t439+192*t440)*s34r*s2l2-192*t449+384*l3*t271*z*t454+9
     #6*t459*t19*t49)*s1vr
      s4 = s3
      s8 = (192*t467*t8+((-t472+960*t465+t474)*s23r-192*t478+384*t481)*s
     #1vr+768*t485*t13+(960*t478+960*t491*s34r)*s23r+192*t499+192*t504*t
     #43)*s1l1+(192*t511*t8+((-384*t515+960*t509+t518)*s23r-192*t522+384
     #*t525)*s1vr+768*t529*t13+(960*t522+960*t535*s34r)*s23r+192*t541+19
     #2*t545*t43)*s1l2-288*t553+(768*t556+(-t472+192*t465+384*t466)*s2l1
     #+(192*t509+384*t510)*s2l2-192*t566-192*t568+(-t572+96*(4-z)*z*t470
     #)*t6)*t8
      s7 = s8+(768*t582+((768*t471-384*t465-768*t466)*s2l1+(-384*t509-76
     #8*t510)*s2l2+864*t595+384*t566+384*t568+(768*t571-96*t328*t3*(9-z)
     #)*t6)*s23r+(384*t478+(-192*t489-384*t490)*s34r)*s2l1+(-192*t533-38
     #4*t534)*s34r*s2l2+288*t623+(192*t335*t411+192*t335*t415+(384*t335*
     #t570-96*(7+z)*z*t477)*t6)*s34r)*s1vr+768*t643+768*t648+192*t651
      s8 = t654
      s6 = s7*s8
      s7 = ((-512.D0/3.D0*t467*t8+((1024.D0/3.D0*t471-512*t465-512.D0/3.
     #D0*t466)*s23r+512.D0/3.D0*t478-1024.D0/3.D0*t481)*s1vr-1024.D0/3.D
     #0*t485*t13+(-512*t478+512*t672*s34r)*s23r-512.D0/3.D0*t499-512.D0/
     #3.D0*t504*t43)*s1l1+(-512.D0/3.D0*t511*t8+((1024.D0/3.D0*t515-512*
     #t509-512.D0/3.D0*t510)*s23r+512.D0/3.D0*t522-1024.D0/3.D0*t525)*s1
     #vr-1024.D0/3.D0*t529*t13+(-512*t522+512*t699*s34r)*s23r-512.D0/3.D
     #0*t541-512.D0/3.D0*t545*t43)*s1l2+192*t553+(1472.D0/3.D0*t556+t715
     #*s2l1+t718*s2l2+896.D0/3.D0*t595+512.D0/3.D0*t328*t722*t6)*t8+(-20
     #48.D0/3.D0*t582+(-t715*s2l1-t718*s2l2-3520.D0/3.D0*t595-512.D0/3.D
     #0*t328*t735*t6)*s23r+(-128.D0/3.D0*t478+64.D0/3.D0*t672*s34r)*s2l1
     #+64.D0/3.D0*t699*s34r*s2l2-1472.D0/3.D0*t623-1024.D0/3.D0*t750*t59
     #4)*s1vr-1024.D0/3.D0*t643-512*t648-512.D0/3.D0*t651)*t654
      s5 = s6+s7
      s2 = s4+s5
      s3 = s2+(-192*t764+((64.D0/3.D0*t66+64.D0/3.D0*t69)*s2l1+(64.D0/3.
     #D0*t769+64.D0/3.D0*t770)*s2l2-1024.D0/3.D0*t777+t780+t782-64.D0/3.
     #D0*(2-t111)*z*t785)*t13+((t790+64.D0/3.D0*t79*t68*s34r+128.D0/3.D0
     #*t84-64.D0/3.D0*t259)*s2l1+(64.D0/3.D0*t79*t414*s34r+128.D0/3.D0*t
     #801-64.D0/3.D0*t803)*s2l2-448.D0/3.D0*t810+(64.D0/3.D0*t814+64.D0/
     #3.D0*t815-64.D0/3.D0*t816*z*t19*t819)*s34r+(-128*t258-64.D0/3.D0*t
     #826*t144)*s3l1p-64.D0/3.D0*t826*l3*t415+(-t835+64.D0/3.D0*(-t393+6
     #+16*t201)*z*t24)*t6)*s23r+((128.D0/3.D0*t45-128.D0/3.D0*t257*t21)*
     #s2l2-64.D0/3.D0*t136+(64.D0/3.D0*t852*t115-64.D0/3.D0*t145)*s34r-t
     #858)*s2l1+(-64.D0/3.D0*t862+(64.D0/3.D0*t852*t864-64.D0/3.D0*t868)
     #*s34r-t873)*s2l2+128*t878+((-128*t881-64*t47*t883*t6)*s3l1p-64*t89
     #0+128*t247*t892)*s34r+t899*s3l1p-t902-512.D0/3.D0*t903)*t8
      s1 = s3-192*t907*t908*t43-512.D0/3.D0*t912*t913+(192*t918+(-288*t9
     #21-288*t924+t926+t927)*s23r)*t9
      s3 = s1+t1421*s13r
      s4 = s3
      s6 = ((288*t270*t58*t1423+(288*t1022*t13-288*t299*t58*t1429)*s1vr)
     #*s1l1+(288*t270*t385*t1423+(288*t1141*t13-288*t299*t385*t1429)*s1v
     #r)*s1l2-576*t1192*t42*s23r*t9+(384*t1215+((-t1454+t1455+t1456)*s2l
     #1+t1460+t1461-t1462-t1463+(-t1464-96*t1465*l3*t311)*t6)*s23r)*t8+(
     #-t1285+((-t971+96*t196-96*t145)*s2l1+(96*t1086-96*t868)*s2l2-t1461
     #+t1462+t1463+(t1464+96*t816*l3*t311)*t6)*t13+(((192*t976-576*t1245
     #)*s2l2+(-96*t235-288*t240)*s34r+288*t1500+288*t735*t106)*s2l1+((-9
     #6*t1098-288*t1102)*s34r+288*t1510+288*t735*t1513)*s2l2+(192*t1320+
     #192*t1322+(384*t1324+96*t721*l3*t328*t17)*t6)*s34r+288*t142*t411+2
     #88*t1274+576*t142*t570*t6)*s23r)*s1vr)*s13r
      s7 = (512.D0/3.D0*t272*t201*t19*t406-512.D0/3.D0*t2*t420*t6)*t13
      s5 = s6+s7
      s2 = s4+s5
      s4 = s2
      s6 = (64.D0/3.D0*t916*t1550-64.D0/3.D0*t921-64.D0/3.D0*t924)*t59
      s11 = ((384*t933-384*t939*s1vr)*s1l2+(192*t945-192*t196)*t9+((-t97
     #1+t1455-t1564)*s23r-384*t955+576*t299*t80+96*t1500-t1571)*t8+((t97
     #1-1152*t196)*t13+(t1582*s2l2+(-1728*t235-192*t240)*s34r-96*t126*t1
     #590*s3l2p-96*t126*t1594*s4l2p*t6)*s23r+t1606*s2l2+(-576*t336-192*t
     #339)*t43+(-96*t1613*t908*s3l2p-t474)*s34r)*s1vr-768*t1022*t32+(t16
     #30*s2l2+1728*t1632*s34r+192*t126*t1635*s3l2p+192*t126*t1626*s4l2p*
     #t6)*t13+(t1649*s2l2+1152*t340*t43+(192*t220*t1653*s3l2p+192*t220*t
     #1263*s4l2p*t6)*s34r)*s23r+t1666*s2l2-192*t1069*t216+(192*t335*t58+
     #192*t335*t68)*t43)*s1l1
      s12 = ((192*t1084-192*t1086)*t9+((-t1113+576*t1086-t1682)*s23r-384
     #*t1095+576*t299*t524+96*t1510-t1690)*t8+((t1113-1152*t1086)*t13+(t
     #1582*s2l1+(-1728*t1098-192*t1102)*s34r-96*t126*t1590*s3l1p-96*t126
     #*t1594*s4l1p*t6)*s23r+t1606*s2l1+(-576*t1159-192*t1162)*t43+(-96*t
     #1613*t1097-t518)*s34r)*s1vr-768*t1141*t32+(t1630*s2l1+1728*t1725*s
     #34r+192*t126*t1635*s3l1p+192*t126*t1626*s4l1p*t6)*t13+(t1649*s2l1+
     #1152*t1356*t43+(192*t220*t1653*s3l1p+192*t220*t1263*s4l1p*t6)*s34r
     #)*s23r+t1666*s2l1-192*t1177*t216+(192*t335*t385+192*t335*t414)*t43
     #)*s1l2
      s10 = s11+s12
      s11 = s10+(-576*t1194+(t1454-192*t196-t1564)*s2l1-192*t1201*s2l2+t
     #1768+t1462+t1463-96*t1771*t892)*t9
      s12 = s11
      s14 = (96*t1215+((-768*t945+t1455+t1456)*s2l1+t1460+t1768-576*t122
     #9-576*t890+(-t1464-96*(-17+z)*t19*t244*l3)*t6)*s23r+((-384*t976+19
     #2*t1792*t2*t20)*s2l2+192*t1632*s34r-96*t1802*t857-96*t1499*t249)*s
     #2l1+(192*t1725*s34r-96*t1802*t872-96*t1499*t389)*s2l2+(-192*t1320-
     #192*t1322-192*t205*l3*z*t220*t6)*s34r+192*t1192*t411+192*t1192*t41
     #5-96*t459*t247*t6)*t8
      s15 = (-768*t1284+(-1536*t1204+96*(7-t367)*t19*z*t892)*t13+((-192*
     #t1843*t20*s2l2+96*t1848*t857+192*t1852*t106)*s2l1+(96*t1848*t872+1
     #92*t1852*t1513)*s2l2-960*t1261+1152*l3*t271*z*t1343-96*t1869*t411-
     #96*t1869*t415+(192*t178*t17*t105*s4l1p-96*(8-t1879-5*t201)*t2*t247
     #)*t6)*s23r+(-384*t1004*t75+(192*t344+192*t1377)*s34r)*s2l1+(192*t1
     #897+192*t41*t414)*s34r*s2l2-t1369-96*(t177-7)*z*l3*t1664+(-192*t13
     #3*t411-192*t133*t415+(t572-96*(6-z)*z*t470)*t6)*s34r)*s1vr
      s13 = s14+s15
      s9 = s12+s13
      s8 = s9-768*t1391+(-1536*t1395+192*t394*t19*t903)*t13+(-960*t1405+
     #192*(2-t1625)*t201*t39*t1040)*s23r-192*t1416-192*t650*t1001
      s9 = s13r
      s7 = s8*s9
      s5 = s6+s7
      s3 = s4+s5
      t2021 = s3+(-960*t271*t201*t19*t406-192*t1769*t1*t1947)*t13+(-512.
     #D0/3.D0*t650*t39*t221-512.D0/3.D0*t907*t21)*s23r+(-480*t819*s3l2p*
     #s23r*t9+(t1965*t13+(-t1967+(768*t103+192*t107)*s34r-96*t1973*t115)
     #*s23r)*t8+((-96*t64-96*t66+96*t69)*t32+(t1984*s2l2+(-384*t103-96*t
     #107)*s34r+96*t1993+96*t1995*t144)*t13+(t2002*s2l2+(-288*t188-192*t
     #192)*t43+(96*t2009*t115-288*t145)*s34r)*s23r)*s1vr)*s1l1
      t2023 = t477*t25*t8
      t2025 = t477*t1550
      t2028 = t774*t621*s34r
      t2033 = t654*s13r
      t2047 = t18*t74
      t2051 = t1801*l3*t17
      t2057 = 5*z
      t2059 = (-2+t2057)*l3
      t2066 = t270*t75
      t2069 = t734*t17*t19
      t2081 = t244*t385
      t2085 = 192*t878
      t2109 = -t36-384*t26
      t2134 = t24*t6
      t2136 = -576*t22-288*t2134
      t2145 = t48*t75
      t2147 = t734*t2
      t2157 = 1152*t22+864*t2134
      t2163 = (-13+t393)*t3
      t2174 = 576*t45+960*t128-96*(-4+t177)*t1*t25
      t2181 = (-16+t393)*t17*t19
      t2188 = (-2-t2057+6*t201)*t2
      t2192 = (t94+t377-2)*t2
      t2200 = 96*t222+96*t734*t19*t294
      t2204 = t721*t19
      t2211 = t1990*t2
      t2214 = t1990*s4l2p*t6
      t2219 = t393-7
      t2226 = 192*t2219*l3*t3*t21+192*t1990*t1*t25
      t2228 = t2219*t6
      t2246 = 3*t1
      t2251 = 192*t1990*t17*t39*t221+192*t2246*z*t19*t294
      t2258 = t2246*t6
      t2269 = 192*t332
      t2284 = t445*t6
      t2289 = t1612*t3
      t2297 = 192*t83*t414
      t2304 = t19*t4
      t2308 = t1613*l3
      t2335 = t1792*t3
      t2360 = t5*t514
      t2363 = 192*t770
      t2364 = 192*t2360-576*t769-t2363
      t2376 = t2304*t325*s3l1p
      t2380 = t78*t4*s4l1p*t6
      t2406 = t4*t39*t1158
      t2408 = t4*t132*t1101
      t2433 = t1990*t3*t864
      t2435 = t1990*s4l1p*t6
      t2449 = t1991*s3l1p
      t2478 = t1897+t220*z*s4l1p*t6
      t2497 = t1800*t6
      t2503 = t79*t524
      t2517 = t257*t415
      t2551 = t73*t521
      t2698 = t257*t385
      t2760 = 2+z
      t2770 = 8*t201
      t2801 = (3+z)*t40*t19
      t2827 = t328*t40
      s3 = (288*t2023+(-768*t2025-288*t2028)*s1vr)*t2033+(((-96*t371*t85
     #7-192*t259)*s2l1+(-96*t244*t864-192*t803)*s2l2-96*t272*z*t19*t2047
     #-96*t2051*t411-96*t2051*t415+(-384*t834+96*t2059*t244)*t6)*t13+((-
     #384*t2066+(96*t2069*t115-t1564)*s34r-288*t283)*s2l1+((96*t2069*t86
     #4-t1682)*s34r-288*t2081)*s2l2-t2085+(-192*t1206*t883*t385-192*t120
     #6*t40*s4l1p*t58-96*t2059*z*t1245)*s34r-288*t244*t411-288*t244*t415
     #)*s23r)*s1vr
      s4 = s3
      s8 = (384*t11+(-768*t15+t2109*s23r)*t8+(384*t34-t2109*t13+(384*t45
     #+384*t50)*s23r)*s1vr)*s1l2+(-t1965*s23r+96*t84)*t9+((-576*t64+1152
     #*t66+576*t69)*t13+(t2136*s2l2+(1152*t103+576*t107)*s34r+768*t84)*s
     #23r-96*t2145+96*t2147*t58)*t8+((576*t64-576*t66-576*t69)*t32+(t215
     #7*s2l2+(-1152*t103-1152*t107)*s34r+96*t2163*t115-t173)*t13+(t2174*
     #s2l2+(-576*t188-576*t192)*t43+(96*t2181*t115-t1564)*s34r+96*t2188*
     #t58+96*t2192*t68)*s23r+t2200*s2l2-288*t299*t135+(-96*t2204*t857+t1
     #571)*s34r)*s1vr+(192*t2211*t944-192*t1993-192*t83*t2214)*t32
      s7 = s8+(t2226*s2l2+(-192*t270*t2228*s3l2p-192*t270*t2219*s4l2p*t6
     #)*s34r-192*t149*t1992-192*t149*t2214)*t13+(t2251*s2l2+(-192*t299*t
     #1992-192*t299*t2214)*t43+(-192*t311*t2258*s3l2p-192*t311*t2246*s4l
     #2p*t6)*s34r)*s23r+t2269*s2l2+192*t340*t216+192*t348*t43
      s8 = s1l1
      s6 = s7*s8
      s7 = (384*t764+(-960*t138*z*t40*t776+96*t1847*t3*t2284)*t13+((-96*
     #t2289*t115+t173)*s2l1+(-96*t2289*t864+t2297)*s2l2+576*t810+96*(-9+
     #t177)*z*t17*t2304*t74+96*t2308*t411+96*t2308*t415+96*(5-t94-4*t201
     #)*t2*t372)*s23r+(384*t2145-192*t270*t80+96*t1843*t58)*s2l1+(-192*t
     #270*t524+96*t1843*t385)*s2l2-t2085+96*t1771*t406-96*t2335*t411-96*
     #t2335*t415)*t8
      s5 = s6+s7
      s2 = s4+s5
      s3 = s2+(-1024.D0/3.D0*t2023+(1024.D0/3.D0*t2025+1024.D0/3.D0*t202
     #8)*s1vr)*t2033
      s4 = s3+(192*t2246*l3*t201*t454+192*t721*t2*t19*t1947*s34r)*s23r
      s5 = s4
      s9 = (t2364*s23r+96*t801)*t9+((-576*t2360+1152*t769+576*t770)*t13+
     #(t2136*s2l1+(1152*t2376+576*t2380)*s34r+768*t801)*s23r-96*t48*t521
     #+96*t2147*t385)*t8+((576*t2360-576*t769-576*t770)*t32+(t2157*s2l1+
     #(-1152*t2376-1152*t2380)*s34r+96*t2163*t864-t2297)*t13+(t2174*s2l1
     #+(-576*t2406-576*t2408)*t43+(96*t2181*t864-t1682)*s34r+96*t2188*t3
     #85+96*t2192*t414)*s23r+t2200*s2l1-288*t299*t861+(-96*t2204*t872+t1
     #690)*s34r)*s1vr+(192*t2211*t1083-192*t2433-192*t83*t2435)*t32
      s8 = s9+(t2226*s2l1+(-192*t270*t2228*s3l1p-192*t270*t2219*s4l1p*t6
     #)*s34r-192*t149*t2449-192*t149*t2435)*t13+(t2251*s2l1+(-192*t299*t
     #2449-192*t299*t2435)*t43+(-192*t311*t2258*s3l1p-192*t311*t2246*s4l
     #1p*t6)*s34r)*s23r+t2269*s2l1+192*t1356*t216+192*t2478*t43
      s9 = s1l2
      s7 = s8*s9
      s8 = (512.D0/3.D0*t918+(-64.D0/3.D0*t18*t1286-64.D0/3.D0*t18*t1289
     #+128*t777-t780-t782+64.D0/3.D0*t5*z*(-7+t1879)*t6)*s23r+(-t790+128
     #.D0/3.D0*t81-64.D0/3.D0*t83*t2497*s3l2p)*s2l1+(128.D0/3.D0*t2503-6
     #4.D0/3.D0*t83*t2497*s3l1p)*s2l2-448.D0/3.D0*t1192*t42*s34r+(256.D0
     #/3.D0*t258+128.D0/3.D0*t259)*s3l1p+128.D0/3.D0*t2517-512.D0/3.D0*t
     #24*t641)*t9
      s6 = s7+s8
      s1 = s5+s6
      s2 = s1+(96*t918+(-192*t921-192*t924+192*t138*z*t40*t776+t926+t927
     #-96*(3+t177)*t3*t2284)*s23r+384*t83*t920+384*t83*t923-192*t257*t41
     #1-192*t2517)*t9+(-480*t819*s3l1p*s23r*t9+(-t2364*t13+(-384*t2551+(
     #768*t2376+192*t2380)*s34r-96*t1973*t864)*s23r)*t8+((-96*t2360-96*t
     #769+96*t770)*t32+(t1984*s2l1+(-384*t2376-96*t2380)*s34r+96*t2433+9
     #6*t1995*t867)*t13+(t2002*s2l1+(-288*t2406-192*t2408)*t43+(96*t2009
     #*t864-288*t868)*s34r)*s23r)*s1vr)*s1l2+(384*t550*t551*t1423+((576*
     #t471-288*t465-288*t466)*s2l1+288*t717*s2l2-384*t595)*s23r*s1vr)*t6
     #54
      s4 = s2
      s8 = -64.D0/3.D0*t18*t385*t59+((-128.D0/3.D0*t2360+64*t769+128.D0/
     #3.D0*t770)*s23r-64.D0/3.D0*t2551+64*t2503+64.D0/3.D0*t801)*t9+((64
     #0.D0/3.D0*t2360-704.D0/3.D0*t769-640.D0/3.D0*t770)*t13+(t99*s2l1+(
     #-896.D0/3.D0*t2376-256*t2380)*s34r-64.D0/3.D0*t113*t864-64.D0/3.D0
     #*t83*t118*s4l1p*t6)*s23r+t130*s2l1-64*t862+(-320.D0/3.D0*t139*t864
     #+1024.D0/3.D0*t868)*s34r+512.D0/3.D0*t149*t385+1024.D0/3.D0*t149*t
     #414)*t8+((-512.D0/3.D0*t2360+192*t769+512.D0/3.D0*t770)*t32+(t166*
     #s2l1+(1216.D0/3.D0*t2376+384*t2380)*s34r-t2297)*t13+(t185*s2l1+(70
     #4.D0/3.D0*t2406+640.D0/3.D0*t2408)*t43+(-896.D0/3.D0*t1086-704*t86
     #8)*s34r-512.D0/3.D0*t202*t385+512.D0/3.D0*t206*t2*s4l1p*t6)*s23r+t
     #227*s2l1+64.D0/3.D0*t231*t385*t216+(-896.D0/3.D0*t1098-512*t1102)*
     #t43+(-1024.D0/3.D0*t244*t20*s3l1p-512*t1689)*s34r)*s1vr+(-512.D0/3
     #.D0*t83*t514+512.D0/3.D0*t2698+512.D0/3.D0*t803)*t32
      s7 = s8+(t268*s2l1+(-512.D0/3.D0*t276*s3l1p-512.D0/3.D0*t275*s4l1p
     #*t6)*s34r+512.D0/3.D0*t2081+512.D0/3.D0*t244*t414)*t13+(t297*s2l1+
     #(-512.D0/3.D0*t304*s3l1p-512.D0/3.D0*t303*s4l1p*t6)*t43+(-512.D0/3
     #.D0*t315*s3l1p-512.D0/3.D0*t314*s4l1p*t6)*s34r)*s23r+t333*s2l1+512
     #.D0/3.D0*t1356*t216+512.D0/3.D0*t2478*t43
      s8 = s1l2
      s6 = s7*s8
      s7 = -192*t1769*t201*t2*t913
      s5 = s6+s7
      s3 = s4+s5
      s5 = s3
      s8 = 64.D0/3.D0*t5*z*(9-17*z)*t6*t32+((64.D0/3.D0*t258+64.D0/3.D0*
     #t259)*s2l1+(64.D0/3.D0*t2698+64.D0/3.D0*t803)*s2l2+64.D0/3.D0*(19-
     #32*z)*z*t19*t2047+(128.D0/3.D0*t258+64.D0/3.D0*t257*t2760*s4l2p*t6
     #)*s3l1p+64.D0/3.D0*t257*t2760*t415+(t835+64.D0/3.D0*(-6+t393-t2770
     #)*z*t24)*t6)*t13+((128.D0/3.D0*t2066+(-64.D0/3.D0*t196+64.D0/3.D0*
     #t1192*t144)*s34r+t858)*s2l1+((-64.D0/3.D0*t1086+64.D0/3.D0*t1192*t
     #867)*s34r+t873)*s2l2+64.D0/3.D0*(11-15*z)*z*t39*t398+((256.D0/3.D0
     #*t881+64.D0/3.D0*t2801*t144)*s3l1p+64.D0/3.D0*t2801*t866*t58+(t123
     #4+64.D0/3.D0*(-12+14*z-t2770)*z*t48)*t6)*s34r-t899*s3l1p+t902+512.
     #D0/3.D0*t1800*t201*t293)*s23r+(128.D0/3.D0*t299*t498+(-64.D0/3.D0*
     #t2827*t115+64.D0/3.D0*t240)*t43+128.D0/3.D0*t142*t80)*s2l1
      s7 = s8+((-64.D0/3.D0*t2827*t864+64.D0/3.D0*t1102)*t43+128.D0/3.D0
     #*t142*t524)*s2l2+64.D0/3.D0*t449+((128.D0/3.D0*t1318*t215*s3l2p+64
     #.D0/3.D0*t1318*t338)*s3l1p+t1323+64.D0/3.D0*(-6+t111)*z*t39*t257*t
     #6)*t43+((-128.D0/3.D0*t142*t734*t6*s3l2p+128.D0/3.D0*t1270)*s3l1p+
     #128.D0/3.D0*t1274+512.D0/3.D0*t912*t20)*s34r
      s8 = s1vr
      s6 = s7*s8
      s4 = s5+s6
      t2910 = s4+(((-96*t66-t1964)*s2l1+(-96*t769-t2363)*s2l2+192*t777-t
     #926-t927+96*t1626*z*t785)*t13+((-t1967+96*t81-192*t722*t115)*s2l1+
     #(96*t2503-192*t722*t864)*s2l2+(-192*t814-192*t815-192*t445*t142*t6
     #)*s34r+192*t237*t411+192*t237*t415)*s23r)*t8-192*t1404*t326
      taux11 = t2021+t2910
      t1 = l3-1
      t2 = t1**2
      t3 = -1+z
      t4 = t3**2
      t5 = t4**2
      t6 = t2*t5
      t7 = 1/s3vr
      t8 = t7*s3l2p
      t9 = t6*t8
      t10 = s4l2p*t7
      t11 = t6*t10
      t12 = t9-t11
      t14 = s1vr**2
      t16 = t3*t4
      t17 = t16*t2
      t18 = t7*s2l2
      t19 = t17*t18
      t25 = t2*t1
      t26 = t5*t25
      t27 = t7*s34r
      t28 = t27*s2l2
      t29 = t26*t28
      t31 = t5*t3
      t32 = t25*t31
      t33 = t8*s34r
      t38 = -t19+t9+t11
      t40 = s23r**2
      t43 = t32*t8
      t44 = t32*t10
      t45 = t43+t44
      t50 = t2**2
      t51 = t31*t50
      t52 = s34r**2
      t53 = t7*t52
      t55 = t51*t53*s2l2
      t57 = t5*t4
      t58 = t50*t57
      t61 = t58*t8+t58*t10
      t66 = t7*s3l1p
      t67 = t6*t66
      t68 = s4l1p*t7
      t69 = t6*t68
      t70 = -t67+t69
      t73 = t7*s2l1
      t74 = t17*t73
      t80 = t27*s2l1
      t81 = t26*t80
      t83 = t66*s34r
      t88 = t74-t67-t69
      t92 = t32*t66
      t93 = t32*t68
      t94 = -t92-t93
      t100 = t51*t53*s2l1
      t104 = -t58*t66-t58*t68
      t109 = t9+t11
      t110 = 256.D0/3.D0*t109
      t112 = -t67-t69
      t113 = 256.D0/3.D0*t112
      t123 = -t45
      t127 = -t94
      t134 = s13r**2
      t136 = t1*t16
      t137 = l3*t7
      t138 = t137*s2l2
      t139 = t136*t138
      t141 = -t1
      t142 = 4*t141
      t143 = t142*t5
      t144 = t137*s3l2p
      t147 = t1*t5
      t149 = l3*s4l2p*t7
      t150 = t147*t149
      t154 = l3*t6
      t157 = t2*t31
      t158 = t157*t144
      t159 = l3*t31
      t161 = t2*s4l2p*t7
      t162 = t159*t161
      t166 = z*t16
      t167 = t166*t1
      t170 = (-t136-4*t167)*t7
      t174 = -t136+4*t147
      t181 = 29*t1*t16
      t184 = 60*t1*t5
      t190 = t137*s34r
      t191 = t6*t190
      t193 = t4*t1
      t194 = 3*z
      t195 = -1+t194
      t196 = t195*t7
      t198 = 8192.D0/3.D0*t193*t196
      t199 = -15872.D0/3.D0*t191-t198
      t205 = 4*z
      t206 = 1-t205
      t210 = (-t136+4*t136*t206)*t7
      t214 = -t136-8*t167
      t221 = t25*t7*t52
      t222 = t159*t221
      t224 = z*t2
      t231 = -2816*t222+2048.D0/3.D0*(-t17-4*t224*t16)*t7*s34r
      t233 = t25*t57
      t234 = t233*l3
      t235 = t8*t52
      t238 = -1-t205
      t239 = t238*t2
      t240 = t5*t7
      t249 = t147*t144
      t250 = t139-t249-t150
      t252 = t40*s23r
      t255 = 40960.D0/3.D0*t191+t198
      t257 = -t158-t162
      t270 = 16*z
      t273 = t16*t7
      t277 = 32768.D0/3.D0*t222-2048.D0/3.D0*(3-t270)*t2*t273*s34r
      t279 = t233*t144
      t280 = l3*t25
      t283 = t280*t57*s4l2p*t7
      t284 = -t279-t283
      t289 = -t6+4*t6*t206
      t290 = t289*t7
      t300 = t57*t7
      t301 = t52*s34r
      t302 = t300*t301
      t303 = l3*t50*t302
      t308 = 8192.D0/3.D0*t303-2048.D0/3.D0*t238*t5*t221
      t310 = t5*t16
      t311 = t50*t310
      t314 = -t311*t144-t311*t149
      t320 = -t32-4*z*t25*t31
      t321 = t320*t7
      t330 = t137*s2l1
      t331 = t136*t330
      t333 = t137*s3l1p
      t337 = l3*s4l1p*t7
      t338 = t147*t337
      t344 = t2*t7
      t345 = t344*s3l1p
      t346 = t159*t345
      t348 = t2*s4l1p*t7
      t349 = t159*t348
      t381 = t66*t52
      t392 = t147*t333
      t393 = -t331+t392+t338
      t398 = t346+t349
      t412 = t300*s3l1p
      t413 = t280*t412
      t416 = t280*t57*s4l1p*t7
      t417 = t413+t416
      t432 = t311*t333+t311*t337
      t443 = t1*l3
      t444 = t443*t31
      t445 = t10*s3l1p
      t446 = t444*t445
      t447 = t68*s3l2p
      t448 = t444*t447
      t449 = -t446+t448
      t451 = t14*s1vr
      t453 = 3*t141
      t455 = t453*t5*l3
      t456 = t8*s2l1
      t459 = t66*s2l2
      t466 = t157*l3
      t468 = t466*t10*s34r
      t469 = t147*t8
      t474 = t466*t68*s34r
      t475 = t147*t66
      t480 = l3*t2*t57
      t483 = t480*t445-t480*t447
      t486 = t147*t445
      t487 = 256.D0/3.D0*t486
      t488 = t147*t447
      t489 = 256.D0/3.D0*t488
      t492 = l3*t5
      t493 = t492*t1
      t531 = l3*t310*t25
      t537 = t157*t445
      t538 = t157*t447
      t539 = -t537+t538
      t546 = l3**2
      t547 = t546*t5
      t548 = t547*t8
      t550 = t547*t10
      t555 = t141*t31*t546
      t558 = l3*t16
      t559 = t558*t8
      t563 = t16*t546
      t564 = t563*t18
      t565 = 8192.D0/3.D0*t564
      t570 = 31*t1
      t572 = t546*t7
      t573 = t572*s34r
      t576 = t4*l3
      t577 = z*t7
      t580 = 256.D0/3.D0*t570*t5*t573+8192.D0/3.D0*t576*t577
      t583 = 23*t31*t1
      t584 = t572*s3l2p
      t586 = t570*t31
      t588 = t546*s4l2p*t7
      t593 = 30*z
      t595 = (-9+t593)*t16
      t603 = -t558*(-t270+25)+16*t558*t3
      t610 = t157*t572*t52
      t613 = -256.D0/3.D0*t610+256.D0/3.D0*t136*t190
      t615 = t2*t57
      t616 = t615*t546
      t617 = t616*t235
      t619 = 7*t141
      t620 = t619*t5
      t626 = z*t4
      t643 = -5376*t1*t5*t573-8192.D0/3.D0*t576*t7
      t645 = 57*t1
      t646 = t645*t31
      t650 = 32*t31*t1
      t655 = 2*z
      t657 = (22-t655)*t16
      t660 = t558*t10
      t670 = 8192.D0/3.D0*t626*t7
      t671 = -2560*t610-6400.D0/3.D0*t1*t16*t190+t670
      t673 = t615*t584
      t675 = t615*t588
      t681 = (6-t655)*t1*t5
      t684 = -t645*t5
      t690 = (3-t205)*z
      t691 = t4*t7
      t695 = t238*z
      t705 = t137*t52
      t708 = t577*s34r
      t711 = 256.D0/3.D0*t546*t25*t302+1792.D0/3.D0*t6*t705+2048.D0/3.D0
     #*t193*t708
      t714 = t25*t310*t546
      t722 = t1*t7
      t723 = t722*s3l2p
      t726 = z*t1
      t728 = t16*s4l2p*t7
      t729 = t726*t728
      t736 = t492*t8
      t737 = t492*t10
      t741 = 8*z
      t747 = 2048.D0/3.D0*(7-t741)*t1*t16*t190-t670
      t749 = -t3
      t750 = 2*t749
      t754 = -t493+4*t492*t1*t750
      t755 = t754*t7
      t762 = t166*t8
      t773 = t691*s34r
      t776 = 2048.D0/3.D0*(2-t205)*t2*t5*t705+2048.D0/3.D0*t690*t1*t773
      t782 = -2*t466+4*t157*l3*t749
      t783 = t782*t7
      t793 = -t167+4*t166*t1*t749
      t794 = t793*t7
      t803 = t31*t7
      t808 = -t280*t803*t301-t224*t273*t52
      t809 = 2048.D0/3.D0*t808
      t811 = -t284
      t819 = t6*t577*s3l2p+t6*z*s4l2p*t7
      t824 = t547*t66
      t826 = t547*t68
      t832 = t558*t66
      t836 = t563*t73
      t837 = 8192.D0/3.D0*t836
      t844 = t572*s3l1p
      t847 = t546*s4l1p*t7
      t861 = t616*t381
      t888 = t558*t68
      t895 = t546*t2*t412
      t898 = t546*t57*t348
      t925 = t722*s3l1p
      t929 = t16*s4l1p*t7
      t930 = t726*t929
      t937 = t492*t66
      t938 = t492*t68
      t950 = t166*t66
      t974 = -t417
      t982 = -t6*t577*s3l1p-t6*z*s4l1p*t7
      t987 = -t548-t550
      t988 = 256.D0/3.D0*t987
      t990 = t824+t826
      t991 = 256.D0/3.D0*t990
      t993 = t546*t31
      t995 = 256.D0/3.D0*t993*t445
      t997 = 256.D0/3.D0*t993*t447
      t1008 = t492*t445
      t1010 = t492*t447
      t1021 = 2*t141*t31
      t1025 = t993*t1*s4l2p*t7
      t1034 = t31*t1
      t1035 = t1034*t847
      t1043 = t1*t57
      t1044 = t1043*t546
      t1057 = t726*t5
      t1081 = t492*z
      t1088 = 1-t655
      t1089 = t1088*t1
      t1090 = t1089*t5
      t1094 = (2-z)*t1*t5
      t1106 = t1043*l3
      t1114 = t224*t31
      t1138 = -t453*t16
      t1146 = 6*t141*t16
      t1150 = 2304*t150
      t1153 = s34r*s23r
      t1170 = 2304*t338
      t1180 = 384*t249
      t1183 = 384*t392
      t1186 = 2304*t446
      t1187 = 2304*t448
      t1203 = t273*s3l2p
      t1213 = t273*s3l1p
      t1229 = t547*t7
      t1240 = t141*t5*t546
      t1243 = t1034*t546
      t1244 = t1243*t33
      t1258 = 384*t143*t573+1152*t558*t7
      t1262 = (14-t194)*t16
      t1265 = 6*z
      t1267 = (-t1265+11)*t16
      t1278 = -1536*t610+384*(5-t194)*t1*t16*t190
      t1302 = t1243*t83
      s3 = ((8192.D0/3.D0*t12*t14+((16384.D0/3.D0*t19-8192*t9-8192.D0/3.
     #D0*t11)*s23r+8192.D0/3.D0*t29-16384.D0/3.D0*t32*t33)*s1vr+16384.D0
     #/3.D0*t38*t40+(-8192*t29+8192*t45*s34r)*s23r-8192.D0/3.D0*t55+8192
     #.D0/3.D0*t61*t52)*s1l1+(8192.D0/3.D0*t70*t14+((-16384.D0/3.D0*t74+
     #8192*t67+8192.D0/3.D0*t69)*s23r-8192.D0/3.D0*t81+16384.D0/3.D0*t32
     #*t83)*s1vr+16384.D0/3.D0*t88*t40+(8192*t81+8192*t94*s34r)*s23r+819
     #2.D0/3.D0*t100+8192.D0/3.D0*t104*t52)*s1l2+(t110*s2l1+t113*s2l2)*t
     #14+((-t110*s2l1-t113*s2l2)*s23r+256.D0/3.D0*t123*s34r*s2l1+256.D0/
     #3.D0*t127*s34r*s2l2)*s1vr)*t134
      s7 = (((-8960.D0/3.D0*t139-256.D0/3.D0*t143*t144+17408.D0/3.D0*t15
     #0)*s23r+256.D0/3.D0*t154*t28+(-8192.D0/3.D0*t158+8192.D0/3.D0*t162
     #)*s34r+2048.D0/3.D0*t170*s3l2p+2048.D0/3.D0*t174*s4l2p*t7)*t14+((-
     #256.D0/3.D0*t181*t138+256.D0/3.D0*t184*t144+256.D0/3.D0*t143*t149)
     #*t40+(t199*s2l2+(31744.D0/3.D0*t158-1024.D0/3.D0*t162)*s34r-2048.D
     #0/3.D0*t210*s3l2p-2048.D0/3.D0*t214*s4l2p*t7)*s23r+t231*s2l2+16384
     #.D0/3.D0*t234*t235+(-4096.D0/3.D0*t239*t240*s3l2p+4096*t11)*s34r)*
     #s1vr+16384.D0/3.D0*t250*t252+(t255*s2l2+40960.D0/3.D0*t257*s34r-81
     #92.D0/3.D0*t136*t196*s3l2p-8192.D0/3.D0*t136*t195*s4l2p*t7)*t40+(t
     #277*s2l2+32768.D0/3.D0*t284*t52+(2048.D0/3.D0*t290*s3l2p+2048.D0/3
     #.D0*t289*s4l2p*t7)*s34r)*s23r+t308*s2l2+8192.D0/3.D0*t314*t301+(20
     #48.D0/3.D0*t321*s3l2p+2048.D0/3.D0*t320*s4l2p*t7)*t52)*s1l1
      s8 = (((8960.D0/3.D0*t331+256.D0/3.D0*t143*t333-17408.D0/3.D0*t338
     #)*s23r-256.D0/3.D0*t154*t80+(8192.D0/3.D0*t346-8192.D0/3.D0*t349)*
     #s34r-2048.D0/3.D0*t170*s3l1p-2048.D0/3.D0*t174*s4l1p*t7)*t14+((256
     #.D0/3.D0*t181*t330-256.D0/3.D0*t184*t333-256.D0/3.D0*t143*t337)*t4
     #0+(-t199*s2l1+(-31744.D0/3.D0*t346+1024.D0/3.D0*t349)*s34r+2048.D0
     #/3.D0*t210*s3l1p+2048.D0/3.D0*t214*s4l1p*t7)*s23r-t231*s2l1-16384.
     #D0/3.D0*t234*t381+(4096.D0/3.D0*t239*t240*s3l1p-4096*t69)*s34r)*s1
     #vr+16384.D0/3.D0*t393*t252+(-t255*s2l1+40960.D0/3.D0*t398*s34r+819
     #2.D0/3.D0*t136*t196*s3l1p+8192.D0/3.D0*t136*t195*s4l1p*t7)*t40+(-t
     #277*s2l1+32768.D0/3.D0*t417*t52+(-2048.D0/3.D0*t290*s3l1p-2048.D0/
     #3.D0*t289*s4l1p*t7)*s34r)*s23r-t308*s2l1+8192.D0/3.D0*t432*t301+(-
     #2048.D0/3.D0*t321*s3l1p-2048.D0/3.D0*t320*s4l1p*t7)*t52)*s1l2
      s6 = s7+s8
      s5 = s6+256.D0/3.D0*t449*t451+((-256.D0/3.D0*t455*t456+256.D0/3.D0
     #*t455*t459+1024.D0/3.D0*t446-1024.D0/3.D0*t448)*s23r+(-256.D0/3.D0
     #*t468-256.D0/3.D0*t469)*s2l1+(256.D0/3.D0*t474+256.D0/3.D0*t475)*s
     #2l2+512.D0/3.D0*t483*s34r+t487-t489)*t14+((-256*t493*t456+256*t493
     #*t459-256*t446+256*t448)*t40+(((-256*t158+256.D0/3.D0*t162)*s34r+2
     #56.D0/3.D0*t469)*s2l1+((256*t346-256.D0/3.D0*t349)*s34r-256.D0/3.D
     #0*t475)*s2l2-1024.D0/3.D0*t483*s34r-t487+t489)*s23r+(256.D0/3.D0*t
     #234*t10*t52+256.D0/3.D0*t157*t33)*s2l1+(-256.D0/3.D0*t234*t68*t52-
     #256.D0/3.D0*t157*t83)*s2l2+(-256.D0/3.D0*t531*t445+256.D0/3.D0*t53
     #1*t447)*t52+256.D0/3.D0*t539*s34r)*s1vr
      s6 = s13r
      s4 = s5*s6
      s2 = s3+s4
      s4 = s2
      s8 = ((-1024.D0/3.D0*t548-256.D0/3.D0*t550)*s23r+256.D0/3.D0*t555*
     #t33+256.D0/3.D0*t559)*t451+((t565-6400.D0/3.D0*t548-7936.D0/3.D0*t
     #550)*t40+(t580*s2l2+(-256.D0/3.D0*t583*t584-256.D0/3.D0*t586*t588)
     #*s34r-256.D0/3.D0*t595*t144-256.D0/3.D0*t603*s4l2p*t7)*s23r+t613*s
     #2l2+512.D0/3.D0*t617+(-256.D0/3.D0*t620*t144+10240.D0/3.D0*t150)*s
     #34r+2048.D0/3.D0*t626*t8+10240.D0/3.D0*t626*t10)*t14
      s7 = s8+((-t565+7424.D0/3.D0*t548+8192.D0/3.D0*t550)*t252+(t643*s2
     #l2+(256.D0/3.D0*t646*t584+512.D0/3.D0*t650*t588)*s34r+256.D0/3.D0*
     #t657*t144-768*t660)*t40+(t671*s2l2+(2304*t673+8192.D0/3.D0*t675)*t
     #52+(256.D0/3.D0*t681*t144+256.D0/3.D0*t684*t149)*s34r+2048.D0/3.D0
     #*t690*t691*s3l2p+2048.D0/3.D0*t695*t4*s4l2p*t7)*s23r+t711*s2l2-256
     #.D0/3.D0*t714*t8*t301+(-4096.D0/3.D0*t158-4096*t162)*t52+(-4096.D0
     #/3.D0*t166*t723-4096*t729)*s34r)*s1vr+(-8192.D0/3.D0*t558*t18+8192
     #.D0/3.D0*t736+8192.D0/3.D0*t737)*t252
      s6 = s7+(t747*s2l2+(-2048.D0/3.D0*t755*s3l2p-2048.D0/3.D0*t754*s4l
     #2p*t7)*s34r+8192.D0/3.D0*t762+8192.D0/3.D0*t166*t10)*t40+(t776*s2l
     #2+(-2048.D0/3.D0*t783*s3l2p-2048.D0/3.D0*t782*s4l2p*t7)*t52+(-2048
     #.D0/3.D0*t794*s3l2p-2048.D0/3.D0*t793*s4l2p*t7)*s34r)*s23r+t809*s2
     #l2+2048.D0/3.D0*t811*t301+2048.D0/3.D0*t819*t52
      s7 = s1l1
      s5 = s6*s7
      s3 = s4+s5
      s4 = s3
      s9 = ((1024.D0/3.D0*t824+256.D0/3.D0*t826)*s23r-256.D0/3.D0*t555*t
     #83-256.D0/3.D0*t832)*t451+((-t837+6400.D0/3.D0*t824+7936.D0/3.D0*t
     #826)*t40+(-t580*s2l1+(256.D0/3.D0*t583*t844+256.D0/3.D0*t586*t847)
     #*s34r+256.D0/3.D0*t595*t333+256.D0/3.D0*t603*s4l1p*t7)*s23r-t613*s
     #2l1-512.D0/3.D0*t861+(256.D0/3.D0*t620*t333-10240.D0/3.D0*t338)*s3
     #4r-2048.D0/3.D0*t626*t66-10240.D0/3.D0*t626*t68)*t14
      s8 = s9+((t837-7424.D0/3.D0*t824-8192.D0/3.D0*t826)*t252+(-t643*s2
     #l1+(-256.D0/3.D0*t646*t844-512.D0/3.D0*t650*t847)*s34r-256.D0/3.D0
     #*t657*t333+768*t888)*t40+(-t671*s2l1+(-2304*t895-8192.D0/3.D0*t898
     #)*t52+(-256.D0/3.D0*t681*t333-256.D0/3.D0*t684*t337)*s34r-2048.D0/
     #3.D0*t690*t691*s3l1p-2048.D0/3.D0*t695*t4*s4l1p*t7)*s23r-t711*s2l1
     #+256.D0/3.D0*t714*t66*t301+(4096.D0/3.D0*t346+4096*t349)*t52+(4096
     #.D0/3.D0*t166*t925+4096*t930)*s34r)*s1vr+(8192.D0/3.D0*t558*t73-81
     #92.D0/3.D0*t937-8192.D0/3.D0*t938)*t252
      s7 = s8+(-t747*s2l1+(2048.D0/3.D0*t755*s3l1p+2048.D0/3.D0*t754*s4l
     #1p*t7)*s34r-8192.D0/3.D0*t950-8192.D0/3.D0*t166*t68)*t40+(-t776*s2
     #l1+(2048.D0/3.D0*t783*s3l1p+2048.D0/3.D0*t782*s4l1p*t7)*t52+(2048.
     #D0/3.D0*t794*s3l1p+2048.D0/3.D0*t793*s4l1p*t7)*s34r)*s23r-t809*s2l
     #1+2048.D0/3.D0*t974*t301+2048.D0/3.D0*t982*t52
      s8 = s1l2
      s6 = s7*s8
      s7 = ((t988*s2l1+t991*s2l2+t995-t997)*s23r+256.D0/3.D0*t555*t8*s34
     #r*s2l1-256.D0/3.D0*t555*t66*s34r*s2l2+256.D0/3.D0*t1008-256.D0/3.D
     #0*t1010)*t451
      s5 = s6+s7
      s1 = s4+s5
      s3 = s1
      s5 = ((-t988*s2l1-t991*s2l2-t995+t997)*t40+(((-256.D0/3.D0*t1021*t
     #584+256.D0/3.D0*t1025)*s34r-256.D0/3.D0*t736-256.D0/3.D0*t737)*s2l
     #1+((256.D0/3.D0*t1021*t844-256.D0/3.D0*t1035)*s34r+256.D0/3.D0*t93
     #7+256.D0/3.D0*t938)*s2l2+(-256.D0/3.D0*t1044*t445+256.D0/3.D0*t104
     #4*t447)*s34r+256.D0/3.D0*t159*t445-256.D0/3.D0*t159*t447)*s23r+(25
     #6.D0/3.D0*t617+(-256.D0/3.D0*t1057*t144+256.D0/3.D0*t150)*s34r)*s2
     #l1+(-256.D0/3.D0*t861+(256.D0/3.D0*t1057*t333-256.D0/3.D0*t338)*s3
     #4r)*s2l2+512.D0/3.D0*t449*s34r)*t14
      s6 = (((256.D0/3.D0*t736+256.D0/3.D0*t737)*s2l1+(-256.D0/3.D0*t937
     #-256.D0/3.D0*t938)*s2l2-256.D0/3.D0*t1081*t445+256.D0/3.D0*t1081*t
     #447)*t40+((-256.D0/3.D0*t1090*t144-256.D0/3.D0*t1094*t149)*s34r*s2
     #l1+(256.D0/3.D0*t1090*t333+256.D0/3.D0*t1094*t337)*s34r*s2l2+(-256
     #.D0/3.D0*t1106*t445+256.D0/3.D0*t1106*t447)*s34r)*s23r+(256.D0/3.D
     #0*t1114*t144-256.D0/3.D0*t162)*t52*s2l1+(-256.D0/3.D0*t1114*t333+2
     #56.D0/3.D0*t349)*t52*s2l2+256.D0/3.D0*t483*t52)*s1vr
      s4 = s5+s6
      s2 = s3+s4
      s3 = s2+(1152*t109*s2l1+1152*t112*s2l2)*s23r*s1vr*t134
      s4 = s3+(((384*t1138*t138-1152*t249)*s23r*t14+((384*t1146*t138+230
     #4*t249+t1150)*t40+1152*t466*t8*t1153)*s1vr)*s1l1+((-384*t1138*t330
     #+1152*t392)*s23r*t14+((-384*t1146*t330-2304*t392-t1170)*t40-1152*t
     #466*t66*t1153)*s1vr)*s1l2+((t1180+t1150)*s2l1+(-t1183-t1170)*s2l2-
     #t1186+t1187)*s23r*t14+(((1152*t249-1152*t150)*s2l1+(-1152*t392+115
     #2*t338)*s2l2+t1186-t1187)*t40+(((-1920*t158-3456*t162)*s34r+1152*t
     #1089*t1203-1152*t729)*s2l1+((1920*t346+3456*t349)*s34r-1152*t1089*
     #t1213+1152*t930)*s2l2+2304*t483*s34r+1152*t486-1152*t488)*s23r)*s1
     #vr)*s13r
      t1337 = s4+(1920*t1229*s3l2p*s23r*t451+((1152*t564-5376*t548-2304*
     #t550)*t40+(-384*t1240*t28-2304*t1244-1152*t559)*s23r)*t14+(2304*t5
     #47*t8*t252+(t1258*s2l2+2688*t1244+384*t1262*t144+384*t1267*t149)*t
     #40+(t1278*s2l2+384*t617+(-768*t249+1152*t150)*s34r)*s23r)*s1vr)*s1
     #l1+(-1920*t1229*s3l1p*s23r*t451+((-1152*t836+5376*t824+2304*t826)*
     #t40+(384*t1240*t80+2304*t1302+1152*t832)*s23r)*t14+(-2304*t547*t66
     #*t252+(-t1258*s2l1+384*t619*t31*t546*t83-384*t1262*t333-384*t1267*
     #t337)*t40+(-t1278*s2l1-384*t861+(768*t392-1152*t338)*s34r)*s23r)*s
     #1vr)*s1l2
      t1340 = -t547*t456+t547*t459
      t1341 = 384*t1340
      t1350 = 768*t1244
      t1351 = -1-t655
      t1352 = t1351*t16
      t1357 = 768*t1302
      t1362 = 1920*t1008
      t1363 = 1920*t1010
      t1369 = 6*t3*t16
      t1380 = 768*t1008
      t1381 = 768*t1010
      t1386 = -t1*t750*t5
      t1402 = t453*l3*t31
      t1403 = t1402*t445
      t1404 = t1402*t447
      t1418 = 768*t11
      t1449 = 768*t69
      t1494 = t32*t7
      t1495 = s3l2p*s34r
      t1499 = s3l1p*s34r
      t1512 = t141*l3
      t1516 = 768*t150
      t1528 = -384*t191-768*t453*t4*t7
      t1532 = (-7-z)*t1
      t1535 = 3072*t729
      t1548 = 768*t191+384*(-19+t593)*t1*t691
      t1561 = (t136*(-5+t270)-3*t136*(3-13*z))*t7
      t1564 = 3+t205
      t1569 = t136*t1564-3*t136*(-3-t1265)
      t1576 = 5*z
      t1577 = -13+t1576
      t1579 = t344*s34r
      t1582 = 2688*t222+384*t1577*t16*t1579
      t1588 = 7*z
      t1590 = (-21+t1588)*t5
      t1591 = t344*s3l2p
      t1607 = -25344*t191-768*(-13+25*z)*t1*t691
      t1609 = -t257
      t1617 = t136*(-4+t1588)-3*t136*(3-t1265)
      t1618 = t1617*t7
      t1632 = -16128*t222-768*(-9+29*z)*t16*t1579
      t1641 = t6*(-3+t741)-3*t6*(2-t1588)
      t1642 = t1641*t7
      t1653 = -3072*t303-3072*t32*t53
      t1668 = 768*t338
      t1681 = 3072*t930
      t1719 = -t398
      t1774 = (-1+t1576)*t1
      t1778 = (7-t655)*t1
      t1792 = -t142*t5
      t1800 = (-5-z)*t1
      t1803 = (14-t741)*t1
      t1815 = (9-t1265)*t1*t5
      t1823 = (4+z)*t5
      t1826 = (4-z)*t5
      t1845 = t14**2
      t1853 = t547*t1
      t1858 = -t1088*l3
      t1868 = t722*s34r
      t1869 = t547*t1868
      t1875 = -2304*t1869+384*t238*t4*t137
      t1877 = t993*t723
      t1884 = (-6+22*z)*t16
      t1888 = (7+t741)*t16
      t1896 = -768*t610+768*t443*t16*t708
      t1901 = -t1564*t5*t1
      t1906 = -t1576-2
      t1907 = t1906*t4
      t1916 = 14*z
      t1921 = 16128*t1869+384*(t1916+12)*t4*t137
      t1927 = (-t1265-12)*t16
      t1930 = 10*z
      t1932 = (-5+t1930)*t16
      t1947 = 9216*t610+384*(11+18*z)*l3*t16*t1868-384*t1577*t3*t577
      t1954 = (-13-t1930)*t5*t1
      t1958 = (t270-11)*t5*t1
      t1963 = z**2
      t1966 = (-8-t1916+15*t1963)*t4
      t1971 = (t1265+8*t1963-8)*t4
      t1984 = 384*t1351*t5*t2*t705+384*(-t1576-8)*t1*t773
      t1987 = t1088*l3*t31
      t1994 = (-t194-8)*t1
      t2002 = -13+9*z
      t2003 = t2002*t4
      t2005 = -4+t194
      t2007 = 3-t655
      t2010 = t558*t2005-3*t558*t2007
      t2011 = t2010*t7
      t2026 = 768*(21*z-22)*l3*t16*t1868+768*t2002*t3*t577
      t2035 = t492*t1*(t1265-7)-15*t492*t1*t749
      t2036 = t2035*t7
      t2046 = t626*t2005-3*t626*t2007
      t2047 = t2046*t7
      t2055 = 12*z
      t2065 = 768*(-13+t2055)*t5*t2*t705+768*(-9+t2055)*z*t1*t773
      t2069 = 3*t749
      t2073 = t157*l3*t2005-3*t157*l3*t2069
      t2074 = t2073*t7
      t2088 = -t166*t1*t2069-3*t166*t1*(2-t194)
      t2089 = t2088*t7
      t2098 = 3072*t808
      t2129 = t546*t1*t803*s3l1p
      t2246 = (t205-7)*t16
      t2258 = (-5-t655)*t16
      t2276 = (2*t1963-t1588+5)*t4
      t2291 = t1088*t16
      t2299 = (-t1963-t1576+6)*t4
      t2311 = -t1906*t16
      t2319 = (-1+t1963-t655)*t16
      t2336 = (-z-3)*t1*t5
      s2 = t1341*s23r*t451+((2304*t987*s2l1+2304*t990*s2l2)*t40+((t1350-
     #384*t1352*t144)*s2l1+(-t1357+384*t1352*t333)*s2l2+t1362-t1363)*s23
     #r)*t14
      s3 = s2+(((-384*t1369*t144-2304*t737)*s2l1+(384*t1369*t333+2304*t9
     #38)*s2l2+t1380-t1381)*t40+(((384*t1386*t144+t1150)*s34r+1152*t762)
     #*s2l1+((-384*t1386*t333-t1170)*s34r-1152*t950)*s2l2+(768*t1403-768
     #*t1404)*s34r-1152*t166*t445+1152*t166*t447)*s23r)*s1vr
      s4 = s3
      s6 = (((2304*t19-4224*t9+t1418)*t14+((-11904*t19+19968*t9+7680*t11
     #)*s23r-4224*t29+(7296*t43+2304*t44)*s34r)*s1vr-12288*t38*t40+(1305
     #6*t29+13056*t123*s34r)*s23r+3072*t55-3072*t61*t52)*s1l1+((-2304*t7
     #4+4224*t67-t1449)*t14+((11904*t74-19968*t67-7680*t69)*s23r+4224*t8
     #1+(-7296*t92-2304*t93)*s34r)*s1vr-12288*t88*t40+(-13056*t81+13056*
     #t127*s34r)*s23r-3072*t100-3072*t104*t52)*s1l2+(-1152*t6*t456+1152*
     #t6*t459-2304*t537+2304*t538)*t14+((2304*t12*s2l1+2304*t70*s2l2+460
     #8*t537-4608*t538)*s23r+2304*t1494*t1495*s2l1-2304*t1494*t1499*s2l2
     #+(2304*t233*t445-2304*t233*t447)*s34r)*s1vr)*t134
      s10 = ((384*t1512*t273*s2l2+t1180-t1516)*t451+((3840*t139-11136*t2
     #49-5376*t150)*s23r+t1528*s2l2-1536*t468+384*t1532*t1203-t1535)*t14
     #+((384*t139-6144*t249+1536*t150)*t40+(t1548*s2l2+(-7296*t158+3072*
     #t162)*s34r-384*t1561*s3l2p-384*t1569*s4l2p*t7)*s23r+t1582*s2l2+(-3
     #456*t279-768*t283)*t52+(-384*t1590*t1591-t1418)*s34r)*s1vr-12288*t
     #250*t252+(t1607*s2l2+25344*t1609*s34r+768*t1618*s3l2p+768*t1617*s4
     #l2p*t7)*t40+(t1632*s2l2+16128*t811*t52+(768*t1642*s3l2p+768*t1641*
     #s4l2p*t7)*s34r)*s23r+t1653*s2l2-3072*t314*t301+(3072*t233*t8+3072*
     #t233*t10)*t52)*s1l1
      s11 = ((-384*t1512*t273*s2l1-t1183+t1668)*t451+((-3840*t331+11136*
     #t392+5376*t338)*s23r-t1528*s2l1+1536*t474-384*t1532*t1213+t1681)*t
     #14+((-384*t331+6144*t392-1536*t338)*t40+(-t1548*s2l1+(7296*t346-30
     #72*t349)*s34r+384*t1561*s3l1p+384*t1569*s4l1p*t7)*s23r-t1582*s2l1+
     #(3456*t413+768*t416)*t52+(384*t1590*t345+t1449)*s34r)*s1vr-12288*t
     #393*t252+(-t1607*s2l1+25344*t1719*s34r-768*t1618*s3l1p-768*t1617*s
     #4l1p*t7)*t40+(-t1632*s2l1+16128*t974*t52+(-768*t1642*s3l1p-768*t16
     #41*s4l1p*t7)*s34r)*s23r-t1653*s2l1-3072*t432*t301+(-3072*t233*t66-
     #3072*t233*t68)*t52)*s1l2
      s9 = s10+s11
      s8 = s9+((-1920*t249-t1516)*s2l1+(1920*t392+t1668)*s2l2)*t451+(((-
     #t1180+3072*t150)*s2l1+(t1183-3072*t338)*s2l2+768*t1403-768*t1404)*
     #s23r+(768*t1609*s34r-384*t1774*t1203+384*t1778*t728)*s2l1+(768*t17
     #19*s34r+384*t1774*t1213-384*t1778*t929)*s2l2-768*t1792*t445+768*t1
     #792*t447)*t14+(((384*t1800*t1203-384*t1803*t728)*s2l1+(-384*t1800*
     #t1213+384*t1803*t929)*s2l2+384*t1815*t445-384*t1815*t447)*s23r+(76
     #8*t1823*t1591-768*t1826*t161)*s34r*s2l1+(-768*t1823*t345+768*t1826
     #*t348)*s34r*s2l2-5376*t539*s34r)*s1vr
      s9 = s13r
      s7 = s8*s9
      s5 = s6+s7
      s1 = s4+s5
      s3 = s1
      s7 = 768*t547*t8*t1845+((384*t564+2688*t548)*s23r+768*t1853*t28-15
     #36*t1244+384*t1858*t1203)*t451+((-1536*t564+4608*t548+3072*t550)*t
     #40+(t1875*s2l2+(5376*t1877+3072*t1025)*s34r+384*t1884*t144+384*t18
     #88*t149)*s23r+t1896*s2l2+768*t617+(384*t1901*t144+t1516)*s34r+384*
     #t1907*t8)*t14+((6912*t564-6912*t548-6912*t550)*t252+(t1921*s2l2+(-
     #16128*t1877-16128*t1025)*s34r+384*t1927*t144-384*t1932*t149)*t40+(
     #t1947*s2l2+(-9216*t673-9216*t675)*t52+(384*t1954*t144-384*t1958*t1
     #49)*s34r+384*t1966*t8+384*t1971*t10)*s23r+t1984*s2l2+(-384*t1987*t
     #1591+2304*t162)*t52+(-384*t1994*t1203+t1535)*s34r)*s1vr+(768*t2003
     #*t138-768*t2011*s3l2p-768*t2010*s4l2p*t7)*t252
      s6 = s7+(t2026*s2l2+(-768*t2036*s3l2p-768*t2035*s4l2p*t7)*s34r-768
     #*t2047*s3l2p-768*t2046*s4l2p*t7)*t40+(t2065*s2l2+(-768*t2074*s3l2p
     #-768*t2073*s4l2p*t7)*t52+(-768*t2089*s3l2p-768*t2088*s4l2p*t7)*s34
     #r)*s23r+t2098*s2l2+3072*t811*t301+3072*t819*t52
      s7 = s1l1
      s5 = s6*s7
      s8 = -768*t547*t66*t1845+((-384*t836-2688*t824)*s23r-768*t1853*t80
     #+1536*t1302-384*t1858*t1213)*t451+((1536*t836-4608*t824-3072*t826)
     #*t40+(-t1875*s2l1+(-5376*t2129-3072*t1035)*s34r-384*t1884*t333-384
     #*t1888*t337)*s23r-t1896*s2l1-768*t861+(-384*t1901*t333-t1668)*s34r
     #-384*t1907*t66)*t14+((-6912*t836+6912*t824+6912*t826)*t252+(-t1921
     #*s2l1+(16128*t2129+16128*t1035)*s34r-384*t1927*t333+384*t1932*t337
     #)*t40+(-t1947*s2l1+(9216*t895+9216*t898)*t52+(-384*t1954*t333+384*
     #t1958*t337)*s34r-384*t1966*t66-384*t1971*t68)*s23r-t1984*s2l1+(384
     #*t1987*t345-2304*t349)*t52+(384*t1994*t1213-t1681)*s34r)*s1vr+(-76
     #8*t2003*t330+768*t2011*s3l1p+768*t2010*s4l1p*t7)*t252
      s7 = s8+(-t2026*s2l1+(768*t2036*s3l1p+768*t2035*s4l1p*t7)*s34r+768
     #*t2047*s3l1p+768*t2046*s4l1p*t7)*t40+(-t2065*s2l1+(768*t2074*s3l1p
     #+768*t2073*s4l1p*t7)*t52+(768*t2089*s3l1p+768*t2088*s4l1p*t7)*s34r
     #)*s23r-t2098*s2l1+3072*t974*t301+3072*t982*t52
      s8 = s1l2
      s6 = s7*s8
      s4 = s5+s6
      s2 = s3+s4
      t2344 = s2-768*t1340*t1845+(-t1341*s23r+(-t1350+384*t2246*t144)*s2
     #l1+(t1357-384*t2246*t333)*s2l2-t1380+t1381)*t451+(((-384*t2258*t14
     #4+2304*t660)*s2l1+(384*t2258*t333-2304*t888)*s2l2-t1362+t1363)*s23
     #r+(-768*t1386*t137*t1495+384*t2276*t8)*s2l1+(768*t1386*t137*t1499-
     #384*t2276*t66)*s2l2-768*t449*s34r+384*t2291*t445-384*t2291*t447)*t
     #14+(((-384*t2299*t8+2304*t728)*s2l1+(384*t2299*t66-2304*t929)*s2l2
     #-384*t2311*t445+384*t2311*t447)*s23r+(-768*t2319*t723-2304*t136*t1
     #0)*s34r*s2l1+(768*t2319*t925+2304*t136*t68)*s34r*s2l2+(-768*t2336*
     #t445+768*t2336*t447)*s34r)*s1vr
      taux12 = t1337+t2344

CCC Coefficients

      tcoff21 = taux11
      tcoff22 = taux11
      tcoff23 = taux12
      tcoff24 = taux12

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet21 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff21)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet22 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z
     #-t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff22)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet23 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff23)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet24 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z
     #-t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff24)

CCC Sum

      qgrmnum7e1 = tFjet21*tcoff21+tFjet22*tcoff22+tFjet23*tcoff23+tFjet
     #24*tcoff24
      RETURN
      END

      double precision function qgrmnum7e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = z**2
      t2 = z*t1
      t3 = -1+z
      t4 = t3**2
      t5 = t3*t4
      t6 = t2*t5
      t7 = l3-1
      t8 = t7**2
      t9 = 1/s3vr
      t10 = t8*t9
      t11 = s34r**2
      t16 = l3*t9
      t17 = s23r**2
      t18 = t17*s23r
      t19 = t16*t18
      t23 = t8*t7
      t24 = l3*t1*t23
      t25 = t4**2
      t26 = t25*t3
      t27 = t26*t9
      t28 = t11*s34r
      t29 = t27*t28
      t32 = 3*z
      t33 = -4+t32
      t38 = l3**2
      t39 = t38*l3
      t40 = t39*t25
      t43 = s1vr**2
      t44 = t43**2
      t48 = t38*t5
      t56 = l3*t25
      t57 = s4l2p*t9
      t58 = t57*s2l1
      t61 = s4l1p*t9
      t62 = t61*s2l2
      t69 = t25*t38
      t70 = t9*s34r
      t71 = t69*t70
      t74 = t57*s3l1p
      t76 = 64.D0/3.D0*t56*t74
      t77 = t61*s3l2p
      t79 = 64.D0/3.D0*t56*t77
      t82 = 128.D0/3.D0*t56*s4l2p*s4l1p
      t83 = 8*t1
      t87 = t4*l3
      t95 = t70*s2l2
      t98 = l3*t7
      t101 = z*t7
      t102 = t101*t25
      t103 = l3*s4l2p
      t104 = t103*t9
      t111 = t7*t26
      t112 = t16*s3l1p
      t115 = l3*s4l1p*t9
      t125 = t26*t38
      t126 = t9*t11
      t127 = t125*t126
      t130 = t98*t26
      t141 = t5*t7
      t142 = t141*l3
      t151 = t4*t9
      t156 = t8*t26
      t158 = t126*s2l2
      t162 = t25*t4
      t163 = t162*t9
      t166 = l3*t26
      t169 = t166*t8*s4l2p*t9
      t175 = t162*t8
      t179 = t166*t8*s4l1p*t9
      t184 = z*t38
      t185 = t184*t162
      t186 = t23*t9
      t188 = t185*t186*t28
      t194 = t56*t126
      t197 = 2-t32
      t200 = t151*s34r
      t206 = t39*t9
      t208 = z*t25*t206*t18
      t210 = z*t26
      t211 = t210*t7
      t213 = t211*t206*s34r
      t215 = 8*z
      t218 = t48*t9
      t226 = z*t162*t8*t206*t11
      t228 = 4*z
      t238 = t9*s3l2p
      t245 = t69*t7
      t246 = t245*t95
      t247 = 64.D0/3.D0*t246
      t248 = t111*t38
      t250 = t248*t238*s34r
      t252 = l3*t5
      t253 = t252*t238
      t256 = t43*s1vr
      t261 = 128.D0/3.D0*t246
      t265 = 448.D0/3.D0*t252*t57
      t268 = t38*t9
      t270 = t156*t268*t11
      t271 = 128.D0/3.D0*t270
      t272 = t16*s34r
      t273 = t141*t272
      t275 = t271+64.D0/3.D0*t273
      t277 = t175*t38
      t279 = t277*t238*t11
      t281 = t7*t25
      t282 = t16*s3l2p
      t283 = t281*t282
      t285 = t281*t104
      t289 = z*t4
      t291 = 512.D0/3.D0*t289*t238
      t293 = 512.D0/3.D0*t289*t57
      t301 = -t271-192*t273
      t314 = t25*t8
      t316 = t314*t16*t11
      t318 = t4*t7
      t319 = z*t9
      t320 = t319*s34r
      t322 = 512.D0/3.D0*t318*t320
      t323 = -64.D0/3.D0*t38*t23*t163*t28-192*t316-t322
      t325 = t5*t25
      t327 = t23*t325*t38
      t331 = t156*t282
      t336 = z*t5
      t337 = t7*t9
      t338 = t337*s3l2p
      t343 = t336*t338+t101*t5*s4l2p*t9
      t350 = -t283-t285
      t356 = 1024.D0/3.D0*t316+t322
      t358 = -t331-t169
      t366 = l3*t23
      t368 = z*t8
      t369 = t5*t9
      t373 = 512.D0/3.D0*t366*t29+512.D0/3.D0*t368*t369*t11
      t380 = -t23*t162*t282-t366*t162*s4l2p*t9
      t393 = t23*t25
      t395 = t393*t319*t43
      t397 = t319*s23r
      t398 = t393*t397
      t400 = t8**2
      t401 = t400*t9
      t403 = t210*t401*s34r
      t408 = s13r**2
      t409 = t408*s13r
      t414 = t268*t18
      t418 = -4+7*z
      t423 = (2+t32)*l3
      t442 = t40*t319*t17
      t445 = 2*z
      t448 = t184*t9
      t454 = t102*t268*s34r
      t458 = t9*s3l1p
      t465 = t70*s2l1
      t466 = t245*t465
      t467 = 64.D0/3.D0*t466
      t469 = t248*t458*s34r
      t471 = t252*t458
      t482 = 448.D0/3.D0*t252*t61
      t487 = t277*t458*t11
      t489 = t281*t112
      t491 = t281*t115
      t496 = 512.D0/3.D0*t289*t458
      t498 = 512.D0/3.D0*t289*t61
      t518 = t166*t10*s3l1p
      t528 = t336*t337*s3l1p+t101*t5*s4l1p*t9
      t535 = -t489-t491
      t541 = -t518-t179
      t555 = -t366*t163*s3l1p-t366*t162*s4l1p*t9
      t574 = 14*z
      t589 = 64.D0/3.D0*t56*t238
      t594 = t38*t7
      t604 = 64.D0/3.D0*t56*t458
      t634 = 2*t3*t7*t25
      t648 = t368*t38
      t649 = t27*t11
      t655 = t252*t70
      t659 = t1*t4*t9
      t668 = t102*t268*t17
      t670 = t27*s34r
      t671 = t648*t670
      t676 = t141*t9
      t684 = z+1
      t692 = t186*t11
      t693 = t185*t692
      t697 = t314*t70
      s2 = 1088.D0/3.D0*t6*t10*t11+512.D0/3.D0*t5*t1*t19+1088.D0/3.D0*t2
     #4*t29
      s3 = s2-192*t33*t1*t4*t19
      s4 = s3-192*t40*z*t9*s23r*t44
      s5 = s4
      s7 = (64.D0/3.D0*t48*z*(-10+18*z)*t9*t18+(64.D0/3.D0*t56*t58+64.D0
     #/3.D0*t56*t62+64.D0/3.D0*(-9+39*z)*z*t7*t71+t76+t79+(t82+64.D0/3.D
     #0*(19+t83-19*z)*z*t87)*t9)*t17+((128.D0/3.D0*t56*t7*t95+(-64.D0/3.
     #D0*t98*t27*s3l2p+64.D0/3.D0*t102*t104)*s34r)*s2l1+(-64.D0/3.D0*t11
     #1*t112+64.D0/3.D0*t102*t115)*s34r*s2l2+64.D0/3.D0*(21*z+12)*z*t8*t
     #127+(64.D0/3.D0*t130*t74+64.D0/3.D0*t130*t77+(128.D0/3.D0*t111*t10
     #3*s4l1p+64.D0/3.D0*(38-35*z+t83)*z*t142)*t9)*s34r+512.D0/3.D0*(-2-
     #z)*t1*t151)*s23r+(128.D0/3.D0*t156*l3*t158+(-64.D0/3.D0*l3*t8*t163
     #*s3l2p+64.D0/3.D0*t169)*t11)*s2l1+(-64.D0/3.D0*t175*t112+64.D0/3.D
     #0*t179)*t11*s2l2+704.D0/3.D0*t188+64.D0/3.D0*(19-16*z)*z*t8*t194+5
     #12.D0/3.D0*t197*t1*t7*t200)*s1vr
      s8 = (-96*t208+(-672*t213+96*(-5+t215)*z*t218)*t17+(-384*t226+96*(
     #-3+t228)*z*t7*t71)*s23r)*t43
      s6 = s7+s8
      s1 = s5+s6
      s3 = s1+(-64.D0/3.D0*t69*t238*t44+(128.D0/3.D0*t69*t238*s23r-t247+
     #64*t250+64.D0/3.D0*t253)*t256+(-64.D0/3.D0*t69*t238*t17+(t261-256.
     #D0/3.D0*t250-512.D0/3.D0*t253-t265)*s23r+t275*s2l2-64*t279+(-640.D
     #0/3.D0*t283-512.D0/3.D0*t285)*s34r-t291-t293)*t43+((-t247+64.D0/3.
     #D0*t250+448.D0/3.D0*t253+t265)*t17+(t301*s2l2+128.D0/3.D0*t279+(51
     #2*t283+1472.D0/3.D0*t285)*s34r+t291+t293)*s23r+t323*s2l2+64.D0/3.D
     #0*t327*t238*t28+(1088.D0/3.D0*t331+1024.D0/3.D0*t169)*t11+1024.D0/
     #3.D0*t343*s34r)*s1vr+(512.D0/3.D0*t142*t95+512.D0/3.D0*t350*s34r)*
     #t17+(t356*s2l2+1024.D0/3.D0*t358*t11-512.D0/3.D0*t343*s34r)*s23r+t
     #373*s2l2+512.D0/3.D0*t380*t28+(-512.D0/3.D0*t314*t319*s3l2p-512.D0
     #/3.D0*t314*z*s4l2p*t9)*t11)*s1l1
      s2 = s3+(-384*t395+(768*t398+384*t403)*s1vr)*t409+(-96*(-3+z)*z*t5
     #*t414+(-96*t418*z*t7*t71+96*t423*t336*t9)*t17+(-96*(-1+t228)*z*t8*
     #t127-96*t423*z*t141*t70)*s23r)*s1vr
      s3 = s2+(768*t442+(768*t213-96*(t445+1)*t5*t448)*s23r-192*t454)*t2
     #56
      s4 = s3+(-64.D0/3.D0*t69*t458*t44+(128.D0/3.D0*t69*t458*s23r-t467+
     #64*t469+64.D0/3.D0*t471)*t256+(-64.D0/3.D0*t69*t458*t17+(128.D0/3.
     #D0*t466-256.D0/3.D0*t469-512.D0/3.D0*t471-t482)*s23r+t275*s2l1-64*
     #t487+(-640.D0/3.D0*t489-512.D0/3.D0*t491)*s34r-t496-t498)*t43+((-t
     #467+64.D0/3.D0*t469+448.D0/3.D0*t471+t482)*t17+(t301*s2l1+128.D0/3
     #.D0*t487+(512*t489+1472.D0/3.D0*t491)*s34r+t496+t498)*s23r+t323*s2
     #l1+64.D0/3.D0*t327*t458*t28+(1088.D0/3.D0*t518+1024.D0/3.D0*t179)*
     #t11+1024.D0/3.D0*t528*s34r)*s1vr+(512.D0/3.D0*t142*t465+512.D0/3.D
     #0*t535*s34r)*t17+(t356*s2l1+1024.D0/3.D0*t541*t11-512.D0/3.D0*t528
     #*s34r)*s23r+t373*s2l1+512.D0/3.D0*t555*t28+(-512.D0/3.D0*t314*t319
     #*s3l1p-512.D0/3.D0*t314*z*s4l1p*t9)*t11)*s1l2
      s5 = s4
      s7 = (640.D0/3.D0*t208+(64.D0/3.D0*t69*t58+64.D0/3.D0*t69*t62+1472
     #.D0/3.D0*t213-64.D0/3.D0*(5+t574)*z*t218)*t17+((t261+(-64.D0/3.D0*
     #t125*t338+64.D0/3.D0*t125*t7*s4l2p*t9)*s34r+t589-64.D0/3.D0*t56*t5
     #7)*s2l1+((-64.D0/3.D0*t594*t27*s3l1p+64.D0/3.D0*t111*t38*s4l1p*t9)
     #*s34r+t604-64.D0/3.D0*t56*t61)*s2l2+832.D0/3.D0*t226-64.D0/3.D0*(3
     #6+17*z)*z*t7*t71-t76-t79+(-t82+64.D0/3.D0*(11*z-19-16*t1)*z*t87)*t
     #9)*s23r+((128.D0/3.D0*t270-128.D0/3.D0*t56*t337*s34r)*s2l2-64.D0/3
     #.D0*t279+(64.D0/3.D0*t634*t282-64.D0/3.D0*t285)*s34r)*s2l1+(-64.D0
     #/3.D0*t487+(64.D0/3.D0*t634*t112-64.D0/3.D0*t491)*s34r)*s2l2-1984.
     #D0/3.D0*t648*t649+64.D0/3.D0*(-19-t215)*z*t7*t655+1024.D0/3.D0*t65
     #9)*t43
      s8 = (-480*t102*t268*s23r*t256+(-192*t668+(384*t671-96*(-6+t32)*l3
     #*z*t676)*s23r)*t43+((288*t671-288*t684*l3*z*t676)*t17+(96*t693+96*
     #(-5+t32)*l3*z*t697)*s23r)*s1vr)*s13r
      s6 = s7+s8
      t706 = s5+s6
      t709 = 10*z
      t723 = 2*t1
      t726 = l3*z
      t727 = t726*t9
      t738 = t314*t126
      t743 = t2*t9
      t775 = t1*t9
      t786 = 1-t445
      t805 = 512.D0/3.D0*t141*t238+512.D0/3.D0*t141*t57
      t809 = t5*t8
      t811 = 512.D0/3.D0*t809*t95
      t814 = -t314*t238-t314*t57
      t826 = t26*t23
      t837 = 512.D0/3.D0*t141*t458+512.D0/3.D0*t141*t61
      t842 = 512.D0/3.D0*t809*t465
      t845 = -t314*t458-t314*t61
      t865 = t184*t25
      t867 = t865*t337*t44
      t870 = t102*t268*s23r
      t873 = -64.D0/3.D0*t350
      t876 = -64.D0/3.D0*t535
      t893 = 31*z
      t897 = t252*t9
      t904 = 128.D0/3.D0*t314*l3*t95
      t916 = t56*t70
      t929 = t865*t337*t18
      t976 = t184*t325*t401*t28
      t988 = t369*s34r
      t994 = t142*t775*t18
      t998 = t1*t8*t25*t272
      t1008 = t24*t649
      t1009 = t10*s34r
      t1017 = t400*t162*l3*t775*t28
      t1020 = -t684*t1
      s1 = (t805*t43+(-t805*s23r+t811+1024.D0/3.D0*t814*s34r)*s1vr+(-t81
     #1-512.D0/3.D0*t814*s34r)*s23r-512.D0/3.D0*t393*t158+(512.D0/3.D0*t
     #826*t238+512.D0/3.D0*t826*t57)*t11)*s1l1+(t837*t43+(-t837*s23r+t84
     #2+1024.D0/3.D0*t845*s34r)*s1vr+(-t842-512.D0/3.D0*t845*s34r)*s23r-
     #512.D0/3.D0*t393*t126*s2l1+(512.D0/3.D0*t826*t458+512.D0/3.D0*t826
     #*t61)*t11)*s1l2-256.D0/3.D0*t867+(448*t870+t873*s2l1+t876*s2l2+121
     #6.D0/3.D0*t671+64.D0/3.D0*t101*l3*t5*(t215-13)*t9)*t256+(-64.D0/3.
     #D0*t668+(-t873*s2l1-t876*s2l2-512.D0/3.D0*t671-64.D0/3.D0*(12-t893
     #)*z*t7*t897)*s23r+(t904+128.D0/3.D0*t358*s34r)*s2l1+128.D0/3.D0*t5
     #41*s34r*s2l2-640.D0/3.D0*t693-64.D0/3.D0*(-1-t215)*z*t8*t916+512.D
     #0/3.D0*(-t336*t7+t318*z*(-t32+1+t1))*t9)*t43
      t1024 = s1+(-1024.D0/3.D0*t929+(-2560.D0/3.D0*t671-64.D0/3.D0*(-25
     #+23*z)*z*t7*t897)*t17+((-t904-64.D0/3.D0*t358*s34r)*s2l1-64.D0/3.D
     #0*t541*s34r*s2l2-1856.D0/3.D0*t693+64.D0/3.D0*(37-t893)*z*t8*t916-
     #512.D0/3.D0*(2-t32-t723)*z*t318*t9)*s23r+(-128.D0/3.D0*t166*t23*t1
     #58-64.D0/3.D0*t380*t11)*s2l1-64.D0/3.D0*t555*t11*s2l2-320.D0/3.D0*
     #t976+64.D0/3.D0*(-t215+12)*z*t23*t166*t126-512.D0/3.D0*(2-5*z)*z*t
     #8*t988)*s1vr-1024.D0/3.D0*t994+(-2560.D0/3.D0*t998-512.D0/3.D0*t1*
     #t7*t4*(-1+t32)*t9)*t17+(-2048.D0/3.D0*t1008-2048.D0/3.D0*t6*t1009)
     #*s23r-512.D0/3.D0*t1017+512.D0/3.D0*t1020*t25*t692
      t1026 = 6*z
      t1028 = (-4+t1026)*z
      t1039 = 4*t1
      t1056 = 9*z
      t1070 = (t723+2-t32)*t4
      t1076 = t726*t8
      t1077 = t25*t9
      t1079 = t1076*t1077*t256
      t1082 = t1076*t1077*s23r
      t1085 = t726*t23*t670
      t1095 = t1076*t1077*t17
      t1106 = t401*t11
      t1107 = t726*t162*t1106
      t1118 = t809*t775*t17
      t1123 = t1*t23*t25*t70*s23r
      t1125 = t26*t1
      t1126 = t1125*t1106
      t1142 = z-2
      t1172 = t1**2
      t1199 = 192*t671
      t1216 = t101*t9
      s1 = (-576*t208+(-1152*t213+96*(-5+t709)*t5*t448)*t17+(-576*t226+9
     #6*(-3+t709)*z*t25*t594*t70+96*(t445+t723+3)*t4*t727)*s23r+96*t142*
     #t320)*t43+(-192*t33*l3*t1*t738-576*t4*t3*t7*t743*s34r)*s23r+(-896.
     #D0/3.D0*t442+((64.D0/3.D0*t69*t238-64.D0/3.D0*t69*t57)*s2l1+(64.D0
     #/3.D0*t69*t458-64.D0/3.D0*t69*t61)*s2l2-1088.D0/3.D0*t213+64.D0/3.
     #D0*t48*z*(-t228+15)*t9)*s23r+(-t261+128.D0/3.D0*t250-t589)*s2l1+(1
     #28.D0/3.D0*t469-t604)*s2l2+1280.D0/3.D0*t454+1024.D0/3.D0*t87*t775
     #)*t256+(1024.D0/3.D0*t395+(-1024.D0/3.D0*t398-1024.D0/3.D0*t403)*s
     #1vr)*t409+(-512.D0/3.D0*t786*t1*t7*t655+512.D0/3.D0*t4*t2*t9)*t17+
     #(480*t442+384*t211*t206*s34r*s23r)*t256+t1024*s13r
      s2 = s1+(-192*t1028*t5*t414+(-192*(-7+12*z)*z*t38*t281*t70-96*(-t3
     #2+t1039+7)*t4*t727)*t17+(-192*t1028*t8*t127-96*(-t32+t1039+8)*t7*z
     #*t655+96*(3*t1+2*t2+2-t1056)*t3*t319)*s23r+192*t188-96*t786*l3*z*t
     #738+96*t1070*t7*t320)*s1vr+(-192*t1079+(960*t1082+768*t1085+96*(-3
     #+t1026)*z*t809*t9)*t43+(-1536*t1095+(-2112*t1085-960*t368*t5*t3*t9
     #)*s23r-576*t1107-96*(t228-7)*z*t25*t186*s34r)*s1vr-768*t1118-960*t
     #1123-192*t1126)*t408+(-448.D0/3.D0*t1079+(-1600.D0/3.D0*t1082-384*
     #t1085+512.D0/3.D0*t368*t5*t197*t9)*t43+(2048.D0/3.D0*t1095+(1216*t
     #1085+512.D0/3.D0*t368*t5*t1142*t9)*s23r+1600.D0/3.D0*t1107+1024.D0
     #/3.D0*z*t23*t670)*s1vr+1024.D0/3.D0*t1118+512*t1123+512.D0/3.D0*t1
     #126)*t408
      t1274 = s2+(288*t1076*t1077*s23r*t43-288*t726*t826*t70*s23r*s1vr)*
     #t408+(-512.D0/3.D0*t1020*t8*t194+512.D0/3.D0*t1172*t7*t200)*s23r+(
     #256.D0/3.D0*t40*t397-64.D0/3.D0*t69*t238*s2l1-64.D0/3.D0*t69*t458*
     #s2l2)*t44+(-192*(t1026-7)*t1*t7*t655-192*t33*t3*t743)*t17+(192*t86
     #7+(-576*t870-t1199-96*t101*t897)*t256+((-t1199-96*(-10+t1026)*t7*z
     #*t897)*s23r-192*t693-192*t1142*l3*z*t697-96*t1070*t1216)*t43+(768*
     #t929+(1728*t671+96*(-18+t574)*t7*z*t897)*t17+(1152*t693+96*(-23+t5
     #74)*l3*z*t697-96*(-7+13*z)*t4*t1216)*s23r+192*t976-672*t726*t26*t6
     #92-96*(-5+t1056)*z*t5*t1009)*s1vr+768*t994+(1728*t998+192*t418*t7*
     #t659)*t17+(1152*t1008+192*(-3+t215)*t1*t8*t988)*s23r+192*t1017+192
     #*t1125*t692)*s13r
      taux11 = t706+t1274
      t1 = l3-1
      t2 = t1**2
      t3 = -1+z
      t4 = t3**2
      t5 = t4**2
      t6 = t2*t5
      t7 = 1/s3vr
      t8 = t7*s3l2p
      t9 = t6*t8
      t10 = s4l2p*t7
      t11 = t6*t10
      t14 = s1vr**2
      t16 = t4*t3
      t17 = t16*t2
      t18 = t7*s2l2
      t19 = t17*t18
      t25 = t2*t1
      t26 = t5*t25
      t27 = t7*s34r
      t28 = t27*s2l2
      t29 = t26*t28
      t31 = t5*t3
      t32 = t25*t31
      t33 = t8*s34r
      t38 = t19-t9-t11
      t40 = s23r**2
      t43 = t32*t8
      t44 = t32*t10
      t45 = -t43-t44
      t50 = t2**2
      t51 = t31*t50
      t52 = s34r**2
      t53 = t7*t52
      t55 = t51*t53*s2l2
      t57 = t5*t4
      t58 = t50*t57
      t61 = -t58*t8-t58*t10
      t66 = t7*s3l1p
      t67 = t6*t66
      t68 = s4l1p*t7
      t69 = t6*t68
      t73 = t7*s2l1
      t74 = t17*t73
      t80 = t27*s2l1
      t81 = t26*t80
      t83 = t66*s34r
      t88 = -t74+t67+t69
      t92 = t32*t66
      t93 = t32*t68
      t94 = t92+t93
      t100 = t51*t53*s2l1
      t104 = t58*t66+t58*t68
      t109 = -t9-t11
      t110 = 256.D0/3.D0*t109
      t112 = t67+t69
      t113 = 256.D0/3.D0*t112
      t123 = -t45
      t127 = -t94
      t134 = s13r**2
      t136 = l3*t5
      t137 = t136*t1
      t138 = t14*s1vr
      t142 = t1*t16
      t143 = l3*t7
      t144 = t143*s2l2
      t145 = t142*t144
      t147 = 2*t1
      t148 = t147*t5
      t149 = t143*s3l2p
      t150 = t148*t149
      t152 = t1*t5
      t153 = l3*s4l2p
      t154 = t153*t7
      t155 = t152*t154
      t159 = t6*l3
      t162 = t2*t31
      t163 = t162*t149
      t165 = l3*t31
      t168 = t165*t2*s4l2p*t7
      t172 = 4*t142
      t173 = z*t16
      t174 = t173*t1
      t177 = (t172+5*t174)*t7
      t181 = t172-5*t152
      t187 = -t1
      t189 = 39*t187*t16
      t192 = 77*t187*t5
      t194 = 3*t1
      t195 = t194*t5
      t200 = t143*s34r
      t201 = t6*t200
      t203 = t4*t1
      t204 = 3*z
      t205 = -1+t204
      t206 = t205*t7
      t208 = 10240.D0/3.D0*t203*t206
      t209 = 6912*t201+t208
      t215 = 4*z
      t216 = 1-t215
      t220 = (t172-5*t142*t216)*t7
      t224 = t172+10*t174
      t231 = t25*t7*t52
      t232 = t165*t231
      t235 = z*t2
      t242 = 3584*t232+2048.D0/3.D0*(4*t17+5*t235*t16)*t7*s34r
      t244 = t25*t57
      t245 = t244*l3
      t246 = t8*t52
      t249 = 5*z
      t250 = 4+t249
      t251 = t250*t2
      t252 = t5*t7
      t261 = t152*t149
      t262 = -t145+t261+t155
      t264 = t40*s23r
      t267 = -51200.D0/3.D0*t201-t208
      t269 = t163+t168
      t285 = t16*t7
      t289 = -40960.D0/3.D0*t232-2048.D0/3.D0*(-1+20*z)*t2*t285*s34r
      t291 = t244*t149
      t292 = l3*t25
      t295 = t292*t57*s4l2p*t7
      t296 = t291+t295
      t302 = 4*t6-5*t6*t216
      t303 = t302*t7
      t313 = t57*t7
      t314 = t52*s34r
      t315 = t313*t314
      t316 = l3*t50*t315
      t321 = -10240.D0/3.D0*t316-2048.D0/3.D0*t250*t5*t231
      t323 = t5*t16
      t324 = t50*t323
      t327 = t324*t149+t324*t154
      t334 = 4*t32+5*z*t25*t31
      t335 = t334*t7
      t347 = t143*s2l1
      t348 = t142*t347
      t350 = t143*s3l1p
      t351 = t148*t350
      t353 = l3*s4l1p
      t354 = t353*t7
      t355 = t152*t354
      t361 = t2*t7
      t362 = t361*s3l1p
      t363 = t165*t362
      t366 = t2*s4l1p*t7
      t367 = t165*t366
      t399 = t66*t52
      t410 = t152*t350
      t411 = t348-t410-t355
      t416 = -t363-t367
      t430 = t313*s3l1p
      t431 = t292*t430
      t434 = t292*t57*s4l1p*t7
      t435 = -t431-t434
      t450 = -t324*t350-t324*t354
      t461 = t8*s2l1
      t462 = t137*t461
      t464 = t66*s2l2
      t465 = t137*t464
      t468 = t1*l3*t31
      t469 = t10*s3l1p
      t470 = t468*t469
      t472 = t68*s3l2p
      t473 = t468*t472
      t478 = -t194*t5
      t479 = t478*l3
      t489 = 256.D0/3.D0*t168
      t493 = 256.D0/3.D0*t152*t8
      t497 = 256.D0/3.D0*t367
      t501 = 256.D0/3.D0*t152*t66
      t505 = l3*t2*t57
      t508 = -t505*t469+t505*t472
      t509 = 512.D0/3.D0*t508
      t511 = t152*t469
      t512 = 256.D0/3.D0*t511
      t513 = t152*t472
      t514 = 256.D0/3.D0*t513
      t551 = l3*t323*t25
      t557 = t162*t469
      t558 = t162*t472
      t559 = t557-t558
      t566 = l3**2
      t567 = t566*t5
      t568 = t14**2
      t570 = t567*t8*t568
      t572 = t567*t8
      t574 = t567*t10
      t575 = 256.D0/3.D0*t574
      t578 = t567*t1
      t579 = t578*t28
      t583 = 7*t187*t31*t566
      t586 = l3*t16
      t587 = t586*t8
      t591 = t16*t566
      t592 = t591*t18
      t593 = 10240.D0/3.D0*t592
      t600 = t566*t7
      t601 = t600*s34r
      t604 = l3*t4
      t605 = z*t7
      t608 = 11264.D0/3.D0*t187*t5*t601-10240.D0/3.D0*t604*t605
      t611 = 46*t187*t31
      t612 = t600*s3l2p
      t615 = 40*t187*t31
      t617 = t566*s4l2p*t7
      t624 = (33-40*z)*t16
      t627 = 8*z
      t630 = 16*z
      t634 = -t586*(t627-26)+2*t586*(-t630+25)
      t641 = t162*t600*t52
      t644 = -1024.D0/3.D0*t641-1024.D0/3.D0*t142*t200
      t646 = t2*t57
      t647 = t646*t566
      t648 = t647*t246
      t651 = 25*t1*t5
      t657 = z*t4
      t668 = 81*t187
      t674 = -256.D0/3.D0*t668*t5*t601+10240.D0/3.D0*t604*t7
      t676 = t668*t31
      t680 = 41*t187*t31
      t686 = t586*t10
      t696 = 10240.D0/3.D0*t657*t7
      t697 = 3584*t641-1024*t187*t16*t200-t696
      t699 = t646*t612
      t701 = t646*t617
      t706 = 58*t1*t5
      t709 = 140*t1*t5
      t715 = (-1+t249)*z
      t716 = t4*t7
      t720 = t250*z
      t730 = t143*t52
      t736 = 256.D0/3.D0*t566*t25*t315-7168.D0/3.D0*t6*t730-8192.D0/3.D0
     #*t203*t605*s34r
      t739 = t25*t323*t566
      t747 = t1*t7
      t748 = t747*s3l2p
      t751 = z*t1
      t753 = t16*s4l2p*t7
      t754 = t751*t753
      t761 = t136*t8
      t762 = t136*t10
      t766 = 10*z
      t772 = 2048.D0/3.D0*(-6+t766)*t1*t16*t200+t696
      t775 = -t3
      t780 = 4*t137-10*t136*t1*t775
      t781 = t780*t7
      t788 = t173*t8
      t799 = t716*s34r
      t802 = 2048.D0/3.D0*(3+t249)*t2*t5*t730+2048.D0/3.D0*t715*t1*t799
      t809 = 8*t162*l3-5*t162*l3*t775
      t810 = t809*t7
      t821 = 4*t174-5*t173*t1*t775
      t822 = t821*t7
      t831 = t31*t7
      t836 = t292*t831*t314+t235*t285*t52
      t837 = 8192.D0/3.D0*t836
      t839 = -t296
      t846 = t6*z*s4l2p*t7
      t847 = -t6*t605*s3l2p-t846
      t853 = t567*t66*t568
      t855 = t567*t66
      t857 = t567*t68
      t858 = 256.D0/3.D0*t857
      t861 = t578*t80
      t865 = t586*t66
      t869 = t591*t73
      t870 = 10240.D0/3.D0*t869
      t877 = t600*s3l1p
      t880 = t566*s4l1p*t7
      t894 = t647*t399
      t920 = t586*t68
      t927 = t566*t2*t430
      t930 = t566*t57*t366
      t957 = t747*s3l1p
      t961 = t16*s4l1p*t7
      t962 = t751*t961
      t969 = t136*t66
      t970 = t136*t68
      t982 = t173*t66
      t1006 = -t435
      t1013 = t6*z*s4l1p*t7
      t1014 = t6*t605*s3l1p+t1013
      t1019 = t567*t461
      t1020 = t567*t464
      t1021 = t1019-t1020
      t1030 = t566*t31
      t1031 = t1030*t469
      t1032 = 512.D0/3.D0*t1031
      t1033 = t1030*t472
      t1034 = 512.D0/3.D0*t1033
      t1039 = 4*t187*t31*t566
      t1050 = t136*t469
      t1052 = t136*t472
      t1064 = t1030*t1
      t1080 = t1*t57*t566
      t1083 = t1080*t469-t1080*t472
      t1086 = -1-z
      t1087 = 2*t1086
      t1089 = t1087*t5*l3
      t1099 = (6-t215)*t1*t5
      t1113 = t470-t473
      t1125 = t136*z
      t1127 = -3*t136-2*t1125
      t1136 = z-2
      t1138 = t1136*t1*t5
      t1150 = t1087*t31*t1
      t1162 = (3-z)*t2*t31
      t1185 = 768*t145
      t1186 = 1152*t261
      t1187 = 1536*t155
      t1197 = 1536*t168
      t1205 = 768*t348
      t1206 = 1152*t410
      t1207 = 1536*t355
      t1217 = 1536*t367
      t1242 = 2*z
      t1244 = (-1+t1242)*t1
      t1245 = t285*s3l2p
      t1255 = t285*s3l1p
      t1262 = 768*t508*s34r
      t1271 = t567*t7
      t1281 = -t147
      t1283 = t1281*t5*t566
      t1286 = t1030*t748
      t1290 = t1030*t1*s4l2p*t7
      t1295 = (-4+z)*t16
      t1311 = 384*t478*t601-1152*t586*t7
      t1318 = (-16+t204)*t16
      t1322 = (-13+z)*t16
      t1327 = 1536*t641
      t1333 = -t1327+384*(-7-t1242)*t1*t16*t200
      t1341 = (4+z)*t5*t1
      s3 = (((-10240.D0/3.D0*t9+10240.D0/3.D0*t11)*t14+((-20480.D0/3.D0*
     #t19+10240*t9+10240.D0/3.D0*t11)*s23r-10240.D0/3.D0*t29+20480.D0/3.
     #D0*t32*t33)*s1vr+20480.D0/3.D0*t38*t40+(10240*t29+10240*t45*s34r)*
     #s23r+10240.D0/3.D0*t55+10240.D0/3.D0*t61*t52)*s1l1+((10240.D0/3.D0
     #*t67-10240.D0/3.D0*t69)*t14+((20480.D0/3.D0*t74-10240*t67-10240.D0
     #/3.D0*t69)*s23r+10240.D0/3.D0*t81-20480.D0/3.D0*t32*t83)*s1vr+2048
     #0.D0/3.D0*t88*t40+(-10240*t81+10240*t94*s34r)*s23r-10240.D0/3.D0*t
     #100+10240.D0/3.D0*t104*t52)*s1l2+(t110*s2l1+t113*s2l2)*t14+((-t110
     #*s2l1-t113*s2l2)*s23r+256.D0/3.D0*t123*s34r*s2l1+256.D0/3.D0*t127*
     #s34r*s2l2)*s1vr)*t134
      s7 = (-256.D0/3.D0*t137*t8*t138+((10496.D0/3.D0*t145-256.D0/3.D0*t
     #150-21248.D0/3.D0*t155)*s23r-512.D0/3.D0*t159*t28+(3584*t163-10240
     #.D0/3.D0*t168)*s34r+2048.D0/3.D0*t177*s3l2p+2048.D0/3.D0*t181*s4l2
     #p*t7)*t14+((-256.D0/3.D0*t189*t144+256.D0/3.D0*t192*t149+256.D0/3.
     #D0*t195*t154)*t40+(t209*s2l2+(-40448.D0/3.D0*t163+256*t168)*s34r-2
     #048.D0/3.D0*t220*s3l2p-2048.D0/3.D0*t224*s4l2p*t7)*s23r+t242*s2l2-
     #6912*t245*t246+(-4096.D0/3.D0*t251*t252*s3l2p-26624.D0/3.D0*t11)*s
     #34r)*s1vr+20480.D0/3.D0*t262*t264+(t267*s2l2+51200.D0/3.D0*t269*s3
     #4r+10240.D0/3.D0*t142*t206*s3l2p+10240.D0/3.D0*t142*t205*s4l2p*t7)
     #*t40+(t289*s2l2+40960.D0/3.D0*t296*t52+(2048.D0/3.D0*t303*s3l2p+20
     #48.D0/3.D0*t302*s4l2p*t7)*s34r)*s23r+t321*s2l2+10240.D0/3.D0*t327*
     #t314+(2048.D0/3.D0*t335*s3l2p+2048.D0/3.D0*t334*s4l2p*t7)*t52)*s1l
     #1
      s8 = (256.D0/3.D0*t137*t66*t138+((-10496.D0/3.D0*t348+256.D0/3.D0*
     #t351+21248.D0/3.D0*t355)*s23r+512.D0/3.D0*t159*t80+(-3584*t363+102
     #40.D0/3.D0*t367)*s34r-2048.D0/3.D0*t177*s3l1p-2048.D0/3.D0*t181*s4
     #l1p*t7)*t14+((256.D0/3.D0*t189*t347-256.D0/3.D0*t192*t350-256.D0/3
     #.D0*t195*t354)*t40+(-t209*s2l1+(40448.D0/3.D0*t363-256*t367)*s34r+
     #2048.D0/3.D0*t220*s3l1p+2048.D0/3.D0*t224*s4l1p*t7)*s23r-t242*s2l1
     #+6912*t245*t399+(4096.D0/3.D0*t251*t252*s3l1p+26624.D0/3.D0*t69)*s
     #34r)*s1vr+20480.D0/3.D0*t411*t264+(-t267*s2l1+51200.D0/3.D0*t416*s
     #34r-10240.D0/3.D0*t142*t206*s3l1p-10240.D0/3.D0*t142*t205*s4l1p*t7
     #)*t40+(-t289*s2l1+40960.D0/3.D0*t435*t52+(-2048.D0/3.D0*t303*s3l1p
     #-2048.D0/3.D0*t302*s4l1p*t7)*s34r)*s23r-t321*s2l1+10240.D0/3.D0*t4
     #50*t314+(-2048.D0/3.D0*t335*s3l1p-2048.D0/3.D0*t334*s4l1p*t7)*t52)
     #*s1l2
      s6 = s7+s8
      s5 = s6+(-1024.D0/3.D0*t462+1024.D0/3.D0*t465+256.D0/3.D0*t470-256
     #.D0/3.D0*t473)*t138+((-256.D0/3.D0*t479*t461+256.D0/3.D0*t479*t464
     #-512.D0/3.D0*t470+512.D0/3.D0*t473)*s23r+((1792.D0/3.D0*t163+t489)
     #*s34r+t493)*s2l1+((-1792.D0/3.D0*t363-t497)*s34r-t501)*s2l2+t509*s
     #34r-t512+t514)*t14+((256.D0/3.D0*t462-256.D0/3.D0*t465+256.D0/3.D0
     #*t470-256.D0/3.D0*t473)*t40+(((-512.D0/3.D0*t163-t489)*s34r-t493)*
     #s2l1+((512.D0/3.D0*t363+t497)*s34r+t501)*s2l2-t509*s34r+t512-t514)
     #*s23r+((-256*t291-256.D0/3.D0*t295)*t52-256.D0/3.D0*t162*t33)*s2l1
     #+((256*t431+256.D0/3.D0*t434)*t52+256.D0/3.D0*t162*t83)*s2l2+(256.
     #D0/3.D0*t551*t469-256.D0/3.D0*t551*t472)*t52+256.D0/3.D0*t559*s34r
     #)*s1vr
      s6 = s13r
      s4 = s5*s6
      s2 = s3+s4
      s4 = s2
      s8 = 256*t570+((-1024.D0/3.D0*t572+t575)*s23r+256*t579+256.D0/3.D0
     #*t583*t33-1024.D0/3.D0*t587)*t138
      s7 = s8+((-t593+10496.D0/3.D0*t572+10240.D0/3.D0*t574)*t40+(t608*s
     #2l2+(-256.D0/3.D0*t611*t612-256.D0/3.D0*t615*t617)*s34r-256.D0/3.D
     #0*t624*t149-256.D0/3.D0*t634*s4l2p*t7)*s23r+t644*s2l2+1280.D0/3.D0
     #*t648+(-256.D0/3.D0*t651*t149-6144*t155)*s34r-8192.D0/3.D0*t657*t8
     #-6144*t657*t10)*t14+((t593-10240.D0/3.D0*t572-10496.D0/3.D0*t574)*
     #t264+(t674*s2l2+(256.D0/3.D0*t676*t612+512.D0/3.D0*t680*t617)*s34r
     #-256*t587+3072*t686)*t40+(t697*s2l2+(-3584*t699-10496.D0/3.D0*t701
     #)*t52+(256.D0/3.D0*t706*t149+256.D0/3.D0*t709*t154)*s34r+2048.D0/3
     #.D0*t715*t716*s3l2p+2048.D0/3.D0*t720*t4*s4l2p*t7)*s23r+t736*s2l2-
     #256.D0/3.D0*t739*t8*t314+(15616.D0/3.D0*t163+26624.D0/3.D0*t168)*t
     #52+(16384.D0/3.D0*t173*t748+26624.D0/3.D0*t754)*s34r)*s1vr+(10240.
     #D0/3.D0*t586*t18-10240.D0/3.D0*t761-10240.D0/3.D0*t762)*t264
      s6 = s7+(t772*s2l2+(-2048.D0/3.D0*t781*s3l2p-2048.D0/3.D0*t780*s4l
     #2p*t7)*s34r-10240.D0/3.D0*t788-10240.D0/3.D0*t173*t10)*t40+(t802*s
     #2l2+(-2048.D0/3.D0*t810*s3l2p-2048.D0/3.D0*t809*s4l2p*t7)*t52+(-20
     #48.D0/3.D0*t822*s3l2p-2048.D0/3.D0*t821*s4l2p*t7)*s34r)*s23r+t837*
     #s2l2+8192.D0/3.D0*t839*t314+8192.D0/3.D0*t847*t52
      s7 = s1l1
      s5 = s6*s7
      s3 = s4+s5
      s4 = s3
      s9 = -256*t853+((1024.D0/3.D0*t855-t858)*s23r-256*t861-256.D0/3.D0
     #*t583*t83+1024.D0/3.D0*t865)*t138
      s8 = s9+((t870-10496.D0/3.D0*t855-10240.D0/3.D0*t857)*t40+(-t608*s
     #2l1+(256.D0/3.D0*t611*t877+256.D0/3.D0*t615*t880)*s34r+256.D0/3.D0
     #*t624*t350+256.D0/3.D0*t634*s4l1p*t7)*s23r-t644*s2l1-1280.D0/3.D0*
     #t894+(256.D0/3.D0*t651*t350+6144*t355)*s34r+8192.D0/3.D0*t657*t66+
     #6144*t657*t68)*t14+((-t870+10240.D0/3.D0*t855+10496.D0/3.D0*t857)*
     #t264+(-t674*s2l1+(-256.D0/3.D0*t676*t877-512.D0/3.D0*t680*t880)*s3
     #4r+256*t865-3072*t920)*t40+(-t697*s2l1+(3584*t927+10496.D0/3.D0*t9
     #30)*t52+(-256.D0/3.D0*t706*t350-256.D0/3.D0*t709*t354)*s34r-2048.D
     #0/3.D0*t715*t716*s3l1p-2048.D0/3.D0*t720*t4*s4l1p*t7)*s23r-t736*s2
     #l1+256.D0/3.D0*t739*t66*t314+(-15616.D0/3.D0*t363-26624.D0/3.D0*t3
     #67)*t52+(-16384.D0/3.D0*t173*t957-26624.D0/3.D0*t962)*s34r)*s1vr+(
     #-10240.D0/3.D0*t586*t73+10240.D0/3.D0*t969+10240.D0/3.D0*t970)*t26
     #4
      s7 = s8+(-t772*s2l1+(2048.D0/3.D0*t781*s3l1p+2048.D0/3.D0*t780*s4l
     #1p*t7)*s34r+10240.D0/3.D0*t982+10240.D0/3.D0*t173*t68)*t40+(-t802*
     #s2l1+(2048.D0/3.D0*t810*s3l1p+2048.D0/3.D0*t809*s4l1p*t7)*t52+(204
     #8.D0/3.D0*t822*s3l1p+2048.D0/3.D0*t821*s4l1p*t7)*s34r)*s23r-t837*s
     #2l1+8192.D0/3.D0*t1006*t314+8192.D0/3.D0*t1014*t52
      s8 = s1l2
      s6 = s7*s8
      s7 = 256*t1021*t568
      s5 = s6+s7
      s1 = s4+s5
      s2 = s1+(((-512.D0/3.D0*t572+t575)*s2l1+(512.D0/3.D0*t855-t858)*s2
     #l2-t1032+t1034)*s23r+(256.D0/3.D0*t1039*t33+256*t761)*s2l1+(-256.D
     #0/3.D0*t1039*t83-256*t969)*s2l2-256.D0/3.D0*t1050+256.D0/3.D0*t105
     #2)*t138+(((-256.D0/3.D0*t572-256.D0/3.D0*t574)*s2l1+(256.D0/3.D0*t
     #855+256.D0/3.D0*t857)*s2l2+t1032-t1034)*t40+((-256.D0/3.D0*t1064*t
     #10*s34r-512.D0/3.D0*t761+256.D0/3.D0*t762)*s2l1+(256.D0/3.D0*t1064
     #*t68*s34r+512.D0/3.D0*t969-256.D0/3.D0*t970)*s2l2+512.D0/3.D0*t108
     #3*s34r+256.D0/3.D0*t1089*t469-256.D0/3.D0*t1089*t472)*s23r+(256.D0
     #/3.D0*t648+(256.D0/3.D0*t1099*t149-256.D0/3.D0*t155)*s34r)*s2l1+(-
     #256.D0/3.D0*t894+(-256.D0/3.D0*t1099*t350+256.D0/3.D0*t355)*s34r)*
     #s2l2+512.D0/3.D0*t1113*s34r)*t14
      s3 = s2+(((-256.D0/3.D0*t761-256.D0/3.D0*t762)*s2l1+(256.D0/3.D0*t
     #969+256.D0/3.D0*t970)*s2l2-256.D0/3.D0*t1127*s4l2p*t66+256.D0/3.D0
     #*t1127*s4l1p*t8)*t40+((-256.D0/3.D0*t150-256.D0/3.D0*t1138*t154)*s
     #34r*s2l1+(256.D0/3.D0*t351+256.D0/3.D0*t1138*t354)*s34r*s2l2+(-256
     #.D0/3.D0*t1150*t153*t66+256.D0/3.D0*t1150*t353*t8)*s34r)*s23r+(-25
     #6.D0/3.D0*t1162*t149+256.D0/3.D0*t168)*t52*s2l1+(256.D0/3.D0*t1162
     #*t350-256.D0/3.D0*t367)*t52*s2l2+256.D0/3.D0*t508*t52)*s1vr
      s4 = s3+(1152*t109*s2l1+1152*t112*s2l2)*s23r*s1vr*t134
      s5 = s4
      s7 = (((t1185+t1186+t1187)*s23r*t14+((384*t145-1920*t261-1920*t155
     #)*t40+(-1152*t163-t1197)*s34r*s23r)*s1vr)*s1l1+((-t1205-t1206-t120
     #7)*s23r*t14+((-384*t348+1920*t410+1920*t355)*t40+(1152*t363+t1217)
     #*s34r*s23r)*s1vr)*s1l2+768*t1113*s23r*t14+(((-t1186-384*t155)*s2l1
     #+(t1206+384*t355)*s2l2-768*t470+768*t473)*t40+(((2688*t163+1152*t1
     #68)*s34r+1152*t1244*t1245+1152*t754)*s2l1+((-2688*t363-1152*t367)*
     #s34r-1152*t1244*t1255-1152*t962)*s2l2+t1262-1152*t511+1152*t513)*s
     #23r)*s1vr)*s13r
      s8 = (-384*t1271*s3l2p*s23r*t138+((-1536*t592+2304*t572+768*t574)*
     #t40+(-384*t1283*t28+(-1536*t1286-768*t1290)*s34r-384*t1295*t149)*s
     #23r)*t14+((384*t592-1152*t572-384*t574)*t264+(t1311*s2l2+(768*t128
     #6+384*t1290)*s34r+384*t1318*t149+384*t1322*t154)*t40+(t1333*s2l2+(
     #1920*t699+768*t701)*t52+(384*t1341*t149-1152*t155)*s34r)*s23r)*s1v
     #r)*s1l1
      s6 = s7+s8
      t1353 = s5+s6
      t1367 = t566*t1*t831*s3l1p
      t1370 = t31*t1*t880
      t1417 = 768*t1031
      t1418 = 768*t1033
      t1432 = t1064*t33
      t1435 = -t1087*t16
      t1440 = t1064*t83
      t1457 = -t249+4
      t1458 = t1457*t16
      t1471 = (-z-3)*t5*l3
      t1480 = (-t249+6)*t1*t5
      t1497 = -t1136*t1*l3
      t1517 = 2304*t11
      t1548 = 2304*t69
      t1584 = t32*t7
      t1585 = s3l2p*s34r
      t1589 = s3l1p*s34r
      t1603 = 768*t155
      t1614 = 768*t201-1536*t203*t7
      t1620 = (7-t215)*t1
      t1623 = 3840*t754
      t1636 = -3072*t201+384*(22-34*z)*t1*t716
      t1645 = 13*z
      t1650 = (-3*t142*(-5+t630)+2*t142*(3-t1645))*t7
      t1656 = 6*z
      t1657 = -3-t1656
      t1660 = -3*t142*(3+t215)+2*t142*t1657
      t1669 = t361*s34r
      t1672 = -4608*t232+384*(11-t627)*t16*t1669
      t1680 = (21-14*z)*t5
      t1681 = t361*s3l2p
      t1697 = 33024*t201-768*(18-33*z)*t1*t716
      t1702 = 7*z
      t1709 = -3*t142*(-4+t1702)+2*t142*(3-t1656)
      t1710 = t1709*t7
      t1724 = 21504*t232-768*(13-38*z)*t16*t1669
      t1734 = -3*t6*(-3+t627)+2*t6*(2-t1702)
      t1735 = t1734*t7
      t1746 = 3840*t316+3840*t32*t53
      t1759 = 768*t355
      t1774 = 3840*t962
      t1852 = t187*t31*l3
      t1853 = t1852*t469
      t1855 = t1852*t472
      t1871 = 8*t1086*t1
      t1874 = -3+t1242
      t1875 = t1874*t1
      t1890 = t751*t5
      t1897 = t187*t16
      t1900 = (-4+t1242)*t1
      t1912 = (-5-t1242)*t1*t5
      t1920 = (-t204-4)*t5
      t1932 = t1086*t31*t2
      t1948 = t216*l3
      t1958 = t747*s34r
      t1959 = t567*t1958
      t1964 = 4608*t1959-384*t1657*t4*t143
      t1972 = (4-24*z)*t16
      t1976 = (-4-t766)*t16
      t1986 = t1327+384*(-1-t215)*t1*t16*t200
      t1989 = -3+t215
      t1991 = t1989*t5*t1
      t1997 = (z+6)*t4
      t2006 = 18*z
      t2011 = -21504*t1959+384*(-19-t2006)*t4*t143
      t2017 = (17+t1242)*t16
      t2021 = 14*t775*t16
      t2036 = -11520*t641+384*(-t2006-24)*l3*t16*t1958-384*(18-t627)*t3*
     #t605
      t2043 = (30+t1242)*t5*t1
      t2047 = (20-t2006)*t5*t1
      t2053 = z**2
      t2056 = (10+21*z-24*t2053)*t4
      t2062 = (-11*z-10*t2053+10)*t4
      t2075 = -384*(5-t215)*t5*t2*t730+384*(z+10)*t1*t799
      t2079 = (-13+t215)*l3*t31
      t2086 = (-t249+10)*t1
      t2093 = 18-t1645
      t2094 = t2093*t4
      t2096 = -4+t204
      t2099 = -t1874
      t2102 = -3*t586*t2096+2*t586*t2099
      t2103 = t2102*t7
      t2118 = 768*(-28*z+31)*l3*t16*t1958+768*t2093*t3*t605
      t2128 = -3*t136*t1*(t1656-7)+10*t136*t1*t775
      t2129 = t2128*t7
      t2140 = -3*t657*t2096+2*t657*t2099
      t2141 = t2140*t7
      t2149 = 15*z
      t2159 = 768*(18-t2149)*t5*t2*t730+768*(13-t2149)*z*t1*t799
      t2164 = 3*t775
      t2168 = -3*t162*l3*t2096+2*t162*l3*t2164
      t2169 = t2168*t7
      t2184 = 3*t173*t1*t2164+2*t173*t1*(2-t204)
      t2185 = t2184*t7
      t2194 = 3840*t836
      t2337 = (2-t627)*t16
      t2361 = (-7-t215)*t5*l3
      t2370 = -t1989*l3*t5
      t2376 = (3+t1242-4*t2053)*t4
      t2392 = (t1242+1)*t16
      t2400 = -t1457*t4
      t2411 = 2*t2053
      t2413 = (-t2411-6-t1702)*t16
      t2421 = (3+t204-t2411)*t16
      t2438 = -t1086*t1*t5
      s2 = (384*t1271*s3l1p*s23r*t138+((1536*t869-2304*t855-768*t857)*t4
     #0+(384*t1283*t80+(1536*t1367+768*t1370)*s34r+384*t1295*t350)*s23r)
     #*t14+((-384*t869+1152*t855+384*t857)*t264+(-t1311*s2l1+(384*t1281*
     #t31*t877-384*t1370)*s34r-384*t1318*t350-384*t1322*t354)*t40+(-t133
     #3*s2l1+(-1920*t927-768*t930)*t52+(-384*t1341*t350+1152*t355)*s34r)
     #*s23r)*s1vr)*s1l2+(384*t1019-384*t1020+t1417-t1418)*s23r*t138+(((1
     #920*t572+1536*t574)*s2l1+(-1920*t855-1536*t857)*s2l2-t1417+t1418)*
     #t40+((-1920*t1432-384*t1435*t149)*s2l1+(1920*t1440+384*t1435*t350)
     #*s2l2-768*t1083*s34r+768*t1125*t469-768*t1125*t472)*s23r)*t14
      s3 = s2+(((-384*t1458*t149+1536*t762)*s2l1+(384*t1458*t350-1536*t9
     #70)*s2l2+768*t1471*t469-768*t1471*t472)*t40+(((384*t1480*t149-t118
     #7)*s34r-1152*t788)*s2l1+((-384*t1480*t350+t1207)*s34r+1152*t982)*s
     #2l2+(768*t1497*t31*s4l2p*t66-768*t1497*t31*s4l1p*t8)*s34r+1152*t17
     #3*t469-1152*t173*t472)*s23r)*s1vr
      s4 = s3
      s6 = (((-1536*t19+4608*t9-t1517)*t14+((11520*t19-22272*t9-6912*t11
     #)*s23r+4608*t29+(-8448*t43-1536*t44)*s34r)*s1vr-15360*t38*t40+(-17
     #664*t29+17664*t123*s34r)*s23r-3840*t55-3840*t61*t52)*s1l1+((1536*t
     #74-4608*t67+t1548)*t14+((-11520*t74+22272*t67+6912*t69)*s23r-4608*
     #t81+(8448*t92+1536*t93)*s34r)*s1vr-15360*t88*t40+(17664*t81+17664*
     #t127*s34r)*s23r+3840*t100-3840*t104*t52)*s1l2+768*t559*t14+((-1536
     #*t6*t461+1536*t6*t464-1536*t557+1536*t558)*s23r-768*t1584*t1585*s2
     #l1+768*t1584*t1589*s2l2+(-768*t244*t469+768*t244*t472)*s34r)*s1vr)
     #*t134
      s10 = ((t1185+1536*t261+t1603)*t138+((-3072*t145+7680*t261+7680*t1
     #55)*s23r+t1614*s2l2+(-5376*t163+t1197)*s34r+384*t1620*t1245+t1623)
     #*t14+((9216*t261-4608*t155)*t40+(t1636*s2l2+(15360*t163-4608*t168)
     #*s34r-384*t1650*s3l2p-384*t1660*s4l2p*t7)*s23r+t1672*s2l2+(7680*t2
     #91+1536*t295)*t52+(-384*t1680*t1681+t1517)*s34r)*s1vr-15360*t262*t
     #264+(t1697*s2l2-33024*t269*s34r+768*t1710*s3l2p+768*t1709*s4l2p*t7
     #)*t40+(t1724*s2l2+21504*t839*t52+(768*t1735*s3l2p+768*t1734*s4l2p*
     #t7)*s34r)*s23r+t1746*s2l2-3840*t327*t314+(-3840*t244*t8-3840*t244*
     #t10)*t52)*s1l1
      s11 = ((-t1205-1536*t410-t1759)*t138+((3072*t348-7680*t410-7680*t3
     #55)*s23r-t1614*s2l1+(5376*t363-t1217)*s34r-384*t1620*t1255-t1774)*
     #t14+((-9216*t410+4608*t355)*t40+(-t1636*s2l1+(-15360*t363+4608*t36
     #7)*s34r+384*t1650*s3l1p+384*t1660*s4l1p*t7)*s23r-t1672*s2l1+(-7680
     #*t431-1536*t434)*t52+(384*t1680*t362-t1548)*s34r)*s1vr-15360*t411*
     #t264+(-t1697*s2l1-33024*t416*s34r-768*t1710*s3l1p-768*t1709*s4l1p*
     #t7)*t40+(-t1724*s2l1+21504*t1006*t52+(-768*t1735*s3l1p-768*t1734*s
     #4l1p*t7)*s34r)*s23r-t1746*s2l1-3840*t450*t314+(3840*t244*t66+3840*
     #t244*t68)*t52)*s1l2
      s9 = s10+s11
      s8 = s9+((3072*t261+t1603)*s2l1+(-3072*t410-t1759)*s2l2-768*t1853+
     #768*t1855)*t138+((-768*t137*t10*s2l1+768*t137*t68*s2l2+768*t1853-7
     #68*t1855)*s23r+((-2304*t163-768*t168)*s34r-384*t1871*t1245+384*t18
     #75*t753)*s2l1+((2304*t363+768*t367)*s34r+384*t1871*t1255-384*t1875
     #*t961)*s2l2+t1262+768*t1890*t469-768*t1890*t472)*t14+(((384*t1897*
     #t8-384*t1900*t753)*s2l1+(-384*t1897*t66+384*t1900*t961)*s2l2+384*t
     #1912*t469-384*t1912*t472)*s23r+(768*t1920*t1681-768*t846)*s34r*s2l
     #1+(-768*t1920*t362+768*t1013)*s34r*s2l2+(768*t1932*t469-768*t1932*
     #t472)*s34r)*s1vr
      s9 = s13r
      s7 = s8*s9
      s5 = s6+s7
      s1 = s4+s5
      s3 = s1
      s7 = -1536*t570+(-768*t591*t18*s23r-1536*t579+3072*t1432+384*t1948
     #*t1245)*t138+((3072*t592-9216*t572-4608*t574)*t40+(t1964*s2l2+(-10
     #752*t1286-4608*t1290)*s34r+384*t1972*t149+384*t1976*t154)*s23r+t19
     #86*s2l2-1536*t648+(768*t1991*t149-768*t155)*s34r+384*t1997*t8)*t14
     #+((-9984*t592+9984*t572+9984*t574)*t264+(t2011*s2l2+(21504*t1286+2
     #1504*t1290)*s34r+384*t2017*t149-384*t2021*t154)*t40+(t2036*s2l2+(1
     #1520*t699+11520*t701)*t52+(384*t2043*t149-384*t2047*t154)*s34r+384
     #*t2056*t8+384*t2062*t10)*s23r+t2075*s2l2+(-384*t2079*t1681-2304*t1
     #68)*t52+(-384*t2086*t1245-t1623)*s34r)*s1vr+(768*t2094*t144-768*t2
     #103*s3l2p-768*t2102*s4l2p*t7)*t264
      s6 = s7+(t2118*s2l2+(-768*t2129*s3l2p-768*t2128*s4l2p*t7)*s34r-768
     #*t2141*s3l2p-768*t2140*s4l2p*t7)*t40+(t2159*s2l2+(-768*t2169*s3l2p
     #-768*t2168*s4l2p*t7)*t52+(-768*t2185*s3l2p-768*t2184*s4l2p*t7)*s34
     #r)*s23r+t2194*s2l2+3840*t839*t314+3840*t847*t52
      s7 = s1l1
      s5 = s6*s7
      s8 = 1536*t853+(768*t591*t73*s23r+1536*t861-3072*t1440-384*t1948*t
     #1255)*t138+((-3072*t869+9216*t855+4608*t857)*t40+(-t1964*s2l1+(107
     #52*t1367+4608*t1370)*s34r-384*t1972*t350-384*t1976*t354)*s23r-t198
     #6*s2l1+1536*t894+(-768*t1991*t350+768*t355)*s34r-384*t1997*t66)*t1
     #4+((9984*t869-9984*t855-9984*t857)*t264+(-t2011*s2l1+(-21504*t1367
     #-21504*t1370)*s34r-384*t2017*t350+384*t2021*t354)*t40+(-t2036*s2l1
     #+(-11520*t927-11520*t930)*t52+(-384*t2043*t350+384*t2047*t354)*s34
     #r-384*t2056*t66-384*t2062*t68)*s23r-t2075*s2l1+(384*t2079*t362+230
     #4*t367)*t52+(384*t2086*t1255+t1774)*s34r)*s1vr+(-768*t2094*t347+76
     #8*t2103*s3l1p+768*t2102*s4l1p*t7)*t264
      s7 = s8+(-t2118*s2l1+(768*t2129*s3l1p+768*t2128*s4l1p*t7)*s34r+768
     #*t2141*s3l1p+768*t2140*s4l1p*t7)*t40+(-t2159*s2l1+(768*t2169*s3l1p
     #+768*t2168*s4l1p*t7)*t52+(768*t2185*s3l1p+768*t2184*s4l1p*t7)*s34r
     #)*s23r-t2194*s2l1+3840*t1006*t314+3840*t1014*t52
      s8 = s1l2
      s6 = s7*s8
      s4 = s5+s6
      s2 = s3+s4
      t2446 = s2-1536*t1021*t568+((768*t1031-768*t1033)*s23r+(1536*t1432
     #+384*t2337*t149)*s2l1+(-1536*t1440-384*t2337*t350)*s2l2+768*t1050-
     #768*t1052)*t138+(((-1920*t587-1536*t686)*s2l1+(1920*t865+1536*t920
     #)*s2l2-384*t2361*t469+384*t2361*t472)*s23r+(-768*t2370*t747*t1585+
     #384*t2376*t8)*s2l1+(768*t2370*t747*t1589-384*t2376*t66)*s2l2-1536*
     #t1113*s34r+384*t2392*t469-384*t2392*t472)*t14+(((-384*t2400*t8-153
     #6*t753)*s2l1+(384*t2400*t66+1536*t961)*s2l2-384*t2413*t469+384*t24
     #13*t472)*s23r+(-768*t2421*t748+1536*t142*t10)*s34r*s2l1+(768*t2421
     #*t957-1536*t142*t68)*s34r*s2l2+(-1536*t2438*t469+1536*t2438*t472)*
     #s34r)*s1vr
      taux12 = t1353+t2446

CCC Coefficients

      tcoff21 = taux11
      tcoff22 = taux11
      tcoff23 = taux12
      tcoff24 = taux12

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet21 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff21)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet22 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z
     #-t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff22)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet23 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff23)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet24 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z
     #-t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff24)

CCC Sum

      qgrmnum7e2 = tFjet21*tcoff21+tFjet22*tcoff22+tFjet23*tcoff23+tFjet
     #24*tcoff24
      RETURN
      END

      double precision function qgrmnum7e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = z**2
      t2 = l3-1
      t3 = t2**2
      t5 = -1+z
      t6 = t5**2
      t7 = t6**2
      t9 = 1/s3vr
      t11 = s34r**2
      t15 = z*t1
      t18 = t6*t9*s34r
      t23 = l3**2
      t24 = t23*l3
      t25 = t24*t7
      t28 = s1vr**2
      t29 = t28**2
      t37 = t9*s34r
      t38 = t7*t23*t37
      t42 = t6*l3
      t43 = t42*t9
      t47 = s23r**2
      t52 = t5*t7
      t54 = t9*t11
      t62 = t6*t5
      t63 = t62*l3
      t64 = t63*t37
      t69 = 512.D0/3.D0*t1*t6*t9
      t72 = z*t23
      t73 = t7*t6
      t74 = t72*t73
      t75 = t3*t2
      t76 = t75*t9
      t77 = t11*s34r
      t81 = 8*z
      t89 = 2*z
      t90 = -1+t89
      t104 = t24*t9
      t106 = z*t52*t2*t104*s34r
      t111 = (-8+z)*z*t62*t23*t9
      t130 = z*t3*t23
      t131 = t52*t9
      t156 = z*t7*t2
      t157 = t23*t9
      t161 = t1*t9
      t165 = t28*s1vr
      t174 = t2*t9
      t182 = t130*t131*s34r
      t187 = 192*z*t2*t63*t9
      t193 = t76*t11
      t194 = t74*t193
      t196 = l3*z
      t198 = t7*t9
      t200 = t196*t3*t198*s34r
      t204 = 512.D0/3.D0*z*t62*t174
      t213 = t3**2
      s1 = (-1024.D0/3.D0*t1*t3*t7*l3*t9*t11-512.D0/3.D0*t15*t2*t18)*s23
     #r+64.D0/3.D0*t25*z*t9*s23r*t29+((64.D0/3.D0*(-7+z)*z*t2*t38+448.D0
     #/3.D0*t5*z*t43)*t47+(64.D0/3.D0*(z-14)*z*t3*t52*t23*t54+64.D0/3.D0
     #*(-14+15*z)*z*t2*t64+t69)*s23r-448.D0/3.D0*t74*t76*t77+64.D0/3.D0*
     #(-7+t81)*z*t3*t7*l3*t54+512.D0/3.D0*t90*t1*t2*t18)*s1vr-512.D0/3.D
     #0*t15*t62*t3*t9*t11
      taux11 = s1+((64.D0/3.D0*t106-64.D0/3.D0*t111)*t47+(64.D0/3.D0*z*t
     #73*t3*t104*t11-64.D0/3.D0*(-22+t89)*z*t2*t38+64.D0/3.D0*(7+z)*z*t4
     #3)*s23r+896.D0/3.D0*t130*t131*t11+64.D0/3.D0*(7+t81)*z*t2*t64-t69)
     #*t28-512.D0/3.D0*l3*t1*t75*t131*t77+(-64.D0/3.D0*t25*z*t9*t47+(-12
     #8.D0/3.D0*t106+64.D0/3.D0*t111)*s23r-448.D0/3.D0*t156*t157*s34r-51
     #2.D0/3.D0*t42*t161)*t165-512.D0/3.D0*t2*t62*l3*t161*s34r*t47+(-64.
     #D0/3.D0*t72*t7*t174*t29+(64.D0/3.D0*t156*t157*s23r+64*t182+t187)*t
     #165+((-128.D0/3.D0*t182-t187)*s23r-64*t194-384*t200+t204)*t28+((64
     #.D0/3.D0*t194+192*t200-t204)*s23r+64.D0/3.D0*t72*t7*t62*t213*t9*t7
     #7+192*t196*t52*t193-512.D0/3.D0*t90*z*t3*t62*t9*s34r)*s1vr+512.D0/
     #3.D0*t62*t3*t1*t37*s23r+512.D0/3.D0*t1*t75*t198*t11)*s13r
      t1 = l3-1
      t2 = t1**2
      t3 = -1+z
      t4 = t3**2
      t5 = t4**2
      t6 = t2*t5
      t7 = 1/s3vr
      t8 = t7*s3l2p
      t9 = t6*t8
      t10 = s4l2p*t7
      t11 = t6*t10
      t12 = t9-t11
      t14 = s1vr**2
      t16 = t4*t3
      t17 = t16*t2
      t18 = t7*s2l2
      t19 = t17*t18
      t25 = t2*t1
      t26 = t5*t25
      t27 = t7*s34r
      t28 = t27*s2l2
      t29 = t26*t28
      t31 = t5*t3
      t32 = t25*t31
      t33 = t8*s34r
      t34 = t32*t33
      t38 = -t19+t9+t11
      t40 = s23r**2
      t45 = t32*t8+t32*t10
      t50 = t2**2
      t51 = t31*t50
      t52 = s34r**2
      t53 = t7*t52
      t55 = t51*t53*s2l2
      t57 = t5*t4
      t58 = t50*t57
      t61 = t58*t8+t58*t10
      t66 = t7*s3l1p
      t67 = t6*t66
      t68 = s4l1p*t7
      t69 = t6*t68
      t70 = -t67+t69
      t73 = t7*s2l1
      t74 = t17*t73
      t80 = t27*s2l1
      t81 = t26*t80
      t83 = t66*s34r
      t84 = t32*t83
      t88 = t74-t67-t69
      t94 = -t32*t66-t32*t68
      t100 = t51*t53*s2l1
      t104 = -t58*t66-t58*t68
      t109 = -t9-t11
      t110 = 512.D0/3.D0*t109
      t112 = t67+t69
      t113 = 512.D0/3.D0*t112
      t132 = s13r**2
      t134 = l3*t5
      t135 = t134*t1
      t136 = t14*s1vr
      t140 = t1*t16
      t141 = l3*t7
      t142 = t141*s2l2
      t143 = t140*t142
      t145 = t1*t5
      t146 = t141*s3l2p
      t147 = t145*t146
      t150 = l3*s4l2p*t7
      t151 = t145*t150
      t155 = t2*t31
      t156 = t155*t146
      t158 = l3*t31
      t161 = t158*t2*s4l2p*t7
      t165 = 5*t140
      t166 = z*t16
      t167 = t166*t1
      t170 = (-t165-2*t167)*t7
      t174 = -t165+2*t145
      t180 = 1536*t143
      t182 = 512.D0/3.D0*t151
      t185 = t141*s34r
      t186 = t6*t185
      t188 = t4*t1
      t189 = 3*z
      t190 = -1+t189
      t191 = t190*t7
      t193 = 4096.D0/3.D0*t188*t191
      t194 = -8704.D0/3.D0*t186-t193
      t197 = 512.D0/3.D0*t161
      t200 = 4*z
      t201 = 1-t200
      t205 = (-t165+2*t140*t201)*t7
      t209 = -t165-4*t167
      t216 = t25*t7*t52
      t217 = t158*t216
      t220 = z*t2
      t227 = -4096.D0/3.D0*t217+2048.D0/3.D0*(-5*t17-2*t220*t16)*t7*s34r
      t229 = t25*t57
      t230 = t229*l3
      t231 = t8*t52
      t232 = t230*t231
      t234 = 2*z
      t235 = -5-t234
      t236 = t235*t2
      t237 = t5*t7
      t246 = t143-t147-t151
      t248 = t40*s23r
      t251 = 20480.D0/3.D0*t186+t193
      t253 = -t156-t161
      t266 = 8*z
      t269 = t16*t7
      t273 = 16384.D0/3.D0*t217-2048.D0/3.D0*(-3-t266)*t2*t269*s34r
      t275 = t229*t146
      t276 = l3*t25
      t279 = t276*t57*s4l2p*t7
      t280 = -t275-t279
      t286 = -5*t6+2*t6*t201
      t287 = t286*t7
      t297 = t57*t7
      t298 = t52*s34r
      t299 = t297*t298
      t300 = l3*t50*t299
      t305 = 4096.D0/3.D0*t300-2048.D0/3.D0*t235*t5*t216
      t307 = t5*t16
      t308 = t50*t307
      t311 = -t308*t146-t308*t150
      t318 = -5*t32-2*z*t25*t31
      t319 = t318*t7
      t331 = t141*s2l1
      t332 = t140*t331
      t334 = t141*s3l1p
      t335 = t145*t334
      t338 = l3*s4l1p*t7
      t339 = t145*t338
      t343 = t2*t7
      t344 = t343*s3l1p
      t345 = t158*t344
      t348 = t2*s4l1p*t7
      t349 = t158*t348
      t360 = 1536*t332
      t362 = 512.D0/3.D0*t339
      t368 = 512.D0/3.D0*t349
      t380 = t66*t52
      t381 = t230*t380
      t391 = -t332+t335+t339
      t396 = t345+t349
      t410 = t297*s3l1p
      t411 = t276*t410
      t414 = t276*t57*s4l1p*t7
      t415 = t411+t414
      t430 = t308*t334+t308*t338
      t441 = t8*s2l1
      t442 = t135*t441
      t444 = t66*s2l2
      t445 = t135*t444
      t448 = t1*l3*t31
      t449 = t10*s3l1p
      t450 = t448*t449
      t452 = t68*s3l2p
      t453 = t448*t452
      t459 = 9*t1*t5*l3
      t472 = 512.D0/3.D0*t145*t8
      t479 = 512.D0/3.D0*t145*t66
      t483 = l3*t2*t57
      t486 = -t483*t449+t483*t452
      t487 = 1024.D0/3.D0*t486
      t489 = t145*t449
      t490 = 512.D0/3.D0*t489
      t491 = t145*t452
      t492 = 512.D0/3.D0*t491
      t529 = l3*t307*t25
      t535 = t155*t449
      t536 = t155*t452
      t544 = l3**2
      t545 = t544*t5
      t546 = t14**2
      t550 = t545*t8
      t552 = t545*t10
      t553 = 512.D0/3.D0*t552
      t556 = t545*t1
      t557 = t556*t28
      t561 = 15*t31*t1*t544
      t564 = l3*t16
      t565 = t564*t8
      t569 = t16*t544
      t570 = t569*t18
      t571 = 4096.D0/3.D0*t570
      t578 = t544*t7
      t579 = t578*s34r
      t582 = l3*t4
      t583 = z*t7
      t586 = 6656.D0/3.D0*t1*t5*t579+4096.D0/3.D0*t582*t583
      t589 = 44*t31*t1
      t590 = t578*s3l2p
      t593 = t544*t31
      t596 = t593*t1*s4l2p*t7
      t600 = 16*z
      t602 = (-38+t600)*t16
      t609 = -7*t564+2*t564*(t266-26)
      t616 = t155*t578*t52
      t618 = t140*t185
      t620 = 2560.D0/3.D0*t616+256*t618
      t622 = t2*t57
      t623 = t622*t544
      t624 = t623*t231
      t626 = -t1
      t628 = 32*t626*t5
      t634 = z*t4
      t642 = 1536*t552
      t651 = -9472.D0/3.D0*t1*t5*t579-4096.D0/3.D0*t582*t7
      t654 = 45*t31*t1
      t657 = 3072*t596
      t671 = 4096.D0/3.D0*t634*t7
      t672 = -6656.D0/3.D0*t616-1792*t626*t16*t185+t671
      t674 = t622*t590
      t678 = t622*t544*s4l2p*t7
      t679 = 1536*t678
      t683 = 100*t626*t5
      t686 = 139*t626*t5
      t692 = (-3-t234)*z
      t693 = t4*t7
      t697 = t235*z
      t707 = t141*t52
      t708 = t6*t707
      t713 = -1280.D0/3.D0*t544*t25*t299+9472.D0/3.D0*t708+10240.D0/3.D0
     #*t188*t583*s34r
      t716 = t25*t307*t544
      t724 = t1*t7
      t725 = t724*s3l2p
      t728 = z*t1
      t730 = t16*s4l2p*t7
      t731 = t728*t730
      t738 = t134*t8
      t739 = t134*t10
      t748 = 2048.D0/3.D0*(-1-t200)*t1*t16*t185-t671
      t751 = -t3
      t752 = 2*t751
      t756 = -5*t135+2*t134*t1*t752
      t757 = t756*t7
      t764 = t166*t8
      t775 = t693*s34r
      t778 = 2048.D0/3.D0*(-8-t234)*t2*t5*t707+2048.D0/3.D0*t692*t1*t775
      t780 = t155*l3
      t785 = -10*t780+2*t155*l3*t751
      t786 = t785*t7
      t797 = -5*t167+2*t166*t1*t751
      t798 = t797*t7
      t807 = t31*t7
      t812 = -t276*t807*t298-t220*t269*t52
      t813 = 10240.D0/3.D0*t812
      t815 = -t280
      t819 = t6*t583*s3l2p
      t822 = t6*z*s4l2p*t7
      t823 = t819+t822
      t831 = t545*t66
      t833 = t545*t68
      t834 = 512.D0/3.D0*t833
      t837 = t556*t80
      t841 = t564*t66
      t845 = t569*t73
      t846 = 4096.D0/3.D0*t845
      t853 = t578*s3l1p
      t856 = t31*t1
      t859 = t856*t544*s4l1p*t7
      t872 = t623*t380
      t886 = 1536*t833
      t893 = 3072*t859
      t904 = t544*t2*t410
      t907 = t544*t57*t348
      t908 = 1536*t907
      t938 = t16*s4l1p*t7
      t939 = t728*t938
      t946 = t134*t66
      t947 = t134*t68
      t959 = t166*t66
      t983 = -t415
      t987 = t6*t583*s3l1p
      t990 = t6*z*s4l1p*t7
      t991 = -t987-t990
      t996 = t545*t441
      t997 = t545*t444
      t1011 = 10*t31*t1*t544
      t1022 = t134*t449
      t1024 = t134*t452
      t1037 = 7*t31*t1
      t1063 = 10*t3*t1*t5
      t1077 = t450-t453
      t1094 = 7*t3*t1*t5
      t1097 = z-2
      t1098 = t1097*t1
      t1099 = t1098*t5
      t1119 = 5*t3*t2*t31
      t1142 = s23r*t14
      t1148 = s34r*s23r
      t1170 = 1536*t450
      t1171 = 1536*t453
      t1176 = 2304*t151
      t1180 = 2304*t339
      t1189 = -1+t234
      t1190 = t1189*t1
      t1191 = t269*s3l2p
      t1192 = t1190*t1191
      t1201 = t269*s3l1p
      t1202 = t1190*t1201
      t1207 = 1536*t486
      t1217 = t545*t7
      t1227 = t593*t725
      t1233 = (-6+t189)*t16
      t1243 = t724*s34r
      t1244 = t545*t1243
      t1247 = 2304*t1244-2304*t564*t7
      t1253 = -4+t189
      t1254 = t1253*t16
      t1255 = t1254*t146
      t1257 = t190*t16
      t1264 = 3072*t616+3840*t618
      t1271 = (-8+t189)*t5*t1
      s3 = ((4096.D0/3.D0*t12*t14+((8192.D0/3.D0*t19-4096*t9-4096.D0/3.D
     #0*t11)*s23r+4096.D0/3.D0*t29-8192.D0/3.D0*t34)*s1vr+8192.D0/3.D0*t
     #38*t40+(-4096*t29+4096*t45*s34r)*s23r-4096.D0/3.D0*t55+4096.D0/3.D
     #0*t61*t52)*s1l1+(4096.D0/3.D0*t70*t14+((-8192.D0/3.D0*t74+4096*t67
     #+4096.D0/3.D0*t69)*s23r-4096.D0/3.D0*t81+8192.D0/3.D0*t84)*s1vr+81
     #92.D0/3.D0*t88*t40+(4096*t81+4096*t94*s34r)*s23r+4096.D0/3.D0*t100
     #+4096.D0/3.D0*t104*t52)*s1l2+(t110*s2l1+t113*s2l2)*t14+((-t110*s2l
     #1-t113*s2l2)*s23r+512.D0/3.D0*t45*s34r*s2l1+512.D0/3.D0*t94*s34r*s
     #2l2)*s1vr)*t132
      s7 = (512.D0/3.D0*t135*t8*t136+((-3584.D0/3.D0*t143-1024.D0/3.D0*t
     #147+2560*t151)*s23r+(-5120.D0/3.D0*t156+4096.D0/3.D0*t161)*s34r+20
     #48.D0/3.D0*t170*s3l2p+2048.D0/3.D0*t174*s4l2p*t7)*t14+((-t180+8704
     #.D0/3.D0*t147+t182)*t40+(t194*s2l2+(17408.D0/3.D0*t156+t197)*s34r-
     #2048.D0/3.D0*t205*s3l2p-2048.D0/3.D0*t209*s4l2p*t7)*s23r+t227*s2l2
     #+8704.D0/3.D0*t232+(-4096.D0/3.D0*t236*t237*s3l2p+8192*t11)*s34r)*
     #s1vr+8192.D0/3.D0*t246*t248+(t251*s2l2+20480.D0/3.D0*t253*s34r-409
     #6.D0/3.D0*t140*t191*s3l2p-4096.D0/3.D0*t140*t190*s4l2p*t7)*t40+(t2
     #73*s2l2+16384.D0/3.D0*t280*t52+(2048.D0/3.D0*t287*s3l2p+2048.D0/3.
     #D0*t286*s4l2p*t7)*s34r)*s23r+t305*s2l2+4096.D0/3.D0*t311*t298+(204
     #8.D0/3.D0*t319*s3l2p+2048.D0/3.D0*t318*s4l2p*t7)*t52)*s1l1
      s8 = (-512.D0/3.D0*t135*t66*t136+((3584.D0/3.D0*t332+1024.D0/3.D0*
     #t335-2560*t339)*s23r+(5120.D0/3.D0*t345-4096.D0/3.D0*t349)*s34r-20
     #48.D0/3.D0*t170*s3l1p-2048.D0/3.D0*t174*s4l1p*t7)*t14+((t360-8704.
     #D0/3.D0*t335-t362)*t40+(-t194*s2l1+(-17408.D0/3.D0*t345-t368)*s34r
     #+2048.D0/3.D0*t205*s3l1p+2048.D0/3.D0*t209*s4l1p*t7)*s23r-t227*s2l
     #1-8704.D0/3.D0*t381+(4096.D0/3.D0*t236*t237*s3l1p-8192*t69)*s34r)*
     #s1vr+8192.D0/3.D0*t391*t248+(-t251*s2l1+20480.D0/3.D0*t396*s34r+40
     #96.D0/3.D0*t140*t191*s3l1p+4096.D0/3.D0*t140*t190*s4l1p*t7)*t40+(-
     #t273*s2l1+16384.D0/3.D0*t415*t52+(-2048.D0/3.D0*t287*s3l1p-2048.D0
     #/3.D0*t286*s4l1p*t7)*s34r)*s23r-t305*s2l1+4096.D0/3.D0*t430*t298+(
     #-2048.D0/3.D0*t319*s3l1p-2048.D0/3.D0*t318*s4l1p*t7)*t52)*s1l2
      s6 = s7+s8
      s5 = s6+(1792.D0/3.D0*t442-1792.D0/3.D0*t445+512.D0/3.D0*t450-512.
     #D0/3.D0*t453)*t136+((-256.D0/3.D0*t459*t441+256.D0/3.D0*t459*t444-
     #1024.D0/3.D0*t450+1024.D0/3.D0*t453)*s23r+((-1024*t156+t197)*s34r+
     #t472)*s2l1+((1024*t345-t368)*s34r-t479)*s2l2+t487*s34r-t490+t492)*
     #t14+((512.D0/3.D0*t442-512.D0/3.D0*t445+512.D0/3.D0*t450-512.D0/3.
     #D0*t453)*t40+(((1792.D0/3.D0*t156-t197)*s34r-t472)*s2l1+((-1792.D0
     #/3.D0*t345+t368)*s34r+t479)*s2l2-t487*s34r+t490-t492)*s23r+((1280.
     #D0/3.D0*t275-512.D0/3.D0*t279)*t52-512.D0/3.D0*t155*t33)*s2l1+((-1
     #280.D0/3.D0*t411+512.D0/3.D0*t414)*t52+512.D0/3.D0*t155*t83)*s2l2+
     #(512.D0/3.D0*t529*t449-512.D0/3.D0*t529*t452)*t52+(512.D0/3.D0*t53
     #5-512.D0/3.D0*t536)*s34r)*s1vr
      s6 = s13r
      s4 = s5*s6
      s2 = s3+s4
      s4 = s2
      s8 = -1280.D0/3.D0*t545*t8*t546+((3584.D0/3.D0*t550+t553)*s23r-128
     #0.D0/3.D0*t557+256.D0/3.D0*t561*t33+256*t565)*t136
      s7 = s8+((t571-7424.D0/3.D0*t550-5120.D0/3.D0*t552)*t40+(t586*s2l2
     #+(-256.D0/3.D0*t589*t590-5120.D0/3.D0*t596)*s34r-256.D0/3.D0*t602*
     #t146-256.D0/3.D0*t609*s4l2p*t7)*s23r+t620*s2l2-1280*t624+(-256.D0/
     #3.D0*t628*t146+14336.D0/3.D0*t151)*s34r+10240.D0/3.D0*t634*t8+1433
     #6.D0/3.D0*t634*t10)*t14+((-t571+5120.D0/3.D0*t550+t642)*t248+(t651
     #*s2l2+(256.D0/3.D0*t654*t590+t657)*s34r-6400.D0/3.D0*t565-11008.D0
     #/3.D0*t564*t10)*t40+(t672*s2l2+(2560*t674+t679)*t52+(256.D0/3.D0*t
     #683*t146+256.D0/3.D0*t686*t150)*s34r+2048.D0/3.D0*t692*t693*s3l2p+
     #2048.D0/3.D0*t697*t4*s4l2p*t7)*s23r+t713*s2l2+1280.D0/3.D0*t716*t8
     #*t298+(-6400*t156-8192*t161)*t52+(-20480.D0/3.D0*t166*t725-8192*t7
     #31)*s34r)*s1vr+(-4096.D0/3.D0*t564*t18+4096.D0/3.D0*t738+4096.D0/3
     #.D0*t739)*t248
      s6 = s7+(t748*s2l2+(-2048.D0/3.D0*t757*s3l2p-2048.D0/3.D0*t756*s4l
     #2p*t7)*s34r+4096.D0/3.D0*t764+4096.D0/3.D0*t166*t10)*t40+(t778*s2l
     #2+(-2048.D0/3.D0*t786*s3l2p-2048.D0/3.D0*t785*s4l2p*t7)*t52+(-2048
     #.D0/3.D0*t798*s3l2p-2048.D0/3.D0*t797*s4l2p*t7)*s34r)*s23r+t813*s2
     #l2+10240.D0/3.D0*t815*t298+10240.D0/3.D0*t823*t52
      s7 = s1l1
      s5 = s6*s7
      s3 = s4+s5
      s4 = s3
      s9 = 1280.D0/3.D0*t545*t66*t546+((-3584.D0/3.D0*t831-t834)*s23r+12
     #80.D0/3.D0*t837-256.D0/3.D0*t561*t83-256*t841)*t136
      s8 = s9+((-t846+7424.D0/3.D0*t831+5120.D0/3.D0*t833)*t40+(-t586*s2
     #l1+(256.D0/3.D0*t589*t853+5120.D0/3.D0*t859)*s34r+256.D0/3.D0*t602
     #*t334+256.D0/3.D0*t609*s4l1p*t7)*s23r-t620*s2l1+1280*t872+(256.D0/
     #3.D0*t628*t334-14336.D0/3.D0*t339)*s34r-10240.D0/3.D0*t634*t66-143
     #36.D0/3.D0*t634*t68)*t14+((t846-5120.D0/3.D0*t831-t886)*t248+(-t65
     #1*s2l1+(-256.D0/3.D0*t654*t853-t893)*s34r+6400.D0/3.D0*t841+11008.
     #D0/3.D0*t564*t68)*t40+(-t672*s2l1+(-2560*t904-t908)*t52+(-256.D0/3
     #.D0*t683*t334-256.D0/3.D0*t686*t338)*s34r-2048.D0/3.D0*t692*t693*s
     #3l1p-2048.D0/3.D0*t697*t4*s4l1p*t7)*s23r-t713*s2l1-1280.D0/3.D0*t7
     #16*t66*t298+(6400*t345+8192*t349)*t52+(20480.D0/3.D0*t166*t724*s3l
     #1p+8192*t939)*s34r)*s1vr+(4096.D0/3.D0*t564*t73-4096.D0/3.D0*t946-
     #4096.D0/3.D0*t947)*t248
      s7 = s8+(-t748*s2l1+(2048.D0/3.D0*t757*s3l1p+2048.D0/3.D0*t756*s4l
     #1p*t7)*s34r-4096.D0/3.D0*t959-4096.D0/3.D0*t166*t68)*t40+(-t778*s2
     #l1+(2048.D0/3.D0*t786*s3l1p+2048.D0/3.D0*t785*s4l1p*t7)*t52+(2048.
     #D0/3.D0*t798*s3l1p+2048.D0/3.D0*t797*s4l1p*t7)*s34r)*s23r-t813*s2l
     #1+10240.D0/3.D0*t983*t298+10240.D0/3.D0*t991*t52
      s8 = s1l2
      s6 = s7*s8
      s7 = (-1280.D0/3.D0*t996+1280.D0/3.D0*t997)*t546
      s5 = s6+s7
      s1 = s4+s5
      s2 = s1+(((1792.D0/3.D0*t550+t553)*s2l1+(-1792.D0/3.D0*t831-t834)*
     #s2l2)*s23r+(256.D0/3.D0*t1011*t33-1280.D0/3.D0*t738)*s2l1+(-256.D0
     #/3.D0*t1011*t83+1280.D0/3.D0*t946)*s2l2-512.D0/3.D0*t1022+512.D0/3
     #.D0*t1024)*t136+(((-512.D0/3.D0*t550-512.D0/3.D0*t552)*s2l1+(512.D
     #0/3.D0*t831+512.D0/3.D0*t833)*s2l2)*t40+(((-256.D0/3.D0*t1037*t590
     #-512.D0/3.D0*t596)*s34r+1792.D0/3.D0*t738+512.D0/3.D0*t739)*s2l1+(
     #(256.D0/3.D0*t1037*t853+512.D0/3.D0*t859)*s34r-1792.D0/3.D0*t946-5
     #12.D0/3.D0*t947)*s2l2+1792.D0/3.D0*t1022-1792.D0/3.D0*t1024)*s23r+
     #(-1280.D0/3.D0*t624+(256.D0/3.D0*t1063*t146-t182)*s34r)*s2l1+(1280
     #.D0/3.D0*t872+(-256.D0/3.D0*t1063*t334+t362)*s34r)*s2l2+1024.D0/3.
     #D0*t1077*s34r)*t14
      s3 = s2+(((-512.D0/3.D0*t738-512.D0/3.D0*t739)*s2l1+(512.D0/3.D0*t
     #946+512.D0/3.D0*t947)*s2l2-1280.D0/3.D0*t1022+1280.D0/3.D0*t1024)*
     #t40+((-256.D0/3.D0*t1094*t146-512.D0/3.D0*t1099*t150)*s34r*s2l1+(2
     #56.D0/3.D0*t1094*t334+512.D0/3.D0*t1099*t338)*s34r*s2l2-1792.D0/3.
     #D0*t1077*s34r)*s23r+(-256.D0/3.D0*t1119*t146+t197)*t52*s2l1+(256.D
     #0/3.D0*t1119*t334-t368)*t52*s2l2+512.D0/3.D0*t486*t52)*s1vr
      s4 = s3+(2304*t109*s2l1+2304*t112*s2l2)*s23r*s1vr*t132
      s5 = s4
      s7 = ((2304*t135*t8*t1142+(2304*t246*t40-2304*t780*t8*t1148)*s1vr)
     #*s1l1+(-2304*t135*t66*t1142+(2304*t391*t40+2304*t780*t66*t1148)*s1
     #vr)*s1l2+(4608*t442-4608*t445+t1170-t1171)*s23r*t14+(((768*t147+t1
     #176)*s2l1+(-768*t335-t1180)*s2l2-t1170+t1171)*t40+(((-768*t156+230
     #4*t161)*s34r+2304*t1192+2304*t731)*s2l1+((768*t345-2304*t349)*s34r
     #-2304*t1202-2304*t939)*s2l2+t1207*s34r-2304*t489+2304*t491)*s23r)*
     #s1vr)*s13r
      s8 = (-3840*t1217*s3l2p*s23r*t136+((-1536*t570+4608*t550+t642)*t40
     #+(-3072*t557+(6144*t1227+1536*t596)*s34r-768*t1233*t146)*s23r)*t14
     #+((-768*t570-768*t550+768*t552)*t248+(t1247*s2l2+(-3072*t1227-768*
     #t596)*s34r+768*t1255+768*t1257*t150)*t40+(t1264*s2l2+(-2304*t674-t
     #679)*t52+(768*t1271*t146-t1176)*s34r)*s23r)*s1vr)*s1l1
      s6 = s7+s8
      t1282 = s5+s6
      t1294 = t544*t1*t807*s3l1p
      t1314 = t1254*t334
      t1337 = t593*t449
      t1338 = 1536*t1337
      t1339 = t593*t452
      t1340 = 1536*t1339
      t1348 = t856*t544
      t1350 = 6*z
      t1351 = -4+t1350
      t1352 = t1351*t16
      t1363 = t1*t57*t544
      t1369 = -t752
      t1371 = t1369*l3*t5
      t1381 = z*l3*t16
      t1386 = z+1
      t1388 = t1386*t5*l3
      t1395 = s3l2p*s34r
      t1402 = s3l1p*s34r
      t1409 = t728*l3
      t1432 = 1536*t11
      t1459 = 1536*t69
      t1483 = t6*t441-t6*t444+t535-t536
      t1489 = t32*t7
      t1490 = t1395*s2l1
      t1493 = t1402*s2l2
      t1506 = -1536*t147+1536*t151
      t1508 = 4608*t147
      t1517 = 1536*t731
      t1527 = 3072*t186+768*t1351*t1*t693
      t1532 = (-5+t600)*t7
      t1536 = 3+t200
      t1545 = t343*s34r
      t1548 = 1536*t217+768*t1189*t16*t1545
      t1551 = -3+t200
      t1552 = t1551*t5
      t1565 = -4+7*z
      t1569 = -13824*t186-1536*t1565*t1*t693
      t1574 = t1565*t7
      t1585 = -3+t266
      t1589 = -9216*t217-1536*t1585*t16*t1545
      t1593 = t1585*t7
      t1606 = -1536*t300-1536*t32*t53
      t1619 = 1536*t335-1536*t339
      t1621 = 4608*t335
      t1630 = 1536*t939
      t1719 = 2*t1386*t1
      t1722 = -3+t234
      t1723 = t1722*t1
      t1739 = t728*t5
      t1747 = (-5+t1350)*t1
      t1756 = t1747*t5
      t1796 = -3072*t1244-768*(t234+1)*t4*t141
      t1802 = t1369*t16
      t1807 = t140*l3
      t1813 = t1097*t4
      t1826 = 9216*t1244+768*(7+t234)*t4*t141
      t1832 = (-13+t1350)*t16
      t1849 = 4608*t616+768*(t234+6)*l3*t16*t1243-768*(-4+t234)*t3*t583
      t1856 = (t1350-16)*t5*t1
      t1859 = t1369*t5*t1
      t1865 = z**2
      t1868 = (-2-5*z+6*t1865)*t4
      t1871 = 2*t1865
      t1873 = (t189+t1871-2)*t4
      t1880 = -768*t708+768*t1098*t775
      t1887 = (t189-2)*t1
      t1894 = t1253*t4
      t1897 = t1253*s4l2p*t7
      t1902 = t1350-7
      t1909 = 1536*t1902*l3*t16*t1243+1536*t1253*t3*t583
      t1911 = t1902*t7
      t1920 = t1253*t7
      t1921 = t1920*s3l2p
      t1931 = 3*t3
      t1936 = 1536*t1253*t5*t2*t707+1536*t1931*z*t1*t775
      t1943 = t1931*t7
      t1954 = 1536*t812
      t2036 = t1253*s4l1p*t7
      t2051 = t1920*s3l1p
      t2095 = t1551*t16*l3
      t2098 = t1552*l3
      t2107 = (-5+t200)*t4
      t2118 = t1722*t16
      t2126 = (-t189+t1871)*t4
      t2130 = (t1871+2-t189)*t16
      t2136 = t145*t7
      s2 = (3840*t1217*s3l1p*s23r*t136+((1536*t845-4608*t831-t886)*t40+(
     #3072*t837+(-6144*t1294-1536*t859)*s34r+768*t1233*t334)*s23r)*t14+(
     #(768*t845+768*t831-768*t833)*t248+(-t1247*s2l1+(3072*t1294+768*t85
     #9)*s34r-768*t1314-768*t1257*t338)*t40+(-t1264*s2l1+(2304*t904+t908
     #)*t52+(-768*t1271*t334+t1180)*s34r)*s23r)*s1vr)*s1l2+(-2304*t996+2
     #304*t997-t1338+t1340)*s23r*t136
      s3 = s2+((-768*t996+768*t997+t1338-t1340)*t40+((768*t1348*t33-768*
     #t1352*t146)*s2l1+(-768*t1348*t83+768*t1352*t334)*s2l2+(1536*t1363*
     #t449-1536*t1363*t452)*s34r-768*t1371*t449+768*t1371*t452)*s23r)*t1
     #4
      s1 = s3+((-768*t1381*t441+768*t1381*t444+1536*t1388*t449-1536*t138
     #8*t452)*t40+((768*t1099*t141*t1395-2304*t764)*s2l1+(-768*t1099*t14
     #1*t1402+2304*t959)*s2l2+(1536*t1409*t31*s4l2p*t66-1536*t1409*t31*s
     #4l1p*t8)*s34r+2304*t166*t449-2304*t166*t452)*s23r)*s1vr+((-1536*t1
     #2*t14+((-3072*t19+7680*t9+t1432)*s23r-1536*t29+3072*t34)*s1vr-6144
     #*t38*t40+(7680*t29-7680*t45*s34r)*s23r+1536*t55-1536*t61*t52)*s1l1
     #+(-1536*t70*t14+((3072*t74-7680*t67-t1459)*s23r+1536*t81-3072*t84)
     #*s1vr-6144*t88*t40+(-7680*t81-7680*t94*s34r)*s23r-1536*t100-1536*t
     #104*t52)*s1l2+1536*t1483*t14+(-3072*t1483*s23r-1536*t1489*t1490+15
     #36*t1489*t1493+(-1536*t229*t449+1536*t229*t452)*s34r)*s1vr)*t132
      s3 = s1
      s8 = (t1506*t136+((t1508-3072*t151)*s23r+(4608*t156-3072*t161)*s34
     #r+768*t1192-t1517)*t14+((t180-9216*t147)*t40+(t1527*s2l2-13824*t78
     #0*t33-768*t140*t1532*s3l2p-768*t140*t1536*s4l2p*t7)*s23r+t1548*s2l
     #2-4608*t232+(-768*t1552*t343*s3l2p-t1432)*s34r)*s1vr-6144*t246*t24
     #8+(t1569*s2l2-13824*t253*s34r+1536*t140*t1574*s3l2p+1536*t140*t156
     #5*s4l2p*t7)*t40+(t1589*s2l2+9216*t815*t52+(1536*t6*t1593*s3l2p+153
     #6*t6*t1585*s4l2p*t7)*s34r)*s23r+t1606*s2l2-1536*t311*t298+(1536*t2
     #29*t8+1536*t229*t10)*t52)*s1l1
      s9 = (t1619*t136+((-t1621+3072*t339)*s23r+(-4608*t345+3072*t349)*s
     #34r-768*t1202+t1630)*t14+((-t360+9216*t335)*t40+(-t1527*s2l1+13824
     #*t780*t83+768*t140*t1532*s3l1p+768*t140*t1536*s4l1p*t7)*s23r-t1548
     #*s2l1+4608*t381+(768*t1552*t344+t1459)*s34r)*s1vr-6144*t391*t248+(
     #-t1569*s2l1-13824*t396*s34r-1536*t140*t1574*s3l1p-1536*t140*t1565*
     #s4l1p*t7)*t40+(-t1589*s2l1+9216*t983*t52+(-1536*t6*t1593*s3l1p-153
     #6*t6*t1585*s4l1p*t7)*s34r)*s23r-t1606*s2l1-1536*t430*t298+(-1536*t
     #229*t66-1536*t229*t68)*t52)*s1l2
      s7 = s8+s9
      s6 = s7+(t1506*s2l1+t1619*s2l2-t1170+t1171)*t136+(((t1508-1536*t15
     #1)*s2l1+(-t1621+1536*t339)*s2l2+4608*t450-4608*t453)*s23r+((1536*t
     #156-1536*t161)*s34r-768*t1719*t1191+768*t1723*t730)*s2l1+((-1536*t
     #345+1536*t349)*s34r+768*t1719*t1201-768*t1723*t938)*s2l2-t1207*s34
     #r-1536*t1739*t449+1536*t1739*t452)*t14+(((768*t1747*t1191-t1517)*s
     #2l1+(-768*t1747*t1201+t1630)*s2l2+768*t1756*t449-768*t1756*t452)*s
     #23r+(1536*t819-1536*t822)*s34r*s2l1+(-1536*t987+1536*t990)*s34r*s2
     #l2+(1536*t622*t449-1536*t622*t452)*s34r)*s1vr
      s7 = s13r
      s5 = s6*s7
      s8 = (-4608*t545*t8*s23r+768*t565)*t136+((-3072*t570+9216*t550+307
     #2*t552)*t40+(t1796*s2l2+(9216*t1227+t657)*s34r+6144*t565+768*t1802
     #*t150)*s23r+768*t1807*t28-1536*t135*t10*s34r+768*t1813*t8)*t14+((4
     #608*t570-4608*t550-4608*t552)*t248+(t1826*s2l2+(-9216*t1227-9216*t
     #596)*s34r+768*t1832*t146-1536*t166*t150)*t40+(t1849*s2l2+(-4608*t6
     #74-4608*t678)*t52+(768*t1856*t146-768*t1859*t150)*s34r+768*t1868*t
     #8+768*t1873*t10)*s23r+t1880*s2l2+(-2304*t156+1536*t161)*t52+(-768*
     #t1887*t1191+t1517)*s34r)*s1vr+(1536*t1894*t142-1536*t1255-1536*t56
     #4*t1897)*t248
      s7 = s8+(t1909*s2l2+(-1536*t135*t1911*s3l2p-1536*t135*t1902*s4l2p*
     #t7)*s34r-1536*t634*t1921-1536*t634*t1897)*t40+(t1936*s2l2+(-1536*t
     #780*t1921-1536*t780*t1897)*t52+(-1536*t167*t1943*s3l2p-1536*t167*t
     #1931*s4l2p*t7)*s34r)*s23r+t1954*s2l2+1536*t815*t298+1536*t823*t52
      s8 = s1l1
      s6 = s7*s8
      s4 = s5+s6
      s2 = s3+s4
      s4 = s2
      s7 = (4608*t545*t66*s23r-768*t841)*t136+((3072*t845-9216*t831-3072
     #*t833)*t40+(-t1796*s2l1+(-9216*t1294-t893)*s34r-6144*t841-768*t180
     #2*t338)*s23r-768*t1807*t80+1536*t135*t68*s34r-768*t1813*t66)*t14+(
     #(-4608*t845+4608*t831+4608*t833)*t248+(-t1826*s2l1+(9216*t1294+921
     #6*t859)*s34r-768*t1832*t334+1536*t166*t338)*t40+(-t1849*s2l1+(4608
     #*t904+4608*t907)*t52+(-768*t1856*t334+768*t1859*t338)*s34r-768*t18
     #68*t66-768*t1873*t68)*s23r-t1880*s2l1+(2304*t345-1536*t349)*t52+(7
     #68*t1887*t1201-t1630)*s34r)*s1vr+(-1536*t1894*t331+1536*t1314+1536
     #*t564*t2036)*t248
      s6 = s7+(-t1909*s2l1+(1536*t135*t1911*s3l1p+1536*t135*t1902*s4l1p*
     #t7)*s34r+1536*t634*t2051+1536*t634*t2036)*t40+(-t1936*s2l1+(1536*t
     #780*t2051+1536*t780*t2036)*t52+(1536*t167*t1943*s3l1p+1536*t167*t1
     #931*s4l1p*t7)*s34r)*s23r-t1954*s2l1+1536*t983*t298+1536*t991*t52
      s7 = s1l2
      s5 = s6*s7
      s3 = s4+s5
      t2143 = s3+((-1536*t996+1536*t997-1536*t1337+1536*t1339)*s23r+3072
     #*t564*t441-3072*t564*t444+1536*t1022-1536*t1024)*t136+((-768*t2095
     #*t441+768*t2095*t444-768*t2098*t449+768*t2098*t452)*s23r+(-1536*t1
     #35*t33+768*t2107*t8)*s2l1+(1536*t135*t83-768*t2107*t66)*s2l2+768*t
     #2118*t449-768*t2118*t452)*t14+((-768*t2126*t441+768*t2126*t444-768
     #*t2130*t449+768*t2130*t452)*s23r-1536*t2136*t1490+1536*t2136*t1493
     #)*s1vr
      taux12 = t1282+t2143

CCC Coefficients

      tcoff21 = taux11
      tcoff22 = taux11
      tcoff23 = taux12
      tcoff24 = taux12

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet21 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff21)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet22 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z
     #-t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff22)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet23 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff23)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet24 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z
     #-t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff24)

CCC Sum

      qgrmnum7e3 = tFjet21*tcoff21+tFjet22*tcoff22+tFjet23*tcoff23+tFjet
     #24*tcoff24
      RETURN
      END

      double precision function qgrmnum7e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux11 = 0
      t1 = l3-1
      t2 = -1+z
      t3 = t2**2
      t4 = t3*t2
      t5 = t4*t1
      t6 = 1/s3vr
      t7 = t6*s3l2p
      t9 = s4l2p*t6
      t12 = 4096.D0/3.D0*t5*t7+4096.D0/3.D0*t5*t9
      t13 = s1vr**2
      t17 = t1**2
      t18 = t4*t17
      t19 = t6*s34r
      t20 = t19*s2l2
      t22 = 4096.D0/3.D0*t18*t20
      t23 = t3**2
      t24 = t23*t17
      t27 = -t24*t7-t24*t9
      t37 = t17*t1
      t38 = t37*t23
      t39 = s34r**2
      t40 = t6*t39
      t44 = t23*t2
      t45 = t44*t37
      t53 = t6*s3l1p
      t55 = s4l1p*t6
      t58 = -4096.D0/3.D0*t5*t53-4096.D0/3.D0*t5*t55
      t62 = t19*s2l1
      t64 = 4096.D0/3.D0*t18*t62
      t67 = t24*t53+t24*t55
      t87 = t1*t23
      t88 = t87*l3
      t89 = t7*s2l1
      t91 = t53*s2l2
      t94 = 512.D0/3.D0*t88*t89-512.D0/3.D0*t88*t91
      t95 = t13*s1vr
      t99 = t17*t44
      t100 = t99*l3
      t102 = t7*s34r*s2l1
      t103 = t100*t102
      t106 = t53*s34r*s2l2
      t107 = t100*t106
      t114 = t23*t3
      t115 = t37*t114
      t116 = t115*l3
      t118 = t7*t39*s2l1
      t122 = t53*t39*s2l2
      t129 = l3**2
      t130 = t129*t23
      t131 = t13**2
      t138 = t130*t1
      t139 = t138*t20
      t140 = 512.D0/3.D0*t139
      t142 = t44*t1*t129
      t144 = t142*t7*s34r
      t146 = l3*t4
      t147 = t146*t7
      t151 = s23r**2
      t159 = 3584.D0/3.D0*t146*t9
      t165 = 1024.D0/3.D0*t99*t129*t6*t39
      t166 = t6*l3
      t168 = t5*t166*s34r
      t170 = t165+512.D0/3.D0*t168
      t173 = t17*t114*t129
      t175 = t173*t7*t39
      t177 = t166*s3l2p
      t178 = t87*t177
      t182 = t87*l3*s4l2p*t6
      t186 = z*t3
      t188 = 4096.D0/3.D0*t186*t7
      t190 = 4096.D0/3.D0*t186*t9
      t198 = -t165-1536*t168
      t208 = t114*t6
      t209 = t39*s34r
      t214 = t24*t166*t39
      t217 = z*t6
      t220 = 4096.D0/3.D0*t1*t3*t217*s34r
      t221 = -512.D0/3.D0*t129*t37*t208*t209-1536*t214-t220
      t225 = t37*t23*t4*t129
      t229 = t99*t177
      t231 = l3*t44
      t234 = t231*t17*s4l2p*t6
      t238 = z*t4
      t239 = t1*t6
      t242 = z*t1
      t246 = t238*t239*s3l2p+t242*t4*s4l2p*t6
      t251 = l3*t5
      t260 = 8192.D0/3.D0*t214+t220
      t270 = l3*t37
      t279 = 4096.D0/3.D0*t270*t44*t6*t209+4096.D0/3.D0*z*t17*t4*t6*t39
      t304 = t138*t62
      t305 = 512.D0/3.D0*t304
      t307 = t142*t53*s34r
      t309 = t146*t53
      t320 = 3584.D0/3.D0*t146*t55
      t326 = t173*t53*t39
      t329 = t87*t166*s3l1p
      t333 = t87*l3*s4l1p*t6
      t338 = 4096.D0/3.D0*t186*t53
      t340 = 4096.D0/3.D0*t186*t55
      t363 = t231*t17*t6*s3l1p
      t367 = t231*t17*s4l1p*t6
      t376 = -t238*t239*s3l1p-t242*t4*s4l1p*t6
      t421 = -512.D0/3.D0*t130*t89+512.D0/3.D0*t130*t91
      t426 = t23*l3
      t427 = t426*t7
      t432 = t426*t53
      t444 = t9*s3l1p
      t445 = t426*t444
      t447 = t55*s3l2p
      t448 = t426*t447
      t454 = 2*t2*t1*t23
      t473 = l3*t1*t44
      t486 = l3*t17*t114
      s2 = ((t12*t13+(-t12*s23r+t22+8192.D0/3.D0*t27*s34r)*s1vr+(-t22-40
     #96.D0/3.D0*t27*s34r)*s23r-4096.D0/3.D0*t38*t40*s2l2+(4096.D0/3.D0*
     #t45*t7+4096.D0/3.D0*t45*t9)*t39)*s1l1+(t58*t13+(-t58*s23r-t64+8192
     #.D0/3.D0*t67*s34r)*s1vr+(t64-4096.D0/3.D0*t67*s34r)*s23r+4096.D0/3
     #.D0*t38*t40*s2l1+(-4096.D0/3.D0*t45*t53-4096.D0/3.D0*t45*t55)*t39)
     #*s1l2+t94*t95+(-t94*s23r-1024.D0/3.D0*t103+1024.D0/3.D0*t107)*t13+
     #((512.D0/3.D0*t103-512.D0/3.D0*t107)*s23r+512.D0/3.D0*t116*t118-51
     #2.D0/3.D0*t116*t122)*s1vr)*s13r
      s4 = (-512.D0/3.D0*t130*t7*t131+(1024.D0/3.D0*t130*t7*s23r-t140+51
     #2*t144+512.D0/3.D0*t147)*t95+(-512.D0/3.D0*t130*t7*t151+(1024.D0/3
     #.D0*t139-2048.D0/3.D0*t144-4096.D0/3.D0*t147-t159)*s23r+t170*s2l2-
     #512*t175+(-5120.D0/3.D0*t178-4096.D0/3.D0*t182)*s34r-t188-t190)*t1
     #3+((-t140+512.D0/3.D0*t144+3584.D0/3.D0*t147+t159)*t151+(t198*s2l2
     #+1024.D0/3.D0*t175+(4096*t178+11776.D0/3.D0*t182)*s34r+t188+t190)*
     #s23r+t221*s2l2+512.D0/3.D0*t225*t7*t209+(8704.D0/3.D0*t229+8192.D0
     #/3.D0*t234)*t39+8192.D0/3.D0*t246*s34r)*s1vr+(4096.D0/3.D0*t251*t2
     #0+(-4096.D0/3.D0*t178-4096.D0/3.D0*t182)*s34r)*t151+(t260*s2l2+(-8
     #192.D0/3.D0*t229-8192.D0/3.D0*t234)*t39-4096.D0/3.D0*t246*s34r)*s2
     #3r+t279*s2l2+(-4096.D0/3.D0*t115*t177-4096.D0/3.D0*t270*t114*s4l2p
     #*t6)*t209+(-4096.D0/3.D0*t24*t217*s3l2p-4096.D0/3.D0*t24*z*s4l2p*t
     #6)*t39)*s1l1
      s5 = (512.D0/3.D0*t130*t53*t131+(-1024.D0/3.D0*t130*t53*s23r+t305-
     #512*t307-512.D0/3.D0*t309)*t95+(512.D0/3.D0*t130*t53*t151+(-1024.D
     #0/3.D0*t304+2048.D0/3.D0*t307+4096.D0/3.D0*t309+t320)*s23r-t170*s2
     #l1+512*t326+(5120.D0/3.D0*t329+4096.D0/3.D0*t333)*s34r+t338+t340)*
     #t13+((t305-512.D0/3.D0*t307-3584.D0/3.D0*t309-t320)*t151+(-t198*s2
     #l1-1024.D0/3.D0*t326+(-4096*t329-11776.D0/3.D0*t333)*s34r-t338-t34
     #0)*s23r-t221*s2l1-512.D0/3.D0*t225*t53*t209+(-8704.D0/3.D0*t363-81
     #92.D0/3.D0*t367)*t39+8192.D0/3.D0*t376*s34r)*s1vr+(-4096.D0/3.D0*t
     #251*t62+(4096.D0/3.D0*t329+4096.D0/3.D0*t333)*s34r)*t151+(-t260*s2
     #l1+(8192.D0/3.D0*t363+8192.D0/3.D0*t367)*t39-4096.D0/3.D0*t376*s34
     #r)*s23r-t279*s2l1+(4096.D0/3.D0*t270*t208*s3l1p+4096.D0/3.D0*t270*
     #t114*s4l1p*t6)*t209+(4096.D0/3.D0*t24*t217*s3l1p+4096.D0/3.D0*t24*
     #z*s4l1p*t6)*t39)*s1l2
      s3 = s4+s5
      s1 = s2+s3
      taux12 = s1+t421*t131+(-t421*s23r+(1024.D0/3.D0*t144-512.D0/3.D0*t
     #427)*s2l1+(-1024.D0/3.D0*t307+512.D0/3.D0*t432)*s2l2)*t95+(((-512.
     #D0/3.D0*t144+512.D0/3.D0*t427)*s2l1+(512.D0/3.D0*t307-512.D0/3.D0*
     #t432)*s2l2+512.D0/3.D0*t445-512.D0/3.D0*t448)*s23r+(-512.D0/3.D0*t
     #175+512.D0/3.D0*t454*t166*s3l2p*s34r)*s2l1+(512.D0/3.D0*t326-512.D
     #0/3.D0*t454*t166*s3l1p*s34r)*s2l2)*t13+((-512.D0/3.D0*t445+512.D0/
     #3.D0*t448)*t151+(-512.D0/3.D0*t473*t102+512.D0/3.D0*t473*t106+(-51
     #2.D0/3.D0*t473*t444+512.D0/3.D0*t473*t447)*s34r)*s23r-512.D0/3.D0*
     #t486*t118+512.D0/3.D0*t486*t122)*s1vr

CCC Coefficients

      tcoff21 = taux11
      tcoff22 = taux11
      tcoff23 = taux12
      tcoff24 = taux12

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet21 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff21)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet22 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z
     #-t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff22)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet23 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff23)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet24 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z
     #-t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff24)

CCC Sum

      qgrmnum7e4 = tFjet21*tcoff21+tFjet22*tcoff22+tFjet23*tcoff23+tFjet
     #24*tcoff24
      RETURN
      END

      double precision function qgrmnum8e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3-1
      t2 = -1+z
      t3 = t2**2
      t4 = t1*t3
      t5 = s3vr**2
      t6 = 1/t5
      t7 = t6*s3l2p
      t8 = t7*s2l1
      t10 = t6*s3l1p
      t11 = t10*s2l2
      t16 = l3*t3
      t22 = l3*t3*t2
      t23 = t22*t1
      t26 = t2*t6
      t44 = s4l2p*t6*s3l1p
      t45 = t22*t44
      t47 = s4l1p*t6*s3l2p
      t48 = t22*t47
      t55 = t3*t6
      t62 = t3**2
      t64 = l3*t62*t1
      taux13 = (512.D0/3.D0*t4*t8+512.D0/3.D0*t4*t11)*s13r+(-512.D0/3.D0
     #*t16*t7*s1vr+512.D0/3.D0*t16*t7*s23r+512.D0/3.D0*t23*t7*s34r+512.D
     #0/3.D0*t26*s3l2p)*s1l1+(-512.D0/3.D0*t16*t10*s1vr+512.D0/3.D0*t16*
     #t10*s23r+512.D0/3.D0*t23*t10*s34r+512.D0/3.D0*t26*s3l1p)*s1l2+(-51
     #2.D0/3.D0*t16*t8-512.D0/3.D0*t16*t11+512.D0/3.D0*t45+512.D0/3.D0*t
     #48)*s1vr+(-512.D0/3.D0*t45-512.D0/3.D0*t48)*s23r-512.D0/3.D0*t55*s
     #3l2p*s2l1-512.D0/3.D0*t55*s3l1p*s2l2+(-512.D0/3.D0*t64*t44-512.D0/
     #3.D0*t64*t47)*s34r-512.D0/3.D0*t3*s4l2p*t10-512.D0/3.D0*t3*s4l1p*t
     #7
      t1 = l3-1
      t2 = -1+z
      t3 = t2**2
      t4 = t1*t3
      t5 = s3vr**2
      t6 = 1/t5
      t7 = t6*s3l2p
      t8 = t7*s2l1
      t10 = t6*s3l1p
      t11 = t10*s2l2
      t16 = l3*t3
      t22 = l3*t3*t2
      t23 = t22*t1
      t26 = t2*t6
      t44 = s4l2p*t6*s3l1p
      t45 = t22*t44
      t47 = s4l1p*t6*s3l2p
      t48 = t22*t47
      t55 = t3*t6
      t62 = t3**2
      t64 = l3*t62*t1
      taux14 = (2048.D0/3.D0*t4*t8-2048.D0/3.D0*t4*t11)*s13r+(-2048.D0/3
     #.D0*t16*t7*s1vr+2048.D0/3.D0*t16*t7*s23r+2048.D0/3.D0*t23*t7*s34r+
     #2048.D0/3.D0*t26*s3l2p)*s1l1+(2048.D0/3.D0*t16*t10*s1vr-2048.D0/3.
     #D0*t16*t10*s23r-2048.D0/3.D0*t23*t10*s34r-2048.D0/3.D0*t26*s3l1p)*
     #s1l2+(-2048.D0/3.D0*t16*t8+2048.D0/3.D0*t16*t11-2048.D0/3.D0*t45+2
     #048.D0/3.D0*t48)*s1vr+(2048.D0/3.D0*t45-2048.D0/3.D0*t48)*s23r-204
     #8.D0/3.D0*t55*s3l2p*s2l1+2048.D0/3.D0*t55*s3l1p*s2l2+(2048.D0/3.D0
     #*t64*t44-2048.D0/3.D0*t64*t47)*s34r+2048.D0/3.D0*t3*s4l2p*t10-2048
     #.D0/3.D0*t3*s4l1p*t7

CCC Coefficients

      tcoff25 = taux13
      tcoff26 = taux13
      tcoff27 = taux14
      tcoff28 = taux14

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet25 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff25)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet26 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z
     #-t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff26)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet27 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff27)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet28 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z
     #-t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff28)

CCC Sum

      qgrmnum8e0 = tFjet25*tcoff25+tFjet26*tcoff26+tFjet27*tcoff27+tFjet
     #28*tcoff28
      RETURN
      END

      double precision function qgrmnum8e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3*z
      t2 = -1+z
      t3 = t2**2
      t5 = l3-1
      t6 = s3vr**2
      t7 = 1/t6
      t8 = t5*t7
      t12 = t5*t3
      t13 = t7*s3l2p
      t14 = t13*s2l1
      t17 = t7*s3l1p
      t18 = t17*s2l2
      t21 = t3*t2
      t24 = t5**2
      t25 = t24*t7
      t34 = l3*t3
      t41 = l3*t21
      t42 = t41*t5
      t48 = -2*t2*t7
      t66 = l3**2
      t67 = t66*z
      t68 = t3*t7
      t79 = 512.D0/3.D0*t67*t21*t8*s34r
      t81 = s4l2p*t7*s3l1p
      t83 = 1024.D0/3.D0*t41*t81
      t85 = s4l1p*t7*s3l2p
      t87 = 1024.D0/3.D0*t41*t85
      t100 = t3**2
      t102 = s34r**2
      t107 = l3*t100*t5
      taux13 = (-512.D0/3.D0*t1*t3*t8*s1vr-1024.D0/3.D0*t12*t14-1024.D0/
     #3.D0*t12*t18+512.D0/3.D0*z*t21*l3*t25*s34r+512.D0/3.D0*t2*z*t8)*s1
     #3r+(1024.D0/3.D0*t34*t13*s1vr-1024.D0/3.D0*t34*t13*s23r-1024.D0/3.
     #D0*t42*t13*s34r+512.D0/3.D0*t48*s3l2p)*s1l1+(1024.D0/3.D0*t34*t17*
     #s1vr-1024.D0/3.D0*t34*t17*s23r-1024.D0/3.D0*t42*t17*s34r+512.D0/3.
     #D0*t48*s3l1p)*s1l2+(512.D0/3.D0*t67*t68*s23r+1024.D0/3.D0*t34*t14+
     #1024.D0/3.D0*t34*t18+t79-t83-t87)*s1vr+(-t79+t83+t87+512.D0/3.D0*t
     #1*t68)*s23r+1024.D0/3.D0*t68*s3l2p*s2l1+1024.D0/3.D0*t68*s3l1p*s2l
     #2-512.D0/3.D0*t67*t100*t25*t102+(1024.D0/3.D0*t107*t81+1024.D0/3.D
     #0*t107*t85-512.D0/3.D0*t1*t12*t7)*s34r+1024.D0/3.D0*t3*s4l2p*t17+1
     #024.D0/3.D0*t3*s4l1p*t13
      t1 = l3-1
      t2 = -1+z
      t3 = t2**2
      t4 = t1*t3
      t5 = s3vr**2
      t6 = 1/t5
      t7 = t6*s3l2p
      t8 = t7*s2l1
      t10 = t6*s3l1p
      t11 = t10*s2l2
      t16 = l3*t3
      t24 = l3*t3*t2
      t25 = t24*t1
      t31 = -5*t2*t6
      t52 = s4l2p*t6*s3l1p
      t53 = t24*t52
      t55 = s4l1p*t6*s3l2p
      t56 = t24*t55
      t63 = t3*t6
      t70 = t3**2
      t72 = l3*t70*t1
      taux14 = (-10240.D0/3.D0*t4*t8+10240.D0/3.D0*t4*t11)*s13r+(10240.D
     #0/3.D0*t16*t7*s1vr-10240.D0/3.D0*t16*t7*s23r-10240.D0/3.D0*t25*t7*
     #s34r+2048.D0/3.D0*t31*s3l2p)*s1l1+(-10240.D0/3.D0*t16*t10*s1vr+102
     #40.D0/3.D0*t16*t10*s23r+10240.D0/3.D0*t25*t10*s34r-2048.D0/3.D0*t3
     #1*s3l1p)*s1l2+(10240.D0/3.D0*t16*t8-10240.D0/3.D0*t16*t11+10240.D0
     #/3.D0*t53-10240.D0/3.D0*t56)*s1vr+(-10240.D0/3.D0*t53+10240.D0/3.D
     #0*t56)*s23r+10240.D0/3.D0*t63*s3l2p*s2l1-10240.D0/3.D0*t63*s3l1p*s
     #2l2+(-10240.D0/3.D0*t72*t52+10240.D0/3.D0*t72*t55)*s34r-10240.D0/3
     #.D0*t3*s4l2p*t10+10240.D0/3.D0*t3*s4l1p*t7

CCC Coefficients

      tcoff25 = taux13
      tcoff26 = taux13
      tcoff27 = taux14
      tcoff28 = taux14

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet25 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff25)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet26 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z
     #-t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff26)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet27 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff27)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet28 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z
     #-t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff28)

CCC Sum

      qgrmnum8e1 = tFjet25*tcoff25+tFjet26*tcoff26+tFjet27*tcoff27+tFjet
     #28*tcoff28
      RETURN
      END

      double precision function qgrmnum8e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3*z
      t2 = -1+z
      t3 = t2**2
      t5 = l3-1
      t6 = s3vr**2
      t7 = 1/t6
      t8 = t5*t7
      t12 = t5*t3
      t13 = t7*s3l2p
      t14 = t13*s2l1
      t17 = t7*s3l1p
      t18 = t17*s2l2
      t21 = t3*t2
      t24 = t5**2
      t25 = t24*t7
      t34 = l3*t3
      t39 = l3*t21
      t40 = t39*t5
      t43 = t2*t7
      t58 = l3**2
      t59 = t58*z
      t60 = t3*t7
      t71 = 1024.D0/3.D0*t59*t21*t8*s34r
      t73 = s4l2p*t7*s3l1p
      t75 = 512.D0/3.D0*t39*t73
      t77 = s4l1p*t7*s3l2p
      t79 = 512.D0/3.D0*t39*t77
      t92 = t3**2
      t94 = s34r**2
      t99 = l3*t92*t5
      taux13 = (1024.D0/3.D0*t1*t3*t8*s1vr+512.D0/3.D0*t12*t14+512.D0/3.
     #D0*t12*t18-1024.D0/3.D0*z*t21*l3*t25*s34r-1024.D0/3.D0*t2*z*t8)*s1
     #3r+(-512.D0/3.D0*t34*t13*s1vr+512.D0/3.D0*t34*t13*s23r+512.D0/3.D0
     #*t40*t13*s34r+512.D0/3.D0*t43*s3l2p)*s1l1+(-512.D0/3.D0*t34*t17*s1
     #vr+512.D0/3.D0*t34*t17*s23r+512.D0/3.D0*t40*t17*s34r+512.D0/3.D0*t
     #43*s3l1p)*s1l2+(-1024.D0/3.D0*t59*t60*s23r-512.D0/3.D0*t34*t14-512
     #.D0/3.D0*t34*t18-t71+t75+t79)*s1vr+(t71-t75-t79-1024.D0/3.D0*t1*t6
     #0)*s23r-512.D0/3.D0*t60*s3l2p*s2l1-512.D0/3.D0*t60*s3l1p*s2l2+1024
     #.D0/3.D0*t59*t92*t25*t94+(-512.D0/3.D0*t99*t73-512.D0/3.D0*t99*t77
     #+1024.D0/3.D0*t1*t12*t7)*s34r-512.D0/3.D0*t3*s4l2p*t17-512.D0/3.D0
     #*t3*s4l1p*t13
      t1 = l3-1
      t2 = -1+z
      t3 = t2**2
      t4 = t1*t3
      t5 = s3vr**2
      t6 = 1/t5
      t7 = t6*s3l2p
      t8 = t7*s2l1
      t10 = t6*s3l1p
      t11 = t10*s2l2
      t16 = l3*t3
      t24 = l3*t3*t2
      t25 = t24*t1
      t30 = 9*t2*t6
      t51 = s4l2p*t6*s3l1p
      t52 = t24*t51
      t54 = s4l1p*t6*s3l2p
      t55 = t24*t54
      t62 = t3*t6
      t69 = t3**2
      t71 = l3*t69*t1
      taux14 = (6144*t4*t8-6144*t4*t11)*s13r+(-6144*t16*t7*s1vr+6144*t16
     #*t7*s23r+6144*t25*t7*s34r+2048.D0/3.D0*t30*s3l2p)*s1l1+(6144*t16*t
     #10*s1vr-6144*t16*t10*s23r-6144*t25*t10*s34r-2048.D0/3.D0*t30*s3l1p
     #)*s1l2+(-6144*t16*t8+6144*t16*t11-6144*t52+6144*t55)*s1vr+(6144*t5
     #2-6144*t55)*s23r-6144*t62*s3l2p*s2l1+6144*t62*s3l1p*s2l2+(6144*t71
     #*t51-6144*t71*t54)*s34r+6144*t3*s4l2p*t10-6144*t3*s4l1p*t7

CCC Coefficients

      tcoff25 = taux13
      tcoff26 = taux13
      tcoff27 = taux14
      tcoff28 = taux14

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet25 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff25)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet26 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z
     #-t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff26)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet27 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff27)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet28 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z
     #-t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff28)

CCC Sum

      qgrmnum8e2 = tFjet25*tcoff25+tFjet26*tcoff26+tFjet27*tcoff27+tFjet
     #28*tcoff28
      RETURN
      END

      double precision function qgrmnum8e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3*z
      t2 = -1+z
      t3 = t2**2
      t4 = t1*t3
      t5 = l3-1
      t6 = s3vr**2
      t7 = 1/t6
      t8 = t5*t7
      t11 = t3*t2
      t14 = t5**2
      t15 = t14*t7
      t23 = l3**2
      t24 = t23*z
      t25 = t3*t7
      t29 = t8*s34r
      t30 = t24*t11*t29
      t38 = t3**2
      t40 = s34r**2
      taux13 = (-512.D0/3.D0*t4*t8*s1vr+512.D0/3.D0*z*t11*l3*t15*s34r+51
     #2.D0/3.D0*t2*z*t8)*s13r+(512.D0/3.D0*t24*t25*s23r+512.D0/3.D0*t30)
     #*s1vr+(-512.D0/3.D0*t30+512.D0/3.D0*t1*t25)*s23r-512.D0/3.D0*t24*t
     #38*t15*t40-512.D0/3.D0*t4*t29
      t1 = l3-1
      t2 = -1+z
      t3 = t2**2
      t4 = t1*t3
      t5 = s3vr**2
      t6 = 1/t5
      t7 = t6*s3l2p
      t8 = t7*s2l1
      t10 = t6*s3l1p
      t11 = t10*s2l2
      t16 = l3*t3
      t24 = l3*t3*t2
      t25 = t24*t1
      t31 = -7*t2*t6
      t52 = s4l2p*t6*s3l1p
      t53 = t24*t52
      t55 = s4l1p*t6*s3l2p
      t56 = t24*t55
      t63 = t3*t6
      t70 = t3**2
      t72 = l3*t70*t1
      taux14 = (-14336.D0/3.D0*t4*t8+14336.D0/3.D0*t4*t11)*s13r+(14336.D
     #0/3.D0*t16*t7*s1vr-14336.D0/3.D0*t16*t7*s23r-14336.D0/3.D0*t25*t7*
     #s34r+2048.D0/3.D0*t31*s3l2p)*s1l1+(-14336.D0/3.D0*t16*t10*s1vr+143
     #36.D0/3.D0*t16*t10*s23r+14336.D0/3.D0*t25*t10*s34r-2048.D0/3.D0*t3
     #1*s3l1p)*s1l2+(14336.D0/3.D0*t16*t8-14336.D0/3.D0*t16*t11+14336.D0
     #/3.D0*t53-14336.D0/3.D0*t56)*s1vr+(-14336.D0/3.D0*t53+14336.D0/3.D
     #0*t56)*s23r+14336.D0/3.D0*t63*s3l2p*s2l1-14336.D0/3.D0*t63*s3l1p*s
     #2l2+(-14336.D0/3.D0*t72*t52+14336.D0/3.D0*t72*t55)*s34r-14336.D0/3
     #.D0*t3*s4l2p*t10+14336.D0/3.D0*t3*s4l1p*t7

CCC Coefficients

      tcoff25 = taux13
      tcoff26 = taux13
      tcoff27 = taux14
      tcoff28 = taux14

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet25 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff25)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet26 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z
     #-t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff26)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet27 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff27)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet28 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z
     #-t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff28)

CCC Sum

      qgrmnum8e3 = tFjet25*tcoff25+tFjet26*tcoff26+tFjet27*tcoff27+tFjet
     #28*tcoff28
      RETURN
      END

      double precision function qgrmnum8e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux13 = 0
      t1 = l3-1
      t2 = -1+z
      t3 = t2**2
      t4 = t1*t3
      t5 = s3vr**2
      t6 = 1/t5
      t7 = t6*s3l2p
      t8 = t7*s2l1
      t10 = t6*s3l1p
      t11 = t10*s2l2
      t16 = l3*t3
      t22 = l3*t3*t2
      t23 = t22*t1
      t26 = t2*t6
      t44 = s4l2p*t6*s3l1p
      t45 = t22*t44
      t47 = s4l1p*t6*s3l2p
      t48 = t22*t47
      t55 = t3*t6
      t62 = t3**2
      t64 = l3*t62*t1
      taux14 = (4096.D0/3.D0*t4*t8-4096.D0/3.D0*t4*t11)*s13r+(-4096.D0/3
     #.D0*t16*t7*s1vr+4096.D0/3.D0*t16*t7*s23r+4096.D0/3.D0*t23*t7*s34r+
     #4096.D0/3.D0*t26*s3l2p)*s1l1+(4096.D0/3.D0*t16*t10*s1vr-4096.D0/3.
     #D0*t16*t10*s23r-4096.D0/3.D0*t23*t10*s34r-4096.D0/3.D0*t26*s3l1p)*
     #s1l2+(-4096.D0/3.D0*t16*t8+4096.D0/3.D0*t16*t11-4096.D0/3.D0*t45+4
     #096.D0/3.D0*t48)*s1vr+(4096.D0/3.D0*t45-4096.D0/3.D0*t48)*s23r-409
     #6.D0/3.D0*t55*s3l2p*s2l1+4096.D0/3.D0*t55*s3l1p*s2l2+(4096.D0/3.D0
     #*t64*t44-4096.D0/3.D0*t64*t47)*s34r+4096.D0/3.D0*t3*s4l2p*t10-4096
     #.D0/3.D0*t3*s4l1p*t7

CCC Coefficients

      tcoff25 = taux13
      tcoff26 = taux13
      tcoff27 = taux14
      tcoff28 = taux14

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet25 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff25)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet26 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z
     #-t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff26)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet27 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff27)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet28 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z
     #-t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff28)

CCC Sum

      qgrmnum8e4 = tFjet25*tcoff25+tFjet26*tcoff26+tFjet27*tcoff27+tFjet
     #28*tcoff28
      RETURN
      END

      double precision function qgrmnum9e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3-1
      t2 = t1**2
      t3 = z*t2
      t4 = -1+z
      t5 = t4**2
      t6 = t5*t4
      t8 = l3**2
      t9 = 1/s3vr
      t10 = t8*t9
      t14 = l3*t5
      t15 = t2*t9
      t19 = t2*t6
      t20 = l3*t9
      t21 = t20*s3l2p
      t27 = t9*s3l1p
      t28 = t27*s2l2
      t33 = z*t8
      t34 = t5**2
      t36 = t2*t1
      t37 = t36*t9
      t42 = l3*t6
      t44 = t9*s34r
      t45 = t44*s2l2
      t49 = l3*t34*t36
      t50 = t9*s3l2p
      t51 = t50*s34r
      t61 = s13r**2
      t63 = t1*t5
      t64 = t63*t8
      t65 = t9*s2l2
      t66 = s23r*s1vr
      t69 = t19*t8
      t76 = t9*s2l1
      t85 = z*t1
      t86 = t85*t6
      t87 = t8*l3
      t88 = t87*t9
      t89 = s1vr**2
      t90 = t89*s1vr
      t94 = t8*t6
      t95 = t1*t9
      t97 = t94*t95*s3l2p
      t115 = t88*s34r
      t116 = t3*t34*t115
      t117 = 256.D0/3.D0*t116
      t118 = t1*t34
      t119 = t118*t8
      t120 = t50*s3l1p
      t123 = t5*t8
      t124 = t123*t9
      t126 = 64.D0/3.D0*t85*t124
      t129 = s23r**2
      t139 = t94*t1
      t143 = t10*s3l2p
      t147 = t8*s4l2p*t9
      t148 = t118*t147
      t152 = s4l1p*t9
      t153 = t152*s3l2p
      t154 = t119*t153
      t156 = t6*z
      t157 = t1*t8
      t160 = 64.D0/3.D0*t156*t157*t9
      t165 = t2*t34
      t166 = t165*t143
      t168 = t165*t147
      t172 = 2*z
      t175 = (-4+t172)*t5*t1
      t179 = l3*s4l2p*t9
      t181 = 64.D0/3.D0*t63*t179
      t184 = t10*s3l1p
      t185 = t165*t184
      t187 = t8*s4l1p
      t189 = t165*t187*t9
      t193 = t20*s3l1p
      t199 = 64.D0/3.D0*t63*l3*s4l1p*t9
      t202 = t34*t4
      t204 = z*t202*t36
      t205 = s34r**2
      t206 = t88*t205
      t207 = t204*t206
      t209 = t202*t2
      t210 = t209*t8
      t213 = t94*t9
      t214 = t3*t213
      t218 = l3*t1
      t219 = t218*t6
      t226 = t10*s34r
      t237 = z*t5*t1
      t253 = t209*t147
      t257 = t210*t153
      t266 = t6*t9
      t267 = t266*s3l2p
      t270 = t6*t1
      t271 = t270*t179
      t275 = t219*t153
      t279 = t8*t34
      t282 = 2*t4
      t283 = t282*l3
      t284 = t283*t5
      t290 = t36*t202
      t291 = t290*t8
      t292 = s4l2p*t9
      t298 = (1-t172)*t2*t6
      t322 = t34*t5
      t324 = t2**2
      t326 = t205*s34r
      t327 = t88*t326
      t340 = s3l1p*s34r
      s1 = (-64.D0/3.D0*t64*t65*t66-64.D0/3.D0*t69*t44*s2l2*s23r)*s1l1+(
     #-64.D0/3.D0*t64*t76*t66-64.D0/3.D0*t69*t44*s2l1*s23r)*s1l2-64.D0/3
     #.D0*t86*t88*t90+((256.D0/3.D0*t97+64.D0/3.D0*t94*t1*s4l2p*t9)*s2l1
     #+(256.D0/3.D0*t94*t95*s3l1p+64.D0/3.D0*t94*t1*s4l1p*t9)*s2l2+t117+
     #128.D0/3.D0*t119*t120+t126)*t89+(-64.D0/3.D0*t86*t88*t129+((128.D0
     #/3.D0*t63*t10*s2l2+64.D0/3.D0*t97)*s2l1+64.D0/3.D0*t139*t28-128*t1
     #16+(-128.D0/3.D0*t118*t143-64.D0/3.D0*t148)*s3l1p-64.D0/3.D0*t154-
     #t160)*s23r+(512.D0/3.D0*t69*t45+(-256.D0/3.D0*t166-64*t168)*s34r+6
     #4.D0/3.D0*t175*t21-t181)*s2l1+((-256.D0/3.D0*t185-64*t189)*s34r+64
     #.D0/3.D0*t175*t193-t199)*s2l2-320.D0/3.D0*t207+(-256.D0/3.D0*t210*
     #t120-64*t214)*s34r-128.D0/3.D0*t219*t120)*s1vr+(t117-t160)*t129
      t344 = s1+(((-128.D0/3.D0*t19*t226+128.D0/3.D0*t63*t20)*s2l2+(-64.
     #D0/3.D0*t166+128.D0/3.D0*t168)*s34r+64.D0/3.D0*t237*t21+t181)*s2l1
     #+((-64.D0/3.D0*t185+128.D0/3.D0*t189)*s34r+64.D0/3.D0*t237*t193+t1
     #99)*s2l2+128*t207+((128.D0/3.D0*t209*t143+64.D0/3.D0*t253)*s3l1p+6
     #4.D0/3.D0*t257+64.D0/3.D0*(4+z)*z*t2*t213)*s34r+(128.D0/3.D0*t218*
     #t267+64.D0/3.D0*t271)*s3l1p+64.D0/3.D0*t275)*s23r+((-128.D0/3.D0*t
     #279*t37*t205+128.D0/3.D0*t284*t15*s34r)*s2l2+128.D0/3.D0*t291*t292
     #*t205+(64.D0/3.D0*t298*t21+128.D0/3.D0*t42*t2*s4l2p*t9)*s34r)*s2l1
     #+(128.D0/3.D0*t291*t152*t205+(64.D0/3.D0*t298*t193+128.D0/3.D0*t42
     #*t2*s4l1p*t9)*s34r)*s2l2+128.D0/3.D0*z*t322*t324*t327+(128.D0/3.D0
     #*t36*t322*t8*t120+128.D0/3.D0*t33*t34*t36*t9)*t205+128.D0/3.D0*t16
     #5*l3*t50*t340
      t346 = t6*t87
      t353 = t270*t87
      t354 = t353*t45
      t356 = t118*t87
      t357 = t356*t51
      t363 = t87*t5
      t371 = 64*t165*t206
      t372 = t5*t9
      t376 = t371+64.D0/3.D0*t157*t372*s34r
      t379 = t87*t202*t2
      t380 = t50*t205
      t381 = t379*t380
      t383 = t139*t51
      t389 = -64.D0/3.D0*t270*t115+64.D0/3.D0*t124
      t391 = 64.D0/3.D0*t357
      t394 = 3-t172
      t399 = -t371-64.D0/3.D0*t394*t1*t5*t226
      t409 = -128.D0/3.D0*t290*t327-128.D0/3.D0*t19*t10*t205
      t412 = t87*t36*t322
      t416 = t165*t8
      t428 = t353*t44*s2l1
      t430 = t27*s34r
      t431 = t356*t430
      t444 = t27*t205
      t445 = t379*t444
      t447 = t139*t430
      t468 = t8**2
      t469 = t468*t9
      t478 = t34*t87
      t495 = t85*t34
      t497 = t495*t469*s34r
      t499 = t478*t50
      t501 = t478*t292
      t505 = t478*t153
      t507 = 2-z
      t515 = -t4
      t516 = t515*t5
      t525 = t1*t87
      t526 = t525*t202
      t529 = z*t87
      t536 = (-5+t172)*t6
      t540 = 64.D0/3.D0*t94*t292
      t559 = 5*t5*t4
      t595 = 3*z
      t619 = (-4+z)*t8*t6
      t620 = s3l2p*s34r
      t621 = t95*t620
      t627 = t95*t340
      t653 = -t394
      t655 = t372*s3l2p
      t682 = (t595-2)*t8*t6
      t684 = t283*t655
      t701 = 3*t4
      t707 = t653*t1*t34
      t734 = t282*t2*t34
      t740 = -t282*t5*t1
      s2 = ((64.D0/3.D0*t3*t6*t10*s23r+(-128.D0/3.D0*t14*t15*s2l2-64.D0/
     #3.D0*t19*t21)*s2l1-64.D0/3.D0*t19*l3*t28)*s1vr-64.D0/3.D0*t33*t34*
     #t37*s34r*s23r+(-128.D0/3.D0*t42*t36*t45+64.D0/3.D0*t49*t51)*s2l1+6
     #4.D0/3.D0*t49*t27*s34r*s2l2)*t61+t344*s13r+(-64.D0/3.D0*t346*t50*t
     #90+(64.D0/3.D0*t346*t50*s23r-64.D0/3.D0*t354+256.D0/3.D0*t357+64.D
     #0/3.D0*t123*t50)*t89+(64.D0/3.D0*t363*t65*t129+(256.D0/3.D0*t354-2
     #56.D0/3.D0*t357)*s23r+t376*s2l2-320.D0/3.D0*t381-64*t383)*s1vr+(t3
     #89*s2l2+t391)*t129+(t399*s2l2+64*t381+128.D0/3.D0*t383)*s23r+t409*
     #s2l2+128.D0/3.D0*t412*t50*t326+128.D0/3.D0*t416*t380)*s1l1
      s3 = s2+(-64.D0/3.D0*t346*t27*t90+(64.D0/3.D0*t346*t27*s23r-64.D0/
     #3.D0*t428+256.D0/3.D0*t431+64.D0/3.D0*t123*t27)*t89+(64.D0/3.D0*t3
     #63*t76*t129+(256.D0/3.D0*t428-256.D0/3.D0*t431)*s23r+t376*s2l1-320
     #.D0/3.D0*t445-64*t447)*s1vr+(t389*s2l1+64.D0/3.D0*t431)*t129+(t399
     #*s2l1+64*t445+128.D0/3.D0*t447)*s23r+t409*s2l1+128.D0/3.D0*t412*t2
     #7*t326+128.D0/3.D0*t416*t444)*s1l2
      s4 = s3+(64.D0/3.D0*t156*t469*s23r-64.D0/3.D0*t346*t50*s2l1-64.D0/
     #3.D0*t346*t28-256.D0/3.D0*t478*t120)*t90
      s5 = s4
      s7 = (((-64*t346*t50-64.D0/3.D0*t346*t292)*s2l1+(-64*t346*t27-64.D
     #0/3.D0*t346*t152)*s2l2+64.D0/3.D0*t497+(128*t499+128.D0/3.D0*t501)
     #*s3l1p+128.D0/3.D0*t505-64.D0/3.D0*t507*z*t363*t9)*s23r+(-128.D0/3
     #.D0*t354-t391+64.D0/3.D0*t516*t143)*s2l1+(-64.D0/3.D0*t431+64.D0/3
     #.D0*t516*t184)*s2l2+(512.D0/3.D0*t526*t120+64.D0/3.D0*t529*t270*t9
     #)*s34r+(-128.D0/3.D0*t536*t143+t540)*s3l1p+64.D0/3.D0*t94*t153)*t8
     #9
      s8 = ((-128.D0/3.D0*t497+(-128.D0/3.D0*t499-64.D0/3.D0*t501)*s3l1p
     #-64.D0/3.D0*t505+64.D0/3.D0*t529*t266)*t129+((64*t357-64.D0/3.D0*t
     #559*t143-t540)*s2l1+(64*t431-64.D0/3.D0*t559*t184-64.D0/3.D0*t94*t
     #152)*s2l2-128.D0/3.D0*t3*t202*t469*t205+((-128*t525*t202*t9*s3l2p-
     #128.D0/3.D0*t525*t202*s4l2p*t9)*s3l1p-128.D0/3.D0*t526*t153+64.D0/
     #3.D0*(-5+z)*z*t1*t346*t9)*s34r+(128.D0/3.D0*(-6+t595)*t6*t143+64.D
     #0/3.D0*t536*t147)*s3l1p+64.D0/3.D0*t536*t8*t153+64.D0/3.D0*t515*z*
     #t4*t8*t9)*s23r+(-128.D0/3.D0*t139*t45+128.D0/3.D0*t381-64.D0/3.D0*
     #t619*t621)*s2l1+(128.D0/3.D0*t445-64.D0/3.D0*t619*t627)*s2l2+(-256
     #.D0/3.D0*t2*t322*t87*t120-64*t3*t478*t9)*t205+((128.D0/3.D0*(-7+4*
     #z)*t1*t34*t143-64*t148)*s3l1p-64*t154-t126)*s34r+(128.D0/3.D0*t653
     #*l3*t655-64.D0/3.D0*t14*t292)*s3l1p-64.D0/3.D0*t14*t153)*s1vr
      s6 = s7+s8
      s1 = s5+s6
      taux15 = s1+(-128.D0/3.D0*t495*t115+(-128.D0/3.D0*t279*t50-64.D0/3
     #.D0*t279*t292)*s3l1p-64.D0/3.D0*t279*t153+64.D0/3.D0*t156*t10)*t12
     #9+((64.D0/3.D0*t682*t621-64.D0/3.D0*t684)*s2l1+(64.D0/3.D0*t682*t6
     #27-64.D0/3.D0*t283*t372*s3l1p)*s2l2+128.D0/3.D0*t507*z*t2*t478*t9*
     #t205+((-128.D0/3.D0*t701*t1*t34*t143-64.D0/3.D0*t707*t147)*s3l1p-6
     #4.D0/3.D0*t707*t187*t50-64.D0/3.D0*t701*z*t1*t124)*s34r+(-128.D0/3
     #.D0*t684-64.D0/3.D0*t283*t5*s4l2p*t9)*s3l1p-64.D0/3.D0*t284*t153)*
     #s23r+(64.D0/3.D0*t734*t10*s3l2p*t205-64.D0/3.D0*t740*t20*t620)*s2l
     #1+(64.D0/3.D0*t734*t10*s3l1p*t205-64.D0/3.D0*t740*t20*t340)*s2l2+1
     #28.D0/3.D0*t204*t327+((-128.D0/3.D0*t282*t202*t2*t143+128.D0/3.D0*
     #t253)*s3l1p+128.D0/3.D0*t257+128.D0/3.D0*t214)*t205+((-128.D0/3.D0
     #*t283*t1*t267+128.D0/3.D0*t271)*s3l1p+128.D0/3.D0*t275)*s34r
      t1 = l3-1
      t2 = t1**2
      t3 = -1+z
      t4 = t3**2
      t5 = t4*t3
      t6 = t2*t5
      t7 = l3*t6
      t8 = 1/s3vr
      t9 = t8*s3l2p
      t10 = t9*s2l1
      t12 = t8*s3l1p
      t13 = t12*s2l2
      t18 = t8*l3
      t19 = t18*s3l2p
      t21 = l3*t5
      t23 = t2*s4l2p*t8
      t28 = t18*s3l1p
      t31 = t2*s4l1p*t8
      t38 = t4**2
      t40 = t2*t1
      t41 = l3*t38*t40
      t51 = s13r**2
      t53 = t1*t4
      t54 = l3**2
      t55 = t54*t8
      t58 = t54*t5
      t59 = t1*t8
      t61 = t58*t59*s3l2p
      t67 = t1*s4l2p*t8
      t68 = t58*t67
      t69 = -t61-t68
      t71 = s23r**2
      t73 = t2*t38
      t74 = t73*t54
      t75 = s34r*s23r
      t85 = t59*s3l1p
      t86 = t58*t85
      t92 = t1*s4l1p*t8
      t93 = t58*t92
      t94 = t86+t93
      t102 = t58*t1
      t107 = s1vr**2
      t115 = t1*t38
      t116 = t115*t54
      t117 = s4l2p*t8
      t118 = t117*s3l1p
      t121 = t8*s4l1p
      t122 = t121*s3l2p
      t127 = t9*s34r
      t128 = t74*t127
      t134 = t12*s34r
      t135 = t74*t134
      t144 = z*t4*t1
      t147 = l3*z*t4
      t157 = t38*t3
      t159 = t157*t2*t54
      t168 = t40*t157*t54
      t169 = s34r**2
      t186 = t54*l3
      t187 = t5*t186
      t188 = t187*t9
      t189 = 512.D0/3.D0*t188
      t190 = t187*t117
      t191 = 256.D0/3.D0*t190
      t195 = t186*t4
      t202 = 2*t1
      t204 = t202*t5*t186
      t205 = t8*s34r
      t210 = 3*t1*t38
      t211 = t186*t8
      t212 = t211*s3l2p
      t220 = z-2
      t221 = t220*t4
      t222 = t55*s3l2p
      t225 = t54*t4
      t237 = 256.D0/3.D0*t1*t5*t211*s34r-256.D0/3.D0*t225*t8
      t241 = t186*t38
      t248 = t58*t117
      t260 = 256.D0/3.D0*t73*t211*t169-256.D0/3.D0*t220*t1*t4*t55*s34r
      t262 = t186*t157
      t263 = t2*t8
      t280 = t187*t12
      t281 = 512.D0/3.D0*t280
      t282 = t187*t121
      t283 = 256.D0/3.D0*t282
      t296 = t211*s3l1p
      t304 = t55*s3l1p
      t323 = t58*t121
      t336 = t54*t38
      t352 = t241*t118
      t354 = t241*t122
      t369 = -t1*t38*t186
      t372 = 4*t4*t3
      t383 = t202*t186*t157
      t389 = 2*z
      t392 = (-3+t389)*t5*t54
      t400 = l3*t4
      t418 = z*t5*t1
      t435 = (-1+t389)*t1*t38
      s3 = ((256.D0/3.D0*t7*t10-256.D0/3.D0*t7*t13)*s1vr+((-256.D0/3.D0*
     #t6*t19-256.D0/3.D0*t21*t23)*s2l1+(256.D0/3.D0*t6*t28+256.D0/3.D0*t
     #21*t31)*s2l2)*s23r-256.D0/3.D0*t41*t9*s34r*s2l1+256.D0/3.D0*t41*t1
     #2*s34r*s2l2)*t51
      s4 = (((256.D0/3.D0*t53*t55*s2l2+256.D0/3.D0*t61)*s23r*s1vr+256.D0
     #/3.D0*t69*t71-256.D0/3.D0*t74*t9*t75)*s1l1+((-256.D0/3.D0*t1*t54*t
     #4*t8*s2l1-256.D0/3.D0*t86)*s23r*s1vr+256.D0/3.D0*t94*t71+256.D0/3.
     #D0*t74*t12*t75)*s1l2+(256.D0/3.D0*t102*t10-256.D0/3.D0*t102*t13)*t
     #107+((-512.D0/3.D0*t69*s2l1-512.D0/3.D0*t94*s2l2+256.D0/3.D0*t116*
     #t118-256.D0/3.D0*t116*t122)*s23r+(-256*t128-256.D0/3.D0*t53*t19)*s
     #2l1+(256*t135+256.D0/3.D0*t53*t28)*s2l2)*s1vr+((256.D0/3.D0*t128+2
     #56.D0/3.D0*t144*t19+256.D0/3.D0*t147*t67)*s2l1+(-256.D0/3.D0*t135-
     #256.D0/3.D0*t144*t28-256.D0/3.D0*t147*t92)*s2l2+(-256.D0/3.D0*t159
     #*t118+256.D0/3.D0*t159*t122)*s34r)*s23r+(512.D0/3.D0*t168*t9*t169+
     #256.D0/3.D0*t7*t127)*s2l1+(-512.D0/3.D0*t168*t12*t169-256.D0/3.D0*
     #t7*t134)*s2l2)*s13r
      s2 = s3+s4
      s3 = s2
      s5 = ((-t189-t191)*s23r*t107+((-256.D0/3.D0*t195*t8*s2l2+t189+512.
     #D0/3.D0*t190)*t71+(-256.D0/3.D0*t204*t205*s2l2+(256.D0/3.D0*t210*t
     #212+256.D0/3.D0*t210*t186*s4l2p*t8)*s34r-256.D0/3.D0*t221*t222+256
     #.D0/3.D0*t225*t117)*s23r)*s1vr+(t237*s2l2+(-256.D0/3.D0*t115*t212-
     #512.D0/3.D0*t241*t67)*s34r+256.D0/3.D0*t58*t9+256.D0/3.D0*t248)*t7
     #1+(t260*s2l2+(-256.D0/3.D0*t262*t263*s3l2p-512.D0/3.D0*t262*t23)*t
     #169+(256.D0/3.D0*t115*t222-512.D0/3.D0*t68)*s34r)*s23r)*s1l1
      s6 = ((t281+t283)*s23r*t107+((256.D0/3.D0*t195*t8*s2l1-t281-512.D0
     #/3.D0*t282)*t71+(256.D0/3.D0*t204*t205*s2l1+(-256.D0/3.D0*t210*t29
     #6-256.D0/3.D0*t210*t186*s4l1p*t8)*s34r+256.D0/3.D0*t221*t304-256.D
     #0/3.D0*t225*t121)*s23r)*s1vr+(-t237*s2l1+(256.D0/3.D0*t115*t296+51
     #2.D0/3.D0*t241*t92)*s34r-256.D0/3.D0*t58*t12-256.D0/3.D0*t323)*t71
     #+(-t260*s2l1+(256.D0/3.D0*t262*t263*s3l1p+512.D0/3.D0*t262*t31)*t1
     #69+(-256.D0/3.D0*t336*t85+512.D0/3.D0*t93)*s34r)*s23r)*s1l2
      s4 = s5+s6
      s1 = s3+s4
      taux16 = s1+(((-256*t188-t191)*s2l1+(256*t280+t283)*s2l2-512.D0/3.
     #D0*t352+512.D0/3.D0*t354)*s23r-256.D0/3.D0*t225*t10+256.D0/3.D0*t2
     #25*t13)*t107+((256.D0/3.D0*t352-256.D0/3.D0*t354)*t71+((-256.D0/3.
     #D0*t369*t127-256.D0/3.D0*t372*t222-256.D0/3.D0*t248)*s2l1+(256.D0/
     #3.D0*t369*t134+256.D0/3.D0*t372*t304+256.D0/3.D0*t323)*s2l2+(256.D
     #0/3.D0*t383*t118-256.D0/3.D0*t383*t122)*s34r-256.D0/3.D0*t392*t118
     #+256.D0/3.D0*t392*t122)*s23r+(256.D0/3.D0*t102*t127-256.D0/3.D0*t4
     #00*t9)*s2l1+(-256.D0/3.D0*t102*t134+256.D0/3.D0*t400*t12)*s2l2)*s1
     #vr+(256.D0/3.D0*t336*t118-256.D0/3.D0*t336*t122)*t71+((256.D0/3.D0
     #*t418*t55*s3l2p*s34r-256.D0/3.D0*t21*t9)*s2l1+(-256.D0/3.D0*t418*t
     #55*s3l1p*s34r+256.D0/3.D0*t21*t12)*s2l2+(256.D0/3.D0*t435*t54*s4l2
     #p*t12-256.D0/3.D0*t435*t54*s4l1p*t9)*s34r+256.D0/3.D0*t21*t118-256
     #.D0/3.D0*t21*t122)*s23r

CCC Coefficients

      tcoff29 = taux15
      tcoff30 = taux15
      tcoff31 = taux16
      tcoff32 = taux16

CCC Jet functions

      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet29 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff29)
      t2 = 1-l3
      t3 = 1-z
      t5 = t2*t3*s13r
      t6 = l3*t3
      t7 = t6*s23r
      t8 = t6*s1vr
      t11 = t3**2
      t13 = l3*t2*t11*s34r
      tFjet30 = Fjet(var,ndim,z,1/ux,t5,t7,-1-t5-t8+z,t8-t7-t13,t13,t8,-
     #1+z-t8+t13,-t5-t7-t13+z,1+t5+t7,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff30)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet31 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff31)
      t2 = 1-l3
      t3 = 1-z
      t5 = t2*t3*s13r
      t6 = l3*t3
      t7 = t6*s23r
      t8 = t6*s1vr
      t11 = t3**2
      t13 = l3*t2*t11*s34r
      tFjet32 = Fjet(var,ndim,z,1/ux,t5,t7,-1-t5-t8+z,t8-t7-t13,t13,t8,-
     #1+z-t8+t13,-t5-t7-t13+z,1+t5+t7,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff32)

CCC Sum

      qgrmnum9e0 = tFjet29*tcoff29+tFjet30*tcoff30+tFjet31*tcoff31+tFjet
     #32*tcoff32
      RETURN
      END

      double precision function qgrmnum9e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3-1
      t2 = t1**2
      t3 = -1+z
      t4 = t3**2
      t5 = t4*t3
      t6 = t2*t5
      t7 = l3**2
      t8 = t6*t7
      t9 = 1/s3vr
      t11 = s1vr**2
      t15 = z*t2
      t16 = t15*t5
      t17 = t7*t9
      t21 = l3*t5
      t22 = t21*t2
      t23 = s4l2p*t9
      t27 = s4l1p*t9
      t31 = t4**2
      t33 = t2*t1
      t35 = t17*s34r
      t38 = l3*z
      t39 = t4*t2
      t40 = t39*t9
      t45 = z*t7
      t47 = t33*t9
      t53 = t9*s34r
      t54 = t53*s2l2
      t58 = l3*t31*t33
      t62 = t9*s3l2p
      t71 = t9*s3l1p
      t77 = t31*t3
      t78 = z*t77
      t79 = t2**2
      t81 = s34r**2
      t82 = t17*t81
      t90 = s13r**2
      t95 = t1*t9
      t98 = 128.D0/3.D0*t6*t35-64.D0/3.D0*l3*t3*t95
      t100 = t1*t4
      t101 = l3*t9
      t102 = t101*s3l2p
      t104 = 64.D0/3.D0*t100*t102
      t106 = l3*s4l2p*t9
      t107 = t100*t106
      t108 = 64.D0/3.D0*t107
      t112 = 128.D0/3.D0*t54*t8
      t115 = t7*t31
      t119 = l3*t4
      t120 = t2*t9
      t124 = -128.D0/3.D0*t115*t47*t81-64.D0/3.D0*t119*t120*s34r
      t128 = t2*s4l2p*t9
      t129 = t21*t128
      t136 = t101*s3l1p
      t138 = 64.D0/3.D0*t100*t136
      t140 = l3*s4l1p*t9
      t141 = t100*t140
      t142 = 64.D0/3.D0*t141
      t145 = t53*s2l1
      t153 = t2*s4l1p*t9
      t154 = t21*t153
      t160 = t7*l3
      t161 = z*t160
      t166 = t5*t7
      t167 = t95*s3l2p
      t169 = 128.D0/3.D0*t166*t167
      t170 = t1*s4l2p
      t171 = t170*t9
      t172 = t166*t171
      t176 = t95*s3l1p
      t178 = 128.D0/3.D0*t166*t176
      t180 = t1*s4l1p*t9
      t181 = t166*t180
      t185 = t1*t31
      t186 = t185*t7
      t187 = t23*s3l1p
      t189 = 64.D0/3.D0*t186*t187
      t190 = t27*s3l2p
      t192 = 64.D0/3.D0*t186*t190
      t193 = z*t1
      t194 = t4*t7
      t196 = t193*t194*t9
      t200 = t193*t5
      t201 = t160*t9
      t202 = s23r**2
      t213 = t201*s34r
      t214 = t15*t31*t213
      t216 = t7*s4l2p
      t217 = t216*s4l1p
      t220 = 2*z
      t221 = -1+t220
      t223 = t100*t7
      t230 = t2*t31
      t231 = t17*s3l2p
      t232 = t230*t231
      t233 = t216*t9
      t234 = t230*t233
      t238 = 2-z
      t240 = t238*t4*t1
      t245 = t17*s3l1p
      t246 = t230*t245
      t247 = t7*s4l1p
      t249 = t230*t247*t9
      t257 = t77*t2
      t258 = t257*t7
      t259 = t258*t187
      t261 = t258*t190
      t264 = t15*t166*t9
      t268 = l3*t1
      t270 = t5*t9*s3l2p
      t271 = t268*t270
      t272 = t1*t5
      t273 = t272*t106
      t278 = t272*l3*t190
      t282 = 64.D0/3.D0*t38*t100*t9
      t286 = t5*z
      t287 = t1*t7
      t298 = z*t4*t1
      t302 = t221*t4*t1
      t318 = t201*t81
      t338 = t5*s4l2p
      t348 = -3+t220
      t349 = t348*l3
      t350 = t349*t4
      t351 = s34r*s2l2
      t355 = t33*t77
      t356 = t355*t7
      t357 = t62*t81
      t371 = t71*t81
      t385 = t31*t4
      t387 = t385*t33*t7
      t399 = l3*t2
      t409 = z**2
      t419 = s4l2p*s4l1p
      s2 = ((t98*s2l2+t104-t108)*s1vr+(-t112-t104-t108)*s23r+t124*s2l2+(
     #-64.D0/3.D0*t6*t102+64.D0/3.D0*t129)*s34r)*s1l1+((t98*s2l1+t138-t1
     #42)*s1vr+(-128.D0/3.D0*t8*t145-t138-t142)*s23r+t124*s2l1+(-64.D0/3
     #.D0*t6*t136+64.D0/3.D0*t154)*s34r)*s1l2+(-256.D0/3.D0*t161*t5*t95*
     #s23r+(-t169-64.D0/3.D0*t172)*s2l1+(-t178-64.D0/3.D0*t181)*s2l2+t18
     #9+t192+64.D0/3.D0*t196)*t11
      s3 = s2+(64.D0/3.D0*t200*t201*t202+((t169+64*t172)*s2l1+(t178+64*t
     #181)*s2l2+512.D0/3.D0*t214-t189-t192+(-128.D0/3.D0*t185*t217-64.D0
     #/3.D0*t221*z*t223)*t9)*s23r+(t112+(64.D0/3.D0*t232+64.D0/3.D0*t234
     #)*s34r+64.D0/3.D0*t240*t102)*s2l1+((64.D0/3.D0*t246+64.D0/3.D0*t24
     #9)*s34r+64.D0/3.D0*t240*t136)*s2l2+(-128.D0/3.D0*t259-128.D0/3.D0*
     #t261-448.D0/3.D0*t264)*s34r+(-128.D0/3.D0*t271-128.D0/3.D0*t273)*s
     #3l1p-128.D0/3.D0*t278-t282)*s1vr
      s1 = s3+(-256.D0/3.D0*t214+64.D0/3.D0*t286*t287*t9)*t202+((t112+(6
     #4.D0/3.D0*t232-128.D0/3.D0*t234)*s34r+64.D0/3.D0*t298*t102+64.D0/3
     #.D0*t302*t106)*s2l1+((64.D0/3.D0*t246-128.D0/3.D0*t249)*s34r+64.D0
     #/3.D0*t298*t136+64.D0/3.D0*t302*t140)*s2l2-256.D0/3.D0*t78*t33*t31
     #8+(64.D0/3.D0*t259+64.D0/3.D0*t261+(128.D0/3.D0*t257*t217+64.D0/3.
     #D0*(5+t220)*z*t8)*t9)*s34r+(128.D0/3.D0*t271+64*t273)*s3l1p+64*t27
     #8+(256.D0/3.D0*t268*t338*s4l1p-64.D0/3.D0*t38*t100)*t9)*s23r
      t423 = s1+(128.D0/3.D0*t350*t120*t351+64.D0/3.D0*t356*t357+(64.D0/
     #3.D0*t16*t102+256.D0/3.D0*t129)*s34r+128.D0/3.D0*t100*t62+64.D0/3.
     #D0*t100*t23)*s2l1+(64.D0/3.D0*t356*t371+(64.D0/3.D0*t16*t136+256.D
     #0/3.D0*t154)*s34r+128.D0/3.D0*t100*t71+64.D0/3.D0*t100*t27)*s2l2+(
     #64.D0/3.D0*t387*t187+64.D0/3.D0*t387*t190+128*t45*t31*t33*t9)*t81+
     #((128.D0/3.D0*t230*t102+128.D0/3.D0*t399*t31*s4l2p*t9)*s3l1p+128.D
     #0/3.D0*t399*t31*t190+64.D0/3.D0*t409*l3*t40)*s34r+64.D0/3.D0*t100*
     #t187+64.D0/3.D0*t100*t190+128.D0/3.D0*t100*t419*t9
      t426 = t3*t7
      t431 = t4*t9
      t433 = t287*t431*s34r
      t437 = t160*t5
      t438 = t437*t1
      t442 = t230*t318
      t450 = t11*s1vr
      t454 = t437*t62
      t456 = t437*t23
      t460 = t438*t54
      t462 = t185*t160
      t464 = t462*t62*s34r
      t466 = -t238
      t467 = t466*t4
      t476 = t185*t201*s3l2p
      t478 = t160*t31
      t480 = 128.D0/3.D0*t478*t171
      t483 = t348*t4
      t486 = 4-z
      t487 = t486*t7
      t488 = t4*s4l2p
      t489 = t488*t9
      t495 = t486*t1*t4
      t499 = t160*t77
      t500 = t499*t2
      t501 = t500*t357
      t511 = t166*t62
      t512 = t166*t23
      t516 = 128.D0/3.D0*t442
      t517 = 3-z
      t522 = t516-64.D0/3.D0*t517*t1*t4*t35
      t527 = (t220+1)*t7*t5
      t530 = t466*t7*t5
      t535 = t221*t3
      t538 = 3*z
      t539 = t538-2
      t540 = t539*t3
      t545 = t81*s34r
      t553 = t95*s34r
      t556 = 64.D0/3.D0*t355*t201*t545-64.D0/3.D0*t486*t2*t5*t82+64.D0/3
     #.D0*t221*l3*t3*t553
      t559 = t160*t33*t385
      t565 = (2+z)*t2*t31
      t570 = t100*l3
      t571 = t221*t9
      t582 = t437*t71
      t584 = t437*t27
      t588 = t438*t145
      t591 = t462*t71*s34r
      t601 = t185*t201*s3l1p
      t604 = 128.D0/3.D0*t478*t180
      t609 = t4*s4l1p
      t619 = t500*t371
      t630 = t166*t27
      t666 = t478*t187
      t667 = t478*t190
      t671 = t7**2
      t686 = t478*t419
      t699 = (t538-4)*t4
      t712 = t1*t160*t77
      t713 = t712*t187
      t714 = t712*t190
      t720 = 2*t3*t5*t7
      t730 = 4*z
      t742 = 3*t4*t3
      t765 = 128.D0/3.D0*t511
      t766 = t539*t5
      t788 = t120*s3l2p
      t801 = t517*l3
      t802 = t431*s3l2p
      t807 = t120*s3l1p
      t820 = t431*s3l1p
      t826 = t160*t2*t385
      t832 = t185*t231
      t836 = (-2+t730)*t1*t31
      t841 = t247*t62
      t847 = t466*l3
      t849 = 128.D0/3.D0*t847*t802
      t860 = (z+1)*t5
      t881 = -t3*t7
      t882 = t881*t5
      t906 = (1+t538)*t1*t31
      t946 = t881*t31
      t949 = t221*t7*t31
      t956 = (2-t220+t409)*t1*t4
      t978 = t15*t77
      t992 = t486*l3*t1
      s3 = (64.D0/3.D0*t8*z*t9*t11+(-64.D0/3.D0*t16*t17*s23r-64.D0/3.D0*
     #t22*t23*s2l1-64.D0/3.D0*t22*t27*s2l2-128.D0/3.D0*z*t31*t33*t35+64.
     #D0/3.D0*t38*t40)*s1vr+64.D0/3.D0*t45*t31*t47*s34r*s23r+(-128.D0/3.
     #D0*t21*t33*t54+64.D0/3.D0*t58*t23*s34r-64.D0/3.D0*t39*t62-64.D0/3.
     #D0*t39*t23)*s2l1+(64.D0/3.D0*t58*t27*s34r-64.D0/3.D0*t39*t71-64.D0
     #/3.D0*t39*t27)*s2l2+64.D0/3.D0*t78*t79*t82-64.D0/3.D0*t38*t5*t47*s
     #34r)*t90
      s4 = t423*s13r+((((128.D0/3.D0*t272*t213-128.D0/3.D0*t426*t9)*s23r
     #+128.D0/3.D0*t433)*s1vr-128.D0/3.D0*t438*t53*t202+(-128.D0/3.D0*t4
     #42-128.D0/3.D0*t433)*s23r-128.D0/3.D0*t6*t82)*s1l2+128.D0/3.D0*t43
     #7*t62*t450+((-256.D0/3.D0*t454-128.D0/3.D0*t456)*s23r-64.D0/3.D0*t
     #460-320.D0/3.D0*t464+64.D0/3.D0*t467*t231)*t11+((128.D0/3.D0*t454+
     #128.D0/3.D0*t456)*t202+((128*t476+t480)*s34r-64.D0/3.D0*t483*t231+
     #64.D0/3.D0*t487*t489)*s23r+64.D0/3.D0*t495*t17*t351+256.D0/3.D0*t5
     #01-128.D0/3.D0*t200*t17*s3l2p*s34r-128.D0/3.D0*t119*t62)*s1vr+(64.
     #D0/3.D0*t460-64.D0/3.D0*t464+64.D0/3.D0*t511+64.D0/3.D0*t512)*t202
     #+(t522*s2l2-128.D0/3.D0*t501+(64.D0/3.D0*t527*t167+64.D0/3.D0*t530
     #*t171)*s34r+64.D0/3.D0*t535*t102+64.D0/3.D0*t540*t106)*s23r+t556*s
     #2l2-64.D0/3.D0*t559*t62*t545+64.D0/3.D0*t565*t17*s3l2p*t81+(64.D0/
     #3.D0*t570*t571*s3l2p-64.D0/3.D0*t107)*s34r)*s1l1
      s2 = s3+s4
      s3 = s2+(128.D0/3.D0*t437*t71*t450+((-256.D0/3.D0*t582-128.D0/3.D0
     #*t584)*s23r-64.D0/3.D0*t588-320.D0/3.D0*t591+64.D0/3.D0*t467*t245)
     #*t11+((128.D0/3.D0*t582+128.D0/3.D0*t584)*t202+((128*t601+t604)*s3
     #4r-64.D0/3.D0*t483*t245+64.D0/3.D0*t487*t609*t9)*s23r+64.D0/3.D0*t
     #495*t17*s34r*s2l1+256.D0/3.D0*t619-128.D0/3.D0*t200*t17*s3l1p*s34r
     #-128.D0/3.D0*t119*t71)*s1vr+(64.D0/3.D0*t588-64.D0/3.D0*t591+64.D0
     #/3.D0*t166*t71+64.D0/3.D0*t630)*t202+(t522*s2l1-128.D0/3.D0*t619+(
     #64.D0/3.D0*t527*t176+64.D0/3.D0*t530*t180)*s34r+64.D0/3.D0*t535*t1
     #36+64.D0/3.D0*t540*t140)*s23r+t556*s2l1-64.D0/3.D0*t559*t71*t545+6
     #4.D0/3.D0*t565*t17*s3l1p*t81+(64.D0/3.D0*t570*t571*s3l1p-64.D0/3.D
     #0*t141)*s34r)*s1l2
      s4 = s3+(128.D0/3.D0*t437*t62*s2l1+128.D0/3.D0*t437*t71*s2l2-128.D
     #0/3.D0*t666-128.D0/3.D0*t667)*t450
      s5 = s4
      s7 = (64*t286*t671*t9*t202+((-128.D0/3.D0*t454-64.D0/3.D0*t456)*s2
     #l1+(-128.D0/3.D0*t582-64.D0/3.D0*t584)*s2l2+64*t666+64*t667+(256.D
     #0/3.D0*t686+64*t161*t4)*t9)*s23r+(-128.D0/3.D0*t460+(-64.D0/3.D0*t
     #476+t480)*s34r+64.D0/3.D0*t699*t231)*s2l1+((-64.D0/3.D0*t601+t604)
     #*s34r+64.D0/3.D0*t699*t245)*s2l2+(256.D0/3.D0*t713+256.D0/3.D0*t71
     #4)*s34r-64.D0/3.D0*t720*t187-64.D0/3.D0*t720*t190)*t11
      s10 = (-64.D0/3.D0*t666-64.D0/3.D0*t667+(-128.D0/3.D0*t686+64.D0/3
     #.D0*(-6+t730)*z*t160*t4)*t9)*t202+((-64.D0/3.D0*t464-64.D0/3.D0*t7
     #42*t231-128.D0/3.D0*t512)*s2l1+(-64.D0/3.D0*t591-64.D0/3.D0*t742*t
     #245-128.D0/3.D0*t630)*s2l2+(-64*t713-64*t714+(-256.D0/3.D0*t499*t1
     #70*s4l1p-128*t161*t272)*t9)*s34r+(t765+64.D0/3.D0*t766*t233)*s3l1p
     #+64.D0/3.D0*t766*t7*t190+(256.D0/3.D0*t115*t419+256.D0/3.D0*t3*z*t
     #426)*t9)*s23r+((t516-256.D0/3.D0*t166*t553)*s2l2+(-64.D0/3.D0*t499
     #*t788-128.D0/3.D0*t499*t128)*t81+(-64.D0/3.D0*t720*t167+128.D0/3.D
     #0*t185*t233)*s34r-64.D0/3.D0*t801*t802)*s2l1+((-64.D0/3.D0*t499*t8
     #07-128.D0/3.D0*t499*t153)*t81+(-64.D0/3.D0*t720*t176+128.D0/3.D0*t
     #115*t180)*s34r-64.D0/3.D0*t801*t820)*s2l2
      s9 = s10+(-128.D0/3.D0*t826*t187-128.D0/3.D0*t826*t190)*t81+((128.
     #D0/3.D0*t832+64.D0/3.D0*t836*t233)*s3l1p+64.D0/3.D0*t836*t841-64*t
     #196)*s34r+(t849-64.D0/3.D0*t801*t489)*s3l1p-64.D0/3.D0*t801*t4*t19
     #0
      s10 = s1vr
      s8 = s9*s10
      s6 = s7+s8
      s1 = s5+s6
      s2 = s1+((-t765-64.D0/3.D0*t860*t233)*s3l1p-64.D0/3.D0*t860*t7*t19
     #0+(-128.D0/3.D0*t166*z*s4l2p*s4l1p-64.D0/3.D0*t517*z*t194)*t9)*t20
     #2+(((64.D0/3.D0*t882*t167-64.D0/3.D0*t172)*s34r-64.D0/3.D0*t21*t62
     #-64.D0/3.D0*t21*t23)*s2l1+((64.D0/3.D0*t882*t176-64.D0/3.D0*t181)*
     #s34r-64.D0/3.D0*t21*t71-64.D0/3.D0*t21*t27)*s2l2+((-256.D0/3.D0*t8
     #32-64.D0/3.D0*t906*t233)*s3l1p-64.D0/3.D0*t906*t841+(-128.D0/3.D0*
     #t221*t1*t31*t217+64.D0/3.D0*(8-t730)*z*t223)*t9)*s34r+(-t849-64.D0
     #/3.D0*t349*t489)*s3l1p-64.D0/3.D0*t350*t190+(-128.D0/3.D0*t21*t419
     #+64.D0/3.D0*t38*t4)*t9)*s23r+((128.D0/3.D0*t115*t120*t81-128.D0/3.
     #D0*t272*t101*s34r)*s2l2+(64.D0/3.D0*t946*t788-64.D0/3.D0*t949*t128
     #)*t81+(-64.D0/3.D0*t956*t102-64.D0/3.D0*t273)*s34r-64.D0/3.D0*t802
     #)*s2l1
      taux15 = s2+((64.D0/3.D0*t946*t807-64.D0/3.D0*t949*t153)*t81+(-64.
     #D0/3.D0*t956*t136-64.D0/3.D0*t272*t140)*s34r-64.D0/3.D0*t820)*s2l2
     #+((-128.D0/3.D0*t257*t231-128.D0/3.D0*t978*t233)*s3l1p-128.D0/3.D0
     #*t978*t841+320.D0/3.D0*t264)*t81+((-128.D0/3.D0*t847*t1*t270+64.D0
     #/3.D0*t992*t338*t9)*s3l1p+64.D0/3.D0*t992*t5*s4l1p*t62-t282)*s34r-
     #64.D0/3.D0*t488*t71-64.D0/3.D0*t609*t62
      t1 = l3-1
      t2 = t1**2
      t3 = -1+z
      t4 = t3**2
      t5 = t4*t3
      t6 = t2*t5
      t7 = l3*t6
      t8 = 1/s3vr
      t9 = t8*s3l2p
      t10 = t9*s2l1
      t12 = t8*s3l1p
      t13 = t12*s2l2
      t18 = t8*l3
      t19 = t18*s3l2p
      t20 = t6*t19
      t21 = l3*t5
      t23 = t2*s4l2p*t8
      t24 = t21*t23
      t25 = t20+t24
      t28 = t18*s3l1p
      t29 = t6*t28
      t31 = t2*s4l1p*t8
      t32 = t21*t31
      t33 = -t29-t32
      t38 = t4**2
      t40 = t2*t1
      t41 = l3*t38*t40
      t42 = t9*s34r
      t45 = t4*t2
      t48 = s4l2p*t8
      t53 = t12*s34r
      t58 = t8*s4l1p
      t64 = s13r**2
      t66 = -t1
      t67 = 3*t66
      t68 = t67*t4
      t69 = l3**2
      t70 = t69*t8
      t74 = t69*t5
      t75 = t1*t8
      t76 = t75*s3l2p
      t77 = t74*t76
      t81 = t70*s34r
      t86 = 256.D0/3.D0*t6*t81+256.D0/3.D0*l3*t3*t75
      t88 = t66*t4
      t89 = t88*t19
      t92 = l3*s4l2p*t8
      t93 = t88*t92
      t98 = t1*s4l2p*t8
      t99 = t74*t98
      t100 = t77+t99
      t102 = s23r**2
      t104 = t6*t69
      t105 = t8*s34r
      t106 = t105*s2l2
      t109 = t2*t38
      t110 = t109*t69
      t111 = t110*t42
      t117 = t69*t38
      t119 = s34r**2
      t123 = t2*t8
      t127 = -256.D0/3.D0*t117*t40*t8*t119-256.D0/3.D0*l3*t4*t123*s34r
      t136 = t75*s3l1p
      t137 = t74*t136
      t143 = t88*t28
      t146 = l3*s4l1p*t8
      t147 = t88*t146
      t152 = t1*s4l1p*t8
      t153 = t74*t152
      t154 = -t137-t153
      t157 = t105*s2l1
      t160 = t110*t53
      t172 = t74*t1
      t177 = s1vr**2
      t185 = t1*t38
      t186 = t185*t69
      t187 = t48*s3l1p
      t190 = t58*s3l2p
      t196 = t1*t4
      t210 = t1*t5
      t211 = t210*l3
      t213 = 256.D0/3.D0*t211*t187
      t215 = 256.D0/3.D0*t211*t190
      t219 = 3*z
      t222 = (1-t219)*t4*t1
      t236 = t38*t3
      t238 = t236*t2*t69
      t247 = t40*t236*t69
      t248 = t9*t119
      t256 = (2-z)*t3
      t259 = t1*t3
      t264 = t12*t119
      t278 = l3*t2*t38
      t290 = t69*l3
      t291 = t5*t290
      t292 = t177*s1vr
      t296 = t291*t9
      t298 = t291*t48
      t299 = 1024.D0/3.D0*t298
      t302 = t210*t290
      t305 = t185*t290
      t306 = t305*t42
      t308 = -t3
      t309 = t308*t4
      t310 = t70*s3l2p
      t315 = t290*t4
      t325 = t290*t8
      t326 = t325*s34r
      t328 = t308*t69
      t331 = -1792.D0/3.D0*t66*t5*t326+256.D0/3.D0*t328*t8
      t334 = 10*t66*t38
      t335 = t325*s3l2p
      t345 = (8-4*z)*t4
      t349 = (3-z)*t4
      t350 = t69*s4l2p
      t351 = t350*t8
      t357 = t109*t325*t119
      t362 = 256.D0/3.D0*t357-256.D0/3.D0*z*t1*t4*t81
      t364 = t290*t236
      t365 = t364*t2
      t368 = 2*t308
      t370 = t368*t69*t5
      t372 = t75*s3l2p*s34r
      t375 = t3*z
      t386 = 256.D0/3.D0*t67*t5*t326+256*t4*t69*t8
      t390 = t290*t38
      t402 = 4*t3
      t407 = t308*l3
      t410 = -256*t357+256.D0/3.D0*t402*t1*t4*t81+256.D0/3.D0*t407*t8
      t419 = -t402
      t421 = t419*t69*t5
      t425 = (4-z)*t69*t5
      t430 = 2*z
      t432 = (1-t430)*t3
      t446 = 256.D0/3.D0*z*t2*t5*t70*t119-256.D0/3.D0*t88*t18*s34r
      t448 = t328*t38
      t465 = t291*t12
      t467 = t291*t58
      t468 = 1024.D0/3.D0*t467
      t473 = t305*t53
      t475 = t70*s3l1p
      t489 = t325*s3l1p
      t499 = t69*s4l1p
      t500 = t499*t8
      t510 = t75*s3l1p*s34r
      t574 = t390*t187
      t576 = t390*t190
      t581 = (5-t430)*t4
      t601 = -t67*t38*t290
      t604 = 14*t308*t4
      t606 = 5*z
      t608 = (-t606+4)*t4
      t621 = 6*t66*t290*t236
      t627 = 6*z
      t630 = (8-t627)*t5*t69
      t639 = (7-t430)*t69*t5
      t644 = z**2
      t646 = (t644+5-t606)*t3
      t660 = t66*t38*t69
      t666 = l3*z
      t667 = t666*t4
      t681 = (-t219+2)*t69*t5
      t683 = t419*l3
      t684 = t4*t8
      t704 = (3-t627)*t1*t38
      t713 = t368*l3*t4
      t724 = (-2+t430-t644)*t1*t4
      t730 = t3*t8
      t746 = t666*t1
      s3 = ((-512.D0/3.D0*t7*t10+512.D0/3.D0*t7*t13)*s1vr+(512.D0/3.D0*t
     #25*s2l1+512.D0/3.D0*t33*s2l2)*s23r+(512.D0/3.D0*t41*t42+256.D0/3.D
     #0*t45*t9+256.D0/3.D0*t45*t48)*s2l1+(-512.D0/3.D0*t41*t53-256.D0/3.
     #D0*t45*t12-256.D0/3.D0*t45*t58)*s2l2)*t64
      s8 = (((256.D0/3.D0*t68*t70*s2l2-512.D0/3.D0*t77)*s23r+t86*s2l2+25
     #6.D0/3.D0*t89+256.D0/3.D0*t93)*s1vr+512.D0/3.D0*t100*t102+(-256.D0
     #/3.D0*t104*t106+512.D0/3.D0*t111-512.D0/3.D0*t89-512.D0/3.D0*t93)*
     #s23r+t127*s2l2+256.D0/3.D0*t25*s34r)*s1l1+(((-256.D0/3.D0*t68*t70*
     #s2l1+512.D0/3.D0*t137)*s23r-t86*s2l1-256.D0/3.D0*t143-256.D0/3.D0*
     #t147)*s1vr+512.D0/3.D0*t154*t102+(256.D0/3.D0*t104*t157-512.D0/3.D
     #0*t160+512.D0/3.D0*t143+512.D0/3.D0*t147)*s23r-t127*s2l1+256.D0/3.
     #D0*t33*s34r)*s1l2
      s7 = s8+(-256*t172*t10+256*t172*t13)*t177+((-512*t100*s2l1-512*t15
     #4*s2l2-256*t186*t187+256*t186*t190)*s23r+(768*t111+256.D0/3.D0*t19
     #6*t19-256.D0/3.D0*t196*t92)*s2l1+(-768*t160-256.D0/3.D0*t196*t28+2
     #56.D0/3.D0*t196*t146)*s2l2-t213+t215)*s1vr+((-256*t111+256.D0/3.D0
     #*t222*t19+256.D0/3.D0*t222*t92)*s2l1+(256*t160-256.D0/3.D0*t222*t2
     #8-256.D0/3.D0*t222*t146)*s2l2+(256*t238*t187-256*t238*t190)*s34r+t
     #213-t215)*s23r
      s6 = s7+(-512*t247*t248+(-512.D0/3.D0*t20+256.D0/3.D0*t24)*s34r+25
     #6.D0/3.D0*t256*t76+256.D0/3.D0*t259*t48)*s2l1+(512*t247*t264+(512.
     #D0/3.D0*t29-256.D0/3.D0*t32)*s34r-256.D0/3.D0*t256*t136-256.D0/3.D
     #0*t259*t58)*s2l2+(256.D0/3.D0*t278*t187-256.D0/3.D0*t278*t190)*s34
     #r-256.D0/3.D0*t88*t187+256.D0/3.D0*t88*t190
      s7 = s13r
      s5 = s6*s7
      s6 = (-256.D0/3.D0*t291*t9*t292+((1792.D0/3.D0*t296+t299)*s23r-256
     #.D0/3.D0*t302*t106+512.D0/3.D0*t306+256.D0/3.D0*t309*t310)*t177+((
     #256*t315*t8*s2l2-512*t296-512*t298)*t102+(t331*s2l2+(256.D0/3.D0*t
     #334*t335+256.D0/3.D0*t334*t290*s4l2p*t8)*s34r-256.D0/3.D0*t345*t31
     #0-256.D0/3.D0*t349*t351)*s23r+t362*s2l2-256.D0/3.D0*t365*t248-256.
     #D0/3.D0*t370*t372+256.D0/3.D0*t375*t19)*s1vr+(t386*s2l2+(256*t185*
     #t335+512*t390*t98)*s34r-256*t74*t9-256*t74*t48)*t102+(t410*s2l2+(2
     #56*t364*t123*s3l2p+512*t364*t23)*t119+(256.D0/3.D0*t421*t76+256.D0
     #/3.D0*t425*t98)*s34r+256.D0/3.D0*t432*t19+256.D0/3.D0*t407*t48)*s2
     #3r+t446*s2l2+256.D0/3.D0*t448*t123*s3l2p*t119+(-256.D0/3.D0*l3*t1*
     #t5*t8*s3l2p-256.D0/3.D0*t93)*s34r)*s1l1
      s4 = s5+s6
      s2 = s3+s4
      s3 = s2+(256.D0/3.D0*t291*t12*t292+((-1792.D0/3.D0*t465-t468)*s23r
     #+256.D0/3.D0*t302*t157-512.D0/3.D0*t473-256.D0/3.D0*t309*t475)*t17
     #7+((-256*t315*t8*s2l1+512*t465+512*t467)*t102+(-t331*s2l1+(-256.D0
     #/3.D0*t334*t489-256.D0/3.D0*t334*t290*s4l1p*t8)*s34r+256.D0/3.D0*t
     #345*t475+256.D0/3.D0*t349*t500)*s23r-t362*s2l1+256.D0/3.D0*t365*t2
     #64+256.D0/3.D0*t370*t510-256.D0/3.D0*t375*t28)*s1vr+(-t386*s2l1+(-
     #256*t185*t489-512*t390*t152)*s34r+256*t74*t12+256*t74*t58)*t102+(-
     #t410*s2l1+(-256*t364*t123*s3l1p-512*t364*t31)*t119+(-256.D0/3.D0*t
     #421*t136-256.D0/3.D0*t425*t152)*s34r-256.D0/3.D0*t432*t28-256.D0/3
     #.D0*t407*t58)*s23r-t446*s2l1-256.D0/3.D0*t448*t123*s3l1p*t119+(256
     #.D0/3.D0*t21*t136+256.D0/3.D0*t147)*s34r)*s1l2
      s1 = s3+(-256.D0/3.D0*t291*t10+256.D0/3.D0*t291*t13)*t292+(((2560.
     #D0/3.D0*t296+t299)*s2l1+(-2560.D0/3.D0*t465-t468)*s2l2+512*t574-51
     #2*t576)*s23r+(256.D0/3.D0*t306+256.D0/3.D0*t581*t310)*s2l1+(-256.D
     #0/3.D0*t473-256.D0/3.D0*t581*t475)*s2l2-256.D0/3.D0*t74*t187+256.D
     #0/3.D0*t74*t190)*t177+((-256*t574+256*t576)*t102+((-256.D0/3.D0*t6
     #01*t42-256.D0/3.D0*t604*t310-256.D0/3.D0*t608*t351)*s2l1+(256.D0/3
     #.D0*t601*t53+256.D0/3.D0*t604*t475+256.D0/3.D0*t608*t500)*s2l2+(25
     #6.D0/3.D0*t621*t187-256.D0/3.D0*t621*t190)*s34r-256.D0/3.D0*t630*t
     #187+256.D0/3.D0*t630*t190)*s23r+((-256.D0/3.D0*t639*t76-256.D0/3.D
     #0*t99)*s34r-256.D0/3.D0*t646*t19)*s2l1+((256.D0/3.D0*t639*t136+256
     #.D0/3.D0*t153)*s34r+256.D0/3.D0*t646*t28)*s2l2+(-256.D0/3.D0*t660*
     #t187+256.D0/3.D0*t660*t190)*s34r-256.D0/3.D0*t667*t187+256.D0/3.D0
     #*t667*t190)*s1vr
      taux16 = s1+(-256*t187*t117+256*t117*t190)*t102+((256.D0/3.D0*t681
     #*t372-256.D0/3.D0*t683*t684*s3l2p+256.D0/3.D0*t666*t4*s4l2p*t8)*s2
     #l1+(-256.D0/3.D0*t681*t510+256.D0/3.D0*t683*t684*s3l1p-256.D0/3.D0
     #*t666*t4*s4l1p*t8)*s2l2+(256.D0/3.D0*t704*t350*t12-256.D0/3.D0*t70
     #4*t499*t9)*s34r+256.D0/3.D0*t713*t187-256.D0/3.D0*t713*t190)*s23r+
     #(512.D0/3.D0*t110*t248+(-256.D0/3.D0*t724*t19-256.D0/3.D0*t667*t98
     #)*s34r-256.D0/3.D0*t730*s3l2p)*s2l1+(-512.D0/3.D0*t110*t264+(256.D
     #0/3.D0*t724*t28+256.D0/3.D0*t667*t152)*s34r+256.D0/3.D0*t730*s3l1p
     #)*s2l2+(256.D0/3.D0*t746*t5*s4l2p*t12-256.D0/3.D0*t746*t5*s4l1p*t9
     #)*s34r+256.D0/3.D0*t3*s4l2p*t12-256.D0/3.D0*t3*s4l1p*t9

CCC Coefficients

      tcoff29 = taux15
      tcoff30 = taux15
      tcoff31 = taux16
      tcoff32 = taux16

CCC Jet functions

      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet29 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff29)
      t2 = 1-l3
      t3 = 1-z
      t5 = t2*t3*s13r
      t6 = l3*t3
      t7 = t6*s23r
      t8 = t6*s1vr
      t11 = t3**2
      t13 = l3*t2*t11*s34r
      tFjet30 = Fjet(var,ndim,z,1/ux,t5,t7,-1-t5-t8+z,t8-t7-t13,t13,t8,-
     #1+z-t8+t13,-t5-t7-t13+z,1+t5+t7,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff30)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet31 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff31)
      t2 = 1-l3
      t3 = 1-z
      t5 = t2*t3*s13r
      t6 = l3*t3
      t7 = t6*s23r
      t8 = t6*s1vr
      t11 = t3**2
      t13 = l3*t2*t11*s34r
      tFjet32 = Fjet(var,ndim,z,1/ux,t5,t7,-1-t5-t8+z,t8-t7-t13,t13,t8,-
     #1+z-t8+t13,-t5-t7-t13+z,1+t5+t7,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff32)

CCC Sum

      qgrmnum9e1 = tFjet29*tcoff29+tFjet30*tcoff30+tFjet31*tcoff31+tFjet
     #32*tcoff32
      RETURN
      END

      double precision function qgrmnum9e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3*z
      t2 = -1+z
      t3 = t2**2
      t5 = l3-1
      t6 = t5**2
      t7 = 1/s3vr
      t8 = t6*t7
      t12 = t3*t6
      t13 = t7*s3l2p
      t15 = t7*s4l2p
      t20 = t7*s3l1p
      t22 = t7*s4l1p
      t27 = t3*t2
      t29 = t6*t5
      t35 = s13r**2
      t37 = t3*t5
      t38 = t37*l3
      t42 = l3*t27*t6
      t43 = t15*s34r
      t44 = t42*t43
      t50 = t22*s34r
      t51 = t42*t50
      t55 = t5*z
      t57 = l3**2
      t58 = t57*l3
      t59 = t58*t7
      t60 = s1vr**2
      t61 = t60*s1vr
      t71 = t6*z
      t72 = t3**2
      t80 = t3*t57
      t93 = t13*s2l1
      t96 = t20*s2l2
      t99 = t72*t2
      t102 = s34r**2
      t103 = t59*t102
      t105 = 128.D0/3.D0*z*t99*t29*t103
      t106 = z+1
      t110 = t27*t57
      t111 = t7*s34r
      t112 = t110*t111
      t115 = 4*z
      t125 = t7*l3
      t166 = t72*t3
      t168 = t6**2
      t170 = t102*s34r
      t178 = t7*t102
      t182 = z**2
      t188 = t15*s3l1p
      t191 = t22*s3l2p
      s1 = (-64.D0/3.D0*t38*t15*s1vr+64.D0/3.D0*t44)*s1l1+(-64.D0/3.D0*t
     #38*t22*s1vr+64.D0/3.D0*t51)*s1l2+128.D0/3.D0*t55*t27*t59*t61+(-128
     #.D0/3.D0*z*t58*t27*t5*t7*s23r-128.D0/3.D0*t71*t72*t59*s34r+64.D0/3
     #.D0*(-4+z)*z*t5*t80*t7)*t60+(-64.D0/3.D0*(3+z)*z*t5*t80*t7*s23r+64
     #.D0/3.D0*t38*t93+64.D0/3.D0*t38*t96-t105-128.D0/3.D0*t106*z*t6*t11
     #2-64.D0/3.D0*(-5+t115)*z*l3*t2*t5*t7)*s1vr+((64.D0/3.D0*t37*t125*s
     #3l2p+64.D0/3.D0*t37*l3*s4l2p*t7)*s2l1+(64.D0/3.D0*t37*t125*s3l1p+6
     #4.D0/3.D0*t37*l3*s4l1p*t7)*s2l2+t105+64.D0/3.D0*(8+z)*z*t6*t112-64
     #*t1*t37*t7)*s23r+(64.D0/3.D0*t44+128.D0/3.D0*t37*t13+64.D0/3.D0*t3
     #7*t15)*s2l1
      t198 = s1+(64.D0/3.D0*t51+128.D0/3.D0*t37*t20+64.D0/3.D0*t37*t22)*
     #s2l2+128.D0/3.D0*z*t166*t168*t59*t170+64.D0/3.D0*(z+6)*z*t57*t72*t
     #29*t178+256.D0/3.D0*t182*l3*t3*t8*s34r+64.D0/3.D0*t37*t188+64.D0/3
     #.D0*t37*t191+128.D0/3.D0*t37*s4l2p*s4l1p*t7
      t201 = t5*t57*t3
      t206 = t6*t27
      t207 = t57*t7
      t216 = t201*t111*s2l2
      t217 = t110*t5
      t219 = t217*t13*s34r
      t223 = l3*t3
      t228 = t206*t57
      t233 = t6*t72*t57
      t235 = t233*t13*t102
      t244 = t201*t111*s2l1
      t246 = t217*t20*s34r
      t258 = t233*t20*t102
      t264 = z*t27
      t265 = t57**2
      t266 = t265*t7
      t272 = t55*t72*t266*s34r
      t276 = s23r**2
      t281 = 3*z
      t282 = -6+t281
      t285 = t58*t3*t7
      t292 = t71*t99*t266*t102
      t298 = t27*t58*t111
      t315 = 9*z
      t329 = 128.D0/3.D0*t219
      t331 = 64.D0/3.D0*t223*t13
      t334 = 128.D0/3.D0*t246
      t336 = 64.D0/3.D0*t223*t20
      t354 = t80*t111
      t387 = (-3+t115)*t2
      t394 = t3*t7
      t420 = t27*t5*l3
      s2 = (64*t1*t3*t8*s1vr+(-64.D0/3.D0*t12*t13-64.D0/3.D0*t12*t15)*s2
     #l1+(-64.D0/3.D0*t12*t20-64.D0/3.D0*t12*t22)*s2l2-64*t1*t27*t29*t7*
     #s34r)*t35+t198*s13r+((128.D0/3.D0*t201*t111*s1vr-128.D0/3.D0*t201*
     #t111*s23r-128.D0/3.D0*t206*t207*t102)*s1l2+(64.D0/3.D0*t80*t15*s23
     #r+64.D0/3.D0*t216-64.D0/3.D0*t219)*s1vr+(-64.D0/3.D0*t216+64.D0/3.
     #D0*t219+64.D0/3.D0*t223*t15)*s23r-64.D0/3.D0*t228*t178*s2l2+64.D0/
     #3.D0*t235-64.D0/3.D0*t38*t43)*s1l1+((64.D0/3.D0*t80*t22*s23r+64.D0
     #/3.D0*t244-64.D0/3.D0*t246)*s1vr+(-64.D0/3.D0*t244+64.D0/3.D0*t246
     #+64.D0/3.D0*t223*t22)*s23r-64.D0/3.D0*t228*t178*s2l1+64.D0/3.D0*t2
     #58-64.D0/3.D0*t38*t50)*s1l2
      s1 = s2+(-128.D0/3.D0*t264*t266*s23r-256.D0/3.D0*t272)*t61+(128.D0
     #/3.D0*t264*t266*t276+(512.D0/3.D0*t272-64.D0/3.D0*t282*z*t285)*s23
     #r+512.D0/3.D0*t292-64.D0/3.D0*(-6+t115)*z*t5*t298)*t60+((-128.D0/3
     #.D0*t272+64.D0/3.D0*(t281-2)*z*t285)*t276+(-64.D0/3.D0*t80*t93-64.
     #D0/3.D0*t80*t96-128*t292+64.D0/3.D0*(-8+t315)*z*t5*t298+64.D0/3.D0
     #*(-7+t315-t182)*z*t2*t57*t7)*s23r+(-t329-t331)*s2l1+(-t334-t336)*s
     #2l2-256.D0/3.D0*z*t29*t166*t266*t170+512.D0/3.D0*t2*z*t6*t72*t58*t
     #178-64.D0/3.D0*(8-t281)*z*t5*t354-64.D0/3.D0*t223*t188-64.D0/3.D0*
     #t223*t191)*s1vr+(-128.D0/3.D0*t106*z*t5*t298+64.D0/3.D0*t182*t3*t2
     #07)*t276
      taux15 = s1+((t329-t331)*s2l1+(t334-t336)*s2l2-128*t182*t6*t72*t10
     #3+64.D0/3.D0*(6-6*z+t182)*z*t5*t354+64.D0/3.D0*t387*t1*t7)*s23r+(1
     #28.D0/3.D0*t235-64.D0/3.D0*t394*s3l2p)*s2l1+(128.D0/3.D0*t258-64.D
     #0/3.D0*t394*s3l1p)*s2l2-128.D0/3.D0*(-1+2*z)*z*t99*t29*t58*t7*t170
     #-64.D0/3.D0*t282*z*t6*t110*t178+(64.D0/3.D0*t420*t188+64.D0/3.D0*t
     #420*t191-64.D0/3.D0*t387*z*l3*t5*t7)*s34r-64.D0/3.D0*t3*s4l2p*t20-
     #64.D0/3.D0*t3*s4l1p*t13
      t1 = -1+z
      t2 = t1**2
      t3 = l3-1
      t4 = t3**2
      t5 = t4*t2
      t6 = 1/s3vr
      t7 = t6*s3l2p
      t9 = s4l2p*t6
      t14 = t6*s3l1p
      t16 = s4l1p*t6
      t22 = s13r**2
      t24 = -t3
      t25 = t24*t2
      t26 = l3**2
      t27 = t25*t26
      t28 = t6*s2l2
      t29 = s1vr**2
      t33 = t3*t2
      t34 = t33*t26
      t38 = t2*t1
      t39 = t38*t4
      t40 = t26*t6
      t41 = t40*s34r
      t43 = l3*t1
      t44 = t3*t6
      t47 = -512.D0/3.D0*t39*t41-512.D0/3.D0*t43*t44
      t49 = l3*t6
      t50 = t49*s3l2p
      t51 = t33*t50
      t54 = l3*s4l2p*t6
      t55 = t33*t54
      t59 = t39*t26
      t60 = t6*s34r
      t61 = t60*s2l2
      t68 = t2**2
      t69 = t26*t68
      t70 = t4*t3
      t72 = s34r**2
      t76 = t4*t6
      t80 = 256.D0/3.D0*t69*t70*t6*t72+256.D0/3.D0*l3*t2*t76*s34r
      t83 = l3*t38
      t85 = t4*s4l2p*t6
      t92 = t6*s2l1
      t101 = t49*s3l1p
      t102 = t33*t101
      t105 = l3*s4l1p*t6
      t106 = t33*t105
      t110 = t60*s2l1
      t121 = t4*s4l1p*t6
      t128 = t26*t38
      t129 = t44*s3l2p
      t130 = t128*t129
      t133 = t3*s4l2p*t6
      t134 = t128*t133
      t138 = t44*s3l1p
      t139 = t128*t138
      t142 = t3*s4l1p*t6
      t143 = t128*t142
      t147 = t24*t68
      t148 = t147*t26
      t149 = t9*s3l1p
      t152 = t16*s3l2p
      t163 = t3*t68
      t164 = t163*t26
      t171 = t4*t68
      t172 = t40*s3l2p
      t175 = t26*s4l2p
      t176 = t175*t6
      t181 = -3+z
      t183 = t181*t2*t3
      t184 = t183*t50
      t186 = l3*z
      t187 = t186*t2
      t188 = t187*t133
      t192 = t40*s3l1p
      t195 = t26*s4l1p
      t196 = t195*t6
      t201 = t183*t101
      t203 = t187*t142
      t207 = t68*t1
      t209 = t207*t4*t26
      t212 = -t209*t149+t209*t152
      t215 = t38*t3
      t216 = t215*l3
      t218 = 256.D0/3.D0*t216*t149
      t220 = 256.D0/3.D0*t216*t152
      t223 = t171*t26
      t224 = t7*s34r
      t230 = t14*s34r
      t240 = t70*t207
      t241 = t240*t26
      t242 = t7*t72
      t245 = z*t4
      t246 = t245*t38
      t248 = -z-3
      t250 = t248*l3*t38
      t257 = (2-4*z)*t1
      t260 = 3*z
      t262 = (1-t260)*t1
      t267 = t14*t72
      t281 = t68*t2
      t283 = t281*t70*t26
      t290 = l3*t4*t68
      s2 = (-256.D0/3.D0*t27*t28*t29+(256.D0/3.D0*t34*t28*s23r+t47*s2l2+
     #256.D0/3.D0*t51+256.D0/3.D0*t55)*s1vr+(256.D0/3.D0*t59*t61-512.D0/
     #3.D0*t51-512.D0/3.D0*t55)*s23r+t80*s2l2+(-256.D0/3.D0*t39*t50-256.
     #D0/3.D0*t83*t85)*s34r)*s1l1+(256.D0/3.D0*t27*t92*t29+(-256.D0/3.D0
     #*t34*t92*s23r-t47*s2l1-256.D0/3.D0*t102-256.D0/3.D0*t106)*s1vr+(-2
     #56.D0/3.D0*t59*t110+512.D0/3.D0*t102+512.D0/3.D0*t106)*s23r-t80*s2
     #l1+(256.D0/3.D0*t39*t101+256.D0/3.D0*t83*t121)*s34r)*s1l2
      s1 = s2+((1024.D0/3.D0*t130+512.D0/3.D0*t134)*s2l1+(-1024.D0/3.D0*
     #t139-512.D0/3.D0*t143)*s2l2-256.D0/3.D0*t148*t149+256.D0/3.D0*t148
     #*t152)*t29+(((512.D0/3.D0*t130+512.D0/3.D0*t134)*s2l1+(-512.D0/3.D
     #0*t139-512.D0/3.D0*t143)*s2l2+256.D0/3.D0*t164*t149-256.D0/3.D0*t1
     #64*t152)*s23r+((-1792.D0/3.D0*t171*t172-512.D0/3.D0*t171*t176)*s34
     #r+256.D0/3.D0*t184+256.D0/3.D0*t188)*s2l1+((1792.D0/3.D0*t171*t192
     #+512.D0/3.D0*t171*t196)*s34r-256.D0/3.D0*t201-256.D0/3.D0*t203)*s2
     #l2+512.D0/3.D0*t212*s34r+t218-t220)*s1vr+((256.D0/3.D0*t223*t224+2
     #56.D0/3.D0*t184+256.D0/3.D0*t183*t54)*s2l1+(-256.D0/3.D0*t223*t230
     #-256.D0/3.D0*t201-256.D0/3.D0*t183*t105)*s2l2+256.D0/3.D0*t212*s34
     #r-t218+t220)*s23r
      t300 = s1+(256*t241*t242+(-256.D0/3.D0*t246*t50+256.D0/3.D0*t250*t
     #85)*s34r+256.D0/3.D0*t257*t129+256.D0/3.D0*t262*t133)*s2l1+(-256*t
     #241*t267+(256.D0/3.D0*t246*t101-256.D0/3.D0*t250*t121)*s34r-256.D0
     #/3.D0*t257*t138-256.D0/3.D0*t262*t142)*s2l2+(256.D0/3.D0*t283*t149
     #-256.D0/3.D0*t283*t152)*t72+(-256.D0/3.D0*t290*t149+256.D0/3.D0*t2
     #90*t152)*s34r-256.D0/3.D0*t25*t149+256.D0/3.D0*t25*t152
      t302 = t26*l3
      t303 = t302*t2
      t305 = 256.D0/3.D0*t303*t28
      t306 = t38*t302
      t307 = t306*t7
      t308 = 512.D0/3.D0*t307
      t309 = t306*t9
      t310 = 512.D0/3.D0*t309
      t313 = t215*t302
      t316 = t163*t302
      t319 = z+1
      t320 = t319*t26
      t321 = t2*t6
      t322 = t321*s3l2p
      t328 = s23r**2
      t330 = 3*t3
      t332 = t302*t6
      t333 = t332*s34r
      t339 = -256.D0/3.D0*t330*t38*t333+256.D0/3.D0*(2-z)*t1*t40
      t342 = 2*t3*t68
      t343 = t332*s3l2p
      t346 = 4*t3*t68
      t348 = t302*s4l2p*t6
      t353 = 2*z
      t354 = -3+t353
      t355 = t354*t2
      t359 = 256.D0/3.D0*t128*t9
      t364 = 512.D0/3.D0*t171*t332*t72
      t370 = -t364-256.D0/3.D0*t248*t3*t26*t321*s34r
      t372 = t302*t207
      t373 = t372*t4
      t378 = 2*t1*t26*t38
      t383 = t319*t1
      t392 = 256.D0/3.D0*t215*t333-256.D0/3.D0*t2*t26*t6
      t395 = 256.D0/3.D0*t163*t343
      t396 = t302*t68
      t402 = 256.D0/3.D0*t128*t7
      t413 = t364-512.D0/3.D0*t319*t3*t2*t41+256.D0/3.D0*t43*t6
      t418 = -4+t353
      t420 = t418*t26*t38
      t423 = t38*z*t3
      t428 = -1+t353
      t429 = t428*t1
      t436 = t72*s34r
      t447 = 256.D0/3.D0*t240*t332*t436+256.D0/3.D0*(-2-z)*t4*t38*t40*t7
     #2-256.D0/3.D0*t33*t49*s34r
      t450 = t302*t70*t281
      t455 = t181*t26*t68
      t470 = 256.D0/3.D0*t303*t92
      t471 = t306*t14
      t472 = 512.D0/3.D0*t471
      t473 = t306*t16
      t474 = 512.D0/3.D0*t473
      t481 = t321*s3l1p
      t490 = t332*s3l1p
      t493 = t302*s4l1p*t6
      t501 = 256.D0/3.D0*t128*t16
      t519 = 256.D0/3.D0*t163*t490
      t525 = 256.D0/3.D0*t128*t14
      t559 = t396*t149
      t560 = t396*t152
      t561 = -t559+t560
      t578 = 512.D0/3.D0*t147*t348
      t584 = 512.D0/3.D0*t147*t493
      t590 = t3*t302*t207
      t593 = t590*t149-t590*t152
      t598 = -t418*t26*t38
      t609 = -t330*t68
      t616 = (9*z-10)*t2
      t619 = t260-2
      t620 = t619*t2
      t637 = t69*t149
      t639 = t69*t152
      t643 = t76*s3l2p
      t652 = (t353-10)*t26*t38
      t656 = -t354*t26*t38
      t661 = z**2
      t663 = (-t661-z)*t1
      t668 = t76*s3l1p
      t685 = t302*t4*t281
      t694 = -4*t1*t3*t68
      t695 = t175*t14
      t697 = t195*t7
      t704 = 3*l3*t1*t2
      t716 = (-7+t260)*t26*t38
      t718 = -t428
      t720 = t718*t3*t38
      t726 = (t260-4)*l3
      t749 = t207*t3*t26
      t763 = (-7+z)*t26*t68
      t766 = t718*t4*t68
      t773 = (2-t353+t661)*t3*t2
      t797 = t245*t207
      t804 = t619*l3*t3
      s2 = ((256.D0/3.D0*t5*t7+256.D0/3.D0*t5*t9)*s2l1+(-256.D0/3.D0*t5*
     #t14-256.D0/3.D0*t5*t16)*s2l2)*t22+t300*s13r+(((-t305-t308-t310)*s2
     #3r+256.D0/3.D0*t313*t61+256.D0/3.D0*t316*t224+256.D0/3.D0*t320*t32
     #2)*t29+((-t305+t308+t310)*t328+(t339*s2l2+(256.D0/3.D0*t342*t343+2
     #56.D0/3.D0*t346*t348)*s34r-256.D0/3.D0*t355*t172-t359)*s23r+t370*s
     #2l2-512.D0/3.D0*t373*t242-256.D0/3.D0*t378*t44*s3l2p*s34r-256.D0/3
     #.D0*t383*t50)*s1vr+(t392*s2l2+(-t395-512.D0/3.D0*t396*t133)*s34r+t
     #402+t359)*t328+(t413*s2l2-512.D0/3.D0*t373*t9*t72+(256.D0/3.D0*t42
     #0*t129+256.D0/3.D0*t423*t176)*s34r+256.D0/3.D0*t429*t50+256.D0/3.D
     #0*t43*t9)*s23r+t447*s2l2+256.D0/3.D0*t450*t7*t436+256.D0/3.D0*t455
     #*t76*s3l2p*t72+(256.D0/3.D0*l3*t3*t38*t6*s3l2p-256.D0/3.D0*t55)*s3
     #4r)*s1l1
      s3 = s2+(((t470+t472+t474)*s23r-256.D0/3.D0*t313*t110-256.D0/3.D0*
     #t316*t230-256.D0/3.D0*t320*t481)*t29+((t470-t472-t474)*t328+(-t339
     #*s2l1+(-256.D0/3.D0*t342*t490-256.D0/3.D0*t346*t493)*s34r+256.D0/3
     #.D0*t355*t192+t501)*s23r-t370*s2l1+512.D0/3.D0*t373*t267+256.D0/3.
     #D0*t378*t44*s3l1p*s34r+256.D0/3.D0*t383*t101)*s1vr+(-t392*s2l1+(t5
     #19+512.D0/3.D0*t396*t142)*s34r-t525-t501)*t328+(-t413*s2l1+512.D0/
     #3.D0*t373*t16*t72+(-256.D0/3.D0*t420*t138-256.D0/3.D0*t423*t196)*s
     #34r-256.D0/3.D0*t429*t101-256.D0/3.D0*t43*t16)*s23r-t447*s2l1-256.
     #D0/3.D0*t450*t14*t436-256.D0/3.D0*t455*t76*s3l1p*t72+(-256.D0/3.D0
     #*t83*t138+256.D0/3.D0*t106)*s34r)*s1l2
      s4 = s3+512.D0/3.D0*t561*t29*s1vr
      s5 = s4
      s7 = (((-512*t307-1024.D0/3.D0*t309)*s2l1+(512*t471+1024.D0/3.D0*t
     #473)*s2l2-256.D0/3.D0*t559+256.D0/3.D0*t560)*s23r+((-t395+t578)*s3
     #4r+t402)*s2l1+((t519-t584)*s34r-t525)*s2l2+1024.D0/3.D0*t593*s34r+
     #256.D0/3.D0*t598*t149-256.D0/3.D0*t598*t152)*t29
      s8 = (-256.D0/3.D0*t561*t328+(((-256.D0/3.D0*t609*t343-t578)*s34r-
     #256.D0/3.D0*t616*t172-512.D0/3.D0*t620*t176)*s2l1+((256.D0/3.D0*t6
     #09*t490+t584)*s34r+256.D0/3.D0*t616*t192+512.D0/3.D0*t620*t196)*s2
     #l2+256.D0/3.D0*t593*s34r-256.D0/3.D0*t637+256.D0/3.D0*t639)*s23r+(
     #(256.D0/3.D0*t372*t643+512.D0/3.D0*t372*t85)*t72+(-256.D0/3.D0*t65
     #2*t129+256.D0/3.D0*t656*t133)*s34r-256.D0/3.D0*t663*t50)*s2l1+((-2
     #56.D0/3.D0*t372*t668-512.D0/3.D0*t372*t121)*t72+(256.D0/3.D0*t652*
     #t138-256.D0/3.D0*t656*t142)*s34r+256.D0/3.D0*t663*t101)*s2l2+(-512
     #.D0/3.D0*t685*t149+512.D0/3.D0*t685*t152)*t72+(-256.D0/3.D0*t694*t
     #695+256.D0/3.D0*t694*t697)*s34r+256.D0/3.D0*t704*t149-256.D0/3.D0*
     #t704*t152)*s1vr
      s6 = s7+s8
      s1 = s5+s6
      taux16 = s1+(256.D0/3.D0*t637-256.D0/3.D0*t639)*t328+(((256.D0/3.D
     #0*t716*t129-256.D0/3.D0*t720*t176)*s34r-256.D0/3.D0*t726*t322-512.
     #D0/3.D0*t186*t2*s4l2p*t6)*s2l1+((-256.D0/3.D0*t716*t138+256.D0/3.D
     #0*t720*t196)*s34r+256.D0/3.D0*t726*t481+512.D0/3.D0*t186*t2*s4l1p*
     #t6)*s2l2+(256.D0/3.D0*t749*t149-256.D0/3.D0*t749*t152)*s34r-256.D0
     #/3.D0*t187*t149+256.D0/3.D0*t187*t152)*s23r+((256.D0/3.D0*t763*t64
     #3-256.D0/3.D0*t766*t176)*t72+(-256.D0/3.D0*t773*t50+512.D0/3.D0*t1
     #88)*s34r-256.D0/3.D0*t262*t7)*s2l1+((-256.D0/3.D0*t763*t668+256.D0
     #/3.D0*t766*t196)*t72+(256.D0/3.D0*t773*t101-512.D0/3.D0*t203)*s34r
     #+256.D0/3.D0*t262*t14)*s2l2+(-512.D0/3.D0*t797*t695+512.D0/3.D0*t7
     #97*t697)*t72+(-256.D0/3.D0*t804*t38*s4l2p*t14+256.D0/3.D0*t804*t38
     #*s4l1p*t7)*s34r+256.D0/3.D0*t262*t149-256.D0/3.D0*t262*t152

CCC Coefficients

      tcoff29 = taux15
      tcoff30 = taux15
      tcoff31 = taux16
      tcoff32 = taux16

CCC Jet functions

      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet29 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff29)
      t2 = 1-l3
      t3 = 1-z
      t5 = t2*t3*s13r
      t6 = l3*t3
      t7 = t6*s23r
      t8 = t6*s1vr
      t11 = t3**2
      t13 = l3*t2*t11*s34r
      tFjet30 = Fjet(var,ndim,z,1/ux,t5,t7,-1-t5-t8+z,t8-t7-t13,t13,t8,-
     #1+z-t8+t13,-t5-t7-t13+z,1+t5+t7,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff30)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet31 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff31)
      t2 = 1-l3
      t3 = 1-z
      t5 = t2*t3*s13r
      t6 = l3*t3
      t7 = t6*s23r
      t8 = t6*s1vr
      t11 = t3**2
      t13 = l3*t2*t11*s34r
      tFjet32 = Fjet(var,ndim,z,1/ux,t5,t7,-1-t5-t8+z,t8-t7-t13,t13,t8,-
     #1+z-t8+t13,-t5-t7-t13+z,1+t5+t7,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff32)

CCC Sum

      qgrmnum9e2 = tFjet29*tcoff29+tFjet30*tcoff30+tFjet31*tcoff31+tFjet
     #32*tcoff32
      RETURN
      END

      double precision function qgrmnum9e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3*z
      t2 = -1+z
      t3 = t2**2
      t4 = t1*t3
      t5 = l3-1
      t6 = t5**2
      t7 = 1/s3vr
      t8 = t6*t7
      t11 = t3*t2
      t14 = t6*t5*t7
      t19 = s13r**2
      t22 = z*t5*t3
      t23 = l3**2
      t24 = t23*t7
      t28 = t6*z
      t29 = t28*t11
      t30 = t24*s34r
      t31 = t29*t30
      t36 = 64.D0/3.D0*t1*t3*t5*t7
      t43 = t3**2
      t45 = s34r**2
      t49 = z**2
      t57 = t23*l3
      t58 = z*t57
      t59 = t3*t7
      t60 = s23r**2
      t66 = t5*t7*s34r
      t68 = 128.D0/3.D0*t58*t11*t66
      t71 = 64.D0/3.D0*t3*z*t24
      t74 = t22*t30
      taux15 = (64.D0/3.D0*t4*t8*s1vr-64.D0/3.D0*t1*t11*t14*s34r)*t19+((
     #-128.D0/3.D0*t22*t24*s23r-128.D0/3.D0*t31-t36)*s1vr+(64*t31-t36)*s
     #23r+128.D0/3.D0*z*t23*t43*t14*t45+64.D0/3.D0*t49*l3*t3*t8*s34r)*s1
     #3r+(64.D0/3.D0*t58*t59*t60+(t68+t71)*s23r-128.D0/3.D0*t74)*s1vr+(-
     #t68+t71)*t60+(-128.D0/3.D0*t28*t43*t57*t7*t45+64.D0/3.D0*t74+64.D0
     #/3.D0*t1*t59)*s23r+128.D0/3.D0*t29*t24*t45-64.D0/3.D0*t66*t4
      t1 = -1+z
      t2 = t1**2
      t3 = l3-1
      t4 = t3**2
      t5 = t2*t4
      t6 = 1/s3vr
      t7 = t6*s3l2p
      t9 = s4l2p*t6
      t14 = t6*s3l1p
      t16 = s4l1p*t6
      t22 = s13r**2
      t24 = t3*t2
      t25 = l3**2
      t26 = t24*t25
      t27 = t6*s2l2
      t28 = s1vr**2
      t34 = l3*t6
      t35 = t34*s3l2p
      t36 = t24*t35
      t38 = l3*s4l2p*t6
      t39 = t24*t38
      t43 = t2*t1
      t44 = t4*t43
      t45 = t44*t25
      t46 = t6*s34r
      t47 = t46*s2l2
      t54 = t2**2
      t55 = t25*t54
      t56 = t4*t3
      t58 = s34r**2
      t61 = l3*t2
      t62 = t4*t6
      t66 = 512.D0/3.D0*t55*t56*t6*t58+512.D0/3.D0*t61*t62*s34r
      t69 = l3*t43
      t71 = t4*s4l2p*t6
      t78 = t6*s2l1
      t84 = t34*s3l1p
      t85 = t24*t84
      t87 = l3*s4l1p*t6
      t88 = t24*t87
      t92 = t46*s2l1
      t103 = t4*s4l1p*t6
      t110 = t25*t43
      t111 = t3*t6
      t112 = t111*s3l2p
      t115 = t3*s4l2p*t6
      t118 = -1024.D0/3.D0*t110*t112-1024.D0/3.D0*t110*t115
      t120 = t111*s3l1p
      t123 = t3*s4l1p*t6
      t126 = 1024.D0/3.D0*t110*t120+1024.D0/3.D0*t110*t123
      t128 = t3*t54
      t129 = t128*t25
      t130 = t9*s3l1p
      t132 = 512.D0/3.D0*t129*t130
      t133 = t16*s3l2p
      t135 = 512.D0/3.D0*t129*t133
      t144 = t4*t54
      t145 = t25*t6
      t146 = t145*s3l2p
      t149 = t25*s4l2p
      t150 = t149*t6
      t155 = 2*z
      t158 = (9-t155)*t2*t3
      t163 = (z-2)*t3*t2
      t168 = t145*s3l1p
      t171 = t25*s4l1p
      t172 = t171*t6
      t183 = t54*t1
      t185 = t183*t4*t25
      t188 = t185*t130-t185*t133
      t191 = t43*t3
      t192 = t191*l3
      t194 = 512.D0/3.D0*t192*t130
      t196 = 512.D0/3.D0*t192*t133
      t199 = t144*t25
      t200 = t7*s34r
      t203 = t155+1
      t205 = t203*t2*t3
      t212 = t14*s34r
      t226 = t56*t183
      t227 = t226*t25
      t228 = t7*t58
      t231 = z*t4
      t232 = t231*t43
      t236 = t203*l3*t43
      t242 = 10*t1**2
      t246 = 5*t1**2
      t251 = t14*t58
      t266 = t54*t2
      t268 = t266*t56*t25
      t275 = l3*t4*t54
      t282 = 5*t3*t2
      s2 = (-512.D0/3.D0*t26*t27*t28+(512.D0/3.D0*t26*t27*s23r+512.D0/3.
     #D0*t36+512.D0/3.D0*t39)*s1vr+(512.D0/3.D0*t45*t47-1024.D0/3.D0*t36
     #-1024.D0/3.D0*t39)*s23r+t66*s2l2+(-512.D0/3.D0*t44*t35-512.D0/3.D0
     #*t69*t71)*s34r)*s1l1+(512.D0/3.D0*t26*t78*t28+(-512.D0/3.D0*t26*t7
     #8*s23r-512.D0/3.D0*t85-512.D0/3.D0*t88)*s1vr+(-512.D0/3.D0*t45*t92
     #+1024.D0/3.D0*t85+1024.D0/3.D0*t88)*s23r-t66*s2l1+(512.D0/3.D0*t44
     #*t84+512.D0/3.D0*t69*t103)*s34r)*s1l2
      s1 = s2+(t118*s2l1+t126*s2l2-t132+t135)*t28+((-t118*s2l1-t126*s2l2
     #+t132-t135)*s23r+((512.D0/3.D0*t144*t146+1024.D0/3.D0*t144*t150)*s
     #34r+256.D0/3.D0*t158*t35-512.D0/3.D0*t163*t38)*s2l1+((-512.D0/3.D0
     #*t144*t168-1024.D0/3.D0*t144*t172)*s34r-256.D0/3.D0*t158*t84+512.D
     #0/3.D0*t163*t87)*s2l2+1024.D0/3.D0*t188*s34r+t194-t196)*s1vr+((512
     #.D0/3.D0*t199*t200+256.D0/3.D0*t205*t35+256.D0/3.D0*t205*t38)*s2l1
     #+(-512.D0/3.D0*t199*t212-256.D0/3.D0*t205*t84-256.D0/3.D0*t205*t87
     #)*s2l2-512.D0/3.D0*t188*s34r-t194+t196)*s23r
      t287 = s1+(512.D0/3.D0*t227*t228+(512.D0/3.D0*t232*t35+256.D0/3.D0
     #*t236*t71)*s34r+256.D0/3.D0*t242*t112+256.D0/3.D0*t246*t115)*s2l1+
     #(-512.D0/3.D0*t227*t251+(-512.D0/3.D0*t232*t84-256.D0/3.D0*t236*t1
     #03)*s34r-256.D0/3.D0*t242*t120-256.D0/3.D0*t246*t123)*s2l2+(-512.D
     #0/3.D0*t268*t130+512.D0/3.D0*t268*t133)*t58+(-512.D0/3.D0*t275*t13
     #0+512.D0/3.D0*t275*t133)*s34r-256.D0/3.D0*t282*t130+256.D0/3.D0*t2
     #82*t133
      t289 = t25*l3
      t290 = t43*t289
      t291 = t28*s1vr
      t295 = t289*t2
      t297 = 512.D0/3.D0*t295*t27
      t298 = t290*t7
      t301 = 1024.D0/3.D0*t290*t9
      t304 = t191*t289
      t307 = t128*t289
      t311 = (-3+z)*t25
      t312 = t2*t6
      t313 = t312*s3l2p
      t320 = s23r**2
      t322 = t289*t6
      t324 = t191*t322*s34r
      t329 = -512*t324+512.D0/3.D0*t1*z*t145
      t332 = t128*t322*s3l2p
      t334 = t289*t54
      t335 = t334*t115
      t339 = -5+t155
      t340 = t339*t2
      t344 = 512.D0/3.D0*t110*t9
      t347 = -t339
      t349 = t347*t3*t25
      t354 = t289*t183
      t355 = t354*t4
      t358 = 4*z
      t361 = (-5+t358)*t25*t43
      t362 = s3l2p*s34r
      t373 = 512.D0/3.D0*t324-512.D0/3.D0*t2*t25*t6
      t375 = 512.D0/3.D0*t332
      t376 = 1024.D0/3.D0*t335
      t378 = (-t375-t376)*s34r
      t389 = l3*t1
      t392 = 256.D0/3.D0*(3-t358)*t3*t2*t145*s34r+512.D0/3.D0*t389*t6
      t394 = t62*s3l2p
      t395 = t354*t394
      t396 = t354*t71
      t402 = (-1+t358)*t25*t43
      t406 = t43*z*t3
      t411 = -1+t155
      t412 = t411*t1
      t419 = t58*s34r
      t423 = 3-t155
      t432 = -512.D0/3.D0*t226*t322*t419+256.D0/3.D0*t423*t4*t43*t145*t5
     #8-512.D0/3.D0*t24*t34*s34r
      t435 = t289*t56*t266
      t440 = t203*t25*t54
      t458 = 512.D0/3.D0*t295*t78
      t459 = t290*t14
      t462 = 1024.D0/3.D0*t290*t16
      t469 = t312*s3l1p
      t480 = t128*t322*s3l1p
      t482 = t334*t123
      t489 = 512.D0/3.D0*t110*t16
      t498 = s3l1p*s34r
      t508 = 512.D0/3.D0*t480
      t509 = 1024.D0/3.D0*t482
      t511 = (t508+t509)*s34r
      t518 = t62*s3l1p
      t519 = t354*t518
      t520 = t354*t103
      t552 = t290*t7*s2l1
      t554 = t290*t14*s2l2
      t555 = t334*t130
      t556 = t334*t133
      t568 = 3*z
      t570 = (-5+t568)*t2
      t582 = t3*t289*t183
      t585 = -t582*t130+t582*t133
      t590 = 2*t1*t43*t25
      t602 = (-5+6*z)*t2
      t616 = 3*t1*t43*t25
      t627 = -2+t358
      t629 = t627*t25*t43
      t632 = t411*t25
      t633 = t632*t43
      t635 = 512.D0/3.D0*t633*t115
      t639 = z**2
      t642 = (-11+13*z-2*t639)*t1
      t654 = 512.D0/3.D0*t633*t123
      t662 = t289*t4*t266
      t669 = t627*t3*t54
      t670 = t149*t14
      t672 = t171*t7
      t678 = t347*l3*t2
      t690 = 4-t155
      t692 = t690*t43*t25
      t697 = t411*l3
      t712 = (-1+t568)*t3*t54
      t719 = l3*z*t2
      t727 = t690*t25*t54
      t730 = t632*t54
      t737 = (2-t155+t639)*t3*t2
      t758 = t231*t183
      t765 = t423*l3*t3
      s3 = ((-1280.D0/3.D0*t5*t7-1280.D0/3.D0*t5*t9)*s2l1+(1280.D0/3.D0*
     #t5*t14+1280.D0/3.D0*t5*t16)*s2l2)*t22
      s4 = t287*s13r+(1024.D0/3.D0*t290*t7*t291+((t297-2048.D0/3.D0*t298
     #-t301)*s23r+512.D0/3.D0*t304*t47-2560.D0/3.D0*t307*t200+512.D0/3.D
     #0*t311*t313)*t28+((-t297+1024.D0/3.D0*t298+t301)*t320+(t329*s2l2+(
     #1024*t332+2048.D0/3.D0*t335)*s34r-512.D0/3.D0*t340*t146-t344)*s23r
     #-256.D0/3.D0*t349*t312*s34r*s2l2+2048.D0/3.D0*t355*t228-256.D0/3.D
     #0*t361*t111*t362-512.D0/3.D0*t61*t7)*s1vr+(t373*s2l2+t378+512.D0/3
     #.D0*t110*t7+t344)*t320+(t392*s2l2+(-1024.D0/3.D0*t395-1024.D0/3.D0
     #*t396)*t58+(256.D0/3.D0*t402*t112+512.D0/3.D0*t406*t150)*s34r+512.
     #D0/3.D0*t412*t35+512.D0/3.D0*t389*t9)*s23r+t432*s2l2-512.D0/3.D0*t
     #435*t7*t419+256.D0/3.D0*t440*t62*s3l2p*t58+(512.D0/3.D0*l3*t3*t43*
     #t6*s3l2p-512.D0/3.D0*t39)*s34r)*s1l1
      s2 = s3+s4
      s3 = s2+(-1024.D0/3.D0*t290*t14*t291+((-t458+2048.D0/3.D0*t459+t46
     #2)*s23r-512.D0/3.D0*t304*t92+2560.D0/3.D0*t307*t212-512.D0/3.D0*t3
     #11*t469)*t28+((t458-1024.D0/3.D0*t459-t462)*t320+(-t329*s2l1+(-102
     #4*t480-2048.D0/3.D0*t482)*s34r+512.D0/3.D0*t340*t168+t489)*s23r+25
     #6.D0/3.D0*t349*t312*s34r*s2l1-2048.D0/3.D0*t355*t251+256.D0/3.D0*t
     #361*t111*t498+512.D0/3.D0*t61*t14)*s1vr+(-t373*s2l1+t511-512.D0/3.
     #D0*t110*t14-t489)*t320+(-t392*s2l1+(1024.D0/3.D0*t519+1024.D0/3.D0
     #*t520)*t58+(-256.D0/3.D0*t402*t120-512.D0/3.D0*t406*t172)*s34r-512
     #.D0/3.D0*t412*t84-512.D0/3.D0*t389*t16)*s23r-t432*s2l1+512.D0/3.D0
     #*t435*t14*t419-256.D0/3.D0*t440*t62*s3l1p*t58+(-512.D0/3.D0*t69*t1
     #20+512.D0/3.D0*t88)*s34r)*s1l2
      s4 = s3+(1024.D0/3.D0*t552-1024.D0/3.D0*t554+1024.D0/3.D0*t555-102
     #4.D0/3.D0*t556)*t291
      s1 = s4+((-1024.D0/3.D0*t552+1024.D0/3.D0*t554-512*t555+512*t556)*
     #s23r+((-t375+t376)*s34r+512.D0/3.D0*t570*t146)*s2l1+((t508-t509)*s
     #34r-512.D0/3.D0*t570*t168)*s2l2+2048.D0/3.D0*t585*s34r+512.D0/3.D0
     #*t590*t130-512.D0/3.D0*t590*t133)*t28+((512.D0/3.D0*t555-512.D0/3.
     #D0*t556)*t320+((t378-256.D0/3.D0*t602*t146)*s2l1+(t511+256.D0/3.D0
     #*t602*t168)*s2l2-512*t585*s34r-512.D0/3.D0*t616*t130+512.D0/3.D0*t
     #616*t133)*s23r+((-512.D0/3.D0*t395-1024.D0/3.D0*t396)*t58+(-256.D0
     #/3.D0*t629*t112+t635)*s34r-256.D0/3.D0*t642*t35)*s2l1+((512.D0/3.D
     #0*t519+1024.D0/3.D0*t520)*t58+(256.D0/3.D0*t629*t120-t654)*s34r+25
     #6.D0/3.D0*t642*t84)*s2l2+(1024.D0/3.D0*t662*t130-1024.D0/3.D0*t662
     #*t133)*t58+(-512.D0/3.D0*t669*t670+512.D0/3.D0*t669*t672)*s34r+256
     #.D0/3.D0*t678*t130-256.D0/3.D0*t678*t133)*s1vr
      taux16 = s1+(512.D0/3.D0*t55*t130-512.D0/3.D0*t55*t133)*t320+(((25
     #6.D0/3.D0*t692*t112-t635)*s34r-256.D0/3.D0*t697*t313)*s2l1+((-256.
     #D0/3.D0*t692*t120+t654)*s34r+256.D0/3.D0*t697*t469)*s2l2+(512.D0/3
     #.D0*t712*t670-512.D0/3.D0*t712*t672)*s34r+512.D0/3.D0*t719*t130-51
     #2.D0/3.D0*t719*t133)*s23r+((256.D0/3.D0*t727*t394-512.D0/3.D0*t730
     #*t71)*t58-512.D0/3.D0*t737*t34*t362-256.D0/3.D0*t246*t7)*s2l1+((-2
     #56.D0/3.D0*t727*t518+512.D0/3.D0*t730*t103)*t58+512.D0/3.D0*t737*t
     #34*t498+256.D0/3.D0*t246*t14)*s2l2+(1024.D0/3.D0*t758*t670-1024.D0
     #/3.D0*t758*t672)*t58+(-256.D0/3.D0*t765*t43*s4l2p*t14+256.D0/3.D0*
     #t765*t43*s4l1p*t7)*s34r+256.D0/3.D0*t246*t130-256.D0/3.D0*t246*t13
     #3

CCC Coefficients

      tcoff29 = taux15
      tcoff30 = taux15
      tcoff31 = taux16
      tcoff32 = taux16

CCC Jet functions

      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet29 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff29)
      t2 = 1-l3
      t3 = 1-z
      t5 = t2*t3*s13r
      t6 = l3*t3
      t7 = t6*s23r
      t8 = t6*s1vr
      t11 = t3**2
      t13 = l3*t2*t11*s34r
      tFjet30 = Fjet(var,ndim,z,1/ux,t5,t7,-1-t5-t8+z,t8-t7-t13,t13,t8,-
     #1+z-t8+t13,-t5-t7-t13+z,1+t5+t7,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff30)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet31 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff31)
      t2 = 1-l3
      t3 = 1-z
      t5 = t2*t3*s13r
      t6 = l3*t3
      t7 = t6*s23r
      t8 = t6*s1vr
      t11 = t3**2
      t13 = l3*t2*t11*s34r
      tFjet32 = Fjet(var,ndim,z,1/ux,t5,t7,-1-t5-t8+z,t8-t7-t13,t13,t8,-
     #1+z-t8+t13,-t5-t7-t13+z,1+t5+t7,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff32)

CCC Sum

      qgrmnum9e3 = tFjet29*tcoff29+tFjet30*tcoff30+tFjet31*tcoff31+tFjet
     #32*tcoff32
      RETURN
      END

      double precision function qgrmnum9e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux15 = 0
      t1 = -1+z
      t2 = t1**2
      t3 = l3-1
      t4 = t3**2
      t5 = t2*t4
      t6 = 1/s3vr
      t7 = t6*s3l2p
      t9 = s4l2p*t6
      t14 = t6*s3l1p
      t16 = s4l1p*t6
      t22 = s13r**2
      t24 = t3*t2
      t25 = t24*l3
      t26 = t7*s2l1
      t28 = t14*s2l2
      t33 = l3*t6
      t52 = t2*t1
      t54 = l3*t52*t4
      t58 = 2*t1**2
      t59 = t3*t6
      t74 = t9*s3l1p
      t77 = t16*s3l2p
      t82 = l3**2
      t84 = t3*t82*t2
      t85 = t6*s34r
      t89 = t82*t52*t3
      t91 = t89*t7*s34r
      t93 = -512.D0/3.D0*t84*t85*s2l2-512.D0/3.D0*t91
      t98 = t4*t52*t82
      t99 = s34r**2
      t100 = t6*t99
      t104 = t2**2
      t106 = t82*t104*t4
      t108 = t106*t7*t99
      t115 = t89*t14*s34r
      t117 = 512.D0/3.D0*t84*t85*s2l1+512.D0/3.D0*t115
      t125 = t106*t14*t99
      t129 = t2*t82
      t135 = 1024.D0/3.D0*t91
      t136 = l3*t2
      t138 = 512.D0/3.D0*t136*t7
      t141 = 1024.D0/3.D0*t115
      t143 = 512.D0/3.D0*t136*t14
      t159 = t2*t6
      t170 = t52*t3*l3
      s1 = ((-512.D0/3.D0*t5*t7-512.D0/3.D0*t5*t9)*s2l1+(512.D0/3.D0*t5*
     #t14+512.D0/3.D0*t5*t16)*s2l2)*t22+((512.D0/3.D0*t25*t26-512.D0/3.D
     #0*t25*t28)*s1vr+((512.D0/3.D0*t24*t33*s3l2p+512.D0/3.D0*t24*l3*s4l
     #2p*t6)*s2l1+(-512.D0/3.D0*t24*t33*s3l1p-512.D0/3.D0*t24*l3*s4l1p*t
     #6)*s2l2)*s23r+(512.D0/3.D0*t54*t9*s34r+512.D0/3.D0*t58*t59*s3l2p+5
     #12.D0/3.D0*t24*t9)*s2l1+(-512.D0/3.D0*t54*t16*s34r-512.D0/3.D0*t58
     #*t59*s3l1p-512.D0/3.D0*t24*t16)*s2l2-512.D0/3.D0*t24*t74+512.D0/3.
     #D0*t24*t77)*s13r+(t93*s1vr-t93*s23r+512.D0/3.D0*t98*t100*s2l2+512.
     #D0/3.D0*t108)*s1l1+(t117*s1vr-t117*s23r-512.D0/3.D0*t98*t100*s2l1-
     #512.D0/3.D0*t125)*s1l2+((-512.D0/3.D0*t129*t26+512.D0/3.D0*t129*t2
     #8)*s23r+(-t135-t138)*s2l1+(t141+t143)*s2l2+512.D0/3.D0*t136*t74-51
     #2.D0/3.D0*t136*t77)*s1vr
      taux16 = s1+((t135-t138)*s2l1+(-t141+t143)*s2l2)*s23r+(1024.D0/3.D
     #0*t108-512.D0/3.D0*t159*s3l2p)*s2l1+(-1024.D0/3.D0*t125+512.D0/3.D
     #0*t159*s3l1p)*s2l2+(-512.D0/3.D0*t170*t74+512.D0/3.D0*t170*t77)*s3
     #4r+512.D0/3.D0*t2*s4l2p*t14-512.D0/3.D0*t2*s4l1p*t7

CCC Coefficients

      tcoff29 = taux15
      tcoff30 = taux15
      tcoff31 = taux16
      tcoff32 = taux16

CCC Jet functions

      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet29 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff29)
      t2 = 1-l3
      t3 = 1-z
      t5 = t2*t3*s13r
      t6 = l3*t3
      t7 = t6*s23r
      t8 = t6*s1vr
      t11 = t3**2
      t13 = l3*t2*t11*s34r
      tFjet30 = Fjet(var,ndim,z,1/ux,t5,t7,-1-t5-t8+z,t8-t7-t13,t13,t8,-
     #1+z-t8+t13,-t5-t7-t13+z,1+t5+t7,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2
     #,s4l2,5.D0,1.D0,1.D0,Tcoeff*tcoff30)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet31 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff31)
      t2 = 1-l3
      t3 = 1-z
      t5 = t2*t3*s13r
      t6 = l3*t3
      t7 = t6*s23r
      t8 = t6*s1vr
      t11 = t3**2
      t13 = l3*t2*t11*s34r
      tFjet32 = Fjet(var,ndim,z,1/ux,t5,t7,-1-t5-t8+z,t8-t7-t13,t13,t8,-
     #1+z-t8+t13,-t5-t7-t13+z,1+t5+t7,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2
     #,s4l2,7.D0,1.D0,1.D0,Tcoeff*tcoff32)

CCC Sum

      qgrmnum9e4 = tFjet29*tcoff29+tFjet30*tcoff30+tFjet31*tcoff31+tFjet
     #32*tcoff32
      RETURN
      END

      double precision function qgrmnum10e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = s23r2(z,l1,l2,l3,l4)
      t2 = t1*z
      t3 = l3-1
      t4 = t3**2
      t5 = t4**2
      t7 = -1+z
      t8 = t7**2
      t9 = t8**2
      t10 = s4vr**2
      t11 = 1/t10
      t13 = s13r**2
      t14 = t13**2
      t19 = t4*t3
      t20 = t8*t7
      t21 = t19*t20
      t22 = t1*t11
      t27 = t19*t11
      t28 = t27*s23r
      t31 = t5*t9
      t32 = t22*s34r
      t36 = s1l1**2
      t38 = t22*s2l1
      t41 = z*t11
      t42 = t41*t1
      t47 = t2*t20
      t55 = l3*t19
      t56 = t55*t9
      t57 = t11*s23r
      t75 = z**2
      t76 = t1*t75
      t77 = t76*t20
      t80 = t76*t9
      t88 = t4*t20
      t89 = t88*l3
      t90 = s1vr**2
      t95 = t1*t4*t20
      t96 = l3*t11
      t100 = t56*t32
      t101 = 768*t100
      t102 = t4*t8
      t103 = t102*t11
      t105 = 1536*t2*t103
      t108 = s23r**2
      t114 = t1*(-4+z)
      t119 = 2*z
      t121 = t1*(1-t119)
      t129 = 1536*t89*t38
      t130 = t22*s3l1
      t131 = t89*t130
      t136 = t2*t4
      t137 = t20*l3
      t138 = t137*t11
      t139 = t136*t138
      t151 = 4*z
      t155 = t8*t11
      t156 = t155*s3l1
      t159 = 3+t119
      t166 = t11*t108
      t167 = t137*t166
      t170 = t11*s34r
      t171 = t2*t170
      t174 = t114*z
      t180 = t21*t170
      t185 = t4*t9
      t186 = t185*z
      t187 = l3**2
      t188 = t187*t1
      t189 = t90*s1vr
      t194 = t9*t187
      t198 = s2l1**2
      t205 = t9*t7
      t209 = 384*t19*t205*t187*t171
      t210 = t76*t4
      t222 = t11*s3l1
      t226 = -z-1
      t235 = t155*t198
      t240 = -z-3
      t248 = t80*t55*t170
      t250 = s3l1**2
      t260 = 2*t75
      t281 = t1*t3
      t282 = t281*t20
      t283 = t187*t11
      t287 = l3*t8
      t288 = t287*t11
      t293 = t283*t108
      t296 = t194*t4
      t297 = t296*t32
      t307 = 6144*t95*t96*s34r
      t308 = t7*t3
      t310 = 768*t308*t22
      t313 = t108*s23r
      t314 = t283*t313
      t319 = t1*(z-2)
      t326 = t136*t137*t170
      t334 = s34r**2
      t339 = t1*(-1-t151)
      t341 = t155*s34r
      t347 = t282*t283*s2l1
      t350 = t282*t283*s3l1
      t351 = 2304*t350
      t352 = t3*t20
      t353 = t352*t187
      t354 = t353*t42
      t355 = 768*t354
      t358 = t281*l3
      t363 = t96*s3l1
      t364 = t281*t8*t363
      t365 = 1536*t364
      t366 = t3*t2
      t367 = t366*t288
      t368 = 2304*t367
      t393 = t287*t222
      t396 = t3*t8
      t397 = t396*t96
      t405 = t7*t11
      t408 = 3072*t366*t405*s3l1
      t413 = t20*t187
      t414 = t11*t313
      t415 = t413*t414
      t419 = t186*t188*t170
      t427 = t88*t170
      t428 = t76*l3*t427
      t435 = t2*t9
      t436 = t11*t334
      t437 = t55*t436
      t441 = t102*t170
      t446 = t187*l3
      t447 = t2*t446
      t448 = t9*t3
      t452 = t283*t198
      t457 = t205*t4
      t459 = t447*t457*t170
      t465 = t41*t1*s3l1
      t485 = t366*t393
      t487 = t76*t3
      t488 = t487*t288
      t498 = t11*t198
      t503 = t1*t226
      t504 = t503*z
      t509 = t76*t187
      t511 = t509*t185*t170
      t517 = -1-t119
      t518 = t1*t517
      t519 = z*t3
      t520 = t518*t519
      t562 = t1*t75*z
      t566 = t1*t8
      t567 = t75*t3
      t585 = -t1*t226
      t591 = 2304*t282*t283*s34r
      t595 = t7*l3
      t596 = t595*t11
      t602 = 2304*t358*t341
      t603 = 1536*t42
      t609 = t518*t3
      t610 = t413*t170
      t613 = t595*t42
      t619 = t4*t11*t334
      t622 = t287*t170
      t637 = t446*t20
      t638 = t637*z
      t642 = t187*t8
      t643 = t642*t38
      t645 = t642*t130
      t647 = t642*t42
      t651 = t1*t7
      t652 = t651*t363
      t662 = t448*t446*t171
      t667 = t642*t11
      t673 = -t1*t517
      t704 = t76*t596
      t709 = t185*t436
      t710 = t188*z*t709
      t722 = t518*t170
      t727 = t187**2
      t728 = t727*t11
      t732 = t446*t11
      t778 = t595*z*t130
      t779 = 768*t778
      t843 = t518*t567
      s3 = 768*t2*t5*t9*t11*s1vr*t14
      s5 = ((768*t21*t22*s1vr-1536*t1*t20*t28-768*t31*t32)*t36+((768*t21
     #*t38+2304*t21*t42)*s1vr-1536*t47*t28-768*t31*z*t32)*s1l1+(-768*t56
     #*t2*t57+1536*t47*t27*s2l1+1536*t47*t27*s3l1+384*t1*(z+5)*z*t21*t11
     #)*s1vr-768*t77*t28-384*t80*t5*t11*s34r)*t13*s13r
      s8 = (-768*t89*t22*t90+(1536*t95*t96*s23r+t101+t105)*s1vr+3072*t95
     #*t96*t108+(1536*t100+768*t114*t103)*s23r-768*t121*t20*t27*s34r)*t3
     #6+((-t129-768*t131)*t90+((t129+3072*t131-768*t139)*s23r+(t101+t105
     #)*s2l1+(768*t56*t130+1536*t56*t42)*s34r+768*t1*(-1+t151)*t4*t156+7
     #68*t1*t159*z*t103)*s1vr+3072*t136*t167+(1536*t56*t171+768*t174*t10
     #3)*s23r-768*t121*z*t180)*s1l1+384*t186*t188*t11*t189+(-1152*t136*t
     #194*t57-768*t89*t22*t198+(-768*t131-768*t139)*s2l1+t209+384*t210*t
     #138)*t90
      s7 = s8+(768*t186*t188*t166+(-1536*t136*t137*t11*s2l1+t209-1536*t1
     #36*t137*t222+1152*t1*t226*z*t88*t96)*s23r+768*t136*t235+(2304*t136
     #*t156-768*t1*t240*z*t103)*s2l1+1152*t248+1536*t136*t155*t250+768*t
     #1*t159*z*t102*t222-384*t1*(-5-t260)*z*t103)*s1vr+1536*t210*t167+(7
     #68*t248+384*t114*t75*t103)*s23r-384*t121*t75*t180
      s8 = t13
      s6 = s7*s8
      s4 = s5+s6
      s2 = s3+s4
      s4 = s2
      s8 = ((-768*t282*t283*s23r-2304*t281*t288)*t90+(-2304*t282*t293+(-
     #768*t297-768*t1*(-5+z)*t3*t288)*s23r+t307-t310)*s1vr-1536*t282*t31
     #4+(-768*t297-1536*t319*t3*t288)*t108+(-3072*t326+1536*t281*t155)*s
     #23r-3072*t1*t9*t19*t96*t334-768*t339*t4*t341)*t36+(((-1536*t347-t3
     #51-t355)*s23r-4608*t358*t155*s2l1+t365-t368)*t90+((-2304*t347-3072
     #*t350-2304*t354)*t108+((-768*t297-768*t1*(-5+t119)*t3*t288)*s2l1+(
     #-768*t296*t130-3072*t186*t188*t11)*s34r-768*t1*(-5+t151)*t3*t393-7
     #68*t174*t397)*s23r+(t307-t310)*s2l1+7680*t326+t408-768*t308*t42)*s
     #1vr-1536*t366*t415+(-768*t419-1536*t319*z*t397)*t108+(-3072*t428+1
     #536*t2*t396*t11)*s23r-3072*t435*t437-768*t339*z*t441)*s1l1
      s7 = s8+(768*t447*t448*t166+(-768*t282*t452+(-t351-t355)*s2l1-1152
     #*t459-1536*t282*t283*t250-1536*t353*t465-384*t1*(2+z)*z*t352*t283)
     #*s23r-2304*t358*t235+(t365-t368)*s2l1+1536*t419+768*t287*t3*t22*t2
     #50+768*t485-1152*t488)*t90+(-768*t447*t448*t414+(-384*t459+t355)*t
     #108+(-768*t366*t287*t498+(-2304*t485+768*t504*t397)*s2l1-2688*t511
     #-1536*t366*t287*t11*t250+768*t520*t393+384*t1*(z-2-t75)*z*t397)*s2
     #3r+(1536*t326+t408)*s2l1-768*t2*t205*t19*t187*t436+4608*t428+1536*
     #t366*t405*t250-1536*t504*t308*t222-384*t1*t7*z*t308*t11)*s1vr
      s6 = s7-768*t487*t415+(-384*t511-768*t319*t75*t397)*t108+(-1536*t5
     #62*l3*t427+768*t566*t567*t11)*s23r-1536*t80*t437-384*t339*t75*t441
      s7 = s13r
      s5 = s6*s7
      s3 = s4+s5
      s4 = s3+(768*t566*t187*t57*t90+(-768*t585*t8*t293+(-t591+768*t1*(1
     #+3*z)*t596)*s23r+t602-t603)*s1vr+768*t2*t8*t314+(-768*t609*t610-15
     #36*t613)*t108+(1536*t188*t9*t619+1536*t609*t622+768*t42)*s23r-3072
     #*t1*l3*t20*t619-768*t308*t517*t32)*t36
      s1 = s4+((-768*t638*t22*t108+(1536*t643-768*t645+2304*t647)*s23r+2
     #304*t652-768*t613)*t90+(768*t638*t22*t313+(-768*t643+1536*t662+768
     #*t1*t240*z*t667)*t108+((-t591+768*t673*t596)*s2l1+(768*t350-4608*t
     #354)*s34r-768*t652+2304*t585*z*t596)*s23r+(t602-t603)*s2l1+(-3840*
     #t364+3072*t367)*s34r+768*t130-768*t673*t41)*s1vr+768*t76*t8*t314+(
     #-768*t520*t610-1536*t704)*t108+(1536*t710+1536*t520*t622+768*t76*t
     #11)*s23r-3072*t89*t2*t436-768*t308*z*t722)*s1l1+(-384*t435*t728*t1
     #08+768*t47*t732*s23r-384*t647)*t189
      s2 = s1+(384*t435*t728*t313+(768*t3*t205*t727*t171+768*t1*t226*z*t
     #637*t11)*t108+(768*t566*t452+(-768*t645+768*t647)*s2l1-1920*t662+3
     #84*t1*(5*z+1)*z*t667)*s23r+2304*t651*l3*t222*s2l1+1152*t353*t171-7
     #68*t651*t96*t250+t779-768*t704)*t90+(768*t77*t732*t313+(-384*t339*
     #z*t446*t448*t170-384*t1*(t75+t151)*z*t667)*t108+(768*t2*t7*t96*t19
     #8+(-768*t778-768*t504*t596)*s2l1+768*t447*t457*t436-384*t1*(1+9*z)
     #*t519*t610-t779+384*t1*(t119+3*t75+1)*z*t596)*s23r-768*t2*t498+(76
     #8*t465+768*t503*t41)*s2l1-768*t710+(-1536*t485+1920*t488)*s34r+768
     #*t465-384*t1*(t260+1)*t41)*s1vr+384*t562*t8*t314
      taux17 = s2+(-384*t843*t610-768*t562*t596)*t108+(768*t509*t709+768
     #*t843*t622+384*t562*t11)*s23r-1536*t210*t137*t436-384*t308*t75*t72
     #2
      t1 = s23r2(z,l1,l2,l3,l4)
      t2 = t1*z
      t3 = l3-1
      t4 = t3**2
      t5 = t4**2
      t7 = -1+z
      t8 = t7**2
      t9 = t8**2
      t10 = s4vr**2
      t11 = 1/t10
      t13 = s13r**2
      t14 = t13**2
      t19 = t4*t3
      t20 = t8*t7
      t21 = t19*t20
      t23 = t1*t11
      t27 = t2*t20
      t28 = t19*t11
      t29 = t28*s23r
      t39 = l3*t19
      t40 = t39*t9
      t41 = t11*s23r
      t42 = t2*t41
      t59 = z**2
      t60 = t1*t59
      t61 = t60*t20
      t64 = t60*t9
      t72 = t11*s34r
      t73 = t2*t72
      t75 = 6144*t40*t73
      t76 = 6*z
      t77 = 4*t59
      t80 = t4*t8
      t81 = t80*t11
      t86 = t2*t4
      t87 = t20*l3
      t88 = s23r**2
      t89 = t11*t88
      t90 = t87*t89
      t94 = t1*(-4+z)
      t100 = 2*z
      t102 = t1*(1-t100)
      t104 = t21*t72
      t109 = t4*t9
      t110 = t109*z
      t111 = l3**2
      t112 = t111*t1
      t113 = s1vr**2
      t114 = t113*s1vr
      t123 = t11*s2l1
      t126 = 3072*t86*t87*t123
      t127 = t9*t7
      t131 = 1536*t19*t127*t111*t73
      t132 = t60*t4
      t141 = t11*s3l1
      t145 = -t7
      t155 = 2*t59
      t159 = t8*t11
      t164 = t64*t39*t72
      t166 = 4*z
      t193 = t3*t20
      t194 = t193*t111
      t197 = t3*t2
      t198 = l3*t8
      t199 = t11*t198
      t205 = t110*t112*t72
      t215 = t86*t87*t72
      t217 = t7*t3
      t218 = t2*t11
      t220 = 3072*t217*t218
      t223 = t20*t111
      t224 = t88*s23r
      t225 = t11*t224
      t226 = t223*t225
      t231 = t1*(z-2)
      t233 = t3*t8
      t234 = l3*t11
      t235 = t233*t234
      t241 = t4*t20
      t242 = t241*t72
      t243 = t60*l3*t242
      t250 = t2*t9
      t251 = s34r**2
      t252 = t11*t251
      t253 = t39*t252
      t257 = t1*(-1-t166)
      t259 = t80*t72
      t264 = t111*l3
      t265 = t2*t264
      t266 = t9*t3
      t273 = t127*t4
      t275 = t265*t273*t72
      t283 = t111*t11
      t289 = t198*t123
      t293 = t198*t141
      t294 = t197*t293
      t296 = t60*t3
      t297 = t296*t199
      t314 = t60*t111
      t316 = t314*t109*t72
      t320 = z*t3
      t343 = z+1
      t360 = t1*t59*z
      t365 = t59*t3
      t378 = t264*t20
      t379 = t378*z
      t383 = t111*t8
      t384 = t383*z
      t388 = t7*l3
      t397 = t266*t264*t73
      t401 = t383*t11
      t406 = t194*t73
      t408 = t388*t11
      t409 = t60*t408
      t413 = t198*t72
      t423 = t283*t224
      t427 = t1*(-1-t100)
      t428 = t427*t320
      t429 = t223*t72
      t436 = t109*t252
      t437 = t112*z*t436
      t450 = t427*t72
      t455 = t111**2
      t456 = t455*t11
      t460 = t264*t11
      t544 = z*t11
      t562 = t427*t365
      s3 = 3072*t2*t5*t9*t11*s1vr*t14
      s4 = ((3072*t21*z*t23*s1vr+6144*t27*t29+3072*t5*t9*z*t23*s34r)*s1l
     #1+(-3072*t40*t42+3072*t27*t28*s2l1+6144*t27*t28*s3l1-1536*t1*(-5+z
     #)*z*t21*t11)*s1vr+3072*t61*t29+1536*t64*t5*t11*s34r)*t13*s13r+(((-
     #t75+1536*t1*(t76-t77)*t81)*s1vr-12288*t86*t90+(-t75-3072*t94*z*t81
     #)*s23r+3072*t102*z*t104)*s1l1-1536*t110*t112*t11*t114+(4608*t86*t9
     #*t111*t41+t126-t131-1536*t132*t87*t11)*t113+(-3072*t110*t112*t89+(
     #-t126-t131-6144*t86*t87*t141-4608*t1*t145*z*t87*t4*t11)*s23r+1536*
     #t1*(t76-t155)*t4*t159*s2l1-4608*t164+1536*t1*(-t166+8)*z*t80*t141+
     #1536*t1*(-t155+5)*z*t81)*s1vr-6144*t132*t90+(-3072*t164-1536*t94*t
     #59*t81)*s23r+1536*t102*t59*t104)*t13
      s2 = s3+s4
      s4 = s2
      s7 = ((3072*t194*t42+9216*t197*t199)*t113+((12288*t205-3072*t1*(-t
     #59+t100)*t3*t199)*s23r-30720*t215+t220)*s1vr+6144*t197*t226+(3072*
     #t205+6144*t231*z*t235)*t88+(12288*t243-6144*t2*t233*t11)*s23r+1228
     #8*t250*t253+3072*t257*z*t259)*s1l1+(-3072*t265*t266*t89+(3072*t194
     #*t2*t123+4608*t275+6144*t194*t2*t141+1536*t1*(2+z)*z*t193*t283)*s2
     #3r+9216*t197*t289-6144*t205-3072*t294+4608*t297)*t113+(3072*t265*t
     #266*t225+(1536*t275-3072*t194*t218)*t88+(-1536*t1*(-t155+t166)*t3*
     #t289+10752*t316-6144*t1*t145*t320*t293-1536*t1*(-t59+z+2)*z*t235)*
     #s23r+(-6144*t215+t220)*s2l1+3072*t2*t127*t19*t111*t252-18432*t243-
     #6144*t197*t159*s3l1+1536*t1*t343*z*t217*t11)*s1vr+3072*t296*t226
      s6 = s7+(1536*t316+3072*t231*t59*t235)*t88+(6144*t360*l3*t242-3072
     #*t1*t8*t365*t11)*s23r+6144*t64*t253+1536*t257*t59*t259
      s7 = s13r
      s5 = s6*s7
      s3 = s4+s5
      s1 = s3+((3072*t379*t23*t88-9216*t384*t23*s23r+3072*t388*t218)*t11
     #3+(-3072*t379*t23*t224+(-6144*t397+1536*t1*(t166+t155)*t401)*t88+(
     #18432*t406-9216*t409)*s23r-12288*t197*t413+1536*t1*(t77-t100)*t11)
     #*s1vr-3072*t60*t8*t423+(3072*t428*t429+6144*t409)*t88+(-6144*t437-
     #6144*t428*t413-3072*t60*t11)*s23r+12288*t241*l3*t2*t252+3072*t217*
     #z*t450)*s1l1+(1536*t250*t456*t88-3072*t27*t460*s23r+1536*t383*t218
     #)*t114
      taux18 = s1+(-1536*t250*t456*t224+(-3072*t3*t127*t455*t73+3072*t1*
     #t343*z*t378*t11)*t88+(-3072*t384*t23*s2l1+7680*t397-1536*t1*(5*z+1
     #)*z*t401)*s23r-4608*t406-3072*t388*z*t23*s3l1+3072*t409)*t113+(-30
     #72*t61*t460*t224+(1536*t257*z*t264*t266*t72+1536*t1*(t59+t166)*z*t
     #401)*t88+(1536*t1*(2*z-2*t59)*t7*t234*s2l1-3072*t265*t273*t252+153
     #6*t1*(1+9*z)*t320*t429-1536*t1*(3*t59+t100-1)*z*t408)*s23r-3072*t1
     #*t145*t544*s2l1+3072*t437+(6144*t294-7680*t297)*s34r+1536*t1*(-1+t
     #155)*t544)*s1vr-1536*t360*t8*t423+(1536*t562*t429+3072*t360*t408)*
     #t88+(-3072*t314*t436-3072*t562*t413-1536*t360*t11)*s23r+6144*t132*
     #t87*t252+1536*t217*t59*t450

CCC Coefficients

      tcoff33 = taux17
      tcoff34 = taux17
      tcoff35 = taux18
      tcoff36 = taux18

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet33 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff33)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = 1-l3
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet34 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff34)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet35 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff35)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = 1-l3
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet36 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff36)

CCC Sum

      qgrmnum10e0 = tFjet33*tcoff33+tFjet34*tcoff34+tFjet35*tcoff35+tFje
     #t36*tcoff36
      RETURN
      END

      double precision function qgrmnum10e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = s23r2(z,l1,l2,l3,l4)
      t2 = t1*z
      t3 = l3-1
      t4 = t3**2
      t5 = t4**2
      t6 = t2*t5
      t7 = -1+z
      t8 = t7**2
      t9 = t8**2
      t10 = s4vr**2
      t11 = 1/t10
      t13 = s13r**2
      t14 = t13**2
      t19 = t8*t7
      t20 = t1*t19
      t21 = t4*t3
      t23 = t11*s23r
      t24 = s1l1**2
      t28 = t2*t19
      t29 = t21*t11
      t34 = l3*t21
      t35 = t34*t9
      t36 = s1vr**2
      t47 = t9*t7
      t49 = t11*s34r
      t56 = 3*z
      t60 = t19*t21
      t66 = z**2
      t67 = t1*t66
      t72 = t67*t9
      t80 = t1*t4
      t81 = t80*t19
      t82 = l3*t11
      t86 = t8*t11
      t91 = s23r**2
      t95 = t86*s23r
      t98 = t29*s34r
      t103 = t4*t19
      t104 = t103*l3
      t105 = t1*t11
      t106 = t105*s2l1
      t108 = t105*s3l1
      t109 = t104*t108
      t110 = t2*t4
      t111 = l3*t19
      t113 = t110*t111*t11
      t117 = t86*s2l1
      t121 = t4*t8*t11
      t122 = t2*t121
      t126 = t11*t91
      t127 = t111*t126
      t133 = t105*s34r
      t138 = t4*t9
      t139 = t138*z
      t140 = l3**2
      t141 = t140*t1
      t142 = t36*s1vr
      t154 = 1536*t110*t111*t11*s2l1
      t157 = t2*t49
      t158 = t21*t47*t140*t157
      t160 = t11*s3l1
      t163 = 1536*t110*t111*t160
      t167 = t103*t82
      t176 = 4*z
      t184 = s2l1**2
      t185 = t86*t184
      t189 = t110*t86*s3l1
      t198 = t34*t49
      t201 = s3l1**2
      t215 = t67*t4
      t229 = 2*t1
      t230 = 2*z
      t231 = 1-t230
      t240 = t1*t3
      t241 = t240*t19
      t242 = t140*t11
      t245 = l3*t8
      t246 = t245*t11
      t254 = t240*l3
      t259 = 4608*t81*t82*s34r
      t260 = t7*t3
      t262 = 1536*t260*t105
      t265 = t91*s23r
      t266 = t242*t265
      t272 = s34r*s23r
      t273 = t82*t272
      t278 = s34r**2
      t282 = t86*s34r
      t288 = t241*t242*s2l1
      t291 = t241*t242*s3l1
      t293 = t3*t19
      t294 = t293*t140
      t295 = z*t11
      t296 = t295*t1
      t297 = t294*t296
      t301 = t254*t117
      t304 = t82*s3l1
      t305 = t240*t8*t304
      t306 = 1536*t305
      t307 = t3*t2
      t308 = t307*t246
      t309 = 1536*t308
      t325 = t7*t11
      t326 = t325*s3l1
      t333 = t19*t140
      t334 = t11*t265
      t335 = t333*t334
      t344 = t2*t9
      t345 = t11*t278
      t346 = t34*t345
      t353 = t140*l3
      t354 = t2*t353
      t355 = t9*t3
      t365 = t242*t184
      t372 = t47*t4
      t374 = t354*t372*t49
      t382 = t293*t242
      t396 = t307*t245*t160
      t397 = 768*t396
      t398 = 5*z
      t403 = t3*t8*t82
      t418 = t11*t184
      t426 = 7*z
      t431 = t138*t49
      t447 = t7*z*t3
      t454 = t307*t326
      t468 = t103*t49
      t486 = t67*t3
      t489 = t67*t140
      t502 = (-t1-t2)*t66
      t506 = t1*t8
      t517 = t1*(-1-t176)
      t525 = t506*t140
      t531 = t254*t282
      t539 = t1*t7
      t546 = t4*t11*t278
      t561 = t140*t8
      t565 = 768*t561*t296
      t568 = t539*t304
      t569 = 1536*t568
      t575 = s34r*s2l1
      t597 = t294*t157
      t598 = t7*l3
      t599 = t598*t296
      t604 = t138*t345
      t606 = 1536*t141*z*t604
      t607 = t245*t49
      t620 = t140**2
      t621 = t620*t11
      t625 = t353*t11
      t652 = t105*t201
      t655 = t561*t11
      t667 = t598*z
      t669 = 768*t667*t108
      t672 = t598*t11
      t705 = t333*t49
      t747 = -1-t230
      t751 = (-t229+t1*t747)*t66*t3
      s3 = -1536*t6*t9*t11*s1vr*t14
      s5 = (1536*t20*t21*t23*t24+1536*t28*t29*s23r*s1l1+1152*t35*t2*t11*
     #t36+(3072*t35*t2*t23-1536*t28*t29*s2l1+384*t6*t47*l3*t49-1536*t28*
     #t29*s3l1+384*t1*(-10+t56)*z*t60*t11)*s1vr+1536*t67*t19*t29*s23r+38
     #4*t72*t5*t11*s34r)*t13*s13r
      s6 = (((-3072*t81*t82*s23r+1536*t80*t86)*s1vr-3072*t81*t82*t91+230
     #4*t80*t95-1536*t20*t98)*t24+(((-3072*t104*t106-3072*t109-3072*t113
     #)*s23r+1536*t80*t117+1536*t122)*s1vr-3072*t110*t127+2304*t110*t95-
     #1536*t60*z*t133)*s1l1-1152*t139*t141*t11*t142+(-1152*t110*t9*t140*
     #t23+t154-384*t158+t163-384*t1*(z-6)*z*t167)*t36+(-3072*t139*t141*t
     #126+(t154-768*t158+t163+384*t1*(13-t176)*z*t167)*s23r-1536*t110*t1
     #85+(-3072*t189-2304*t122)*s2l1+384*t1*(1-t56)*z*t9*t198-1536*t110*
     #t86*t201-2304*t189-384*t1*(-8*z+10+2*t66)*z*t121)*s1vr-3072*t215*t
     #127+(-768*t198*t72-384*(-3*t1+t1*(-4+z))*t66*t121)*s23r+384*(-t229
     #+t1*t231)*t66*t19*t98)*t13
      s4 = s5+s6
      s2 = s3+s4
      s4 = s2
      s8 = ((1536*t241*t242*s23r+1536*t240*t246)*t36+(3072*t241*t242*t91
     #-4608*t254*t95-t259+t262)*s1vr+1536*t241*t266-1536*t254*t86*t91+30
     #72*t81*t273+3072*t1*t9*t21*t82*t278-3072*t80*t282)*t24+(((3072*t28
     #8+3072*t291+1536*t297)*s23r+3072*t301-t306+t309)*t36+((3072*t288+3
     #072*t291+3072*t297)*t91+(-4608*t301-t306-4608*t308)*s23r+(-t259+t2
     #62)*s2l1+(1536*t109-4608*t113)*s34r-1536*t240*t326+1536*t260*t296)
     #*s1vr+1536*t307*t335-1536*t307*t245*t126+3072*t2*t103*t273+3072*t3
     #44*t346-3072*t110*t282)*s1l1
      s7 = s8+(768*t354*t355*t23-384*t297)*t142+(384*t354*t355*t126+(153
     #6*t241*t365+3072*t241*t242*s3l1*s2l1+1152*t374+1536*t241*t242*t201
     #-384*t1*(-t56+5)*z*t382)*s23r+1536*t254*t185+(-t306+2304*t308)*s2l
     #1-2304*t139*t141*t49+t397-384*t1*(-1-t398)*z*t403)*t36+(1536*t354*
     #t355*t334+(384*t374-384*t1*(6-t56)*z*t382)*t91+(1536*t307*t245*t41
     #8+(3072*t396+768*t308)*s2l1-384*t1*(-t426-2)*t140*z*t431+1536*t307
     #*t245*t11*t201+t397+384*t1*(-9*z+t66+8)*z*t403)*s23r-768*t447*t105
     #*t184+(-1536*t110*t111*t49-3072*t454)*s2l1+1536*t2*t47*t21*t140*t3
     #45+1152*t1*(-6*z+1)*z*l3*t468-768*t307*t325*t201-1536*t454-384*(t1
     #*t231-t1*t7)*z*t260*t11)*s1vr
      s6 = s7+1536*t486*t335+(384*t489*t431+768*(-t1+t1*(z-2))*t66*t3*t2
     #46)*t91+(-1536*t502*l3*t468-768*t506*t66*t3*t11)*s23r+3072*t72*t34
     #6+384*(-4*t1+t517)*t66*t4*t282
      s7 = s13r
      s5 = s6*s7
      s3 = s4+s5
      s1 = s3+(-768*t525*t23*t36+(1536*t241*t242*t272-1536*t531)*s1vr-76
     #8*t506*t266+(-1536*t241*t242*s34r+1536*t539*t82)*t91+(-1536*t141*t
     #9*t546+3072*t531-768*t105)*s23r+3072*t1*l3*t19*t546-1536*t260*t133
     #)*t24+(((-1536*t561*t106-t565)*s23r-t569)*t36+(-1536*t525*t160*t91
     #+(1536*t241*t242*t575+(-1536*t291+1536*t297)*s34r+3072*t568)*s23r-
     #1536*t254*t86*t575+(4608*t305-t309)*s34r-1536*t108)*s1vr-768*t2*t8
     #*t266+(-1536*t597+1536*t599)*t91+(-t606+3072*t307*t607-768*t296)*s
     #23r+3072*t104*t2*t345-1536*t447*t133)*s1l1+(384*t344*t621*t91-1152
     #*t28*t625*s23r+t565)*t142
      s2 = s1+(-384*t344*t621*t265+(-768*t3*t47*t620*t157+384*t1*(3+t230
     #)*z*t19*t353*t11)*t91+(-768*t506*t365+2688*t355*t353*t157-768*t561
     #*t652-2304*t67*t655)*s23r+(-t569-768*t599)*s2l1-1920*t597+1536*t53
     #9*t82*t201-t669+768*(-t1+t2)*z*t672)*t36+(384*(-t1-2*t2)*z*t19*t62
     #5*t265+(384*(-t229+t517)*z*t353*t355*t49-384*t1*(-t398-t66)*z*t655
     #)*t91+(-768*t2*t7*t82*t184-768*t667*t106-1536*t354*t372*t345+4224*
     #t486*t705-768*t667*t652+t669+384*t1*(-3*t66-z-1)*z*t672)*s23r+768*
     #t2*t418+768*t295*t1*s2l1+t606+(1536*t396+384*t1*(-t426+3)*z*t403)*
     #s34r+768*t295*t1*t201-768*t295*t1*s3l1-384*t1*(-2-2*t66+2*z)*t295)
     #*s1vr+384*t502*t8*t266
      taux17 = s2+(384*t751*t705-768*t502*t672)*t91+(-1536*t489*t604-768
     #*t751*t607+384*(-t66-t66*z)*t1*t11)*s23r+3072*t215*t111*t345+384*(
     #-2*t260*t66+t260*t66*t747)*t1*t49
      t1 = s23r2(z,l1,l2,l3,l4)
      t2 = -1+z
      t3 = t2**2
      t4 = t3**2
      t5 = t1*t4
      t6 = l3-1
      t7 = t6**2
      t8 = t7**2
      t10 = s4vr**2
      t11 = 1/t10
      t16 = t1*z
      t17 = t16*t8
      t23 = s13r**2
      t24 = t23**2
      t26 = t7*t6
      t27 = t5*t26
      t28 = l3*t11
      t29 = s1vr**2
      t37 = t2*t4
      t39 = t28*s34r
      t42 = 2*z
      t45 = 4*t16
      t48 = t3*t2
      t49 = t48*t11
      t54 = t16*t48
      t55 = t26*t11
      t56 = t55*s23r
      t61 = t1*t11
      t62 = t61*s34r
      t67 = l3*t26
      t68 = t67*t4
      t69 = t61*s3l1
      t72 = t16*t11
      t85 = t11*s34r
      t89 = t55*s3l1
      t92 = -z+5
      t105 = z**2
      t106 = t1*t105
      t110 = t106*t4
      t118 = t5*t7
      t119 = l3**2
      t120 = t119*t11
      t121 = t29*s1vr
      t128 = t1*t119
      t129 = t128*t37
      t131 = t129*t55*s34r
      t134 = t48*l3
      t135 = t134*t11
      t140 = s23r**2
      t152 = 4*z
      t153 = -1-t152
      t154 = t1*t153
      t155 = 8*t16
      t161 = 10*z
      t162 = 4*t105
      t165 = 6*z
      t171 = t3*t11
      t176 = t16*t7
      t177 = t140*t11
      t178 = t134*t177
      t181 = t16*t85
      t184 = -4+z
      t187 = 3*t1-3*t1*t184
      t190 = t7*t3*t11
      t195 = 2*t1
      t196 = 1-t42
      t199 = t195-3*t1*t196
      t202 = t49*s34r
      t207 = t120*s2l1
      t210 = t7*t4
      t211 = t210*t119
      t212 = t211*t69
      t214 = t210*z
      t216 = t214*t128*t11
      t224 = 5*z
      t229 = t48*t7
      t230 = t229*t11
      t235 = t129*t89
      t240 = t16*t37*t26*t119*t11
      t244 = -5-z
      t247 = t11*s3l1
      t248 = t134*t247
      t253 = 2*t16
      t272 = t176*t248
      t276 = -t2
      t278 = 3*t1*t276
      t290 = t67*t85
      t292 = 2*t105
      t305 = t16*t247
      t307 = 3*z
      t309 = t1*(1-t307)
      t310 = 6*t16
      t341 = t106*t7
      t357 = t119*l3
      t358 = t1*t357
      t359 = t358*t4
      t360 = t6*t11
      t364 = t358*t37
      t365 = t7*t11
      t366 = t365*s34r
      t367 = t364*t366
      t373 = t48*t119
      t374 = t373*t11
      t379 = t211*t62
      t383 = 12*t16
      t386 = l3*t3
      t387 = t386*t11
      t392 = t140*s23r
      t397 = t1*t6
      t419 = s34r**2
      t421 = t129*t55*t419
      t436 = t2*t11
      t441 = t16*t6
      t442 = t11*t392
      t443 = t373*t442
      t452 = t1-3*t1*(z-2)
      t459 = 3*t16
      t460 = t1+t459
      t461 = t460*z
      t463 = t229*t85
      t472 = t16*t4
      t473 = t11*t419
      t474 = t67*t473
      t477 = 4*t1
      t478 = 3*t154
      t479 = t477-t478
      t482 = t171*s34r
      t488 = t359*t360*s3l1
      t490 = t16*t357
      t491 = t4*t6
      t493 = t490*t491*t11
      t497 = t397*t48
      t498 = t120*s3l1
      t499 = t497*t498
      t501 = t6*t48
      t502 = t501*t119
      t503 = t502*t72
      t511 = -z-1
      t512 = t1*t511
      t522 = t37*t7
      t528 = 9*z
      t537 = t1*(2-t307)
      t538 = 2+z
      t549 = t1*(-t165+1)
      t563 = t28*s3l1
      t566 = -1-t224
      t598 = 7*z
      t626 = 4*t1*t276
      t631 = t386*t247
      t650 = t2*t1
      t669 = t1*t3
      t676 = -t511
      t681 = t2*t6
      t690 = t106*t119
      t700 = t460*t105
      t718 = t119**2
      t719 = t718*t11
      t723 = t1*t48
      t724 = t357*t11
      t732 = t719*t392
      t747 = t360*s34r
      t748 = t359*t747
      t750 = t119*t3
      t751 = t750*t72
      t755 = t120*s34r
      t756 = t497*t755
      t764 = t357*t48
      t770 = t1*(-3-t165)
      t786 = t365*t419
      t807 = t128*t4*t786
      t829 = t120*t392
      t832 = -1-t42
      t835 = t195-3*t1*t832
      t837 = t835*z*t6
      t838 = t373*t85
      t842 = t2*l3*t11
      t848 = t210*t473
      t851 = t386*t85
      t854 = 3*t105
      t888 = t724*s2l1
      t891 = t724*s3l1
      t894 = t764*t11
      t948 = t750*t11
      t1004 = -t1*t184
      t1088 = -t292+1
      t1103 = t835*t105*t6
      s3 = (3072*t5*t8*t11*s1vr*s1l1-9216*t17*t4*t11*s1vr)*t24
      s5 = ((-4608*t27*t28*t29+(-9216*t27*t28*s23r-1536*t1*t8*t37*t39+15
     #36*(-t1*(-5+t42)-t45)*t26*t49)*s1vr-24576*t54*t56-9216*t8*t4*z*t62
     #)*s1l1+(-3072*t68*t69-1536*t68*t72)*t29+(6144*t68*t16*t11*s23r-122
     #88*t54*t55*s2l1-1536*t17*t37*l3*t85-21504*t54*t89-4608*t1*t92*z*t2
     #6*t48*t11)*s1vr-12288*t106*t48*t56-4608*t110*t8*t11*s34r)*t23*s13r
      s8 = (1536*t118*t120*t121+(10752*t118*t120*s23r+1536*t131-12288*t1
     #*t7*t135)*t29+(9216*t118*t120*t140+(3072*t131-1536*t1*(z+10)*t7*t1
     #35)*s23r+1536*(-t154+t155)*t4*t26*t39-1536*(-t1*(7-t161+t162)+2*t1
     #*(t165-t162))*t7*t171)*s1vr+49152*t176*t178+(18432*t68*t181-3072*t
     #187*z*t190)*s23r+3072*t199*z*t26*t202)*s1l1+(1536*t118*t207+4608*t
     #212+7680*t216)*t121+((6144*t212-13824*t216)*s23r+(-1536*t131-1536*
     #(-t1*(3-t224)+t45)*l3*t230)*s2l1+(-1536*t235+4608*t240)*s34r+1536*
     #t1*t244*t7*t248-1536*(-t1*(-3+z)-t253)*z*l3*t230)*t29
      s7 = s8+(15360*t214*t128*t177+(12288*t176*t134*t11*s2l1+6144*t26*t
     #37*t119*t181+24576*t272+1536*(t1*t153+2*t278)*z*l3*t230)*s23r+(153
     #6*t1*(-z-4)*t4*t290-1536*(-t1*(t292+2-11*z)+2*t1*(t165-t292))*t7*t
     #171)*s2l1+(-1536*t68*t305+1536*(-t309+t310)*z*t4*t67*t11)*s34r-153
     #6*(-t1*(t152-11)+2*t1*(-t152+8))*z*t7*t171*s3l1-1536*(-t1*(t292-3-
     #t42)+2*t1*(-t292+5))*z*t190)*s1vr+24576*t341*t178+(9216*t110*t290-
     #1536*t187*t105*t190)*s23r+1536*t199*t105*t26*t202
      s8 = t23
      s6 = s7*s8
      s4 = s5+s6
      s2 = s3+s4
      s4 = s2
      s8 = ((-7680*t359*t360*t140+(-4608*t367-1536*(-t1*(-t224+11)+t45)*
     #t6*t374)*s23r+9216*t379-1536*(-t1*(-3-t161)+t383)*t6*t387)*t29+(-3
     #072*t359*t360*t392+(-1536*t367+7680*t397*t374)*t140+(-3072*(-t1*(-
     #t224-2)+t155)*t119*t4*t366+3072*(-t1*(-t165+t105+5)+2*t1*(-t105+t4
     #2))*t6*t387)*s23r-6144*t421+1536*(-t1*(-32*z+3)+40*t16)*l3*t48*t36
     #6-1536*(-t1*(3-t165)+t45)*t6*t436)*s1vr-24576*t441*t443+(-9216*t21
     #4*t128*t85+6144*t452*z*t6*t387)*t140+(-12288*t461*l3*t463+18432*t1
     #6*t6*t3*t11)*s23r-49152*t472*t474+3072*t479*z*t7*t482)*s1l1+((-614
     #4*t488-3072*t493)*s23r+12288*t499+1536*t503)*t121
      s9 = s8
      s11 = ((-3072*t488+10752*t493)*t140+((1536*t367-1536*(-t512+t45)*t
     #6*t374)*s2l1+(1536*t364*t365*s3l1-13824*t490*t522*t11)*s34r-1536*(
     #-t1*(-t528+5)+t155)*t6*t48*t498-1536*(-t537+2*t1*t538)*z*t6*t374)*
     #s23r+(-3072*t379-3072*(-t549+t310)*t6*t387)*s2l1+(-12288*t212+2150
     #4*t216)*s34r+3072*(-t278+t253)*t6*t3*t563-1536*(-t1*t566+t310)*z*t
     #6*t387)*t29
      s12 = (-12288*t490*t491*t442+(-4608*t490*t522*t85-3072*t502*t305-1
     #536*(t1*t244-t477)*z*t6*t374)*t140+((1536*t1*t538*t4*t7*t119*t85+1
     #536*(-t1*(-t598+4+t105)+2*t1*(-t292+t152))*t6*t387)*s2l1+(1536*t21
     #4*t128*t247-1536*(-t1*(-t598-2)+14*t16)*t119*z*t210*t11)*s34r+1536
     #*(-t1*(-7+t224)+2*t626)*z*t6*t631+1536*(-t1*(4-t224+t105)+2*t1*(-t
     #105+z+2))*z*t6*t387)*s23r+(3072*t421+3072*(-t626+t45)*l3*t48*t366-
     #3072*(t650+t459)*t6*t436)*s2l1+(3072*t235-12288*t240)*t419+(-6144*
     #t272+4608*(-t549+t155)*z*l3*t230)*s34r+3072*(t669+6*t16*t3)*t6*t24
     #7-1536*(-t309+2*t1*t676)*z*t681*t11)*s1vr
      s10 = s11+s12
      s7 = s9+s10
      s6 = s7-12288*t106*t6*t443+(-4608*t690*t210*t85+3072*t452*t105*t6*
     #t387)*t140+(-6144*t700*l3*t463+9216*t669*t105*t6*t11)*s23r-24576*t
     #110*t474+1536*t479*t105*t7*t482
      s7 = s13r
      s5 = s6*s7
      s3 = s4+s5
      s4 = s3
      s8 = (-1536*t5*t719*t140+3072*t723*t724*s23r-1536*t669*t120)*t121+
     #(1536*t5*t732+(3072*t397*t37*t719*s34r+1536*(-3*t1*t676-t45)*t48*t
     #724)*t140+(-10752*t748+32256*t751)*s23r+7680*t756+3072*(-t650-t253
     #)*t2*t28)*t29+(10752*t764*z*t61*t392+(1536*(-t770+t155)*t357*t4*t7
     #47-1536*(-t1*(3-t292-t161)+2*t1*(t152+t292))*t3*t120)*t140+(6144*t
     #364*t786-3072*(-t1*(-t528+1)+t383)*t6*t48*t755+1536*(-t1*(-6*t105-
     #t224+2)+12*t106)*t2*t28)*s23r-6144*t807+1536*(-t1*(-12*z+5)+16*t16
     #)*t6*t3*t39-1536*(-t1*(-t162+t42-1)+2*t1*(t162-t42))*t11)*s1vr+307
     #2*t461*t3*t829
      s7 = s8+(3072*t837*t838-6144*t461*t842)*t140+(24576*t128*z*t848-61
     #44*t837*t851+3072*(z+t854)*t1*t11)*s23r-49152*t229*l3*t16*t473+307
     #2*(2*t681*z-3*t681*z*t832)*t1*t85
      s8 = s1l1
      s6 = s7*s8
      s7 = ((-1536*t5*t719*s2l1+1536*t5*t719*s3l1-4608*t16*t4*t718*t11)*
     #t140+(3072*t723*t888-6144*t723*t891+10752*t16*t894)*s23r-1536*t750
     #*t61*s2l1+4608*t750*t69-6144*t751)*t121
      s5 = s6+s7
      s1 = s4+s5
      s3 = s1+(4608*t472*t732+(-3072*t54*t888+9216*t6*t37*t718*t181+3072
     #*t54*t891+1536*(-t1*(5+t42)+4*t1*t511)*z*t894)*t140+((-1536*t748+1
     #536*(t650+t155)*t3*t120)*s2l1+(4608*t488-26112*t493)*s34r+1536*t1*
     #(1-t224)*t3*t498+1536*(-t770-2*t1*t566)*z*t948)*s23r+(1536*t756-15
     #36*t512*t842)*s2l1+(-7680*t499+16896*t503)*s34r+1536*(-t1*(-t598+1
     #)+t45)*t2*t563+1536*(t1*t196-t45)*z*t842)*t29
      s4 = s3
      s6 = (1536*(t1+t310)*z*t48*t724*t392+(-1536*t1*(t105-2)*t3*t207+15
     #36*(t195-t478)*z*t357*t491*t85+1536*t106*t3*t498-1536*(-t1*(1-t598
     #-t105)+2*t1*(t105+t152))*z*t948)*t140+((1536*t1004*t119*t501*t85-1
     #536*(-t1*(t854-2-t307)+2*t1*(2*z-2*t105))*t2*t28)*s2l1+12288*t490*
     #t522*t473+(-1536*t1*(-t307-2)*t119*t501*t247-1536*(11*t16+2*t1*(1+
     #t528))*z*t6*t374)*s34r+1536*t1*(-t307+2-t105)*t2*t563+1536*(-t1*(3
     #-t854-t224)+2*t1*(t854+t42-1))*z*t842)*s23r+(3072*t807-1536*t1004*
     #t6*t851+1536*(-t1*(-3+t42)+4*t1*t276)*z*t11)*s2l1+(3072*t212-12288
     #*t216)*t419+(-29184*t441*t631+1536*(-t1*(-t598+3)+10*t16)*z*t6*t38
     #7)*s34r-1536*t537*t247+4608*t1*t1088*z*t11)*s1vr
      s7 = 1536*t700*t3*t829
      s5 = s6+s7
      s2 = s4+s5
      taux18 = s2+(1536*t1103*t838-3072*t700*t842)*t140+(12288*t690*t848
     #-3072*t1103*t851+1536*(t105+3*t105*z)*t1*t11)*s23r-24576*t341*t134
     #*t473+1536*(2*t681*t105-3*t681*t105*t832)*t1*t85

CCC Coefficients

      tcoff33 = taux17
      tcoff34 = taux17
      tcoff35 = taux18
      tcoff36 = taux18

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet33 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff33)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = 1-l3
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet34 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff34)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet35 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff35)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = 1-l3
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet36 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff36)

CCC Sum

      qgrmnum10e1 = tFjet33*tcoff33+tFjet34*tcoff34+tFjet35*tcoff35+tFje
     #t36*tcoff36
      RETURN
      END

      double precision function qgrmnum10e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = s23r2(z,l1,l2,l3,l4)
      t2 = t1*z
      t3 = l3-1
      t4 = t3**2
      t5 = t4**2
      t7 = -1+z
      t8 = t7**2
      t9 = t8**2
      t10 = s4vr**2
      t11 = 1/t10
      t13 = s13r**2
      t14 = t13**2
      t19 = t4*t3
      t20 = l3*t19
      t21 = t20*t9
      t22 = s1vr**2
      t27 = t11*s23r
      t31 = t8*t7
      t34 = z*t11*t1
      t39 = z**2
      t40 = t1*t39
      t41 = t40*t31
      t42 = t19*t11
      t49 = t4*t9
      t50 = t49*z
      t51 = l3**2
      t52 = t51*t1
      t53 = t22*s1vr
      t58 = t2*t4
      t62 = t31*l3
      t68 = s23r**2
      t69 = t11*t68
      t73 = 4*z
      t78 = t31*t4
      t82 = t11*s34r
      t83 = t2*t82
      t86 = 2*z
      t96 = t40*t4
      t100 = t8*t11
      t109 = t51*l3
      t110 = t2*t109
      t111 = t9*t3
      t116 = t3*t31*t51
      t126 = z*t3
      t128 = t31*t51
      t133 = t50*t52*t82
      t141 = t3*t8*l3*t11
      t146 = t68*s23r
      t147 = t11*t146
      t166 = t9*t7
      t169 = s34r**2
      t170 = t11*t169
      t181 = t7*t3
      t187 = t40*t3
      t191 = l3*t8
      t214 = t51*t8
      t215 = t214*t34
      t221 = 768*t111*t109*t83
      t232 = t7*l3
      t233 = t232*t34
      t239 = t1*t11
      t251 = t187*t128*t82
      t257 = t49*t170
      t263 = t191*t82
      s2 = 768*t2*t5*t9*t11*s1vr*t14+(-1536*t21*t2*t11*t22+(-2304*t21*t2
     #*t27+1920*t19*t31*t34)*s1vr-768*t41*t42*s23r)*t13*s13r+(768*t50*t5
     #2*t11*t53+(3072*t58*t9*t51*t27-3072*t58*t62*t11)*t22+(2304*t50*t52
     #*t69+384*t1*(t73-9)*z*l3*t78*t27+768*t21*t83-384*t1*(-5+t86)*z*t4*
     #t8*t11)*s1vr+1536*t96*t62*t69-1152*t96*t100*s23r+768*t41*t42*s34r)
     #*t13
      s1 = s2+((-768*t110*t111*t27+384*t116*t34)*t53+(-1536*t110*t111*t6
     #9-384*t1*(t86-8)*t126*t128*t27+768*t133-384*t1*(2+2*z)*z*t141)*t22
     #+(-768*t110*t111*t147-384*t1*(-3+t73)*t126*t128*t69+(-1536*t133+38
     #4*t1*(-4+6*z)*z*t141)*s23r-768*t2*t166*t19*t51*t170+2304*t40*l3*t7
     #8*t82-384*t1*(-1+t86)*z*t181*t11)*s1vr-768*t187*t128*t147+768*t187
     #*t191*t69-1536*t40*t62*t4*t11*s34r*s23r-1536*t40*t9*t20*t170+1536*
     #t96*t100*s34r)*s13r+(384*t2*t31*t109*t11*s23r-384*t215)*t53+((-t22
     #1+384*t1*(z-2)*z*t214*t11)*s23r+768*t116*t83+768*t233)*t22
      taux17 = s1+(384*t109*t31*z*t239*t146+(t221-384*t215)*t68+(768*t11
     #0*t166*t4*t170-768*t251+384*t233)*s23r-768*t52*z*t257+768*t1*t7*t1
     #26*t263-384*t34)*s1vr+384*t40*t8*t51*t11*t146+(768*t251-768*t40*t2
     #32*t11)*t68+(768*t40*t51*t257-1536*t187*t263+384*t40*t11)*s23r-153
     #6*t96*t62*t170+768*t181*t39*t239*s34r
      t1 = s23r2(z,l1,l2,l3,l4)
      t2 = -1+z
      t3 = t2**2
      t4 = t3**2
      t5 = t1*t4
      t6 = l3-1
      t7 = t6**2
      t8 = t7**2
      t10 = s4vr**2
      t11 = 1/t10
      t16 = t1*z
      t17 = t16*t8
      t23 = s13r**2
      t24 = t23**2
      t26 = t7*t6
      t27 = t5*t26
      t28 = l3*t11
      t29 = s1vr**2
      t37 = t2*t4
      t39 = t28*s34r
      t42 = 10*t1
      t43 = 2*z
      t45 = t1*(-5+t43)
      t49 = t3*t2
      t50 = t49*t11
      t55 = t16*t49
      t56 = t26*t11
      t57 = t56*s23r
      t62 = t1*t11
      t63 = t62*s34r
      t71 = l3*t26
      t72 = t71*t4
      t73 = t62*s3l1
      t76 = t16*t11
      t89 = t11*s34r
      t93 = t56*s3l1
      t108 = z**2
      t109 = t1*t108
      t113 = t109*t4
      t121 = t5*t7
      t122 = l3**2
      t123 = t122*t11
      t124 = t29*s1vr
      t131 = t1*t122
      t132 = t131*t37
      t134 = t132*t56*s34r
      t135 = 3072*t134
      t137 = t49*l3
      t138 = t137*t11
      t143 = s23r**2
      t148 = 8*z
      t160 = 4*t1
      t161 = 4*z
      t162 = -1-t161
      t164 = 2*t1*t162
      t172 = 10*z
      t173 = 4*t108
      t179 = t3*t11
      t184 = t16*t7
      t185 = t11*t143
      t186 = t137*t185
      t189 = t16*t89
      t193 = -4+z
      t196 = -9*t1+2*t1*t193
      t198 = t7*t3
      t199 = t11*t198
      t204 = 6*t1
      t205 = 1-t43
      t208 = -t204+2*t1*t205
      t211 = t50*s34r
      t216 = t123*s2l1
      t217 = t121*t216
      t219 = t7*t4
      t220 = t219*t122
      t221 = t220*t73
      t223 = t219*z
      t225 = t223*t131*t11
      t234 = 5*z
      t240 = t49*t7
      t241 = t240*t11
      t246 = t132*t93
      t250 = t16*t37*t26*t122*t11
      t254 = -5-z
      t260 = t28*s3l1
      t277 = t11*s2l1
      t285 = t11*s3l1
      t287 = t184*t137*t285
      t309 = 2*t2*t1
      t310 = 2*t108
      t321 = t16*t285
      t324 = 3*z
      t326 = t1*(1-t324)
      t351 = t109*t7
      t368 = t122*l3
      t369 = t1*t368
      t370 = t369*t4
      t371 = t6*t11
      t375 = t1*t6
      t376 = t49*t122
      t377 = t376*t11
      t385 = t369*t37
      t386 = t7*t11
      t387 = t386*s34r
      t388 = t385*t387
      t401 = t220*t63
      t403 = z+1
      t411 = l3*t3
      t412 = t411*t11
      t417 = t143*s23r
      t421 = 3072*t388
      t426 = t49*t6
      t439 = 6*z
      t441 = t1*(-4+t439)
      t451 = s34r**2
      t453 = t132*t56*t451
      t466 = t1*(-2+t161)
      t472 = t2*t11
      t477 = t16*t6
      t478 = t11*t417
      t479 = t376*t478
      t484 = 3*t1
      t486 = t1*(z-2)
      t488 = -t484+2*t486
      t495 = 2*t16
      t496 = -t484-t495
      t497 = t496*z
      t499 = t240*t89
      t507 = t16*t4
      t508 = t11*t451
      t509 = t71*t508
      t513 = -12*t1+t164
      t516 = t179*s34r
      t523 = 6144*t370*t371*s2l1
      t524 = t371*s3l1
      t525 = t370*t524
      t527 = t16*t368
      t528 = t4*t6
      t530 = t527*t528*t11
      t534 = t375*t49
      t537 = t123*s3l1
      t538 = t534*t537
      t540 = t426*t122
      t541 = t540*t76
      t545 = 12288*t525
      t552 = -t1*t403
      t563 = t37*t7
      t569 = 4*t2
      t570 = t1*t569
      t571 = 9*z
      t584 = 2*t1*(2-t324)
      t596 = -2*t16+2*t1*(-t439+1)
      t606 = t2*t1
      t617 = 2*t1*t403
      t657 = t123*s34r
      t659 = 7*z
      t689 = t411*t285
      t731 = t1*t3
      t740 = -t1*t205
      t744 = t2*t6
      t750 = t109*t6
      t753 = t109*t122
      t762 = t496*t108
      t779 = t122**2
      t780 = t779*t11
      t784 = t1*t49
      t785 = t368*t11
      t793 = t780*t417
      t803 = t49*t368*t11
      t808 = t371*s34r
      t809 = t370*t808
      t812 = t1*(t43-4)
      t820 = t534*t657
      t833 = t785*t417
      t838 = 2*t1*(-3-t439)
      t852 = t386*t451
      t874 = t131*t4*t852
      t894 = t123*t417
      t897 = -1-t43
      t900 = -t204+2*t1*t897
      t902 = t900*z*t6
      t903 = t376*t89
      t907 = t2*l3*t11
      t913 = t219*t508
      t916 = t411*t89
      t950 = t785*s2l1
      t953 = t785*s3l1
      t960 = t122*t3
      t1010 = t960*t11
      t1075 = -t812-2*t1*t193
      t1079 = 3*t108
      t1165 = t900*t108*t6
      s3 = (-12288*t5*t8*t11*s1vr*s1l1+3072*t17*t4*t11*s1vr)*t24
      s5 = ((21504*t27*t28*t29+(36864*t27*t28*s23r+3072*t1*t8*t37*t39+15
     #36*(-t42+2*t45)*t26*t50)*s1vr+30720*t55*t57+6144*t8*t4*z*t63)*s1l1
     #+(6144*t27*t28*s2l1+12288*t72*t73+9216*t72*t76)*t29+(9216*t72*t16*
     #t11*s23r+12288*t55*t56*s2l1+3072*t17*t37*l3*t89+18432*t55*t93+1536
     #*(-5*t1+2*t1*(-z+5))*z*t26*t49*t11)*s1vr+15360*t109*t49*t57+3072*t
     #113*t8*t11*s34r)*t23*s13r
      s8 = (-9216*t121*t123*t124+(-46080*t121*t123*s23r-t135+49152*t1*t7
     #*t138)*t29+(-36864*t121*t123*t143+(-6144*t134+1536*(-t1*(t148-18)+
     #2*t1*(z+10))*t7*t138)*s23r+1536*(-t160+t164)*t4*t26*t39-1536*(-t1*
     #(-10+t161)+2*t1*(7-t172+t173))*t7*t179)*s1vr-61440*t184*t186+(-122
     #88*t72*t189-3072*t196*z*t199)*s23r+3072*t208*z*t26*t211)*s1l1+(-92
     #16*t217-15360*t221-12288*t225)*t124+((-12288*t217-24576*t221-3072*
     #t225)*s23r+(t135-1536*(-t160+2*t1*(3-t234))*l3*t241)*s2l1+(3072*t2
     #46-3072*t250)*s34r-1536*(-t204+2*t1*t254)*t7*t49*t260-1536*(-8*t1+
     #2*t1*(-3+z))*z*l3*t241)*t29
      s7 = s8+(-27648*t223*t131*t185+(-18432*t184*t137*t277-6144*t26*t37
     #*t122*t189-30720*t287+1536*(-t1*(t161-9)-2*t1*t162)*z*l3*t241)*s23
     #r+(-1536*(-t160+2*t1*(-z-4))*t4*t26*t39-1536*(-t309+2*t1*(t310+2-1
     #1*z))*t7*t179)*s2l1+(3072*t72*t321+1536*(-2*t1+2*t326)*z*t4*t71*t1
     #1)*s34r-3072*t1*(t161-11)*z*t198*t285-1536*(-t45+2*t1*(t310-3-t43)
     #)*z*t199)*s1vr-30720*t351*t186+(-6144*t113*t71*t89-1536*t196*t108*
     #t199)*s23r+1536*t208*t108*t26*t211
      s8 = t23
      s6 = s7*s8
      s4 = s5+s6
      s2 = s3+s4
      s4 = s2
      s9 = ((6144*t370*t371*s23r-3072*t375*t377)*t124+(27648*t370*t371*t
     #143+(9216*t388-1536*(-t1*(t161-16)+2*t1*(-t234+11))*t6*t377)*s23r-
     #24576*t401-1536*(-4*t1*t403+2*t1*(-3-t172))*t6*t412)*t29+(12288*t3
     #70*t371*t417+(t421-1536*(-t1*(-6+t148)+t42)*t122*t426*t11)*t143+(-
     #3072*(-t160+2*t1*(-t234-2))*t122*t4*t387+3072*(-t441+2*t1*(-t439+t
     #108+5))*t6*t412)*s23r+18432*t453+1536*(-12*t16+2*t1*(-32*z+3))*l3*
     #t49*t387-1536*(-t466+2*t1*(3-t439))*t6*t472)*s1vr+30720*t477*t479+
     #(6144*t223*t131*t89+6144*t488*z*t6*t412)*t143+(-12288*t497*l3*t499
     #-12288*t16*t6*t3*t11)*s23r+61440*t507*t509+3072*t513*z*t7*t516)*s1
     #l1
      s10 = ((t523+18432*t525+9216*t530)*s23r-3072*t534*t216-33792*t538-
     #4608*t541)*t124
      s8 = s9+s10
      s9 = s8
      s11 = ((t523+t545-3072*t530)*t143+((-t421-1536*(-t1*(-6+t161)+2*t5
     #52)*t6*t377)*s2l1+(-3072*t385*t386*s3l1+9216*t527*t563*t11)*s34r-1
     #536*(-t570+2*t1*(-t571+5))*t6*t49*t537-1536*(-t1*(t43-8)+t584)*z*t
     #6*t377)*s23r+(6144*t401-3072*t596*t6*t412)*s2l1+(33792*t221-21504*
     #t225)*s34r+3072*(-t606-6*t2*t1)*t6*t3*t260-1536*(-t617+2*t1*(-1-t2
     #34))*z*t6*t412)*t29
      s12 = (15360*t527*t528*t478+(6144*t540*t16*t277+3072*t527*t563*t89
     #+12288*t540*t321-1536*(-t1*(-3+t161)-2*t1*t254)*z*t6*t377)*t143+((
     #1536*(-2*t1+2*t1*(-2-z))*t4*t7*t657+1536*(-t441+2*t1*(-t659+4+t108
     #))*t6*t412)*s2l1+(-3072*t223*t131*t285-1536*(-t160+2*t1*(-t659-2))
     #*t122*z*t219*t11)*s34r+1536*(-2*t1+2*t1*(-7+t234))*z*t6*t689+1536*
     #(-t441+2*t1*(4-t234+t108))*z*t6*t412)*s23r+(-9216*t453+3072*(-t1*(
     #-4+t324)-2*t1*t569)*l3*t49*t387-3072*(-3*t606-t495)*t6*t472)*s2l1+
     #(-9216*t246+15360*t250)*t451+(15360*t287+4608*t596*z*l3*t241)*s34r
     #+3072*(-3*t731-4*t16*t3)*t6*t285-1536*(-t740+2*t326)*z*t744*t11)*s
     #1vr
      s10 = s11+s12
      s7 = s9+s10
      s6 = s7+15360*t750*t479+(3072*t753*t219*t89+3072*t488*t108*t6*t412
     #)*t143+(-6144*t762*l3*t499-6144*t731*t108*t6*t11)*s23r+30720*t113*
     #t509+1536*t513*t108*t7*t516
      s7 = s13r
      s5 = s6*s7
      s3 = s4+s5
      s4 = s3
      s8 = (3072*t5*t780*t143-9216*t784*t785*s23r+6144*t731*t123)*t124+(
     #-3072*t5*t793+(-6144*t375*t37*t780*s34r+9216*t1*t403*t803)*t143+(2
     #7648*t809+1536*(-t812-18*t16)*t3*t123)*s23r-21504*t820+3072*(-2*t1
     #+2*t606)*t2*t28)*t29+(1536*(-2*t1-6*t16)*t49*t833+(1536*(-t160+t83
     #8)*t368*t4*t808-1536*(-2*t1+2*t1*(3-t310-t172))*t3*t123)*t143+(-18
     #432*t385*t852-3072*(-2*t16+2*t1*(-t571+1))*t6*t49*t657+1536*(-2*t1
     #+2*t1*(-6*t108-t234+2))*t2*t28)*s23r+18432*t874+1536*(-t570+2*t1*(
     #-12*z+5))*t6*t3*t39-1536*(-2*t1+2*t1*(-t173+t43-1))*t11)*s1vr+3072
     #*t497*t3*t894
      s7 = s8+(3072*t902*t903-6144*t497*t907)*t143+(-30720*t131*z*t913-6
     #144*t902*t916+3072*(-t324-t310)*t1*t11)*s23r+61440*t240*l3*t16*t50
     #8+3072*(-6*t744*z+2*t744*z*t897)*t1*t89
      s8 = s1l1
      s6 = s7*s8
      s7 = ((3072*t5*t780*s2l1-3072*t5*t780*s3l1+3072*t16*t4*t779*t11)*t
     #143+(-9216*t784*t950+12288*t784*t953-10752*t16*t803)*s23r+6144*t96
     #0*t62*s2l1-9216*t960*t73+7680*t960*t76)*t124
      s5 = s6+s7
      s1 = s4+s5
      s3 = s1+(-3072*t507*t793+(6144*t55*t950-6144*t6*t37*t779*t189+3072
     #*(-t1-t495)*t49*t953+3072*t1*(5+t43)*z*t803)*t143+((6144*t809+1536
     #*(-4*t606-8*t16)*t3*t123)*s2l1+(-t545+24576*t530)*s34r-1536*(-t160
     #+2*t1*(1-t234))*t3*t537+1536*(-t486+t838)*z*t1010)*s23r+(-6144*t82
     #0+1536*(-2*t1+2*t552)*t2*t28)*s2l1+(21504*t538-18432*t541)*s34r+15
     #36*(-t617+2*t1*(-t659+1))*t2*t260+1536*(-2*t1+2*t740)*z*t907)*t29
      s2 = s3+(1536*(-t484-4*t16)*z*t49*t833+(1536*(-2*t1+2*t1*(t108-2))
     #*t3*t216+1536*(-t204+t164)*z*t368*t528*t89+1536*(-2*t1-2*t16)*z*t3
     #*t537-1536*(-t1+2*t1*(1-t659-t108))*z*t1010)*t143+((-1536*t1075*t1
     #22*t49*t808-1536*(-2*t1+2*t1*(t1079-2-t324))*t2*t28)*s2l1-15360*t5
     #27*t563*t508+(1536*(-t617+2*t1*(-t324-2))*t122*t49*t524+36864*t750
     #*t377)*s34r-1536*(-t466+2*t1*(-t324+2-t108))*t2*t260+1536*(-t1+2*t
     #1*(3-t1079-t234))*z*t907)*s23r+(-9216*t874+1536*t1075*t6*t3*t39+30
     #72*t1*(-3+t43)*z*t11)*s2l1+(-9216*t221+15360*t225)*t451+(43008*t47
     #7*t689+1536*(-t309+2*t1*(-t659+3))*z*t6*t412)*s34r+1536*(-t309+t58
     #4)*t11*s3l1-1536*(-t1+2*t1*(-t310+1))*z*t11)*s1vr+1536*t762*t3*t89
     #4
      taux18 = s2+(1536*t1165*t903-3072*t762*t907)*t143+(-15360*t753*t91
     #3-3072*t1165*t916+1536*(-t1079-2*t108*z)*t1*t11)*s23r+30720*t351*t
     #137*t508+1536*(-6*t744*t108+2*t744*t108*t897)*t1*t89

CCC Coefficients

      tcoff33 = taux17
      tcoff34 = taux17
      tcoff35 = taux18
      tcoff36 = taux18

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet33 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff33)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = 1-l3
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet34 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff34)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet35 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff35)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = 1-l3
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet36 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff36)

CCC Sum

      qgrmnum10e2 = tFjet33*tcoff33+tFjet34*tcoff34+tFjet35*tcoff35+tFje
     #t36*tcoff36
      RETURN
      END

      double precision function qgrmnum10e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux17 = 0
      t1 = s23r2(z,l1,l2,l3,l4)
      t2 = -1+z
      t3 = t2**2
      t4 = t3**2
      t5 = t1*t4
      t6 = l3-1
      t7 = t6**2
      t8 = t7**2
      t10 = s4vr**2
      t11 = 1/t10
      t16 = t1*z
      t23 = s13r**2
      t24 = t23**2
      t26 = t7*t6
      t27 = t5*t26
      t28 = l3*t11
      t29 = s1vr**2
      t37 = t3*t2
      t38 = t37*t11
      t44 = t26*t11
      t45 = t44*s23r
      t52 = l3*t26
      t53 = t52*t4
      t54 = t1*t11
      t55 = t54*s3l1
      t58 = z*t11*t1
      t63 = t11*s23r
      t67 = t26*t37
      t72 = z**2
      t73 = t1*t72
      t74 = t73*t37
      t80 = t5*t7
      t81 = l3**2
      t82 = t81*t11
      t83 = t29*s1vr
      t90 = t37*l3
      t91 = t90*t11
      t96 = s23r**2
      t100 = 8*z
      t107 = t54*s34r
      t109 = 12288*t53*t107
      t110 = 4*z
      t114 = t7*t3*t11
      t119 = t16*t7
      t120 = t11*t96
      t121 = t90*t120
      t124 = t3*t11
      t125 = t124*s23r
      t133 = t82*s2l1
      t134 = t80*t133
      t136 = t7*t4
      t137 = t136*t81
      t138 = t137*t55
      t140 = t136*z
      t141 = t81*t1
      t143 = t140*t141*t11
      t144 = 6144*t143
      t150 = t7*t37
      t151 = t150*l3
      t152 = t54*s2l1
      t164 = t11*s2l1
      t168 = t11*s3l1
      t170 = t119*t90*t168
      t175 = t7*t11
      t182 = 2*t1*t2
      t187 = t11*s34r
      t188 = t16*t187
      t191 = 2*z
      t199 = t73*t7
      t209 = t81*l3
      t210 = t1*t209
      t211 = t210*t4
      t212 = t6*t11
      t216 = t1*t6
      t217 = t37*t81
      t218 = t217*t11
      t232 = t137*t107
      t234 = z+1
      t238 = t3*l3
      t239 = t238*t11
      t244 = t96*s23r
      t251 = t37*t6
      t258 = t1*(-4+6*z)
      t260 = t258*t6*t239
      t264 = t4*t2
      t265 = t141*t264
      t266 = s34r**2
      t268 = t265*t44*t266
      t274 = t1*(-2+t110)
      t275 = t6*t2
      t276 = t275*t11
      t281 = t16*t6
      t282 = t11*t244
      t283 = t217*t282
      t286 = t238*t120
      t290 = s34r*s23r
      t295 = t11*t266
      t296 = t52*t295
      t299 = t124*s34r
      t305 = t211*t212*s2l1
      t308 = t211*t212*s3l1
      t310 = t16*t209
      t311 = t4*t6
      t313 = t310*t311*t11
      t317 = t216*t37
      t321 = t317*t82*s3l1
      t323 = t251*t81
      t324 = t323*t58
      t338 = 4*t1*t2*t6
      t344 = t251*t82
      t355 = t28*s3l1
      t359 = 2*t1*t234
      t362 = t6*t3*t28
      t391 = t281*t238*t168
      t432 = t73*t6
      t448 = t1*t37
      t449 = t209*t11
      t453 = t1*t3*t82
      t458 = t211*t212*s34r
      t459 = 12288*t458
      t461 = t1*(t191-4)
      t462 = t3*t81
      t463 = t462*t11
      t469 = t317*t82*s34r
      t472 = t1*t2*t28
      t483 = t175*t266
      t486 = t323*t188
      t488 = 6144*t472
      t492 = t141*t4*t483
      t494 = t238*t187
      t501 = t82*t244
      t504 = l3*t2
      t505 = t504*t58
      t510 = t136*t295
      t529 = t37*t209
      t536 = 6144*t462*t152
      t538 = 3072*t462*t58
      s3 = (12288*t5*t8*t11*s1vr*s1l1+6144*t16*t8*t4*t11*s1vr)*t24
      s5 = ((-24576*t27*t28*t29+(-36864*t27*t28*s23r+30720*t1*t26*t38)*s
     #1vr-12288*t16*t37*t45)*s1l1+(-12288*t27*t28*s2l1-12288*t53*t55-122
     #88*t53*t58)*t29+(-18432*t53*t16*t63+15360*t67*t58)*s1vr-6144*t74*t
     #45)*t23*s13r
      s6 = ((12288*t80*t82*t83+(49152*t80*t82*s23r-49152*t1*t7*t91)*t29+
     #(36864*t80*t82*t96+3072*t1*(t100-18)*t7*t90*t63+t109-3072*t1*(-10+
     #t110)*t114)*s1vr+24576*t119*t121-18432*t119*t125+12288*t67*z*t107)
     #*s1l1+(12288*t134+12288*t138+t144)*t83+((24576*t134+24576*t138+245
     #76*t143)*s23r-12288*t151*t152-18432*t151*t55-24576*t119*t91)*t29+(
     #18432*t140*t141*t120+(12288*t119*t90*t164+12288*t170+3072*t1*(t110
     #-9)*z*t90*t175)*s23r+(-t109-3072*t182*t114)*s2l1+6144*t53*t188-307
     #2*t1*(-5+t191)*z*t114)*s1vr+12288*t199*t121-9216*t199*t125+6144*t7
     #4*t44*s34r)*t23
      s4 = s5+s6
      s2 = s3+s4
      s4 = s2
      s8 = ((-12288*t211*t212*s23r+6144*t216*t218)*t83+(-24576*t211*t212
     #*t96-3072*t1*(t110-16)*t6*t217*t63+12288*t232-12288*t1*t234*t6*t23
     #9)*t29+(-12288*t211*t212*t244-3072*t1*(-6+t100)*t81*t251*t120+(-24
     #576*t232+6144*t260)*s23r-12288*t268+36864*t119*t90*t187-3072*t274*
     #t276)*s1vr-12288*t281*t283+12288*t281*t286-24576*t16*t150*t28*t290
     #-24576*t16*t4*t296+24576*t119*t299)*s1l1+((-12288*t305-12288*t308-
     #6144*t313)*s23r+6144*t317*t133+18432*t321+3072*t324)*t83
      s7 = s8+((-12288*t305-12288*t308-12288*t313)*t96+(-3072*t1*(-6+t11
     #0)*t6*t217*t164-3072*t338*t217*t168-3072*t1*(t191-8)*z*t344)*s23r-
     #12288*t281*t238*t164+(-18432*t138+t144)*s34r+6144*t317*t355-3072*t
     #359*z*t362)*t29+(-6144*t310*t311*t282+(-12288*t323*t16*t164-12288*
     #t323*t16*t168-3072*t1*(-3+t110)*z*t344)*t96+((6144*t232+3072*t260)
     #*s2l1-12288*t140*t141*t187+6144*t391+3072*t258*z*t362)*s23r+(6144*
     #t268+6144*t1*(-4+3*z)*l3*t150*t187-6144*t216*t124)*s2l1+(6144*t265
     #*t44*s3l1-6144*t16*t264*t26*t81*t11)*t266+(-6144*t170+18432*t199*t
     #91)*s34r+6144*t216*t124*s3l1-3072*t1*(-1+t191)*z*t276)*s1vr
      s6 = s7-6144*t432*t283+6144*t432*t286-12288*t73*t90*t175*t290-1228
     #8*t73*t4*t296+12288*t199*t299
      s7 = s13r
      s5 = s6*s7
      s3 = s4+s5
      s1 = s3+((6144*t448*t449*s23r-6144*t453)*t83+((-t459+3072*t461*t46
     #3)*s23r+12288*t469+12288*t472)*t29+(6144*t448*t449*t244+(t459-6144
     #*t453)*t96+(12288*t210*t264*t483-12288*t486+t488)*s23r-12288*t492+
     #3072*t338*t494-6144*t54)*s1vr+6144*t16*t3*t501+(12288*t486-12288*t
     #505)*t96+(12288*t141*z*t510-24576*t281*t494+6144*t58)*s23r-24576*t
     #151*t16*t295+12288*t275*z*t107)*s1l1+((6144*t448*t449*s2l1+3072*t1
     #6*t529*t11)*s23r-t536-t538)*t83
      s2 = s1+(6144*t448*t209*t168*t96+((-6144*t458+6144*t141*t38)*s2l1+
     #(6144*t308-6144*t313)*s34r-12288*t462*t55+3072*t1*(z-2)*z*t463)*s2
     #3r+(6144*t469+6144*t472)*s2l1+(-12288*t321+6144*t324)*s34r+3072*t3
     #59*t2*t355+6144*t505)*t29+(3072*t529*z*t54*t244+(t536+6144*t311*t2
     #09*t188+6144*t462*z*t55-t538)*t96+((-3072*t461*t81*t251*t187-t488)
     #*s2l1+6144*t310*t264*t7*t295+(3072*t359*t81*t251*t168-6144*t432*t2
     #18)*s34r-3072*t274*t2*t355+3072*t505)*s23r+(6144*t492+3072*t461*t6
     #*t494)*s2l1+(6144*t138-6144*t143)*t266+(-18432*t391+3072*t182*z*t3
     #62)*s34r+3072*t182*t168-3072*t58)*s1vr+3072*t73*t3*t501
      taux18 = s2+(6144*t432*t217*t187-6144*t73*t504*t11)*t96+(6144*t73*
     #t81*t510-12288*t432*t494+3072*t73*t11)*s23r-12288*t199*t90*t295+61
     #44*t275*t72*t107

CCC Coefficients

      tcoff33 = taux17
      tcoff34 = taux17
      tcoff35 = taux18
      tcoff36 = taux18

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet33 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff33)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = 1-l3
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet34 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff34)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet35 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff35)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = 1-l3
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet36 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff36)

CCC Sum

      qgrmnum10e3 = tFjet33*tcoff33+tFjet34*tcoff34+tFjet35*tcoff35+tFje
     #t36*tcoff36
      RETURN
      END

      double precision function qgrmnum10e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux17 = 0
      taux18 = 0

CCC Coefficients

      tcoff33 = taux17
      tcoff34 = taux17
      tcoff35 = taux18
      tcoff36 = taux18

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet33 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff33)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = 1-l3
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet34 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff34)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet35 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff35)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = 1-l3
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet36 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff36)

CCC Sum

      qgrmnum10e4 = tFjet33*tcoff33+tFjet34*tcoff34+tFjet35*tcoff35+tFje
     #t36*tcoff36
      RETURN
      END

      double precision function qgrmnum11e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t3 = s1l1**2
      t5 = z**2
      t7 = r*t
      t8 = -1+t7
      t9 = t8**2
      t11 = r**2
      t12 = 1/t11
      t14 = t11*r
      t15 = t14*t
      t16 = l1**2
      t17 = dsqrt(l2)
      t18 = t16*t17
      t20 = t**2
      t21 = t11*t20
      t25 = l1*t17
      t26 = t11**2
      t32 = t17*t14
      t34 = t17*t11
      t36 = t17*r
      t43 = (1+t11)**2
      t46 = t11*l1
      t47 = t46*t
      t49 = l1*r
      t51 = l1*t
      t55 = dsqrt(-l1*(-1+l1)*(1-l2)*t43*r*(t11*t+t47+r+r*t20-t49-t49*t2
     #0+t+t51))
      t59 = t15*t18-t18*t21-t18*t11+t7*t18+t25*t26+2*t25*t21+4*t25*t11+t
     #25-t32*t-t34*t20-t34-t36*t+2*t55-4*t55*l4
      t60 = t59**2
      t61 = r+t
      t62 = t61**2
      t65 = 1/t43
      t78 = l1*l2
      t82 = l2*t11
      t90 = l2*t16
      t95 = t55*t17
      t99 = -l1-2*t46-l1*t26+t78+4*t78*t11+t78*t26-t82-l2*t14*t-l2*r*t-t
     #82*t20+2*t78*t21-t90*t11+t90*t15+t90*t7-t90*t21-4*t95*l4+2*t95
      t105 = dsqrt((r-t)*s1l1*s2l1*t99*t8/r*t65)
      t109 = t17*s1l1
      t116 = s1l1*l1
      t121 = -t32*s1l1-2*t14*t105*c3l1+t109*t47+t36*s1l1*t20-2*t105*c3l1
     #*r-t36*t116-t36*t116*t20+t109*t51
      t130 = s1vr**2
      t131 = t121**2
      t137 = s4vr**2
      taux19 = (-768*(2*z*s1l1+2*t3+t5)*t9*t12*t60/t62*t65+1536*s1vr*(z+
     #2*s1l1)*t121*t65*t12*t8*t59/t61-1536*t130*t131*t65*t12)/t137
      t1 = z**2
      t5 = r*t
      t6 = -1+t5
      t7 = t6**2
      t9 = r**2
      t10 = 1/t9
      t12 = t9*r
      t13 = t12*t
      t14 = l1**2
      t15 = dsqrt(l2)
      t16 = t14*t15
      t18 = t**2
      t19 = t9*t18
      t23 = l1*t15
      t24 = t9**2
      t30 = t15*t12
      t32 = t15*t9
      t34 = t15*r
      t41 = (1+t9)**2
      t44 = t9*l1
      t45 = t44*t
      t47 = l1*r
      t49 = l1*t
      t53 = dsqrt(-l1*(-1+l1)*(1-l2)*t41*r*(t9*t+t45+r+r*t18-t47-t47*t18
     #+t+t49))
      t57 = t13*t16-t16*t19-t16*t9+t5*t16+t23*t24+2*t23*t19+4*t23*t9+t23
     #-t30*t-t32*t18-t32-t34*t+2*t53-4*t53*l4
      t58 = t57**2
      t59 = r+t
      t60 = t59**2
      t63 = 1/t41
      t78 = l1*l2
      t82 = l2*t9
      t90 = l2*t14
      t95 = t53*t15
      t99 = -l1-2*t44-l1*t24+t78+4*t78*t9+t78*t24-t82-l2*t12*t-l2*r*t-t8
     #2*t18+2*t78*t19-t90*t9+t90*t13+t90*t5-t90*t19-4*t95*l4+2*t95
      t105 = dsqrt((r-t)*s1l1*s2l1*t99*t6/r*t63)
      t109 = t15*s1l1
      t116 = s1l1*l1
      t127 = s4vr**2
      taux20 = (3072*(t1+2*z*s1l1)*t7*t10*t58/t60*t63-6144*s1vr*t6*t10*t
     #57/t59*t63*z*(-t30*s1l1-2*t12*t105*c3l1+t109*t45+t34*s1l1*t18-2*t1
     #05*c3l1*r-t34*t116-t34*t116*t18+t109*t49))/t127

CCC Coefficients

      tcoff37 = taux19
      tcoff38 = taux19
      tcoff39 = taux20
      tcoff40 = taux20

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet37 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff37)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = 1-l3
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet38 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff38)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet39 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff39)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = 1-l3
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet40 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff40)

CCC Sum

      qgrmnum11e0 = tFjet37*tcoff37+tFjet38*tcoff38+tFjet39*tcoff39+tFje
     #t40*tcoff40
      RETURN
      END

      double precision function qgrmnum11e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = z**2
      t3 = s1l1**2
      t6 = r*t
      t7 = -1+t6
      t8 = t7**2
      t10 = r**2
      t11 = 1/t10
      t13 = t10*r
      t14 = t13*t
      t15 = l1**2
      t16 = dsqrt(l2)
      t17 = t15*t16
      t19 = t**2
      t20 = t10*t19
      t24 = l1*t16
      t25 = t10**2
      t31 = t13*t16
      t33 = t16*t10
      t35 = t16*r
      t42 = (1+t10)**2
      t45 = t10*l1
      t46 = t45*t
      t48 = l1*r
      t50 = l1*t
      t54 = dsqrt(-l1*(-1+l1)*(1-l2)*t42*r*(t10*t+t46+r+r*t19-t48-t48*t1
     #9+t+t50))
      t58 = t17*t14-t17*t20-t17*t10+t6*t17+t24*t25+2*t24*t20+4*t24*t10+t
     #24-t31*t-t33*t19-t33-t35*t+2*t54-4*t54*l4
      t59 = t58**2
      t60 = r+t
      t61 = t60**2
      t64 = 1/t42
      t77 = l1*l2
      t81 = l2*t10
      t89 = l2*t15
      t94 = t54*t16
      t98 = -l1-2*t45-l1*t25+t77+4*t77*t10+t77*t25-t81-l2*t13*t-l2*r*t-t
     #81*t19+2*t77*t20-t89*t10+t89*t14+t89*t6-t89*t20-4*t94*l4+2*t94
      t104 = dsqrt((r-t)*s1l1*s2l1*t98*t7/r*t64)
      t108 = t16*s1l1
      t115 = s1l1*l1
      t120 = -t31*s1l1-2*t13*t104*c3l1+t108*t46+t35*s1l1*t19-2*t104*c3l1
     #*r-t35*t115-t35*t115*t19+t108*t50
      t129 = s1vr**2
      t130 = t120**2
      t136 = s4vr**2
      taux19 = (-768*(-2*t1-2*z*s1l1-2*t3)*t8*t11*t59/t61*t64-1536*s1vr*
     #(z+2*s1l1)*t120*t64*t11*t7*t58/t60+1536*t129*t130*t64*t11)/t136
      t1 = z**2
      t3 = s13*s2l1
      t4 = l3*s1vr
      t10 = t4*z
      t14 = r*t
      t15 = -1+t14
      t16 = t15**2
      t18 = r**2
      t19 = 1/t18
      t21 = r*t18
      t22 = t21*t
      t23 = l1**2
      t24 = dsqrt(l2)
      t25 = t23*t24
      t27 = t**2
      t28 = t18*t27
      t32 = l1*t24
      t33 = t18**2
      t39 = t24*t21
      t41 = t24*t18
      t43 = t24*r
      t50 = (1+t18)**2
      t53 = t18*l1
      t54 = t53*t
      t56 = l1*r
      t58 = l1*t
      t62 = dsqrt(-l1*(-1+l1)*(1-l2)*t50*r*(t18*t+t54+r+r*t27-t56-t56*t2
     #7+t+t58))
      t66 = t22*t25-t25*t28-t25*t18+t14*t25+t32*t33+2*t32*t28+4*t32*t18+
     #t32-t39*t-t41*t27-t41-t43*t+2*t62-4*t62*l4
      t67 = t66**2
      t68 = r+t
      t69 = t68**2
      t72 = 1/t50
      t76 = s1vr*t15*t19
      t78 = t66/t68
      t79 = s13*l3
      t100 = l1*l2
      t104 = l2*t18
      t112 = l2*t23
      t117 = t62*t24
      t121 = -l1-2*t53-l1*t33+t100+4*t100*t18+t100*t33-t104-l2*t21*t-l2*
     #r*t-t104*t27+2*t100*t28-t112*t18+t112*t22+t112*t14-t112*t28-4*t117
     #*l4+2*t117
      t127 = dsqrt((r-t)*s1l1*s2l1*t121*t15/r*t72)
      t131 = t24*s1l1
      t138 = s1l1*l1
      t147 = s4vr**2
      taux20 = (3072*(-4*t1-t3*t4+t4*s2l1*z-8*z*s1l1+t3*t10-t4*s2l1)*t16
     #*t19*t67/t69*t72+3072*(t76*t78*t72*(-t79*s1vr+s13*s34-s13-t4+t79*s
     #1vr*z-1+2*z+s34+t10)+6*t76*t78*t72*z)*(-t39*s1l1-2*t21*t127*c3l1+t
     #131*t54+t43*s1l1*t27-2*t127*c3l1*r-t43*t138-t43*t138*t27+t131*t58)
     #)/t147

CCC Coefficients

      tcoff37 = taux19
      tcoff38 = taux19
      tcoff39 = taux20
      tcoff40 = taux20

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet37 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff37)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = 1-l3
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet38 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff38)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet39 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff39)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = 1-l3
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet40 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff40)

CCC Sum

      qgrmnum11e1 = tFjet37*tcoff37+tFjet38*tcoff38+tFjet39*tcoff39+tFje
     #t40*tcoff40
      RETURN
      END

      double precision function qgrmnum11e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = z**2
      t2 = r*t
      t4 = (-1+t2)**2
      t6 = r**2
      t9 = t6*r
      t11 = l1**2
      t12 = dsqrt(l2)
      t13 = t11*t12
      t15 = t**2
      t16 = t6*t15
      t20 = l1*t12
      t21 = t6**2
      t29 = t12*t6
      t38 = (1+t6)**2
      t44 = l1*r
      t50 = dsqrt(-l1*(-1+l1)*(1-l2)*t38*r*(t6*t+t6*l1*t+r+t15*r-t44-t44
     #*t15+t+l1*t))
      t54 = t9*t*t13-t13*t16-t13*t6+t2*t13+t20*t21+2*t20*t16+4*t20*t6+t2
     #0-t12*t9*t-t29*t15-t29-t12*r*t+2*t50-4*t50*l4
      t55 = t54**2
      t57 = (r+t)**2
      t61 = s4vr**2
      taux19 = -768*t1*t4/t6*t55/t57/t38/t61
      t1 = z**2
      t3 = s13*s2l1
      t4 = l3*s1vr
      t12 = t4*z
      t18 = r*t
      t19 = -1+t18
      t20 = t19**2
      t22 = r**2
      t23 = 1/t22
      t25 = t22*r
      t26 = t25*t
      t27 = l1**2
      t28 = dsqrt(l2)
      t29 = t27*t28
      t31 = t**2
      t32 = t22*t31
      t36 = l1*t28
      t37 = t22**2
      t43 = t25*t28
      t45 = t28*t22
      t47 = t28*r
      t54 = (1+t22)**2
      t57 = t22*l1
      t58 = t57*t
      t60 = l1*r
      t62 = l1*t
      t66 = dsqrt(-l1*(-1+l1)*(1-l2)*t54*r*(t22*t+t58+r+r*t31-t60-t60*t3
     #1+t+t62))
      t70 = t26*t29-t29*t32-t29*t22+t18*t29+t36*t37+2*t36*t32+4*t36*t22+
     #t36-t43*t-t45*t31-t45-t47*t+2*t66-4*t66*l4
      t71 = t70**2
      t72 = r+t
      t73 = t72**2
      t76 = 1/t54
      t80 = s1vr*t19*t23
      t82 = t70/t72
      t83 = s13*l3
      t105 = l1*l2
      t109 = l2*t22
      t117 = l2*t27
      t122 = t66*t28
      t126 = -l1-2*t57-l1*t37+t105+4*t105*t22+t105*t37-t109-l2*t25*t-l2*
     #r*t-t109*t31+2*t105*t32-t117*t22+t117*t26+t117*t18-t117*t32-4*t122
     #*l4+2*t122
      t132 = dsqrt((r-t)*s1l1*s2l1*t126*t19/r*t76)
      t136 = t28*s1l1
      t143 = s1l1*l1
      t152 = s4vr**2
      taux20 = (3072*(5*t1+3*t3*t4-3*t4*s2l1*z+10*z*s1l1-3*t3*t12+3*t4*s
     #2l1)*t20*t23*t71/t73*t76+3072*(-3*t80*t82*t76*(-t83*s1vr+s13*s34-s
     #13-t4+t83*s1vr*z-1+2*z+s34+t12)-4*t80*t82*t76*z)*(-t43*s1l1-2*t25*
     #t132*c3l1+t136*t58+t47*s1l1*t31-2*t132*c3l1*r-t47*t143-t47*t143*t3
     #1+t136*t62))/t152

CCC Coefficients

      tcoff37 = taux19
      tcoff38 = taux19
      tcoff39 = taux20
      tcoff40 = taux20

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet37 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff37)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = 1-l3
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet38 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff38)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet39 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff39)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = 1-l3
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet40 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff40)

CCC Sum

      qgrmnum11e2 = tFjet37*tcoff37+tFjet38*tcoff38+tFjet39*tcoff39+tFje
     #t40*tcoff40
      RETURN
      END

      double precision function qgrmnum11e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux19 = 0
      t1 = z**2
      t2 = s13*s2l1
      t3 = l3*s1vr
      t9 = t3*z
      t13 = r*t
      t14 = -1+t13
      t15 = t14**2
      t17 = r**2
      t18 = 1/t17
      t20 = t17*r
      t21 = t20*t
      t22 = l1**2
      t23 = dsqrt(l2)
      t24 = t22*t23
      t26 = t**2
      t27 = t17*t26
      t31 = l1*t23
      t32 = t17**2
      t38 = t23*t20
      t40 = t23*t17
      t42 = t23*r
      t49 = (1+t17)**2
      t52 = l1*t17
      t53 = t52*t
      t55 = l1*r
      t57 = l1*t
      t61 = dsqrt(-l1*(-1+l1)*(1-l2)*t49*r*(t17*t+t53+r+r*t26-t55-t55*t2
     #6+t+t57))
      t65 = t24*t21-t24*t27-t24*t17+t13*t24+t31*t32+2*t31*t27+4*t31*t17+
     #t31-t38*t-t40*t26-t40-t42*t+2*t61-4*t61*l4
      t66 = t65**2
      t67 = r+t
      t68 = t67**2
      t71 = 1/t49
      t79 = s13*l3
      t92 = l1*l2
      t96 = l2*t17
      t104 = l2*t22
      t109 = t61*t23
      t113 = -l1-2*t52-l1*t32+t92+4*t92*t17+t92*t32-t96-l2*t20*t-l2*r*t-
     #t96*t26+2*t92*t27-t104*t17+t104*t21+t104*t13-t104*t27-4*t109*l4+2*
     #t109
      t119 = dsqrt((r-t)*s1l1*s2l1*t113*t14/r*t71)
      t123 = t23*s1l1
      t130 = s1l1*l1
      t141 = s4vr**2
      taux20 = (6144*(-t1-t3*t2+t3*s2l1*z-2*z*s1l1+t2*t9-t3*s2l1)*t15*t1
     #8*t66/t68*t71+6144*s1vr*t14*t18*t65/t67*t71*(-t79*s1vr+s13*s34-s13
     #-t3+t79*s1vr*z-1+2*z+s34+t9)*(-t38*s1l1-2*t20*t119*c3l1+t123*t53+t
     #42*s1l1*t26-2*t119*c3l1*r-t42*t130-t42*t130*t26+t123*t57))/t141

CCC Coefficients

      tcoff37 = taux19
      tcoff38 = taux19
      tcoff39 = taux20
      tcoff40 = taux20

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet37 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff37)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = 1-l3
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet38 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff38)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet39 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff39)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = 1-l3
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet40 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff40)

CCC Sum

      qgrmnum11e3 = tFjet37*tcoff37+tFjet38*tcoff38+tFjet39*tcoff39+tFje
     #t40*tcoff40
      RETURN
      END

      double precision function qgrmnum11e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux19 = 0
      taux20 = 0

CCC Coefficients

      tcoff37 = taux19
      tcoff38 = taux19
      tcoff39 = taux20
      tcoff40 = taux20

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet37 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff37)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = 1-l3
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet38 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,5.D0,1.D0,1.D0,Tcoeff*tcoff38)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet39 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff39)
      t2 = 1-z
      t3 = l3*t2
      t4 = t3*s1vr
      t5 = t3*s23r
      t6 = 1-l3
      t8 = t2**2
      t10 = l3*t6*t8*s34r
      t13 = t6*t2*s13r
      tFjet40 = Fjet(var,ndim,z,1/ux,t4-t5-t10,-1-t13-t4+z,t5,t13,t10,-1
     #+z-t4+t10,t4,1+t13+t5,-t13-t5-t10+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,
     #s4l2,s3l2,7.D0,1.D0,1.D0,Tcoeff*tcoff40)

CCC Sum

      qgrmnum11e4 = tFjet37*tcoff37+tFjet38*tcoff38+tFjet39*tcoff39+tFje
     #t40*tcoff40
      RETURN
      END

