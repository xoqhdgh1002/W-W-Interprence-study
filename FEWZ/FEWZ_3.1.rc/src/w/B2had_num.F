CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCC Numerator functions CCCCCCCCCCCCCCCCCCCCCCCCCC

      double precision function B2num1e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3-1
      t2 = t1**2
      t3 = t2**2
      t4 = -1+z
      t5 = t4**2
      t6 = t5**2
      t8 = s4vr**2
      t9 = 1/t8
      t11 = s3vr**2
      t12 = 1/t11
      t14 = s13r**2
      t15 = t14**2
      t20 = t2*t1
      t21 = t20*t6
      t22 = t21*l3
      t23 = t9*t12
      t32 = t6*t4
      t34 = t3*t32*l3
      t39 = t5*t4
      t40 = t20*t39
      t41 = t23*s3l2
      t42 = t40*t41
      t44 = t9*s4l2
      t45 = t44*t12
      t46 = t40*t45
      t62 = t23*s3l1
      t63 = t40*t62
      t65 = t9*s4l1
      t66 = t65*t12
      t67 = t40*t66
      t71 = t23*s2l2
      t74 = t22*t41
      t76 = t22*t45
      t85 = z*l3
      t86 = t85*t6
      t87 = t20*t9
      t88 = t87*t12
      t89 = t86*t88
      t94 = t23*s2l2*s2l1
      t100 = t23*s34r
      t126 = t3*t9
      t127 = t12*s34r
      t131 = t40*t9
      t132 = t12*s3l2
      t133 = t132*s3l1
      t137 = s4l2*s4l1*t12
      t143 = l3**2
      t144 = t143*t6
      t145 = t144*t2
      t149 = s23r**2
      t150 = t23*t149
      t152 = t143*t32
      t153 = t152*t20
      t160 = s1vr**2
      t165 = t145*t71
      t166 = t145*t41
      t167 = t145*t45
      t171 = t153*t100
      t172 = l3*t6
      t173 = t2*t9
      t174 = t173*t12
      t175 = t172*t174
      t176 = t171+t175
      t177 = 128*t176
      t180 = t23*s3l2*s34r
      t183 = l3*t39
      t184 = t183*t2
      t185 = t184*t41
      t195 = -512*t171-384*t175
      t197 = t153*t41
      t198 = t153*t45
      t200 = -128*t197+128*t198
      t207 = t6*t5
      t209 = t3*t207*t143
      t210 = s34r**2
      t211 = t23*t210
      t213 = -z+2
      t214 = t213*t9
      t215 = t214*t127
      t218 = -128*t209*t211+128*t22*t215
      t221 = t23*s3l2*t210
      t227 = t5*t2
      t228 = z-3
      t229 = t227*t228
      t232 = t227*z
      t241 = t23*s2l1
      t243 = t145*t62
      t244 = t145*t66
      t250 = t23*s3l1*s34r
      t253 = t184*t62
      t262 = t153*t62
      t263 = t153*t66
      t265 = -128*t262+128*t263
      t274 = t23*s3l1*t210
      t287 = t23*s3l2*s2l1
      t290 = t23*s3l1*s2l2
      t292 = t12*s3l1
      t293 = t44*t292
      t294 = t145*t293
      t295 = t65*t132
      t296 = t145*t295
      t308 = z*t143
      t309 = t308*t6
      t310 = t309*t174
      t311 = 128*t310
      t321 = l3*(z-4)*t39
      t322 = t173*t132
      t325 = t172*t2
      t326 = t325*t45
      t333 = t173*t292
      t342 = t153*t295
      t344 = t308*t32
      t346 = 128*t344*t88
      t368 = 2*z
      t371 = l3*(t368-5)*t39
      t374 = s4l2*t12
      t375 = t173*t374
      t384 = s4l1*t12
      t394 = t23*s3l2*s3l1
      t397 = t44*s4l1
      t398 = t184*t397
      t399 = t6*t2
      t409 = (t368-4)*t9*t127
      t412 = z**2
      t413 = 3*z
      t414 = t412-t413+1
      t420 = t12*t210
      t424 = 2*t4
      t425 = t424*t9
      t428 = -t368-1
      t429 = t428*t9
      t430 = t429*t374
      t435 = 5*z
      t437 = t227*(t435-7)
      t440 = 4*z
      t442 = t227*(-t440+2)
      t452 = t429*t384
      t478 = -t4
      t487 = t39*t2
      t490 = z+3
      t491 = t490*t5
      t492 = t491*t2
      t499 = t487*t9
      s2 = ((-256*t145*t23*s23r*s1vr+256*t145*t150+256*t153*t23*s34r*s23
     #r)*s1l2-128*t145*t23*s3l2*t160+((128*t165+128*t166-128*t167)*s23r+
     #t177*s2l2+256*t153*t180+128*t185)*s1vr-512*t145*t23*s2l2*t149+(t19
     #5*s2l2+t200*s34r+64*t185-64*t184*t45)*s23r+t218*s2l2-128*t209*t221
     #-64*t22*t44*t127+64*t229*t41-128*t232*t45)*s1l1+(-128*t145*t23*s3l
     #1*t160+((128*t145*t241+128*t243-128*t244)*s23r+t177*s2l1+256*t153*
     #t250+128*t253)*s1vr-512*t145*t23*s2l1*t149+(t195*s2l1+t265*s34r+64
     #*t253-64*t184*t66)*s23r+t218*s2l1-128*t209*t274-64*t22*t65*t127+64
     #*t229*t62-128*t232*t66)*s1l2+(-128*t145*t287-128*t145*t290-128*t29
     #4-128*t296)*t160
      s1 = s2+(((512*t165-256*t166+256*t167)*s2l1+(-256*t243+256*t244)*s
     #2l2-t311)*s23r+(256*t176*s2l2+(128*t197+128*t198)*s34r-128*t321*t3
     #22+128*t326)*s2l1+((128*t262+128*t263)*s34r-128*t321*t333+128*t325
     #*t66)*s2l2+(256*t153*t293+256*t342-t346)*s34r+256*t184*t293+256*t1
     #84*t295-128*t86*t174)*s1vr+(256*t145*t94+512*t310)*t149+(((256*t17
     #1+768*t175)*s2l2-t200*s34r-64*t371*t322+64*t371*t375)*s2l1+(-t265*
     #s34r-64*t371*t333+64*t371*t173*t384)*s2l2+512*t344*t87*t127+384*t1
     #84*t394+(-384*t398+384*t85*t399*t9)*t12)*s23r
      t502 = s1+((128*t22*t409+256*t414*t5*t174)*s2l2-128*t209*t44*t420+
     #(64*t22*t425*t132+64*t22*t430)*s34r+64*t437*t41+64*t442*t45)*s2l1+
     #(-128*t209*t65*t420+(64*t22*t425*t292+64*t22*t452)*s34r+64*t437*t6
     #2+64*t442*t66)*s2l2+(-128*t209*t293-128*t209*t295+128*t308*t207*t1
     #26*t12)*t210+((256*t74-192*t76)*s3l1-192*t22*t295+(-128*t22*t397-1
     #28*t86*t20*t478*t9)*t12)*s34r+(256*t487*t41-64*t492*t45)*s3l1-64*t
     #492*t295-128*t499*t137
      t504 = t143*l3
      t505 = t504*t6
      t506 = t505*t1
      t510 = t504*t32*t2
      t511 = t510*t100
      t512 = t1*t9
      t513 = t512*t12
      t514 = t144*t513
      t516 = 256*t511+256*t514
      t520 = t149*s23r
      t521 = t23*t520
      t529 = t504*t207*t20
      t530 = t529*t211
      t532 = t152*t2*t100
      t541 = t143*t39
      t542 = t541*t1
      t547 = t506*t71
      t549 = t506*t41
      t550 = 256*t549
      t551 = t506*t45
      t555 = t510*t41
      t557 = t510*t45
      t561 = z+1
      t562 = t143*t561
      t563 = t562*t39
      t564 = t512*t132
      t567 = t144*t1
      t568 = t567*t45
      t569 = 128*t568
      t574 = l3*t1*t5
      t575 = z*t9
      t576 = t575*t12
      t578 = t145*t100+t574*t576
      t579 = 128*t578
      t593 = 384*t511+512*t514
      t598 = -t428
      t599 = t143*t598
      t600 = t599*t39
      t603 = t512*t374
      t614 = t412-t440+1
      t619 = 128*t530+256*t145*t228*t9*t127+128*l3*t614*t5*t513
      t626 = t490*t9
      t630 = t145*t575*t374
      t634 = t183*t1
      t635 = t634*t41
      t641 = t368-1
      t646 = -256*t153*t211-128*t184*t641*t9*t127
      t650 = t561*t9
      t651 = t650*t132
      t654 = -t561*t9
      t655 = t654*t374
      t660 = t1*t4
      t661 = -t368+3
      t662 = t660*t661
      t666 = t412*t4*t1
      t669 = ((512*t506*t150+t516*s23r)*s1vr-512*t506*t521+(-768*t511-25
     #6*t514)*t149+(-256*t530-256*t532)*s23r)*s1l2+(256*t506*t23*s3l2*s2
     #3r-256*t542*t41)*t160+((128*t547-t550+256*t551)*t149+((-384*t555+1
     #28*t557)*s34r+128*t563*t564+t569)*s23r+t579*s2l2+512*t145*t180+256
     #*t574*t41)*s1vr+256*t506*t23*s2l2*t520+(t593*s2l2+(128*t555-128*t5
     #57)*s34r-64*t600*t564+64*t600*t603)*t149+(t619*s2l2+(128*t529*t41-
     #128*t529*t45)*t210+(-128*t145*t626*t132-128*t630)*s34r-128*t635)*s
     #23r+t646*s2l2-320*t153*t221+(-64*t184*t651-64*t184*t655)*s34r-64*t
     #662*t41+64*t666*t45
      t680 = t506*t62
      t682 = t506*t66
      t686 = t510*t62
      t688 = t510*t66
      t692 = t512*t292
      t695 = t567*t66
      t696 = 128*t695
      t716 = t512*t384
      t730 = t145*t575*t384
      t734 = t634*t62
      t741 = t650*t292
      t743 = t654*t384
      t756 = t506*t293
      t757 = t506*t295
      t765 = t542*t293
      t767 = t542*t295
      t772 = 128*t549
      t773 = 128*t551
      t779 = t504*z
      t780 = t779*t6
      t781 = t780*t513
      t792 = t143*(t413-5)*t39
      t805 = t510*t295
      t817 = t166+t167
      t818 = 128*t817
      t822 = l3*(t413-4)*t5
      t825 = t85*t1
      t826 = t5*t9
      t828 = t825*t826*t374
      t832 = t243+t244
      t838 = t825*t826*t384
      t847 = t5*t1
      t848 = l3*t228*t847
      t853 = t412*l3
      t866 = -t661
      t868 = t143*t866*t39
      t869 = t868*t564
      t886 = t542*t397
      t905 = (-t412+t435-4)*t9
      t910 = (t412-t368+1)*t9
      t959 = t85*t5
      t985 = 2*t412
      t988 = t660*(t985-8*z+5)
      t991 = z*t4
      t992 = t991*t1
      t1041 = t491*t1
      s2 = t669*s1l1+((256*t506*t23*s3l1*s23r-256*t542*t62)*t160+((128*t
     #506*t241-256*t680+256*t682)*t149+((-384*t686+128*t688)*s34r+128*t5
     #63*t692+t696)*s23r+t579*s2l1+512*t145*t250+256*t574*t62)*s1vr+256*
     #t506*t23*s2l1*t520+(t593*s2l1+(128*t686-128*t688)*s34r-64*t600*t69
     #2+64*t600*t716)*t149+(t619*s2l1+(128*t529*t62-128*t529*t66)*t210+(
     #-128*t145*t626*t292-128*t730)*s34r-128*t734)*s23r+t646*s2l1-320*t1
     #53*t274+(-64*t184*t741-64*t184*t743)*s34r-64*t662*t62+64*t666*t66)
     #*s1l2+((256*t506*t287+256*t506*t290+256*t756+256*t757)*s23r-256*t5
     #42*t287-256*t542*t290-256*t765-256*t767)*t160
      s3 = s2+(((-256*t547+t772-t773)*s2l1+(128*t680-128*t682)*s2l2-128*
     #t781)*t149+((-t516*s2l2+(-128*t555-128*t557)*s34r+128*t792*t564-t5
     #69)*s2l1+((-128*t686-128*t688)*s34r+128*t792*t692-t696)*s2l2+(-256
     #*t510*t293-256*t805)*s34r+256*t567*t293+256*t567*t295)*s23r+(256*t
     #578*s2l2+t818*s34r-128*t822*t564+128*t828)*s2l1+(128*t832*s34r-128
     #*t822*t692+128*t838)*s2l2+(384*t294+384*t296-t311)*s34r-128*t848*t
     #293-128*t848*t295-128*t853*t1*t826*t12)*s1vr
      s1 = s3-256*t780*t512*t12*t520+((-256*t567*t71+64*t869-64*t868*t60
     #3)*s2l1+(64*t868*t692-64*t868*t716)*s2l2-384*t779*t32*t173*t127-38
     #4*t542*t394+(384*t886-512*t308*t6*t1*t9)*t12)*t149+(((-256*t532-25
     #6*t172*t513)*s2l2+(-128*t145*t651-128*t630)*s34r-128*t574*t905*t13
     #2-128*t574*t910*t374)*s2l1+((-128*t145*t741-128*t730)*s34r-128*t57
     #4*t905*t292-128*t574*t910*t384)*s2l2-128*t779*t207*t87*t420+((-512
     #*t166-128*t599*t6*t375)*s3l1-128*t599*t399*t295+(256*t145*t397+256
     #*t309*t2*t213*t9)*t12)*s34r+(-512*t635-128*t634*t45)*s3l1-128*t634
     #*t295+(256*t634*t397-128*t959*t614*t1*t9)*t12)*s23r
      t1051 = s1+((256*t325*t100+256*t847*t576)*s2l2+(-64*t197-128*t198)
     #*t210+(-64*t184*t654*t132-64*t184*t650*t374)*s34r-64*t988*t41-64*t
     #992*t214*t374)*s2l1+((-64*t262-128*t263)*t210+(-64*t184*t654*t292-
     #64*t184*t650*t384)*s34r-64*t988*t62-64*t992*t214*t384)*s2l2+((-128
     #*t197-192*t198)*s3l1-192*t342+t346)*t210+((-128*l3*t866*t39*t322+1
     #28*t326)*s3l1+128*t325*t295+(-128*t398+128*t853*t499)*t12)*s34r+(-
     #128*t4*t414*t1*t41+64*t1041*t45)*s3l1+64*t1041*t295-128*t992*t44*t
     #384
      t1053 = t143**2
      t1054 = t1053*t6
      t1058 = t1053*t32*t1
      t1059 = t1058*t100
      t1060 = t505*t23
      t1061 = -t1059-t1060
      t1065 = t143*t5
      t1066 = t1065*t576
      t1067 = t506*t100+t1066
      t1072 = t149**2
      t1089 = t510*t211
      t1097 = t1054*t9
      t1101 = t504*t39
      t1102 = t1101*t9
      t1116 = 128*t1061
      t1125 = t504*(z+2)*t39
      t1132 = 128*t1067
      t1137 = t1065*z
      t1141 = 128*t1137*t45
      t1146 = l3*t4
      t1154 = t504*t598*t39
      t1164 = 128*t506*t215-128*t144*t23
      t1167 = (t368+4)*t9
      t1174 = t562*t5
      t1177 = t1065*t412
      t1185 = t5*l3
      t1188 = 128*t1089+256*t567*t100+128*t1185*t576
      t1190 = t510*t221
      t1193 = -t490*t9
      t1200 = -t1146*t641
      t1203 = t1146*t412
      t1205 = 64*t1203*t45
      t1209 = t512*t127
      t1212 = -128*t145*t211-128*t959*t1209
      t1222 = t4*t9
      t1263 = 128*t1137*t66
      t1294 = t510*t274
      t1304 = 64*t1203*t66
      t1320 = t132*s2l1
      t1322 = t292*s2l2
      t1324 = t374*s3l1
      t1326 = t384*s3l2
      t1338 = t1065*t9
      t1349 = t1053*z
      t1354 = t504*t641*t39
      t1362 = t779*t39
      t1367 = t6*t9
      t1374 = t143*t641*t5
      t1384 = t143*(t413-1)*t5
      t1395 = l3*t641
      t1396 = t1395*t4
      t1404 = t1185*t9
      t1430 = 64*t551
      t1434 = t1065*(-t985+t413-3)
      t1463 = t143*(t985+z+1)*t5
      t1482 = t228*t9
      t1492 = t1146*(4*t412-6*z+3)
      t1557 = t4*t641
      t1591 = 64*t4*t9
      s2 = 256*t3*t6*t9*t12*s2l2*s2l1*t15+((-128*t22*t23*s2l2*s1vr+256*t
     #22*t23*s2l2*s23r+128*t34*t23*s34r*s2l2-64*t42+64*t46)*s1l1+(-128*t
     #22*t23*s2l1*s1vr+256*t22*t23*s2l1*s23r+128*t34*t23*s34r*s2l1-64*t6
     #3+64*t67)*s1l2+((-256*t22*t71+128*t74-128*t76)*s2l1+(128*t22*t62-1
     #28*t22*t66)*s2l2+128*t89)*s1vr+(-512*t22*t94-256*t89)*s23r+((-256*
     #t34*t100-512*t21*t23)*s2l2+(-128*t34*t41+128*t34*t45)*s34r-192*t42
     #+192*t46)*s2l1+((-128*t34*t62+128*t34*t66)*s34r-192*t63+192*t67)*s
     #2l2-128*t85*t32*t126*t127-128*t131*t133+128*t131*t137)*t14*s13r+t5
     #02*t14+t1051*s13r
      s4 = s2
      s7 = ((-256*t1054*t521+256*t1061*t149+256*t1067*s23r)*s1vr+256*t10
     #54*t23*t1072+(512*t1059+256*t1060)*t520+(256*t1053*t207*t2*t211+12
     #8*t506*t409-256*t1066)*t149+(-256*t1089-256*t542*t575*t127)*s23r)*
     #s1l2+(-128*t1097*t132*t149+256*t1102*t132*s23r-128*t1065*t41)*t160
     #+((-128*t1054*t71+128*t1054*t41-128*t1054*t45)*t520+(t1116*s2l2+(1
     #28*t1058*t41-128*t1058*t45)*s34r-128*t1125*t41-128*t505*t45)*t149+
     #(t1132*s2l2+(-384*t549+t773)*s34r+128*t1137*t41+t1141)*s23r+256*t5
     #42*t180+128*t1146*t41)*s1vr+(-128*t505*t71+64*t1154*t41-64*t1154*t
     #45)*t520+(t1164*s2l2+(64*t506*t1167*t132+64*t506*t430)*s34r-64*t11
     #74*t41-128*t1177*t45)*t149
      s6 = s7+(t1188*s2l2+192*t1190+(64*t542*t1193*t132+64*t568)*s34r+64
     #*t1200*t41+t1205)*s23r+t1212*s2l2+(-192*t166-64*t167)*t210+(-64*t5
     #74*t651-64*t828)*s34r+64*t1222*t132
      s7 = s1l1
      s5 = s6*s7
      s3 = s4+s5
      s4 = s3+((-128*t1097*t292*t149+256*t1102*t292*s23r-128*t1065*t62)*
     #t160+((-128*t1054*t241+128*t1054*t62-128*t1054*t66)*t520+(t1116*s2
     #l1+(128*t1058*t62-128*t1058*t66)*s34r-128*t1125*t62-128*t505*t66)*
     #t149+(t1132*s2l1+(-384*t680+128*t682)*s34r+128*t1137*t62+t1263)*s2
     #3r+256*t542*t250+128*t1146*t62)*s1vr+(-128*t505*t241+64*t1154*t62-
     #64*t1154*t66)*t520+(t1164*s2l1+(64*t506*t1167*t292+64*t506*t452)*s
     #34r-64*t1174*t62-128*t1177*t66)*t149+(t1188*s2l1+192*t1294+(64*t54
     #2*t1193*t292+64*t695)*s34r+64*t1200*t62+t1304)*s23r+t1212*s2l1+(-1
     #92*t243-64*t244)*t210+(-64*t574*t741-64*t838)*s34r+64*t1222*t292)*
     #s1l2
      s1 = s4+((-128*t1097*t1320-128*t1097*t1322-128*t1097*t1324-128*t10
     #97*t1326)*t149+(256*t1102*t1320+256*t1102*t1322+256*t1102*t1324+25
     #6*t1102*t1326)*s23r-128*t1338*t1320-128*t1338*t1322-128*t1338*t132
     #4-128*t1338*t1326)*t160+(128*t1349*t6*t521+(-128*t1354*t287-128*t1
     #354*t290+128*t1349*t32*t1209-256*t1362*t293-256*t1362*t295+128*t77
     #9*t1367*t12)*t149+(256*t1374*t287+256*t1374*t290+(-128*t756-128*t7
     #57-128*t781)*s34r+128*t1384*t293+128*t1384*t295-128*t1065*t412*t9*
     #t12)*s23r-128*t1396*t287-128*t1396*t290+(128*t765+128*t767)*s34r-1
     #28*t1404*t1324-128*t1404*t1326)*s1vr
      s3 = s1+((64*t1101*t41-64*t1101*t45)*s2l1+(64*t1101*t62-64*t1101*t
     #66)*s2l2+128*t1102*t133+(-128*t1101*t397+128*t779*t1367)*t12)*t520
      s4 = s3+(((t772-t1430)*s34r+64*t1434*t41-t1141)*s2l1+((128*t680-64
     #*t682)*s34r+64*t1434*t62-t1263)*s2l2+((t550+t1430)*s3l1+64*t757+(-
     #128*t506*t397-128*t780*t478*t1*t9)*t12)*s34r+(256*t541*t41-64*t146
     #3*t45)*s3l1-64*t1463*t295+(-128*t541*t397-64*t308*t5*(-t985+t440-2
     #)*t9)*t12)*t149
      s2 = s4+((64*t1190+(64*t542*t1482*t132+64*t542*t655)*s34r+64*t1492
     #*t41-t1205)*s2l1+(64*t1294+(64*t542*t1482*t292+64*t542*t743)*s34r+
     #64*t1492*t62-t1304)*s2l2+((128*t555+64*t557)*s3l1+64*t805)*t210+((
     #128*t869-128*t563*t603)*s3l1-128*t562*t39*t1*t295+(128*t886-64*t30
     #8*t39*t424*t1*t9)*t12)*s34r+(128*t1146*t414*t41+64*t183*t45)*s3l1+
     #64*t183*t9*t1326+(128*t1146*z*t397-128*t853*t826)*t12)*s23r+(-64*t
     #817*t210+(-64*t635-64*t828)*s34r-64*t1557*t41)*s2l1
      taux1 = s2+(-64*t832*t210+(-64*t734-64*t838)*s34r-64*t1557*t62)*s2
     #l2+(-t818*s3l1-128*t296)*t210+((-128*t1395*t5*t564-64*t574*t45)*s3
     #l1-64*t574*t295)*s34r+(-128*t991*t41+t1591*t374)*s3l1+t1591*t1326
      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = -1+z
      t5 = t4**2
      t6 = t5**2
      t8 = t3*t6*l3
      t9 = s4vr**2
      t10 = 1/t9
      t11 = s3vr**2
      t12 = 1/t11
      t13 = t10*t12
      t18 = t2**2
      t19 = t6*t4
      t21 = t18*t19*l3
      t26 = t5*t4
      t27 = t3*t26
      t28 = t13*s3l2
      t30 = 256*t27*t28
      t31 = t10*s4l2
      t32 = t31*t12
      t34 = 256*t27*t32
      t45 = t13*s3l1
      t47 = 256*t27*t45
      t48 = t10*s4l1
      t49 = t48*t12
      t51 = 256*t27*t49
      t54 = t8*t28
      t55 = t8*t32
      t59 = t8*t45
      t60 = t8*t49
      t81 = s13r**2
      t84 = l3**2
      t85 = t84*t6
      t86 = t85*t2
      t87 = s1vr**2
      t92 = t13*s2l2
      t95 = t86*t28
      t97 = t86*t32
      t98 = 512*t97
      t102 = t84*t19*t3
      t103 = t13*s34r
      t104 = t102*t103
      t105 = l3*t6
      t106 = t2*t10
      t108 = t105*t106*t12
      t110 = 512*t104+512*t108
      t113 = t13*s3l2*s34r
      t116 = l3*t26
      t117 = t116*t2
      t118 = t117*t28
      t124 = -1024*t104+512*t108
      t126 = t102*t28
      t127 = t102*t32
      t129 = -512*t126-512*t127
      t136 = t6*t5
      t138 = t18*t136*t84
      t139 = s34r**2
      t140 = t13*t139
      t146 = -512*t138*t140-512*l3*t19*t3*t103
      t149 = t13*s3l2*t139
      t156 = t5*t2
      t157 = -z+3
      t158 = t156*t157
      t160 = 256*t158*t28
      t161 = t156*z
      t163 = 512*t161*t32
      t170 = t13*s2l1
      t173 = t86*t45
      t175 = t86*t49
      t176 = 512*t175
      t182 = t13*s3l1*s34r
      t185 = t117*t45
      t191 = t102*t45
      t192 = t102*t49
      t194 = 512*t191+512*t192
      t204 = t13*s3l1*t139
      t212 = 256*t158*t45
      t214 = 512*t161*t49
      t218 = t13*s3l2*s2l1
      t221 = t13*s3l1*s2l2
      t223 = t12*s3l1
      t224 = t31*t223
      t225 = t86*t224
      t226 = t12*s3l2
      t227 = t48*t226
      t228 = t86*t227
      t243 = t157*t10
      t247 = t105*t2
      t264 = -t102*t224+t102*t227
      t275 = 2*z
      t276 = -t275+1
      t277 = t276*t10
      t281 = s4l2*t12
      t292 = s4l1*t12
      t300 = t12*t139
      t305 = (4-t275)*t10
      t308 = -t276
      t309 = t308*t10
      t339 = -z-3
      t340 = t156*t339
      s2 = (-512*t86*t13*s3l2*t87+((1536*t86*t92+512*t95+t98)*s23r+t110*
     #s2l2+1024*t102*t113+1024*t118)*s1vr+(t124*s2l2+t129*s34r-256*t118-
     #256*t117*t32)*s23r+t146*s2l2-512*t138*t149+(-512*t54+256*t55)*s34r
     #-t160+t163)*s1l1+(512*t86*t13*s3l1*t87+((-1536*t86*t170-512*t173-t
     #176)*s23r-t110*s2l1-1024*t102*t182-1024*t185)*s1vr+(-t124*s2l1+t19
     #4*s34r+256*t185+256*t117*t49)*s23r-t146*s2l1+512*t138*t204+(512*t5
     #9-256*t60)*s34r+t212-t214)*s1l2
      s1 = s2+(-512*t86*t218+512*t86*t221+512*t225-512*t228)*t87+(((-102
     #4*t95-1024*t97)*s2l1+(1024*t173+1024*t175)*s2l2)*s23r+((512*t126-5
     #12*t127)*s34r+512*t117*t243*t226-512*t247*t32)*s2l1+((-512*t191+51
     #2*t192)*s34r-512*t117*t243*t223+512*t247*t49)*s2l2+1024*t264*s34r-
     #1024*t117*t224+1024*t117*t227)*s1vr+((-t129*s34r+256*t117*t277*t22
     #6+256*t117*t277*t281)*s2l1+(-t194*s34r-256*t117*t277*t223-256*t117
     #*t277*t292)*s2l2)*s23r
      t345 = s1+(512*t138*t31*t300+(-256*t8*t305*t226+256*t8*t309*t281)*
     #s34r-t160+t163)*s2l1+(-512*t138*t48*t300+(256*t8*t305*t223-256*t8*
     #t309*t292)*s34r+t212-t214)*s2l2+(512*t138*t224-512*t138*t227)*t139
     #+(768*t8*t224-768*t8*t227)*s34r-256*t340*t224+256*t340*t227
      t347 = t84*l3
      t348 = t347*t6
      t349 = t348*t1
      t353 = t84*t26
      t354 = t353*t1
      t361 = t349*t28
      t362 = 1024*t361
      t363 = t349*t32
      t366 = s23r**2
      t368 = t347*t19
      t369 = t368*t2
      t370 = t369*t103
      t371 = t1*t10
      t372 = t371*t12
      t373 = t85*t372
      t375 = -1024*t370-1024*t373
      t377 = t369*t28
      t379 = t369*t32
      t383 = -t4
      t384 = t353*t383
      t385 = t371*t226
      t388 = t85*t1
      t390 = 512*t388*t32
      t395 = l3*t1*t5
      t397 = z*t10*t12
      t400 = 512*t86*t103+512*t395*t397
      t404 = l3*t5
      t405 = -t157
      t406 = t404*t405
      t413 = 512*t370-1024*t373
      t418 = -t275+3
      t419 = t353*t418
      t422 = t371*t281
      t428 = t347*t136*t3
      t432 = 512*t428*t140-512*t105*t372
      t440 = z*t84*t6
      t443 = -z-1
      t444 = t443*t10
      t449 = (-512*t440*t106*t226-512*t86*t444*t281)*s34r
      t450 = t404*t383
      t456 = z*l3
      t462 = -512*t102*t140-512*t456*t26*t106*t12*s34r
      t466 = t405*t10
      t469 = -t443
      t470 = t469*t10
      t478 = -t383*t418*t1
      t480 = 256*t478*t28
      t481 = z**2
      t483 = t481*t4*t1
      t485 = 256*t483*t32
      t497 = t349*t45
      t498 = 1024*t497
      t499 = t349*t49
      t505 = t369*t45
      t507 = t369*t49
      t511 = t371*t223
      t515 = 512*t388*t49
      t533 = t371*t292
      t551 = (512*t440*t106*t223+512*t86*t444*t292)*s34r
      t568 = 256*t478*t45
      t570 = 256*t483*t49
      t575 = t349*t224
      t576 = t349*t227
      t584 = t354*t224
      t586 = t354*t227
      t601 = 3*t383
      t602 = t353*t601
      t616 = t369*t224-t369*t227
      t628 = t404*t418
      t631 = t456*t1
      t632 = t5*t10
      t634 = t631*t632*t281
      t644 = t631*t632*t292
      t648 = -t225+t228
      t653 = l3*t405*t5*t1
      t660 = t353*t276
      t674 = t404*(t481-t275+1)
      t678 = t404*(-t481+z)
      t692 = t84*(t275+1)*t6*t2
      t699 = t404*t383*t1
      t711 = -t601*t10
      t714 = t383*t10
      t739 = t116*t2*t383
      t746 = t5*t339*t1
      s3 = ((1024*t349*t13*s3l2*s23r-1024*t354*t28)*t87+((-1536*t349*t92
     #-t362-1024*t363)*t366+(t375*s2l2+(-1536*t377-512*t379)*s34r-512*t3
     #84*t385-t390)*s23r+t400*s2l2+1536*t86*t113-512*t406*t385)*s1vr+(t4
     #13*s2l2+(512*t377+512*t379)*s34r+256*t419*t385+256*t419*t422)*t366
     #+(t432*s2l2+(512*t428*t28+512*t428*t32)*t139+t449-512*t450*t422)*s
     #23r+t462*s2l2-768*t102*t149+(256*t117*t466*t226-256*t117*t470*t281
     #)*s34r-t480-t485)*s1l1
      s4 = ((-1024*t349*t13*s3l1*s23r+1024*t354*t45)*t87+((1536*t349*t17
     #0+t498+1024*t499)*t366+(-t375*s2l1+(1536*t505+512*t507)*s34r+512*t
     #384*t511+t515)*s23r-t400*s2l1-1536*t86*t182+512*t406*t511)*s1vr+(-
     #t413*s2l1+(-512*t505-512*t507)*s34r-256*t419*t511-256*t419*t533)*t
     #366+(-t432*s2l1+(-512*t428*t45-512*t428*t49)*t139+t551+512*t450*t5
     #33)*s23r-t462*s2l1+768*t102*t204+(-256*t117*t466*t223+256*t117*t47
     #0*t292)*s34r+t568+t570)*s1l2+((1024*t349*t218-1024*t349*t221-1024*
     #t575+1024*t576)*s23r-1024*t354*t218+1024*t354*t221+1024*t584-1024*
     #t586)*t87
      s2 = s3+s4
      s1 = s2+(((512*t361+512*t363)*s2l1+(-512*t497-512*t499)*s2l2)*t366
     #+(((-512*t377+512*t379)*s34r-512*t602*t385+t390)*s2l1+((512*t505-5
     #12*t507)*s34r+512*t602*t511-t515)*s2l2+1024*t616*s34r-1024*t388*t2
     #24+1024*t388*t227)*s23r+((1024*t95-t98)*s34r+512*t628*t385-512*t63
     #4)*s2l1+((-1024*t173+t176)*s34r-512*t628*t511+512*t644)*s2l2+1536*
     #t648*s34r+512*t653*t224-512*t653*t227)*s1vr+((-256*t660*t385-256*t
     #660*t422)*s2l1+(256*t660*t511+256*t660*t533)*s2l2)*t366+((t449+512
     #*t674*t385-512*t678*t422)*s2l1+(t551-512*t674*t511+512*t678*t533)*
     #s2l2+(512*t692*t224-512*t692*t227)*s34r-512*t699*t224+512*t699*t22
     #7)*s23r
      t751 = s1+((-256*t126+512*t127)*t139+(256*t117*t711*t226-256*t117*
     #t714*t281)*s34r-t480-t485)*s2l1+((256*t191-512*t192)*t139+(-256*t1
     #17*t711*t223+256*t117*t714*t292)*s34r+t568+t570)*s2l2-768*t264*t13
     #9+(512*t739*t224-512*t739*t227)*s34r+256*t746*t224-256*t746*t227
      t753 = t84**2
      t754 = t753*t6
      t755 = t754*t10
      t759 = t347*t26
      t760 = t759*t10
      t764 = t84*t5
      t774 = t366*s23r
      t777 = t753*t19*t1
      t781 = 512*t777*t103+512*t348*t13
      t788 = t759*t443
      t798 = -512*t349*t103-512*t764*t397
      t803 = t764*t276
      t806 = t764*z
      t808 = 512*t806*t32
      t811 = t354*t113
      t819 = t759*t276
      t830 = 512*t368*t1*t103+512*t85*t13
      t833 = t347*z*t6
      t836 = t348*t308
      t842 = 3*z-1
      t843 = t764*t842
      t848 = t764*(2*t481-2*z+2)
      t856 = -512*t388*t103-512*t404*t397
      t859 = 256*t369*t149
      t860 = t353*t842
      t862 = t353*t157
      t867 = l3*t4
      t870 = t456*t4
      t872 = (-z+2)*t10
      t880 = (-256*t95+256*t97)*t139
      t881 = t116*t1
      t885 = (256*t881*t28+256*t634)*s34r
      t887 = 256*t714*t226
      t927 = 512*t806*t49
      t930 = t354*t182
      t961 = 256*t369*t204
      t976 = (256*t173-256*t175)*t139
      t980 = (-256*t881*t45-256*t644)*s34r
      t982 = 256*t714*t223
      t985 = t226*s2l1
      t987 = t223*s2l2
      t989 = t281*s3l1
      t991 = t292*s3l2
      t1003 = t764*t10
      t1014 = t759*z
      t1024 = -t764*t842
      t1034 = t575-t576
      t1043 = t867*t383
      t1055 = t404*t10
      t1078 = 2*t481
      t1080 = t764*(t1078+1-z)
      t1097 = t764*(-z-1-t1078)
      t1105 = t84*t469*t26
      t1112 = t867*(-1-t1078+t275)
      t1115 = t867*t481
      t1135 = t353*t1*t443
      t1159 = t4*t10
      s3 = ((-512*t8*t13*s2l2*s1vr+512*t21*t13*s34r*s2l2-t30-t34)*s1l1+(
     #512*t8*t13*s2l1*s1vr-512*t21*t13*s34r*s2l1+t47+t51)*s1l2+((512*t54
     #+512*t55)*s2l1+(-512*t59-512*t60)*s2l2)*s1vr+((-512*t21*t28-512*t2
     #1*t32)*s34r-t30-t34)*s2l1+((512*t21*t45+512*t21*t49)*s34r+t47+t51)
     #*s2l2)*t81*s13r+t345*t81
      s2 = s3+t751*s13r+((-512*t755*t226*t366+1024*t760*t226*s23r-512*t7
     #64*t28)*t87+((512*t754*t92+512*t754*t28+512*t754*t32)*t774+(t781*s
     #2l2+(512*t777*t28+512*t777*t32)*s34r+512*t788*t28+512*t348*t32)*t3
     #66+(t798*s2l2+(-t362-512*t363)*s34r-512*t803*t28-t808)*s23r+512*t8
     #11-512*t404*t28)*s1vr+(512*t348*t92-256*t819*t28-256*t819*t32)*t77
     #4+(t830*s2l2+(512*t833*t385+256*t836*t422)*s34r-256*t843*t28+256*t
     #848*t32)*t366+(t856*s2l2+t859+(-256*t860*t385+256*t862*t422)*s34r+
     #256*t867*t28+256*t870*t872*t281)*s23r+t880+t885-t887)*s1l1
      s3 = s2+((512*t755*t223*t366-1024*t760*t223*s23r+512*t764*t45)*t87
     #+((-512*t754*t170-512*t754*t45-512*t754*t49)*t774+(-t781*s2l1+(-51
     #2*t777*t45-512*t777*t49)*s34r-512*t788*t45-512*t348*t49)*t366+(-t7
     #98*s2l1+(t498+512*t499)*s34r+512*t803*t45+t927)*s23r-512*t930+512*
     #t404*t45)*s1vr+(-512*t348*t170+256*t819*t45+256*t819*t49)*t774+(-t
     #830*s2l1+(-512*t833*t511-256*t836*t533)*s34r+256*t843*t45-256*t848
     #*t49)*t366+(-t856*s2l1-t961+(256*t860*t511-256*t862*t533)*s34r-256
     #*t867*t45-256*t870*t872*t292)*s23r+t976+t980+t982)*s1l2
      s1 = s3+((-512*t755*t985+512*t755*t987+512*t755*t989-512*t755*t991
     #)*t366+(1024*t760*t985-1024*t760*t987-1024*t760*t989+1024*t760*t99
     #1)*s23r-512*t1003*t985+512*t1003*t987+512*t1003*t989-512*t1003*t99
     #1)*t87+((-1024*t1014*t218+1024*t1014*t221+1024*t1014*t224-1024*t10
     #14*t227)*t366+((-512*t349*t113-512*t1024*t28)*s2l1+(512*t349*t182+
     #512*t1024*t45)*s2l2+512*t1034*s34r-512*t843*t224+512*t843*t227)*s2
     #3r+(512*t811+512*t1043*t28)*s2l1+(-512*t930-512*t1043*t45)*s2l2+(-
     #512*t584+512*t586)*s34r+512*t1055*t989-512*t1055*t991)*s1vr+((256*
     #t759*t28+256*t759*t32)*s2l1+(-256*t759*t45-256*t759*t49)*s2l2)*t77
     #4
      taux2 = s1+(((512*t361+256*t363)*s34r-256*t1080*t28+t808)*s2l1+((-
     #512*t497-256*t499)*s34r+256*t1080*t45-t927)*s2l2-256*t1034*s34r-25
     #6*t1097*t224+256*t1097*t227)*t366+((t859+(-256*t1105*t385+256*t110
     #5*t422)*s34r-256*t1112*t28+256*t1115*t32)*s2l1+(-t961+(256*t1105*t
     #511-256*t1105*t533)*s34r+256*t1112*t45-256*t1115*t49)*s2l2-256*t61
     #6*t139+(-512*t1135*t224+512*t1135*t227)*s34r+256*t450*t224-256*t45
     #0*t227)*s23r+(t880+t885-t887)*s2l1+(t976+t980+t982)*s2l2-512*t648*
     #t139+(256*t395*t224-256*t395*t227)*s34r-256*t1159*t989+256*t1159*t
     #991

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = taux2

CCC Jet functions

      t1 = 1-l3
      t2 = -z+1
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,27.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t2 = -z+1
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet2 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,27.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = 1-l3
      t2 = -z+1
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,28.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t2 = -z+1
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet4 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,28.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      B2num1e0 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcoff4
      RETURN
      END

      double precision function B2num1e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3-1
      t2 = t1**2
      t3 = t2**2
      t4 = -1+z
      t5 = t4**2
      t6 = t5**2
      t9 = s4vr**2
      t10 = 1/t9
      t11 = s3vr**2
      t12 = 1/t11
      t13 = t10*t12
      t14 = s13r**2
      t15 = t14**2
      t19 = z*l3
      t20 = t19*t6
      t21 = t2*t1
      t22 = t21*t10
      t23 = t12*s23r
      t27 = t6*t4
      t29 = t3*t10
      t30 = t12*s34r
      t41 = t21*t6
      t42 = t41*l3
      t48 = t13*s34r*s2l2
      t50 = 128*t42*t48
      t51 = t13*s3l2
      t53 = t10*s4l2
      t54 = t53*t12
      t58 = (64*t42*t51+64*t42*t54)*s34r
      t60 = z+1
      t61 = t5*t2*t60
      t63 = 64*t61*t51
      t65 = 64*t61*t54
      t69 = t13*s34r*s2l1
      t72 = t13*s3l1
      t74 = t10*s4l1
      t75 = t74*t12
      t79 = (64*t42*t72+64*t42*t75)*s34r
      t81 = 64*t61*t72
      t83 = 64*t61*t75
      t86 = l3**2
      t87 = t86*z
      t88 = t60*t6
      t90 = t2*t10
      t91 = s1vr**2
      t96 = t27*t21
      t97 = t87*t96
      t98 = 2*z
      t99 = t98+1
      t100 = t99*t10
      t103 = t5*t4
      t111 = t87*t6
      t112 = s23r**2
      t113 = t12*t112
      t129 = t6*t5
      t134 = s34r**2
      t135 = t12*t134
      t140 = 3*z
      t148 = z**2
      t149 = 3*t148
      t150 = 4*z
      t156 = (128*t42*t13*s34r*s1l2+t50+t58+t63+t65)*s1l1+(128*t42*t69+t
     #79+t81+t83)*s1l2+128*t87*t88*t90*t12*t91+(-128*t97*t100*t30-128*t1
     #9*t103*t2*t60*t13)*s1vr+768*t111*t90*t113+(768*t87*t27*t22*t30+768
     #*t20*t90*t12)*s23r+(t50+t58+t63+t65)*s2l1+(t79+t81+t83)*s2l2-64*t8
     #7*t129*t3*(-t98-3)*t10*t135-128*t19*t41*(-t140+4)*t10*t30-64*z*t5*
     #t2*(-t149+t150-3)*t10*t12
      t158 = t86*t6
      t159 = t158*t2
      t164 = t96*t86
      t165 = t13*t134
      t166 = t164*t165
      t170 = t13*s34r
      t171 = l3*t6*t2*t170
      t182 = l3*t5
      t183 = t182*t1
      t184 = t60*t10
      t185 = t12*s3l2
      t190 = l3*t60*t5
      t191 = t1*t10
      t192 = s4l2*t12
      t193 = t191*t192
      t196 = -256*t159*t48+(-128*t159*t51-128*t159*t54)*s34r-128*t183*t1
     #84*t185-128*t190*t193
      t199 = -128*t166-128*t171
      t200 = t199*s2l2
      t205 = (-64*t164*t51-64*t164*t54)*t134
      t207 = l3*t103*t2
      t209 = (t98-1)*t10
      t210 = t209*t185
      t216 = (-64*t207*t210-64*t207*t100*t192)*s34r
      t218 = t148-z-2
      t219 = t1*t4*t218
      t221 = 64*t219*t51
      t223 = z*t4*t1
      t224 = t184*t192
      t226 = 64*t223*t224
      t235 = (-128*t159*t72-128*t159*t75)*s34r
      t236 = t12*s3l1
      t239 = 128*t183*t184*t236
      t240 = s4l1*t12
      t241 = t191*t240
      t243 = 128*t190*t241
      t251 = (-64*t164*t72-64*t164*t75)*t134
      t252 = t209*t236
      t258 = (-64*t207*t252-64*t207*t100*t240)*s34r
      t260 = 64*t219*t72
      t261 = t184*t240
      t263 = 64*t223*t261
      t266 = t86*l3
      t267 = t266*z
      t272 = t2*t27
      t273 = t272*t266
      t274 = z*t10
      t275 = t274*t30
      t276 = t273*t275
      t278 = t87*t60
      t287 = t90*t30
      t297 = t274*t135
      t298 = t21*t129*t266*t297
      t304 = t19*t1
      t312 = t112*s23r
      t326 = t6*t2
      t333 = t19*t5
      t334 = 6*z
      t346 = t6*t103
      t349 = t12*t134*s34r
      s1 = ((-256*t159*t13*s34r*s23r-128*t166-128*t171)*s1l2+t196*s23r+t
     #200+t205+t216-t221-t226)*s1l1+((-256*t159*t69+t235-t239-t243)*s23r
     #+t199*s2l1+t251+t258-t260-t263)*s1l2+(-256*t267*t88*t191*t23-128*t
     #276+128*t278*t103*t1*t13)*t91+((256*t267*t60*t27*t287-256*t278*t6*
     #t1*t13)*s23r+128*t298-384*t148*t86*t6*t287-128*t304*t5*t60*t13)*s1
     #vr-512*t267*t6*t191*t12*t312+(-768*t276-768*t111*t191*t12)*t112
      t373 = s1+(t196*s2l1+(t235-t239-t243)*s2l2-384*t298+256*t87*t326*(
     #t148-z+4)*t10*t30+128*t333*(-t148+t334-3)*t1*t13)*s23r+(t200+t205+
     #t216-t221-t226)*s2l1+(t251+t258-t260-t263)*s2l2-64*t267*t346*t29*t
     #349+64*t97*(t140+5)*t10*t135+64*t19*t103*t2*(-t148+8*z-5)*t10*t30+
     #64*t5*t1*z*(-1-t148)*t10*t12
      t376 = t266*t6*t1
      t385 = 128*t273*t165+128*t158*t1*t170
      t387 = t159*t165
      t389 = t191*t30
      t390 = t333*t389
      t402 = t86*t60*t5
      t407 = 128*t376*t48+(64*t376*t51+64*t376*t54)*s34r+64*t402*t51+64*
     #t402*t54
      t416 = t86*t103*t1
      t419 = t86*t99*t103
      t424 = l3*t4
      t425 = t424*t218
      t428 = t424*z
      t431 = t385*s2l2+(64*t273*t51+64*t273*t54)*t134+(64*t416*t210+64*t
     #419*t193)*s34r+64*t425*t51+64*t428*t224
      t434 = -128*t387-128*t390
      t435 = t434*s2l2
      t439 = 64*t159*t13*s3l2*t134
      t441 = t182*t1*z
      t445 = 128*t441*t13*s3l2*s34r
      t446 = t4*t60
      t448 = 64*t446*t51
      t457 = (64*t376*t72+64*t376*t75)*s34r
      t459 = 64*t402*t72
      t461 = 64*t402*t75
      t469 = (64*t273*t72+64*t273*t75)*t134
      t474 = (64*t416*t252+64*t419*t241)*s34r
      t476 = 64*t425*t72
      t478 = 64*t428*t261
      t485 = 64*t159*t13*s3l1*t134
      t489 = 128*t441*t13*s3l1*s34r
      t491 = 64*t446*t72
      t494 = t86**2
      t495 = t494*z
      t497 = t6*t10
      t503 = t494*t27*z*t389
      t519 = (2*t148+z-1)*t10*t12
      t526 = t494*t2*t129*t297
      t531 = t86*t5*z
      t544 = t112**2
      t575 = t22*t349
      t603 = t53*t236
      t606 = t74*t185
      t616 = 2*t182*t1*t60
      t629 = (64+128*z+64*t148)*t10
      s1 = 128*t3*t6*z*t13*t15+(-512*t20*t22*t23-256*t19*t27*t29*t30-256
     #*z*t6*t22*t12)*t14*s13r+t156*t14+t373*s13r+((128*t376*t13*s34r*t11
     #2+t385*s23r-128*t387-128*t390)*s1l2+t407*t112+t431*s23r+t435-t439-
     #t445-t448)*s1l1+((128*t376*t69+t457+t459+t461)*t112+(t385*s2l1+t46
     #9+t474+t476+t478)*s23r+t434*s2l1-t485-t489-t491)*s1l2+(128*t495*t6
     #0*t497*t113+(128*t503-128*t267*t60*t103*t10*t12)*s23r-128*t376*t27
     #5)*t91+((-128*t503+128*t267*t103*t519)*t112+(-128*t526+128*t266*t1
     #48*t6*t389-128*t531*t519)*s23r+128*t273*t297-128*t111*t389)*s1vr+1
     #28*t494*t6*z*t13*t544
      taux1 = s1+(256*t503+256*t267*t497*t12)*t312+(t407*s2l1+(t457+t459
     #+t461)*s2l2+192*t526-128*t267*t6*(-z+4)*t389-64*t531*(-2*t148*z-t1
     #49+t334-3)*t10*t12)*t112+(t431*s2l1+(t469+t474+t476+t478)*s2l2+64*
     #t495*t346*t575-64*t267*t272*(z+5)*t10*t135-64*t87*t103*(-t148+t150
     #-5)*t389-64*t333*(t148+t98-1)*t10*t12)*s23r+(t435-t439-t445-t448)*
     #s2l1+(-t485-t489-t491)*s2l2-64*t267*t129*t575+(64*t159*t603+64*t15
     #9*t606+128*t278*t326*t13)*t134+(64*t616*t603+64*t616*t606+64*t304*
     #t5*(t148+t150-1)*t13)*s34r+t629*t192*s3l1+t629*t240*s3l2
      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = -1+z
      t5 = t4**2
      t6 = t5**2
      t8 = t3*t6*l3
      t9 = s4vr**2
      t10 = 1/t9
      t11 = s3vr**2
      t12 = 1/t11
      t13 = t10*t12
      t17 = t2**2
      t18 = t6*t4
      t20 = t17*t18*l3
      t24 = t5*t4
      t25 = t3*t24
      t26 = t13*s3l2
      t27 = t25*t26
      t28 = t10*s4l2
      t29 = t28*t12
      t30 = t25*t29
      t40 = t13*s3l1
      t41 = t25*t40
      t42 = t10*s4l1
      t43 = t42*t12
      t44 = t25*t43
      t48 = t8*t26
      t49 = t8*t29
      t53 = t8*t40
      t54 = t8*t43
      t79 = s13r**2
      t82 = l3**2
      t83 = t82*t6
      t84 = t83*t2
      t85 = s1vr**2
      t90 = t13*s2l2
      t93 = t84*t26
      t95 = t84*t29
      t96 = 1536*t95
      t100 = t82*t18*t3
      t101 = t13*s34r
      t102 = t100*t101
      t103 = l3*t6
      t104 = t2*t10
      t106 = t103*t104*t12
      t108 = -1024*t102-1024*t106
      t111 = t13*s3l2*s34r
      t114 = l3*t24
      t115 = t114*t2
      t116 = t115*t26
      t122 = 2048*t102-1024*t106
      t124 = t100*t26
      t125 = t100*t29
      t127 = 1536*t124+1536*t125
      t134 = t6*t5
      t136 = t17*t134*t82
      t137 = s34r**2
      t138 = t13*t137
      t144 = 1024*t136*t138+1024*l3*t18*t3*t101
      t154 = t5*t2
      t155 = 2*z
      t156 = t155-6
      t158 = -z+3
      t160 = 2*t154*t158
      t162 = (-t154*t156+t160)*t10
      t163 = t12*s3l2
      t166 = t154*z
      t175 = t13*s2l1
      t178 = t84*t40
      t180 = t84*t43
      t181 = 1536*t180
      t187 = t13*s3l1*s34r
      t190 = t115*t40
      t196 = t100*t40
      t197 = t100*t43
      t199 = -1536*t196-1536*t197
      t216 = t12*s3l1
      t224 = t13*s3l2*s2l1
      t227 = t13*s3l1*s2l2
      t229 = t28*t216
      t230 = t84*t229
      t231 = t42*t163
      t232 = t84*t231
      t254 = (-t114*t2*(z-4)+2*t114*t2*t158)*t10
      t257 = t103*t2
      t273 = t100*t229-t100*t231
      t287 = -t155+1
      t292 = (-t114*t2*(t155-8)+2*t114*t2*t287)*t10
      t295 = s4l2*t12
      t304 = s4l1*t12
      t311 = t12*t137
      t315 = -t287
      t317 = t103*t3*t315
      t318 = 4-t155
      t323 = (-t317+2*t103*t3*t318)*t10
      t325 = -t155-3
      t330 = (-t103*t3*t325+2*t317)*t10
      t335 = 6*z
      t339 = (-t154*(t335-10)+t160)*t10
      t346 = (-t154*(-t335+2)+4*t166)*t10
      t375 = z+7
      t377 = -z-3
      t381 = (-t154*t375+2*t154*t377)*t10
      t382 = t295*s3l1
      t385 = t304*s3l2
      s2 = (1536*t84*t13*s3l2*t85+((-3072*t84*t90-1536*t93-t96)*s23r+t10
     #8*s2l2-3072*t100*t111-2560*t116)*s1vr+(t122*s2l2+t127*s34r-512*t11
     #6-512*t115*t29)*s23r+t144*s2l2+1536*t136*t13*s3l2*t137+(768*t48-12
     #80*t49)*s34r+256*t162*t163-2048*t166*t29)*s1l1+(-1536*t84*t13*s3l1
     #*t85+((3072*t84*t175+1536*t178+t181)*s23r-t108*s2l1+3072*t100*t187
     #+2560*t190)*s1vr+(-t122*s2l1+t199*s34r+512*t190+512*t115*t43)*s23r
     #-t144*s2l1-1536*t136*t13*s3l1*t137+(-768*t53+1280*t54)*s34r-256*t1
     #62*t216+2048*t166*t43)*s1l2
      s1 = s2+(1536*t84*t224-1536*t84*t227-1536*t230+1536*t232)*t85+(((3
     #072*t93+3072*t95)*s2l1+(-3072*t178-3072*t180)*s2l2)*s23r+((-1536*t
     #124+1536*t125)*s34r-512*t254*t163+1536*t257*t29)*s2l1+((1536*t196-
     #1536*t197)*s34r+512*t254*t216-1536*t257*t43)*s2l2+3072*t273*s34r+3
     #072*t115*t229-3072*t115*t231)*s1vr+((-t127*s34r-256*t292*t163-256*
     #t292*t295)*s2l1+(-t199*s34r+256*t292*t216+256*t292*t304)*s2l2)*s23
     #r
      t388 = s1+(-1536*t136*t28*t311+(256*t323*t163-256*t330*t295)*s34r+
     #256*t339*t163-256*t346*t295)*s2l1+(1536*t136*t42*t311+(-256*t323*t
     #216+256*t330*t304)*s34r-256*t339*t216+256*t346*t304)*s2l2+(-1536*t
     #136*t229+1536*t136*t231)*t137+(-2304*t8*t229+2304*t8*t231)*s34r+25
     #6*t381*t382-256*t381*t385
      t390 = t82*l3
      t391 = t390*t6
      t392 = t391*t1
      t396 = t82*t24
      t397 = t396*t1
      t403 = t392*t26
      t404 = t392*t29
      t407 = s23r**2
      t409 = t390*t18
      t410 = t409*t2
      t411 = t410*t101
      t412 = t1*t10
      t413 = t412*t12
      t414 = t83*t413
      t416 = 2048*t411+2048*t414
      t418 = t410*t26
      t420 = t410*t29
      t424 = z+1
      t425 = t396*t424
      t426 = -t4
      t430 = (-t425+2*t396*t426)*t1
      t433 = t83*t1
      t435 = 1536*t433*t29
      t442 = z*t10*t12
      t445 = -1024*t84*t101-1024*l3*t1*t5*t442
      t449 = l3*t5
      t450 = -t158
      t454 = (-2*t449+2*t449*t450)*t1
      t461 = -1024*t411+2048*t414
      t468 = -t155+3
      t472 = (-t396*(4+t155)+2*t396*t468)*t1
      t480 = t390*t134*t3
      t484 = -1024*t480*t138+1024*t103*t413
      t496 = 2*t83*t2*z
      t498 = (-t83*t2*(z+4)-t496)*t10
      t500 = z-2
      t503 = -t424
      t508 = (-t83*t2*t500+2*t83*t2*t503)*t10
      t509 = t508*t295
      t514 = -t449*t318
      t518 = t449*z
      t519 = t449*t426
      t522 = (2*t518+2*t519)*t1
      t528 = z*l3
      t534 = 1024*t100*t138+1024*t528*t24*t104*t12*s34r
      t544 = (-t257+2*t114*t2*t450)*t10
      t546 = 3*z
      t547 = -t546-1
      t551 = t114*t2*t424
      t554 = (-t114*t2*t547+2*t551)*t10
      t559 = 4*z
      t562 = 2*t4
      t564 = -t562*t468
      t566 = (t426*(6-t559)+t564)*t1
      t569 = z**2
      t570 = t569*t4
      t571 = t570*t1
      t584 = t392*t40
      t585 = t392*t43
      t591 = t410*t40
      t593 = t410*t43
      t600 = 1536*t433*t43
      t630 = t508*t304
      t660 = t392*t229
      t661 = t392*t231
      t669 = t397*t229
      t671 = t397*t231
      t688 = 3*t426
      t692 = (-t396*(t546-5)+2*t396*t688)*t1
      t706 = -t410*t229+t410*t231
      t723 = (-t449*(t546-4)+2*t449*t468)*t1
      t726 = t528*t1
      t727 = t5*t10
      t729 = t726*t727*t295
      t739 = t726*t727*t304
      t743 = t230-t232
      t748 = l3*t450*t5*t1
      t759 = (-t396*t156+2*t396*t287)*t1
      t772 = z+2
      t776 = (-t83*t2*t772-t496)*t10
      t787 = (-t449*(-7-t569+t335)+2*t449*(1-t155+t569))*t1
      t796 = (-t449*(t569-t559+1)+2*t449*(-t569+z))*t1
      t814 = t82*(t155+1)*t6*t2
      t820 = z-5
      t823 = -t449*t820+2*t519
      t825 = t823*t1*t10
      t843 = (-t114*t2*t377-2*t114*t2*t688)*t10
      t845 = t426*t10
      t852 = 2*t569
      t856 = (t426*(-10*z+8+t852)+t564)*t1
      t864 = (z*t4*t562+2*t570)*t1
      t892 = (-t551+2*t114*t2*t426)*t10
      t903 = (-t5*t375+2*t5*t377)*t1*t10
      s3 = ((-3072*t392*t13*s3l2*s23r+3072*t397*t26)*t85+((3072*t392*t90
     #+3072*t403+3072*t404)*t407+(t416*s2l2+(4608*t418+1536*t420)*s34r+5
     #12*t430*t26+t435)*s23r+t445*s2l2-5120*t84*t111+512*t454*t26)*s1vr+
     #(t461*s2l2+(-1536*t418-1536*t420)*s34r-256*t472*t26-256*t472*t29)*
     #t407+(t484*s2l2+(-1536*t480*t26-1536*t480*t29)*t137+(-512*t498*t16
     #3+512*t509)*s34r+512*t514*t412*t163+512*t522*t29)*s23r+t534*s2l2+(
     #2816*t124+256*t125)*t137+(-256*t544*t163+256*t554*t295)*s34r-256*t
     #566*t26+1024*t571*t29)*s1l1
      s4 = ((3072*t392*t13*s3l1*s23r-3072*t397*t40)*t85+((-3072*t392*t17
     #5-3072*t584-3072*t585)*t407+(-t416*s2l1+(-4608*t591-1536*t593)*s34
     #r-512*t430*t40-t600)*s23r-t445*s2l1+5120*t84*t187-512*t454*t40)*s1
     #vr+(-t461*s2l1+(1536*t591+1536*t593)*s34r+256*t472*t40+256*t472*t4
     #3)*t407+(-t484*s2l1+(1536*t480*t40+1536*t480*t43)*t137+(512*t498*t
     #216-512*t630)*s34r-512*t514*t412*t216-512*t522*t43)*s23r-t534*s2l1
     #+(-2816*t196-256*t197)*t137+(256*t544*t216-256*t554*t304)*s34r+256
     #*t566*t40-1024*t571*t43)*s1l2+((-3072*t392*t224+3072*t392*t227+307
     #2*t660-3072*t661)*s23r+3072*t397*t224-3072*t397*t227-3072*t669+307
     #2*t671)*t85
      s2 = s3+s4
      s1 = s2+(((-1536*t403-1536*t404)*s2l1+(1536*t584+1536*t585)*s2l2)*
     #t407+(((1536*t418-1536*t420)*s34r+512*t692*t26-t435)*s2l1+((-1536*
     #t591+1536*t593)*s34r-512*t692*t40+t600)*s2l2+3072*t706*s34r+3072*t
     #433*t229-3072*t433*t231)*s23r+((-2560*t93+t96)*s34r-512*t723*t26+1
     #536*t729)*s2l1+((2560*t178-t181)*s34r+512*t723*t40-1536*t739)*s2l2
     #+4608*t743*s34r-1536*t748*t229+1536*t748*t231)*s1vr+((256*t759*t26
     #+256*t759*t29)*s2l1+(-256*t759*t40-256*t759*t43)*s2l2)*t407+(((-51
     #2*t776*t163+512*t509)*s34r-512*t787*t26+512*t796*t29)*s2l1+((512*t
     #776*t216-512*t630)*s34r+512*t787*t40-512*t796*t43)*s2l2+(-1536*t81
     #4*t229+1536*t814*t231)*s34r+512*t825*t382-512*t825*t385)*s23r
      t908 = s1+((768*t124-1280*t125)*t137+(-256*t843*t163+256*t115*t845
     #*t295)*s34r-256*t856*t26+256*t864*t29)*s2l1+((-768*t196+1280*t197)
     #*t137+(256*t843*t216-256*t115*t845*t304)*s34r+256*t856*t40-256*t86
     #4*t43)*s2l2-2304*t273*t137+(-512*t892*t382+512*t892*t385)*s34r-256
     #*t903*t382+256*t903*t385
      t910 = t82**2
      t911 = t910*t6
      t912 = t911*t10
      t916 = t390*t24
      t917 = t916*t10
      t921 = t82*t5
      t933 = t407*s23r
      t936 = t910*t18*t1
      t940 = -1024*t936*t101-1024*t391*t13
      t951 = (-t916*t772+2*t916*t503)*t10
      t961 = 1024*t392*t101+1024*t921*t442
      t967 = t921*z
      t971 = (-t967+2*t921*t287)*t10
      t974 = t967*t29
      t978 = t397*t111
      t980 = t4*l3
      t981 = 2*t449
      t983 = (-t980+t981)*t10
      t995 = (-2*t916*t424+2*t916*t287)*t10
      t1006 = -1024*t409*t1*t101-1024*t83*t13
      t1013 = (-t391*(t155+5)-4*t391*z)*t1
      t1019 = (-t391*t325+2*t391*t315)*t1
      t1025 = t546-1
      t1026 = t921*t1025
      t1029 = (4*t921+2*t1026)*t10
      t1040 = (-t921*(-2*z-2*t569)+2*t921*(2*t569-2*z+2))*t10
      t1048 = 1024*t433*t101+1024*t449*t442
      t1051 = 256*t420
      t1059 = (-t396*(-z-5)+2*t396*t1025)*t1
      t1061 = t396*t503
      t1065 = (-t1061+2*t396*t158)*t1
      t1070 = 4*t426
      t1074 = (-t980*t1070-2*t980)*t10
      t1077 = t528*t4
      t1079 = -t500*t10
      t1089 = 2*t114
      t1091 = (-t518+t1089)*t1
      t1094 = 768*t729
      t1098 = -t1070*t10
      t1142 = t967*t43
      t1146 = t397*t187
      t1176 = 256*t593
      t1197 = 768*t739
      t1204 = t163*s2l1
      t1206 = t216*s2l2
      t1220 = t921*t10
      t1232 = t916*z
      t1235 = (-t916*t315-4*t1232)*t10
      t1254 = (-t921*(t559-2)-2*t921*t1025)*t10
      t1265 = -t660+t661
      t1279 = (-t980*t315+2*t980*t426)*t10
      t1292 = t449*t10
      t1321 = (-t921*(-6-t852+t559)+2*t921*(t852+1-z))*t10
      t1345 = (-t921*(5+t852+z)+2*t921*(-z-1-t852))*t10
      t1356 = 2*t425
      t1358 = (-t396*t820+t1356)*t1
      t1362 = (-t396*t547+t1356)*t1
      t1375 = (-t980*(6-8*z+4*t569)+2*t980*(-1-t852+t155))*t10
      t1379 = t569*l3*t4
      t1406 = (t396*t377+2*t1061)*t1*t10
      t1412 = t823*t10
      t1424 = (-t449*t500+t1089)*t1
      t1431 = (t426*t562-2+t155)*t10
      t1453 = (-t449*t287+t981)*t1*t10
      t1461 = (t569-5*z+4)*t10
      s3 = ((1024*t8*t13*s2l2*s1vr-1024*t20*t13*s34r*s2l2+1024*t27+1024*
     #t30)*s1l1+(-1024*t8*t13*s2l1*s1vr+1024*t20*t13*s34r*s2l1-1024*t41-
     #1024*t44)*s1l2+((-1536*t48-1536*t49)*s2l1+(1536*t53+1536*t54)*s2l2
     #)*s1vr+((1536*t20*t26+1536*t20*t29)*s34r+1536*t27+1536*t30)*s2l1+(
     #(-1536*t20*t40-1536*t20*t43)*s34r-1536*t41-1536*t44)*s2l2)*t79*s13
     #r+t388*t79
      s2 = s3+t908*s13r+((1536*t912*t163*t407-3072*t917*t163*s23r+1536*t
     #921*t26)*t85+((-1024*t911*t90-1536*t911*t26-1536*t911*t29)*t933+(t
     #940*s2l2+(-1536*t936*t26-1536*t936*t29)*s34r-512*t951*t163-1536*t3
     #91*t29)*t407+(t961*s2l2+(3584*t403+1536*t404)*s34r+512*t971*t163+1
     #536*t974)*s23r-2048*t978+512*t983*t163)*s1vr+(-1024*t391*t90+256*t
     #995*t163+256*t995*t295)*t933+(t1006*s2l2+(256*t1013*t26-256*t1019*
     #t29)*s34r+256*t1029*t163-256*t1040*t295)*t407+(t1048*s2l2+(-1280*t
     #418-t1051)*t137+(256*t1059*t26-256*t1065*t29)*s34r+256*t1074*t163-
     #512*t1077*t1079*t295)*s23r+(1280*t93-768*t95)*t137+(-256*t1091*t26
     #-t1094)*s34r-256*t1098*t163)*s1l1
      s3 = s2+((-1536*t912*t216*t407+3072*t917*t216*s23r-1536*t921*t40)*
     #t85+((1024*t911*t175+1536*t911*t40+1536*t911*t43)*t933+(-t940*s2l1
     #+(1536*t936*t40+1536*t936*t43)*s34r+512*t951*t216+1536*t391*t43)*t
     #407+(-t961*s2l1+(-3584*t584-1536*t585)*s34r-512*t971*t216-1536*t11
     #42)*s23r+2048*t1146-512*t983*t216)*s1vr+(1024*t391*t175-256*t995*t
     #216-256*t995*t304)*t933+(-t1006*s2l1+(-256*t1013*t40+256*t1019*t43
     #)*s34r-256*t1029*t216+256*t1040*t304)*t407+(-t1048*s2l1+(1280*t591
     #+t1176)*t137+(-256*t1059*t40+256*t1065*t43)*s34r-256*t1074*t216+51
     #2*t1077*t1079*t304)*s23r+(-1280*t178+768*t180)*t137+(256*t1091*t40
     #+t1197)*s34r+256*t1098*t216)*s1l2
      s1 = s3+((1536*t912*t1204-1536*t912*t1206-1536*t912*t382+1536*t912
     #*t385)*t407+(-3072*t917*t1204+3072*t917*t1206+3072*t917*t382-3072*
     #t917*t385)*s23r+1536*t1220*t1204-1536*t1220*t1206-1536*t1220*t382+
     #1536*t1220*t385)*t85+((-512*t1235*t1204+512*t1235*t1206-3072*t1232
     #*t229+3072*t1232*t231)*t407+((1024*t392*t111+512*t1254*t163)*s2l1+
     #(-1024*t392*t187-512*t1254*t216)*s2l2+1536*t1265*s34r+1536*t1026*t
     #229-1536*t1026*t231)*s23r+(-1024*t978-512*t1279*t163)*s2l1+(1024*t
     #1146+512*t1279*t216)*s2l2+(1536*t669-1536*t671)*s34r-1536*t1292*t3
     #82+1536*t1292*t385)*s1vr+((-1024*t916*t26-1024*t916*t29)*s2l1+(102
     #4*t916*t40+1024*t916*t43)*s2l2)*t933
      s2 = s1+(((-1792*t403-1280*t404)*s34r+256*t1321*t163-2048*t974)*s2
     #l1+((1792*t584+1280*t585)*s34r-256*t1321*t216+2048*t1142)*s2l2-768
     #*t1265*s34r+256*t1345*t382-256*t1345*t385)*t407+(((-768*t418-t1051
     #)*t137+(256*t1358*t26-256*t1362*t29)*s34r+256*t1375*t163-1024*t137
     #9*t29)*s2l1+((768*t591+t1176)*t137+(-256*t1358*t40+256*t1362*t43)*
     #s34r-256*t1375*t216+1024*t1379*t43)*s2l2-768*t706*t137+(512*t1406*
     #t382-512*t1406*t385)*s34r-256*t1412*t382+256*t1412*t385)*s23r+((76
     #8*t93-768*t95)*t137+(-256*t1424*t26-t1094)*s34r-256*t1431*t163)*s2
     #l1
      taux2 = s2+((-768*t178+768*t180)*t137+(256*t1424*t40+t1197)*s34r+2
     #56*t1431*t216)*s2l2-1792*t743*t137+(-256*t1453*t382+256*t1453*t385
     #)*s34r-256*t1461*t382+256*t1461*t385

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = taux2

CCC Jet functions

      t1 = 1-l3
      t2 = -z+1
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,27.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t2 = -z+1
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet2 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,27.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = 1-l3
      t2 = -z+1
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,28.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t2 = -z+1
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet4 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,28.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      B2num1e1 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcoff4
      RETURN
      END

      double precision function B2num1e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3**2
      t2 = z*t1
      t3 = -1+z
      t4 = t3**2
      t5 = t4**2
      t6 = t5*t4
      t8 = l3-1
      t9 = t8**2
      t10 = t9**2
      t11 = s4vr**2
      t12 = 1/t11
      t13 = t10*t12
      t14 = s3vr**2
      t15 = 1/t14
      t16 = s34r**2
      t17 = t15*t16
      t21 = z*l3
      t22 = t9*t8
      t25 = z+1
      t26 = t25*t12
      t27 = t15*s34r
      t28 = t26*t27
      t33 = z**2
      t34 = 2*z
      t35 = t33+t34+1
      t37 = t35*t12*t15
      t41 = s13r**2
      t44 = t1*l3*z
      t45 = t44*t6
      t46 = t22*t12
      t51 = t2*t5*t9
      t54 = t21*t4
      t62 = t4*t3
      t63 = t5*t62
      t66 = t15*t16*s34r
      t70 = t5*t3
      t76 = (3*z+1)*t12*t17
      t82 = 3*t33+t34-1
      t93 = t1**2
      t94 = t93*z
      t103 = t8*t12*t27
      t110 = s23r**2
      t113 = t46*t66
      taux1 = (-64*t2*t6*t13*t17-128*t21*t5*t22*t28-64*z*t4*t9*t37)*t41+
     #((128*t45*t46*t17+256*t51*t28+128*t54*t35*t8*t12*t15)*s23r+64*t44*
     #t63*t13*t66+64*t2*t70*t22*t76+64*t21*t62*t9*t82*t12*t27+64*t4*t8*z
     #*t37)*s13r+(-64*t94*t6*t9*t12*t17-128*t44*t5*t25*t103-64*t2*t4*t37
     #)*t110+(-64*t94*t63*t113-64*t44*t70*t9*t76-64*t2*t62*t82*t103-64*t
     #54*t37)*s23r+64*t45*t113+128*t51*t26*t17+64*t21*t4*t35*t103
      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = -1+z
      t5 = t4**2
      t6 = t5*t4
      t7 = t3*t6
      t8 = s4vr**2
      t9 = 1/t8
      t10 = s3vr**2
      t11 = 1/t10
      t12 = t9*t11
      t13 = t12*s3l2
      t14 = t7*t13
      t15 = t9*s4l2
      t16 = t15*t11
      t17 = t7*t16
      t21 = t12*s3l1
      t22 = t7*t21
      t23 = t9*s4l1
      t24 = t23*t11
      t25 = t7*t24
      t29 = t5**2
      t30 = l3*t29
      t31 = t30*t3
      t32 = t31*t13
      t33 = t31*t16
      t37 = t31*t21
      t38 = t31*t24
      t44 = t2**2
      t45 = t29*t4
      t47 = t44*t45*l3
      t67 = s13r**2
      t70 = l3**2
      t71 = t70*t29
      t72 = t71*t2
      t73 = s1vr**2
      t78 = t72*t13
      t79 = t72*t16
      t80 = t78+t79
      t84 = t70*t45*t3
      t86 = t12*s3l2*s34r
      t89 = l3*t6
      t90 = t89*t2
      t91 = t90*t13
      t95 = t84*t13
      t96 = t84*t16
      t98 = -1024*t95-1024*t96
      t105 = t29*t5
      t107 = t44*t105*t70
      t108 = s34r**2
      t117 = t5*t2
      t118 = z+1
      t119 = t117*t118
      t120 = 2*z
      t121 = t120-6
      t125 = (-t119+2*t117*t121)*t9
      t126 = t11*s3l2
      t132 = (-t119-8*t117*z)*t9
      t133 = s4l2*t11
      t142 = t72*t21
      t143 = t72*t24
      t144 = -t142-t143
      t148 = t12*s3l1*s34r
      t151 = t90*t21
      t155 = t84*t21
      t156 = t84*t24
      t158 = 1024*t155+1024*t156
      t173 = t11*s3l1
      t176 = s4l1*t11
      t182 = t12*s3l2*s2l1
      t185 = t12*s3l1*s2l2
      t187 = t15*t173
      t188 = t72*t187
      t189 = t23*t126
      t190 = t72*t189
      t202 = t95-t96
      t207 = l3*(z-4)*t6
      t208 = t2*t9
      t212 = t30*t2
      t217 = -t155+t156
      t229 = -t84*t187+t84*t189
      t241 = (t120-8)*t9
      t262 = t11*t108
      t266 = t120-1
      t271 = (-t31+2*t30*t3*t266)*t9
      t273 = -t120-3
      t278 = (-t31+2*t30*t3*t273)*t9
      t283 = 6*z
      t288 = (-t119+2*t117*(t283-10))*t9
      t295 = (-t119+2*t117*(-t283+2))*t9
      t324 = z+7
      t325 = t117*t324
      s2 = (-1024*t72*t12*s3l2*t73+(1024*t80*s23r+2048*t84*t86+1024*t91)
     #*s1vr+(t98*s34r+2048*t91+2048*t90*t16)*s23r-1024*t107*t12*s3l2*t10
     #8+(256*t32+1792*t33)*s34r+256*t125*t126-256*t132*t133)*s1l1+(1024*
     #t72*t12*s3l1*t73+(1024*t144*s23r-2048*t84*t148-1024*t151)*s1vr+(t1
     #58*s34r-2048*t151-2048*t90*t24)*s23r+1024*t107*t12*s3l1*t108+(-256
     #*t37-1792*t38)*s34r-256*t125*t173+256*t132*t176)*s1l2
      s1 = s2+(-1024*t72*t182+1024*t72*t185+1024*t188-1024*t190)*t73+((-
     #2048*t80*s2l1-2048*t144*s2l2)*s23r+(1024*t202*s34r-1024*t207*t208*
     #t126-1024*t212*t16)*s2l1+(1024*t217*s34r+1024*t207*t208*t173+1024*
     #t212*t24)*s2l2+2048*t229*s34r-2048*t90*t187+2048*t90*t189)*s1vr+((
     #-t98*s34r-512*t90*t241*t126-512*t90*t241*t133)*s2l1+(-t158*s34r+51
     #2*t90*t241*t173+512*t90*t241*t176)*s2l2)*s23r
      t330 = s1+(1024*t107*t15*t262+(256*t271*t126-256*t278*t133)*s34r+2
     #56*t288*t126-256*t295*t133)*s2l1+(-1024*t107*t23*t262+(-256*t271*t
     #173+256*t278*t176)*s34r-256*t288*t173+256*t295*t176)*s2l2+(1024*t1
     #07*t187-1024*t107*t189)*t108+(1536*t31*t187-1536*t31*t189)*s34r+51
     #2*t325*t187-512*t325*t189
      t332 = t70*l3
      t333 = t332*t29
      t334 = t333*t1
      t338 = t70*t6
      t339 = t338*t1
      t344 = t334*t13
      t345 = t334*t16
      t346 = -t344-t345
      t348 = s23r**2
      t351 = t332*t45*t2
      t352 = t351*t13
      t354 = t351*t16
      t359 = t70*t118*t6
      t360 = t1*t9
      t361 = t360*t126
      t364 = t71*t1
      t366 = 1024*t364*t16
      t371 = l3*t5
      t372 = t371*t1
      t381 = t338*(4+t120)
      t384 = t360*t133
      t390 = t332*t105*t3
      t401 = (-t72+2*t71*t2*(z+4))*t9
      t403 = z-2
      t408 = (-t72+2*t71*t2*t403)*t9
      t409 = t408*t133
      t413 = t371*t118
      t418 = (-t413+2*t371*(t120-4))*t1
      t421 = t371*z
      t424 = (-t413-4*t421)*t1
      t434 = t89*t2*t266
      t437 = (-t434+2*t212)*t9
      t439 = t120+1
      t441 = t89*t2*t439
      t442 = 3*z
      t443 = -t442-1
      t448 = (-t441+2*t89*t2*t443)*t9
      t453 = -t4
      t454 = z**2
      t455 = t454-z-2
      t456 = t453*t455
      t457 = 2*t4
      t458 = 4*z
      t462 = (t456+t457*(6-t458))*t1
      t465 = z*t4
      t466 = t465*t118
      t470 = (-t466-4*t454*t4)*t1
      t482 = t334*t21
      t483 = t334*t24
      t484 = t482+t483
      t487 = t351*t21
      t489 = t351*t24
      t493 = t360*t173
      t497 = 1024*t364*t24
      t511 = t360*t176
      t522 = t408*t176
      t549 = t334*t187
      t550 = t334*t189
      t558 = t339*t187
      t560 = t339*t189
      t577 = t70*(t442-5)*t6
      t591 = t351*t187-t351*t189
      t605 = l3*(t442-4)*t5
      t608 = z*l3
      t609 = t608*t1
      t610 = t5*t9
      t612 = t609*t610*t133
      t622 = t609*t610*t176
      t626 = -t188+t190
      t631 = t5*t1
      t632 = l3*(z-3)*t631
      t639 = t338*t121
      t652 = z+2
      t657 = (-t72+2*t71*t2*t652)*t9
      t666 = (-t413+2*t371*(-7-t454+t283))*t1
      t673 = (-t413+2*t371*(t454-t458+1))*t1
      t690 = t70*t439*t29*t2
      t696 = z-5
      t698 = t371*t696*t1
      t708 = -z-3
      t713 = (-t434+2*t89*t2*t708)*t9
      t719 = (-t441+2*t89*t2*t453)*t9
      t725 = 2*t454
      t729 = (t456+t457*(-10*z+8+t725))*t1
      t736 = (-t466-2*t465*t457)*t1
      t759 = t89*t2*t118
      t766 = t5*t324*t1
      s3 = ((2048*t334*t12*s3l2*s23r-2048*t339*t13)*t73+(2048*t346*t348+
     #((-3072*t352-1024*t354)*s34r+1024*t359*t361-t366)*s23r+4096*t72*t8
     #6+2048*t372*t13)*s1vr+((1024*t352+1024*t354)*s34r-512*t381*t361-51
     #2*t381*t384)*t348+((1024*t390*t13+1024*t390*t16)*t108+(-512*t401*t
     #126+512*t409)*s34r-512*t418*t13+512*t424*t16)*s23r+(-2304*t95-768*
     #t96)*t108+(-256*t437*t126+256*t448*t133)*s34r-256*t462*t13+256*t47
     #0*t16)*s1l1
      s4 = ((-2048*t334*t12*s3l1*s23r+2048*t339*t21)*t73+(2048*t484*t348
     #+((3072*t487+1024*t489)*s34r-1024*t359*t493+t497)*s23r-4096*t72*t1
     #48-2048*t372*t21)*s1vr+((-1024*t487-1024*t489)*s34r+512*t381*t493+
     #512*t381*t511)*t348+((-1024*t390*t21-1024*t390*t24)*t108+(512*t401
     #*t173-512*t522)*s34r+512*t418*t21-512*t424*t24)*s23r+(2304*t155+76
     #8*t156)*t108+(256*t437*t173-256*t448*t176)*s34r+256*t462*t21-256*t
     #470*t24)*s1l2+((2048*t334*t182-2048*t334*t185-2048*t549+2048*t550)
     #*s23r-2048*t339*t182+2048*t339*t185+2048*t558-2048*t560)*t73
      s2 = s3+s4
      s1 = s2+((-1024*t346*s2l1-1024*t484*s2l2)*t348+(((-1024*t352+1024*
     #t354)*s34r+1024*t577*t361+t366)*s2l1+((1024*t487-1024*t489)*s34r-1
     #024*t577*t493-t497)*s2l2+2048*t591*s34r-2048*t364*t187+2048*t364*t
     #189)*s23r+((1024*t78-1024*t79)*s34r-1024*t605*t361-1024*t612)*s2l1
     #+((-1024*t142+1024*t143)*s34r+1024*t605*t493+1024*t622)*s2l2+3072*
     #t626*s34r+1024*t632*t187-1024*t632*t189)*s1vr+((512*t639*t361+512*
     #t639*t384)*s2l1+(-512*t639*t493-512*t639*t511)*s2l2)*t348+(((-512*
     #t657*t126+512*t409)*s34r-512*t666*t13+512*t673*t16)*s2l1+((512*t65
     #7*t173-512*t522)*s34r+512*t666*t21-512*t673*t24)*s2l2+(1024*t690*t
     #187-1024*t690*t189)*s34r+1024*t698*t187-1024*t698*t189)*s23r
      t771 = s1+(-256*t202*t108+(-256*t713*t126+256*t719*t133)*s34r-256*
     #t729*t13+256*t736*t16)*s2l1+(-256*t217*t108+(256*t713*t173-256*t71
     #9*t176)*s34r+256*t729*t21-256*t736*t24)*s2l2-1536*t229*t108+(-1024
     #*t759*t187+1024*t759*t189)*s34r-512*t766*t187+512*t766*t189
      t773 = t70**2
      t774 = t773*t29
      t775 = t774*t9
      t779 = t332*t6
      t780 = t779*t9
      t784 = t70*t5
      t793 = t348*s23r
      t796 = t773*t45*t1
      t803 = t332*t652*t6
      t814 = t784*z
      t823 = l3*t4
      t828 = 2*t118
      t829 = t779*t828
      t839 = (-t333+2*t333*(t120+5))*t1
      t844 = (-t333+2*t333*t273)*t1
      t849 = t784*t118
      t852 = (-t849-8*t784)*t9
      t860 = (-t849+2*t784*(-2*z-2*t454))*t9
      t866 = 768*t354
      t869 = t338*t266
      t874 = (-t869+2*t338*(-z-5))*t1
      t876 = t338*t439
      t881 = (-t876-2*t338*t118)*t1
      t886 = t823*t455
      t891 = (-t886+8*t823*t453)*t9
      t894 = t608*t4
      t895 = t118*t9
      t902 = 512*t79
      t905 = t608*t631
      t906 = t11*s34r
      t910 = t453*t118
      t912 = (t910+4-t458)*t9
      t976 = 768*t489
      t992 = 512*t143
      t1002 = t126*s2l1
      t1004 = t173*s2l2
      t1006 = t133*s3l1
      t1008 = t176*s3l2
      t1020 = t784*t9
      t1032 = t332*t266*t6
      t1038 = t332*z*t6
      t1046 = t784*(t458-2)
      t1051 = t549-t550
      t1056 = t70*(t442-1)*t5
      t1064 = l3*t266*t4
      t1072 = t371*t9
      t1099 = (-t849+2*t784*(-6-t725+t458))*t9
      t1104 = (-t849-8*t814)*t9
      t1123 = t784*(5+t725+z)
      t1136 = (-t869+2*t338*t696)*t1
      t1141 = (-t876+2*t338*t443)*t1
      t1152 = (-t886+2*t823*(6-8*z+4*t454))*t9
      t1161 = (-t608*t4*t118-4*t454*l3*t4)*t9
      t1185 = -t338*t708*t1
      t1191 = t371*t696
      t1204 = (-2*t421+2*t371*t403)*t1
      t1210 = t457**2
      t1212 = (t910+t1210)*t9
      t1238 = (-t371*t828-2*t371*t266)*t1*t9
      t1246 = (-3*t454+t458-5)*t9
      s3 = ((-1024*t14-1024*t17)*s1l1+(1024*t22+1024*t25)*s1l2+((1024*t3
     #2+1024*t33)*s2l1+(-1024*t37-1024*t38)*s2l2)*s1vr+((-1024*t47*t13-1
     #024*t47*t16)*s34r-2048*t14-2048*t17)*s2l1+((1024*t47*t21+1024*t47*
     #t24)*s34r+2048*t22+2048*t25)*s2l2)*t67*s13r+t330*t67
      s2 = s3+t771*s13r+((-1024*t775*t126*t348+2048*t780*t126*s23r-1024*
     #t784*t13)*t73+((1024*t774*t13+1024*t774*t16)*t793+((1024*t796*t13+
     #1024*t796*t16)*s34r-1024*t803*t13+1024*t333*t16)*t348+((-3072*t344
     #-1024*t345)*s34r+1024*t814*t13-1024*t814*t16)*s23r+2048*t339*t86+1
     #024*t823*t13)*s1vr+(512*t829*t13+512*t829*t16)*t793+((256*t839*t13
     #-256*t844*t16)*s34r+256*t852*t126-256*t860*t133)*t348+((1280*t352+
     #t866)*t108+(256*t874*t13-256*t881*t16)*s34r+256*t891*t126+256*t894
     #*t895*t133)*s23r+(-1280*t78+t902)*t108+512*t905*t15*t906-256*t912*
     #t126)*s1l1
      s3 = s2+((1024*t775*t173*t348-2048*t780*t173*s23r+1024*t784*t21)*t
     #73+((-1024*t774*t21-1024*t774*t24)*t793+((-1024*t796*t21-1024*t796
     #*t24)*s34r+1024*t803*t21-1024*t333*t24)*t348+((3072*t482+1024*t483
     #)*s34r-1024*t814*t21+1024*t814*t24)*s23r-2048*t339*t148-1024*t823*
     #t21)*s1vr+(-512*t829*t21-512*t829*t24)*t793+((-256*t839*t21+256*t8
     #44*t24)*s34r-256*t852*t173+256*t860*t176)*t348+((-1280*t487-t976)*
     #t108+(-256*t874*t21+256*t881*t24)*s34r-256*t891*t173-256*t894*t895
     #*t176)*s23r+(1280*t142-t992)*t108-512*t905*t23*t906+256*t912*t173)
     #*s1l2
      s1 = s3+((-1024*t775*t1002+1024*t775*t1004+1024*t775*t1006-1024*t7
     #75*t1008)*t348+(2048*t780*t1002-2048*t780*t1004-2048*t780*t1006+20
     #48*t780*t1008)*s23r-1024*t1020*t1002+1024*t1020*t1004+1024*t1020*t
     #1006-1024*t1020*t1008)*t73+((-1024*t1032*t182+1024*t1032*t185+2048
     #*t1038*t187-2048*t1038*t189)*t348+(1024*t1046*t182-1024*t1046*t185
     #+1024*t1051*s34r-1024*t1056*t187+1024*t1056*t189)*s23r-1024*t1064*
     #t182+1024*t1064*t185+(-1024*t558+1024*t560)*s34r+1024*t1072*t1006-
     #1024*t1072*t1008)*s1vr+((1024*t779*t13+1024*t779*t16)*s2l1+(-1024*
     #t779*t21-1024*t779*t24)*s2l2)*t793
      s2 = s1+(((1280*t344+1792*t345)*s34r+256*t1099*t126-256*t1104*t133
     #)*s2l1+((-1280*t482-1792*t483)*s34r-256*t1099*t173+256*t1104*t176)
     #*s2l2-512*t1051*s34r+512*t1123*t187-512*t1123*t189)*t348+(((256*t3
     #52+t866)*t108+(256*t1136*t13-256*t1141*t16)*s34r+256*t1152*t126-25
     #6*t1161*t133)*s2l1+((-256*t487-t976)*t108+(-256*t1136*t21+256*t114
     #1*t24)*s34r-256*t1152*t173+256*t1161*t176)*s2l2-512*t591*t108+(102
     #4*t1185*t187-1024*t1185*t189)*s34r-512*t1191*t187+512*t1191*t189)*
     #s23r+((-256*t78+t902)*t108+(-256*t1204*t13+512*t612)*s34r-256*t121
     #2*t126)*s2l1
      taux2 = s2+((256*t142-t992)*t108+(256*t1204*t21-512*t622)*s34r+256
     #*t1212*t173)*s2l2-1792*t626*t108+(-256*t1238*t1006+256*t1238*t1008
     #)*s34r-256*t1246*t1006+256*t1246*t1008

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = taux2

CCC Jet functions

      t1 = 1-l3
      t2 = -z+1
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,27.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t2 = -z+1
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet2 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,27.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = 1-l3
      t2 = -z+1
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,28.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t2 = -z+1
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet4 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,28.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      B2num1e2 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcoff4
      RETURN
      END

      double precision function B2num1e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux1 = 0
      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = -1+z
      t5 = t4**2
      t6 = t5**2
      t8 = t3*t6*l3
      t9 = s4vr**2
      t10 = 1/t9
      t11 = s3vr**2
      t12 = 1/t11
      t13 = t10*t12
      t14 = t13*s3l2
      t16 = t10*s4l2
      t17 = t16*t12
      t23 = z+1
      t24 = t5*t2*t23
      t29 = (512*t8*t14-512*t8*t17)*s34r+512*t24*t14-512*t24*t17
      t31 = t13*s3l1
      t33 = t10*s4l1
      t34 = t33*t12
      t43 = (-512*t8*t31+512*t8*t34)*s34r-512*t24*t31+512*t24*t34
      t48 = s13r**2
      t50 = l3**2
      t52 = t50*t6*t2
      t58 = l3*t5
      t59 = t58*t23
      t60 = t1*t10
      t61 = t12*s3l2
      t62 = t60*t61
      t65 = s4l2*t12
      t66 = t60*t65
      t69 = (-1024*t52*t14+1024*t52*t17)*s34r-1024*t59*t62+1024*t59*t66
      t71 = t6*t4
      t73 = t50*t71*t3
      t78 = s34r**2
      t79 = (-512*t73*t14+512*t73*t17)*t78
      t80 = t5*t4
      t82 = l3*t80*t2
      t83 = 2*z
      t84 = t83-1
      t85 = t84*t10
      t88 = t83+1
      t89 = t88*t10
      t94 = (-512*t82*t85*t61+512*t82*t89*t65)*s34r
      t95 = z**2
      t96 = t95-z-2
      t98 = t4*t96*t1
      t100 = 512*t98*t14
      t102 = z*t4*t23
      t104 = 512*t102*t66
      t112 = t12*s3l1
      t113 = t60*t112
      t116 = s4l1*t12
      t117 = t60*t116
      t120 = (1024*t52*t31-1024*t52*t34)*s34r+1024*t59*t113-1024*t59*t11
     #7
      t126 = (512*t73*t31-512*t73*t34)*t78
      t133 = (512*t82*t85*t112-512*t82*t89*t116)*s34r
      t135 = 512*t98*t31
      t137 = 512*t102*t117
      t150 = t50*l3
      t152 = t150*t6*t1
      t159 = t50*t5*t23
      t164 = (512*t152*t14-512*t152*t17)*s34r+512*t159*t14-512*t159*t17
      t165 = s23r**2
      t168 = t150*t71*t2
      t175 = t50*t80*t84
      t178 = t50*t88*t80
      t184 = t4*l3*t96
      t188 = z*l3*t4
      t189 = t23*t10
      t193 = (512*t168*t14-512*t168*t17)*t78+(512*t175*t62-512*t178*t66)
     #*s34r+512*t184*t14-512*t188*t189*t65
      t198 = 512*t52*t13*s3l2*t78
      t200 = t58*z*t1
      t204 = 1024*t200*t13*s3l2*s34r
      t205 = t4*t23
      t207 = 512*t205*t14
      t219 = (-512*t152*t31+512*t152*t34)*s34r-512*t159*t31+512*t159*t34
      t236 = (-512*t168*t31+512*t168*t34)*t78+(-512*t175*t113+512*t178*t
     #117)*s34r-512*t184*t31+512*t188*t189*t116
      t241 = 512*t52*t13*s3l1*t78
      t245 = 1024*t200*t13*s3l1*s34r
      t247 = 512*t205*t31
      t262 = t16*t112
      t264 = t33*t61
      t271 = 2*t58*t23*t1
      t278 = (1+t95+t83)*t10
      taux2 = (t29*s1l1+t43*s1l2+t29*s2l1+t43*s2l2)*t48+((t69*s23r+t79+t
     #94-t100+t104)*s1l1+(t120*s23r+t126+t133+t135-t137)*s1l2+(t69*s2l1+
     #t120*s2l2)*s23r+(t79+t94-t100+t104)*s2l1+(t126+t133+t135-t137)*s2l
     #2)*s13r+(t164*t165+t193*s23r-t198-t204-t207)*s1l1+(t219*t165+t236*
     #s23r+t241+t245+t247)*s1l2+(t164*s2l1+t219*s2l2)*t165+(t193*s2l1+t2
     #36*s2l2)*s23r+(-t198-t204-t207)*s2l1+(t241+t245+t247)*s2l2+(-512*t
     #52*t262+512*t52*t264)*t78+(-512*t271*t262+512*t271*t264)*s34r-512*
     #t278*t65*s3l1+512*t278*t116*s3l2

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = taux2

CCC Jet functions

      t1 = 1-l3
      t2 = -z+1
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,27.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t2 = -z+1
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet2 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,27.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = 1-l3
      t2 = -z+1
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,28.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t2 = -z+1
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet4 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,28.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      B2num1e3 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcoff4
      RETURN
      END

      double precision function B2num1e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux1 = 0
      taux2 = 0

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = taux2

CCC Jet functions

      t1 = 1-l3
      t2 = -z+1
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,27.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t2 = -z+1
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet2 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,27.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = 1-l3
      t2 = -z+1
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,28.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t2 = -z+1
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet4 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,28.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      B2num1e4 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcoff4
      RETURN
      END

