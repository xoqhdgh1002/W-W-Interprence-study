CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCC Numerator functions CCCCCCCCCCCCCCCCCCCCCCCCCC

      double precision function A2num1e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = t1**2
      t3 = t2**2
      t4 = l3*t3
      t5 = l3-1
      t6 = t5**2
      t7 = t6*t5
      t8 = z*t7
      t10 = l1**2
      t11 = r**2
      t13 = 1+t11
      t14 = t13**2
      t15 = r+t
      t16 = t15**2
      t19 = r*t
      t20 = 1+t19
      t21 = t20**2
      t23 = t14/t16/t21
      t24 = t10*t11*t23
      t29 = t2*t1
      t30 = t29*z
      t31 = 2*l3
      t32 = t31-1
      t33 = t32*t6
      t39 = 1/t15
      t41 = 1/t20
      t42 = t13*t39*t41
      t44 = z*l3
      t49 = t2*z
      t53 = s13r**2
      t55 = l3*t29
      t60 = l3*t2
      t61 = t5*s2l1
      t64 = z*t5
      t65 = t60*t64
      t69 = t6*s34r
      t71 = t2*t32
      t80 = l3*t1
      t83 = t80*z
      t84 = 256*t83
      t87 = t5*t2
      t89 = t87*l3*s34r
      t90 = t1*t5
      t96 = l3**2
      t97 = t96*z
      t98 = t3*t1
      t99 = t98*t7
      t101 = t10*l1
      t102 = t11*r
      t110 = t14*t13/t16/t15/t21/t20
      t114 = s2l1**2
      t121 = z*t6
      t130 = t55*t121*s3l1
      t132 = 3*l3
      t133 = 3*t44
      t152 = 512*t65
      t156 = 2*t44
      t163 = 4*l3
      t169 = 3*t96
      t170 = 3*t97
      t179 = z*s2l1
      t185 = t80*s3l1
      t191 = 256*t64*t60*s3l1
      t192 = t44-l3+1
      t198 = t1*z
      t201 = 256*t198*t32*s3l1
      t207 = t96*t5
      t211 = t96*t3
      t212 = t211*t69
      t214 = 128*t65
      t219 = t96*t2
      t220 = s23r**2
      t224 = t207*t29*s34r
      t229 = s34r**2
      t230 = t6*t229
      t233 = 3*z
      t240 = t32*z*t1
      t246 = t219*s34r
      t258 = t96*t6
      t259 = t229*s34r
      t271 = s1l1**2
      t273 = t3*s3l1
      t274 = t258*t273
      t275 = 256*t274
      t276 = t6*t3
      t277 = t276*t97
      t279 = -t275+128*t277
      t287 = t207*t29*s3l1
      t289 = t207*t30
      t294 = 384*t277
      t297 = -t132+t133+2-z
      t299 = t87*s3l1
      t302 = 2*z
      t304 = (-t132+t133+1-t302)*l3
      t305 = t49*t5
      t329 = 4*t44
      t335 = 6*t44
      t336 = 6*l3
      t337 = 4*z
      t344 = -t169+t170-1+t163-t156
      t349 = (-t169+t170+z-t329+t31)*t1
      t382 = t29*t5
      t400 = t44-z-l3
      t401 = t400*z
      t406 = t7*t3*t2
      t407 = t96*l3
      t408 = t407*z
      t410 = t10**2
      t411 = t11**2
      t413 = t14**2
      t414 = t16**2
      t417 = t21**2
      t429 = t408*s34r
      t432 = s3l1**2
      t434 = t258*t3*t432
      t444 = t5*t3
      t448 = t98*t6
      t491 = z**2
      t492 = t491*l3
      t494 = 24*t44
      t496 = t491*t96
      t497 = 12*t496
      t498 = 24*t97
      t499 = 12*t96
      t519 = t207*t29
      t536 = t5*(t156-t31-z)
      t558 = t276*t96
      t585 = 4*t96
      t609 = 2*t96
      t615 = z*s3l1
      t617 = 256*t80*t615
      t664 = t329-5*t492+8*t496-12*t97+t585+t491-l3-z+8*t408-4*t491*t407
     #-4*t407
      t687 = 1+u
      t688 = t687**2
      t689 = 1/t688
      t691 = t102*t
      t692 = dsqrt(l1)
      t693 = t692*l2
      t696 = t411*r
      t697 = t696*l2
      t698 = t692*l1
      t699 = t698*t
      t702 = t411*t11
      t704 = t692*t10
      t705 = t**2
      t706 = t704*t705
      t708 = t102*l2
      t709 = t705*t
      t710 = t704*t709
      t712 = r*l2
      t713 = t704*t
      t715 = t702*t692
      t718 = t411*t698
      t721 = t411*t692
      t733 = t11*l1
      t736 = l1*r
      t742 = dsqrt(-l2*(1-l1)*(l2-1)*t14*r*(t11*t+t733*t+r+r*t705-t736-t
     #736*t705+t+l1*t))
      t743 = r*t742
      t748 = t411*l2
      t752 = 5*t691*t693+3*t697*t699+t702*l2*t706-t708*t710-t712*t713+2*
     #t715*l2-3*t718*l2+5*t721*l2-2*t102*t692*t+2*t743*t-r*t692*t+t748*t
     #704-2*t733*t742
      t753 = t11*l2
      t757 = t411*t102
      t760 = t702*t698
      t762 = l1*t742
      t766 = t11*t698
      t773 = t11*t692
      t781 = t698*t705
      t786 = t753*t704-t696*t692*t-t757*t698*t-t760*l2-4*t691*t762*l4-t7
     #66*l2-2*t696*t698*t-t102*t698*t+3*t773*l2-4*t743*l4*t+3*t748*t706-
     #2*t748*t781-2*t697*t713
      t788 = t696*t709
      t789 = t698*l2
      t798 = t11*t742
      t814 = t102*t709
      t817 = 2*t788*t789+2*t696*t*t693+4*t733*t742*l4+2*t798-2*t721+2*t7
     #18-4*t798*l4+2*t691*t762+3*t19*t693+2*t753*t706-2*t753*t781-3*t708
     #*t713+2*t814*t789
      t829 = t708*t699-t814*t693-t411*t705*t693-t715-t773-t697*t710-t788
     #*t693-t702*t705*t693+t757*l2*t699-t712*t699+t789+t766+t760
      t831 = t752+t786+t817+t829
      t832 = t831**2
      t834 = t11+t19+l1-t736*t
      t835 = t834**2
      t850 = 1-l1*l3*r*t1*t687*t39*t41
      t852 = s34spinc(z,l1,l2,l3,l4,l5,l6,l7,l8)
      t859 = t850**2
      t860 = t852**2
      t867 = (-128*t80*t400*s34r+128*z)*t114+((-256*t80*t400*s3l1+128*t8
     #3)*s34r-256*t400*s3l1+128*t192*z)*s2l1+64*t558*t401*t259+64*t44*t2
     #9*t5*(t170-t169+l3-5*t44+t302)*t229+(-256*t80*t400*t432+t617-64*t1
     #98*t664)*s34r+(-512*t44+512*l3+256*z)*t432+256*t615+64*(-4*t97+2*t
     #496+t609+t329-2*t492-t31+t491+1)*z+128*(-t491-2*t114-2*t179)/r*t39
     #*t41*t689*t832/t835+256*(z+2*s2l1)*t850*t852*t689*t831/t834-256*t8
     #59*t860*r*t15*t20*t689
      s3 = (128*t4*t8*t24+(-128*t4*t8*s34r-128*t30*t33)*l1*r*t42+128*t44
     #*t29*t6*s34r+128*t49*t6)*t53
      s4 = ((-256*t55*t6*s2l1*t24+((512*t60*t61+256*t65)*s23r+(256*t55*t
     #69+256*t71*t5)*s2l1)*l1*r*t42+(-512*t80*s2l1-t84)*s23r+(-256*t89-2
     #56*t90)*s2l1)*s1l1-128*t97*t99*t101*t102*t110+(256*t55*t6*t114+(51
     #2*t55*t6*s3l1+256*t55*t121)*s2l1+128*t97*t99*s34r+512*t130-128*t55
     #*t121*(t132-t133-2))*t10*t11*t23+(256*t60*z*t61*s23r-512*t60*t5*t1
     #14+(-1024*t60*t5*s3l1-t152)*s2l1+(-256*t130-128*t55*t121*(t156-t31
     #+1))*s34r-256*t49*(t163-1)*t5*s3l1+128*t49*t5*(t169-t170-t163+1))*
     #l1*r*t42-256*t80*t179*s23r+256*t80*t114+(512*t185+t84)*s2l1+(t191+
     #128*t60*t64*t192)*s34r+t201-128*t198*(-t97+1+t96-t31))*s13r
      s2 = s3+s4
      s3 = s2+((-256*t207*t29*s23r-128*t212+t214)*t10*t11*t23+(512*t219*
     #t220+(512*t224+512*t60*t5)*s23r+256*t211*t230+128*t60*t5*(t156-t31
     #-t233+2)*s34r-128*t240)*l1*r*t42+(-256*t246-512*t80)*t220+(-256*t2
     #07*t29*t229-512*t89-256*t90)*s23r-128*t258*t3*t259-256*t55*t230-12
     #8*t1*(-t133+t97+z-t96-1+t31)*s34r+128*z)*t271
      s4 = s3
      s6 = (t279*t101*t102*t110+((256*t207*t29*s2l1+1024*t287-256*t289)*
     #s23r+(512*t274-t294)*s34r+256*t297*l3*t299-128*t304*t305)*t10*t11*
     #t23+(512*t97*t2*t220+((-256*t224-256*t71*l3)*s2l1+(-512*t287+512*t
     #289)*s34r-1024*t71*l3*s3l1+t152)*s23r+(-t275+t294)*t229+(-256*t60*
     #t5*(-t163+t329+2-z)*s3l1-128*t60*t64*(-t335+t336-3+t337))*s34r-256
     #*t344*t1*s3l1+128*t349*z)*l1*r*t42+(-256*t97*t2*s34r-512*t83)*t220
     #+((256*t246+256*t80)*s2l1-256*t207*t30*t229+(512*t219*s3l1-512*t65
     #)*s34r+1024*t185-256*t198*t5)*s23r-128*t258*t3*z*t259+(256*t287+12
     #8*t44*t382*(-t132+2))*t229+(256*t80*(t156-z+2-t31)*s3l1+128*t198*(
     #-t170+t329-z-t132+t169+1))*s34r+256*t192*s3l1-128*t401)*s1l1
      s7 = 128*t406*t408*t410*t411*t413/t414/t417
      s5 = s6+s7
      s1 = s4+s5
      s2 = s1+(-128*t121*t98*t407*s23r-t279*s2l1-256*t406*t429+512*t434-
     #256*t33*t98*t96*z)*t101*t102*t110+(128*t444*t408*t220+(256*t408*t4
     #48*s34r+256*t207*t30*s3l1+128*(-t233+1-t132+t133)*t96*t382*z)*s23r
     #+(-128*t212+128*t65)*t114+(-256*t258*t273*s34r-256*t304*t299+128*t
     #297*l3*t305)*s2l1+192*t408*t406*t229+(-256*t434-128*t276*t97*(-t33
     #5+t336+t337-2))*s34r-256*(-t336+t335-t233+2)*l3*t87*t432+t191+64*(
     #-12*t492+t494-12*l3+t497-t498+t499+3*t491-t337+3)*l3*t305)*t10*t11
     #*t23
      s3 = s2+((-128*t444*t429-128*(t156-t233-t31+1)*z*t219)*t220+(-128*
     #t448*t408*t229+128*t519*z*(-t329+t163+t337-1)*s34r-256*t32*l3*t49*
     #s3l1-128*(t233-t169+t170-t335+t31)*l3*t49)*s23r+(128*t60*t536*s34r
     #-128*t240)*t114+((256*t60*t536*s3l1-t214)*s34r+256*t349*s3l1-128*t
     #344*t1*z)*s2l1-64*t408*t406*t259-64*t558*z*(t335-t336+1-5*z)*t229+
     #(256*t60*t536*t432-t191+64*t60*t64*(-t497+t498-t499+16*t492-t494+8
     #*l3-5*t491+t337-1))*s34r+256*(-6*t96+6*t97+z-t335+t163)*t1*t432-t2
     #01-64*t32*(-8*t97+4*t496+t585+8*t44-4*t492-t163+t491+1)*t198)*l1*r
     #*t42
      taux1 = s3+(128*t97*t2*t400*s34r+128*(-l3+t44-t302)*l3*t198)*t220+
     #(128*t519*t401*t229-128*t60*z*(-2*t97+t609-l3+t329-t302)*s34r+t617
     #+128*(-t96+t97-t156+z)*t1*z)*s23r+t867
      t1 = -1+z
      t2 = t1**2
      t3 = t2**2
      t4 = l3*t3
      t5 = l3-1
      t6 = t5**2
      t7 = t6*t5
      t8 = z*t7
      t10 = l1**2
      t11 = r**2
      t13 = 1+t11
      t14 = t13**2
      t15 = r+t
      t16 = t15**2
      t19 = r*t
      t20 = 1+t19
      t21 = t20**2
      t23 = t14/t16/t21
      t29 = t2*t1
      t30 = t29*z
      t31 = 2*l3
      t32 = t31-1
      t39 = 1/t15
      t41 = 1/t20
      t42 = t13*t39*t41
      t44 = z*l3
      t47 = t44*t29*t6*s34r
      t49 = t2*z
      t53 = s13r**2
      t55 = l3*t2
      t56 = z*t5
      t59 = l1*r
      t62 = l3*t1
      t68 = l3**2
      t69 = t68*z
      t70 = t3*t1
      t71 = t70*t7
      t73 = t10*l1
      t74 = t11*r
      t82 = t14*t13/t16/t15/t21/t20
      t83 = t73*t74*t82
      t86 = l3*t29
      t87 = z*t6
      t95 = t86*t87*s3l1
      t97 = 3*l3
      t98 = 3*t44
      t113 = t5*t2
      t114 = 8*t44
      t115 = 2*z
      t116 = -t114+t115
      t122 = 2*t44
      t133 = 3*t68
      t134 = 3*t69
      t135 = 4*l3
      t149 = t55*t56*s34r
      t151 = -t1
      t152 = 4*t44
      t153 = -t152+t115
      t167 = -t153
      t177 = t6*t3
      t181 = t68*t5
      t185 = t69*s34r
      t188 = 6*t44
      t189 = z**2
      t190 = t189*l3
      t191 = 6*t190
      t201 = s23r**2
      t206 = -t29*t5
      t209 = 6*z
      t216 = s34r**2
      t221 = 12*t44
      t228 = 6*t69
      t230 = 6*t189*t68
      t231 = 2*t189
      t232 = 8*t190
      t250 = 4*z
      t251 = t188-t250
      t260 = t3*z
      t261 = t216*s34r
      t277 = -512*t177*t69*t83+(2048*t181*t30*s23r+1536*t177*t185+256*(-
     #t188+t191+t115-4*t189)*l3*t113)*t10*t11*t23+(-2048*t69*t2*t201+(30
     #72*t206*t185+512*(t209-t114)*l3*t2)*s23r-1536*t177*t69*t216+256*t5
     #5*t5*(-t209-12*t190+t221+8*t189)*s34r+256*(t228-t230-t231-t152+t23
     #2)*t1)*l1*r*t42+(1024*t69*t2*s34r+2048*t62*z)*t201+(1024*t181*t30*
     #t216+512*t55*t251*s34r-512*t153*t1)*s23r+512*t68*t6*t260*t261+256*
     #t86*t5*t251*t216+256*t151*(-t231-t188+t228+t232-t230+t115)*s34r-51
     #2*t44+512*t190-512*t189
      t279 = t68*l3
      t286 = t7*t3*t2
      t287 = t279*z
      t288 = t287*s34r
      t290 = 1+z
      t299 = t5*t3
      t303 = t70*t6
      t310 = 3*z
      t326 = t177*t68
      t327 = t44-z-l3
      t335 = t30*l3
      t376 = 6*l3
      t377 = 5*z
      t383 = 6*t68
      t407 = z*t327
      t435 = 5*t44
      t457 = 1+u
      t458 = t457**2
      t459 = 1/t458
      t461 = t74*t
      t468 = t11*l1
      t470 = t**2
      t477 = dsqrt(-l2*(1-l1)*(l2-1)*t14*r*(t11*t+t468*t+r+r*t470-t59-t5
     #9*t470+t+l1*t))
      t478 = l1*t477
      t482 = t11**2
      t483 = t482*l2
      t484 = dsqrt(l1)
      t485 = t484*l1
      t486 = t485*t470
      t489 = t482*r
      t490 = t489*l2
      t491 = t484*t10
      t492 = t491*t
      t495 = t470*t
      t496 = t489*t495
      t497 = t485*l2
      t501 = t484*l2
      t511 = t11*l2
      t512 = t491*t470
      t517 = t482*t11
      t518 = t517*t485
      t519 = t74*l2
      t522 = t74*t495
      t525 = -4*t461*t478*l4-2*t483*t486-2*t490*t492+2*t496*t497+2*t489*
     #t*t501+4*t468*t477*l4+2*t461*t478+3*t19*t501+2*t511*t512-2*t511*t4
     #86+t518-3*t519*t492+2*t522*t497
      t526 = t485*t
      t531 = t491*t495
      t536 = t482*t74
      t539 = r*l2
      t541 = t11*t485
      t548 = t11*t484
      t551 = t11*t477
      t553 = t519*t526-t522*t501-t482*t470*t501-t490*t531-t496*t501-t517
     #*t470*t501+t536*l2*t526-t539*t526-t541*l2-2*t489*t485*t-t74*t485*t
     #+3*t548*l2+2*t551
      t555 = t482*t484
      t557 = t482*t485
      t559 = r*t477
      t573 = t517*t484
      t578 = -2*t555+2*t557-t548+2*t559*t-r*t484*t+t483*t491-2*t468*t477
     #+t511*t491-t489*t484*t-t536*t485*t-t518*l2+2*t573*l2-3*t557*l2
      t599 = 5*t555*l2+5*t461*t501+3*t490*t526+t517*l2*t512-t519*t531-t5
     #39*t492-4*t559*l4*t+3*t483*t512+t497+t541-2*t74*t484*t-t573-4*t551
     #*l4
      t601 = t525+t553+t578+t599
      t602 = t601**2
      t604 = t11+t19+l1-t59*t
      t605 = t604**2
      t620 = s34spinc(z,l1,l2,l3,l4,l5,l6,l7,l8)
      s2 = (512*t4*t8*t10*t11*t23+(-512*t4*t8*s34r-512*t30*t32*t6)*l1*r*
     #t42+512*t47+512*t49*t6)*t53+((1024*t55*t56*s23r*t59*t42-1024*t62*z
     #*s23r)*s1l1-512*t69*t71*t83+(2048*t86*t87*s2l1+512*t69*t71*s34r+20
     #48*t95-512*t86*t87*(t97-t98-2))*t10*t11*t23+(-1024*t55*z*t5*s2l1*s
     #23r+(-1024*t47+512*t113*t116)*s2l1+(-1024*t95+512*t86*t87*(-1-t122
     #+t31))*s34r+512*t113*t116*s3l1+512*t49*t5*(t133-t134-t135+1))*l1*r
     #*t42+1024*t62*z*s2l1*s23r+(1024*t149+512*t151*t153)*s2l1+(1024*t56
     #*t55*s3l1-512*t55*t56*(l3-t44-1))*s34r-512*t151*t167*s3l1-512*t1*z
     #*(-t69+1+t68-t31))*s13r+t277*s1l1
      s3 = s2+(512*t87*t70*t279*s23r-512*t177*t69*s2l1+512*t286*t288-512
     #*t6*t290*t260*t68)*t73*t74*t82
      s1 = s3+(-512*t299*t287*t201+(-1024*t287*t303*s34r-1024*t181*t30*s
     #3l1+512*(t310-1+t97-t98)*t5*t30*t68)*s23r+256*(-t231+t250-t188+t19
     #1)*l3*t113*s2l1-768*t287*t286*t216-1536*t326*z*t327*s34r+768*t32*t
     #5*t290*t335)*t10*t11*t23+((512*t299*t288+512*(t122-t310-t31+1)*z*t
     #68*t2)*t201+(512*t303*t287*t216+512*t206*t68*z*(-t152+t135+t250-1)
     #*s34r+512*t167*l3*t2*s3l1+512*(t310-t133+t134-t188+t31)*l3*t49)*s2
     #3r+(-512*t149+256*(t115+4*t190-t114+t228-t230)*t1)*s2l1+256*t287*t
     #286*t261+256*t326*z*(t188-t376+1-t377)*t216+256*t335*t5*(-t221+t37
     #7+1+t228-t383)*s34r-256*(1-t376+t383)*t290*t49)*l1*r*t42+(-512*t69
     #*t2*t327*s34r+512*(l3-t44+t115)*z*t62)*t201
      taux2 = s1+(-512*t181*t29*t407*t216+512*t55*z*(-2*t69+2*t68-l3+t15
     #2-t115)*s34r-1024*t62*z*s3l1+512*(t68-t69+t122-z)*t1*z)*s23r+(512*
     #t62*z*s34r-512*t44+512*t190+512*z)*s2l1-256*t326*t407*t261-256*t33
     #5*t5*(t134-t133+l3-t435+t115)*t216-256*t49*(-z-t228+2*t287+t435-2*
     #t279+l3)*s34r+256*t32*z*t1*t290-512*z*(z+2*s2l1)/r*t39*t41*t459*t6
     #02/t605+1024*z*t459*(1+l1*l3*r*t151*t457*t39*t41)*t620*t601/t604

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet2 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff2)

CCC Sum

      A2num1e0 = tFjet1*tcoff1+tFjet2*tcoff2
      RETURN
      END

      double precision function A2num1e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = t1**2
      t3 = t2**2
      t4 = l3*t3
      t5 = l3-1
      t6 = t5**2
      t7 = t6*t5
      t8 = z*t7
      t10 = l1**2
      t11 = r**2
      t13 = 1+t11
      t14 = t13**2
      t15 = r+t
      t16 = t15**2
      t19 = r*t
      t20 = 1+t19
      t21 = t20**2
      t23 = t14/t16/t21
      t29 = t2*t1
      t31 = 2*l3
      t32 = t31-1
      t33 = t32*t6
      t39 = 1/t15
      t41 = 1/t20
      t42 = t13*t39*t41
      t44 = z*l3
      t49 = t2*z
      t53 = s13r**2
      t55 = l3**2
      t56 = t55*z
      t57 = t3*t6
      t61 = t3*t1
      t62 = t7*t61
      t66 = l3*t29
      t68 = 1+z
      t77 = t57*t56*s34r
      t79 = 2*t44
      t80 = 2*z
      t81 = -t31+t79+1-t80
      t87 = s34r**2
      t91 = t66*z
      t92 = t79-t31-z
      t105 = t5*t29
      t108 = l3*t1
      t109 = -t80+t44+1-l3
      t116 = t57*t56*t87
      t118 = l3*t2
      t119 = t118*z
      t120 = t44-z-l3
      t125 = t1*z
      t131 = t55*t3
      t136 = t131*t6*s34r-t118*z*t5
      t137 = 128*t136
      t141 = t6*t87
      t142 = t131*t141
      t144 = 3*z
      t151 = t32*z*t1
      t157 = t55*t6
      t158 = t87*s34r
      t164 = 3*t44
      t171 = s1l1**2
      t177 = t49*t5
      t178 = t68*l3*t177
      t191 = t79-t144-t31+1
      t198 = (-z-1+t31+t79)*t1*z
      t204 = t55*t5
      t225 = t68*z
      t230 = t7*t3*t2
      t231 = t55*l3
      t232 = t231*z
      t234 = t10**2
      t235 = t11**2
      t237 = t14**2
      t238 = t16**2
      t241 = t21**2
      t247 = t232*s34r
      t256 = t11*r
      t266 = t5*t3
      t267 = s23r**2
      t271 = t61*t6
      t280 = s2l1**2
      t288 = t57*t55
      t289 = 6*t44
      t297 = z**2
      t298 = t297*l3
      t302 = t297*t55
      t303 = 12*t302
      t304 = 24*t56
      t305 = 12*t55
      t306 = 4*z
      t325 = t204*t29
      t352 = 8*t44
      t353 = 8*l3
      t371 = 4*t55
      t374 = 2*t297
      t392 = z*t120
      t420 = 4*t56
      t433 = t80+t31-t374+4*t297*t231-8*t232-10*t302+8*t298-t289+14*t56+
     #4*t231-t371
      t448 = (1+u)**2
      t451 = t256*t
      t458 = t11*l1
      t460 = t**2
      t462 = l1*r
      t468 = dsqrt(-l2*(1-l1)*(l2-1)*t14*r*(t11*t+t458*t+r+r*t460-t462-t
     #462*t460+t+l1*t))
      t469 = l1*t468
      t473 = t11*t468
      t476 = dsqrt(l1)
      t477 = t476*l1
      t478 = t235*t477
      t481 = t235*t476
      t487 = t235*l2
      t488 = t476*t10
      t492 = t11*l2
      t494 = t235*r
      t497 = t235*t256
      t500 = t235*t11
      t501 = t500*t477
      t503 = t500*t476
      t506 = t477*l2
      t507 = -4*t451*t469*l4-4*t473*l4-3*t478*l2+5*t481*l2-2*t256*t476*t
     #+t487*t488-2*t458*t468+t492*t488-t494*t476*t-t497*t477*t-t501*l2+2
     #*t503*l2+t506
      t508 = t11*t477
      t509 = t476*l2
      t512 = t494*l2
      t513 = t477*t
      t517 = t488*t460
      t519 = t256*l2
      t520 = t460*t
      t521 = t488*t520
      t523 = r*l2
      t524 = t488*t
      t526 = r*t468
      t538 = t11*t476
      t541 = t508+t501+5*t451*t509+3*t512*t513+t500*l2*t517-t519*t521-t5
     #23*t524-4*t526*l4*t+3*t487*t517-t508*l2-2*t494*t477*t-t256*t477*t+
     #3*t538*l2
      t548 = t477*t460
      t553 = t494*t520
      t567 = 2*t526*t-r*t476*t+2*t478-2*t487*t548-2*t512*t524+2*t553*t50
     #6+2*t494*t*t509+4*t458*t468*l4-2*t481-t503-t538+2*t451*t469+3*t19*
     #t509
      t574 = t256*t520
      t589 = 2*t492*t517-2*t492*t548-3*t519*t524+2*t574*t506+t519*t513-t
     #574*t509+2*t473-t235*t460*t509-t512*t521-t553*t509-t500*t460*t509+
     #t497*l2*t513-t523*t513
      t592 = (t507+t541+t567+t589)**2
      t595 = (t11+t19+l1-t462*t)**2
      s3 = (-128*t4*t8*t10*t11*t23+(128*t4*t8*s34r+128*t29*z*t33)*l1*r*t
     #42-128*t44*t29*t6*s34r-128*t49*t6)*t53+((256*t56*t57*s23r+128*t56*
     #t62*s34r-128*t66*z*t6*t68)*t10*t11*t23+((-256*t77-256*t44*t2*t5*t8
     #1)*s23r-128*t56*t62*t87-128*t91*t6*t92*s34r+128*t49*t5*(t79+t31-1)
     #)*l1*r*t42+(256*t56*t105*s34r+256*t108*z*t109)*s23r+128*t116+128*t
     #119*t5*t120*s34r-128*t125*(t44-1+l3))*s13r
      s2 = s3+(t137*t10*t11*t23+(-256*t142-128*t118*t5*(t79-t31-t144+2)*
     #s34r+128*t151)*l1*r*t42+128*t157*t3*t158+256*t66*t141+128*t1*(-t16
     #4+t56+z-t55-1+t31)*s34r-128*z)*t171+((256*t136*s2l1+128*t77-128*t1
     #78)*t10*t11*t23+((-256*t142-256*t118*t5*t81*s34r+256*t151)*s2l1-25
     #6*t116-128*t119*t5*t191*s34r+128*t198)*l1*r*t42+(256*t204*t29*t87+
     #256*t108*t109*s34r-256*z)*s2l1+128*t157*t3*z*t158+256*t91*t5**2*t8
     #7+128*t125*(-t164+t56+z+l3-t55-1)*s34r-128*t225)*s1l1
      s3 = s2-128*t230*t232*t234*t235*t237/t238/t241
      s4 = s3+(256*t230*t247+256*t33*t61*t55*z)*t10*l1*t256*t14*t13/t16/
     #t15/t21/t20
      s1 = s4+(-128*t266*t232*t267+(-128*t232*t271*s34r+128*t68*t55*t105
     #*z)*s23r+t137*t280+(128*t77-128*t178)*s2l1-256*t232*t230*t87-128*t
     #288*z*(t289-6*l3-5*z+2)*s34r+64*(12*t298-24*t44+12*l3-t303+t304-t3
     #05+t306-4-4*t297)*l3*t177)*t10*t11*t23+((128*t266*t247+128*t191*z*
     #t55*t2)*t267+(128*t271*t232*t87+128*t325*z*(t79-t31-t144)*s34r-128
     #*(-t80-1+t31+t79)*l3*t49)*s23r+(-128*t118*t5*t92*s34r+128*t151)*t2
     #80+(-128*t119*t5*(t79-t31-z-1)*s34r+128*t198)*s2l1+128*t232*t230*t
     #158-64*t288*z*(-t352+t353+8*z-2)*t87+64*t119*t5*(t303-t304+t305-20
     #*t298+28*t44-t353+8*t297-6*z+2)*s34r-64*t32*(8*t56-4*t302-t371-t35
     #2+4*t298+4*l3-t374-2)*t125)*l1*r*t42
      taux1 = s1+(-128*t56*t2*t120*s34r-128*(-l3+t44-t80)*l3*t125)*t267+
     #(-128*t325*t392*t87-128*t118*z*(t56-t55-t164+t80)*s34r+128*(l3+t44
     #-z)*t1*z)*s23r+(128*t108*t120*s34r-128*z)*t280+(128*t108*z*(t44-z-
     #1-l3)*s34r-128*t225)*s2l1-128*t288*t392*t158+64*t91*t5*(-t420+t371
     #+t352-t31-t306)*t87-64*t125*t433*s34r+64*(t420-2*t302-2*t55-4*t44+
     #2*t298+t31-t374-2)*z+128*t297/r*t39*t41/t448*t592/t595
      t1 = -1+z
      t2 = t1**2
      t3 = t2**2
      t4 = l3*t3
      t5 = l3-1
      t6 = t5**2
      t7 = t6*t5
      t8 = l1**2
      t11 = r**2
      t12 = 1+t11
      t13 = t12**2
      t15 = r+t
      t16 = t15**2
      t17 = 1/t16
      t18 = r*t
      t19 = 1+t18
      t20 = t19**2
      t21 = 1/t20
      t26 = t7*s34r
      t27 = t4*t26
      t28 = t2*t1
      t29 = 4*l3
      t37 = 1/t15
      t39 = 1/t19
      t40 = t12*t37*t39
      t42 = l3*t28
      t43 = t6*s34r
      t44 = t42*t43
      t46 = 2*l3
      t47 = t46-1
      t53 = z*t7
      t57 = t13*t17*t21
      t61 = t6*t28
      t68 = t6*z
      t69 = t42*t68
      t71 = t28*z
      t79 = t5*t2
      t83 = z*l3
      t85 = t83*t61*s34r
      t87 = l3*t2
      t88 = z*t5
      t89 = t87*t88
      t91 = t2*z
      t95 = s13r**2
      t97 = l3**2
      t98 = t3*t1
      t99 = t97*t98
      t100 = t8*l1
      t103 = t11*r
      t104 = t13*t12
      t107 = 1/t16/t15
      t109 = 1/t20/t19
      t114 = t97*t3
      t120 = 3*l3
      t121 = 3*t83
      t130 = t114*t43
      t132 = 5*l3
      t133 = 3*z
      t134 = 5*t83
      t139 = 2048*t89
      t142 = s34r**2
      t143 = t7*t142
      t145 = 512*t99*t143
      t146 = 4*t83
      t152 = 3*t97
      t153 = t97*z
      t154 = 3*t153
      t155 = 2*t83
      t163 = t97*t5
      t165 = t163*t28*s34r
      t167 = l3*t1
      t168 = 6*z
      t172 = t167*z
      t173 = 2048*t172
      t178 = 512*t114*t6*t142
      t184 = t1*t5
      t193 = t7*s3l1
      t194 = t99*t193
      t198 = 1536*t153*t98*t7
      t203 = t104*t107*t109
      t208 = t6*t3
      t209 = t208*t153
      t216 = 8*t69
      t223 = -t133+1-t120+t121
      t251 = t120-1
      t262 = 8*t83
      t263 = 2*z
      t264 = -t262+t263
      t279 = t83-l3
      t290 = 6*t83
      t317 = t5*t28
      t321 = t120-2
      t330 = -t1
      t334 = 2*t1
      t335 = -t146+t263
      t340 = t97*t6
      t341 = t3*s3l1
      t363 = -t335
      t368 = t1*z
      s2 = (512*t99*t7*t100*t103*t104*t107*t109+(-2560*t114*t6*s23r-1024
     #*t99*t26-512*t42*t6*(-t120+t121-z))*t8*t11*t57+((1536*t130+1024*t8
     #7*t5*(-t132-t133+2+t134)-t139)*s23r+t145+512*t42*t6*(t146-t29-z)*s
     #34r+512*t79*(-t152+t154-t155+1))*l1*r*t40+(-1536*t165-512*t167*(-t
     #168+4-t132+t134)+t173)*s23r-t178-512*t87*t5*(t155-t46-z)*s34r-512*
     #t184*(-l3+t83-1))*s1l1+(512*t99*t7*s2l1-512*t194+t198)*t100*t103*t
     #203
      s3 = s2+((-512*t114*t6*s2l1-1536*t209)*s23r+512*(-t42*t6*(t121+z+2
     #-t120)-t216)*s2l1+(1024*t194-t198)*s34r-512*(-t42*t6*t223+t216)*s3
     #l1-512*t42*t68*(1+t121-t120)+1024*t42*t68*(t120-t121-2))*t8*t11*t5
     #7
      s1 = s3+(((-512*t130+1024*t87*t5*(-l3+t83+z)+t139)*s2l1+512*t208*t
     #153*s34r+1024*t83*t28*t251*t5)*s23r+(-t145+2560*t85+512*t79*(t154-
     #1-t152+t155+t29)-1024*t79*t264)*s2l1-512*t99*t193*t142+(1024*(-t42
     #*t6*(-t46+1-z+t155)+2*t69)*s3l1+1024*t42*t68*t279-1024*t42*t68*(-1
     #-t155+t46))*s34r+512*(-t79*(t154-t290-t152+t46+z-1)-2*t79*t264)*s3
     #l1+512*t91*t5*(-t152+t154+t46)-1024*t91*t5*(t152-t154-t29+1))*l1*r
     #*t40+((512*t165-512*t167*(t83+t263-l3)-t173)*s2l1-512*t153*t317*s3
     #4r-512*t83*t2*t321)*s23r
      t375 = s1+(t178-2560*t87*t88*s34r+512*t330*(t153-1+t46+t83-t97)+51
     #2*t334*t335)*s2l1+512*t340*t341*t142+(-1024*(-t87*t5*(t83+1-z-l3)+
     #2*t89)*s3l1-512*t87*t88*t279+1024*t87*t88*(l3-t83-1))*s34r-512*(t3
     #30*(-t121+t153+z+l3-t97-1)+t334*t363)*s3l1-512*t368*(t153+l3-t97)+
     #1024*t368*(-t153+1+t97-t46)
      t377 = t6*t98
      t378 = t97*l3
      t382 = t3*t2
      t383 = t378*t382
      t384 = t383*t26
      t390 = (8*t68+t6*t1)*t3*t97
      t396 = -t5
      t397 = t396*t3
      t398 = s23r**2
      t402 = t378*s34r
      t403 = t377*t402
      t406 = 4*z
      t415 = t383*t143
      t417 = 15*z
      t421 = 12*t209
      t425 = z**2
      t426 = t425*l3
      t427 = 6*t426
      t428 = 4*t425
      t433 = 18*t83
      t434 = 15*t426
      t435 = 9*z
      t447 = 6*l3
      t457 = t396*t28
      t458 = 7*z
      t463 = 2*t5*t28
      t470 = 24*t83
      t477 = t142*s34r
      t488 = 34*t83
      t491 = 6*t153
      t492 = t425*t97
      t493 = 3*t492
      t499 = 12*t83
      t500 = 8*t425
      t508 = 30*t153
      t509 = 27*t492
      t519 = t97*t2
      t520 = t83-z-l3
      t536 = t163*t71
      t541 = 7*t83
      t544 = t290-t406
      t563 = 2*t153
      t565 = 2*t97
      t566 = 14*t83
      t578 = t378*z
      t579 = 2*t578
      t584 = -17*t153-t406+t579-t425*t378-l3-17*t426-t378+15*t492+16*t83
     #+t428+t565
      t586 = 2*t425
      t594 = 2560*t83
      t595 = 2304*t426
      t597 = 256*l3
      s3 = (-512*t377*t378*s23r-256*t384+256*t390)*t100*t103*t203
      s4 = (-1536*t397*t378*t398+(1536*t403-512*(8*t88-(-t120+t121-t406+
     #1)*t5)*t28*t97)*s23r+512*t415+256*(-t114*t6*(-t121+t417-2+t120)-t4
     #21)*s34r-512*(-t290+t427+t263-t428)*l3*t79+256*(t433-t120-t434+2-t
     #435+9*t425)*l3*t79)*t8*t11*t57+((1024*t397*t402+512*(t417-3+t447-t
     #290)*t97*t2)*t398+(-1024*t377*t378*t142+512*(t457*t97*(-t458-t447+
     #2+t290)+6*t463*t153)*s34r+512*(-17*z+t470+t152-t154-t46)*l3*t2)*s2
     #3r-256*t383*t7*t477-256*(-t114*t6*(t29+14*z-1-t146)-t421)*t142-256
     #*(-t87*t5*(-t488+t29-17*t425+16*z-1-t152+t491-t493+30*t426)+2*t87*
     #t5*(-t168-12*t426+t499+t500))*s34r+256*(-t508+t500+t509+26*t83-34*
     #t426+t152-t133+1-t29)*t1)*l1*r*t40
      s2 = s3+s4
      s1 = s2+(-1024*(-t519*t520+2*t153*t2)*s34r-4096*t172+512*(-t120+t1
     #21-t406)*l3*t1)*t398+(-1024*(-t317*t97*t520+2*t536)*t142-512*(-t87
     #*(-t541+t46-t152+t154+t406)+2*t87*t544)*s34r-512*(11*t83-t168-t153
     #+t97)*t1)*s23r+256*(-t114*t6*(-t83+t406+l3)-4*t209)*t477+256*(-t42
     #*t5*(-l3-t563-8*z+t565+t566)-2*t42*t5*t544)*t142
      t599 = s1+256+256*(t330*t584+t334*(-t586-t290+t491+8*t426-6*t492+t
     #263))*s34r+t594-t595+2048*t425-t597-768*z
      t606 = 512*t377*t378*s3l1
      t608 = t68*t98*t378
      t615 = t7*t382
      t616 = t578*s34r
      t619 = t340*t341
      t621 = 1+z
      t624 = -1-t263
      t645 = t28*t97
      t693 = t153*(-t146+t29+t406-1)
      t696 = 2*t520
      t702 = t47*t5
      t725 = 8*l3
      t726 = 10*z
      t733 = t155-z+2-t46
      t799 = 5*z
      t810 = 12*t153
      t816 = 6*t97
      t823 = 1-t447+t816
      t853 = t83-z+2-l3
      t862 = z*t520
      t880 = 4*t172
      t919 = 10*t83
      t947 = t47*z
      t957 = 1/r
      t960 = 1+u
      t961 = t960**2
      t962 = 1/t961
      t964 = dsqrt(l1)
      t965 = t964*l1
      t966 = t11*t965
      t967 = t11**2
      t968 = t967*t11
      t969 = t968*t965
      t970 = t965*l2
      t971 = t967*l2
      t972 = t964*t8
      t982 = t11*l1
      t984 = t**2
      t986 = l1*r
      t992 = dsqrt(-l2*(1-l1)*(l2-1)*t13*r*(t11*t+t982*t+r+r*t984-t986-t
     #986*t984+t+l1*t))
      t993 = r*t992
      t996 = t11*t964
      t1001 = t967*r
      t1009 = t967*t964
      t1012 = t967*t965
      t1015 = t966+t969+t970+t971*t972-r*t964*t+2*t993*t+3*t996*l2-t103*
     #t965*t-2*t1001*t965*t-t966*l2-2*t103*t964*t+5*t1009*l2-3*t1012*l2
      t1016 = t968*t964
      t1020 = t967*t103
      t1025 = t11*l2
      t1029 = t11*t992
      t1032 = t1001*l2
      t1033 = t965*t
      t1036 = t103*t
      t1037 = t964*l2
      t1040 = r*l2
      t1041 = t972*t
      t1043 = t103*l2
      t1044 = t984*t
      t1045 = t972*t1044
      t1047 = 2*t1016*l2-t969*l2-t1020*t965*t-t1001*t964*t+t1025*t972-2*
     #t982*t992-4*t1029*l4-t1016-t996+3*t1032*t1033+5*t1036*t1037-t1040*
     #t1041-t1043*t1045
      t1050 = t972*t984
      t1055 = t965*t984
      t1062 = t1001*t1044
      t1071 = l1*t992
      t1082 = t968*l2*t1050-4*t993*l4*t-2*t971*t1055+3*t971*t1050-2*t103
     #2*t1041+2*t1062*t970+2*t1001*t*t1037+4*t982*t992*l4+2*t1036*t1071+
     #3*t18*t1037+2*t1025*t1050-2*t1025*t1055-3*t1043*t1041
      t1084 = t103*t1044
      t1103 = t1043*t1033+2*t1084*t970-t967*t984*t1037-t1084*t1037-t1062
     #*t1037-t1032*t1045-t968*t984*t1037+t1020*l2*t1033-t1040*t1033-4*t1
     #036*t1071*l4+2*t1029-2*t1009+2*t1012
      t1105 = t1015+t1047+t1082+t1103
      t1106 = t1105**2
      t1108 = t11+t18+l1-t986*t
      t1109 = t1108**2
      t1115 = l3*s1vr
      t1120 = t19*t962
      t1127 = 1+l1*l3*r*t330*t960*t37*t39
      t1128 = s34spinc(z,l1,l2,l3,l4,l5,l6,l7,l8)
      t1132 = s34spinc2(z,l1,l2,l3,l4,l5,l6,l7,l8)
      s2 = ((1024*t4*t7*t8*t11*t13*t17*t21+(-512*t27-512*t28*(t29-1)*t6)
     #*l1*r*t40+512*t44+512*t2*t47*t5)*s1l1-512*t4*t53*t8*t11*t57+((512*
     #t27-512*t61)*s2l1+1024*t4*t53*s34r-1024*t69+1024*t71*t47*t6)*l1*r*
     #t40+(-512*t44+512*t79)*s2l1-1024*t85+512*t89-1024*t91*t6)*t95+t375
     #*s13r+t599*s1l1+((-512*t377*t378*s2l1+t606-1536*t608)*s23r+(-256*t
     #384+256*t390)*s2l1-2048*t615*t616-1024*t619+512*(2*t6*t621-t6*t624
     #)*z*t114)*t100*t103*t203
      s3 = s2+((512*t378*t5*t3*s2l1-2048*t396*t3*t578)*t398+((512*t403+5
     #12*(-t263+3-t120+t121)*t5*t645)*s2l1+(-t606+3072*t608)*s34r+512*(4
     #*t536-(-1-t133-t120+t121)*t97*t317)*s3l1-512*(-2*t223*t5-(-t133+2-
     #t120+t121)*t5)*z*t645)*s23r+(256*t415-256*t114*t6*(-t121+t120+t133
     #-4)*s34r-512*(-t586+t406-t290+t427)*l3*t79+256*(6*t425-t435+1+t433
     #-t120-t434)*l3*t79)*s2l1+3072*t578*t615*t142+(1536*t619-768*t208*t
     #693+1536*t208*t153*t696)*s34r+1536*t702*t42*s3l1-768*(2*t702*t621-
     #t702*t624)*z*t42)*t8*t11*t57
      s5 = s3
      s9 = (-512*t47*t28*t97*s2l1-1536*t5*t3*t616+512*(t725+t726-t262-4)
     #*t2*t153)*t398+((-512*t317*t97*t733*s34r+512*(2-z+t146-t447+t152-t
     #154)*t2*l3)*s2l1-1536*t377*t578*t142+(512*t317*t97*(t155-t46-z-1)*
     #s3l1+512*t457*t153*(-t29+t146+2-t406)+512*t463*t693)*s34r-512*(2*t
     #363*l3*t2-(2+t263-t152+t154-t46-t290)*l3*t2)*s3l1+512*(-9*t153-t43
     #5+9*t97+t433-t725+1)*l3*t91)*s23r+(-256*t114*t6*t733*t142-256*(-t8
     #7*t5*(-t586+t168-2+t725+t491-t493+t427-t152-t566)-4*t89)*s34r+256*
     #(t509-t458-t508-20*t426+t488+t425-t46+t152)*t1)*s2l1-1024*t578*t61
     #5*t477
      s8 = s9+(-512*t619+256*t208*t153*(-t499+12*l3+t726-3)-512*t208*t15
     #3*(t290-t447+1-t799))*t142+(-1024*t42*t251*t5*s3l1+256*t83*t317*(-
     #t447-t810+12*t97+t470-t726)-512*t83*t317*(-t499+t799+1+t491-t816))
     #*s34r-512*t823*t2*s3l1+256*(2*t823*t621-t823*t624)*z*t2
      s9 = l1
      s7 = s8*s9
      s8 = r*t40
      s6 = s7*s8
      s4 = s5+s6
      s1 = s4+(512*t519*s2l1+1536*t153*t2*t520*s34r-1024*(l3-t83+t263)*z
     #*t167+512*t696*z*t167)*t398+((512*t519*t853*s34r+512*t853*l3*t1)*s
     #2l1+1536*t163*t28*t862*t142+(-512*t519*(t83-z-1-l3)*s3l1+512*t83*t
     #2*(t563+t263-t565+t46-t146)-1024*t83*t2*(-t563+t565-l3+t146-t263))
     #*s34r+512*(t880-(-l3+t83-2-t263)*l3*t1)*s3l1-1024*(t97-t153+t155-z
     #)*t1*z+512*(-t97+t153+l3-t155+z)*t1*z)*s23r
      taux2 = s1+(256*t317*t97*t853*t142+256*(-t167*(-t97-2+t29-t541-t58
     #6+3*t426+t168-t492+t563)-t880)*s34r+t594-t595-1792*z-t597+256*t425
     #)*s2l1+1024*t208*t97*t862*t477+(512*t163*t28*s3l1-256*t83*t317*(t9
     #19-t491-t406+t816-t120)+512*t83*t317*(t154-t152+l3-t134+t263))*t14
     #2+(512*t87*t321*s3l1-256*t91*(t810+t263-t919-4*t578+4*t378-t152)+5
     #12*t91*(-z-t491+t579+t134-2*t378+l3))*s34r+512*t47*t1*s3l1+256*t94
     #7*t1*t624-512*t947*t1*t621+1536*z*(z+2*s2l1)*t957*t37*t39*t962*t11
     #06/t1109-(-512*(t1115-t1115*z-t168)*r*t15*t1120*t1127*t1128-512*t1
     #84*s1vr*t1132*r*t15*t1120*t1127)*t1105*t39*t37/t1108*t957

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet2 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff2)

CCC Sum

      A2num1e1 = tFjet1*tcoff1+tFjet2*tcoff2
      RETURN
      END

      double precision function A2num1e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3**2
      t3 = t1*l3*z
      t4 = l3-1
      t5 = t4**2
      t7 = -1+z
      t8 = t7**2
      t9 = t8**2
      t11 = t5*t4*t9*t8
      t12 = s34r**2
      t18 = t1*z
      t22 = z**2
      t23 = 2*z
      t24 = t22+1-t23
      t31 = l1**2
      t33 = r**2
      t35 = 1+t33
      t36 = t35**2
      t37 = r+t
      t38 = t37**2
      t42 = 1+r*t
      t43 = t42**2
      t47 = t12*s34r
      t51 = t5*t9*t1
      t52 = z*l3
      t54 = 2*l3
      t62 = t22*l3
      t74 = t7*z
      t92 = 3*l3
      taux1 = (64*t3*t11*t12-128*t5*t9*t7*t18*s34r+64*t24*l3*t8*z*t4)*t3
     #1*t33*t36/t38/t43+(-64*t3*t11*t47-64*t51*z*(2*t52-t54+3-3*z)*t12+6
     #4*l3*t8*z*t4*(4*t62-8*t52+4*l3-3*t22+6*z-3)*s34r-64*(t54-1)*t24*t7
     #4)*l1*r*t35/t37/t42+64*t51*z*(t52-z-l3)*t47+64*t52*t8*t7*t4*(t18-t
     #1+t92-3*t52+t23)*t12-64*t74*(-4*t18-z+t22+2*t22*t1+6*t52-3*t62-t92
     #+2*t1)*s34r+64*t24*z
      t1 = -1+z
      t2 = t1**2
      t3 = t2**2
      t4 = l3*t3
      t5 = l3-1
      t6 = t5**2
      t7 = t6*t5
      t8 = l1**2
      t11 = r**2
      t12 = 1+t11
      t13 = t12**2
      t15 = r+t
      t16 = t15**2
      t17 = 1/t16
      t18 = r*t
      t19 = 1+t18
      t20 = t19**2
      t21 = 1/t20
      t26 = t7*s34r
      t27 = t4*t26
      t28 = t2*t1
      t29 = 4*l3
      t37 = 1/t15
      t39 = 1/t19
      t40 = t12*t37*t39
      t42 = l3*t28
      t43 = t6*s34r
      t44 = t42*t43
      t46 = 2*l3
      t47 = t46-1
      t57 = t13*t17*t21
      t61 = t6*t28
      t65 = t6*z
      t72 = t5*t2
      t76 = l3*t2
      t77 = z*t5
      t81 = s13r**2
      t83 = l3**2
      t84 = t3*t1
      t85 = t83*t84
      t86 = t8*l1
      t89 = t11*r
      t90 = t13*t12
      t93 = 1/t16/t15
      t95 = 1/t20/t19
      t100 = t83*t3
      t106 = 3*l3
      t107 = z*l3
      t108 = 3*t107
      t117 = t100*t43
      t119 = 5*l3
      t120 = 3*z
      t121 = 5*t107
      t128 = s34r**2
      t129 = t7*t128
      t130 = t85*t129
      t132 = 4*t107
      t138 = 3*t83
      t139 = t83*z
      t140 = 3*t139
      t141 = 2*t107
      t149 = t83*t5
      t151 = t149*t28*s34r
      t153 = l3*t1
      t154 = 6*z
      t161 = t100*t6*t128
      t168 = t1*t5
      t176 = t7*s3l1
      t177 = t85*t176
      t179 = t139*t84*t7
      t185 = t90*t93*t95
      t190 = t6*t3
      t227 = t106-1
      t249 = t107-l3
      t256 = 6*t107
      t261 = z*t2
      t270 = 2*z
      t276 = t5*t28
      t280 = t106-2
      t293 = t83*t6
      t294 = t3*s3l1
      t298 = t107+1-z-l3
      t318 = t6*t84
      t319 = t83*l3
      t323 = t3*t2
      t324 = t319*t323
      t326 = 1024*t324*t26
      t328 = t6*t1
      t333 = 256*(-8*t65-4*t328)*t3*t83
      t338 = t5*t3
      t339 = s23r**2
      t343 = t319*s34r
      t344 = t318*t343
      t346 = 4*z
      t349 = t28*t83
      t354 = t324*t129
      t356 = 8*z
      t357 = 6*l3
      t369 = 18*t107
      t370 = z**2
      t371 = t370*l3
      t372 = 15*t371
      t373 = 9*z
      t379 = 12*t107
      t380 = 6*t371
      t381 = 4*t370
      t392 = 7*z
      t407 = 5*z
      t408 = 8*t107
      t415 = t128*s34r
      t419 = 8*l3
      t423 = 14*z
      t432 = t370*t83
      t433 = 6*t432
      t435 = 12*t139
      t437 = 16*l3
      t438 = 6*t83
      t445 = 6*t139
      t446 = 3*t432
      t455 = 48*t139
      t456 = 36*t432
      t457 = 12*t83
      t458 = 10*z
      t469 = t83*t2
      t470 = t107-z-l3
      t484 = 7*t107
      t494 = 2*t470
      t504 = 4*t139
      t509 = 2*t139
      t510 = 2*t83
      t511 = 14*t107
      t519 = -t1
      t521 = 2*t370
      t522 = 8*t371
      t523 = 2*t319
      t524 = t319*z
      t525 = 4*t524
      t528 = t370*t319
      t530 = -8*t432-t511+t357-t521+t522+t523+t270-t525-8*t83+16*t139+2*
     #t528
      t534 = 2*t524
      t537 = 16*t107
      t538 = -17*t139-t346+t534-t528-l3-17*t371-t319+15*t432+t537+t381+t
     #510
      t544 = 4096*t107
      t545 = 3072*t371
      t546 = 1024*l3
      s3 = (1024*t318*t319*s23r+t326+t333)*t86*t89*t185
      s5 = (-3072*t338*t319*t339+(-3072*t344-1024*(-t106+t108-t346+1)*t5
     #*t349)*s23r-2048*t354+256*(-t293*t3*(t256-t356+8-t357)+2*t100*t6*(
     #-t108+15*z-2+t106))*s34r-512*(t369-t106-t372+2-t373+9*t370)*l3*t72
     #+256*(t357-t379+t380-t381-4+t356)*l3*t72)*t8*t11*t57
      s6 = ((2048*t338*t343+1024*(3-t392-t357+t256)*t83*t2)*t339+(2048*t
     #318*t319*t128+1024*t276*t83*(-t392-t357+2+t256)*s34r+1024*(t407-t1
     #38+t140-t408+t46)*l3*t2)*s23r+1024*t324*t7*t415-256*(-t293*t3*(-t3
     #56+t408+6-t419)+2*t100*t6*(t29+t423-1-t132))*t128-256*(-t76*t5*(-1
     #6*t371+t433+8*t370-t435+32*t107-t423-t437+6+t438)+2*t76*t5*(-34*t1
     #07+t29-17*t370+16*z-1-t138+t445-t446+30*t371))*s34r+256*(t455-t456
     #-t457-4+t437+t458-10*t370-52*t107+44*t371)*t1)*l1*r*t40
      s4 = s5+s6
      s2 = s3+s4
      s1 = s2+(-2048*t469*t470*s34r-1024*(-t106+t108-t346)*l3*t1)*t339+(
     #-2048*t349*t5*t470*t128-1024*t76*(-t484+t46-t138+t140+t346)*s34r-1
     #024*(t139-t83-t108+t270)*t1)*s23r+256*(-t293*t3*t494+2*t100*t6*(-t
     #107+t346+l3))*t415+256*(-t42*t5*(t504+t357+t346-t408-4*t83)+2*t42*
     #t5*(-l3-t509-t356+t510+t511))*t128
      t548 = s1-1024+256*(t519*t530+2*t1*t538)*s34r-2560*t370-t544+t545+
     #t546+2560*z
      t553 = t318*t319*s3l1
      t555 = t65*t84*t319
      t561 = t7*t323
      t562 = t524*s34r
      t565 = t293*t294
      t567 = -1-t270
      t645 = t47*t5
      t664 = -t29+t132+2-t346
      t670 = t141-z+2-t46
      t736 = 12*l3
      t758 = 1-t357+t438
      t782 = t107-z+2-l3
      t791 = z*t470
      t850 = 10*t107
      t872 = t47*z
      t881 = 1/r
      t884 = 1+u
      t885 = t884**2
      t886 = 1/t885
      t888 = t89*t
      t895 = t11*l1
      t897 = t**2
      t899 = l1*r
      t905 = dsqrt(-l2*(1-l1)*(l2-1)*t13*r*(t11*t+t895*t+r+r*t897-t899-t
     #899*t897+t+l1*t))
      t906 = l1*t905
      t910 = dsqrt(l1)
      t911 = t910*l1
      t912 = t911*l2
      t913 = t11*t911
      t914 = t11**2
      t915 = t914*t11
      t916 = t915*t911
      t917 = t11*t905
      t919 = t914*t910
      t924 = t914*r
      t930 = t11*t910
      t933 = r*t905
      t938 = -4*t888*t906*l4+t912+t913+t916+2*t917-2*t919-4*t917*l4-t913
     #*l2-2*t924*t911*t-t89*t911*t+3*t930*l2+2*t933*t-r*t910*t
      t939 = t914*l2
      t940 = t910*t8
      t944 = t11*l2
      t948 = t914*t89
      t952 = t915*t910
      t955 = t914*t911
      t963 = t910*l2
      t966 = t924*l2
      t967 = t911*t
      t970 = t939*t940-2*t895*t905+t944*t940-t924*t910*t-t948*t911*t-t91
     #6*l2+2*t952*l2-3*t955*l2+5*t919*l2-2*t89*t910*t-t930+5*t888*t963+3
     #*t966*t967
      t973 = t940*t897
      t975 = t89*l2
      t976 = t897*t
      t977 = t940*t976
      t979 = r*l2
      t980 = t940*t
      t987 = t911*t897
      t992 = t924*t976
      t1007 = t915*l2*t973-t975*t977-t979*t980-4*t933*l4*t+3*t939*t973-2
     #*t939*t987-2*t966*t980+2*t992*t912+2*t924*t*t963+4*t895*t905*l4+2*
     #t888*t906+3*t18*t963+2*t944*t973
      t1012 = t89*t976
      t1027 = -2*t944*t987-3*t975*t980+2*t1012*t912+t975*t967-t1012*t963
     #-t914*t897*t963-t966*t977-t992*t963-t915*t897*t963+t948*l2*t967-t9
     #79*t967+2*t955-t952
      t1029 = t938+t970+t1007+t1027
      t1030 = t1029**2
      t1032 = t11+t18+l1-t899*t
      t1033 = t1032**2
      t1039 = l3*s1vr
      t1044 = t19*t886
      t1051 = 1+l1*l3*r*t519*t884*t37*t39
      t1052 = s34spinc(z,l1,l2,l3,l4,l5,l6,l7,l8)
      t1056 = s34spinc2(z,l1,l2,l3,l4,l5,l6,l7,l8)
      s4 = ((-2048*t4*t7*t8*t11*t13*t17*t21+(1024*t27+1024*t28*(t29-1)*t
     #6)*l1*r*t40-1024*t44-1024*t2*t47*t5)*s1l1-1024*t4*z*t7*t8*t11*t57+
     #((-1024*t27+1024*t61)*s2l1+2048*t42*t65)*l1*r*t40+(1024*t44-1024*t
     #72)*s2l1-1024*t76*t77)*t81
      s8 = (-1024*t85*t7*t86*t89*t90*t93*t95+(5120*t100*t6*s23r+2048*t85
     #*t26+1024*t42*t6*(-t106+t108-z))*t8*t11*t57+((-3072*t117-2048*t76*
     #t5*(-t119-t120+2+t121))*s23r-1024*t130-1024*t42*t6*(t132-t29-z)*s3
     #4r-1024*t72*(-t138+t140-t141+1))*l1*r*t40+(3072*t151+1024*t153*(-t
     #154+4-t119+t121))*s23r+1024*t161+1024*t76*t5*(t141-t46-z)*s34r+102
     #4*t168*(-l3+t107-1))*s1l1+(-1024*t85*t7*s2l1+1024*t177-1024*t179)*
     #t86*t89*t185
      s7 = s8+((1024*t100*t6*s2l1+3072*t190*t139)*s23r+1024*t42*t6*(t108
     #+z+2-t106)*s2l1+(-2048*t177+1024*t179)*s34r-1024*t42*t6*(-t120+1-t
     #106+t108)*s3l1+1024*t42*t65*(1+t108-t106))*t8*t11*t57+(((1024*t117
     #-2048*t76*t5*(-l3+t107+z))*s2l1-1024*t190*t139*s34r-2048*t107*t28*
     #t227*t5)*s23r+(1024*t130-1024*t107*t61*s34r-1024*t72*(t140-1-t138+
     #t141+t29))*s2l1+1024*t85*t176*t128+(2048*t42*t6*(-t46+1-z+t141)*s3
     #l1-2048*t42*t65*t249)*s34r+1024*t72*(t140-t256-t138+t46+z-1)*s3l1-
     #1024*t261*t5*(-t138+t140+t46))*l1*r*t40+((-1024*t151+1024*t153*(t1
     #07+t270-l3))*s2l1+1024*t139*t276*s34r+1024*t107*t2*t280)*s23r
      s6 = s7+(-1024*t161+1024*t76*t77*s34r+1024*t1*(t139-1+t46+t107-t83
     #))*s2l1-1024*t293*t294*t128+(-2048*t76*t5*t298*s3l1+1024*t76*t77*t
     #249)*s34r-1024*t1*(-t108+t139+z+l3-t83-1)*s3l1+1024*t1*z*(t139+l3-
     #t83)
      s7 = s13r
      s5 = s6*s7
      s3 = s4+s5
      s2 = s3+t548*s1l1+((1024*t318*t319*s2l1-1024*t553+1024*t555)*s23r+
     #(t326+t333)*s2l1+2560*t561*t562+2048*t565+512*(2*t6*t567-t328)*z*t
     #100)*t86*t89*t185
      s3 = s2+((-1024*t319*t5*t3*s2l1-2048*t338*t524)*t339+((-1024*t344-
     #1024*(-t270+3-t106+t108)*t5*t349)*s2l1+(1024*t553-2048*t555)*s34r+
     #1024*(-1-t120-t106+t108)*t83*t276*s3l1-1024*(-t120+2-t106+t108)*t5
     #*z*t28*t83)*s23r+(-1024*t354+256*(-t293*t3*(t256-t346-t357+4)+2*t2
     #93*t3*(-t108+t106+t120-4))*s34r-512*(6*t370-t373+1+t369-t106-t372)
     #*l3*t72+256*(-t521-2+t346+t357-t379+t380)*l3*t72)*s2l1-3840*t524*t
     #561*t128+(-3072*t565-1536*t190*t139*t298+1536*t190*t139*(-t132+t29
     #+t346-1))*s34r-3072*t645*t42*s3l1-768*(2*t645*t567-t645*t1)*z*t42)
     #*t8*t11*t57
      s5 = s3
      s9 = (1024*t47*t28*t83*s2l1+1024*t338*t562+1024*t664*t2*t139)*t339
     #+((1024*t276*t83*t670*s34r+1024*(-2+z-t132+t357-t138+t140)*t2*l3)*
     #s2l1+1024*t318*t524*t128+(-1024*t276*t83*(t141-t46-z-1)*s3l1+1024*
     #t77*t349*t664)*s34r-1024*(2+t270-t138+t140-t46-t256)*l3*t2*s3l1+10
     #24*(t120-1-t138+t140-t256+t29)*l3*t261)*s23r+(-256*(-t293*t3*(-t27
     #0+t132-t29)-2*t293*t3*t670)*t128-256*(-t76*t5*(-t435-t522+t433-t27
     #0+t521-t419+t438+t537)+2*t76*t5*(-t521+t154-2+t419+t445-t446+t380-
     #t138-t511))*s34r+256*(-t521-t456-44*t107+t419+t154+28*t371+t455-t4
     #57)*t1)*s2l1+1280*t524*t561*t415
      s8 = s9+(1024*t565+256*t190*t139*(t256-t407+3-t357)-512*t190*t139*
     #(-t379+t736+t458-3))*t128+(2048*t42*t227*t5*s3l1+256*t107*t276*(-3
     #-t438+t736-t379+t407+t445)-512*t107*t276*(-t357-t435+t457+24*t107-
     #t458))*s34r+1024*t758*t2*s3l1+256*(2*t758*t567-t758*t1)*z*t2
      s9 = l1
      s7 = s8*s9
      s8 = r*t40
      s6 = s7*s8
      s4 = s5+s6
      s1 = s4+(-1024*t469*s2l1-1024*t139*t2*t470*s34r-1024*t494*z*t153)*
     #t339+((-1024*t469*t782*s34r-1024*t782*l3*t1)*s2l1-1024*t149*t28*t7
     #91*t128+(1024*t469*(t107-z-1-l3)*s3l1-1024*t107*t2*(t509+t270-t510
     #+t46-t132))*s34r+1024*(-l3+t107-2-t270)*l3*t1*s3l1-1024*(-t83+t139
     #+l3-t141+z)*t1*z)*s23r
      taux2 = s1+(256*(-t349*t5*t494-2*t349*t5*t782)*t128+256*(-t153*(-t
     #29-4*t371+t408-t504+2*t432-t270+t510+t521)+2*t153*(-t83-2+t29-t484
     #-t521+3*t371+t154-t432+t509))*s34r+t545+t546-512*t370+1536*z-t544)
     #*s2l1-1280*t190*t83*t791*t415+(-1024*t149*t28*s3l1-256*t107*t276*(
     #-t121+t106+t270+t140-t138)+512*t107*t276*(t850-t445-t346+t438-t106
     #))*t128+(-1024*t76*t280*s3l1-256*t261*(-t106-t445+t534-z+t121-t523
     #+t438)+512*t261*(t435+t270-t850-t525+4*t319-t138))*s34r-1024*t47*t
     #1*s3l1+256*t872*t2-512*t872*t1*t567-1024*z*(z+2*s2l1)*t881*t37*t39
     #*t886*t1030/t1033-(-1024*(-t1039+t1039*z+t270)*r*t15*t1044*t1051*t
     #1052+1024*t168*s1vr*t1056*r*t15*t1044*t1051)*t1029*t39*t37/t1032*t
     #881

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet2 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff2)

CCC Sum

      A2num1e2 = tFjet1*tcoff1+tFjet2*tcoff2
      RETURN
      END

      double precision function A2num1e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux1 = 0
      t1 = l3**2
      t2 = t1*l3
      t3 = -1+z
      t4 = t3**2
      t5 = t4**2
      t6 = t5*t4
      t7 = t2*t6
      t8 = l3-1
      t9 = t8**2
      t10 = t9*t8
      t14 = t9*t5*t3
      t17 = -1024*t7*t10*s34r+1024*t14*t1
      t18 = l1**2
      t19 = t18*l1
      t21 = r**2
      t22 = t21*r
      t24 = 1+t21
      t25 = t24**2
      t27 = r+t
      t28 = t27**2
      t33 = 1+r*t
      t34 = t33**2
      t37 = t25*t24/t28/t27/t34/t33
      t39 = s34r**2
      t41 = t7*t10*t39
      t43 = t1*t9
      t44 = 6*l3
      t45 = z*l3
      t46 = 6*t45
      t47 = 8*z
      t53 = 12*t45
      t54 = z**2
      t55 = t54*l3
      t56 = 6*t55
      t60 = t4*t8
      t69 = t25/t28/t34
      t71 = t39*s34r
      t75 = 8*l3
      t76 = 8*t45
      t82 = l3*t4
      t84 = t54*t1
      t85 = 6*t84
      t87 = t1*z
      t88 = 12*t87
      t92 = 6*t1
      t98 = 2*t54
      t99 = 4*z
      t100 = 8*t55
      t101 = 16*t45
      t111 = t24/t27/t33
      t114 = t45-z-l3
      t115 = 2*t114
      t120 = t4*t3
      t122 = 4*t87
      t129 = 2*z
      t134 = 2*t2
      t137 = t2*z
      t139 = t129-t98+t44+16*t87-14*t45+t100-8*t1-8*t84+t134+2*t54*t2-4*
     #t137
      t143 = 1024*l3
      t144 = 2048*t45
      t145 = 1024*t55
      t148 = t17*t19*t22*t37+(2048*t41+512*t43*t5*(-t44+t46-t47+8)*s34r-
     #512*(t44-t53+t56-4*t54-4+t47)*l3*t60)*t18*t21*t69+(-1024*t7*t10*t7
     #1-512*t43*t5*(-t75-t47+t76+6)*t39-512*t82*t8*(-16*t55+t85+8*t54-t8
     #8+32*t45-14*z-16*l3+6+t92)*s34r+512*(t92-t88+t85+t98+2-t99-t100-t7
     #5+t101)*t3)*l1*r*t111+512*t1*t5*t9*t115*t71+512*l3*t120*t8*(t122+t
     #99-t76-4*t1+t44)*t39+512*t3*t139*s34r-t143+t144-t145-2048*z+1024*t
     #54+1024
      t151 = t6*t10
      t162 = t9*t5
      t177 = t162*t1
      t185 = 2*l3-1
      t196 = 4*l3
      t205 = 4*t55
      t214 = 5*z
      t220 = t45*t120
      t221 = 6*t87
      t257 = 5*t45
      t258 = 3*l3
      s1 = t148*s1l1+(t17*s2l1-1024*t137*t151*s34r+1024*t14*t87)*t19*t22
     #*t37+((1024*t41+512*t162*t1*(t46-t99-t44+4)*s34r-512*(-t98-2+t99+t
     #44-t53+t56)*l3*t60)*s2l1+1536*t137*t151*t39+1536*t177*z*(2*t45-2*z
     #+2-2*l3)*s34r-1536*t185*t8*t5*z*l3)*t18*t21*t69+((-512*t162*t1*(-t
     #129+4*t45-t196)*t39-512*t82*t8*(-t129+t98-t75+t92+t101-t88-t100+t8
     #5)*s34r+512*(-t205-t196+t76+t92-t88+t85)*t3)*s2l1-512*t137*t151*t7
     #1-512*t177*z*(t46-t214+3-t44)*t39-512*t220*t8*(-t53+t214+t221-t92+
     #12*l3-3)*s34r+512*(1-t44+t92)*t120*z)*l1*r*t111
      taux2 = s1+(512*t1*t120*t8*t115*t39+512*l3*t3*(-t122+2*t84-t129+2*
     #t1+t98-t196-t205+t76)*s34r-t143+t144-t145)*s2l1+512*t87*t5*t9*t114
     #*t71+512*t220*t8*(3*t87-3*t1-t257+t258+t129)*t39+512*z*t4*(-t221+2
     #*t137-z+t257-t134+t92-t258)*s34r-512*t185*t4*z

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet2 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff2)

CCC Sum

      A2num1e3 = tFjet1*tcoff1+tFjet2*tcoff2
      RETURN
      END

      double precision function A2num1e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux1 = 0
      taux2 = 0

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet2 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff2)

CCC Sum

      A2num1e4 = tFjet1*tcoff1+tFjet2*tcoff2
      RETURN
      END

