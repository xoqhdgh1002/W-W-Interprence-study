CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCC Numerator functions CCCCCCCCCCCCCCCCCCCCCCCCCC

      double precision function ACnum1e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = l3-1
      t3 = t2**2
      t4 = t1*t3
      t5 = 1/s3vr
      t6 = t5*s2l2
      t8 = 128.D0/3.D0*t4*t6
      t9 = t1**2
      t10 = t9*t3
      t11 = t5*s3l2p
      t12 = t10*t11
      t13 = 64.D0/3.D0*t12
      t15 = s1vr**2
      t17 = s4l2p*t5
      t18 = t10*t17
      t22 = t3*t2
      t23 = t9*t22
      t24 = t5*s34r
      t25 = t24*s2l2
      t26 = t23*t25
      t28 = t9*t1
      t29 = t28*t22
      t30 = t11*s34r
      t37 = t5*s2l1
      t39 = 128.D0/3.D0*t4*t37
      t40 = t5*s3l1p
      t41 = t10*t40
      t42 = 64.D0/3.D0*t41
      t45 = s4l1p*t5
      t46 = t10*t45
      t50 = t24*s2l1
      t53 = t40*s34r
      t60 = l3*z
      t62 = t3*t5
      t74 = t28*t3
      t75 = t74*t11
      t77 = t74*t17
      t81 = t45*s3l2p
      t82 = t74*t81
      t93 = t22*t5
      t102 = s4l2p*s4l1p*t5
      t123 = t9**2
      t124 = t123*t22
      t138 = s13r**2
      t140 = t2*t1
      t141 = t140*l3
      t145 = t10*l3
      t152 = l3*t2
      t153 = t1*t5
      t155 = t152*t153*s2l2
      t157 = l3*t9
      t158 = t2*t5
      t159 = t158*s3l2p
      t160 = t157*t159
      t162 = t2*s4l2p
      t163 = t162*t5
      t164 = t157*t163
      t168 = l3*t5
      t169 = t168*s34r
      t170 = t10*t169
      t172 = z*t2
      t175 = -256.D0/3.D0*t170-64.D0/3.D0*t172*t5
      t177 = t74*l3
      t178 = t177*t30
      t186 = s23r**2
      t190 = 128*t170+128.D0/3.D0*t158
      t193 = -2+z
      t194 = t193*t2
      t195 = t153*s3l2p
      t199 = t1*s4l2p*t5
      t201 = 64.D0/3.D0*t172*t199
      t204 = l3*t28
      t205 = t204*t22
      t206 = s34r**2
      t207 = t5*t206
      t211 = l3*t123
      t212 = t211*t22
      t213 = t11*t206
      t220 = -128.D0/3.D0*t170+128.D0/3.D0*t140*t5
      t222 = t168*s3l2p
      t223 = t74*t222
      t224 = t3*l3
      t226 = t28*s4l2p*t5
      t227 = t224*t226
      t231 = t9*t2
      t234 = t231*t17
      t241 = t152*t153*s2l1
      t244 = t157*t158*s3l1p
      t247 = t2*s4l1p*t5
      t248 = t157*t247
      t253 = t177*t53
      t264 = t153*s3l1p
      t268 = t1*s4l1p*t5
      t270 = 64.D0/3.D0*t172*t268
      t276 = t40*t206
      t282 = t168*s3l1p
      t283 = t74*t282
      t284 = t28*s4l1p
      t286 = t224*t284*t5
      t298 = l3**2
      t299 = z*t298
      t300 = t299*t2
      t301 = t9*t5
      t305 = t157*t2
      t306 = t11*s2l1
      t309 = t40*s2l2
      t313 = t15*s1vr
      t319 = 64.D0/3.D0*t160+64.D0/3.D0*t164
      t322 = 64.D0/3.D0*t244+64.D0/3.D0*t248
      t325 = t28*t5
      t326 = t325*s34r
      t327 = t299*t3*t326
      t329 = t204*t2
      t330 = t11*s3l1p
      t334 = t204*t162*s4l1p
      t336 = -t1
      t337 = 2*t336
      t351 = (-4+5*z)*t2
      t365 = t211*t62*s3l2p
      t369 = t211*t3*s4l2p*t5
      t374 = t211*t3*t81
      t375 = 128.D0/3.D0*t374
      t378 = t172*t9
      t405 = 128.D0/3.D0*t227
      t413 = 128.D0/3.D0*t286
      t421 = t93*t206
      t430 = l3*s4l2p
      t433 = z**2
      t441 = t301*s3l2p
      t444 = t9*s4l2p*t5
      t457 = t1*z
      t463 = t93*s3l2p
      t466 = t22*l3
      t468 = t123*s4l2p*t5
      t473 = z*t9
      t474 = t473*t3
      t483 = t123*s4l1p*t5
      t492 = t123*t1
      t493 = l3*t492
      t509 = s3l1p*s34r
      t517 = t298*t1
      t521 = t2*t298
      t522 = t521*t9
      t529 = t521*t301*s34r
      t530 = 256.D0/3.D0*t529
      t531 = l3*t1
      t532 = t531*t5
      t536 = t298*t5
      t538 = t74*t536*t206
      t539 = 256.D0/3.D0*t538
      t548 = t298*t9
      t549 = t15**2
      t553 = t548*t11
      t554 = 128.D0/3.D0*t553
      t555 = t548*t17
      t556 = 64.D0/3.D0*t555
      t559 = t522*t25
      t561 = t2*t28
      t562 = t561*t298
      t563 = t562*t30
      t565 = t193*t1
      t570 = t517*t6
      t576 = 64.D0/3.D0*t529+64.D0/3.D0*t60*t5
      t578 = t536*s3l2p
      t579 = t561*t578
      t581 = -t2
      t583 = 2*t581*t28
      t591 = (z-3)*t1
      t594 = t430*t5
      t599 = -t193
      t600 = t599*t2
      t601 = t600*t1
      t606 = t172*l3
      t608 = t301*s3l2p*s34r
      t611 = 64.D0/3.D0*t195
      t616 = t186*s23r
      t618 = -z-1
      t622 = -t530+64.D0/3.D0*t618*l3*t5
      t627 = 3*z
      t629 = (1-t627)*t1
      t638 = z*t5
      t640 = -128.D0/3.D0*t538-64.D0/3.D0*t172*t1*t169+64.D0/3.D0*t638
      t642 = t3*t298
      t643 = t123*t5
      t644 = t643*s3l2p
      t645 = t642*t644
      t646 = t642*t468
      t650 = t194*l3
      t654 = -t618*t1
      t665 = 128.D0/3.D0*t224*t301*t206+64.D0/3.D0*t158*s34r
      t674 = 128.D0/3.D0*t529-128.D0/3.D0*t532
      t676 = t28*t298
      t677 = t676*t163
      t690 = 128.D0/3.D0*t538-128.D0/3.D0*t581*t1*t169-128.D0/3.D0*t638
      t695 = t581*l3
      t712 = t548*t40
      t713 = 128.D0/3.D0*t712
      t714 = t548*t45
      t715 = 64.D0/3.D0*t714
      t720 = t562*t53
      t726 = t517*t37
      t732 = t561*t536*s3l1p
      t743 = l3*s4l1p*t5
      t752 = t301*t509
      t755 = 64.D0/3.D0*t264
      t771 = t642*t643*s3l1p
      t772 = t642*t483
      t791 = t676*t247
      t808 = t9*s4l1p*t5
      t822 = 64.D0/3.D0*t548*t306
      t824 = 64.D0/3.D0*t548*t309
      t825 = t676*t11
      t826 = 128.D0/3.D0*t825
      t828 = 64.D0/3.D0*t676*t17
      t832 = 64.D0/3.D0*t676*t81
      t835 = t298*l3
      t846 = 256.D0/3.D0*t172*t835*t326
      t854 = 128.D0/3.D0*t559
      t855 = 256.D0/3.D0*t579
      t856 = 64.D0/3.D0*t677
      t860 = (-2+t627)*t1
      t865 = 256.D0/3.D0*t732
      t866 = 64.D0/3.D0*t791
      t875 = 128*t2*t123*t578
      t876 = t298*t123
      t878 = 64.D0/3.D0*t876*t163
      t883 = 64.D0/3.D0*t876*t2*t81
      t886 = t193*t9
      t900 = 4*t336
      t901 = t900*z
      t909 = 2*z
      t910 = -3+t909
      t911 = t910*t1
      t914 = t337*t1
      t934 = 4*z
      t936 = (6-t934)*t2
      t946 = 1-t909
      t947 = t946*t9
      t965 = t642*t123
      t968 = t936*t9
      t970 = t600*l3
      t976 = -t946*t1
      t1001 = t325*s3l2p
      t1008 = t284*t11
      t1013 = 128.D0/3.D0*t441
      t1014 = t336*t1
      t1016 = 64.D0/3.D0*t1014*t17
      t1050 = t337*t2*t9
      t1091 = (t433-z)*t1
      t1110 = t900*t3*l3
      t1115 = -t337
      t1116 = t1115*t2
      s3 = (((t8-t13)*t15+((-t8+t13+64.D0/3.D0*t18)*s23r-64.D0/3.D0*t26+
     #64.D0/3.D0*t29*t30)*s1vr)*s1l1+((t39-t42)*t15+((-t39+t42+64.D0/3.D
     #0*t46)*s23r-64.D0/3.D0*t23*t50+64.D0/3.D0*t29*t53)*s1vr)*s1l2+(128
     #.D0/3.D0*t60*t9*t62*s23r+(-64*t12-128.D0/3.D0*t18)*s2l1+(-64*t41-1
     #28.D0/3.D0*t46)*s2l2+(128.D0/3.D0*t75+64.D0/3.D0*t77)*s3l1p+64.D0/
     #3.D0*t82)*t15+(((64.D0/3.D0*t12+64.D0/3.D0*t18)*s2l1+(64.D0/3.D0*t
     #41+64.D0/3.D0*t46)*s2l2-128.D0/3.D0*t60*t28*t93*s34r+(-128.D0/3.D0
     #*t75-128.D0/3.D0*t77)*s3l1p-128.D0/3.D0*t82-128.D0/3.D0*t74*t102)*
     #s23r+(-128.D0/3.D0*t26+(128.D0/3.D0*t29*t11+64.D0/3.D0*t29*t17)*s3
     #4r)*s2l1+(128.D0/3.D0*t29*t40+64.D0/3.D0*t29*t45)*s34r*s2l2+((-128
     #.D0/3.D0*t124*t11-64.D0/3.D0*t124*t17)*s3l1p-64.D0/3.D0*t124*t81)*
     #s34r)*s1vr)*t138
      s6 = ((128.D0/3.D0*t141*t5*s23r*t15-128.D0/3.D0*t145*t24*s23r*s1vr
     #)*s1l2+((-64*t155+128.D0/3.D0*t160-128.D0/3.D0*t164)*s23r+t175*s2l
     #2+128.D0/3.D0*t178)*t15+((256.D0/3.D0*t155-64*t160-64*t164)*t186+(
     #t190*s2l2-256.D0/3.D0*t178+64.D0/3.D0*t194*t195-t201)*s23r+128.D0/
     #3.D0*t205*t207*s2l2-128.D0/3.D0*t212*t213)*s1vr+(t220*s2l2+(128.D0
     #/3.D0*t223+128.D0/3.D0*t227)*s34r-128.D0/3.D0*t231*t11-128.D0/3.D0
     #*t234)*t186)*s1l1+(((-64*t241+128.D0/3.D0*t244-128.D0/3.D0*t248)*s
     #23r+t175*s2l1+128.D0/3.D0*t253)*t15+((256.D0/3.D0*t241-64*t244-64*
     #t248)*t186+(t190*s2l1-256.D0/3.D0*t253+64.D0/3.D0*t194*t264-t270)*
     #s23r+128.D0/3.D0*t205*t207*s2l1-128.D0/3.D0*t212*t276)*s1vr+(t220*
     #s2l1+(128.D0/3.D0*t283+128.D0/3.D0*t286)*s34r-128.D0/3.D0*t231*t40
     #-128.D0/3.D0*t231*t45)*t186)*s1l2
      s7 = s6+(-128.D0/3.D0*t300*t301*s23r+256.D0/3.D0*t305*t306+256.D0/
     #3.D0*t305*t309)*t313
      s8 = s7
      s10 = (-128.D0/3.D0*t300*t301*t186+(t319*s2l1+t322*s2l2-128.D0/3.D
     #0*t327-128.D0/3.D0*t329*t330+(128.D0/3.D0*t334+64.D0/3.D0*t337*z*t
     #141)*t5)*s23r+((128.D0/3.D0*t223+256.D0/3.D0*t227)*s34r+64.D0/3.D0
     #*t351*t195+t201)*s2l1+((128.D0/3.D0*t283+256.D0/3.D0*t286)*s34r+64
     #.D0/3.D0*t351*t264+t270)*s2l2+((-256.D0/3.D0*t365-128.D0/3.D0*t369
     #)*s3l1p-t375)*s34r-128.D0/3.D0*t378*t330)*t15
      s13 = (-t319*s2l1-t322*s2l2+256.D0/3.D0*t327+(128.D0/3.D0*t204*t15
     #9+128.D0/3.D0*t204*t163)*s3l1p+128.D0/3.D0*t329*t81+(128.D0/3.D0*t
     #334+128.D0/3.D0*t336*z*t141)*t5)*t186+((128.D0/3.D0*t145*t25+(-256
     #.D0/3.D0*t223-t405)*s34r-64.D0/3.D0*t172*t195-t201)*s2l1+((-256.D0
     #/3.D0*t283-t413)*s34r-64.D0/3.D0*t172*t264-t270)*s2l2+256.D0/3.D0*
     #t299*t123*t421+((128*t365+256.D0/3.D0*t369)*s3l1p+256.D0/3.D0*t374
     #+(128.D0/3.D0*t123*t3*t430*s4l1p+128.D0/3.D0*t433*l3*t10)*t5)*s34r
     #+(128.D0/3.D0*t172*t441+128.D0/3.D0*t172*t444)*s3l1p+128.D0/3.D0*t
     #378*t81+128.D0/3.D0*t378*t102)*s23r+((256.D0/3.D0*t204*t421+128.D0
     #/3.D0*t457*t62*s34r)*s2l2+(-256.D0/3.D0*t211*t463-128.D0/3.D0*t466
     #*t468)*t206-128.D0/3.D0*t474*t30)*s2l1
      s12 = s13+((-256.D0/3.D0*t211*t93*s3l1p-128.D0/3.D0*t466*t483)*t20
     #6-128.D0/3.D0*t474*t53)*s2l2+((256.D0/3.D0*t493*t463+128.D0/3.D0*t
     #493*t22*s4l2p*t5)*s3l1p+128.D0/3.D0*t493*t22*t81)*t206+128.D0/3.D0
     #*z*t28*t3*t11*t509
      s13 = s1vr
      s11 = s12*s13
      s9 = s10+s11
      s5 = s8+s9
      s6 = s13r
      s4 = s5*s6
      s2 = s3+s4
      s3 = s2
      s7 = ((-128.D0/3.D0*t517*t5*t186-256.D0/3.D0*t522*t24*s23r)*t15+((
     #t530-128.D0/3.D0*t532)*t186+(t539+128.D0/3.D0*t140*t169)*s23r)*s1v
     #r)*s1l2-64.D0/3.D0*t548*t11*t549+((t554+t556)*s23r+64.D0/3.D0*t559
     #+64.D0/3.D0*t563-64.D0/3.D0*t565*t222)*t313
      s6 = s7+((64.D0/3.D0*t570-t554+t556)*t186+(t576*s2l2+(-64*t579-64.
     #D0/3.D0*t583*t298*s4l2p*t5)*s34r+64.D0/3.D0*t591*t222+64.D0/3.D0*t
     #565*t594)*s23r-64.D0/3.D0*t601*t168*s34r*s2l2+64.D0/3.D0*t606*t608
     #+t611)*t15+((-128.D0/3.D0*t570+128.D0/3.D0*t553+128.D0/3.D0*t555)*
     #t616+(t622*s2l2+256.D0/3.D0*t563+128.D0/3.D0*t531*t11-64.D0/3.D0*t
     #629*t594)*t186+(t640*s2l2+(128.D0/3.D0*t645-128.D0/3.D0*t646)*t206
     #-64.D0/3.D0*t650*t608-64.D0/3.D0*t654*t11-64.D0/3.D0*t199)*s23r+t6
     #65*s2l2-128.D0/3.D0*t177*t213-64.D0/3.D0*t140*t30)*s1vr+(t674*s2l2
     #+(-128.D0/3.D0*t579-128.D0/3.D0*t677)*s34r+128.D0/3.D0*t157*t11+12
     #8.D0/3.D0*t157*t17)*t616+(t690*s2l2+(-128.D0/3.D0*t645-128.D0/3.D0
     #*t646)*t206+(128.D0/3.D0*t695*t441+128.D0/3.D0*t695*t444)*s34r+128
     #.D0/3.D0*t457*t11+128.D0/3.D0*t457*t17)*t186
      s7 = s1l1
      s5 = s6*s7
      s8 = -64.D0/3.D0*t548*t40*t549+((t713+t715)*s23r+64.D0/3.D0*t522*t
     #50+64.D0/3.D0*t720-64.D0/3.D0*t565*t282)*t313+((64.D0/3.D0*t726-t7
     #13+t715)*t186+(t576*s2l1+(-64*t732-64.D0/3.D0*t583*t298*s4l1p*t5)*
     #s34r+64.D0/3.D0*t591*t282+64.D0/3.D0*t565*t743)*s23r-64.D0/3.D0*t6
     #01*t168*s34r*s2l1+64.D0/3.D0*t606*t752+t755)*t15
      s7 = s8+((-128.D0/3.D0*t726+128.D0/3.D0*t712+128.D0/3.D0*t714)*t61
     #6+(t622*s2l1+256.D0/3.D0*t720+128.D0/3.D0*t531*t40-64.D0/3.D0*t629
     #*t743)*t186+(t640*s2l1+(128.D0/3.D0*t771-128.D0/3.D0*t772)*t206-64
     #.D0/3.D0*t650*t752-64.D0/3.D0*t654*t40-64.D0/3.D0*t268)*s23r+t665*
     #s2l1-128.D0/3.D0*t177*t276-64.D0/3.D0*t140*t53)*s1vr+(t674*s2l1+(-
     #128.D0/3.D0*t732-128.D0/3.D0*t791)*s34r+128.D0/3.D0*t157*t40+128.D
     #0/3.D0*t157*t45)*t616+(t690*s2l1+(-128.D0/3.D0*t771-128.D0/3.D0*t7
     #72)*t206+(128.D0/3.D0*t695*t301*s3l1p+128.D0/3.D0*t695*t808)*s34r+
     #128.D0/3.D0*t457*t40+128.D0/3.D0*t457*t45)*t186
      s8 = s1l2
      s6 = s7*s8
      s4 = s5+s6
      s1 = s3+s4
      s2 = s1+(-t822-t824+(-t826+t828)*s3l1p+t832)*t549
      s3 = s2+(128.D0/3.D0*t473*t835*t5*t186+((-t554+t556)*s2l1+(-t713+t
     #715)*s2l2+t846+(256.D0/3.D0*t825-t828)*s3l1p-t832-128.D0/3.D0*t676
     #*t102)*s23r+(t854+(-t855-t856)*s34r-64.D0/3.D0*t860*t222)*s2l1+((-
     #t865-t866)*s34r-64.D0/3.D0*t860*t282)*s2l2+((t875-t878)*s3l1p-t883
     #)*s34r+(-128.D0/3.D0*t886*t222+64.D0/3.D0*t886*t594)*s3l1p+64.D0/3
     #.D0*t886*l3*t81)*t313
      s4 = s3
      s8 = (t822+t824-t846+(-t826-t828)*s3l1p-t832-64.D0/3.D0*t901*t517*
     #t5)*t186+((-t854+(t855-t856)*s34r-64.D0/3.D0*t911*t222-64.D0/3.D0*
     #t914*t594)*s2l1+((t865-t866)*s34r-64.D0/3.D0*t911*t282-64.D0/3.D0*
     #t914*t743)*s2l2-256.D0/3.D0*z*t3*t835*t643*t206+((-t875-t878)*s3l1
     #p-t883-64.D0/3.D0*t936*z*t548*t5)*s34r+(128.D0/3.D0*t910*t9*t222+6
     #4.D0/3.D0*t947*t594)*s3l1p+64.D0/3.D0*t947*l3*t81+128.D0/3.D0*t599
     #*t9*l3*t102)*s23r+((-t539-128.D0/3.D0*t601*t169)*s2l2+256.D0/3.D0*
     #t965*t213+(64.D0/3.D0*t968*t222+64.D0/3.D0*t970*t444)*s34r-64.D0/3
     #.D0*t976*t11)*s2l1+(256.D0/3.D0*t965*t276+(64.D0/3.D0*t968*t282+64
     #.D0/3.D0*t970*t808)*s34r-64.D0/3.D0*t976*t40)*s2l2
      s7 = s8-256.D0/3.D0*t3*t492*t298*t11*s3l1p*t206+((128.D0/3.D0*(-4+
     #t627)*t2*l3*t1001-64.D0/3.D0*t606*t226)*s3l1p-64.D0/3.D0*t606*t100
     #8)*s34r+(t1013+t1016)*s3l1p+64.D0/3.D0*t1014*t81
      s8 = t15
      s6 = s7*s8
      s9 = (64.D0/3.D0*t157*t306+64.D0/3.D0*t157*t309+64.D0/3.D0*t900*t2
     #*z*t548*t24+(-128.D0/3.D0*t204*t11-64.D0/3.D0*t204*t17)*s3l1p-64.D
     #0/3.D0*t204*t81-64.D0/3.D0*(-2+t934-2*t433)*z*t168)*t186+((-128.D0
     #/3.D0*t305*t25+(-128.D0/3.D0*t1050*t222-64.D0/3.D0*t378*t594)*s34r
     #+t611-t1016)*s2l1+((-128.D0/3.D0*t1050*t282-64.D0/3.D0*t378*t743)*
     #s34r+t755-64.D0/3.D0*t1014*t45)*s2l2+64.D0/3.D0*t901*t3*t676*t207+
     #((-128*t2*t1*l3*t1001-64.D0/3.D0*t650*t226)*s3l1p-64.D0/3.D0*t650*
     #t1008+(-128.D0/3.D0*t334-128.D0/3.D0*t60*t231)*t5)*s34r+(-t1013-64
     #.D0/3.D0*t1091*t17)*s3l1p-64.D0/3.D0*t1091*t81-128.D0/3.D0*t1014*t
     #102)*s23r+((-256.D0/3.D0*t224*t325*t206-128.D0/3.D0*t140*t24)*s2l2
     #+(-64.D0/3.D0*t1110*t1001-t405)*t206+(64.D0/3.D0*t1116*t195-64.D0/
     #3.D0*t140*t17)*s34r)*s2l1
      s8 = s9+((-64.D0/3.D0*t1110*t325*s3l1p-t413)*t206+(64.D0/3.D0*t111
     #6*t264-64.D0/3.D0*t140*t45)*s34r)*s2l2+((-128.D0/3.D0*t1115*t3*l3*
     #t644+128.D0/3.D0*t369)*s3l1p+t375)*t206+((-128.D0/3.D0*t561*t11+64
     #.D0/3.D0*t234)*s3l1p+64.D0/3.D0*t231*t81)*s34r
      s9 = s1vr
      s7 = s8*s9
      s5 = s6+s7
      taux1 = s4+s5
      t1 = 1-z
      t2 = 2*t1
      t3 = l3-1
      t4 = t3**2
      t5 = t2*t4
      t6 = 1/s3vr
      t7 = t6*s2l2
      t9 = -t1
      t10 = t9**2
      t11 = t10*t4
      t12 = t6*s3l2p
      t13 = t11*t12
      t16 = s1vr**2
      t18 = t1*t4
      t21 = 256.D0/3.D0*t13
      t22 = s4l2p*t6
      t23 = t11*t22
      t27 = t4*t3
      t28 = t10*t27
      t29 = t6*s34r
      t30 = t29*s2l2
      t33 = t10*t9
      t34 = t33*t27
      t35 = t12*s34r
      t42 = t6*s2l1
      t44 = t6*s3l1p
      t45 = t11*t44
      t51 = 256.D0/3.D0*t45
      t52 = s4l1p*t6
      t53 = t11*t52
      t57 = t29*s2l1
      t60 = t44*s34r
      t73 = t33*t4
      t74 = t22*s3l1p
      t77 = t52*s3l2p
      t96 = t10**2
      t97 = t96*t27
      t106 = s13r**2
      t108 = l3*t3
      t109 = t9*t6
      t111 = t108*t109*s2l2
      t113 = l3*t10
      t114 = t3*t6
      t116 = t113*t114*s3l2p
      t120 = l3*t6
      t121 = t120*s34r
      t122 = t11*t121
      t124 = z*t3
      t127 = -1024.D0/3.D0*t122-256.D0/3.D0*t124*t6
      t129 = t73*l3
      t138 = t113*t3*s4l2p*t6
      t141 = s23r**2
      t144 = -t3
      t145 = 2*t144
      t148 = 512*t122-256.D0/3.D0*t145*t6
      t150 = t120*s3l2p
      t151 = t73*t150
      t153 = t4*l3
      t154 = t33*s4l2p
      t156 = t153*t154*t6
      t160 = -2+z
      t161 = t160*t3
      t162 = t109*s3l2p
      t166 = t9*s4l2p*t6
      t168 = 256.D0/3.D0*t124*t166
      t171 = l3*t33
      t172 = t171*t27
      t173 = s34r**2
      t174 = t6*t173
      t178 = l3*t96
      t179 = t178*t27
      t180 = t12*t173
      t185 = t144*t9
      t188 = -512.D0/3.D0*t122-512.D0/3.D0*t185*t6
      t193 = t10*t3
      t203 = t108*t109*s2l1
      t206 = t113*t114*s3l1p
      t220 = t113*t3*s4l1p*t6
      t226 = t120*s3l1p
      t227 = t73*t226
      t229 = t33*s4l1p
      t231 = t153*t229*t6
      t235 = t109*s3l1p
      t239 = t9*s4l1p*t6
      t241 = 256.D0/3.D0*t124*t239
      t247 = t44*t173
      t265 = 3*t3
      t266 = t265*t10
      t268 = l3*s4l2p*t6
      t274 = l3*s4l1p*t6
      t279 = t171*t3
      t288 = -512.D0/3.D0*t151-1024.D0/3.D0*t156
      t291 = 256.D0/3.D0*t124*t162
      t296 = 512.D0/3.D0*t227+1024.D0/3.D0*t231
      t299 = 256.D0/3.D0*t124*t235
      t302 = t178*t4
      t306 = 512.D0/3.D0*t302*t74-512.D0/3.D0*t302*t77
      t330 = -t306
      t332 = t33*t3
      t349 = l3*t96*t9*t27
      t359 = l3**2
      t360 = t359*t10
      t361 = t16**2
      t365 = t360*t12
      t366 = 512.D0/3.D0*t365
      t367 = t360*t22
      t368 = 256.D0/3.D0*t367
      t369 = t366+t368
      t371 = t360*t3
      t374 = t332*t359
      t377 = t160*t9
      t379 = 256.D0/3.D0*t377*t150
      t381 = t16*s1vr
      t383 = t1*t359
      t384 = t383*t7
      t388 = t144*t10
      t389 = t359*t6
      t390 = t389*s34r
      t391 = t388*t390
      t395 = -256.D0/3.D0*t391+256.D0/3.D0*z*l3*t6
      t397 = t265*t33
      t398 = t389*s3l2p
      t401 = -t145*t33
      t403 = t359*s4l2p*t6
      t409 = (z-3)*t9
      t417 = -t160*t3
      t418 = t417*t9
      t423 = t124*l3
      t424 = t10*t6
      t434 = t141*s23r
      t436 = 4*t144
      t439 = -z-1
      t443 = 256.D0/3.D0*t436*t10*t390+256.D0/3.D0*t439*l3*t6
      t448 = -t436*t33
      t453 = t2*l3
      t456 = t439*t9
      t462 = t73*t389*t173
      t467 = z*t6
      t469 = -512.D0/3.D0*t462-256.D0/3.D0*t124*t9*t121+256.D0/3.D0*t467
      t471 = t4*t359
      t472 = t96*t6
      t479 = 512.D0/3.D0*t471*t472*s3l2p+512.D0/3.D0*t471*t96*s4l2p*t6
      t481 = t161*l3
      t482 = t424*s3l2p
      t485 = t144*l3
      t487 = t10*s4l2p*t6
      t488 = t485*t487
      t493 = -t439*t9
      t504 = 512.D0/3.D0*t153*t424*t173+256.D0/3.D0*t114*s34r
      t508 = t9*t3
      t516 = -512.D0/3.D0*t391+512.D0/3.D0*t1*l3*t6
      t518 = t144*t33
      t519 = t518*t398
      t520 = t518*t403
      t532 = 512.D0/3.D0*t462-512.D0/3.D0*t185*t121-512.D0/3.D0*t467
      t540 = z*t9
      t552 = t360*t44
      t553 = 512.D0/3.D0*t552
      t554 = t360*t52
      t555 = 256.D0/3.D0*t554
      t556 = -t553-t555
      t563 = 256.D0/3.D0*t377*t226
      t566 = t383*t42
      t572 = t389*s3l1p
      t575 = t359*s4l1p*t6
      t622 = -512.D0/3.D0*t471*t472*s3l1p-512.D0/3.D0*t471*t96*s4l1p*t6
      t624 = t424*s3l1p
      t628 = t10*s4l1p*t6
      t629 = t485*t628
      t648 = t518*t572
      t649 = t518*t575
      t675 = t12*s2l1
      t677 = t44*s2l2
      t679 = t33*t359
      t680 = t679*t74
      t681 = t679*t77
      t683 = -256.D0/3.D0*t360*t675+256.D0/3.D0*t360*t677-256.D0/3.D0*t6
     #80+256.D0/3.D0*t681
      t693 = -512.D0/3.D0*t519-256.D0/3.D0*t520
      t699 = 512.D0/3.D0*t648+256.D0/3.D0*t649
      t704 = t359*t96*t3
      t711 = t160*t10*l3
      t723 = (-3+2*z)*t9
      t726 = -t2
      t727 = t726*t9
      t741 = t144*t96*t359
      t754 = t726*t3*t10
      t756 = t161*t10
      t761 = t1*t6
      t763 = 256.D0/3.D0*t761*s3l2p
      t772 = 256.D0/3.D0*t761*s3l1p
      t780 = 256.D0/3.D0*t423*t154*t44-256.D0/3.D0*t423*t229*t12
      t782 = t1*t9
      t797 = t2*t3*t10
      t799 = t417*l3
      t817 = z*t10
      s3 = (((-256.D0/3.D0*t5*t7-256.D0/3.D0*t13)*t16+((512.D0/3.D0*t18*
     #t7+t21+256.D0/3.D0*t23)*s23r-256.D0/3.D0*t28*t30+256.D0/3.D0*t34*t
     #35)*s1vr)*s1l1+((256.D0/3.D0*t5*t42+256.D0/3.D0*t45)*t16+((-512.D0
     #/3.D0*t18*t42-t51-256.D0/3.D0*t53)*s23r+256.D0/3.D0*t28*t57-256.D0
     #/3.D0*t34*t60)*s1vr)*s1l2+((t21+512.D0/3.D0*t23)*s2l1+(-t51-512.D0
     #/3.D0*t53)*s2l2-256.D0/3.D0*t73*t74+256.D0/3.D0*t73*t77)*t16+(((-2
     #56.D0/3.D0*t13-256.D0/3.D0*t23)*s2l1+(256.D0/3.D0*t45+256.D0/3.D0*
     #t53)*s2l2)*s23r-256.D0/3.D0*t34*s4l2p*t57+256.D0/3.D0*t34*s4l1p*t3
     #0+(256.D0/3.D0*t97*t74-256.D0/3.D0*t97*t77)*s34r)*s1vr)*t106
      s6 = (((-256*t111+512.D0/3.D0*t116)*s23r+t127*s2l2+512.D0/3.D0*t12
     #9*t35)*t16+((1024.D0/3.D0*t111-256*t116-256*t138)*t141+(t148*s2l2+
     #(-1024.D0/3.D0*t151-512.D0/3.D0*t156)*s34r+256.D0/3.D0*t161*t162-t
     #168)*s23r+512.D0/3.D0*t172*t174*s2l2-512.D0/3.D0*t179*t180)*s1vr+(
     #t188*s2l2+(512.D0/3.D0*t151+512.D0/3.D0*t156)*s34r-512.D0/3.D0*t19
     #3*t12-512.D0/3.D0*t193*t22)*t141)*s1l1+(((256*t203-512.D0/3.D0*t20
     #6)*s23r-t127*s2l1-512.D0/3.D0*t129*t60)*t16+((-1024.D0/3.D0*t203+2
     #56*t206+256*t220)*t141+(-t148*s2l1+(1024.D0/3.D0*t227+512.D0/3.D0*
     #t231)*s34r-256.D0/3.D0*t161*t235+t241)*s23r-512.D0/3.D0*t172*t174*
     #s2l1+512.D0/3.D0*t179*t247)*s1vr+(-t188*s2l1+(-512.D0/3.D0*t227-51
     #2.D0/3.D0*t231)*s34r+512.D0/3.D0*t193*t44+512.D0/3.D0*t193*t52)*t1
     #41)*s1l2
      s5 = s6+(((-256.D0/3.D0*t116-256.D0/3.D0*t266*t268)*s2l1+(256.D0/3
     #.D0*t206+256.D0/3.D0*t266*t274)*s2l2+512.D0/3.D0*t279*t74-512.D0/3
     #.D0*t279*t77)*s23r+(t288*s34r-t291-t168)*s2l1+(t296*s34r+t299+t241
     #)*s2l2+t306*s34r)*t16+(((256.D0/3.D0*t116+256.D0/3.D0*t138)*s2l1+(
     #-256.D0/3.D0*t206-256.D0/3.D0*t220)*s2l2)*t141+((-t288*s34r+t291-2
     #56.D0/3.D0*t161*t166)*s2l1+(-t296*s34r-t299+256.D0/3.D0*t161*t239)
     #*s2l2+t330*s34r+512.D0/3.D0*t332*t74-512.D0/3.D0*t332*t77)*s23r+51
     #2.D0/3.D0*t179*t22*t173*s2l1-512.D0/3.D0*t179*t52*t173*s2l2+(-512.
     #D0/3.D0*t349*t74+512.D0/3.D0*t349*t77)*t173)*s1vr
      s6 = s13r
      s4 = s5*s6
      s2 = s3+s4
      s3 = s2
      s7 = -256.D0/3.D0*t360*t12*t361+(t369*s23r+256.D0/3.D0*t371*t30+25
     #6.D0/3.D0*t374*t35-t379)*t381+((-256.D0/3.D0*t384-t366-t368)*t141+
     #(t395*s2l2+(-256.D0/3.D0*t397*t398-256.D0/3.D0*t401*t403)*s34r+256
     #.D0/3.D0*t409*t150+256.D0/3.D0*t377*t268)*s23r-256.D0/3.D0*t418*t1
     #20*s34r*s2l2+256.D0/3.D0*t423*t424*s3l2p*s34r+256.D0/3.D0*t162)*t1
     #6
      s6 = s7+((512.D0/3.D0*t384+512.D0/3.D0*t365+512.D0/3.D0*t367)*t434
     #+(t443*s2l2+(512.D0/3.D0*t401*t398+256.D0/3.D0*t448*t403)*s34r-256
     #.D0/3.D0*t453*t12-256.D0/3.D0*t456*t268)*t141+(t469*s2l2+t479*t173
     #+(-256.D0/3.D0*t481*t482-512.D0/3.D0*t488)*s34r-256.D0/3.D0*t493*t
     #12-256.D0/3.D0*t166)*s23r+t504*s2l2-512.D0/3.D0*t129*t180-256.D0/3
     #.D0*t508*t35)*s1vr+(t516*s2l2+(512.D0/3.D0*t519+512.D0/3.D0*t520)*
     #s34r+512.D0/3.D0*t113*t12+512.D0/3.D0*t113*t22)*t434+(t532*s2l2-t4
     #79*t173+(512.D0/3.D0*t485*t482+512.D0/3.D0*t488)*s34r+512.D0/3.D0*
     #t540*t12+512.D0/3.D0*t540*t22)*t141
      s7 = s1l1
      s5 = s6*s7
      s8 = 256.D0/3.D0*t360*t44*t361+(t556*s23r-256.D0/3.D0*t371*t57-256
     #.D0/3.D0*t374*t60+t563)*t381+((256.D0/3.D0*t566+t553+t555)*t141+(-
     #t395*s2l1+(256.D0/3.D0*t397*t572+256.D0/3.D0*t401*t575)*s34r-256.D
     #0/3.D0*t409*t226-256.D0/3.D0*t377*t274)*s23r+256.D0/3.D0*t418*t120
     #*s34r*s2l1-256.D0/3.D0*t423*t424*s3l1p*s34r-256.D0/3.D0*t235)*t16
      s7 = s8+((-512.D0/3.D0*t566-512.D0/3.D0*t552-512.D0/3.D0*t554)*t43
     #4+(-t443*s2l1+(-512.D0/3.D0*t401*t572-256.D0/3.D0*t448*t575)*s34r+
     #256.D0/3.D0*t453*t44+256.D0/3.D0*t456*t274)*t141+(-t469*s2l1+t622*
     #t173+(256.D0/3.D0*t481*t624+512.D0/3.D0*t629)*s34r+256.D0/3.D0*t49
     #3*t44+256.D0/3.D0*t239)*s23r-t504*s2l1+512.D0/3.D0*t129*t247+256.D
     #0/3.D0*t508*t60)*s1vr+(-t516*s2l1+(-512.D0/3.D0*t648-512.D0/3.D0*t
     #649)*s34r-512.D0/3.D0*t113*t44-512.D0/3.D0*t113*t52)*t434+(-t532*s
     #2l1-t622*t173+(-512.D0/3.D0*t485*t624-512.D0/3.D0*t629)*s34r-512.D
     #0/3.D0*t540*t44-512.D0/3.D0*t540*t52)*t141
      s8 = s1l2
      s6 = s7*s8
      s4 = s5+s6
      s1 = s3+s4
      s2 = s1+t683*t361
      s3 = s2+((t369*s2l1+t556*s2l2+256.D0/3.D0*t680-256.D0/3.D0*t681)*s
     #23r+(t693*s34r-t379)*s2l1+(t699*s34r+t563)*s2l2+(256.D0/3.D0*t704*
     #t74-256.D0/3.D0*t704*t77)*s34r-256.D0/3.D0*t711*t74+256.D0/3.D0*t7
     #11*t77)*t381
      s4 = s3
      s6 = (t683*t141+((-t693*s34r+256.D0/3.D0*t723*t150+256.D0/3.D0*t72
     #7*t268)*s2l1+(-t699*s34r-256.D0/3.D0*t723*t226-256.D0/3.D0*t727*t2
     #74)*s2l2+(256.D0/3.D0*t741*t74-256.D0/3.D0*t741*t77)*s34r-256.D0/3
     #.D0*t113*t74+256.D0/3.D0*t113*t77)*s23r+((256.D0/3.D0*t754*t150+25
     #6.D0/3.D0*t756*t268)*s34r-t763)*s2l1+((-256.D0/3.D0*t754*t226-256.
     #D0/3.D0*t756*t274)*s34r+t772)*s2l2+t780*s34r-256.D0/3.D0*t782*t74+
     #256.D0/3.D0*t782*t77)*t16
      s7 = ((-256.D0/3.D0*t113*t675+256.D0/3.D0*t113*t677-256.D0/3.D0*t1
     #71*t74+256.D0/3.D0*t171*t77)*t141+(((256.D0/3.D0*t797*t150+256.D0/
     #3.D0*t799*t487)*s34r+t763+256.D0/3.D0*t487)*s2l1+((-256.D0/3.D0*t7
     #97*t226-256.D0/3.D0*t799*t628)*s34r-t772-256.D0/3.D0*t628)*s2l2-t7
     #80*s34r-256.D0/3.D0*t817*t74+256.D0/3.D0*t817*t77)*s23r+(512.D0/3.
     #D0*t129*t22*t173+256.D0/3.D0*t508*t22*s34r)*s2l1+(-512.D0/3.D0*t12
     #9*t52*t173-256.D0/3.D0*t508*t52*s34r)*s2l2+t330*t173+(256.D0/3.D0*
     #t388*t74-256.D0/3.D0*t388*t77)*s34r)*s1vr
      s5 = s6+s7
      taux2 = s4+s5

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = -taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = t2*l3
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet2 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = t2*l3
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet4 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      ACnum1e0 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcoff4
      RETURN
      END

      double precision function ACnum1e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = t1**2
      t3 = z*t2
      t4 = l3-1
      t5 = t4**2
      t6 = t5*t4
      t7 = 1/s3vr
      t8 = t6*t7
      t9 = s1vr**2
      t12 = t2*t1
      t13 = z*t12
      t14 = t5**2
      t16 = t7*s34r
      t21 = s13r**2
      t24 = t1*t5
      t25 = t7*s2l2
      t26 = t24*t25
      t27 = t2*t5
      t28 = t7*s3l2p
      t29 = t27*t28
      t33 = 128.D0/3.D0*t26
      t34 = 64.D0/3.D0*t29
      t35 = s4l2p*t7
      t36 = t27*t35
      t40 = t2*t6
      t41 = t16*s2l2
      t42 = t40*t41
      t44 = t12*t6
      t45 = t28*s34r
      t52 = t7*s2l1
      t53 = t24*t52
      t54 = t7*s3l1p
      t55 = t27*t54
      t60 = 64.D0/3.D0*t55
      t61 = s4l1p*t7
      t62 = t27*t61
      t66 = t16*s2l1
      t69 = t54*s34r
      t76 = l3*z
      t77 = t76*t2
      t78 = t5*t7
      t79 = t9*s1vr
      t94 = t76*t12*t8*s34r
      t96 = t12*t5
      t97 = t96*t28
      t99 = t96*t35
      t103 = t61*s3l2p
      t104 = t96*t103
      t106 = t1*z
      t107 = t106*t78
      t119 = 128.D0/3.D0*t97+128.D0/3.D0*t99
      t122 = s4l2p*s4l1p
      t125 = 3*z
      t127 = (1-t125)*z
      t135 = t35*s34r
      t143 = t2**2
      t144 = t143*t6
      t145 = t144*t28
      t147 = t144*t35
      t161 = t27*l3
      t165 = t16*s23r
      t167 = l3*t12
      t168 = s34r**2
      t169 = t8*t168
      t170 = t167*t169
      t176 = l3*t2
      t177 = t4*t7
      t178 = t177*s3l2p
      t179 = t176*t178
      t180 = 128.D0/3.D0*t179
      t181 = t4*s4l2p
      t182 = t181*t7
      t183 = t176*t182
      t184 = 64.D0/3.D0*t183
      t187 = l3*t4
      t188 = t1*t7
      t190 = t187*t188*s2l2
      t195 = l3*t7
      t196 = t195*s34r
      t197 = t27*t196
      t199 = z*t4
      t201 = 64.D0/3.D0*t199*t7
      t202 = 64*t197+t201
      t204 = t195*s3l2p
      t205 = t96*t204
      t207 = t5*l3
      t209 = t12*s4l2p*t7
      t210 = t207*t209
      t211 = 128.D0/3.D0*t210
      t214 = t1*t4
      t217 = t2*t4
      t218 = t217*t35
      t223 = 64*t179
      t226 = s23r**2
      t229 = 1+z
      t233 = -192*t197-64.D0/3.D0*t229*t4*t7
      t239 = 2-z
      t240 = t239*t4
      t241 = t188*s3l2p
      t245 = t1*s4l2p*t7
      t251 = t27*t16
      t253 = -320.D0/3.D0*t170+64.D0/3.D0*t251
      t255 = l3*t143
      t256 = t8*s3l2p
      t257 = t255*t256
      t259 = t6*l3
      t261 = t143*s4l2p*t7
      t262 = t259*t261
      t266 = 2*z
      t268 = (3-t266)*t2
      t269 = t78*s3l2p
      t271 = 2-t125
      t272 = t271*t2
      t274 = t5*s4l2p*t7
      t281 = t214*t7
      t283 = 128.D0/3.D0*t197-128.D0/3.D0*t281
      t285 = -t205-t210
      t294 = 128.D0/3.D0*t170-128.D0/3.D0*t251
      t297 = -128.D0/3.D0*t257-128.D0/3.D0*t262
      t303 = t168*s34r
      t304 = t195*t303
      t306 = t7*t168
      t309 = 128.D0/3.D0*t143*t14*t304-128.D0/3.D0*t44*t306
      t311 = t143*t1
      t312 = t311*t14
      t315 = l3*s4l2p*t7
      t326 = t176*t177*s3l1p
      t327 = 128.D0/3.D0*t326
      t329 = t4*s4l1p*t7
      t330 = t176*t329
      t331 = 64.D0/3.D0*t330
      t335 = t187*t188*s2l1
      t341 = t195*s3l1p
      t342 = t96*t341
      t344 = t12*s4l1p
      t345 = t344*t7
      t346 = t207*t345
      t347 = 128.D0/3.D0*t346
      t352 = t217*t61
      t357 = 64*t326
      t366 = t188*s3l1p
      t369 = t1*s4l1p
      t370 = t369*t7
      t377 = t255*t8*s3l1p
      t380 = t143*s4l1p*t7
      t381 = t259*t380
      t385 = t78*s3l1p
      t388 = t5*s4l1p*t7
      t396 = -t342-t346
      t406 = -128.D0/3.D0*t377-128.D0/3.D0*t381
      t418 = l3*s4l1p*t7
      t430 = l3**2
      t431 = z*t430
      t432 = t431*t4
      t433 = t2*t7
      t434 = t9**2
      t446 = t12*t7
      t447 = t446*s34r
      t448 = t431*t5*t447
      t450 = 4*z
      t451 = t450-3
      t466 = t326+t330
      t470 = t167*t4
      t471 = t28*s3l1p
      t476 = 128.D0/3.D0*t167*t181*s4l1p
      t492 = -1+t266
      t493 = t492*t4
      t496 = 2*t1
      t497 = t496*t4
      t511 = t431*t143
      t512 = t511*t169
      t514 = t255*t269
      t516 = t255*t274
      t521 = t255*t5*t103
      t523 = 6*z
      t527 = t27*t7
      t532 = -t492
      t533 = t532*t4
      t534 = t433*s3l2p
      t537 = -t229
      t538 = t537*t4
      t539 = t2*s4l2p
      t540 = t539*t7
      t548 = -t4
      t553 = t492*z
      t567 = t167*t182
      t572 = 128.D0/3.D0*t470*t103
      t573 = z**2
      t574 = t573*t4
      t575 = l3*t1
      t586 = t207*t12
      t589 = t451*t4
      t596 = t61*s34r
      t616 = -t496*t4
      t622 = t616*t2
      t637 = t492*t1
      t641 = t255*t6
      t646 = t492*t2
      t668 = l3*t311
      t680 = z+2
      t682 = t76*t7
      t690 = -t1
      t691 = t690*t12
      t704 = t573*l3
      t714 = t430*t2
      t715 = t714*t4
      t721 = t430*t7
      t722 = t721*t168
      t723 = t96*t722
      t724 = 128.D0/3.D0*t723
      t725 = t493*t1
      t726 = t725*t196
      t738 = t78*t168
      t753 = t4*t12
      t754 = t753*t430
      t757 = t106*t204
      t761 = t430*t1
      t762 = t761*t25
      t764 = t714*t28
      t766 = t714*t35
      t772 = t4*t430*t433*s34r
      t775 = -128*t772-64.D0/3.D0*t682
      t777 = t721*s3l2p
      t778 = t753*t777
      t781 = 5*t548*t12
      t783 = t430*s4l2p*t7
      t799 = -t724+64.D0/3.D0*t271*t4*t1*t196
      t801 = t5*t430
      t802 = t143*t7
      t804 = t801*t802*s3l2p
      t806 = t801*t261
      t810 = 5*z
      t813 = (t810-1)*t4*l3
      t823 = t226*s23r
      t827 = 192*t772+128.D0/3.D0*t195
      t831 = 7*t548*t12
      t836 = 4-t266
      t837 = t836*t1
      t840 = t229*t1
      t846 = t450+1
      t851 = z*t7
      t853 = 192*t723+64.D0/3.D0*t846*t4*t1*t196-64.D0/3.D0*t851
      t861 = 3*t2*t4
      t866 = t537*t1
      t872 = t6*t430
      t874 = t872*t802*t303
      t882 = 2*t573
      t887 = 128.D0/3.D0*t874+64.D0/3.D0*(-2+t450)*t5*l3*t433*t168+64.D0
     #/3.D0*(-t882+t266-1)*t4*t16
      t889 = t311*t7
      t891 = t872*t889*s3l2p
      t895 = t872*t311*s4l2p*t7
      t900 = t846*t12*t5
      t904 = (-1-t266)*t12*t5
      t910 = (t125-t882-1)*t4
      t912 = t533*t1
      t923 = -128.D0/3.D0*t772+128.D0/3.D0*t575*t7
      t925 = t12*t430
      t930 = t176*t28
      t931 = 128.D0/3.D0*t930
      t932 = t176*t35
      t941 = -256.D0/3.D0*t723-128.D0/3.D0*t240*t1*t196+128.D0/3.D0*t851
      t946 = t240*l3
      t967 = -256.D0/3.D0*t874-128.D0/3.D0*t239*l3*t2*t738-128.D0/3.D0*t
     #548*t1*t851*s34r
      t973 = t239*t12*t5
      t986 = t14*t430
      t987 = t168**2
      t993 = -128.D0/3.D0*t986*t889*t987-128.D0/3.D0*t44*t304+128.D0/3.D
     #0*t3*t738
      t995 = t143*t2
      t996 = t995*t7
      t1008 = z*t5
      s2 = (128.D0/3.D0*t715*t16*t79+(-256.D0/3.D0*t715*t165-t724-128.D0
     #/3.D0*t726)*t9+(128.D0/3.D0*t715*t16*t226+(128.D0/3.D0*t723+128.D0
     #/3.D0*t726)*s23r+128.D0/3.D0*t492*l3*t2*t738)*s1vr)*s1l2+64.D0/3.D
     #0*t714*t28*t434+(-256.D0/3.D0*t714*t28*s23r+64.D0/3.D0*t715*t41-32
     #0.D0/3.D0*t754*t45-64.D0/3.D0*t757)*t79
      s1 = s2+((-128.D0/3.D0*t762+320.D0/3.D0*t764+128.D0/3.D0*t766)*t22
     #6+(t775*s2l2+(1024.D0/3.D0*t778-64.D0/3.D0*t781*t783)*s34r+64*t575
     #*t28+64.D0/3.D0*t106*t315)*s23r+t799*s2l2+(512.D0/3.D0*t804+128.D0
     #/3.D0*t806)*t168+(64.D0/3.D0*t813*t534-64.D0/3.D0*t622*t315)*s34r)
     #*t9+((128.D0/3.D0*t762-128.D0/3.D0*t764-128.D0/3.D0*t766)*t823+(t8
     #27*s2l2+(-704.D0/3.D0*t778+64.D0/3.D0*t831*t783)*s34r-64.D0/3.D0*t
     #837*t204-64.D0/3.D0*t840*t315)*t226+(t853*s2l2+(-320*t804-192*t806
     #)*t168+(-448.D0/3.D0*t179-64.D0/3.D0*t861*t315)*s34r-64.D0/3.D0*t8
     #66*t28-64.D0/3.D0*t540)*s23r+t887*s2l2+(-128*t891-256.D0/3.D0*t895
     #)*t303+(-64.D0/3.D0*t900*t204+64.D0/3.D0*t904*t315)*t168+(-64.D0/3
     #.D0*t910*t241-64.D0/3.D0*t912*z*s4l2p*t7)*s34r)*s1vr+(t923*s2l2+(1
     #28.D0/3.D0*t778+128.D0/3.D0*t925*t182)*s34r-t931-128.D0/3.D0*t932)
     #*t823
      t1013 = s1+(t941*s2l2+(256.D0/3.D0*t804+256.D0/3.D0*t806)*t168+(12
     #8.D0/3.D0*t946*t534+128.D0/3.D0*t946*t540)*s34r-128.D0/3.D0*t106*t
     #28-128.D0/3.D0*t106*t35)*t226+(t967*s2l2+(256.D0/3.D0*t891+256.D0/
     #3.D0*t895)*t303+(128.D0/3.D0*t973*t204+128.D0/3.D0*t973*t315)*t168
     #+(-128.D0/3.D0*t199*t534-128.D0/3.D0*t199*t540)*s34r)*s23r+t993*s2
     #l2+(128.D0/3.D0*t986*t996*s3l2p+128.D0/3.D0*t986*t995*s4l2p*t7)*t9
     #87-t297*t303+(-128.D0/3.D0*t13*t269-128.D0/3.D0*t1008*t209)*t168
      t1025 = t106*t341
      t1029 = t761*t52
      t1031 = t714*t54
      t1033 = t714*t61
      t1039 = t753*t721*s3l1p
      t1042 = t430*s4l1p*t7
      t1055 = t801*t802*s3l1p
      t1057 = t801*t380
      t1061 = t433*s3l1p
      t1097 = t2*s4l1p*t7
      t1103 = t872*t889*s3l1p
      t1107 = t872*t311*s4l1p*t7
      t1131 = 128.D0/3.D0*t176*t54
      t1132 = t176*t61
      t1160 = t548*z
      s2 = 64.D0/3.D0*t714*t54*t434+(-256.D0/3.D0*t714*t54*s23r+64.D0/3.
     #D0*t715*t66-320.D0/3.D0*t754*t69-64.D0/3.D0*t1025)*t79
      s1 = s2+((-128.D0/3.D0*t1029+320.D0/3.D0*t1031+128.D0/3.D0*t1033)*
     #t226+(t775*s2l1+(1024.D0/3.D0*t1039-64.D0/3.D0*t781*t1042)*s34r+64
     #*t575*t54+64.D0/3.D0*t106*t418)*s23r+t799*s2l1+(512.D0/3.D0*t1055+
     #128.D0/3.D0*t1057)*t168+(64.D0/3.D0*t813*t1061-64.D0/3.D0*t622*t41
     #8)*s34r)*t9+((128.D0/3.D0*t1029-128.D0/3.D0*t1031-128.D0/3.D0*t103
     #3)*t823+(t827*s2l1+(-704.D0/3.D0*t1039+64.D0/3.D0*t831*t1042)*s34r
     #-64.D0/3.D0*t837*t341-64.D0/3.D0*t840*t418)*t226+(t853*s2l1+(-320*
     #t1055-192*t1057)*t168+(-448.D0/3.D0*t326-64.D0/3.D0*t861*t418)*s34
     #r-64.D0/3.D0*t866*t54-64.D0/3.D0*t1097)*s23r+t887*s2l1+(-128*t1103
     #-256.D0/3.D0*t1107)*t303+(-64.D0/3.D0*t900*t341+64.D0/3.D0*t904*t4
     #18)*t168+(-64.D0/3.D0*t910*t366-64.D0/3.D0*t912*z*s4l1p*t7)*s34r)*
     #s1vr+(t923*s2l1+(128.D0/3.D0*t1039+128.D0/3.D0*t925*t329)*s34r-t11
     #31-128.D0/3.D0*t1132)*t823
      t1185 = s1+(t941*s2l1+(256.D0/3.D0*t1055+256.D0/3.D0*t1057)*t168+(
     #128.D0/3.D0*t946*t1061+128.D0/3.D0*t946*t1097)*s34r-128.D0/3.D0*t1
     #06*t54-128.D0/3.D0*t106*t61)*t226+(t967*s2l1+(256.D0/3.D0*t1103+25
     #6.D0/3.D0*t1107)*t303+(128.D0/3.D0*t973*t341+128.D0/3.D0*t973*t418
     #)*t168+(128.D0/3.D0*t1160*t1061+128.D0/3.D0*t1160*t1097)*s34r)*s23
     #r+t993*s2l1+(128.D0/3.D0*t986*t996*s3l1p+128.D0/3.D0*t986*t995*s4l
     #1p*t7)*t987-t406*t303+(-128.D0/3.D0*t1008*t446*s3l1p-128.D0/3.D0*t
     #1008*t345)*t168
      t1187 = t430*l3
      t1188 = t1187*t7
      t1200 = 128.D0/3.D0*t1160*t1187*t447
      t1201 = t925*t28
      t1202 = 128.D0/3.D0*t1201
      t1204 = 64.D0/3.D0*t925*t35
      t1208 = 64.D0/3.D0*t925*t103
      t1216 = 128.D0/3.D0*t199*t1187*t447
      t1240 = t1008*t1187*t802*t168
      t1241 = 128.D0/3.D0*t1240
      t1245 = t430*t143
      t1250 = t1245*t4
      t1256 = t714*t7
      t1262 = t537*t2
      t1287 = t761*t7
      t1293 = (-1+t450)*t1
      t1307 = t533*z
      t1313 = (3-z)*t2
      t1325 = 4*t573
      t1363 = t446*s3l2p
      t1368 = -t680*t4*l3
      t1427 = t176*t4
      t1464 = (t523-t882-2)*t1
      t1528 = t548*t573
      s2 = (-64.D0/3.D0*t3*t8*t9+64.D0/3.D0*t13*t14*t16*s1vr)*t21*s13r+(
     #((-64.D0/3.D0*t26+64.D0/3.D0*t29)*t9+((t33-t34-64.D0/3.D0*t36)*s23
     #r+64.D0/3.D0*t42-64.D0/3.D0*t44*t45)*s1vr)*s1l1+((-64.D0/3.D0*t53+
     #64.D0/3.D0*t55)*t9+((128.D0/3.D0*t53-t60-64.D0/3.D0*t62)*s23r+64.D
     #0/3.D0*t40*t66-64.D0/3.D0*t44*t69)*s1vr)*s1l2+320.D0/3.D0*t77*t78*
     #t79+(64.D0/3.D0*t77*t78*s23r+(t33-t34-128.D0/3.D0*t36)*s2l1+(-t60-
     #128.D0/3.D0*t62)*s2l2-320.D0/3.D0*t94+(-128.D0/3.D0*t97-64.D0/3.D0
     #*t99)*s3l1p-64.D0/3.D0*t104-128.D0/3.D0*t107)*t9+(((-64.D0/3.D0*t2
     #9-64.D0/3.D0*t36)*s2l1+(-64.D0/3.D0*t55-64.D0/3.D0*t62)*s2l2-128.D
     #0/3.D0*t94+t119*s3l1p+128.D0/3.D0*t104+(128.D0/3.D0*t96*t122-64.D0
     #/3.D0*t127*t24)*t7)*s23r+(-128.D0/3.D0*t42+64.D0/3.D0*t44*t135)*s2
     #l1+64.D0/3.D0*t44*s4l1p*t41+((128.D0/3.D0*t145+64.D0/3.D0*t147)*s3
     #l1p+64.D0/3.D0*t144*t103+64.D0/3.D0*t3*t8)*s34r)*s1vr)*t21
      s4 = s2
      s8 = ((128.D0/3.D0*t161*t16*t9+(-128.D0/3.D0*t161*t165-128.D0/3.D0
     #*t170)*s1vr)*s1l2+(t180-t184)*t79+((64*t190-320.D0/3.D0*t179-t184)
     #*s23r+t202*s2l2+(-512.D0/3.D0*t205-t211)*s34r-64.D0/3.D0*t214*t28+
     #64.D0/3.D0*t218)*t9+((-256.D0/3.D0*t190+t223+64*t183)*t226+(t233*s
     #2l2+(192*t205+320.D0/3.D0*t210)*s34r+64.D0/3.D0*t240*t241+64.D0/3.
     #D0*t199*t245)*s23r+t253*s2l2+(512.D0/3.D0*t257+320.D0/3.D0*t262)*t
     #168+(64.D0/3.D0*t268*t269+64.D0/3.D0*t272*t274)*s34r)*s1vr+(t283*s
     #2l2+128.D0/3.D0*t285*s34r+128.D0/3.D0*t217*t28+128.D0/3.D0*t218)*t
     #226+(t294*s2l2+t297*t168+t119*s34r)*s23r+t309*s2l2+(-128.D0/3.D0*t
     #312*t204-128.D0/3.D0*t312*t315)*t303+(128.D0/3.D0*t145+128.D0/3.D0
     #*t147)*t168)*s1l1
      s9 = ((t327-t331)*t79+((64*t335-320.D0/3.D0*t326-t331)*s23r+t202*s
     #2l1+(-512.D0/3.D0*t342-t347)*s34r-64.D0/3.D0*t214*t54+64.D0/3.D0*t
     #352)*t9+((-256.D0/3.D0*t335+t357+64*t330)*t226+(t233*s2l1+(192*t34
     #2+320.D0/3.D0*t346)*s34r+64.D0/3.D0*t240*t366+64.D0/3.D0*t199*t370
     #)*s23r+t253*s2l1+(512.D0/3.D0*t377+320.D0/3.D0*t381)*t168+(64.D0/3
     #.D0*t268*t385+64.D0/3.D0*t272*t388)*s34r)*s1vr+(t283*s2l1+128.D0/3
     #.D0*t396*s34r+128.D0/3.D0*t217*t54+128.D0/3.D0*t352)*t226+(t294*s2
     #l1+t406*t168+(128.D0/3.D0*t96*t54+128.D0/3.D0*t96*t61)*s34r)*s23r+
     #t309*s2l1+(-128.D0/3.D0*t312*t341-128.D0/3.D0*t312*t418)*t303+(128
     #.D0/3.D0*t144*t54+128.D0/3.D0*t144*t61)*t168)*s1l2-64.D0/3.D0*t432
     #*t433*t434
      s7 = s8+s9
      s8 = s7+(-512.D0/3.D0*t432*t433*s23r+(-t180-t184)*s2l1+(-t327-t331
     #)*s2l2-448.D0/3.D0*t448-64.D0/3.D0*t451*z*l3*t281)*t79
      s9 = s8+(-64.D0/3.D0*t432*t433*t226+((-128.D0/3.D0*t190+256.D0/3.D
     #0*t179+256.D0/3.D0*t183)*s2l1+256.D0/3.D0*t466*s2l2+832.D0/3.D0*t4
     #48+128.D0/3.D0*t470*t471+(-t476+64.D0/3.D0*(9-7*z)*z*t187*t1)*t7)*
     #s23r+(-256.D0/3.D0*t161*t41+(64.D0/3.D0*t205+t211)*s34r+64.D0/3.D0
     #*t493*t241+64.D0/3.D0*t497*t245)*s2l1+((64.D0/3.D0*t342+t347)*s34r
     #+64.D0/3.D0*t493*t366+64.D0/3.D0*t497*t370)*s2l2+640.D0/3.D0*t512+
     #((128.D0/3.D0*t514+64.D0/3.D0*t516)*s3l1p+64.D0/3.D0*t521+64.D0/3.
     #D0*(4+t523)*z*l3*t527)*s34r+(-128.D0/3.D0*t533*t534-64.D0/3.D0*t53
     #8*t540)*s3l1p-64.D0/3.D0*t538*t2*t103+(-256.D0/3.D0*t548*t2*t122+6
     #4.D0/3.D0*t553*t4)*t7)*t9
      s10 = s9
      s14 = ((64.D0/3.D0*t179+64.D0/3.D0*t183)*s2l1+64.D0/3.D0*t466*s2l2
     #+64.D0/3.D0*t448+(-128.D0/3.D0*t167*t178-128.D0/3.D0*t567)*s3l1p-t
     #572+(-t476-256.D0/3.D0*t574*t575)*t7)*t226+(((256.D0/3.D0*t197-128
     #.D0/3.D0*t281)*s2l2-128.D0/3.D0*t586*t135+64.D0/3.D0*t589*t241+64.
     #D0/3.D0*t589*t245)*s2l1+(-128.D0/3.D0*t586*t596+64.D0/3.D0*t589*t3
     #66+64.D0/3.D0*t589*t370)*s2l2-128.D0/3.D0*t512+((-256.D0/3.D0*t514
     #-128.D0/3.D0*t516)*s3l1p-128.D0/3.D0*t521-256.D0/3.D0*t76*t527)*s3
     #4r+(128.D0/3.D0*t616*t534+128.D0/3.D0*t616*t540)*s3l1p+128.D0/3.D0
     #*t622*t103+(128.D0/3.D0*t616*t539*s4l1p+64.D0/3.D0*(2*z-2-2*t573)*
     #z*t4)*t7)*s23r+(128.D0/3.D0*t637*t5*t41+64.D0/3.D0*t641*t28*t168+(
     #-64.D0/3.D0*t3*t269-64.D0/3.D0*t646*t274)*s34r)*s2l1
      s13 = s14+(64.D0/3.D0*t641*t54*t168+(-64.D0/3.D0*t3*t385-64.D0/3.D
     #0*t646*t388)*s34r)*s2l2-128.D0/3.D0*t431*t311*t14*t7*t303+((-128.D
     #0/3.D0*t668*t256-64.D0/3.D0*t668*t6*s4l2p*t7)*s3l1p-64.D0/3.D0*t66
     #8*t6*t103-128.D0/3.D0*t44*t680*t682)*t168+((128.D0/3.D0*t532*t12*t
     #269+64.D0/3.D0*t691*t274)*s3l1p+64.D0/3.D0*t691*t5*t103-64.D0/3.D0
     #*t107)*s34r
      s14 = s1vr
      s12 = s13*s14
      s13 = (128.D0/3.D0*t704*t2*t78*s34r-128.D0/3.D0*t574*t188)*t226
      s11 = s12+s13
      s6 = s10+s11
      s7 = s13r
      s5 = s6*s7
      s3 = s4+s5
      s1 = s3+t1013*s1l1+t1185*s1l2
      s2 = s1+(64.D0/3.D0*t3*t1188*s23r+64.D0/3.D0*t714*t28*s2l1+64.D0/3
     #.D0*t714*t54*s2l2-t1200+(t1202-t1204)*s3l1p-t1208)*t434+(64*t3*t11
     #88*t226+(t1216+(-256.D0/3.D0*t1201+t1204)*s3l1p+t1208+(128.D0/3.D0
     #*t925*t122+64.D0/3.D0*(-4+t810)*z*t761)*t7)*s23r+(64.D0/3.D0*t754*
     #t135+64.D0/3.D0*t757)*s2l1+(64.D0/3.D0*t754*t596+64.D0/3.D0*t1025)
     #*s2l2-t1241+((-256.D0/3.D0*t4*t143*t777+64.D0/3.D0*t1245*t182)*s3l
     #1p+64.D0/3.D0*t1250*t103+64.D0/3.D0*(-7+t266)*t4*z*t1256)*s34r+(-2
     #56.D0/3.D0*t930+64.D0/3.D0*t1262*t315)*s3l1p+64.D0/3.D0*t1262*l3*t
     #103)*t79
      s4 = s2
      s7 = 64.D0/3.D0*t3*t1188*t823+((-128.D0/3.D0*t764-64.D0/3.D0*t766)
     #*s2l1+(-128.D0/3.D0*t1031-64.D0/3.D0*t1033)*s2l2-t1216+(t1202+t120
     #4)*s3l1p+t1208-320.D0/3.D0*t690*z*t1287)*t226+((-64.D0/3.D0*t1293*
     #t204-64.D0/3.D0*t637*t315)*s2l1+(-64.D0/3.D0*t1293*t341-64.D0/3.D0
     #*t637*t418)*s2l2-256.D0/3.D0*t1240+(256.D0/3.D0*t1250*t471-64.D0/3
     #.D0*t1307*t1256)*s34r+(128.D0/3.D0*t1313*t204+64*t3*t315)*s3l1p+64
     #*t77*t103+(128.D0/3.D0*t167*t122-64.D0/3.D0*(-4+9*z-t1325)*z*l3)*t
     #7)*s23r+((128.D0/3.D0*t723-128.D0/3.D0*t217*t196)*s2l2+(-t223+64.D
     #0/3.D0*t567)*s34r+64.D0/3.D0*t241)*s2l1
      s6 = s7+((-t357+64.D0/3.D0*t167*t329)*s34r+64.D0/3.D0*t366)*s2l2+(
     #128.D0/3.D0*t5*t311*t430*t471+64.D0/3.D0*t836*z*t5*t925*t7)*t168+(
     #(128.D0/3.D0*t946*t1363-64.D0/3.D0*t1368*t209)*s3l1p-64.D0/3.D0*t1
     #368*t344*t28-64.D0/3.D0*(-5+t266)*t4*t1*t682)*s34r+(128.D0/3.D0*(t
     #266-t573)*t1*t28+64.D0/3.D0*t245)*s3l1p+64.D0/3.D0*t369*t28
      s7 = t9
      s5 = s6*s7
      s3 = s4+s5
      s5 = s3
      s8 = (t1200-64.D0/3.D0*t127*t1287)*t823+((-t931-64.D0/3.D0*t932)*s
     #2l1+(-t1131-64.D0/3.D0*t1132)*s2l2-t1241+64.D0/3.D0*t1307*t714*t16
     #+(-128.D0/3.D0*t239*t2*t204-64.D0/3.D0*t1313*t315)*s3l1p-64.D0/3.D
     #0*t1313*l3*t103+(-128.D0/3.D0*t176*t122-64.D0/3.D0*(-2+t450-t1325)
     #*z*l3)*t7)*t226+((128.D0/3.D0*t1427*t45-64.D0/3.D0*t1293*t28-64.D0
     #/3.D0*t637*t35)*s2l1+(128.D0/3.D0*t1427*t69-64.D0/3.D0*t1293*t54-6
     #4.D0/3.D0*t637*t61)*s2l2+256.D0/3.D0*t690*z*t5*t925*t306+((-128.D0
     #/3.D0*t616*l3*t1363-128.D0/3.D0*t567)*s3l1p-t572-128.D0/3.D0*t725*
     #t682)*s34r+(-128.D0/3.D0*(-1+t125-t573)*t1*t28-64.D0/3.D0*t1464*t3
     #5)*s3l1p-64.D0/3.D0*t1464*t103+(-128.D0/3.D0*t637*t122-64.D0/3.D0*
     #t553)*t7)*s23r+((128.D0/3.D0*t207*t446*t168-128.D0/3.D0*t217*t16)*
     #s2l2-64.D0/3.D0*t285*t168+(64.D0/3.D0*t199*t241-64.D0/3.D0*t218)*s
     #34r)*s2l1
      s7 = s8+(-64.D0/3.D0*t396*t168+(64.D0/3.D0*t199*t366-64.D0/3.D0*t3
     #52)*s34r)*s2l2+128.D0/3.D0*t511*t8*t303+(128.D0/3.D0*t1008*l3*t802
     #*s3l2p*s3l1p-128.D0/3.D0*t704*t527)*t168+((-128.D0/3.D0*(t266-t573
     #-1)*t4*t534-64.D0/3.D0*t493*t540)*s3l1p-64.D0/3.D0*t493*t2*t103-t2
     #01)*s34r
      s8 = s1vr
      s6 = s7*s8
      s4 = s5+s6
      taux1 = s4+(128.D0/3.D0*t1528*t2*t721*s34r+128.D0/3.D0*t573*t1*t19
     #5)*t823+(-128.D0/3.D0*t573*t5*t12*t722+128.D0/3.D0*t1528*t1*t196+1
     #28.D0/3.D0*t573*z*t7)*t226
      t1 = -1+z
      t3 = l3-1
      t4 = t3**2
      t5 = 7*t1*t4
      t6 = 1/s3vr
      t7 = t6*s2l2
      t10 = t1**2
      t11 = t10*t4
      t12 = t6*s3l2p
      t13 = t11*t12
      t14 = 1024.D0/3.D0*t13
      t16 = s1vr**2
      t18 = 4*t1
      t19 = t18*t4
      t22 = s4l2p*t6
      t23 = t11*t22
      t27 = t4*t3
      t28 = t10*t27
      t29 = t6*s34r
      t30 = t29*s2l2
      t33 = t10*t1
      t34 = t33*t27
      t35 = t12*s34r
      t42 = t6*s2l1
      t45 = t6*s3l1p
      t46 = t11*t45
      t47 = 1024.D0/3.D0*t46
      t52 = s4l1p*t6
      t53 = t11*t52
      t57 = t29*s2l1
      t60 = t45*s34r
      t73 = t33*t4
      t74 = t22*s3l1p
      t77 = t52*s3l2p
      t104 = t10**2
      t105 = t104*t27
      t114 = s13r**2
      t116 = l3*t3
      t117 = t1*t6
      t119 = t116*t117*s2l2
      t120 = l3*t10
      t122 = t3*s4l2p*t6
      t123 = t120*t122
      t126 = t16*s1vr
      t129 = t3*t6
      t130 = t129*s3l2p
      t131 = t120*t130
      t135 = l3*t6
      t136 = t135*s34r
      t137 = t11*t136
      t139 = z*t3
      t142 = 1024*t137+1024.D0/3.D0*t139*t6
      t144 = t135*s3l2p
      t145 = t73*t144
      t147 = t4*l3
      t148 = t33*s4l2p
      t149 = t148*t6
      t150 = t147*t149
      t154 = t1*t3
      t157 = t10*t3
      t158 = t157*t22
      t166 = s23r**2
      t173 = -5888.D0/3.D0*t137-256.D0/3.D0*(7+z)*t3*t6
      t179 = 4*z
      t180 = 8-t179
      t181 = t180*t3
      t182 = t117*s3l2p
      t186 = t1*s4l2p*t6
      t188 = 1024.D0/3.D0*t139*t186
      t191 = l3*t33
      t192 = t27*t6
      t193 = s34r**2
      t195 = t191*t192*t193
      t197 = t11*t29
      t199 = -2816.D0/3.D0*t195+256.D0/3.D0*t197
      t201 = l3*t104
      t203 = t201*t192*s3l2p
      t205 = t27*l3
      t207 = t104*s4l2p*t6
      t208 = t205*t207
      t212 = 2*z
      t213 = 3-t212
      t214 = t213*t10
      t215 = t4*t6
      t216 = t215*s3l2p
      t218 = 3*z
      t220 = (2-t218)*t10
      t222 = t4*s4l2p*t6
      t230 = 4*t3
      t234 = 2048.D0/3.D0*t137-512.D0/3.D0*t230*t1*t6
      t245 = 512.D0/3.D0*t195-512.D0/3.D0*t197
      t248 = -512.D0/3.D0*t203-512.D0/3.D0*t208
      t257 = t4**2
      t259 = t193*s34r
      t260 = t135*t259
      t265 = 512.D0/3.D0*t104*t257*t260-512.D0/3.D0*t34*t6*t193
      t267 = t104*t1
      t268 = t267*t257
      t271 = l3*s4l2p*t6
      t284 = t116*t117*s2l1
      t286 = t3*s4l1p*t6
      t287 = t120*t286
      t292 = t129*s3l1p
      t293 = t120*t292
      t299 = t135*s3l1p
      t300 = t73*t299
      t302 = t33*s4l1p
      t303 = t302*t6
      t304 = t147*t303
      t310 = t157*t52
      t325 = t117*s3l1p
      t329 = t1*s4l1p*t6
      t331 = 1024.D0/3.D0*t139*t329
      t337 = t201*t192*s3l1p
      t340 = t104*s4l1p*t6
      t341 = t205*t340
      t345 = t215*s3l1p
      t348 = t4*s4l1p*t6
      t368 = 512.D0/3.D0*t337+512.D0/3.D0*t341
      t381 = l3*s4l1p*t6
      t393 = 2*t3
      t394 = t393*l3
      t395 = t10*t6
      t396 = t395*s3l2p
      t401 = t395*s3l1p
      t409 = -t393*t10
      t411 = -t3
      t413 = 9*t411*t10
      t423 = t191*t3
      t430 = 256.D0/3.D0*t145
      t431 = 2816.D0/3.D0*t150
      t434 = 6*z
      t435 = 2-t434
      t436 = t435*t1
      t441 = 256.D0/3.D0*t300
      t442 = 2816.D0/3.D0*t304
      t449 = t201*t4
      t452 = -t449*t74+t449*t77
      t455 = -z-1
      t457 = t455*t3*t10
      t476 = -t435*t1
      t479 = -z+5
      t480 = t479*t1
      t494 = -t452
      t497 = t33*t3
      t508 = -4+t218
      t509 = t508*t10
      t511 = -1+t212
      t512 = t511*t10
      t531 = l3*t267*t27
      t538 = t455*t33*t4
      t548 = l3**2
      t549 = t548*t10
      t550 = t16**2
      t554 = -t1
      t555 = t554*t548
      t558 = t549*t12
      t560 = t549*t22
      t561 = 512.D0/3.D0*t560
      t566 = 6*t411*t10*t548
      t569 = t230*t33
      t570 = t569*t548
      t574 = -t508*t1
      t579 = t18*t548
      t580 = t579*t7
      t583 = 256.D0/3.D0*t560
      t589 = 5*z
      t594 = -256.D0/3.D0*t3*t548*t395*s34r-256.D0/3.D0*(t589-1)*l3*t6
      t597 = 5*t411*t33
      t598 = t548*t6
      t599 = t598*s3l2p
      t602 = t548*s4l2p*t6
      t608 = 6*t1*l3
      t612 = (6-t589)*t1
      t618 = t73*t598*t193
      t625 = 256*t618-256.D0/3.D0*(-8+t589)*t3*t1*t136
      t627 = t4*t548
      t628 = t104*t6
      t630 = t627*t628*s3l2p
      t632 = t627*t207
      t638 = (-z-4)*t3*t10
      t641 = z*t10
      t642 = t641*t3
      t647 = 3*t554
      t648 = t647*t6
      t657 = t166*s23r
      t661 = t598*s34r
      t663 = -t455
      t664 = 4*t663
      t668 = 4096.D0/3.D0*t10*t3*t661+256.D0/3.D0*t664*l3*t6
      t671 = 8*t411*t33
      t675 = 13*t411*t33
      t681 = (t212+6)*t1
      t686 = (1+7*z)*t1
      t697 = z*t6
      t699 = 1024*t618+512.D0/3.D0*t663*t3*t1*t136-1024.D0/3.D0*t697
      t707 = (9-t212)*t3*t10
      t710 = 3*t3
      t711 = t710*t10
      t717 = -t664*t1
      t720 = -4+z
      t721 = t720*t1
      t726 = t27*t548
      t729 = 1024.D0/3.D0*t726*t628*t259
      t736 = z**2
      t737 = 2*t736
      t742 = t729+256.D0/3.D0*(-6+t212)*t10*t4*t135*t193+256.D0/3.D0*(-t
     #737+t212-4)*t3*t29
      t744 = t267*t6
      t751 = -1024.D0/3.D0*t726*t744*s3l2p-1024.D0/3.D0*t726*t267*s4l2p*
     #t6
      t755 = (-5+t212)*t33*t4
      t759 = (-1-t212)*t33*t4
      t765 = (t218-t737-4)*t3
      t769 = -t511*t3*t1
      t783 = -512.D0/3.D0*t230*t10*t661+512.D0/3.D0*t18*l3*t6
      t786 = t569*t602
      t790 = t120*t12
      t792 = t120*t22
      t801 = -2560.D0/3.D0*t618-512.D0/3.D0*t480*t3*t136+2048.D0/3.D0*t6
     #97
      t807 = t479*t3*t10
      t813 = z*t1
      t820 = 2-z
      t823 = t215*t193
      t830 = -t729-512.D0/3.D0*t820*l3*t10*t823-512.D0/3.D0*t411*t1*t697
     #*s34r
      t835 = t820*t33*t4
      t843 = t10*s4l2p*t6
      t850 = t257*t548
      t851 = t193**2
      t857 = -512.D0/3.D0*t850*t744*t851-512.D0/3.D0*t34*t260+512.D0/3.D
     #0*t641*t823
      t859 = t104*t10
      t860 = t859*t6
      t873 = z*t4
      s2 = 256.D0/3.D0*t549*t12*t550+((256.D0/3.D0*t555*t7-512.D0/3.D0*t
     #558-t561)*s23r+256.D0/3.D0*t566*t30+256.D0/3.D0*t570*t35-256.D0/3.
     #D0*t574*t144)*t126
      s3 = s2+((-256.D0/3.D0*t580+512*t558+t583)*t166+(t594*s2l2+(-256.D
     #0/3.D0*t597*t599-256.D0/3.D0*t597*t602)*s34r+256.D0/3.D0*t608*t12+
     #256.D0/3.D0*t612*t271)*s23r+t625*s2l2+(-256*t630+512.D0/3.D0*t632)
     #*t193+(256.D0/3.D0*t638*t144+512.D0/3.D0*t642*t271)*s34r+256.D0/3.
     #D0*t648*s3l2p)*t16
      s1 = s3+((512.D0/3.D0*t580-2048.D0/3.D0*t558-2048.D0/3.D0*t560)*t6
     #57+(t668*s2l2+(512.D0/3.D0*t671*t599+256.D0/3.D0*t675*t602)*s34r-2
     #56.D0/3.D0*t681*t144-256.D0/3.D0*t686*t271)*t166+(t699*s2l2+(-1024
     #*t630-768*t632)*t193+(-256.D0/3.D0*t707*t144-512.D0/3.D0*t711*t271
     #)*s34r-256.D0/3.D0*t717*t12-256.D0/3.D0*t721*t22)*s23r+t742*s2l2+t
     #751*t259+(-256.D0/3.D0*t755*t144+256.D0/3.D0*t759*t271)*t193+(-256
     #.D0/3.D0*t765*t182-256.D0/3.D0*t769*z*s4l2p*t6)*s34r)*s1vr+(t783*s
     #2l2+(512.D0/3.D0*t569*t599+512.D0/3.D0*t786)*s34r-2048.D0/3.D0*t79
     #0-2048.D0/3.D0*t792)*t657
      t878 = s1+(t801*s2l2+(2560.D0/3.D0*t630+2560.D0/3.D0*t632)*t193+(5
     #12.D0/3.D0*t807*t144+512.D0/3.D0*t807*t271)*s34r-2048.D0/3.D0*t813
     #*t12-2048.D0/3.D0*t813*t22)*t166+(t830*s2l2-t751*t259+(512.D0/3.D0
     #*t835*t144+512.D0/3.D0*t835*t271)*t193+(-512.D0/3.D0*t139*t396-512
     #.D0/3.D0*t139*t843)*s34r)*s23r+t857*s2l2+(512.D0/3.D0*t850*t860*s3
     #l2p+512.D0/3.D0*t850*t859*s4l2p*t6)*t851-t248*t259+(-512.D0/3.D0*z
     #*t33*t216-512.D0/3.D0*t873*t149)*t193
      t885 = t549*t45
      t887 = t549*t52
      t888 = 512.D0/3.D0*t887
      t899 = t579*t42
      t902 = 256.D0/3.D0*t887
      t907 = t598*s3l1p
      t910 = t548*s4l1p*t6
      t924 = t627*t628*s3l1p
      t926 = t627*t340
      t985 = 1024.D0/3.D0*t726*t744*s3l1p+1024.D0/3.D0*t726*t267*s4l1p*t
     #6
      t1004 = t569*t910
      t1008 = t120*t45
      t1010 = t120*t52
      t1039 = t411*z
      t1042 = t10*s4l1p*t6
      s2 = -256.D0/3.D0*t549*t45*t550+((-256.D0/3.D0*t555*t42+512.D0/3.D
     #0*t885+t888)*s23r-256.D0/3.D0*t566*t57-256.D0/3.D0*t570*t60+256.D0
     #/3.D0*t574*t299)*t126
      s3 = s2+((256.D0/3.D0*t899-512*t885-t902)*t166+(-t594*s2l1+(256.D0
     #/3.D0*t597*t907+256.D0/3.D0*t597*t910)*s34r-256.D0/3.D0*t608*t45-2
     #56.D0/3.D0*t612*t381)*s23r-t625*s2l1+(256*t924-512.D0/3.D0*t926)*t
     #193+(-256.D0/3.D0*t638*t299-512.D0/3.D0*t642*t381)*s34r-256.D0/3.D
     #0*t648*s3l1p)*t16
      s1 = s3+((-512.D0/3.D0*t899+2048.D0/3.D0*t885+2048.D0/3.D0*t887)*t
     #657+(-t668*s2l1+(-512.D0/3.D0*t671*t907-256.D0/3.D0*t675*t910)*s34
     #r+256.D0/3.D0*t681*t299+256.D0/3.D0*t686*t381)*t166+(-t699*s2l1+(1
     #024*t924+768*t926)*t193+(256.D0/3.D0*t707*t299+512.D0/3.D0*t711*t3
     #81)*s34r+256.D0/3.D0*t717*t45+256.D0/3.D0*t721*t52)*s23r-t742*s2l1
     #+t985*t259+(256.D0/3.D0*t755*t299-256.D0/3.D0*t759*t381)*t193+(256
     #.D0/3.D0*t765*t325+256.D0/3.D0*t769*z*s4l1p*t6)*s34r)*s1vr+(-t783*
     #s2l1+(-512.D0/3.D0*t569*t907-512.D0/3.D0*t1004)*s34r+2048.D0/3.D0*
     #t1008+2048.D0/3.D0*t1010)*t657
      t1068 = s1+(-t801*s2l1+(-2560.D0/3.D0*t924-2560.D0/3.D0*t926)*t193
     #+(-512.D0/3.D0*t807*t299-512.D0/3.D0*t807*t381)*s34r+2048.D0/3.D0*
     #t813*t45+2048.D0/3.D0*t813*t52)*t166+(-t830*s2l1-t985*t259+(-512.D
     #0/3.D0*t835*t299-512.D0/3.D0*t835*t381)*t193+(-512.D0/3.D0*t1039*t
     #401-512.D0/3.D0*t1039*t1042)*s34r)*s23r-t857*s2l1+(-512.D0/3.D0*t8
     #50*t860*s3l1p-512.D0/3.D0*t850*t859*s4l1p*t6)*t851-t368*t259+(512.
     #D0/3.D0*t873*t33*t6*s3l1p+512.D0/3.D0*t873*t303)*t193
      t1076 = t33*t548
      t1077 = t1076*t74
      t1078 = 1024.D0/3.D0*t1077
      t1079 = t1076*t77
      t1080 = 1024.D0/3.D0*t1079
      t1097 = -t720*t1
      t1113 = -t230*t104*t548
      t1120 = t180*l3*t10
      t1137 = t710*t33
      t1140 = t393*t33
      t1146 = (7-t179)*t1
      t1150 = (5-t434)*t1
      t1168 = t393*t104*t548
      t1180 = t213*t3
      t1181 = t1180*l3
      t1185 = (5-t179)*t3*l3
      t1191 = -t647*t6
      t1193 = 256.D0/3.D0*t1191*s3l2p
      t1202 = 256.D0/3.D0*t1191*s3l1p
      t1205 = 3-t179
      t1207 = t1205*t3*l3
      t1208 = t148*t45
      t1210 = t302*t12
      t1215 = -4+t212
      t1216 = t1215*t1
      t1239 = (-8+t434)*t3*l3
      t1242 = t1215*t3*t10
      t1247 = t1205*t1
      t1263 = -t213*t3*l3
      t1270 = (-1-t179)*t10
      t1281 = (1-t218)*t3
      t1284 = (-3+z)*t3
      t1303 = t1180*t10
      s3 = (((-256.D0/3.D0*t5*t7+t14)*t16+((512.D0/3.D0*t19*t7-t14-1024.
     #D0/3.D0*t23)*s23r+1024.D0/3.D0*t28*t30-1024.D0/3.D0*t34*t35)*s1vr)
     #*s1l1+((256.D0/3.D0*t5*t42-t47)*t16+((-512.D0/3.D0*t19*t42+t47+102
     #4.D0/3.D0*t53)*s23r-1024.D0/3.D0*t28*t57+1024.D0/3.D0*t34*t60)*s1v
     #r)*s1l2+((-t14-1792.D0/3.D0*t23)*s2l1+(t47+1792.D0/3.D0*t53)*s2l2+
     #256*t73*t74-256*t73*t77)*t16+(((1024.D0/3.D0*t13+1024.D0/3.D0*t23)
     #*s2l1+(-1024.D0/3.D0*t46-1024.D0/3.D0*t53)*s2l2)*s23r+(256.D0/3.D0
     #*t34*t12+256*t34*t22)*s34r*s2l1+(-256.D0/3.D0*t34*t45-256*t34*t52)
     #*s34r*s2l2+(-256*t105*t74+256*t105*t77)*s34r)*s1vr)*t114
      s7 = ((256.D0/3.D0*t119+256.D0/3.D0*t123)*t126+((2816.D0/3.D0*t119
     #-768*t131)*s23r+t142*s2l2+(-2560.D0/3.D0*t145-1024.D0/3.D0*t150)*s
     #34r-256.D0/3.D0*t154*t12+256.D0/3.D0*t158)*t16+((-4096.D0/3.D0*t11
     #9+1024*t131+1024*t123)*t166+(t173*s2l2+(1536*t145+2048.D0/3.D0*t15
     #0)*s34r+256.D0/3.D0*t181*t182+t188)*s23r+t199*s2l2+(1024*t203+1280
     #.D0/3.D0*t208)*t193+(256.D0/3.D0*t214*t216+256.D0/3.D0*t220*t222)*
     #s34r)*s1vr+(t234*s2l2+(-2048.D0/3.D0*t145-2048.D0/3.D0*t150)*s34r+
     #2048.D0/3.D0*t157*t12+2048.D0/3.D0*t158)*t166+(t245*s2l2+t248*t193
     #+(512.D0/3.D0*t73*t12+512.D0/3.D0*t73*t22)*s34r)*s23r+t265*s2l2+(-
     #512.D0/3.D0*t268*t144-512.D0/3.D0*t268*t271)*t259+(512.D0/3.D0*t10
     #5*t12+512.D0/3.D0*t105*t22)*t193)*s1l1
      s8 = ((-256.D0/3.D0*t284-256.D0/3.D0*t287)*t126+((-2816.D0/3.D0*t2
     #84+768*t293)*s23r-t142*s2l1+(2560.D0/3.D0*t300+1024.D0/3.D0*t304)*
     #s34r+256.D0/3.D0*t154*t45-256.D0/3.D0*t310)*t16+((4096.D0/3.D0*t28
     #4-1024*t293-1024*t287)*t166+(-t173*s2l1+(-1536*t300-2048.D0/3.D0*t
     #304)*s34r-256.D0/3.D0*t181*t325-t331)*s23r-t199*s2l1+(-1024*t337-1
     #280.D0/3.D0*t341)*t193+(-256.D0/3.D0*t214*t345-256.D0/3.D0*t220*t3
     #48)*s34r)*s1vr+(-t234*s2l1+(2048.D0/3.D0*t300+2048.D0/3.D0*t304)*s
     #34r-2048.D0/3.D0*t157*t45-2048.D0/3.D0*t310)*t166+(-t245*s2l1+t368
     #*t193+(-512.D0/3.D0*t73*t45-512.D0/3.D0*t73*t52)*s34r)*s23r-t265*s
     #2l1+(512.D0/3.D0*t268*t299+512.D0/3.D0*t268*t381)*t259+(-512.D0/3.
     #D0*t105*t45-512.D0/3.D0*t105*t52)*t193)*s1l2
      s6 = s7+s8
      s7 = s6+((256.D0/3.D0*t394*t396+256.D0/3.D0*t123)*s2l1+(-256.D0/3.
     #D0*t394*t401-256.D0/3.D0*t287)*s2l2)*t126
      s8 = s7
      s10 = (((-256.D0/3.D0*t409*t144-256.D0/3.D0*t413*t271)*s2l1+(256.D
     #0/3.D0*t409*t299+256.D0/3.D0*t413*t381)*s2l2-512*t423*t74+512*t423
     #*t77)*s23r+((t430+t431)*s34r-256.D0/3.D0*t436*t130+t188)*s2l1+((-t
     #441-t442)*s34r+256.D0/3.D0*t436*t292-t331)*s2l2+1280.D0/3.D0*t452*
     #s34r+256.D0/3.D0*t457*t74-256.D0/3.D0*t457*t77)*t16
      s11 = (((-1024.D0/3.D0*t131-1024.D0/3.D0*t123)*s2l1+(1024.D0/3.D0*
     #t293+1024.D0/3.D0*t287)*s2l2)*t166+(((-512*t145-t431)*s34r-256.D0/
     #3.D0*t476*t130-256.D0/3.D0*t480*t122)*s2l1+((512*t300+t442)*s34r+2
     #56.D0/3.D0*t476*t292+256.D0/3.D0*t480*t286)*s2l2+512*t494*s34r-512
     #*t497*t74+512*t497*t77)*s23r+((256.D0/3.D0*t203-1024.D0/3.D0*t208)
     #*t193+(-256.D0/3.D0*t509*t216-256.D0/3.D0*t512*t222)*s34r)*s2l1+((
     #-256.D0/3.D0*t337+1024.D0/3.D0*t341)*t193+(256.D0/3.D0*t509*t345+2
     #56.D0/3.D0*t512*t348)*s34r)*s2l2+(1280.D0/3.D0*t531*t74-1280.D0/3.
     #D0*t531*t77)*t193+(-256.D0/3.D0*t538*t74+256.D0/3.D0*t538*t77)*s34
     #r)*s1vr
      s9 = s10+s11
      s5 = s8+s9
      s6 = s13r
      s4 = s5*s6
      s2 = s3+s4
      s1 = s2+t878*s1l1+t1068*s1l2
      s2 = s1+(256.D0/3.D0*t549*t12*s2l1-256.D0/3.D0*t549*t45*s2l2+t1078
     #-t1080)*t550
      s3 = s2+(((-1024.D0/3.D0*t558-t561)*s2l1+(1024.D0/3.D0*t885+t888)*
     #s2l2-t1078+t1080)*s23r+((-512.D0/3.D0*t497*t599-256.D0/3.D0*t786)*
     #s34r-256.D0/3.D0*t1097*t144)*s2l1+((512.D0/3.D0*t497*t907+256.D0/3
     #.D0*t1004)*s34r+256.D0/3.D0*t1097*t299)*s2l2+(256.D0/3.D0*t1113*t7
     #4-256.D0/3.D0*t1113*t77)*s34r-256.D0/3.D0*t1120*t74+256.D0/3.D0*t1
     #120*t77)*t126
      s4 = s3
      s6 = (((256*t558-t583)*s2l1+(-256*t885+t902)*s2l2+256*t1077-256*t1
     #079)*t166+(((512.D0/3.D0*t1137*t599+256.D0/3.D0*t1140*t602)*s34r+2
     #56.D0/3.D0*t1146*t144+256.D0/3.D0*t1150*t271)*s2l1+((-512.D0/3.D0*
     #t1137*t907-256.D0/3.D0*t1140*t910)*s34r-256.D0/3.D0*t1146*t299-256
     #.D0/3.D0*t1150*t381)*s2l2+(256.D0/3.D0*t1168*t74-256.D0/3.D0*t1168
     #*t77)*s34r+1280.D0/3.D0*t120*t74-1280.D0/3.D0*t120*t77)*s23r+((256
     #.D0/3.D0*t1181*t396+256.D0/3.D0*t1185*t843)*s34r-t1193)*s2l1+((-25
     #6.D0/3.D0*t1181*t401-256.D0/3.D0*t1185*t1042)*s34r+t1202)*s2l2+(25
     #6.D0/3.D0*t1207*t1208-256.D0/3.D0*t1207*t1210)*s34r-256.D0/3.D0*t1
     #216*t74+256.D0/3.D0*t1216*t77)*t16
      s7 = (((256*t790-256.D0/3.D0*t792)*s2l1+(-256*t1008+256.D0/3.D0*t1
     #010)*s2l2+256*t191*t74-256*t191*t77)*t166+(((256.D0/3.D0*t1239*t39
     #6+256.D0/3.D0*t1242*t271)*s34r+t1193+256.D0/3.D0*t1247*t22)*s2l1+(
     #(-256.D0/3.D0*t1239*t401-256.D0/3.D0*t1242*t381)*s34r-t1202-256.D0
     #/3.D0*t1247*t52)*s2l2+(256.D0/3.D0*t1263*t1208-256.D0/3.D0*t1263*t
     #1210)*s34r-256.D0/3.D0*t1270*t74+256.D0/3.D0*t1270*t77)*s23r+((-t4
     #30-1280.D0/3.D0*t150)*t193+(256.D0/3.D0*t1281*t182+256.D0/3.D0*t12
     #84*t186)*s34r)*s2l1+((t441+1280.D0/3.D0*t304)*t193+(-256.D0/3.D0*t
     #1281*t325-256.D0/3.D0*t1284*t329)*s34r)*s2l2+1024.D0/3.D0*t494*t19
     #3+(256.D0/3.D0*t1303*t74-256.D0/3.D0*t1303*t77)*s34r)*s1vr
      s5 = s6+s7
      taux2 = s4+s5

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = -taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet2 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet4 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      ACnum1e1 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcoff4
      RETURN
      END

      double precision function ACnum1e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = t1**2
      t3 = z*t2
      t4 = l3-1
      t5 = t4**2
      t6 = t5*t4
      t7 = 1/s3vr
      t8 = t6*t7
      t9 = s1vr**2
      t12 = t2*t1
      t13 = z*t12
      t14 = t5**2
      t16 = t7*s34r
      t21 = s13r**2
      t24 = l3*z
      t25 = t24*t2
      t26 = t5*t7
      t27 = t9*s1vr
      t34 = t2*t5
      t35 = t7*s3l2p
      t37 = s4l2p*t7
      t42 = t7*s3l1p
      t44 = s4l1p*t7
      t50 = t8*s34r
      t51 = t24*t12*t50
      t58 = 3*z
      t59 = -1+t58
      t60 = t59*z
      t61 = t5*t1
      t67 = t2**2
      t69 = t14*t7
      t70 = s34r**2
      t74 = z**2
      t75 = t74*t2
      t82 = t12*t5
      t83 = l3*t7
      t84 = t83*s3l2p
      t85 = t82*t84
      t87 = t5*l3
      t88 = t12*s4l2p
      t89 = t88*t7
      t90 = t87*t89
      t94 = t2*t4
      t95 = t94*t35
      t96 = 64.D0/3.D0*t95
      t102 = t94*t37
      t106 = l3*t12
      t107 = t8*t70
      t109 = t34*t16
      t110 = t106*t107-t109
      t111 = 64.D0/3.D0*t110
      t113 = l3*t67
      t115 = t113*t8*s3l2p
      t117 = t6*l3
      t119 = t67*s4l2p*t7
      t120 = t117*t119
      t125 = 3*t2*t1
      t126 = t26*s3l2p
      t128 = 2*t1
      t129 = t128*t2
      t131 = t5*s4l2p*t7
      t139 = -128.D0/3.D0*t110
      t140 = t139*s2l2
      t142 = 128.D0/3.D0*t115+128.D0/3.D0*t120
      t144 = t82*t35
      t151 = t67*t14
      t152 = t70*s34r
      t153 = t83*t152
      t155 = t12*t6
      t156 = t7*t70
      t159 = -128.D0/3.D0*t151*t153+128.D0/3.D0*t155*t156
      t161 = t67*t1
      t162 = t161*t14
      t164 = l3*s4l2p
      t165 = t164*t7
      t170 = t67*t6
      t178 = t83*s3l1p
      t179 = t82*t178
      t181 = t12*s4l1p
      t182 = t181*t7
      t183 = t87*t182
      t187 = t94*t42
      t188 = 64.D0/3.D0*t187
      t194 = t94*t44
      t200 = t113*t8*s3l1p
      t202 = t67*s4l1p
      t203 = t202*t7
      t204 = t117*t203
      t220 = 128.D0/3.D0*t200+128.D0/3.D0*t204
      t232 = l3*s4l1p*t7
      t244 = l3**2
      t245 = z*t244
      t247 = t2*t7
      t248 = t9**2
      t252 = t245*t2
      t253 = t4*t7
      t258 = t12*t7
      t259 = t258*s34r
      t260 = t245*t5*t259
      t262 = t106*t4
      t263 = t37*s3l1p
      t266 = t44*s3l2p
      t267 = t262*t266
      t269 = t4*s4l2p
      t270 = t269*s4l1p
      t271 = t106*t270
      t275 = l3*t1
      t283 = s23r**2
      t287 = l3*t2
      t290 = t269*t7
      t291 = t287*t290
      t298 = t4*s4l1p*t7
      t299 = t287*t298
      t307 = t275*t7
      t312 = 2*z
      t313 = -1+t312
      t314 = t313*t4
      t315 = t1*t7
      t316 = t315*s3l2p
      t324 = t315*s3l1p
      t333 = t245*t67*t107
      t335 = t113*t5
      t340 = t67*t5
      t341 = t164*s4l1p
      t342 = t340*t341
      t346 = t287*t5
      t354 = z*t4
      t356 = t2*s4l2p*t7
      t357 = t354*t356
      t364 = t12*t4
      t365 = s4l2p*s4l1p
      t369 = (t74-t58+1)*z
      t382 = t95+t102
      t389 = -1-z
      t401 = 3*t74
      t414 = t37*s34r
      t423 = t44*s34r
      t433 = l3*t161*t6
      t440 = -z-2
      t451 = -t389*t12
      t459 = z*t5
      t475 = t26*s34r
      t477 = t74*t4
      t482 = t155*t74
      t492 = t74*t7
      t498 = t244*t7
      t500 = t364*t498*s3l2p
      t502 = t12*t244
      t503 = t502*t290
      t507 = t287*t35
      t508 = 64.D0/3.D0*t507
      t509 = (128.D0/3.D0*t500+64.D0/3.D0*t503)*s34r-t508
      t515 = t128*t1
      t518 = t287*t37
      t519 = 64.D0/3.D0*t518
      t522 = t5*t244
      t523 = t67*t7
      t524 = t523*s3l2p
      t525 = t522*t524
      t527 = t522*t119
      t532 = (-4+t312)*t4
      t533 = t532*l3
      t534 = t247*s3l2p
      t539 = z*t1
      t540 = t539*t35
      t541 = 64.D0/3.D0*t540
      t545 = 128.D0/3.D0*t500+128.D0/3.D0*t503
      t549 = t498*t70
      t550 = t82*t549
      t552 = t128*t4
      t553 = t552*t1
      t554 = t83*s34r
      t557 = -128.D0/3.D0*t550+64.D0/3.D0*t553*t554
      t563 = 4*z
      t566 = (-6+t563)*t4*l3
      t568 = t532*t2
      t573 = t539*t37
      t574 = 64.D0/3.D0*t573
      t577 = t6*t244
      t579 = t577*t523*t152
      t581 = -2+z
      t583 = t581*t5*l3
      t584 = t247*t70
      t585 = t583*t584
      t587 = -z+t74
      t588 = t587*t4
      t591 = -128.D0/3.D0*t579+64.D0/3.D0*t585+64.D0/3.D0*t588*t16
      t593 = t161*t7
      t595 = t577*t593*s3l2p
      t599 = t577*t161*s4l2p*t7
      t605 = (-5+z)*t12*t5
      t612 = 3*t587*t4
      t624 = 128.D0/3.D0*t550-128.D0/3.D0*t94*t554
      t629 = t364*t84
      t631 = t629+t364*t165
      t643 = 256.D0/3.D0*t579-128.D0/3.D0*t585-128.D0/3.D0*t4*t1*z*t7*s3
     #4r
      t649 = t581*t12*t5
      t655 = t354*t534
      t661 = t14*t244
      t662 = t70**2
      t669 = 128.D0/3.D0*t661*t593*t662+128.D0/3.D0*t155*t153-128.D0/3.D
     #0*t3*t26*t70
      t671 = t67*t2
      t672 = t671*t7
      t691 = t364*t498*s3l1p
      t693 = t502*t298
      t697 = t287*t42
      t698 = 64.D0/3.D0*t697
      t699 = (128.D0/3.D0*t691+64.D0/3.D0*t693)*s34r-t698
      t707 = t287*t44
      t708 = 64.D0/3.D0*t707
      t712 = t522*t523*s3l1p
      t714 = t522*t203
      t718 = t247*s3l1p
      t724 = 64.D0/3.D0*t539*t42
      t728 = 128.D0/3.D0*t691+128.D0/3.D0*t693
      t743 = 64.D0/3.D0*t539*t44
      t748 = t577*t593*s3l1p
      t752 = t577*t161*s4l1p*t7
      t774 = t364*t178
      t810 = t258*s3l1p
      t818 = t244*l3
      t819 = t818*t7
      t824 = t354*t818*t259
      t825 = 128.D0/3.D0*t824
      t831 = 448.D0/3.D0*t824
      t839 = t1*t244
      t850 = t459*t818*t523*t70
      t851 = 256.D0/3.D0*t850
      t853 = t244*t67*t4
      t856 = -t4
      t859 = t244*t2
      t866 = t581*t2
      t876 = t283*s23r
      t892 = t839*t7
      t918 = t859*t16
      t923 = -t440*t2
      t946 = t552*t2
      t969 = 256.D0/3.D0*t6*z*t161*t819*t152
      t971 = t161*t244*t5
      t990 = 4*t74
      t1001 = (1-z+t74)*t1
      t1014 = -t507-t518
      t1088 = t313*t5*l3
      t1095 = t588*t1
      t1141 = (z+t74)*t4
      t1151 = t74*z
      t1175 = -t581
      s3 = (64.D0/3.D0*t3*t8*t9-64.D0/3.D0*t13*t14*t16*s1vr)*t21*s13r
      s5 = (64*t25*t26*t27+(-64*t25*t26*s23r+(-64.D0/3.D0*t34*t35-64.D0/
     #3.D0*t34*t37)*s2l1+(-64.D0/3.D0*t34*t42-64.D0/3.D0*t34*t44)*s2l2-1
     #28*t51-64.D0/3.D0*t3*t26)*t9+((256.D0/3.D0*t51-64.D0/3.D0*t60*t61*
     #t7)*s23r+64*t24*t67*t69*t70+64.D0/3.D0*t75*t50)*s1vr)*t21
      s10 = (((128.D0/3.D0*t85+64.D0/3.D0*t90)*s34r-t96)*t9+(((-128.D0/3
     #.D0*t85-128.D0/3.D0*t90)*s34r+t96+64.D0/3.D0*t102)*s23r+t111*s2l2+
     #(-256.D0/3.D0*t115-64*t120)*t70+(64.D0/3.D0*t125*t126+64.D0/3.D0*t
     #129*t131)*s34r)*s1vr+(t140+t142*t70+(-128.D0/3.D0*t144-128.D0/3.D0
     #*t82*t37)*s34r)*s23r+t159*s2l2+(128.D0/3.D0*t162*t84+128.D0/3.D0*t
     #162*t165)*t152+(-128.D0/3.D0*t170*t35-128.D0/3.D0*t170*t37)*t70)*s
     #1l1
      s11 = (((128.D0/3.D0*t179+64.D0/3.D0*t183)*s34r-t188)*t9+(((-128.D
     #0/3.D0*t179-128.D0/3.D0*t183)*s34r+t188+64.D0/3.D0*t194)*s23r+t111
     #*s2l1+(-256.D0/3.D0*t200-64*t204)*t70+(64.D0/3.D0*t125*t26*s3l1p+6
     #4.D0/3.D0*t129*t5*s4l1p*t7)*s34r)*s1vr+(t139*s2l1+t220*t70+(-128.D
     #0/3.D0*t82*t42-128.D0/3.D0*t82*t44)*s34r)*s23r+t159*s2l1+(128.D0/3
     #.D0*t162*t178+128.D0/3.D0*t162*t232)*t152+(-128.D0/3.D0*t170*t42-1
     #28.D0/3.D0*t170*t44)*t70)*s1l2
      s9 = s10+s11
      s8 = s9+64.D0/3.D0*t245*t4*t247*t248+(-128*t252*t253*s23r-128*t260
     #-64.D0/3.D0*t262*t263-64.D0/3.D0*t267+(-128.D0/3.D0*t271-64.D0/3.D
     #0*(-2+t58)*z*t275*t4)*t7)*t27+(64*t252*t253*t283+((128.D0/3.D0*t28
     #7*t253*s3l2p+128.D0/3.D0*t291)*s2l1+(128.D0/3.D0*t287*t253*s3l1p+1
     #28.D0/3.D0*t299)*s2l2+832.D0/3.D0*t260-64.D0/3.D0*t59*z*t4*t307)*s
     #23r+(64.D0/3.D0*t314*t316+64.D0/3.D0*t314*t1*s4l2p*t7)*s2l1+(64.D0
     #/3.D0*t314*t324+64.D0/3.D0*t314*t1*s4l1p*t7)*s2l2+128*t333+(128.D0
     #/3.D0*t335*t263+128.D0/3.D0*t335*t266+(256.D0/3.D0*t342+64.D0/3.D0
     #*(-4+t58)*z*t346)*t7)*s34r+(-128.D0/3.D0*t95-64.D0/3.D0*t357)*s3l1
     #p-64.D0/3.D0*t354*t2*t266+(-128.D0/3.D0*t364*t365+64.D0/3.D0*t369*
     #t4)*t7)*t9
      s9 = s8+((-320.D0/3.D0*t260+128.D0/3.D0*t60*t4*t307)*t283+(64.D0/3
     #.D0*t382*s2l1+(64.D0/3.D0*t187+64.D0/3.D0*t194)*s2l2-320.D0/3.D0*t
     #333-256.D0/3.D0*t389*z*l3*t109+128.D0/3.D0*t382*s3l1p+128.D0/3.D0*
     #t94*t266+(128.D0/3.D0*t94*t365+64.D0/3.D0*(t401+1-t312)*z*t4)*t7)*
     #s23r+(t140+(64.D0/3.D0*t115+128.D0/3.D0*t120)*t70-64.D0/3.D0*t82*t
     #414)*s2l1+((64.D0/3.D0*t200+128.D0/3.D0*t204)*t70-64.D0/3.D0*t82*t
     #423)*s2l2-64.D0/3.D0*t245*t161*t69*t152+(-64.D0/3.D0*t433*t263-64.
     #D0/3.D0*t433*t266+(-128.D0/3.D0*t6*t161*t341-128.D0/3.D0*t155*t440
     #*z*l3)*t7)*t70+((128.D0/3.D0*t144+64.D0/3.D0*t451*t131)*s3l1p+64.D
     #0/3.D0*t451*t5*t266+(128.D0/3.D0*t459*t88*s4l1p+64.D0/3.D0*(t312-t
     #401)*z*t61)*t7)*s34r)*s1vr+(-128.D0/3.D0*t74*l3*t2*t475+128.D0/3.D
     #0*t477*t315)*t283
      s7 = s9+(-128.D0/3.D0*t482*t83*t70+128.D0/3.D0*t75*t475)*s23r-128.
     #D0/3.D0*t151*t74*t153+128.D0/3.D0*t155*t492*t70
      s8 = s13r
      s6 = s7*s8
      s4 = s5+s6
      s2 = s3+s4
      s4 = s2
      s7 = t509*t27+(((-256.D0/3.D0*t500-64*t503)*s34r+64.D0/3.D0*t515*t
     #84+t519)*s23r+(-128*t525-64*t527)*t70+(64.D0/3.D0*t533*t534-64.D0/
     #3.D0*t291)*s34r+t541)*t9+((t545*s34r-t508-t519)*t283+(t557*s2l2+(5
     #12.D0/3.D0*t525+128*t527)*t70+(-64.D0/3.D0*t566*t534-64.D0/3.D0*t5
     #68*t165)*s34r-t541-t574)*s23r+t591*s2l2+(128*t595+256.D0/3.D0*t599
     #)*t152+(-64.D0/3.D0*t605*t84+64*t90)*t70+(-64.D0/3.D0*t612*t316-64
     #.D0/3.D0*t553*z*s4l2p*t7)*s34r)*s1vr+(t624*s2l2+(-128.D0/3.D0*t525
     #-128.D0/3.D0*t527)*t70+128.D0/3.D0*t631*s34r)*t283
      s6 = s7+(t643*s2l2+(-256.D0/3.D0*t595-256.D0/3.D0*t599)*t152+(128.
     #D0/3.D0*t649*t84+128.D0/3.D0*t649*t165)*t70+(128.D0/3.D0*t655+128.
     #D0/3.D0*t357)*s34r)*s23r+t669*s2l2+(-128.D0/3.D0*t661*t672*s3l2p-1
     #28.D0/3.D0*t661*t671*s4l2p*t7)*t662-t142*t152+(128.D0/3.D0*t13*t12
     #6+128.D0/3.D0*t459*t89)*t70
      s7 = s1l1
      s5 = s6*s7
      s3 = s4+s5
      s5 = s3
      s8 = t699*t27+(((-256.D0/3.D0*t691-64*t693)*s34r+64.D0/3.D0*t515*t
     #178+t708)*s23r+(-128*t712-64*t714)*t70+(64.D0/3.D0*t533*t718-64.D0
     #/3.D0*t299)*s34r+t724)*t9+((t728*s34r-t698-t708)*t283+(t557*s2l1+(
     #512.D0/3.D0*t712+128*t714)*t70+(-64.D0/3.D0*t566*t718-64.D0/3.D0*t
     #568*t232)*s34r-t724-t743)*s23r+t591*s2l1+(128*t748+256.D0/3.D0*t75
     #2)*t152+(-64.D0/3.D0*t605*t178+64*t183)*t70+(-64.D0/3.D0*t612*t324
     #-64.D0/3.D0*t553*z*s4l1p*t7)*s34r)*s1vr+(t624*s2l1+(-128.D0/3.D0*t
     #712-128.D0/3.D0*t714)*t70+(128.D0/3.D0*t774+128.D0/3.D0*t364*t232)
     #*s34r)*t283
      s7 = s8+(t643*s2l1+(-256.D0/3.D0*t748-256.D0/3.D0*t752)*t152+(128.
     #D0/3.D0*t649*t178+128.D0/3.D0*t649*t232)*t70+(128.D0/3.D0*t354*t71
     #8+128.D0/3.D0*t354*t2*s4l1p*t7)*s34r)*s23r+t669*s2l1+(-128.D0/3.D0
     #*t661*t672*s3l1p-128.D0/3.D0*t661*t671*s4l1p*t7)*t662-t220*t152+(1
     #28.D0/3.D0*t459*t810+128.D0/3.D0*t459*t182)*t70
      s8 = s1l2
      s6 = s7*s8
      s4 = s5+s6
      s1 = s4+(-64.D0/3.D0*t3*t819*s23r-t825)*t248+(64*t3*t819*t283+(t83
     #1+64.D0/3.D0*t502*t263+64.D0/3.D0*t502*t266+(128.D0/3.D0*t502*t365
     #+64.D0/3.D0*t313*z*t839)*t7)*s23r+t509*s2l1+t699*s2l2+t851+(-64.D0
     #/3.D0*t853*t263-64.D0/3.D0*t853*t266+64*t856*z*t859*t7)*s34r+(-128
     #.D0/3.D0*t507+64.D0/3.D0*t866*t165)*s3l1p+64.D0/3.D0*t866*l3*t266)
     #*t27
      s4 = s1
      s7 = -64.D0/3.D0*t3*t819*t876+((-64.D0/3.D0*t859*t35-64.D0/3.D0*t8
     #59*t37)*s2l1+(-64.D0/3.D0*t859*t42-64.D0/3.D0*t859*t44)*s2l2-t831-
     #64.D0/3.D0*(-t563+2)*z*t892)*t283+((-t545*s34r-64.D0/3.D0*t539*t84
     #-64.D0/3.D0*t539*t165)*s2l1+(-t728*s34r-64.D0/3.D0*t539*t178-64.D0
     #/3.D0*t539*t232)*s2l2-192*t850-64.D0/3.D0*(-3-7*z)*t4*z*t918+(256.
     #D0/3.D0*t507+64.D0/3.D0*t923*t165)*s3l1p+64.D0/3.D0*t923*l3*t266+(
     #128.D0/3.D0*t3*t341-64.D0/3.D0*(-2*t74+t312-1)*z*l3)*t7)*s23r+((-1
     #28.D0/3.D0*t525-64.D0/3.D0*t527)*t70+64.D0/3.D0*t946*t83*s3l2p*s34
     #r-64.D0/3.D0*t534)*s2l1+((-128.D0/3.D0*t712-64.D0/3.D0*t714)*t70+6
     #4.D0/3.D0*t946*t83*s3l1p*s34r-64.D0/3.D0*t718)*s2l2
      s6 = s7-t969+(64.D0/3.D0*t971*t263+64.D0/3.D0*t971*t266-64.D0/3.D0
     #*(-t312-3)*z*t5*t502*t7)*t70+((256.D0/3.D0*t629-64.D0/3.D0*t533*t8
     #9)*s3l1p-64.D0/3.D0*t533*t181*t35-64.D0/3.D0*(z-t990)*t4*t1*t24*t7
     #)*s34r+(128.D0/3.D0*t540+64.D0/3.D0*t1001*t37)*s3l1p+64.D0/3.D0*t1
     #001*t266
      s7 = t9
      s5 = s6*s7
      s3 = s4+s5
      s4 = s3
      s8 = (t825-64.D0/3.D0*t60*t892)*t876+(64.D0/3.D0*t1014*s2l1+(-64.D
     #0/3.D0*t697-64.D0/3.D0*t707)*s2l2+t851+64.D0/3.D0*(-2-9*z)*t4*z*t9
     #18+128.D0/3.D0*t1014*s3l1p-128.D0/3.D0*t287*t266+(-128.D0/3.D0*t28
     #7*t365-64.D0/3.D0*(1+t74)*z*l3)*t7)*t283+(((-128.D0/3.D0*t629-64.D
     #0/3.D0*t946*t165)*s34r-t541-t574)*s2l1+((-128.D0/3.D0*t774-64.D0/3
     #.D0*t946*t232)*s34r-t724-t743)*s2l2+t969+64.D0/3.D0*(-2-11*z)*z*t5
     #*t502*t156+(-256.D0/3.D0*t631*s3l1p-256.D0/3.D0*t267+(-256.D0/3.D0
     #*t271-128.D0/3.D0*(-1+t74+t563)*t4*t539*l3)*t7)*s34r+(-128.D0/3.D0
     #*t540-128.D0/3.D0*t573)*s3l1p-128.D0/3.D0*t539*t266+(-128.D0/3.D0*
     #t539*t365-64.D0/3.D0*t369)*t7)*s23r+((-64.D0/3.D0*t1088*t258*s3l2p
     #-64.D0/3.D0*t113*t131)*t70-64.D0/3.D0*t1095*t414)*s2l1
      s7 = s8+((-64.D0/3.D0*t1088*t810-64.D0/3.D0*t340*t232)*t70-64.D0/3
     #.D0*t1095*t423)*s2l2+128.D0/3.D0*t14*z*t671*t819*t662+64.D0/3.D0*(
     #-t563+1)*z*t67*t577*t7*t152+((-128.D0/3.D0*t87*t524+64.D0/3.D0*t58
     #3*t119)*s3l1p+64.D0/3.D0*t583*t202*t35+(-128.D0/3.D0*t342+64.D0/3.
     #D0*(-t563+3-t990)*z*t346)*t7)*t70+((-128.D0/3.D0*t655-64.D0/3.D0*t
     #1141*t356)*s3l1p-64.D0/3.D0*t1141*t2*t266+(-128.D0/3.D0*t3*t270-64
     #.D0/3.D0*(t74-2*t1151+z-1)*t4*z)*t7)*s34r
      s8 = s1vr
      s6 = s7*s8
      s7 = (128.D0/3.D0*t477*t2*t498*s34r-128.D0/3.D0*t74*t1*t83)*t876
      s5 = s6+s7
      s2 = s4+s5
      taux1 = s2+(256.D0/3.D0*t74*t5*t12*t549+128.D0/3.D0*t1175*t4*t74*t
     #275*t16-128.D0/3.D0*t1151*t7)*t283+(256.D0/3.D0*t170*t244*t492*t15
     #2+128.D0/3.D0*t1175*t74*t5*t287*t156+128.D0/3.D0*t856*t1151*t315*s
     #34r)*s23r+128.D0/3.D0*t162*t244*t492*t662+128.D0/3.D0*t482*t153-12
     #8.D0/3.D0*t5*t1151*t584
      t1 = 1-z
      t3 = l3-1
      t4 = t3**2
      t5 = 7*t1*t4
      t6 = 1/s3vr
      t7 = t6*s2l2
      t10 = -t1
      t11 = t10**2
      t12 = t11*t4
      t13 = t6*s3l2p
      t14 = t12*t13
      t15 = 1280.D0/3.D0*t14
      t17 = s1vr**2
      t19 = 5*t1
      t20 = t19*t4
      t23 = s4l2p*t6
      t24 = t12*t23
      t28 = t4*t3
      t29 = t11*t28
      t30 = t6*s34r
      t31 = t30*s2l2
      t34 = t11*t10
      t35 = t34*t28
      t36 = t13*s34r
      t43 = t6*s2l1
      t46 = t6*s3l1p
      t47 = t12*t46
      t48 = 1280.D0/3.D0*t47
      t53 = s4l1p*t6
      t54 = t12*t53
      t58 = t30*s2l1
      t61 = t46*s34r
      t76 = t34*t4
      t77 = t23*s3l1p
      t80 = t53*s3l2p
      t107 = t11**2
      t108 = t107*t28
      t117 = s13r**2
      t119 = l3*t10
      t120 = t3*t6
      t122 = t119*t120*s2l2
      t124 = l3*t11
      t125 = t120*s3l2p
      t126 = t124*t125
      t129 = t3*s4l2p*t6
      t130 = t124*t129
      t133 = t17*s1vr
      t137 = -t3
      t138 = t137*l3
      t140 = t11*s4l2p*t6
      t145 = t4*t6
      t147 = t124*t145*s34r
      t149 = z*t3
      t152 = -3584.D0/3.D0*t147-1280.D0/3.D0*t149*t6
      t154 = l3*t6
      t155 = t154*s3l2p
      t156 = t76*t155
      t158 = t4*l3
      t159 = t34*s4l2p
      t160 = t159*t6
      t161 = t158*t160
      t165 = -4+z
      t166 = t165*t3
      t167 = t10*t6
      t168 = t167*s3l2p
      t171 = 3*t137
      t172 = t171*t11
      t181 = s23r**2
      t184 = 3*z
      t189 = 8960.D0/3.D0*t147-256.D0/3.D0*(-7-t184)*t3*t6
      t195 = 6*z
      t197 = (-11+t195)*t3
      t200 = 4*z
      t202 = (-1-t200)*t3
      t204 = t10*s4l2p*t6
      t209 = l3*t34
      t210 = t28*t6
      t211 = s34r**2
      t213 = t209*t210*t211
      t215 = t12*t30
      t217 = 2048*t213-1024.D0/3.D0*t215
      t219 = l3*t107
      t221 = t219*t210*s3l2p
      t223 = t28*l3
      t225 = t107*s4l2p*t6
      t226 = t223*t225
      t230 = 9*z
      t232 = (-12+t230)*t11
      t233 = t145*s3l2p
      t235 = 11*z
      t237 = (-8+t235)*t11
      t239 = t4*s4l2p*t6
      t247 = 5*t137
      t251 = -2560.D0/3.D0*t147-512.D0/3.D0*t247*t10*t6
      t253 = t156+t161
      t256 = t11*t3
      t264 = -2048.D0/3.D0*t213+2048.D0/3.D0*t215
      t267 = 2048.D0/3.D0*t221+2048.D0/3.D0*t226
      t276 = t4**2
      t278 = t211*s34r
      t279 = t154*t278
      t284 = -2048.D0/3.D0*t107*t276*t279+2048.D0/3.D0*t35*t6*t211
      t286 = t107*t10
      t287 = t286*t276
      t290 = l3*s4l2p*t6
      t303 = t119*t120*s2l1
      t305 = t11*t6
      t306 = t305*s3l1p
      t310 = l3*s4l1p*t6
      t311 = t172*t310
      t316 = t120*s3l1p
      t317 = t124*t316
      t320 = t11*s4l1p*t6
      t327 = t154*s3l1p
      t328 = t76*t327
      t330 = t34*s4l1p
      t331 = t330*t6
      t332 = t158*t331
      t336 = t167*s3l1p
      t346 = t3*s4l1p*t6
      t347 = t124*t346
      t360 = t10*s4l1p*t6
      t368 = t219*t210*s3l1p
      t371 = t107*s4l1p*t6
      t372 = t223*t371
      t376 = t145*s3l1p
      t379 = t4*s4l1p*t6
      t388 = -t328-t332
      t400 = -2048.D0/3.D0*t368-2048.D0/3.D0*t372
      t424 = 6*t137*t11
      t434 = t209*t3
      t435 = t434*t77
      t437 = t434*t80
      t443 = -t171*t11
      t457 = t76*l3
      t461 = (-6+t230)*t10
      t464 = t200-2
      t465 = t464*t10
      t478 = t219*t4
      t481 = t478*t77-t478*t80
      t484 = 1+z
      t486 = t484*t11*t3
      t504 = (6-t235)*t10
      t522 = t34*t3
      t529 = t219*t28
      t534 = (-t235+12)*t11
      t536 = 3-t200
      t537 = t536*t11
      t555 = l3*t286*t28
      t563 = (3+z)*t34*t4
      t573 = l3**2
      t574 = t10*t573
      t577 = t573*t11
      t578 = t577*t13
      t580 = t577*t23
      t581 = 256*t580
      t586 = -t247*t11*t573
      t589 = 4*t137
      t591 = t589*t34*t573
      t594 = 2*z
      t596 = (1-t594)*t10
      t602 = 6*t1*t573
      t611 = t573*t6
      t612 = t611*s34r
      t618 = -768*t137*t11*t612-256.D0/3.D0*(1-t195)*l3*t6
      t621 = 21*t34*t3
      t622 = t611*s3l2p
      t625 = 10*t34*t3
      t627 = t573*s4l2p*t6
      t634 = (-5*z-4)*t10
      t638 = (t200-5)*t10
      t644 = t76*t611*t211
      t646 = 10*z
      t650 = t154*s34r
      t653 = 512.D0/3.D0*t644-256.D0/3.D0*(-t646+8)*t3*t10*t650
      t655 = t4*t573
      t656 = t107*t6
      t658 = t655*t656*s3l2p
      t660 = t655*t225
      t667 = (10-14*z)*t3*t11
      t670 = z*t11
      t671 = t670*t3
      t677 = (z+2)*t10
      t682 = t19*t573
      t688 = t181*s23r
      t697 = 7424.D0/3.D0*t137*t11*t612+256.D0/3.D0*(-6-t200)*l3*t6
      t700 = 15*t34*t3
      t704 = 20*t34*t3
      t710 = (-9-z)*t10
      t713 = z*t10
      t719 = 7*z
      t725 = z*t6
      t727 = -8704.D0/3.D0*t644+256.D0/3.D0*(-6-t719)*t3*t10*t650+1280.D
     #0/3.D0*t725
      t735 = (-19-z)*t3*t11
      t738 = t247*t11
      t744 = (t195+5)*t10
      t748 = (-t594+5)*t10
      t753 = t28*t573
      t755 = t753*t656*t278
      t757 = 12*z
      t761 = t154*t211
      t764 = z**2
      t770 = -1280*t755+256.D0/3.D0*(5-t757)*t11*t4*t761+256.D0/3.D0*(-t
     #719+7*t764+5)*t3*t30
      t772 = t286*t6
      t774 = t753*t772*s3l2p
      t778 = t753*t286*s4l2p*t6
      t782 = z*t34
      t783 = t782*t4
      t786 = 8*z
      t789 = (5+t786)*t34*t4
      t796 = (-t757+9*t764+5)*t3
      t800 = (-5+t786)*t3*t10
      t813 = -512.D0/3.D0*t738*t612+512.D0/3.D0*t19*l3*t6
      t815 = t247*t34
      t816 = t815*t622
      t829 = (-9+t200)*t3
      t834 = 1536*t644-512.D0/3.D0*t829*t10*t650-2560.D0/3.D0*t725
      t839 = t829*t11
      t845 = t713*t13
      t852 = -8+t200
      t857 = -t589
      t862 = 4096.D0/3.D0*t755-512.D0/3.D0*t852*t11*t4*t761-512.D0/3.D0*
     #t857*t10*t725*s34r
      t868 = t852*t34*t4
      t874 = t305*s3l2p
      t882 = t276*t573
      t883 = t211**2
      t890 = 2048.D0/3.D0*t882*t772*t883+2048.D0/3.D0*t35*t279-2048.D0/3
     #.D0*t670*t145*t211
      t892 = t107*t11
      t893 = t892*t6
      t905 = z*t4
      t914 = t577*t46
      t916 = t577*t53
      t917 = 256*t916
      t936 = t611*s3l1p
      t939 = t573*s4l1p*t6
      t953 = t655*t656*s3l1p
      t955 = t655*t371
      t1010 = t753*t772*s3l1p
      t1014 = t753*t286*s4l1p*t6
      t1035 = t815*t936
      t1056 = t713*t46
      t1072 = t857*z
      t1101 = t34*t573
      t1102 = t1101*t77
      t1103 = t1101*t80
      t1106 = t17**2
      t1133 = t857*t107*t573
      t1141 = -t536*l3*t11
      t1148 = t13*s2l1
      t1151 = t46*s2l2
      t1159 = 2*t137
      t1160 = t1159*t34
      t1166 = (-7+t184)*t10
      t1170 = -t19*t10
      t1187 = t1159*t107*t573
      t1195 = -t165*l3*t11
      t1203 = t536*t3*l3
      t1207 = 4*t10*t3*l3
      t1223 = t149*l3
      t1224 = t159*t46
      t1226 = t330*t13
      t1231 = 2*t10
      t1252 = (13-t646)*t3*l3
      t1256 = (3-t594)*t3*l3
      t1263 = -2*t484*t10
      t1266 = t1231*t10
      t1284 = (7-t594)*t3*l3
      t1291 = (3+t594)*t11
      t1302 = (-4*t764+t235-3)*t3
      t1305 = (2-z)*t3
      t1322 = t464*t3*t11
      s3 = (((-256.D0/3.D0*t5*t7-t15)*t17+((512.D0/3.D0*t20*t7+t15+1280.
     #D0/3.D0*t24)*s23r-1280.D0/3.D0*t29*t31+1280.D0/3.D0*t35*t36)*s1vr)
     #*s1l1+((256.D0/3.D0*t5*t43+t48)*t17+((-512.D0/3.D0*t20*t43-t48-128
     #0.D0/3.D0*t54)*s23r+1280.D0/3.D0*t29*t58-1280.D0/3.D0*t35*t61)*s1v
     #r)*s1l2+((256*t14+1024.D0/3.D0*t24)*s2l1+(-256*t47-1024.D0/3.D0*t5
     #4)*s2l2-512.D0/3.D0*t76*t77+512.D0/3.D0*t76*t80)*t17+(((-1280.D0/3
     #.D0*t14-1280.D0/3.D0*t24)*s2l1+(1280.D0/3.D0*t47+1280.D0/3.D0*t54)
     #*s2l2)*s23r+(-256*t35*t13-512.D0/3.D0*t35*t23)*s34r*s2l1+(256*t35*
     #t46+512.D0/3.D0*t35*t53)*s34r*s2l2+(512.D0/3.D0*t108*t77-512.D0/3.
     #D0*t108*t80)*s34r)*s1vr)*t117
      s7 = ((-256.D0/3.D0*t122-1280.D0/3.D0*t126-256*t130)*t133+((-3328.
     #D0/3.D0*t122+4352.D0/3.D0*t126-256*t138*t140)*s23r+t152*s2l2+(6656
     #.D0/3.D0*t156+3584.D0/3.D0*t161)*s34r-256.D0/3.D0*t166*t168+256.D0
     #/3.D0*t172*t23)*t17+((5120.D0/3.D0*t122-1280*t126-1280*t130)*t181+
     #(t189*s2l2+(-8192.D0/3.D0*t156-4096.D0/3.D0*t161)*s34r+256.D0/3.D0
     #*t197*t168+256.D0/3.D0*t202*t204)*s23r+t217*s2l2+(-7424.D0/3.D0*t2
     #21-4864.D0/3.D0*t226)*t211+(256.D0/3.D0*t232*t233+256.D0/3.D0*t237
     #*t239)*s34r)*s1vr+(t251*s2l2+2560.D0/3.D0*t253*s34r-2560.D0/3.D0*t
     #256*t13-2560.D0/3.D0*t256*t23)*t181+(t264*s2l2+t267*t211+(-2048.D0
     #/3.D0*t76*t13-2048.D0/3.D0*t76*t23)*s34r)*s23r+t284*s2l2+(2048.D0/
     #3.D0*t287*t155+2048.D0/3.D0*t287*t290)*t278+(-2048.D0/3.D0*t108*t1
     #3-2048.D0/3.D0*t108*t23)*t211)*s1l1
      s8 = ((256.D0/3.D0*t303-1280.D0/3.D0*t138*t306-256.D0/3.D0*t311)*t
     #133+((3328.D0/3.D0*t303-4352.D0/3.D0*t317+256*t138*t320)*s23r-t152
     #*s2l1+(-6656.D0/3.D0*t328-3584.D0/3.D0*t332)*s34r+256.D0/3.D0*t166
     #*t336-256.D0/3.D0*t172*t53)*t17+((-5120.D0/3.D0*t303+1280*t317+128
     #0*t347)*t181+(-t189*s2l1+(8192.D0/3.D0*t328+4096.D0/3.D0*t332)*s34
     #r-256.D0/3.D0*t197*t336-256.D0/3.D0*t202*t360)*s23r-t217*s2l1+(742
     #4.D0/3.D0*t368+4864.D0/3.D0*t372)*t211+(-256.D0/3.D0*t232*t376-256
     #.D0/3.D0*t237*t379)*s34r)*s1vr+(-t251*s2l1+2560.D0/3.D0*t388*s34r+
     #2560.D0/3.D0*t256*t46+2560.D0/3.D0*t256*t53)*t181+(-t264*s2l1+t400
     #*t211+(2048.D0/3.D0*t76*t46+2048.D0/3.D0*t76*t53)*s34r)*s23r-t284*
     #s2l1+(-2048.D0/3.D0*t287*t327-2048.D0/3.D0*t287*t310)*t278+(2048.D
     #0/3.D0*t108*t46+2048.D0/3.D0*t108*t53)*t211)*s1l2
      s6 = s7+s8
      s7 = s6+((256.D0/3.D0*t424*t155+256.D0/3.D0*t172*t290)*s2l1+(-256.
     #D0/3.D0*t424*t327-256.D0/3.D0*t311)*s2l2+256.D0/3.D0*t435-256.D0/3
     #.D0*t437)*t133
      s8 = s7
      s10 = (((-256.D0/3.D0*t172*t155-256.D0/3.D0*t443*t290)*s2l1+(256.D
     #0/3.D0*t172*t327+256.D0/3.D0*t443*t310)*s2l2+1024.D0/3.D0*t435-102
     #4.D0/3.D0*t437)*s23r+(768*t457*t36-256.D0/3.D0*t461*t125-256.D0/3.
     #D0*t465*t129)*s2l1+(-768*t457*t61+256.D0/3.D0*t461*t316+256.D0/3.D
     #0*t465*t346)*s2l2+512.D0/3.D0*t481*s34r+256.D0/3.D0*t486*t77-256.D
     #0/3.D0*t486*t80)*t17
      s11 = (((1280.D0/3.D0*t126+1280.D0/3.D0*t130)*s2l1+(-1280.D0/3.D0*
     #t317-1280.D0/3.D0*t347)*s2l2)*t181+((1792.D0/3.D0*t253*s34r-256.D0
     #/3.D0*t504*t125+1280.D0/3.D0*t149*t204)*s2l1+(1792.D0/3.D0*t388*s3
     #4r+256.D0/3.D0*t504*t316-1280.D0/3.D0*t149*t360)*s2l2-256*t481*s34
     #r+256*t522*t77-256*t522*t80)*s23r+(-256*t529*t13*t211+(-256.D0/3.D
     #0*t534*t233-256.D0/3.D0*t537*t239)*s34r)*s2l1+(256*t529*t46*t211+(
     #256.D0/3.D0*t534*t376+256.D0/3.D0*t537*t379)*s34r)*s2l2+(-256*t555
     #*t77+256*t555*t80)*t211+(-256.D0/3.D0*t563*t77+256.D0/3.D0*t563*t8
     #0)*s34r)*s1vr
      s9 = s10+s11
      s5 = s8+s9
      s6 = s13r
      s4 = s5*s6
      s2 = s3+s4
      s3 = s2
      s8 = ((256.D0/3.D0*t574*t7+1024.D0/3.D0*t578+t581)*s23r+256.D0/3.D
     #0*t586*t31+256.D0/3.D0*t591*t36-256.D0/3.D0*t596*t155)*t133+((-256
     #.D0/3.D0*t602*t7-2816.D0/3.D0*t578-512.D0/3.D0*t580)*t181+(t618*s2
     #l2+(-256.D0/3.D0*t621*t622-256.D0/3.D0*t625*t627)*s34r+256.D0/3.D0
     #*t634*t155+256.D0/3.D0*t638*t290)*s23r+t653*s2l2+(-1280.D0/3.D0*t6
     #58-2048.D0/3.D0*t660)*t211+(256.D0/3.D0*t667*t155-2048.D0/3.D0*t67
     #1*t290)*s34r+256.D0/3.D0*t677*t13)*t17
      s7 = s8+((512.D0/3.D0*t682*t7+2560.D0/3.D0*t578+2560.D0/3.D0*t580)
     #*t688+(t697*s2l2+(512.D0/3.D0*t700*t622+256.D0/3.D0*t704*t627)*s34
     #r-256.D0/3.D0*t710*t155+2560.D0/3.D0*t713*t290)*t181+(t727*s2l2+(9
     #472.D0/3.D0*t658+6656.D0/3.D0*t660)*t211+(-256.D0/3.D0*t735*t155-5
     #12.D0/3.D0*t738*t290)*s34r-256.D0/3.D0*t744*t13-256.D0/3.D0*t748*t
     #23)*s23r+t770*s2l2+(4352.D0/3.D0*t774+4096.D0/3.D0*t778)*t278+(102
     #4*t783*t155+256.D0/3.D0*t789*t290)*t211+(-256.D0/3.D0*t796*t168-25
     #6.D0/3.D0*t800*z*s4l2p*t6)*s34r)*s1vr+(t813*s2l2+(512.D0/3.D0*t816
     #+512.D0/3.D0*t815*t627)*s34r+2560.D0/3.D0*t124*t13+2560.D0/3.D0*t1
     #24*t23)*t688+(t834*s2l2+(-1536*t658-1536*t660)*t211+(512.D0/3.D0*t
     #839*t155+512.D0/3.D0*t839*t290)*s34r+2560.D0/3.D0*t845+2560.D0/3.D
     #0*t713*t23)*t181
      s6 = s7+(t862*s2l2+(-4096.D0/3.D0*t774-4096.D0/3.D0*t778)*t278+(51
     #2.D0/3.D0*t868*t155+512.D0/3.D0*t868*t290)*t211+(2048.D0/3.D0*t149
     #*t874+2048.D0/3.D0*t149*t140)*s34r)*s23r+t890*s2l2+(-2048.D0/3.D0*
     #t882*t893*s3l2p-2048.D0/3.D0*t882*t892*s4l2p*t6)*t883-t267*t278+(2
     #048.D0/3.D0*t782*t233+2048.D0/3.D0*t905*t160)*t211
      s7 = s1l1
      s5 = s6*s7
      s9 = ((-256.D0/3.D0*t574*t43-1024.D0/3.D0*t914-t917)*s23r-256.D0/3
     #.D0*t586*t58-256.D0/3.D0*t591*t61+256.D0/3.D0*t596*t327)*t133+((25
     #6.D0/3.D0*t602*t43+2816.D0/3.D0*t914+512.D0/3.D0*t916)*t181+(-t618
     #*s2l1+(256.D0/3.D0*t621*t936+256.D0/3.D0*t625*t939)*s34r-256.D0/3.
     #D0*t634*t327-256.D0/3.D0*t638*t310)*s23r-t653*s2l1+(1280.D0/3.D0*t
     #953+2048.D0/3.D0*t955)*t211+(-256.D0/3.D0*t667*t327+2048.D0/3.D0*t
     #671*t310)*s34r-256.D0/3.D0*t677*t46)*t17
      s8 = s9+((-512.D0/3.D0*t682*t43-2560.D0/3.D0*t914-2560.D0/3.D0*t91
     #6)*t688+(-t697*s2l1+(-512.D0/3.D0*t700*t936-256.D0/3.D0*t704*t939)
     #*s34r+256.D0/3.D0*t710*t327-2560.D0/3.D0*t713*t310)*t181+(-t727*s2
     #l1+(-9472.D0/3.D0*t953-6656.D0/3.D0*t955)*t211+(256.D0/3.D0*t735*t
     #327+512.D0/3.D0*t738*t310)*s34r+256.D0/3.D0*t744*t46+256.D0/3.D0*t
     #748*t53)*s23r-t770*s2l1+(-4352.D0/3.D0*t1010-4096.D0/3.D0*t1014)*t
     #278+(-1024*t783*t327-256.D0/3.D0*t789*t310)*t211+(256.D0/3.D0*t796
     #*t336+256.D0/3.D0*t800*z*s4l1p*t6)*s34r)*s1vr+(-t813*s2l1+(-512.D0
     #/3.D0*t1035-512.D0/3.D0*t815*t939)*s34r-2560.D0/3.D0*t124*t46-2560
     #.D0/3.D0*t124*t53)*t688+(-t834*s2l1+(1536*t953+1536*t955)*t211+(-5
     #12.D0/3.D0*t839*t327-512.D0/3.D0*t839*t310)*s34r-2560.D0/3.D0*t105
     #6-2560.D0/3.D0*t713*t53)*t181
      s7 = s8+(-t862*s2l1+(4096.D0/3.D0*t1010+4096.D0/3.D0*t1014)*t278+(
     #-512.D0/3.D0*t868*t327-512.D0/3.D0*t868*t310)*t211+(-512.D0/3.D0*t
     #1072*t306-512.D0/3.D0*t1072*t320)*s34r)*s23r-t890*s2l1+(2048.D0/3.
     #D0*t882*t893*s3l1p+2048.D0/3.D0*t882*t892*s4l1p*t6)*t883-t400*t278
     #+(-2048.D0/3.D0*t905*t34*t6*s3l1p-2048.D0/3.D0*t905*t331)*t211
      s8 = s1l2
      s6 = s7*s8
      s4 = s5+s6
      s1 = s3+s4
      s2 = s1+(-1024.D0/3.D0*t1102+1024.D0/3.D0*t1103)*t1106
      s3 = s2+(((1280.D0/3.D0*t578+t581)*s2l1+(-1280.D0/3.D0*t914-t917)*
     #s2l2+256*t1102-256*t1103)*s23r+(-256.D0/3.D0*t591*t23*s34r+512.D0/
     #3.D0*t713*t155)*s2l1+(256.D0/3.D0*t591*t53*s34r-512.D0/3.D0*t713*t
     #327)*s2l2+(256.D0/3.D0*t1133*t77-256.D0/3.D0*t1133*t80)*s34r-256.D
     #0/3.D0*t1141*t77+256.D0/3.D0*t1141*t80)*t133
      s4 = s3
      s6 = ((-1280.D0/3.D0*t577*t1148+1280.D0/3.D0*t577*t1151-512.D0/3.D
     #0*t1102+512.D0/3.D0*t1103)*t181+(((512.D0/3.D0*t816+256.D0/3.D0*t1
     #160*t627)*s34r+256.D0/3.D0*t1166*t155+256.D0/3.D0*t1170*t290)*s2l1
     #+((-512.D0/3.D0*t1035-256.D0/3.D0*t1160*t939)*s34r-256.D0/3.D0*t11
     #66*t327-256.D0/3.D0*t1170*t310)*s2l2+(256.D0/3.D0*t1187*t77-256.D0
     #/3.D0*t1187*t80)*s34r-256.D0/3.D0*t1195*t77+256.D0/3.D0*t1195*t80)
     #*s23r+((256.D0/3.D0*t1203*t874+256.D0/3.D0*t1207*t140)*s34r+512.D0
     #/3.D0*t845)*s2l1+((-256.D0/3.D0*t1203*t306-256.D0/3.D0*t1207*t320)
     #*s34r-512.D0/3.D0*t1056)*s2l2+(1024.D0/3.D0*t1223*t1224-1024.D0/3.
     #D0*t1223*t1226)*s34r-256.D0/3.D0*t1231*s4l2p*t46+256.D0/3.D0*t1231
     #*s4l1p*t13)*t17
      s7 = ((-1280.D0/3.D0*t124*t1148+1280.D0/3.D0*t124*t1151-512.D0/3.D
     #0*t209*t77+512.D0/3.D0*t209*t80)*t181+(((256.D0/3.D0*t1252*t874+25
     #6.D0/3.D0*t1256*t140)*s34r+256.D0/3.D0*t1263*t13+256.D0/3.D0*t1266
     #*t23)*s2l1+((-256.D0/3.D0*t1252*t306-256.D0/3.D0*t1256*t320)*s34r-
     #256.D0/3.D0*t1263*t46-256.D0/3.D0*t1266*t53)*s2l2+(256.D0/3.D0*t12
     #84*t1224-256.D0/3.D0*t1284*t1226)*s34r-256.D0/3.D0*t1291*t77+256.D
     #0/3.D0*t1291*t80)*s23r+(256*t253*t211+(256.D0/3.D0*t1302*t168+256.
     #D0/3.D0*t1305*t204)*s34r)*s2l1+(256*t388*t211+(-256.D0/3.D0*t1302*
     #t336-256.D0/3.D0*t1305*t360)*s34r)*s2l2+(256.D0/3.D0*t1322*t77-256
     #.D0/3.D0*t1322*t80)*s34r)*s1vr
      s5 = s6+s7
      taux2 = s4+s5

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = -taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet2 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet4 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      ACnum1e2 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcoff4
      RETURN
      END

      double precision function ACnum1e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3*z
      t2 = -1+z
      t3 = t2**2
      t4 = t3*t2
      t6 = l3-1
      t7 = t6**2
      t8 = t7*t6
      t9 = 1/s3vr
      t10 = t8*t9
      t11 = t10*s34r
      t13 = t3*z
      t14 = t7*t9
      t18 = s1vr**2
      t20 = t3**2
      t22 = t7**2
      t23 = t22*t9
      t24 = s34r**2
      t33 = s13r**2
      t35 = l3**2
      t36 = z*t35
      t40 = t36*t7*t4*t9*s34r
      t46 = t18*s1vr
      t49 = 2*t2
      t50 = t49*z
      t51 = t50*t6
      t59 = t10*t24
      t60 = t36*t20*t59
      t67 = t9*s34r
      t68 = t3*t7*t67
      t71 = z**2
      t73 = (-z+t71)*z
      t74 = t6*t9
      t83 = 2*z
      t84 = 1-t83+t71
      t85 = t84*z
      t90 = t20*t2
      t92 = t24*s34r
      t96 = t4*t8
      t98 = t9*t24
      t103 = t14*s34r
      t108 = t96*t71
      t109 = l3*t9
      t119 = t109*t92
      t129 = t35*l3
      t130 = t129*t9
      t133 = t35*t9
      t136 = -64.D0/3.D0*t6*z*t4*t130*s34r+64.D0/3.D0*t13*t133
      t142 = t7*z*t129*t20*t9*t24
      t143 = 128.D0/3.D0*t142
      t145 = t35*t3*t67
      t151 = s23r**2
      t169 = 256.D0/3.D0*t8*z*t90*t130*t92
      t170 = 4*z
      t175 = t4*t35*t98
      t211 = t24**2
      t227 = t3*l3*t98
      t231 = t71*z
      t254 = t71*t9
      s2 = ((64.D0/3.D0*t1*t4*t11-64.D0/3.D0*t13*t14)*t18+(-64.D0/3.D0*t
     #1*t20*t23*t24+64.D0/3.D0*t4*z*t11)*s1vr)*t33+((64.D0/3.D0*t40-64.D
     #0/3.D0*t13*l3*t6*t9)*t46+((-128.D0/3.D0*t40+64.D0/3.D0*t51*l3*t2*t
     #9)*s23r-256.D0/3.D0*t60+64.D0/3.D0*(3*z-4)*z*l3*t68+64.D0/3.D0*t73
     #*t74)*t18+((64*t60-128.D0/3.D0*t50*l3*t68+64.D0/3.D0*t85*t74)*s23r
     #+64*t36*t90*t23*t92-128.D0/3.D0*t96*t49*t1*t98+64.D0/3.D0*t85*t2*t
     #103)*s1vr+(128.D0/3.D0*t108*t109*t24-128.D0/3.D0*t71*t3*t103)*s23r
     #+128.D0/3.D0*t20*t22*t71*t119-128.D0/3.D0*t71*t4*t59)*s13r
      s1 = s2+(t136*s23r-t143+64.D0/3.D0*t51*t145)*t46+(-t136*t151+(320.
     #D0/3.D0*t142-64.D0/3.D0*(-6+5*z)*t6*z*t145-64.D0/3.D0*t2*z*t109)*s
     #23r+t169-64.D0/3.D0*(t170-5)*z*t7*t175-64.D0/3.D0*t13*l3*t74*s34r)
     #*t18+((-t143+64*t2*t6*z*t145-64.D0/3.D0*t85*t109)*t151+(-t169+64.D
     #0/3.D0*(-6+7*z)*z*t7*t175-128.D0/3.D0*t84*t6*t2*t1*t67-64.D0/3.D0*
     #t73*t9)*s23r-128.D0/3.D0*t22*z*t20*t3*t130*t211+64.D0/3.D0*(-3+t17
     #0)*z*t20*t8*t35*t9*t92+64.D0/3.D0*(-1+t83)*z*t7*t227-64.D0/3.D0*(z
     #-3*t71+2*t231)*t6*z*t9*s34r)*s1vr
      taux1 = s1+(-128.D0/3.D0*t7*t71*t4*t133*t24+128.D0/3.D0*t3*t6*t71*
     #t109*s34r)*t151+(-256.D0/3.D0*t20*t8*t35*t254*t92+128.D0/3.D0*(-2+
     #z)*t71*t7*t227+128.D0/3.D0*t6*t231*t2*t9*s34r)*s23r-128.D0/3.D0*t9
     #0*t22*t35*t254*t211-128.D0/3.D0*t108*t119+128.D0/3.D0*t7*t231*t3*t
     #9*t24
      t1 = -1+z
      t2 = l3-1
      t3 = t2**2
      t4 = t1*t3
      t5 = 1/s3vr
      t6 = t5*s2l2
      t7 = t4*t6
      t8 = t1**2
      t9 = t8*t3
      t10 = t5*s3l2p
      t11 = t9*t10
      t14 = s1vr**2
      t18 = s4l2p*t5
      t19 = t9*t18
      t23 = t3*t2
      t24 = t8*t23
      t25 = t5*s34r
      t26 = t25*s2l2
      t29 = t8*t1
      t30 = t29*t23
      t38 = t5*s2l1
      t39 = t4*t38
      t40 = t5*s3l1p
      t41 = t9*t40
      t47 = s4l1p*t5
      t48 = t9*t47
      t52 = t25*s2l1
      t80 = t30*t5
      t92 = s13r**2
      t94 = l3*t1
      t95 = t2*t5
      t97 = t94*t95*s2l2
      t99 = l3*t8
      t100 = t95*s3l2p
      t101 = t99*t100
      t104 = t2*s4l2p*t5
      t105 = t99*t104
      t108 = t14*s1vr
      t112 = 512*t105
      t115 = t3*t5
      t117 = t99*t115*s34r
      t119 = z*t2
      t122 = 1024*t117+512.D0/3.D0*t119*t5
      t124 = t29*t3
      t125 = l3*t5
      t126 = t125*s3l2p
      t127 = t124*t126
      t129 = t3*l3
      t130 = t29*s4l2p
      t131 = t130*t5
      t132 = t129*t131
      t138 = (5-3*z)*t2
      t139 = t1*t5
      t140 = t139*s3l2p
      t143 = t8*t2
      t144 = t143*t18
      t151 = s23r**2
      t154 = 1+z
      t158 = -6656.D0/3.D0*t117-512.D0/3.D0*t154*t2*t5
      t164 = 5*z
      t166 = (7-t164)*t2
      t170 = (3-z)*t2
      t172 = t1*s4l2p*t5
      t177 = l3*t29
      t178 = t23*t5
      t179 = s34r**2
      t181 = t177*t178*t179
      t183 = t9*t25
      t185 = -1792*t181+1280.D0/3.D0*t183
      t187 = t8**2
      t188 = l3*t187
      t190 = t188*t178*s3l2p
      t192 = t23*l3
      t193 = t187*s4l2p
      t194 = t193*t5
      t195 = t192*t194
      t201 = (15-13*z)*t8
      t202 = t115*s3l2p
      t204 = 12*z
      t206 = (10-t204)*t8
      t208 = t3*s4l2p*t5
      t218 = 1024.D0/3.D0*t117-1024.D0/3.D0*t2*t1*t5
      t229 = 2560.D0/3.D0*t181-2560.D0/3.D0*t183
      t232 = -2560.D0/3.D0*t190-2560.D0/3.D0*t195
      t241 = t3**2
      t243 = t179*s34r
      t244 = t125*t243
      t249 = 2560.D0/3.D0*t187*t241*t244-2560.D0/3.D0*t30*t5*t179
      t251 = t187*t1
      t252 = t251*t241
      t255 = l3*s4l2p*t5
      t260 = t187*t23
      t269 = t94*t95*s2l1
      t271 = t95*s3l1p
      t272 = t99*t271
      t275 = t2*s4l1p*t5
      t276 = t99*t275
      t282 = 512*t276
      t287 = t125*s3l1p
      t288 = t124*t287
      t290 = t29*s4l1p
      t291 = t290*t5
      t292 = t129*t291
      t296 = t139*s3l1p
      t299 = t143*t47
      t316 = t1*s4l1p*t5
      t324 = t188*t178*s3l1p
      t326 = t187*s4l1p
      t327 = t326*t5
      t328 = t192*t327
      t332 = t115*s3l1p
      t335 = t3*s4l1p*t5
      t355 = 2560.D0/3.D0*t324+2560.D0/3.D0*t328
      t368 = l3*s4l1p*t5
      t381 = 3*t8*t2
      t390 = t177*t2
      t391 = t18*s3l1p
      t394 = t47*s3l2p
      t400 = 4*t8*t2
      t417 = 2*z
      t419 = (3-t417)*t1
      t422 = 3*t1
      t423 = t422*t2
      t438 = t188*t3
      t441 = t438*t391-t438*t394
      t444 = z+2
      t446 = t444*t8*t2
      t466 = (-3+t164)*t1
      t486 = t29*t2
      t493 = t188*t23
      t497 = 8*z
      t499 = (-6+t497)*t8
      t501 = -t154
      t502 = t501*t8
      t520 = l3*t251*t23
      t526 = t187*t3
      t536 = l3**2
      t537 = t8*t536
      t538 = t14**2
      t542 = t1*t536
      t543 = t542*t6
      t545 = t537*t10
      t547 = t537*t18
      t551 = t537*t2
      t554 = -t2
      t556 = 18*t554*t29
      t557 = t536*t5
      t558 = t557*s3l2p
      t560 = t554*t29
      t562 = t536*s4l2p*t5
      t563 = t560*t562
      t567 = 7*z
      t569 = (-1+t567)*t1
      t580 = t143*t557*s34r
      t583 = -5632.D0/3.D0*t580-512.D0/3.D0*t125
      t586 = 50*t554*t29
      t589 = 19*t554*t29
      t595 = 10*l3*t1
      t599 = 3*t154*t1
      t605 = t124*t557*t179
      t608 = t125*s34r
      t611 = -4096.D0/3.D0*t605-2048.D0/3.D0*t119*t1*t608
      t613 = t3*t536
      t614 = t187*t5
      t616 = t613*t614*s3l2p
      t618 = t613*t194
      t622 = t8*z
      t623 = t622*l3
      t628 = (-1-t497)*t2*t8
      t633 = z*t1
      t634 = t633*t10
      t635 = 256*t634
      t640 = t151*s23r
      t644 = 6656.D0/3.D0*t580+1024.D0/3.D0*t125
      t647 = 15*t554*t29
      t651 = 22*t554*t29
      t657 = (11-t567)*t1
      t661 = (5-z)*t1
      t672 = z*t5
      t674 = 9728.D0/3.D0*t605+256.D0/3.D0*(6+t204)*t2*t1*t608-512.D0/3.
     #D0*t672
      t682 = (-t417+24)*t2*t8
      t687 = (8-z)*t2*t8
      t693 = (-t164-2)*t1
      t697 = -t444*t1
      t702 = t23*t536
      t704 = t702*t614*t243
      t707 = t125*t179
      t710 = z**2
      t716 = 4096.D0/3.D0*t704+1280*t622*t3*t707+256.D0/3.D0*(t567-7*t71
     #0-2)*t2*t25
      t718 = t251*t5
      t720 = t702*t718*s3l2p
      t724 = t702*t251*s4l2p*t5
      t728 = 15*z
      t731 = (9+t728)*t29*t3
      t735 = (-9-t497)*t29*t3
      t742 = (t728-13*t710-2)*t2
      t745 = -10*z+8
      t747 = t745*t2*t1
      t758 = -1024.D0/3.D0*t580+1024.D0/3.D0*t94*t5
      t760 = t486*t558
      t765 = t99*t10
      t767 = t99*t18
      t776 = -3584.D0/3.D0*t605-512.D0/3.D0*t166*t1*t608+1024.D0/3.D0*t6
     #72
      t781 = t166*t8
      t788 = t633*t18
      t793 = 10-t164
      t798 = 5*t554
      t803 = -5120.D0/3.D0*t704-512.D0/3.D0*t793*t8*t3*t707-512.D0/3.D0*
     #t798*t1*t672*s34r
      t809 = t793*t29*t3
      t815 = t8*t5
      t816 = t815*s3l2p
      t826 = t241*t536
      t827 = t179**2
      t834 = -2560.D0/3.D0*t826*t718*t827-2560.D0/3.D0*t30*t244+2560.D0/
     #3.D0*t622*t115*t179
      t836 = t187*t8
      t837 = t836*t5
      t850 = z*t3
      s2 = 1024.D0/3.D0*t537*t10*t538+((512.D0/3.D0*t543-4096.D0/3.D0*t5
     #45-512*t547)*s23r+512*t551*t26+(256.D0/3.D0*t556*t558+256.D0/3.D0*
     #t563)*s34r-256.D0/3.D0*t569*t126)*t108
      s3 = s2+((-1024.D0/3.D0*t543+3584.D0/3.D0*t545+2048.D0/3.D0*t547)*
     #t151+(t583*s2l2+(-256.D0/3.D0*t586*t558-256.D0/3.D0*t589*t562)*s34
     #r+256.D0/3.D0*t595*t10+256.D0/3.D0*t599*t255)*s23r+t611*s2l2+(7168
     #.D0/3.D0*t616+2816.D0/3.D0*t618)*t179+(5632.D0/3.D0*t623*t100-256.
     #D0/3.D0*t628*t255)*s34r-t635)*t14
      s1 = s3+((1024.D0/3.D0*t543-1024.D0/3.D0*t545-1024.D0/3.D0*t547)*t
     #640+(t644*s2l2+(512.D0/3.D0*t647*t558+256.D0/3.D0*t651*t562)*s34r-
     #256.D0/3.D0*t657*t126-256.D0/3.D0*t661*t255)*t151+(t674*s2l2+(-128
     #00.D0/3.D0*t616-9728.D0/3.D0*t618)*t179+(-256.D0/3.D0*t682*t126-51
     #2.D0/3.D0*t687*t255)*s34r-256.D0/3.D0*t693*t10-256.D0/3.D0*t697*t1
     #8)*s23r+t716*s2l2+(-2048*t720-5120.D0/3.D0*t724)*t243+(-256.D0/3.D
     #0*t731*t126+256.D0/3.D0*t735*t255)*t179+(-256.D0/3.D0*t742*t140-25
     #6.D0/3.D0*t747*z*s4l2p*t5)*s34r)*s1vr+(t758*s2l2+(1024.D0/3.D0*t76
     #0+1024.D0/3.D0*t486*t562)*s34r-1024.D0/3.D0*t765-1024.D0/3.D0*t767
     #)*t640
      t855 = s1+(t776*s2l2+(3584.D0/3.D0*t616+3584.D0/3.D0*t618)*t179+(5
     #12.D0/3.D0*t781*t126+512.D0/3.D0*t781*t255)*s34r-1024.D0/3.D0*t634
     #-1024.D0/3.D0*t788)*t151+(t803*s2l2+(5120.D0/3.D0*t720+5120.D0/3.D
     #0*t724)*t243+(512.D0/3.D0*t809*t126+512.D0/3.D0*t809*t255)*t179+(-
     #2560.D0/3.D0*t119*t816-2560.D0/3.D0*t119*t8*s4l2p*t5)*s34r)*s23r+t
     #834*s2l2+(2560.D0/3.D0*t826*t837*s3l2p+2560.D0/3.D0*t826*t836*s4l2
     #p*t5)*t827-t232*t243+(-2560.D0/3.D0*z*t29*t202-2560.D0/3.D0*t850*t
     #131)*t179
      t860 = t542*t38
      t862 = t537*t40
      t864 = t537*t47
      t870 = t557*s3l1p
      t873 = t536*s4l1p*t5
      t874 = t560*t873
      t903 = t613*t614*s3l1p
      t905 = t613*t327
      t915 = t633*t40
      t916 = 256*t915
      t957 = t702*t718*s3l1p
      t961 = t702*t251*s4l1p*t5
      t981 = t486*t870
      t986 = t99*t40
      t988 = t99*t47
      t1003 = t633*t47
      t1017 = t798*z
      t1018 = t815*s3l1p
      s2 = -1024.D0/3.D0*t537*t40*t538+((-512.D0/3.D0*t860+4096.D0/3.D0*
     #t862+512*t864)*s23r-512*t551*t52+(-256.D0/3.D0*t556*t870-256.D0/3.
     #D0*t874)*s34r+256.D0/3.D0*t569*t287)*t108
      s3 = s2+((1024.D0/3.D0*t860-3584.D0/3.D0*t862-2048.D0/3.D0*t864)*t
     #151+(-t583*s2l1+(256.D0/3.D0*t586*t870+256.D0/3.D0*t589*t873)*s34r
     #-256.D0/3.D0*t595*t40-256.D0/3.D0*t599*t368)*s23r-t611*s2l1+(-7168
     #.D0/3.D0*t903-2816.D0/3.D0*t905)*t179+(-5632.D0/3.D0*t623*t271+256
     #.D0/3.D0*t628*t368)*s34r+t916)*t14
      s1 = s3+((-1024.D0/3.D0*t860+1024.D0/3.D0*t862+1024.D0/3.D0*t864)*
     #t640+(-t644*s2l1+(-512.D0/3.D0*t647*t870-256.D0/3.D0*t651*t873)*s3
     #4r+256.D0/3.D0*t657*t287+256.D0/3.D0*t661*t368)*t151+(-t674*s2l1+(
     #12800.D0/3.D0*t903+9728.D0/3.D0*t905)*t179+(256.D0/3.D0*t682*t287+
     #512.D0/3.D0*t687*t368)*s34r+256.D0/3.D0*t693*t40+256.D0/3.D0*t697*
     #t47)*s23r-t716*s2l1+(2048*t957+5120.D0/3.D0*t961)*t243+(256.D0/3.D
     #0*t731*t287-256.D0/3.D0*t735*t368)*t179+(256.D0/3.D0*t742*t296+256
     #.D0/3.D0*t747*z*s4l1p*t5)*s34r)*s1vr+(-t758*s2l1+(-1024.D0/3.D0*t9
     #81-1024.D0/3.D0*t486*t873)*s34r+1024.D0/3.D0*t986+1024.D0/3.D0*t98
     #8)*t640
      t1047 = s1+(-t776*s2l1+(-3584.D0/3.D0*t903-3584.D0/3.D0*t905)*t179
     #+(-512.D0/3.D0*t781*t287-512.D0/3.D0*t781*t368)*s34r+1024.D0/3.D0*
     #t915+1024.D0/3.D0*t1003)*t151+(-t803*s2l1+(-5120.D0/3.D0*t957-5120
     #.D0/3.D0*t961)*t243+(-512.D0/3.D0*t809*t287-512.D0/3.D0*t809*t368)
     #*t179+(-512.D0/3.D0*t1017*t1018-512.D0/3.D0*t1017*t8*s4l1p*t5)*s34
     #r)*s23r-t834*s2l1+(-2560.D0/3.D0*t826*t837*s3l1p-2560.D0/3.D0*t826
     #*t836*s4l1p*t5)*t827-t355*t243+(2560.D0/3.D0*t850*t29*t5*s3l1p+256
     #0.D0/3.D0*t850*t291)*t179
      t1064 = t29*t536
      t1076 = -t1**2
      t1090 = t554*t187*t536
      t1098 = (-8-z)*l3*t8
      t1116 = -t798*t29
      t1120 = 2*t29*t2
      t1127 = (9-6*z)*t1
      t1131 = (-t417+5)*t1
      t1149 = t536*t187*t2
      t1157 = (3+t417)*l3*t8
      t1164 = t613*t187
      t1170 = (-t417-1)*t2*l3
      t1176 = t422*t1
      t1193 = t613*t251
      t1201 = (-9-t417)*t2*l3
      t1202 = t130*t40
      t1204 = t290*t10
      t1210 = (z+3-t710)*t1
      t1229 = -t745*t2*l3
      t1233 = (-4+t417)*t2*t8
      t1249 = -1+t417
      t1251 = t1249*t2*l3
      t1257 = t1249*t8
      t1265 = t501*t3*l3
      t1272 = (-t497+6*t710+2)*t2
      t1275 = (-z-t710)*t2
      t1293 = t850*l3
      t1303 = (z-t710)*t2*t8
      s3 = (((-512.D0/3.D0*t7+512.D0/3.D0*t11)*t14+((1024.D0/3.D0*t7-512
     #.D0/3.D0*t11-512.D0/3.D0*t19)*s23r+512.D0/3.D0*t24*t26-512.D0/3.D0
     #*t30*t10*s34r)*s1vr)*s1l1+((512.D0/3.D0*t39-512.D0/3.D0*t41)*t14+(
     #(-1024.D0/3.D0*t39+512.D0/3.D0*t41+512.D0/3.D0*t48)*s23r-512.D0/3.
     #D0*t24*t52+512.D0/3.D0*t30*t40*s34r)*s1vr)*s1l2+((256.D0/3.D0*t11+
     #256*t19)*s2l1+(-256.D0/3.D0*t41-256*t48)*s2l2)*t14+(((512.D0/3.D0*
     #t11+512.D0/3.D0*t19)*s2l1+(-512.D0/3.D0*t41-512.D0/3.D0*t48)*s2l2)
     #*s23r+512.D0/3.D0*t80*s3l2p*s34r*s2l1-512.D0/3.D0*t80*s3l1p*s34r*s
     #2l2)*s1vr)*t92
      s7 = ((-512.D0/3.D0*t97+2560.D0/3.D0*t101+512.D0/3.D0*t105)*t108+(
     #(512*t97-3584.D0/3.D0*t101-t112)*s23r+t122*s2l2+(-2560*t127-3328.D
     #0/3.D0*t132)*s34r-256.D0/3.D0*t138*t140+512.D0/3.D0*t144)*t14+((-2
     #048.D0/3.D0*t97+512*t101+t112)*t151+(t158*s2l2+(6656.D0/3.D0*t127+
     #1536*t132)*s34r+256.D0/3.D0*t166*t140+256.D0/3.D0*t170*t172)*s23r+
     #t185*s2l2+(2560*t190+1792*t195)*t179+(256.D0/3.D0*t201*t202+256.D0
     #/3.D0*t206*t208)*s34r)*s1vr+(t218*s2l2+(-1024.D0/3.D0*t127-1024.D0
     #/3.D0*t132)*s34r+1024.D0/3.D0*t143*t10+1024.D0/3.D0*t144)*t151+(t2
     #29*s2l2+t232*t179+(2560.D0/3.D0*t124*t10+2560.D0/3.D0*t124*t18)*s3
     #4r)*s23r+t249*s2l2+(-2560.D0/3.D0*t252*t126-2560.D0/3.D0*t252*t255
     #)*t243+(2560.D0/3.D0*t260*t10+2560.D0/3.D0*t260*t18)*t179)*s1l1
      s8 = ((512.D0/3.D0*t269-2560.D0/3.D0*t272-512.D0/3.D0*t276)*t108+(
     #(-512*t269+3584.D0/3.D0*t272+t282)*s23r-t122*s2l1+(2560*t288+3328.
     #D0/3.D0*t292)*s34r+256.D0/3.D0*t138*t296-512.D0/3.D0*t299)*t14+((2
     #048.D0/3.D0*t269-512*t272-t282)*t151+(-t158*s2l1+(-6656.D0/3.D0*t2
     #88-1536*t292)*s34r-256.D0/3.D0*t166*t296-256.D0/3.D0*t170*t316)*s2
     #3r-t185*s2l1+(-2560*t324-1792*t328)*t179+(-256.D0/3.D0*t201*t332-2
     #56.D0/3.D0*t206*t335)*s34r)*s1vr+(-t218*s2l1+(1024.D0/3.D0*t288+10
     #24.D0/3.D0*t292)*s34r-1024.D0/3.D0*t143*t40-1024.D0/3.D0*t299)*t15
     #1+(-t229*s2l1+t355*t179+(-2560.D0/3.D0*t124*t40-2560.D0/3.D0*t124*
     #t47)*s34r)*s23r-t249*s2l1+(2560.D0/3.D0*t252*t287+2560.D0/3.D0*t25
     #2*t368)*t243+(-2560.D0/3.D0*t260*t40-2560.D0/3.D0*t260*t47)*t179)*
     #s1l2
      s6 = s7+s8
      s7 = s6+((256.D0/3.D0*t381*t126+256.D0/3.D0*t105)*s2l1+(-256.D0/3.
     #D0*t381*t287-256.D0/3.D0*t276)*s2l2-512.D0/3.D0*t390*t391+512.D0/3
     #.D0*t390*t394)*t108
      s8 = s7
      s10 = (((-256.D0/3.D0*t400*t126-256.D0/3.D0*t400*t255)*s2l1+(256.D
     #0/3.D0*t400*t287+256.D0/3.D0*t400*t368)*s2l2)*s23r+((-256*t127-768
     #*t132)*s34r-256.D0/3.D0*t419*t100-256.D0/3.D0*t423*t18)*s2l1+((256
     #*t288+768*t292)*s34r+256.D0/3.D0*t419*t271+256.D0/3.D0*t423*t47)*s
     #2l2+256.D0/3.D0*t441*s34r+256.D0/3.D0*t446*t391-256.D0/3.D0*t446*t
     #394)*t14
      s11 = (((-512.D0/3.D0*t101-512.D0/3.D0*t105)*s2l1+(512.D0/3.D0*t27
     #2+512.D0/3.D0*t276)*s2l2)*t151+(((-512*t127-512.D0/3.D0*t132)*s34r
     #-256.D0/3.D0*t466*t100-256.D0/3.D0*t466*t104)*s2l1+((512*t288+512.
     #D0/3.D0*t292)*s34r+256.D0/3.D0*t466*t271+256.D0/3.D0*t466*t275)*s2
     #l2-512.D0/3.D0*t441*s34r+512.D0/3.D0*t486*t391-512.D0/3.D0*t486*t3
     #94)*s23r+(256.D0/3.D0*t493*t10*t179+(-256.D0/3.D0*t499*t202-256.D0
     #/3.D0*t502*t208)*s34r)*s2l1+(-256.D0/3.D0*t493*t40*t179+(256.D0/3.
     #D0*t499*t332+256.D0/3.D0*t502*t335)*s34r)*s2l2+(256.D0/3.D0*t520*t
     #391-256.D0/3.D0*t520*t394)*t179+(-256.D0/3.D0*t526*t391+256.D0/3.D
     #0*t526*t394)*s34r)*s1vr
      s9 = s10+s11
      s5 = s8+s9
      s6 = s13r
      s4 = s5*s6
      s2 = s3+s4
      s1 = s2+t855*s1l1+t1047*s1l2
      s2 = s1+(1024.D0/3.D0*t537*t10*s2l1-1024.D0/3.D0*t537*t40*s2l2)*t5
     #38
      s3 = s2+(((-768*t545-1280.D0/3.D0*t547)*s2l1+(768*t862+1280.D0/3.D
     #0*t864)*s2l2+512.D0/3.D0*t1064*t391-512.D0/3.D0*t1064*t394)*s23r+(
     #(-2048.D0/3.D0*t760-256.D0/3.D0*t563)*s34r-256.D0/3.D0*t1076*t126)
     #*s2l1+((2048.D0/3.D0*t981+256.D0/3.D0*t874)*s34r+256.D0/3.D0*t1076
     #*t287)*s2l2+(256.D0/3.D0*t1090*t391-256.D0/3.D0*t1090*t394)*s34r-2
     #56.D0/3.D0*t1098*t391+256.D0/3.D0*t1098*t394)*t108
      s4 = s3
      s6 = (((1280.D0/3.D0*t545+256*t547)*s2l1+(-1280.D0/3.D0*t862-256*t
     #864)*s2l2)*t151+(((512.D0/3.D0*t1116*t558+256.D0/3.D0*t1120*t562)*
     #s34r+256.D0/3.D0*t1127*t126+256.D0/3.D0*t1131*t255)*s2l1+((-512.D0
     #/3.D0*t1116*t870-256.D0/3.D0*t1120*t873)*s34r-256.D0/3.D0*t1127*t2
     #87-256.D0/3.D0*t1131*t368)*s2l2+(1024.D0/3.D0*t1149*t391-1024.D0/3
     #.D0*t1149*t394)*s34r-256.D0/3.D0*t1157*t391+256.D0/3.D0*t1157*t394
     #)*s23r+(-256.D0/3.D0*t1164*t18*t179+(256.D0/3.D0*t1170*t816+256.D0
     #/3.D0*t381*t255)*s34r-256.D0/3.D0*t1176*t10)*s2l1+(256.D0/3.D0*t11
     #64*t47*t179+(-256.D0/3.D0*t1170*t1018-256.D0/3.D0*t381*t368)*s34r+
     #256.D0/3.D0*t1176*t40)*s2l2+(256.D0/3.D0*t1193*t391-256.D0/3.D0*t1
     #193*t394)*t179+(256.D0/3.D0*t1201*t1202-256.D0/3.D0*t1201*t1204)*s
     #34r-256.D0/3.D0*t1210*t391+256.D0/3.D0*t1210*t394)*t14
      s7 = (((1280.D0/3.D0*t765+256*t767)*s2l1+(-1280.D0/3.D0*t986-256*t
     #988)*s2l2)*t151+(((256.D0/3.D0*t1229*t816+256.D0/3.D0*t1233*t255)*
     #s34r+t635+256*t788)*s2l1+((-256.D0/3.D0*t1229*t1018-256.D0/3.D0*t1
     #233*t368)*s34r-t916-256*t1003)*s2l2+(512.D0/3.D0*t1251*t1202-512.D
     #0/3.D0*t1251*t1204)*s34r-512.D0/3.D0*t1257*t391+512.D0/3.D0*t1257*
     #t394)*s23r+((-256.D0/3.D0*t127+256.D0/3.D0*t1265*t131)*t179+(256.D
     #0/3.D0*t1272*t140+256.D0/3.D0*t1275*t172)*s34r)*s2l1+((256.D0/3.D0
     #*t288-256.D0/3.D0*t1265*t291)*t179+(-256.D0/3.D0*t1272*t296-256.D0
     #/3.D0*t1275*t316)*s34r)*s2l2+(256.D0/3.D0*t1293*t193*t40-256.D0/3.
     #D0*t1293*t326*t10)*t179+(256.D0/3.D0*t1303*t391-256.D0/3.D0*t1303*
     #t394)*s34r)*s1vr
      s5 = s6+s7
      taux2 = s4+s5

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = -taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet2 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet4 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      ACnum1e3 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcoff4
      RETURN
      END

      double precision function ACnum1e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux1 = 0
      t1 = -1+z
      t2 = t1**2
      t3 = l3-1
      t4 = t3**2
      t5 = t2*t4
      t6 = 1/s3vr
      t7 = t6*s3l2p
      t9 = s4l2p*t6
      t14 = t6*s3l1p
      t16 = s4l1p*t6
      t22 = s1vr**2
      t24 = s13r**2
      t26 = t2*t1
      t27 = t26*t4
      t28 = l3*t6
      t29 = t28*s3l2p
      t30 = t27*t29
      t32 = t4*l3
      t33 = t26*s4l2p
      t34 = t33*t6
      t35 = t32*t34
      t39 = t2*t3
      t40 = t39*t7
      t41 = 512.D0/3.D0*t40
      t44 = -t30-t35
      t47 = t39*t9
      t52 = t4*t3
      t53 = t52*t6
      t54 = s34r**2
      t57 = t6*s34r
      t59 = l3*t26*t53*t54-t5*t57
      t60 = 512.D0/3.D0*t59
      t62 = t2**2
      t63 = l3*t62
      t65 = t63*t53*s3l2p
      t67 = t52*l3
      t68 = t62*s4l2p
      t69 = t68*t6
      t70 = t67*t69
      t75 = 3*t2*t1
      t76 = t4*t6
      t77 = t76*s3l2p
      t79 = 2*t1
      t80 = t79*t2
      t90 = -1024.D0/3.D0*t59
      t93 = 1024.D0/3.D0*t65+1024.D0/3.D0*t70
      t96 = t27*t9
      t102 = t4**2
      t104 = t54*s34r
      t105 = t28*t104
      t107 = t26*t52
      t111 = -1024.D0/3.D0*t62*t102*t105+1024.D0/3.D0*t107*t6*t54
      t113 = t62*t1
      t114 = t113*t102
      t117 = l3*s4l2p*t6
      t122 = t62*t52
      t130 = t28*s3l1p
      t131 = t27*t130
      t133 = t26*s4l1p
      t134 = t133*t6
      t135 = t32*t134
      t139 = t39*t14
      t140 = 512.D0/3.D0*t139
      t143 = t131+t135
      t146 = t39*t16
      t153 = t63*t53*s3l1p
      t155 = t62*s4l1p
      t156 = t155*t6
      t157 = t67*t156
      t161 = t76*s3l1p
      t174 = -1024.D0/3.D0*t153-1024.D0/3.D0*t157
      t177 = t27*t16
      t187 = l3*s4l1p*t6
      t199 = l3*t2
      t200 = t3*t6
      t205 = t199*t3*s4l2p*t6
      t206 = t199*t200*s3l2p+t205
      t213 = t199*t3*s4l1p*t6
      t214 = -t199*t200*s3l1p-t213
      t218 = t22*s1vr
      t230 = t1*t3
      t245 = t63*t4
      t246 = t9*s3l1p
      t248 = t16*s3l2p
      t253 = z*t2
      t254 = t253*t3
      t269 = t63*t52
      t289 = l3*t113*t52
      t295 = t62*t4
      t305 = t3*t26
      t306 = l3**2
      t307 = t306*t6
      t309 = t305*t307*s3l2p
      t313 = t305*t306*s4l2p*t6
      t317 = t199*t7
      t318 = 512.D0/3.D0*t317
      t325 = t79*t1
      t328 = t199*t9
      t329 = 512.D0/3.D0*t328
      t332 = t4*t306
      t333 = t62*t6
      t335 = t332*t333*s3l2p
      t337 = t332*t69
      t341 = 2*z
      t343 = (-4+t341)*t3
      t349 = z*t1
      t351 = 512.D0/3.D0*t349*t7
      t356 = (1024.D0/3.D0*t309+1024.D0/3.D0*t313)*s34r
      t358 = s23r**2
      t361 = t27*t307*t54
      t363 = t79*t3
      t364 = t363*t1
      t365 = t28*s34r
      t368 = -1024.D0/3.D0*t361+512.D0/3.D0*t364*t365
      t376 = (4*z-6)*t3
      t380 = -2+z
      t381 = t380*t3
      t388 = 512.D0/3.D0*t349*t9
      t391 = t52*t306
      t393 = t391*t333*t104
      t398 = t380*t2*t4*t28*t54
      t400 = z**2
      t401 = -z+t400
      t402 = t401*t3
      t405 = -1024.D0/3.D0*t393+512.D0/3.D0*t398+512.D0/3.D0*t402*t57
      t407 = t113*t6
      t409 = t391*t407*s3l2p
      t413 = t391*t113*s4l2p*t6
      t419 = (-5+z)*t26*t4
      t426 = 3*t401*t3
      t427 = t1*t6
      t428 = t427*s3l2p
      t440 = 1024.D0/3.D0*t361-1024.D0/3.D0*t39*t365
      t458 = 2048.D0/3.D0*t393-1024.D0/3.D0*t398-1024.D0/3.D0*t230*z*t6*
     #s34r
      t464 = t380*t26*t4
      t470 = z*t3
      t471 = t2*t6
      t472 = t471*s3l2p
      t475 = t2*s4l2p*t6
      t482 = t102*t306
      t483 = t54**2
      t490 = 1024.D0/3.D0*t482*t407*t483+1024.D0/3.D0*t107*t105-1024.D0/
     #3.D0*t253*t76*t54
      t492 = t62*t2
      t493 = t492*t6
      t506 = z*t4
      t514 = t305*t307*s3l1p
      t518 = t305*t306*s4l1p*t6
      t522 = t199*t14
      t523 = 512.D0/3.D0*t522
      t532 = t199*t16
      t533 = 512.D0/3.D0*t532
      t537 = t332*t333*s3l1p
      t539 = t332*t156
      t544 = t471*s3l1p
      t550 = 512.D0/3.D0*t349*t14
      t555 = (-1024.D0/3.D0*t514-1024.D0/3.D0*t518)*s34r
      t569 = t2*s4l1p*t6
      t575 = 512.D0/3.D0*t349*t16
      t581 = t391*t407*s3l1p
      t585 = t391*t113*s4l1p*t6
      t594 = t427*s3l1p
      t654 = t306*t2
      t658 = -512.D0/3.D0*t654*t7-512.D0/3.D0*t654*t9
      t663 = 512.D0/3.D0*t654*t14+512.D0/3.D0*t654*t16
      t667 = t305*t306
      t679 = t306*t62*t3
      t686 = t380*l3*t2
      t699 = t1*l3
      t718 = t332*t62
      t724 = (-1+t341)*t3*l3
      t742 = t332*t113
      t750 = (t341-3)*t3*l3
      t759 = (-z+1+t400)*t1
      t774 = t363*l3
      t796 = 2*t401*t3
      t819 = t506*l3
      t827 = t402*t2
      s2 = ((512.D0/3.D0*t5*t7+512.D0/3.D0*t5*t9)*s2l1+(-512.D0/3.D0*t5*
     #t14-512.D0/3.D0*t5*t16)*s2l2)*t22*t24
      s7 = (((1024.D0/3.D0*t30+512.D0/3.D0*t35)*s34r-t41)*t22+((1024.D0/
     #3.D0*t44*s34r+t41+512.D0/3.D0*t47)*s23r+t60*s2l2+(-2048.D0/3.D0*t6
     #5-512*t70)*t54+(512.D0/3.D0*t75*t77+512.D0/3.D0*t80*t4*s4l2p*t6)*s
     #34r)*s1vr+(t90*s2l2+t93*t54+(-1024.D0/3.D0*t27*t7-1024.D0/3.D0*t96
     #)*s34r)*s23r+t111*s2l2+(1024.D0/3.D0*t114*t29+1024.D0/3.D0*t114*t1
     #17)*t104+(-1024.D0/3.D0*t122*t7-1024.D0/3.D0*t122*t9)*t54)*s1l1
      s8 = (((-1024.D0/3.D0*t131-512.D0/3.D0*t135)*s34r+t140)*t22+((1024
     #.D0/3.D0*t143*s34r-t140-512.D0/3.D0*t146)*s23r-t60*s2l1+(2048.D0/3
     #.D0*t153+512*t157)*t54+(-512.D0/3.D0*t75*t161-512.D0/3.D0*t80*t4*s
     #4l1p*t6)*s34r)*s1vr+(-t90*s2l1+t174*t54+(1024.D0/3.D0*t27*t14+1024
     #.D0/3.D0*t177)*s34r)*s23r-t111*s2l1+(-1024.D0/3.D0*t114*t130-1024.
     #D0/3.D0*t114*t187)*t104+(1024.D0/3.D0*t122*t14+1024.D0/3.D0*t122*t
     #16)*t54)*s1l2
      s6 = s7+s8
      s5 = s6+(512.D0/3.D0*t206*s2l1+512.D0/3.D0*t214*s2l2)*t218+((-1024
     #.D0/3.D0*t206*s2l1-1024.D0/3.D0*t214*s2l2)*s23r+(512*t44*s34r-512.
     #D0/3.D0*t230*t7-512.D0/3.D0*t230*t9)*s2l1+(512*t143*s34r+512.D0/3.
     #D0*t230*t14+512.D0/3.D0*t230*t16)*s2l2+(-512.D0/3.D0*t245*t246+512
     #.D0/3.D0*t245*t248)*s34r+512.D0/3.D0*t254*t246-512.D0/3.D0*t254*t2
     #48)*t22+(((-512.D0/3.D0*t40-512.D0/3.D0*t47)*s2l1+(512.D0/3.D0*t13
     #9+512.D0/3.D0*t146)*s2l2)*s23r+(512.D0/3.D0*t269*t7*t54+(-512.D0/3
     #.D0*t80*t77-512.D0/3.D0*t96)*s34r)*s2l1+(-512.D0/3.D0*t269*t14*t54
     #+(512.D0/3.D0*t80*t161+512.D0/3.D0*t177)*s34r)*s2l2+(512.D0/3.D0*t
     #289*t246-512.D0/3.D0*t289*t248)*t54+(-512.D0/3.D0*t295*t246+512.D0
     #/3.D0*t295*t248)*s34r)*s1vr
      s6 = s13r
      s4 = s5*s6
      s7 = ((1024.D0/3.D0*t309+512.D0/3.D0*t313)*s34r-t318)*t218+(((-204
     #8.D0/3.D0*t309-512*t313)*s34r+512.D0/3.D0*t325*t29+t329)*s23r+(-10
     #24*t335-512*t337)*t54+(512.D0/3.D0*t343*t2*t29-512.D0/3.D0*t205)*s
     #34r+t351)*t22+((t356-t318-t329)*t358+(t368*s2l2+(4096.D0/3.D0*t335
     #+1024*t337)*t54+(-512.D0/3.D0*t376*t2*t29-1024.D0/3.D0*t381*t2*t11
     #7)*s34r-t351-t388)*s23r+t405*s2l2+(1024*t409+2048.D0/3.D0*t413)*t1
     #04+(-512.D0/3.D0*t419*t29+512*t35)*t54+(-512.D0/3.D0*t426*t428-512
     #.D0/3.D0*t364*z*s4l2p*t6)*s34r)*s1vr+(t440*s2l2+(-1024.D0/3.D0*t33
     #5-1024.D0/3.D0*t337)*t54+(1024.D0/3.D0*t305*t29+1024.D0/3.D0*t305*
     #t117)*s34r)*t358
      s6 = s7+(t458*s2l2+(-2048.D0/3.D0*t409-2048.D0/3.D0*t413)*t104+(10
     #24.D0/3.D0*t464*t29+1024.D0/3.D0*t464*t117)*t54+(1024.D0/3.D0*t470
     #*t472+1024.D0/3.D0*t470*t475)*s34r)*s23r+t490*s2l2+(-1024.D0/3.D0*
     #t482*t493*s3l2p-1024.D0/3.D0*t482*t492*s4l2p*t6)*t483-t93*t104+(10
     #24.D0/3.D0*z*t26*t77+1024.D0/3.D0*t506*t34)*t54
      s7 = s1l1
      s5 = s6*s7
      s3 = s4+s5
      s1 = s2+s3
      s3 = s1
      s6 = ((-1024.D0/3.D0*t514-512.D0/3.D0*t518)*s34r+t523)*t218+(((204
     #8.D0/3.D0*t514+512*t518)*s34r-512.D0/3.D0*t325*t130-t533)*s23r+(10
     #24*t537+512*t539)*t54+(-512.D0/3.D0*t343*l3*t544+512.D0/3.D0*t213)
     #*s34r-t550)*t22+((t555+t523+t533)*t358+(-t368*s2l1+(-4096.D0/3.D0*
     #t537-1024*t539)*t54+(512.D0/3.D0*t376*l3*t544+1024.D0/3.D0*t381*l3
     #*t569)*s34r+t550+t575)*s23r-t405*s2l1+(-1024*t581-2048.D0/3.D0*t58
     #5)*t104+(512.D0/3.D0*t419*t130-512*t135)*t54+(512.D0/3.D0*t426*t59
     #4+512.D0/3.D0*t364*z*s4l1p*t6)*s34r)*s1vr+(-t440*s2l1+(1024.D0/3.D
     #0*t537+1024.D0/3.D0*t539)*t54+(-1024.D0/3.D0*t305*t130-1024.D0/3.D
     #0*t305*t187)*s34r)*t358
      s5 = s6+(-t458*s2l1+(2048.D0/3.D0*t581+2048.D0/3.D0*t585)*t104+(-1
     #024.D0/3.D0*t464*t130-1024.D0/3.D0*t464*t187)*t54+(-1024.D0/3.D0*t
     #470*t544-1024.D0/3.D0*t470*t569)*s34r)*s23r-t490*s2l1+(1024.D0/3.D
     #0*t482*t493*s3l1p+1024.D0/3.D0*t482*t492*s4l1p*t6)*t483-t174*t104+
     #(-1024.D0/3.D0*t506*t26*t6*s3l1p-1024.D0/3.D0*t506*t134)*t54
      s6 = s1l2
      s4 = s5*s6
      s2 = s3+s4
      s3 = s2+((t658*s2l1+t663*s2l2)*s23r+(-512.D0/3.D0*t667*t9*s34r-512
     #.D0/3.D0*t317)*s2l1+(512.D0/3.D0*t667*t16*s34r+512.D0/3.D0*t522)*s
     #2l2+(512.D0/3.D0*t679*t246-512.D0/3.D0*t679*t248)*s34r-512.D0/3.D0
     #*t686*t246+512.D0/3.D0*t686*t248)*t218
      s4 = s3
      s6 = ((-t658*s2l1-t663*s2l2)*t358+((t356+512.D0/3.D0*t699*t7+512.D
     #0/3.D0*t699*t9)*s2l1+(t555-512.D0/3.D0*t699*t14-512.D0/3.D0*t699*t
     #16)*s2l2-512.D0/3.D0*t199*t246+512.D0/3.D0*t199*t248)*s23r+(512.D0
     #/3.D0*t718*t9*t54+(512.D0/3.D0*t724*t472+512.D0/3.D0*t205)*s34r-51
     #2.D0/3.D0*t472)*s2l1+(-512.D0/3.D0*t718*t16*t54+(-512.D0/3.D0*t724
     #*t544-512.D0/3.D0*t213)*s34r+512.D0/3.D0*t544)*s2l2+(-512.D0/3.D0*
     #t742*t246+512.D0/3.D0*t742*t248)*t54+(512.D0/3.D0*t750*t33*t14-512
     #.D0/3.D0*t750*t133*t7)*s34r-512.D0/3.D0*t759*t246+512.D0/3.D0*t759
     #*t248)*t22
      s7 = (((512.D0/3.D0*t317+512.D0/3.D0*t328)*s2l1+(-512.D0/3.D0*t522
     #-512.D0/3.D0*t532)*s2l2)*t358+(((512.D0/3.D0*t774*t472+512.D0/3.D0
     #*t774*t475)*s34r+t351+t388)*s2l1+((-512.D0/3.D0*t774*t544-512.D0/3
     #.D0*t774*t569)*s34r-t550-t575)*s2l2)*s23r+((-512.D0/3.D0*t30+512.D
     #0/3.D0*t295*t117)*t54+(512.D0/3.D0*t796*t428+512.D0/3.D0*t402*t1*s
     #4l2p*t6)*s34r)*s2l1+((512.D0/3.D0*t131-512.D0/3.D0*t295*t187)*t54+
     #(-512.D0/3.D0*t796*t594-512.D0/3.D0*t402*t1*s4l1p*t6)*s34r)*s2l2+(
     #-512.D0/3.D0*t819*t68*t14+512.D0/3.D0*t819*t155*t7)*t54+(512.D0/3.
     #D0*t827*t246-512.D0/3.D0*t827*t248)*s34r)*s1vr
      s5 = s6+s7
      taux2 = s4+s5

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = -taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet2 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet4 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      ACnum1e4 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcoff4
      RETURN
      END

