CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCC Numerator functions CCCCCCCCCCCCCCCCCCCCCCCCCC

      double precision function rm1num1e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3**2
      t2 = -1+z
      t3 = t2**2
      t4 = t3*t2
      t5 = t1*t4
      t6 = l3-1
      t8 = t5*t6*s23r
      t10 = t6**2
      t11 = t1*t10
      t12 = t3**2
      t13 = t12*s34r
      t14 = t11*t13
      t16 = z*l3
      t17 = t3*t6
      t18 = t16*t17
      t19 = 1536*t18
      t21 = l1**2
      t23 = r**2
      t25 = 1+t23
      t26 = t25**2
      t27 = r+t
      t28 = t27**2
      t31 = r*t
      t32 = 1+t31
      t33 = t32**2
      t35 = t26/t28/t33
      t37 = t1*t3
      t38 = s23r**2
      t39 = t37*t38
      t41 = t6*t4
      t43 = t41*t1*s34r
      t44 = l3*t6
      t45 = t44*t3
      t46 = -t43-t45
      t49 = s34r**2
      t51 = t11*t12*t49
      t53 = 2*l3
      t54 = 2*t16
      t55 = 3*z
      t61 = t53-1
      t63 = t61*t2*z
      t68 = 1/t27
      t70 = 1/t32
      t71 = t25*t68*t70
      t73 = t37*s34r
      t75 = t2*l3
      t80 = t41*t1*t49
      t82 = t3*s34r
      t83 = t44*t82
      t85 = t2*t6
      t89 = t49*s34r
      t93 = t4*t10
      t97 = 3*t16
      t98 = z*t1
      t105 = s1l1**2
      t107 = t12*s3l1
      t108 = t11*t107
      t109 = 1920*t108
      t110 = t10*z
      t111 = t1*t12
      t112 = t110*t111
      t114 = t109-1536*t112
      t115 = t21*l1
      t117 = t23*r
      t125 = t26*t25/t28/t27/t33/t32
      t128 = t41*t1*s2l1
      t130 = t1*s3l1
      t131 = t41*t130
      t133 = t98*t41
      t138 = t11*t13*s2l1
      t141 = 4608*t112
      t144 = 3*l3
      t145 = -t144+t97+2-z
      t147 = t17*s3l1
      t148 = t145*l3*t147
      t150 = 2*z
      t151 = -t144+t97-t150+1
      t160 = t98*t3*t38
      t162 = t61*l3
      t164 = t43+t162*t3
      t167 = t131-t133
      t170 = t3*s3l1
      t171 = t162*t170
      t173 = 3840*t18
      t177 = 6*t16
      t178 = 6*l3
      t188 = 4*t16
      t189 = 4*l3
      t190 = t188-t189-z+2
      t195 = 4*z
      t202 = 3*t1
      t203 = 3*t98
      t204 = -t202+t203-1+t189-t54
      t206 = t204*t2*s3l1
      t209 = (-t202+t203-t188+z+t53)*t2
      t216 = t98*t82
      t218 = z*t2
      t219 = t218*l3
      t223 = -t73-t75
      t227 = t98*t41*t49
      t230 = -t37*s3l1+t18
      t233 = t75*s3l1
      t235 = t218*t6
      t252 = l3*t4
      t253 = z*t6
      t261 = (t54-z-t53+2)*s3l1
      t269 = t16-l3+1
      t272 = -l3+t16-z
      t275 = t114*t115*t117*t125+((-1920*t128-7680*t131+1920*t133)*s23r+
     #1152*t138+(-3840*t108+t141)*s34r-1920*t148+1536*t151*z*t45)*t21*t2
     #3*t35+(-3840*t160+(1920*t164*s2l1+3840*t167*s34r+7680*t171-t173)*s
     #23r+(-1152*t51+384*t44*t3*(-t177+t178+t55-3)*s34r)*s2l1+(t109-t141
     #)*t49+(1920*t44*t3*t190*s3l1+1536*t16*t17*(-t177+t178+t195-3))*s34
     #r+1920*t206-1536*t209*z)*l1*r*t71+(1920*t216+3840*t219)*t38+(1920*
     #t223*s2l1+1920*t227+3840*t230*s34r-7680*t233+1920*t235)*s23r+(1152
     #*t80-384*t75*(-3*t16+3*l3+3*z-3)*s34r)*s2l1+1536*t98*t10*t12*t89+(
     #-1920*t131-1536*t252*t253*(-t144+2))*t49+(-1920*t75*t261-1536*t218
     #*(-t203-z+t188+t202-t144+1))*s34r-1920*t269*s3l1+1536*t272*z
      t277 = t10*t6
      t278 = t12*t277
      t281 = t21*t23*t35
      t282 = t16*t278*t281
      t287 = t61*t10
      t289 = -t16*t278*s34r-z*t4*t287
      t295 = t110*t252*s34r
      t297 = z*t3
      t298 = t297*t10
      t301 = s13r**2
      t305 = t252*t10*s2l1*t281
      t308 = t44*t3*s2l1
      t317 = t252*t10*s34r+t3*t61*t6
      t324 = t75*s2l1
      t326 = 384*t219
      t329 = -t83-t85
      t334 = t12*t2
      t335 = t334*t277
      t338 = t115*t117*t125
      t339 = t98*t335*t338
      t341 = s2l1**2
      t343 = t252*t10*t341
      t346 = t252*t10*s3l1
      t348 = t16*t93
      t353 = t98*t335*s34r
      t356 = t16*t93*s3l1
      t360 = t16*t93*(t144-t97-2)
      t369 = t16*t3*t6*s2l1*s23r
      t372 = t44*t3*t341
      t374 = t44*t170
      t376 = 768*t18
      t382 = t16*t93*(1-t53+t54)
      t389 = t297*(t189-1)*t6*s3l1
      t393 = t253*t3*(t202-t189+1-t203)
      t401 = t218*l3*s2l1*s23r
      t403 = t75*t341
      t408 = t16*t147
      t409 = 384*t408
      t411 = t16*t17*t269
      t416 = t218*t61*s3l1
      t417 = 384*t416
      t419 = t218*(1-t53+t1-t98)
      t423 = t98*t4
      t426 = t423*t6*t272*t49
      t429 = 2*t1
      t433 = t16*t3*(-t150-2*t98+t188+t429-l3)*s34r
      t436 = t218*l3*s3l1
      t437 = 1920*t436
      t440 = (-t1+t98-t54+z)*t2*z
      t450 = s3l1**2
      t452 = t75*t272*t450
      t462 = -t98*t3*t272*s34r-(-l3+t16-t150)*l3*t218
      t474 = t1*l3
      t477 = z**2
      t480 = t477*l3
      t483 = t477*t1
      t487 = t474*z
      t489 = -t189-t195-16*t474+16*t1+4*t477+16*t16-20*t480-48*t98+32*t4
     #83-16*t477*t474+32*t487
      t495 = t277*t12*t3
      t497 = t21**2
      t498 = t23**2
      t500 = t26**2
      t501 = t28**2
      t504 = t33**2
      t510 = t474*t12
      t512 = t510*t253*t38
      t516 = t487*t334*t10*s34r
      t519 = t98*t41*s3l1
      t524 = (1-t55-t144+t97)*z*t5*t6
      t529 = t11*t107*s34r
      t531 = t151*l3*t147
      t535 = t12*t450
      t542 = (-t178+t177-t55+2)*l3*t17*t450
      t550 = 12*t1
      t560 = t110*t334*t474*s23r
      t567 = t11*t535
      t569 = z*t334
      t608 = 1920*t408
      t610 = 24*t16
      t624 = t510*t253*s34r
      t637 = t474*t10*t569*t49
      t642 = t423*t6*(-t188+t195-1+t189)*s34r
      t645 = l3*t3
      t647 = t61*z*t645*s3l1
      t651 = (t55-t202+t203+t53-t177)*z*t645
      t655 = -t53+t54-z
      t656 = t3*t655
      t667 = t209*s3l1
      t678 = t110*t1
      t687 = t44*t656*t450
      t707 = (-6*t1+6*t98+z-t177+t189)*t2*t450
      t709 = 1920*t416
      s2 = ((1920*t8+1536*t14-t19)*t21*t23*t35+(-3840*t39+3840*t46*s23r-
     #3072*t51-1536*t44*t3*(-t53+t54+2-t55)*s34r+1536*t63)*l1*r*t71+(192
     #0*t73+3840*t75)*t38+(1920*t80+3840*t83+1920*t85)*s23r+1536*t11*t12
     #*t89+3072*t93*l3*t49+1536*t2*(-t97+z+t98-t1+t53-1)*s34r-1536*z)*t1
     #05+t275*s1l1+(192*t282+192*t289*l1*r*t71+192*t295+192*t298)*t301+(
     #(-384*t305+((768*t308+384*t18)*s23r+384*t317*s2l1)*l1*r*t71+(-768*
     #t324-t326)*s23r+384*t329*s2l1)*s1l1-192*t339+(384*t343+(768*t346+3
     #84*t348)*s2l1+192*t353+768*t356-192*t360)*t21*t23*t35+(384*t369-76
     #8*t372+(-1536*t374-t376)*s2l1+(-384*t356-192*t382)*s34r-384*t389+1
     #92*t393)*l1*r*t71-384*t401+384*t403+(768*t233+t326)*s2l1+(t409+192
     #*t411)*s34r+t417-192*t419)*s13r
      s1 = s2+(-960*t426+960*t433-t437-960*t440)*s23r+(192*t426-192*t433
     #+384*t436+192*t440)*s23r+(-384*t452+384*t436)*s34r+768*t462*t38
      s2 = s1+(1536*t75*t272*s34r-1536*z)*t341+(1920*t452-t437+192*t218*
     #t489)*s34r-1536*t495*t487*t497*t498*t500/t501/t504
      s3 = s2+(192*t512+(384*t516+384*t519+192*t524)*s23r+(-384*t529-384
     #*t531)*s2l1-384*t11*t535*s34r-384*t542+t409)*t21*t23*t35-192*t252*
     #z*t6*(12*t98-t550-20*t16+t189+8*z)*t49
      s4 = s3+(960*t560-t114*s2l1+3072*t495*t487*s34r-3840*t567+3072*t28
     #7*t569*t1)*t115*t117*t125
      t723 = s4+(-960*t512+(-1920*t516-1920*t519-960*t524)*s23r+(1536*t1
     #4-1536*t18)*t341+(1920*t529+1920*t531-1536*t145*z*t45)*s2l1-2304*t
     #487*t495*t49+(1920*t567+192*t110*t111*(-48*t16+48*l3-16+32*z))*s34
     #r+1920*t542-t608-768*(-12*t480+t610-12*l3+12*t483-24*t98+t550-t195
     #+3+3*t477)*z*t45)*t21*t23*t35+((960*t624-192*(-10*t16+15*z+10*l3-5
     #)*t3*t98)*t38+(960*t637-960*t642+1920*t647+960*t651)*s23r+(-1536*t
     #44*t656*s34r+1536*t63)*t341+((-1920*t44*t656*s3l1+t19)*s34r-1920*t
     #667+1536*t204*t2*z)*s2l1+768*t487*t495*t89+192*t678*t12*(t610-24*l
     #3-20*z+4)*t49+(-1920*t687+t608-192*t16*t17*(-48*t483+96*t98-48*t1+
     #64*t480-96*t16+32*l3-4+16*z-20*t477))*s34r-1920*t707+t709+768*t61*
     #(4*t1+4*t483-8*t98-t189-4*t480+8*t16+t477+1)*t218)*l1*r*t71
      t756 = t272*s3l1
      t780 = z*s2l1
      t783 = 1/r
      t786 = 1+u
      t787 = t786**2
      t788 = 1/t787
      t790 = t23*l2
      t791 = dsqrt(l1)
      t792 = t791*t21
      t794 = t791*l1
      t797 = t498*r
      t800 = t23*t794
      t804 = t498*t23
      t805 = t804*t794
      t807 = t498*t117
      t810 = t498*l2
      t812 = t804*t791
      t815 = t498*t791
      t818 = t**2
      t820 = t791*l2
      t822 = t818*t
      t823 = t797*t822
      t825 = t797*l2
      t826 = t792*t822
      t828 = t790*t792-t117*t794*t-t797*t791*t-t800*l2-r*t791*t-t805*l2-
     #t807*t794*t+t810*t792+2*t812*l2+5*t815*l2-t804*t818*t820-t823*t820
     #-t825*t826
      t831 = t117*l2
      t832 = t794*t
      t834 = t117*t822
      t836 = r*l2
      t838 = t792*t
      t841 = t792*t818
      t849 = t794*l2
      t854 = t794*t818
      t859 = -t498*t818*t820+t831*t832-t834*t820-t836*t832-t836*t838+t80
     #4*l2*t841-t831*t826+3*t825*t832+2*t797*t*t820+2*t823*t849-2*t825*t
     #838-2*t810*t854+3*t810*t841
      t861 = t117*t
      t880 = t23*l1
      t883 = l1*r
      t889 = dsqrt(-l2*(1-l1)*(l2-1)*t26*r*(t23*t+t880*t+r+r*t818-t883-t
     #883*t818+t+l1*t))
      t890 = l1*t889
      t896 = r*t889
      t905 = t498*t794
      t908 = t23*t889
      t911 = 5*t861*t820+2*t834*t849-3*t831*t838-2*t790*t854+2*t790*t841
     #+3*t31*t820+2*t861*t890+4*t880*t889*l4-4*t896*l4*t+t807*l2*t832-2*
     #t797*t794*t-3*t905*l2-4*t908*l4
      t915 = t23*t791
      t928 = -2*t117*t791*t+3*t915*l2-2*t880*t889+2*t896*t-4*t861*t890*l
     #4+t849-t915-t812+t805+t800-2*t815+2*t905+2*t908
      t930 = t828+t859+t911+t928
      t931 = t930**2
      t933 = t23+t31+l1-t883*t
      t934 = t933**2
      t937 = t70*t788*t931/t934
      t956 = 1-l1*l3*r*t2*t786*t68*t70
      t958 = s34spinc(z,l1,l2,l3,l4,l5,l6,l7,l8)
      t965 = t956**2
      t966 = t958**2
      t1107 = 1920*t219
      s1 = ((-192*t624-192*(t54-t55-t53+1)*t3*t98)*t38+(-192*t637+192*t6
     #42-384*t647-192*t651)*s23r+(384*t45*t655*s3l1*s34r+384*t667)*s2l1+
     #(384*t687-384*t408)*s34r+384*t707-t417)*l1*r*t71-768*(t429+2*t483-
     #4*t98-t53-2*t480+t188+t477+1)*z+((1920*t75*t756-1536*t219)*s34r+19
     #20*t756-1536*t269*z)*s2l1+(-960*t282-960*t289*l1*r*t71-960*t295-96
     #0*t298)*t301+192*(10*t341+5*t477+10*t780)*t783*t68*t937+192*(-2*t3
     #41-t477-2*t780)*t783*t68*t937-1536*(z+2*s2l1)*t956*t958*t788*t930/
     #t933+1536*t965*t966*r*t27*t32*t788
      s2 = s1+(-192*t560+384*t11*t107*s2l1+768*t567)*t115*t117*t125-768*
     #t678*t12*t272*t89+(-384*t75*t756*s34r-384*t272*s3l1)*s2l1+(768*l3-
     #768*t16+384*z)*t450
      s3 = s2-1536*s3l1*z+(-384*t8*t281+(768*t39-768*t46*s23r)*l1*r*t71+
     #(-384*t73-768*t75)*t38+(-384*t80-768*t83-384*t85)*s23r)*t105
      s4 = s3+(-384*t108*t338+((384*t128+1536*t131-384*t133)*s23r+384*t1
     #38+768*t529+384*t148)*t21*t23*t35+(768*t160+(-384*t164*s2l1-768*t1
     #67*s34r-1536*t171+t376)*s23r+(-384*t51-384*t252*t61*t6*s34r)*s2l1-
     #384*t11*t107*t49-384*t45*t190*s3l1*s34r-384*t206)*l1*r*t71+(-384*t
     #216-768*t219)*t38+(-384*t223*s2l1-384*t227-768*t230*s34r+1536*t233
     #-384*t235)*s23r+(384*t80+384*t83)*s2l1+384*t41*t130*t49+384*t75*t2
     #61*s34r+384*t269*s3l1)*s1l1
      t1154 = s4+1920*t655*t450+((1920*t305+((-3840*t308-1920*t18)*s23r-
     #1920*t317*s2l1)*l1*r*t71+(3840*t324+t1107)*s23r-1920*t329*s2l1)*s1
     #l1+960*t339+(-1920*t343+(-3840*t346-1920*t348)*s2l1-960*t353-3840*
     #t356+960*t360)*t21*t23*t35+(-1920*t369+3840*t372+(7680*t374+t173)*
     #s2l1+(1920*t356+960*t382)*s34r+1920*t389-960*t393)*l1*r*t71+1920*t
     #401-1920*t403+(-3840*t233-t1107)*s2l1+(-t608-960*t411)*s34r-t709+9
     #60*t419)*s13r
      taux1 = t723+t1154
      t1 = z*l3
      t2 = -1+z
      t3 = t2**2
      t4 = t3**2
      t5 = l3-1
      t6 = t5**2
      t7 = t6*t5
      t8 = t4*t7
      t10 = l1**2
      t11 = r**2
      t13 = 1+t11
      t14 = t13**2
      t15 = r+t
      t16 = t15**2
      t19 = r*t
      t20 = 1+t19
      t21 = t20**2
      t23 = t14/t16/t21
      t29 = t3*t2
      t30 = z*t29
      t31 = 2*l3
      t32 = t31-1
      t39 = 1/t15
      t41 = 1/t20
      t42 = t13*t39*t41
      t44 = z*t6
      t47 = t44*l3*t29*s34r
      t49 = z*t3
      t53 = s13r**2
      t55 = t3*t5
      t58 = l1*r
      t61 = z*t2
      t67 = l3**2
      t68 = z*t67
      t69 = t4*t2
      t70 = t69*t7
      t72 = t10*l1
      t73 = t11*r
      t81 = t14*t13/t16/t15/t21/t20
      t82 = t72*t73*t81
      t85 = t29*t6
      t93 = t1*t85*s3l1
      t95 = 3*l3
      t96 = 3*t1
      t111 = 2*z
      t112 = 8*t1
      t113 = t111-t112
      t119 = 2*t1
      t130 = z*t5
      t131 = 3*t67
      t132 = 4*l3
      t133 = 3*t68
      t149 = 4*t1
      t150 = -t149+t111
      t164 = -t150
      t165 = t2*t164
      t173 = t67*t4
      t177 = t29*t5
      t184 = 6*t1
      t185 = z**2
      t186 = t185*l3
      t187 = 6*t186
      t191 = l3*t3
      t198 = s23r**2
      t205 = 6*z
      t212 = s34r**2
      t216 = -t5
      t217 = t216*l3
      t220 = 12*t1
      t226 = 6*t68
      t228 = 6*t185*t67
      t229 = 2*t185
      t230 = 8*t186
      t248 = 4*z
      t249 = t184-t248
      t257 = t212*s34r
      t267 = -t2
      t275 = 6144*t44*t173*t82+(-12288*t68*t177*s23r-18432*t44*t173*s34r
     #-3072*(-t184+t187+t111-4*t185)*t5*t191)*t10*t11*t23+(12288*t68*t3*
     #t198+(18432*t68*t177*s34r+3072*(-t205+t112)*l3*t3)*s23r+18432*t44*
     #t173*t212+3072*t217*t3*(8*t185-12*t186+t220-t205)*s34r-3072*(t226-
     #t228-t229-t149+t230)*t2)*l1*r*t42+(-6144*t68*t3*s34r-12288*t61*l3)
     #*t198+(-6144*t68*t177*t212-3072*t191*t249*s34r-3072*t165)*s23r-614
     #4*t68*t6*t4*t257-3072*l3*t5*t29*t249*t212-3072*t267*(t111-t229-t18
     #4+t230-t228+t226)*s34r+6144*t1-6144*t186+6144*t185
      t277 = t67*l3
      t286 = t7*t4*t3
      t287 = t277*z
      t291 = z+1
      t301 = t4*t277
      t312 = 3*z
      t315 = t30*t67
      t328 = t44*t67
      t329 = -l3+t1-z
      t337 = t1*t29
      t381 = 5*z
      t382 = 6*l3
      t388 = 6*t67
      t441 = 5*t1
      t463 = 1+u
      t464 = t463**2
      t465 = 1/t464
      t467 = t73*t
      t474 = t11*l1
      t476 = t**2
      t483 = dsqrt(-l2*(1-l1)*(l2-1)*t14*r*(t11*t+t474*t+r+r*t476-t58-t5
     #8*t476+t+l1*t))
      t484 = l1*t483
      t488 = t11*l2
      t489 = dsqrt(l1)
      t490 = t489*t10
      t492 = t489*l1
      t495 = t11**2
      t496 = t495*r
      t499 = t11*t492
      t503 = t495*t11
      t504 = t503*t492
      t506 = t495*t73
      t509 = t495*l2
      t511 = t503*t489
      t514 = t495*t489
      t520 = t495*t492
      t523 = -4*t467*t484*l4+t488*t490-t73*t492*t-t496*t489*t-t499*l2-r*
     #t489*t-t504*l2-t506*t492*t+t509*t490+2*t511*l2+5*t514*l2-2*t496*t4
     #92*t-3*t520*l2
      t524 = t11*t483
      t530 = t11*t489
      t535 = r*t483
      t539 = t489*l2
      t541 = t476*t
      t542 = t496*t541
      t544 = t496*l2
      t545 = t490*t541
      t549 = t73*l2
      t550 = t492*t
      t552 = t73*t541
      t554 = r*l2
      t556 = t490*t
      t558 = -4*t524*l4-2*t73*t489*t+3*t530*l2-2*t474*t483+2*t535*t-t503
     #*t476*t539-t542*t539-t544*t545-t495*t476*t539+t549*t550-t552*t539-
     #t554*t550-t554*t556
      t561 = t490*t476
      t569 = t492*l2
      t574 = t492*t476
      t589 = t503*l2*t561-t549*t545+3*t544*t550+2*t496*t*t539+2*t542*t56
     #9-2*t544*t556-2*t509*t574+3*t509*t561+5*t467*t539+2*t552*t569-3*t5
     #49*t556-2*t488*t574+2*t488*t561
      t605 = 3*t19*t539+2*t467*t484+4*t474*t483*l4-4*t535*l4*t+t506*l2*t
     #550+t569-t530-t511+t504+t499-2*t514+2*t520+2*t524
      t607 = t523+t558+t589+t605
      t608 = t607**2
      t610 = t11+t19+l1-t58*t
      t611 = t610**2
      t626 = s34spinc(z,l1,l2,l3,l4,l5,l6,l7,l8)
      s2 = (-3072*t1*t8*t10*t11*t23+(3072*t1*t8*s34r+3072*t30*t32*t6)*l1
     #*r*t42-3072*t47-3072*t49*t6)*t53+((-6144*t1*t55*s23r*t58*t42+6144*
     #t61*l3*s23r)*s1l1+3072*t68*t70*t82+(-12288*t1*t85*s2l1-3072*t68*t7
     #0*s34r-12288*t93+3072*t1*t85*(t95-t96-2))*t10*t11*t23+(6144*t1*t3*
     #t5*s2l1*s23r+(6144*t47-3072*t55*t113)*s2l1+(6144*t93-3072*t1*t85*(
     #-1-t119+t31))*s34r-3072*t55*t113*s3l1-3072*t130*t3*(t131-t132+1-t1
     #33))*l1*r*t42-6144*t61*l3*s2l1*s23r+(-6144*t1*t55*s34r+3072*t2*t15
     #0)*s2l1+(-6144*t1*t55*s3l1+3072*t1*t55*(l3-t1-1))*s34r-3072*t165*s
     #3l1+3072*t61*(1-t31+t67-t68))*s13r+t275*s1l1
      s3 = s2+(-3072*t44*t69*t277*s23r+6144*t44*t173*s2l1-6144*t286*t287
     #*s34r+6144*t6*t291*t68*t4)*t72*t73*t81
      s4 = s3+(-3072*t216*z*t301*t198+(6144*t287*t69*t6*s34r+6144*t68*t1
     #77*s3l1-3072*(-1+t312-t96+t95)*t5*t315)*s23r-3072*(-t229+t248-t184
     #+t187)*t5*t191*s2l1+9216*t287*t286*t212+18432*t328*t4*t329*s34r-92
     #16*t32*t5*t291*t337)*t10*t11*t23
      s1 = s4+((-3072*t301*t130*s34r-3072*(t119-t312-t31+1)*t3*t68)*t198
     #+(-3072*t277*t6*t69*z*t212+3072*t315*t5*(-t149+t248-1+t132)*s34r-3
     #072*t164*l3*t3*s3l1+3072*(-t312-t133+t131-t31+t184)*z*t191)*s23r+(
     #-6144*t217*t49*s34r-3072*(t111+4*t186-t112+t226-t228)*t2)*s2l1-307
     #2*t287*t286*t257-3072*t328*t4*(t184-t381-t382+1)*t212-3072*t337*t5
     #*(-t220+t381+1+t226-t388)*s34r+3072*(t388+1-t382)*t291*t49)*l1*r*t
     #42+(3072*t68*t3*t329*s34r+3072*(-l3+t1-t111)*l3*t61)*t198
      taux2 = s1+(3072*t315*t5*t329*t212-3072*t1*t3*(-t111-2*t68+t149+2*
     #t67-l3)*s34r+6144*t61*l3*s3l1-3072*(-t68+t67+t119-z)*t2*z)*s23r+(6
     #144*t267*l3*z*s34r+6144*t1-6144*t186-6144*z)*s2l1+3072*t328*t4*t32
     #9*t257+3072*t337*t5*(l3+t111-t131+t133-t441)*t212+3072*t49*(-t226+
     #t441+2*t287-z-2*t277+l3)*s34r-3072*t32*t2*z*t291+3072*z*(z+2*s2l1)
     #/r*t39*t41*t465*t608/t611-6144*z*t465*(1+l1*l3*r*t267*t463*t39*t41
     #)*t626*t607/t610

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = t2*l3
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = t2*l3
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet2 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff2)

CCC Sum

      rm1num1e0 = tFjet1*tcoff1+tFjet2*tcoff2
      RETURN
      END

      double precision function rm1num1e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3**2
      t2 = t1*l3
      t3 = -1+z
      t4 = t3**2
      t5 = t4**2
      t6 = t2*t5
      t7 = l3-1
      t8 = z*t7
      t9 = s23r**2
      t11 = t6*t8*t9
      t13 = z*t2
      t14 = t3*t5
      t15 = t7**2
      t18 = t13*t14*t15*s34r
      t19 = z+1
      t21 = t4*t3
      t22 = t21*z
      t23 = t22*t1
      t24 = t19*t7*t23
      t28 = t15*z
      t29 = t1*t5
      t31 = t28*t29*s34r
      t34 = l1**2
      t36 = r**2
      t38 = 1+t36
      t39 = t38**2
      t40 = r+t
      t41 = t40**2
      t44 = r*t
      t45 = 1+t44
      t46 = t45**2
      t48 = t39/t41/t46
      t51 = t6*t8*s34r
      t52 = z*l3
      t53 = 2*t52
      t54 = 3*z
      t55 = 2*l3
      t56 = t53-t54-t55+1
      t58 = z*t1
      t64 = t14*z
      t65 = s34r**2
      t67 = t2*t15*t64*t65
      t68 = t53-t54-t55
      t72 = 2*z
      t75 = t4*z
      t76 = (-1+t53+t55-t72)*l3*t75
      t81 = t28*t29*t65
      t82 = 192*t81
      t83 = t52*t21
      t84 = t55-1
      t92 = 1/t40
      t94 = 1/t45
      t95 = t38*t92*t94
      t101 = t1*t15
      t102 = t5*s3l1
      t106 = t15*t7
      t108 = t106*t5*t4
      t112 = s3l1**2
      t114 = t101*t5*t112
      t116 = t84*t15
      t121 = t34*l1
      t123 = t36*r
      t131 = t39*t38/t41/t40/t46/t45
      t135 = 32*t52
      t136 = 11*l3
      t145 = t21*t7
      t149 = 3*l3
      t150 = 3*t52
      t153 = t1*t21
      t161 = t101*t5*s34r
      t162 = t4*t7
      t163 = t52*t162
      t166 = s2l1**2
      t168 = t101*t102
      t169 = t28*t29
      t175 = t162*s3l1
      t178 = t19*z
      t179 = l3*t7
      t180 = t179*t4
      t182 = 1536*t178*t180
      t199 = 6*t52
      t206 = 1536*t52*t175
      t209 = z**2
      t210 = t209*l3
      t214 = t209*t1
      t216 = 4*z
      t234 = 8*t52
      t235 = 12*z
      t238 = (t234-t235-8*l3+4)*t4
      t247 = 4*t52
      t248 = 4*l3
      t257 = l3*t4
      t261 = 3*t1
      t262 = 3*t58
      t270 = -t55+t53-z
      t271 = t4*t270
      t275 = t84*t3*z
      t294 = 1536*(t53+t55-1-z)*t3*z
      t297 = t65*s34r
      t301 = t28*t1
      t332 = z*t3
      t335 = 1536*t332*t84*s3l1
      t340 = 2*t209
      t356 = t1*t4
      t360 = t145*t1*s34r
      t365 = t101*t5*t65
      t377 = t356*s34r
      t379 = l3*t3
      t385 = 1536*t145*t1*t65
      t386 = t4*s34r
      t387 = t179*t386
      t389 = t3*t7
      t396 = t21*t15
      t406 = s1l1**2
      t409 = t121*t123*t131
      t416 = t145*t1*s3l1
      t418 = t58*t145
      t423 = 3072*t163
      t441 = t84*l3
      t449 = t4*s3l1
      t484 = t332*l3
      t492 = t58*t145*t65
      t498 = t379*s3l1
      t515 = l3*t21
      t530 = t52-l3+1
      t533 = 1536*t178
      s1 = -1536*t168*t409+((1536*t145*t1*s2l1+6144*t416-1536*t418)*s23r
     #+(-1536*t161+t423)*s2l1+(3072*t168-1536*t169)*s34r+1536*(-t149+t15
     #0+2-z)*l3*t175+t182)*t34*t36*t48+(3072*t58*t4*t9+((-1536*t360-1536
     #*t441*t4)*s2l1+(-3072*t416+3072*t418)*s34r-6144*t441*t449+t423)*s2
     #3r+(1536*t365+384*t179*t238*s34r-3072*t275)*s2l1+(-1536*t168+3072*
     #t169)*t65+(-1536*t179*t4*(t247-t248-z+2)*s3l1+1536*t52*t162*t56)*s
     #34r-1536*(-t261+t262-1+t248-t53)*t3*s3l1-t294)*l1*r*t95+(-1536*t58
     #*t386-3072*t484)*t9+((1536*t377+1536*t379)*s2l1-1536*t492+(3072*t3
     #56*s3l1-3072*t163)*s34r+6144*t498-1536*t332*t7)*s23r
      t534 = s1+(-t385-384*t379*(t247-t248-t235+4)*s34r+3072*z)*s2l1-153
     #6*t58*t15*t5*t297+(1536*t416-3072*t515*t8*t7)*t65+(1536*t379*(t53-
     #z-t55+2)*s3l1-1536*t332*(-t150+z+l3-1+t58-t1))*s34r+1536*t530*s3l1
     #+t533
      t536 = t5*t106
      t539 = t34*t36*t48
      t540 = t52*t536*t539
      t545 = t52*t536*s34r+t22*t116
      t551 = t28*t515*s34r
      t553 = t75*t15
      t556 = s13r**2
      t559 = t28*t29*s23r
      t561 = t14*t106
      t564 = 192*t58*t561*s34r
      t566 = t52*t396*t19
      t574 = t52*t162*(-t55+t53+1-t72)
      t579 = t58*t561*t65
      t587 = t8*t4*(t53+t55-1)
      t594 = t58*t145*s34r
      t597 = t332*l3*(-t72+t52+1-l3)
      t602 = -l3+t52-z
      t603 = t7*t602
      t608 = t332*(t52-1+l3)
      t613 = t23*t603*t65
      t616 = t4*(-t150+t58-t1+t72)
      t620 = 2*t1
      t630 = 1536*t332*l3*s3l1
      t637 = (t52+l3-z)*t3*z
      t652 = t58*t4*t602*s34r+(-l3+t52-t72)*l3*t332
      s2 = (-192*t11+(-192*t18+192*t24)*s23r+192*t31)*t34*t36*t48+((192*
     #t51+192*t56*t4*t58)*t9+(192*t67+192*t23*t7*t68*s34r-192*t76)*s23r-
     #t82-192*t83*t84*t7*s34r)*l1*r*t95+(-768*t28*t14*t2*s23r+1536*t101*
     #t102*s2l1-3072*t108*t13*s34r+3072*t114-3072*t116*t64*t1)*t121*t123
     #*t131
      s3 = s2-192*t83*t7*(-16*t58+16*t1+t135-t136-16*z)*t65
      s4 = s3+(1728*t11+(2496*t18+1536*t58*t145*s3l1+768*(1-t54-t149+t15
     #0)*z*t153*t7-960*t24)*s23r+(-1536*t161+1536*t163)*t166+((-1536*t16
     #8-1536*t169)*s34r-1536*(-t149+t150-t72+1)*l3*t175+t182)*s2l1+3072*
     #t13*t108*t65+(-1536*t114+192*t28*t29*(48*t52-48*l3-40*z+19))*s34r-
     #1536*(-6*l3+t199-t54+2)*l3*t162*t112+t206-768*(12*l3-24*t52+12*t21
     #0-12*t1+24*t58-12*t214+t216-4*t209-4)*z*t180)*t34*t36*t48
      s5 = s4
      s7 = ((-1728*t51+192*(-10*t52+15*z+10*l3-5)*t4*t58-192*t238*t58)*t
     #9+(-1728*t67+192*(-5*t58*t145*t68+4*t58*t145*(-t247+t216-1+t248))*
     #s34r-1536*t84*z*t257*s3l1-768*(t54-t261+t262+t55-t199)*z*t257+960*
     #t76)*s23r+(1536*t179*t271*s34r-1536*t275)*t166+((1536*t179*t271*s3
     #l1+1536*t52*t162*(-t55+t53-z-1))*s34r+1536*(-t261+t262-t247+z+t55)
     #*t3*s3l1-t294)*s2l1-1536*t13*t108*t297+192*t301*t5*(-t135+32*l3+32
     #*z-11)*t65+(1536*t179*t271*t112-t206-192*t52*t162*(48*t214-96*t58+
     #48*t1-80*t210+118*t52-38*l3+11+32*t209-27*z))*s34r+1536*(-6*t1+6*t
     #58+z-t199+t248)*t3*t112-t335+768*t84*(-4*t1-4*t214+8*t58+t248+4*t2
     #10-t234-t340-2)*t332)*l1*r*t95
      s8 = ((-1536*t153*t7*s23r-1536*t161+1536*t163)*t34*t36*t48+(3072*t
     #356*t9+(3072*t360+3072*t180)*s23r+3072*t365+1536*t179*t4*(-t55+t53
     #+2-t54)*s34r-1536*t275)*l1*r*t95+(-1536*t377-3072*t379)*t9+(-t385-
     #3072*t387-1536*t389)*s23r-1536*t101*t5*t297-3072*t396*l3*t65-1536*
     #t3*(-t150+z+t58-t1+t55-1)*s34r+1536*z)*t406
      s6 = s7+s8
      s1 = s5+s6
      t663 = s1+t534*s1l1+(-192*t540+192*t545*l1*r*t95-192*t551-192*t553
     #)*t556+((384*t559+t564-192*t566)*t34*t36*t48+((-384*t31-384*t574)*
     #s23r-192*t579-192*t83*t15*t270*s34r+192*t587)*l1*r*t95+(384*t594+3
     #84*t597)*s23r+t82+192*t52*t4*t603*s34r-192*t608)*s13r+(1728*t613-1
     #92*(-5*t52*t616+4*t52*t4*(-t72-2*t58+t247+t620-l3))*s34r+t630+768*
     #(-t1+t58-t53+z)*t3*z-960*t637)*s23r+(-192*t613-192*t52*t616*s34r+1
     #92*t637)*s23r+1536*t652*t9+(-1536*t379*t602*s34r+1536*z)*t166
      t678 = -32*t13+59*t58-40*t214+16*t209*t2-27*t52+32*t210+8*z+16*t2+
     #t136-8*t209-19*t1
      t689 = t602*s3l1
      t741 = 1536*t484
      t764 = t52*t396*s3l1
      s1 = (-1536*t515*t15*s2l1*t539+((3072*t179*t4*s2l1+1536*t163)*s23r
     #+(1536*t515*t15*s34r+1536*t4*t84*t7)*s2l1)*l1*r*t95+(-3072*t379*s2
     #l1-t741)*s23r+(-1536*t387-1536*t389)*s2l1)*s1l1-768*t58*t561*t409+
     #(-1920*t559+1536*t515*t15*t166+(3072*t515*t15*s3l1+1536*t52*t396)*
     #s2l1-t564+3072*t764+960*t566-768*t52*t396*(t149-t150-2))*t34*t36*t
     #48+((1536*t52*t162*s2l1+1920*t31+1920*t574)*s23r-3072*t179*t4*t166
     #+(-6144*t179*t449-t423)*s2l1+960*t579+(-1536*t764+960*t52*t396*t27
     #0-768*t52*t396*(1-t55+t53))*s34r-1536*t75*(t248-1)*t7*s3l1-960*t58
     #7+768*t8*t4*(t261-t248+1-t262))*l1*r*t95+(-1536*t332*l3*s2l1-1920*
     #t594-1920*t597)*s23r+1536*t379*t166
      t839 = s1+(3072*t498+t741)*s2l1-960*t81+(t206-960*t52*t162*t602+76
     #8*t52*t162*t530)*s34r+t335+960*t608-768*t332*(1-t55+t1-t58)
      t846 = 1+u
      t851 = 1-l1*l3*r*t3*t846*t92*t94
      t853 = s34spinc(z,l1,l2,l3,l4,l5,l6,l7,l8)
      t855 = t846**2
      t856 = 1/t855
      t857 = t123*t
      t864 = t36*l1
      t866 = t**2
      t868 = l1*r
      t874 = dsqrt(-l2*(1-l1)*(l2-1)*t39*r*(t36*t+t864*t+r+r*t866-t868-t
     #868*t866+t+l1*t))
      t875 = l1*t874
      t879 = t36**2
      t880 = t879*t36
      t882 = dsqrt(l1)
      t883 = t882*l2
      t885 = t879*r
      t886 = t866*t
      t887 = t885*t886
      t889 = t885*l2
      t890 = t882*t34
      t891 = t890*t886
      t895 = t123*l2
      t896 = t882*l1
      t897 = t896*t
      t899 = t123*t886
      t901 = r*l2
      t903 = t890*t
      t906 = t890*t866
      t914 = -4*t857*t875*l4-t880*t866*t883-t887*t883-t889*t891-t879*t86
     #6*t883+t895*t897-t899*t883-t901*t897-t901*t903+t880*l2*t906-t895*t
     #891+3*t889*t897+2*t885*t*t883
      t915 = t896*l2
      t920 = t879*l2
      t921 = t896*t866
      t932 = t36*l2
      t944 = r*t874
      t948 = 2*t887*t915-2*t889*t903-2*t920*t921+3*t920*t906+5*t857*t883
     #+2*t899*t915-3*t895*t903-2*t932*t921+2*t932*t906+3*t44*t883+2*t857
     #*t875+4*t864*t874*l4-4*t944*l4*t
      t950 = t879*t123
      t958 = t36*t896
      t962 = t880*t896
      t967 = t880*t882
      t970 = t879*t882
      t976 = t879*t896
      t979 = t950*l2*t897+t932*t890-t123*t896*t-t885*t882*t-t958*l2-r*t8
     #82*t-t962*l2-t950*t896*t+t920*t890+2*t967*l2+5*t970*l2-2*t885*t896
     #*t-3*t976*l2
      t980 = t36*t874
      t986 = t36*t882
      t996 = -4*t980*l4-2*t123*t882*t+3*t986*l2-2*t864*t874+2*t944*t+t91
     #5-t986-t967+t962+t958-2*t970+2*t976+2*t980
      t998 = t914+t948+t979+t996
      t1001 = t36+t44+l1-t868*t
      t1006 = t851**2
      t1007 = t853**2
      t1019 = t34**2
      t1021 = t39**2
      t1022 = t41**2
      t1025 = t46**2
      t1036 = 1/r
      t1040 = t998**2
      t1041 = t1001**2
      t1044 = t94*t856*t1040/t1041
      t1051 = (-1536*t379*t602*t112+t630+192*t332*t678)*s34r-768*(-t620-
     #2*t214+4*t58+t55+2*t210-t247-t340-2)*z+((-1536*t379*t689-1536*t332
     #*l3*(-l3+t52-z-1))*s34r-1536*t689+t533)*s2l1+(1728*t540-1728*t545*
     #l1*r*t95+1728*t551+1728*t553)*t556-1536*t270*t112+192*t492+192*t52
     #*t162*s34r+1536*s3l1*z+t839*s13r+1536*(z+2*s2l1)*t851*t853*t856*t9
     #98/t1001-1536*t1006*t1007*r*t40*t45*t856+1536*t301*t5*t602*t297+15
     #36*t108*t13*t1019*t879*t1021/t1022/t1025+192*(-9*t209-8*t166-8*z*s
     #2l1)*t1036*t92*t1044+192*t209*t1036*t92*t1044
      taux1 = t663+t1051
      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = -1+z
      t5 = t4**2
      t6 = t5**2
      t7 = t3*t6
      t8 = l1**2
      t11 = r**2
      t12 = 1+t11
      t13 = t12**2
      t15 = r+t
      t16 = t15**2
      t17 = 1/t16
      t18 = r*t
      t19 = 1+t18
      t20 = t19**2
      t21 = 1/t20
      t27 = t7*l3*s34r
      t28 = t5*t4
      t29 = 4*l3
      t37 = 1/t15
      t39 = 1/t19
      t40 = t12*t37*t39
      t42 = l3*t28
      t44 = t42*t2*s34r
      t46 = 2*l3
      t47 = t46-1
      t53 = z*l3
      t57 = t13*t17*t21
      t61 = t2*t28
      t68 = t53*t61
      t78 = t1*t5
      t82 = t2*z
      t84 = t82*t42*s34r
      t86 = t53*t78
      t88 = z*t5
      t92 = s13r**2
      t94 = l3**2
      t95 = t6*t4
      t96 = t94*t95
      t97 = t8*l1
      t100 = t11*r
      t101 = t13*t12
      t104 = 1/t16/t15
      t106 = 1/t20/t19
      t111 = t94*t2
      t115 = t3*s34r
      t118 = 3*l3
      t119 = 3*t53
      t128 = t6*s34r
      t129 = t111*t128
      t131 = l3*t1
      t132 = 5*l3
      t133 = 3*z
      t134 = 5*t53
      t139 = 18432*t86
      t142 = s34r**2
      t143 = t3*t142
      t145 = 3072*t96*t143
      t146 = 4*t53
      t152 = 3*t94
      t153 = z*t94
      t154 = 3*t153
      t155 = 2*t53
      t163 = t1*t28
      t165 = t163*t94*s34r
      t167 = t4*l3
      t168 = 6*z
      t172 = z*t4
      t174 = 18432*t172*l3
      t179 = 3072*t111*t6*t142
      t194 = t3*s3l1
      t195 = t96*t194
      t199 = 12288*t153*t95*t3
      t204 = t101*t104*t106
      t206 = t6*s2l1
      t209 = t94*t6
      t210 = t82*t209
      t217 = 12*t68
      t224 = 1-t133-t118+t119
      t252 = t118-1
      t263 = 2*z
      t264 = 8*t53
      t265 = t263-t264
      t273 = t155+1-z-t46
      t280 = t53-l3
      t291 = 6*t53
      t300 = z*t1
      t322 = t118-2
      t334 = -t4
      t335 = 3*t334
      t336 = -t146+t263
      t341 = t6*s3l1
      t345 = t53+1-l3-z
      s2 = (-3072*t96*t3*t97*t100*t101*t104*t106+(15360*t111*t6*s23r+614
     #4*t96*t115+3072*t61*l3*(-t118+t119-z))*t8*t11*t57+((-9216*t129-614
     #4*t131*t5*(-t132-t133+2+t134)+t139)*s23r-t145-3072*t61*l3*(t146-t2
     #9-z)*s34r-3072*t78*(-t152+t154-t155+1))*l1*r*t40+(9216*t165+3072*t
     #167*(-t168-t132+4+t134)-t174)*s23r+t179+3072*t131*t5*(-t46+t155-z)
     #*s34r+3072*t4*t1*(-l3+t53-1))*s1l1+(-3072*t96*t3*s2l1+3072*t195-t1
     #99)*t97*t100*t204
      s3 = s2+((3072*t111*t206+9216*t210)*s23r+3072*(t61*l3*(t119+z+2-t1
     #18)+t217)*s2l1+(-6144*t195+t199)*s34r-3072*(t61*l3*t224-t217)*s3l1
     #+3072*t53*t61*(1-t118+t119)-9216*t53*t61*(t118-t119-2))*t8*t11*t57
      s1 = s3+(((3072*t129-6144*t131*t5*(-l3+t53+z)-t139)*s2l1-3072*t82*
     #t209*s34r-6144*t42*z*t252*t1)*s23r+(t145-21504*t84-3072*t78*(t154-
     #t152-1+t155+t29)+9216*t78*t265)*s2l1+3072*t96*t194*t142+(6144*(t61
     #*l3*t273-3*t68)*s3l1-6144*t53*t61*t280+9216*t53*t61*(-1-t155+t46))
     #*s34r+3072*(t78*(t154+z-1+t46-t291-t152)+3*t78*t265)*s3l1-3072*t30
     #0*t5*(t154-t152+t46)+9216*t300*t5*(t152-t29+1-t154))*l1*r*t40+((-3
     #072*t165+3072*t167*(t53+t263-l3)+t174)*s2l1+3072*t153*t163*s34r+30
     #72*t53*t5*t322)*s23r
      t374 = s1+(-t179+21504*t53*t78*s34r+3072*t4*(t153+t46-1+t53-t94)+3
     #072*t335*t336)*s2l1-3072*t111*t341*t142+(-6144*(t131*t5*t345-3*t86
     #)*s3l1+3072*t53*t78*t280-9216*t53*t78*(l3-t53-1))*s34r-3072*(t4*(-
     #t119+z+l3-1+t153-t94)-t335*t336)*s3l1+3072*t172*(t153+l3-t94)-9216
     #*t172*(1-t46+t94-t153)
      t376 = t94*l3
      t377 = t2*t376
      t380 = t6*t5
      t381 = t376*t380
      t382 = t381*t115
      t387 = (8*t82+t2*t4)*t94*t6
      t393 = t376*t1
      t394 = s23r**2
      t399 = t377*t95*s34r
      t402 = 4*z
      t411 = t381*t143
      t417 = 12*t210
      t421 = z**2
      t422 = t421*l3
      t423 = 6*t422
      t424 = 4*t421
      t428 = 15*t422
      t429 = 9*z
      t431 = 18*t53
      t445 = 6*l3
      t455 = t94*t1
      t456 = 7*z
      t460 = -t1
      t462 = 3*t460*t28
      t463 = t462*t153
      t476 = t142*s34r
      t487 = t460*l3
      t489 = 6*t153
      t492 = t421*t94
      t493 = 3*t492
      t499 = 2*l3*t1
      t500 = 8*t421
      t502 = 12*t53
      t509 = 30*t153
      t510 = 27*t492
      t520 = t94*t5
      t521 = -l3+t53-z
      t540 = l3*t5
      t544 = t291-t402
      t551 = 8*z
      t565 = 2*t94
      t566 = 2*t153
      t577 = t376*z
      t578 = 2*t577
      t584 = -t402+t578-t421*t376-17*t422+15*t492+17*t53+t424+t152-t46-t
     #376-18*t153
      t586 = 2*t4
      t587 = 2*t421
      t595 = 30720*t53
      t596 = 27648*t422
      t598 = 3072*l3
      s3 = (3072*t377*t95*s23r+3072*t382-3072*t387)*t97*t100*t204
      s4 = (-9216*t393*t6*t394+(-9216*t399-3072*(-12*t300+(t119-t402+1-t
     #118)*t1)*t28*t94)*s23r-6144*t411-3072*(-t111*t6*(t118-3+15*z-t119)
     #-t417)*s34r+3072*(2*(-t291+t423+t263-t424)*t1-(2-t428-t118-t429+9*
     #t421+t431)*t1)*l3*t5)*t8*t11*t57+((6144*t393*t128+3072*(-19*z+3-t4
     #45+t291)*t94*t5)*t394+(6144*t377*t95*t142+3072*(t455*t28*(t291+2-t
     #456-t445)+6*t463)*s34r+3072*(23*z-32*t53+t154+t46-t152)*l3*t5)*s23
     #r+3072*t381*t3*t476+3072*(-t111*t6*(t29+14*z-2-t146)-t417)*t142+30
     #72*(t487*t5*(-36*t53+t489-t152-2+t445-17*t421+30*t422-t493+17*z)+t
     #499*t5*(t500-12*t422+t502-t168))*s34r-3072*(-t509+t510+t500+26*t53
     #-34*t422+t152+1-t133-t29)*t4)*l1*r*t40
      s2 = s3+s4
      s1 = s2+(-6144*(t520*t521-3*t153*t5)*s34r-3072*(-16*z-t118+t119)*t
     #4*l3)*t394+(-6144*(t455*t28*t521+t463)*t142-3072*(t540*(t402-t152+
     #t46-7*t53+t154)-3*t540*t544)*s34r-3072*(-15*t53+t551+t153-t94)*t4)
     #*s23r-3072*(-t111*t6*(-t53+t402+l3)-4*t210)*t476-3072*(-t131*t28*(
     #14*t53+t565-t551-t566-t46)-2*t131*t28*t544)*t142
      t600 = s1-3072-3072*(t334*t584+t586*(t263-t587-t291+8*t422-6*t492+
     #t489))*s34r-t595+t596-24576*t421+t598+9216*z
      t607 = 3072*t377*t95*s3l1
      t609 = t577*t95*t2
      t616 = t3*t380
      t620 = t111*t341
      t622 = z+1
      t625 = -t263-1
      t638 = t6*t376
      t657 = t94*s3l1
      t672 = -t345
      t693 = -t146+t402-1+t29
      t707 = t47*t1
      t731 = 10*z
      t770 = 12*t94
      t771 = 12*t153
      t773 = 24*t53
      t784 = 5*z
      t822 = 6*t94
      t829 = -t822-1+t445
      t833 = -t829
      t861 = -z+t53+2-l3
      t928 = 10*t53
      t953 = t47*t4
      t965 = 1/r
      t968 = 1+u
      t969 = t968**2
      t970 = 1/t969
      t972 = t11*l2
      t973 = dsqrt(l1)
      t974 = t973*t8
      t976 = t973*l1
      t979 = t11**2
      t980 = t979*r
      t983 = t11*t976
      t987 = t979*t11
      t988 = t987*t976
      t990 = t979*t100
      t993 = t979*l2
      t995 = t987*t973
      t998 = t979*t973
      t1004 = t979*t976
      t1013 = t11*l1
      t1015 = t**2
      t1017 = l1*r
      t1023 = dsqrt(-l2*(1-l1)*(l2-1)*t13*r*(t11*t+t1013*t+r+r*t1015-t10
     #17-t1017*t1015+t+l1*t))
      t1024 = t11*t1023
      t1027 = t972*t974-t100*t976*t-t980*t973*t-t983*l2-r*t973*t-t988*l2
     #-t990*t976*t+t993*t974+2*t995*l2+5*t998*l2-2*t980*t976*t-3*t1004*l
     #2-4*t1024*l4
      t1031 = t11*t973
      t1036 = r*t1023
      t1039 = t976*l2
      t1043 = t100*t
      t1044 = l1*t1023
      t1048 = -2*t100*t973*t+3*t1031*l2-2*t1013*t1023+2*t1036*t+t1039-t1
     #031-t995+t988+t983-2*t998+2*t1004+2*t1024-4*t1043*t1044*l4
      t1051 = t973*l2
      t1053 = t1015*t
      t1054 = t980*t1053
      t1056 = t980*l2
      t1057 = t974*t1053
      t1061 = t100*l2
      t1062 = t976*t
      t1064 = t100*t1053
      t1066 = r*l2
      t1068 = t974*t
      t1071 = t974*t1015
      t1081 = -t987*t1015*t1051-t1054*t1051-t1056*t1057-t979*t1015*t1051
     #+t1061*t1062-t1064*t1051-t1066*t1062-t1066*t1068+t987*l2*t1071-t10
     #61*t1057+3*t1056*t1062+2*t980*t*t1051+2*t1054*t1039
      t1084 = t976*t1015
      t1111 = -2*t1056*t1068-2*t993*t1084+3*t993*t1071+5*t1043*t1051+2*t
     #1064*t1039-3*t1061*t1068-2*t972*t1084+2*t972*t1071+3*t18*t1051+2*t
     #1043*t1044+4*t1013*t1023*l4-4*t1036*l4*t+t990*l2*t1062
      t1113 = t1027+t1048+t1081+t1111
      t1114 = t1113**2
      t1116 = t11+t18+l1-t1017*t
      t1117 = t1116**2
      t1123 = l3*s1vr
      t1128 = t19*t970
      t1135 = 1+l1*l3*r*t334*t968*t37*t39
      t1136 = s34spinc(z,l1,l2,l3,l4,l5,l6,l7,l8)
      t1141 = s34spinc2(z,l1,l2,l3,l4,l5,l6,l7,l8)
      s2 = ((-6144*t7*l3*t8*t11*t13*t17*t21+(3072*t27+3072*t28*(t29-1)*t
     #2)*l1*r*t40-3072*t44-3072*t5*t47*t1)*s1l1+6144*t53*t7*t8*t11*t57+(
     #(-3072*t27+3072*t61)*s2l1-9216*t53*t7*s34r+6144*t68-9216*z*t28*t47
     #*t2)*l1*r*t40+(3072*t44-3072*t78)*s2l1+9216*t84-3072*t86+9216*t88*
     #t2)*t92+t374*s13r+t600*s1l1+((3072*t377*t95*s2l1-t607+12288*t609)*
     #s23r+(3072*t382-3072*t387)*s2l1+24576*t616*t577*s34r+6144*t620-614
     #4*(2*t2*t622-t2*t625)*z*t209)*t97*t100*t204
      s3 = s2+((-3072*t393*t206-15360*z*t1*t638)*t394+((-3072*t399-3072*
     #(-t263+3-t118+t119)*t94*t163)*s2l1+(t607-24576*t609)*s34r+3072*(-6
     #*t300+(-1-t133-t118+t119)*t1)*t28*t657-3072*(3*t224*t1+(2-t133-t11
     #8+t119)*t1)*z*t28*t94)*s23r+(-3072*t411+9216*t111*t6*t672*s34r+307
     #2*(2*(-t587+t402-t291+t423)*t1-(-t428+1+6*t421-t429+t431-t118)*t1)
     #*l3*t5)*s2l1-36864*t577*t616*t142+(-9216*t620+9216*t82*t209*t693-3
     #6864*t82*t209*t521)*s34r-9216*t47*l3*t163*s3l1+9216*(2*t707*t622-t
     #707*t625)*z*t42)*t8*t11*t57
      s5 = s3
      s9 = (3072*t47*t28*t94*s2l1+12288*t638*t300*s34r+3072*(t155-t133-t
     #46+1)*t5*t153-3072*(8*l3-t264-4+t731)*t5*t153)*t394+((3072*t455*t2
     #8*(t155-z-t46+2)*s34r+3072*(-2+z-t146+t445-t152+t154)*l3*t5)*s2l1+
     #12288*t377*t95*z*t142+(-3072*t455*t28*(-t46+t155-z-1)*s3l1+3072*t1
     #53*t163*(-t29-t402+2+t146)+3072*t462*t153*t693)*s34r-3072*(-t431+t
     #551+2+t154-t46-t152)*l3*t5*s3l1+3072*(12*z-t770+t771+10*l3-t773-1)
     #*z*t540)*s23r+(3072*t111*t6*t273*t142+3072*(t487*t5*(-t502-1-t587+
     #t784+t445+t489-t152+t423-t493)-2*t499*t88)*s34r-3072*(-t456-20*t42
     #2+34*t53-t509+t510+t421-t46+t152)*t4)*s2l1+12288*t577*t616*t476
      s8 = s9+(3072*t620-3072*t82*t209*(-t502+12*l3+t731-3)+6144*t82*t20
     #9*(t291-t784-t445+1))*t142+(6144*t42*t252*t1*s3l1-3072*t42*t300*(-
     #t445-t771+t770+t773-t731)+6144*t42*t300*(-t502+t784+1+t489-t822))*
     #s34r-3072*t829*t5*s3l1-3072*(2*t833*t622-t833*t625)*z*t5
      s9 = l1
      s7 = s8*s9
      s8 = r*t40
      s6 = s7*s8
      s4 = s5+s6
      s1 = s4+(-3072*t520*s2l1-12288*t153*t5*t521*s34r-3072*(-l3+t53-t26
     #3)*l3*t172+3072*(t29-t146+t168)*l3*t172)*t394+((-3072*t520*t861*s3
     #4r-3072*t861*l3*t4)*s2l1-12288*t153*t28*t1*t521*t142+(3072*t520*(-
     #l3+t53-z-1)*s3l1-3072*t53*t5*(t566+t263-t565+t46-t146)+9216*t53*t5
     #*(-t263-t566+t146+t565-l3))*s34r+3072*(-t551+t53-2-l3)*t4*l3*s3l1+
     #9216*(-t153+t94+t155-z)*t4*z-3072*(-t94+t153+l3+z-t155)*t4*z)*s23r
      taux2 = s1+(3072*t455*t28*t672*t142-3072*(t334*l3*(3*t422-t94-t587
     #+t784-1+t118+t566-t492-t291)-2*t586*l3*z)*s34r-t595+t596+21504*z-3
     #072*t421+t598)*s2l1-12288*t82*t94*t6*t521*t476+(-3072*t163*t657+30
     #72*t42*t300*(-t489+t822-t118+t928-t402)-6144*t42*t300*(l3+t263-t15
     #2+t154-t134))*t142+(-3072*t540*t322*s3l1+3072*t88*(t263+t771-4*t57
     #7-t928-t152+4*t376)-6144*t88*(-t489+t134+t578-z-2*t376+l3))*s34r-3
     #072*t953*s3l1-3072*t953*z*t625+6144*t953*z*t622-12288*z*(z+2*s2l1)
     #*t965*t37*t39*t970*t1114/t1117-(-3072*(-t1123+t1123*z+t551)*r*t15*
     #t1128*t1135*t1136+3072*t4*s1vr*t1*t1141*r*t15*t1128*t1135)*t1113*t
     #39*t37/t1116*t965

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet2 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff2)

CCC Sum

      rm1num1e1 = tFjet1*tcoff1+tFjet2*tcoff2
      RETURN
      END

      double precision function rm1num1e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = z**2
      t4 = r+t
      t5 = 1/t4
      t7 = r*t
      t8 = 1+t7
      t9 = 1/t8
      t11 = (1+u)**2
      t14 = r**2
      t15 = t14**2
      t16 = t15*t14
      t17 = t**2
      t19 = dsqrt(l1)
      t20 = t19*l2
      t22 = t15*r
      t23 = t17*t
      t24 = t22*t23
      t26 = t22*l2
      t27 = l1**2
      t28 = t19*t27
      t29 = t28*t23
      t33 = t14*r
      t34 = t33*l2
      t35 = t19*l1
      t36 = t35*t
      t38 = t33*t23
      t40 = r*l2
      t42 = t28*t
      t45 = t28*t17
      t53 = t35*l2
      t56 = -t16*t17*t20-t24*t20-t26*t29-t15*t17*t20+t34*t36-t38*t20-t40
     #*t36-t40*t42+t16*l2*t45-t34*t29+3*t26*t36+2*t22*t*t20+2*t24*t53
      t59 = t15*l2
      t60 = t35*t17
      t65 = t33*t
      t72 = t14*l2
      t83 = 1+t14
      t84 = t83**2
      t87 = t14*l1
      t90 = l1*r
      t96 = dsqrt(-l2*(1-l1)*(l2-1)*t84*r*(t14*t+t87*t+r+r*t17-t90-t90*t
     #17+t+l1*t))
      t97 = l1*t96
      t106 = t15*t33
      t109 = -2*t26*t42-2*t59*t60+3*t59*t45+5*t65*t20+2*t38*t53-3*t34*t4
     #2-2*t72*t60+2*t72*t45+3*t7*t20+2*t65*t97+4*t87*t96*l4-4*t65*t97*l4
     #-t106*t35*t
      t112 = t16*t19
      t115 = t15*t19
      t121 = t15*t35
      t124 = t14*t96
      t130 = t14*t19
      t135 = r*t96
      t143 = t59*t28+2*t112*l2+5*t115*l2-2*t22*t35*t-3*t121*l2-4*t124*l4
     #-2*t33*t19*t+3*t130*l2-2*t87*t96+2*t135*t+t72*t28-t33*t35*t-t22*t1
     #9*t
      t144 = t14*t35
      t148 = t16*t35
      t158 = -t144*l2-r*t19*t-t148*l2+t53-t130-t112+t148+t144-2*t115+2*t
     #121+2*t124-4*t135*l4*t+t106*l2*t36
      t161 = (t56+t109+t143+t158)**2
      t164 = (t14+t7+l1-t90*t)**2
      t170 = -1+z
      t171 = t170**2
      t172 = t171*t170
      t173 = t172*l3
      t174 = t173*z
      t175 = l3-1
      t176 = l3**2
      t177 = z*t176
      t179 = 4*t176
      t180 = z*l3
      t182 = 8*l3
      t183 = 8*z
      t186 = s34r**2
      t190 = t176*l3
      t191 = t171**2
      t192 = t190*t191
      t193 = z*t175
      t194 = s23r**2
      t198 = z*t190
      t199 = t191*t170
      t200 = t175**2
      t204 = z+1
      t206 = t172*z
      t207 = t206*t176
      t212 = t200*t175
      t214 = t212*t191*t171
      t218 = t200*z
      t219 = t218*t176
      t225 = 2*z
      t226 = t1+1-t225
      t227 = t226*z
      t235 = t4**2
      t238 = t8**2
      t240 = t84/t235/t238
      t244 = 2*t180
      t245 = 3*z
      t246 = 2*l3
      t263 = t171*z
      t268 = t186*s34r
      t279 = t180*t171
      t280 = l3*t1
      t290 = t246-1
      t292 = t170*z
      t299 = t83*t5*t9
      t301 = t176*t191
      t305 = t199*t212
      t354 = -l3+t180-z
      t355 = t175*t354
      t398 = t191*t212
      t419 = s13r**2
      s2 = 768*t1/r*t5*t9/t11*t161/t164-192*t174*t175*(4*t177-t179-12*t1
     #80+t182+t183)*t186
      s3 = s2+(-768*t192*t193*t194+(-768*t198*t199*t200*s34r+768*t204*t1
     #75*t207)*s23r-768*t198*t214*t186+192*t219*t191*(t183-4)*s34r-768*t
     #227*l3*t171*t175)*t27*t14*t240
      s4 = s3
      s6 = ((768*t192*t193*s34r+768*(t244-t245-t246+1)*t171*t177)*t194+(
     #768*t190*t200*t199*z*t186+768*t207*t175*(t244-t245-t246)*s34r-768*
     #(-1+t244+t246-t225)*l3*t263)*s23r+768*t198*t214*t268+192*t219*t191
     #*(8*t180-t182-12*z+8)*t186-192*t279*t175*(16*t280-24*t180+t182-12*
     #t1-8+20*z)*s34r+768*t290*t226*t292)*l1*r*t299
      s7 = ((1536*t218*t301*s23r+768*t177*t305*s34r-768*t180*t172*t200*t
     #204)*t27*t14*t240+((-1536*t218*t301*s34r-1536*t180*t171*t175*(-t24
     #6+t244+1-t225))*s23r-768*t177*t305*t186-768*t174*t200*(-t246+t244-
     #z)*s34r+768*t193*t171*(t244+t246-1))*l1*r*t299+(1536*t177*t172*t17
     #5*s34r+1536*t292*l3*(-t225+t180+1-l3))*s23r+768*t218*t301*t186+768
     #*t279*t355*s34r-768*t292*(t180-1+l3))*s13r
      s5 = s6+s7
      s1 = s4+s5
      taux1 = s1+(-768*t207*t355*t186-768*t180*t171*(-3*t180+t177-t176+t
     #225)*s34r+768*(t180+l3-z)*t170*z)*s23r+(-768*t177*t171*t354*s34r-7
     #68*(-l3+t180-t225)*l3*t292)*t194+192*t292*(8*t1*t176-12*t177+20*t1
     #80-12*t280-t182+t179+4*t1-4*z)*s34r-768*t227+(-768*t180*t398*t27*t
     #14*t240+(768*t180*t398*s34r+768*t206*t290*t200)*l1*r*t299-768*t218
     #*t173*s34r-768*t263*t200)*t419-768*t219*t191*t354*t268
      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = -1+z
      t5 = t4**2
      t6 = t5**2
      t7 = t3*t6
      t8 = l1**2
      t11 = r**2
      t12 = 1+t11
      t13 = t12**2
      t15 = r+t
      t16 = t15**2
      t17 = 1/t16
      t18 = r*t
      t19 = 1+t18
      t20 = t19**2
      t21 = 1/t20
      t27 = t7*l3*s34r
      t28 = t5*t4
      t29 = 4*l3
      t37 = 1/t15
      t39 = 1/t19
      t40 = t12*t37*t39
      t42 = l3*t28
      t44 = t42*t2*s34r
      t46 = 2*l3
      t47 = t46-1
      t48 = t5*t47
      t53 = z*l3
      t57 = t13*t17*t21
      t61 = t2*t28
      t68 = t53*t61
      t78 = t1*t5
      t82 = t2*z
      t84 = t82*t42*s34r
      t86 = t53*t78
      t88 = z*t5
      t92 = s13r**2
      t94 = l3**2
      t95 = t6*t4
      t96 = t94*t95
      t97 = t8*l1
      t100 = t11*r
      t101 = t13*t12
      t104 = 1/t16/t15
      t106 = 1/t20/t19
      t111 = t94*t2
      t115 = t3*s34r
      t118 = 3*l3
      t119 = 3*t53
      t128 = t6*s34r
      t129 = t111*t128
      t131 = l3*t1
      t132 = 5*l3
      t133 = 3*z
      t134 = 5*t53
      t139 = 12288*t86
      t142 = s34r**2
      t143 = t3*t142
      t145 = 9216*t96*t143
      t146 = 4*t53
      t152 = 3*t94
      t153 = z*t94
      t154 = 3*t153
      t155 = 2*t53
      t163 = t1*t28
      t165 = t163*t94*s34r
      t167 = t4*l3
      t168 = 6*z
      t172 = z*t4
      t174 = 12288*t172*l3
      t179 = 9216*t111*t6*t142
      t194 = t3*s3l1
      t195 = t96*t194
      t199 = 15360*t153*t95*t3
      t204 = t101*t104*t106
      t206 = t6*s2l1
      t209 = t94*t6
      t218 = 8*t68
      t225 = 1-t133-t118+t119
      t254 = t118-1
      t265 = 2*z
      t266 = 8*t53
      t267 = t265-t266
      t275 = t155+1-z-t46
      t283 = t53-l3
      t294 = 6*t53
      t304 = z*t1
      t326 = t118-2
      t335 = -t4
      t336 = 3*t335
      t340 = 2*t4
      t341 = -t146+t265
      t346 = t6*s3l1
      t350 = t53+1-l3-z
      s2 = (9216*t96*t3*t97*t100*t101*t104*t106+(-46080*t111*t6*s23r-184
     #32*t96*t115-9216*t61*l3*(-t118+t119-z))*t8*t11*t57+((27648*t129+18
     #432*t131*t5*(-t132-t133+2+t134)-t139)*s23r+t145+9216*t61*l3*(t146-
     #t29-z)*s34r+9216*t78*(-t152+t154-t155+1))*l1*r*t40+(-27648*t165-92
     #16*t167*(-t168-t132+4+t134)+t174)*s23r-t179-9216*t131*t5*(-t46+t15
     #5-z)*s34r-9216*t4*t1*(-l3+t53-1))*s1l1+(9216*t96*t3*s2l1-9216*t195
     #+t199)*t97*t100*t204
      s3 = s2+((-9216*t111*t206-27648*t82*t209)*s23r+3072*(-3*t61*l3*(t1
     #19+z+2-t118)-t218)*s2l1+(18432*t195-t199)*s34r-3072*(-3*t61*l3*t22
     #5+t218)*s3l1-9216*t53*t61*(1-t118+t119)+6144*t53*t61*(t118-t119-2)
     #)*t8*t11*t57
      s1 = s3+(((-9216*t129+18432*t131*t5*(-l3+t53+z)+t139)*s2l1+9216*t8
     #2*t209*s34r+18432*t42*z*t254*t1)*s23r+(-t145+21504*t84+9216*t78*(t
     #154-t152-1+t155+t29)-6144*t78*t267)*s2l1-9216*t96*t194*t142+(6144*
     #(-3*t61*l3*t275+2*t68)*s3l1+18432*t53*t61*t283-6144*t53*t61*(-1-t1
     #55+t46))*s34r+3072*(-3*t78*(t154+z-1+t46-t294-t152)-2*t78*t267)*s3
     #l1+9216*t304*t5*(t154-t152+t46)-6144*t304*t5*(t152-t29+1-t154))*l1
     #*r*t40+((9216*t165-9216*t167*(t53+t265-l3)-t174)*s2l1-9216*t153*t1
     #63*s34r-9216*t53*t5*t326)*s23r
      t380 = s1+(t179-21504*t53*t78*s34r+3072*t336*(t153+t46-1+t53-t94)+
     #3072*t340*t341)*s2l1+9216*t111*t346*t142+(-6144*(-3*t131*t5*t350+2
     #*t86)*s3l1-9216*t53*t78*t283+6144*t53*t78*(l3-t53-1))*s34r-3072*(t
     #336*(-t119+z+l3-1+t153-t94)-t340*t341)*s3l1-9216*t172*(t153+l3-t94
     #)+6144*t172*(1-t46+t94-t153)
      t382 = t94*l3
      t383 = t2*t382
      t387 = t6*t5
      t388 = t382*t387
      t390 = 12288*t388*t115
      t392 = t2*t4
      t397 = 3072*(-8*t82-4*t392)*t94*t6
      t402 = t382*t1
      t403 = s23r**2
      t408 = t383*t95*s34r
      t411 = 4*z
      t421 = t388*t143
      t423 = 8*z
      t424 = 6*l3
      t428 = 15*z
      t436 = z**2
      t437 = t436*l3
      t438 = 15*t437
      t439 = 9*z
      t441 = 18*t53
      t445 = 12*t53
      t446 = 6*t437
      t447 = 4*t436
      t471 = -t1
      t473 = 3*t471*t28
      t478 = 2*t1
      t479 = t478*t28
      t480 = t479*t153
      t487 = 9*t153
      t488 = 9*t94
      t495 = t142*s34r
      t499 = 8*l3
      t511 = t471*l3
      t512 = t436*t94
      t513 = 6*t512
      t514 = 12*t153
      t515 = 6*t94
      t517 = 30*t53
      t524 = t478*l3
      t526 = 6*t153
      t529 = 3*t512
      t537 = 48*t153
      t538 = 36*t512
      t539 = 12*t94
      t541 = 10*z
      t544 = 16*l3
      t552 = t94*t5
      t553 = -l3+t53-z
      t563 = 9*t53
      t575 = l3*t5
      t586 = 17*t53
      t602 = 4*t153
      t608 = 2*t94
      t609 = 2*t153
      t617 = 15*t153
      t618 = t382*z
      t619 = 4*t618
      t620 = t436*t382
      t624 = 8*t437
      t625 = 2*t436
      t627 = 2*t382
      t628 = t617-t619+2*t620+t132-7*t94-13*t53+t624-t625+t265-8*t512+t6
     #27
      t630 = 2*t618
      t634 = -t411+t630-t620-17*t437+15*t512+t586+t447+t152-t46-t382-18*
     #t153
      t639 = 49152*t53
      t640 = 36864*t437
      t641 = 12288*l3
      s3 = (-9216*t383*t95*s23r-t390-t397)*t97*t100*t204
      s5 = (27648*t402*t6*t403+(27648*t408-3072*(8*t304-3*(t119-t411+1-t
     #118)*t1)*t28*t94)*s23r+24576*t421-3072*(-t111*t6*(t294-t423+7-t424
     #)+2*t111*t6*(t118-3+t428-t119))*s34r+3072*(2*(2-t438-t118-t439+9*t
     #436+t441)*t1-(t424-t445+t446-4+t423-t447)*t1)*l3*t5)*t8*t11*t57
      s6 = ((-18432*t402*t128+3072*(29*z-9+18*l3-t441)*t94*t5)*t403+(-18
     #432*t383*t95*t142+3072*(t473*t94*(t294+2-7*z-t424)+6*t480)*s34r+30
     #72*(-27*z+40*t53-t487-t424+t488)*l3*t5)*s23r-12288*t388*t3*t495+30
     #72*(-t111*t6*(t266-t423+5-t499)+2*t111*t6*(t29+14*z-2-t146))*t142+
     #3072*(t511*t5*(t513-t514+t515-16*t437+t517-14*l3-13*z+8*t436+5)+t5
     #24*t5*(-36*t53+t526-t152-2+t424-17*t436+30*t437-t529+17*z))*s34r-3
     #072*(t537-t538-t539-4+44*t437+t541-10*t436-52*t53+t544)*t4)*l1*r*t
     #40
      s4 = s5+s6
      s2 = s3+s4
      s1 = s2+(-6144*(-3*t552*t553+2*t153*t5)*s34r-3072*(20*z+9*l3-t563)
     #*t4*l3)*t403+(-6144*(t473*t94*t553+t480)*t142-3072*(-3*t575*(t411-
     #t152+t46-7*t53+t154)+2*t575*(t294-t411))*s34r-3072*(t586-t541-t154
     #+t152)*t4)*s23r-3072*(-2*t111*t6*t553+2*t111*t6*(-t53+t411+l3))*t4
     #95-3072*(-t131*t28*(t602+t132-t266+t411-4*t94)+2*t131*t28*(14*t53+
     #t608-t423-t609-t46))*t142
      t644 = s1+12288-3072*(t335*t628+t340*t634)*s34r+t639-t640-t641+307
     #20*t436-30720*z
      t651 = 9216*t383*t95*s3l1
      t653 = t618*t95*t2
      t659 = t3*t387
      t663 = t111*t346
      t665 = -t265-1
      t680 = t6*t382
      t700 = t94*s3l1
      t720 = -t350
      t748 = -t146+t411-1+t29
      t754 = -t424+3
      t759 = t47*t1
      t788 = t94*t1
      t843 = 5*z
      t864 = 12*l3
      t886 = -t515-1+t424
      t889 = -t886
      t921 = -z+t53+2-l3
      t999 = 10*t53
      t1018 = t47*t4
      t1029 = 1/r
      t1032 = 1+u
      t1033 = t1032**2
      t1034 = 1/t1033
      t1036 = t11*l2
      t1037 = dsqrt(l1)
      t1038 = t1037*t8
      t1040 = t1037*l1
      t1043 = t11**2
      t1044 = t1043*r
      t1047 = t11*t1040
      t1051 = t1043*t11
      t1052 = t1051*t1040
      t1054 = t1043*t100
      t1057 = t1043*l2
      t1059 = t1051*t1037
      t1062 = t1043*t1037
      t1068 = t1043*t1040
      t1077 = t11*l1
      t1079 = t**2
      t1081 = l1*r
      t1087 = dsqrt(-l2*(1-l1)*(l2-1)*t13*r*(t11*t+t1077*t+r+r*t1079-t10
     #81-t1081*t1079+t+l1*t))
      t1088 = t11*t1087
      t1091 = t1036*t1038-t100*t1040*t-t1044*t1037*t-t1047*l2-r*t1037*t-
     #t1052*l2-t1054*t1040*t+t1057*t1038+2*t1059*l2+5*t1062*l2-2*t1044*t
     #1040*t-3*t1068*l2-4*t1088*l4
      t1095 = t11*t1037
      t1100 = r*t1087
      t1103 = t1040*l2
      t1107 = t100*t
      t1108 = l1*t1087
      t1112 = -2*t100*t1037*t+3*t1095*l2-2*t1077*t1087+2*t1100*t+t1103-t
     #1095-t1059+t1052+t1047-2*t1062+2*t1068+2*t1088-4*t1107*t1108*l4
      t1118 = t1040*t
      t1121 = t1037*l2
      t1123 = t1079*t
      t1124 = t1044*t1123
      t1126 = t1044*l2
      t1127 = t1038*t1123
      t1131 = t100*l2
      t1133 = t100*t1123
      t1135 = r*l2
      t1137 = t1038*t
      t1140 = t1038*t1079
      t1145 = -4*t1100*l4*t+t1054*l2*t1118-t1051*t1079*t1121-t1124*t1121
     #-t1126*t1127-t1043*t1079*t1121+t1131*t1118-t1133*t1121-t1135*t1118
     #-t1135*t1137+t1051*l2*t1140-t1131*t1127+3*t1126*t1118
      t1153 = t1040*t1079
      t1175 = 2*t1044*t*t1121+2*t1124*t1103-2*t1126*t1137-2*t1057*t1153+
     #3*t1057*t1140+5*t1107*t1121+2*t1133*t1103-3*t1131*t1137-2*t1036*t1
     #153+2*t1036*t1140+3*t18*t1121+2*t1107*t1108+4*t1077*t1087*l4
      t1177 = t1091+t1112+t1145+t1175
      t1178 = t1177**2
      t1180 = t11+t18+l1-t1081*t
      t1181 = t1180**2
      t1187 = l3*s1vr
      t1194 = t19*t1034
      t1201 = 1+l1*l3*r*t335*t1032*t37*t39
      t1202 = s34spinc(z,l1,l2,l3,l4,l5,l6,l7,l8)
      t1208 = s34spinc2(z,l1,l2,l3,l4,l5,l6,l7,l8)
      s2 = ((18432*t7*l3*t8*t11*t13*t17*t21+(-9216*t27-9216*t28*(t29-1)*
     #t2)*l1*r*t40+9216*t44+9216*t48*t1)*s1l1+3072*t53*t7*t8*t11*t57+((9
     #216*t27-9216*t61)*s2l1+6144*t53*t7*s34r-18432*t68+6144*z*t28*t47*t
     #2)*l1*r*t40+(-9216*t44+9216*t78)*s2l1-6144*t84+9216*t86-6144*t88*t
     #2)*t92+t380*s13r+t644*s1l1+((-9216*t383*t95*s2l1+t651-15360*t653)*
     #s23r+(-t390-t397)*s2l1-30720*t659*t618*s34r-18432*t663-6144*(2*t2*
     #t665-t392)*z*t209)*t97*t100*t204
      s3 = s2+((9216*t402*t206-24576*t471*z*t680)*t403+((9216*t408+9216*
     #(-t265+3-t118+t119)*t94*t163)*s2l1+(-t651+30720*t653)*s34r+3072*(4
     #*t304-3*(-1-t133-t118+t119)*t1)*t28*t700-3072*(-2*t225*t1-3*(2-t13
     #3-t118+t119)*t1)*z*t28*t94)*s23r+(12288*t421-3072*(-t111*t6*(t294-
     #t411-t424+5)+6*t111*t6*t720)*s34r+3072*(2*(-t438+1+6*t436-t439+t44
     #1-t118)*t1-(t411-t625-2+t424-t445+t446)*t1)*l3*t5)*s2l1+46080*t618
     #*t659*t142+(27648*t663+18432*t82*t209*t350-18432*t82*t209*t748)*s3
     #4r-9216*t754*l3*t163*s3l1+9216*(2*t759*t665-t759*t4)*z*t42)*t8*t11
     #*t57
      s5 = s3
      s10 = (3072*t754*t28*t94*s2l1-15360*t680*t304*s34r+3072*(t499-t266
     #-4+t541)*t5*t153-3072*(-t499-t423+4+t266)*t5*t153)*t403+((-9216*t7
     #88*t28*(t155-z-t46+2)*s34r-9216*(-2+z-t146+t424-t152+t154)*l3*t5)*
     #s2l1-15360*t383*t95*z*t142+(9216*t788*t28*(-t46+t155-z-1)*s3l1+307
     #2*t473*t153*(-t29-t411+2+t146)+3072*t479*t153*t748)*s34r-3072*(26*
     #t53-t541-6-t487+t424+t488)*l3*t5*s3l1+3072*(15*t94-t428-t617-t544+
     #t517+3)*z*t575)*s23r
      s9 = s10+(3072*(-t111*t6*(t146-t265-t29+1)-2*t111*t6*t275)*t142+30
     #72*(t511*t5*(-t133+1+t625+t513-t514+t515-t624+t441-10*l3)+t524*t5*
     #(-t445-1-t625+t843+t424+t526-t152+t446-t529))*s34r-3072*(-t625-t53
     #8+t499+28*t437+t168-44*t53+t537-t539)*t4)*s2l1-15360*t618*t659*t49
     #5
      s8 = s9+(-9216*t663-3072*t82*t209*(t294-t843-t424+3)+6144*t82*t209
     #*(-t445+t864+t541-3))*t142+(-18432*t42*t254*t1*s3l1-3072*t53*t163*
     #(t864-3-t515-t445+t843+t526)+6144*t42*t304*(-t424-t514+t539+24*t53
     #-t541))*s34r+3072*(2*t886*t5-t889*t5)*s3l1-3072*(2*t889*t665-t889*
     #t4)*z*t5
      s9 = l1
      s7 = s8*s9
      s8 = r*t40
      s6 = s7*s8
      s4 = s5+s6
      s1 = s4+(9216*t552*s2l1+15360*t153*t5*t553*s34r-3072*(t29-t146+t16
     #8)*l3*t172+12288*t553*l3*t172)*t403+((9216*t552*t921*s34r+9216*t92
     #1*l3*t4)*s2l1+15360*t153*t28*t1*t553*t142+(-9216*t552*(-l3+t53-z-1
     #)*s3l1+9216*t53*t5*(t609+t265-t608+t46-t146)-6144*t53*t5*(-t265-t6
     #09+t146+t608-l3))*s34r+3072*(t541-t119+6+t118)*t4*l3*s3l1-6144*(-t
     #153+t94+t155-z)*t4*z+9216*(-t94+t153+l3+z-t155)*t4*z)*s23r
      s2 = s1+(-3072*(-t788*t28*(-t46+t155+1-t265)+2*t788*t28*t720)*t142
     #-3072*(t335*l3*(1+t608-t132+t625-4*t437+2*t512-t133+t563-t602)+t34
     #0*l3*(3*t437-t94-t625+t843-1+t118+t609-t512-t294))*s34r-18432*z+61
     #44*t436+t639-t641-t640)*s2l1+15360*t82*t94*t6*t553*t495+(9216*t163
     #*t700+3072*t53*t163*(t154-t152+t118+t265-t134)-6144*t42*t304*(-t52
     #6+t515-t118+t999-t411))*t142+(9216*t575*t326*s3l1+3072*t88*(-t118-
     #t526+t630+t134-z+t515-t627)-6144*t88*(t265+t514-t619-t999-t152+4*t
     #382))*s34r
      taux2 = s2+9216*t1018*s3l1-3072*t48*z+6144*t1018*z*t665+15360*z*(z
     #+2*s2l1)*t1029*t37*t39*t1034*t1178/t1181-(-3072*(3*t1187-3*t1187*z
     #-t541)*r*t15*t1194*t1201*t1202-9216*t4*s1vr*t1*t1208*r*t15*t1194*t
     #1201)*t1177*t39*t37/t1180*t1029

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet2 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff2)

CCC Sum

      rm1num1e2 = tFjet1*tcoff1+tFjet2*tcoff2
      RETURN
      END

      double precision function rm1num1e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux1 = 0
      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = -1+z
      t5 = t4**2
      t6 = t5**2
      t7 = t3*t6
      t8 = l1**2
      t11 = r**2
      t12 = 1+t11
      t13 = t12**2
      t15 = r+t
      t16 = t15**2
      t17 = 1/t16
      t18 = r*t
      t19 = 1+t18
      t20 = t19**2
      t21 = 1/t20
      t27 = t7*l3*s34r
      t28 = t5*t4
      t29 = 4*l3
      t37 = 1/t15
      t39 = 1/t19
      t40 = t12*t37*t39
      t42 = l3*t28
      t44 = t42*t2*s34r
      t46 = 2*l3
      t47 = t46-1
      t48 = t5*t47
      t53 = z*l3
      t57 = t13*t17*t21
      t61 = t2*t28
      t71 = t1*t5
      t78 = s13r**2
      t80 = l3**2
      t81 = t6*t4
      t82 = t80*t81
      t83 = t8*l1
      t86 = t11*r
      t87 = t13*t12
      t90 = 1/t16/t15
      t92 = 1/t20/t19
      t97 = t80*t2
      t101 = t3*s34r
      t104 = 3*l3
      t105 = 3*t53
      t114 = t6*s34r
      t115 = t97*t114
      t117 = l3*t1
      t118 = 5*l3
      t119 = 3*z
      t120 = 5*t53
      t127 = s34r**2
      t128 = t3*t127
      t129 = t82*t128
      t131 = 4*t53
      t137 = 3*t80
      t138 = z*t80
      t139 = 3*t138
      t140 = 2*t53
      t148 = t1*t28
      t150 = t148*t80*s34r
      t152 = t4*l3
      t160 = t97*t6*t127
      t175 = t3*s3l1
      t176 = t82*t175
      t178 = t138*t81*t3
      t184 = t87*t90*t92
      t186 = t6*s2l1
      t189 = t2*z
      t190 = t80*t6
      t227 = t104-1
      t249 = t53-l3
      t256 = 6*t53
      t261 = z*t1
      t270 = 2*z
      t279 = t104-2
      t292 = t6*s3l1
      t296 = t53+1-l3-z
      t310 = z*t4
      t316 = t80*l3
      t317 = t2*t316
      t321 = t6*t5
      t322 = t316*t321
      t323 = t322*t101
      t325 = t2*t81
      t326 = t325*t80
      t332 = t316*t1
      t333 = s23r**2
      t338 = t317*t81*s34r
      t340 = 4*z
      t343 = t28*t80
      t348 = t322*t128
      t350 = 8*z
      t351 = 6*l3
      t357 = 12*t53
      t358 = z**2
      t359 = t358*l3
      t360 = 6*t359
      t364 = l3*t5
      t373 = 7*z
      t388 = 5*z
      t389 = 8*t53
      t396 = t127*s34r
      t400 = 8*l3
      t406 = t358*t80
      t407 = 6*t406
      t408 = 12*t138
      t409 = 6*t80
      t420 = 2*t358
      t422 = 8*t359
      t430 = t80*t5
      t431 = -l3+t53-z
      t455 = 2*t431
      t460 = 4*t138
      t468 = t316*z
      t475 = 2*t316
      t476 = 15*t138-4*t468+2*t358*t316+t118-7*t80-13*t53+t422-t420+t270
     #-8*t406+t475
      t480 = 12288*l3
      t481 = 24576*t53
      t482 = 12288*t359
      s2 = (6144*t317*t81*s23r+12288*t323-12288*t326)*t83*t86*t184+(-184
     #32*t332*t6*t333+(-18432*t338-6144*(t105-t340+1-t104)*t1*t343)*s23r
     #-24576*t348-6144*t97*t6*(t256-t350+7-t351)*s34r+6144*(t351-t357+t3
     #60-4+t350-4*t358)*t1*t364)*t8*t11*t57+((12288*t332*t114+6144*(-t37
     #3+3-t351+t256)*t80*t5)*t333+(12288*t317*t81*t127+6144*t148*t80*(t2
     #56+2-t373-t351)*s34r+6144*(t388+t139-t389+t46-t137)*l3*t5)*s23r+12
     #288*t322*t3*t396+6144*t97*t6*(t389-t350+5-t400)*t127+6144*t117*t5*
     #(t407-t408+t409-16*t359+30*t53-14*l3-13*z+8*t358+5)*s34r-6144*(t40
     #9-t408+t407+2-t340+t420-t400+16*t53-t422)*t4)*l1*r*t40
      s1 = s2+(-12288*t430*t431*s34r-6144*(-t104+t105-t340)*t4*l3)*t333+
     #(-12288*t148*t80*t431*t127-6144*t364*(t340-t137+t46-7*t53+t139)*s3
     #4r-6144*(-t105+t138-t80+t270)*t4)*s23r-6144*t97*t6*t455*t396-6144*
     #t117*t28*(t460+t118-t389+t340-4*t80)*t127
      t485 = s1-12288-6144*t4*t476*s34r+t480-t481+t482+24576*z-12288*t35
     #8
      t490 = t317*t81*s3l1
      t491 = t468*t325
      t498 = t3*t321
      t502 = t97*t292
      t535 = z*t28*t80
      t580 = -t29-t340+2+t131
      t586 = t80*t1
      t631 = 4*t359
      t651 = 6*t138
      t658 = t409+1-t351
      t678 = -z+t53+2-l3
      t694 = 2*t80
      t755 = 1/r
      t758 = 1+u
      t759 = t758**2
      t760 = 1/t759
      t762 = t86*t
      t769 = t11*l1
      t771 = t**2
      t773 = l1*r
      t779 = dsqrt(-l2*(1-l1)*(l2-1)*t13*r*(t11*t+t769*t+r+r*t771-t773-t
     #773*t771+t+l1*t))
      t780 = l1*t779
      t784 = t11**2
      t785 = t784*t11
      t787 = dsqrt(l1)
      t788 = t787*l2
      t790 = t784*r
      t791 = t771*t
      t792 = t790*t791
      t794 = t790*l2
      t795 = t787*t8
      t796 = t795*t791
      t800 = t86*l2
      t801 = t787*l1
      t802 = t801*t
      t804 = t86*t791
      t806 = r*l2
      t808 = t795*t
      t811 = t795*t771
      t819 = -4*t762*t780*l4-t785*t771*t788-t792*t788-t794*t796-t784*t77
     #1*t788+t800*t802-t804*t788-t806*t802-t806*t808+t785*l2*t811-t800*t
     #796+3*t794*t802+2*t790*t*t788
      t820 = t801*l2
      t825 = t784*l2
      t826 = t801*t771
      t837 = t11*l2
      t849 = r*t779
      t853 = 2*t792*t820-2*t794*t808-2*t825*t826+3*t825*t811+5*t762*t788
     #+2*t804*t820-3*t800*t808-2*t837*t826+2*t837*t811+3*t18*t788+2*t762
     #*t780+4*t769*t779*l4-4*t849*l4*t
      t855 = t784*t86
      t858 = t787*t11
      t859 = t785*t787
      t860 = t785*t801
      t861 = t11*t801
      t862 = t784*t787
      t864 = t784*t801
      t866 = t11*t779
      t874 = t855*l2*t802+t820-t858-t859+t860+t861-2*t862+2*t864+2*t866+
     #t837*t795-t86*t801*t-t790*t787*t-t861*l2
      t901 = -r*t787*t-t860*l2-t855*t801*t+t825*t795+2*t859*l2+5*t862*l2
     #-2*t790*t801*t-3*t864*l2-4*t866*l4-2*t86*t787*t+3*t858*l2-2*t769*t
     #779+2*t849*t
      t903 = t819+t853+t874+t901
      t904 = t903**2
      t906 = t11+t18+l1-t773*t
      t907 = t906**2
      t913 = l3*s1vr
      t918 = t19*t760
      t926 = 1-l1*l3*r*t4*t758*t37*t39
      t927 = s34spinc(z,l1,l2,l3,l4,l5,l6,l7,l8)
      t932 = s34spinc2(z,l1,l2,l3,l4,l5,l6,l7,l8)
      s4 = ((-12288*t7*l3*t8*t11*t13*t17*t21+(6144*t27+6144*t28*(t29-1)*
     #t2)*l1*r*t40-6144*t44-6144*t48*t1)*s1l1-6144*t53*t7*t8*t11*t57+((-
     #6144*t27+6144*t61)*s2l1+12288*t53*t61)*l1*r*t40+(6144*t44-6144*t71
     #)*s2l1-6144*t53*t71)*t78
      s8 = (-6144*t82*t3*t83*t86*t87*t90*t92+(30720*t97*t6*s23r+12288*t8
     #2*t101+6144*t61*l3*(-t104+t105-z))*t8*t11*t57+((-18432*t115-12288*
     #t117*t5*(-t118-t119+2+t120))*s23r-6144*t129-6144*t61*l3*(t131-t29-
     #z)*s34r-6144*t71*(-t137+t139-t140+1))*l1*r*t40+(18432*t150+6144*t1
     #52*(-6*z-t118+4+t120))*s23r+6144*t160+6144*t117*t5*(-t46+t140-z)*s
     #34r+6144*t4*t1*(-l3+t53-1))*s1l1+(-6144*t82*t3*s2l1+6144*t176-6144
     #*t178)*t83*t86*t184
      s7 = s8+((6144*t97*t186+18432*t189*t190)*s23r+6144*t61*l3*(t105+z+
     #2-t104)*s2l1+(-12288*t176+6144*t178)*s34r-6144*t61*l3*(1-t119-t104
     #+t105)*s3l1+6144*t53*t61*(1-t104+t105))*t8*t11*t57+(((6144*t115-12
     #288*t117*t5*(-l3+t53+z))*s2l1-6144*t189*t190*s34r-12288*t42*z*t227
     #*t1)*s23r+(6144*t129-6144*t189*t42*s34r-6144*t71*(t139-t137-1+t140
     #+t29))*s2l1+6144*t82*t175*t127+(12288*t61*l3*(t140+1-z-t46)*s3l1-1
     #2288*t53*t61*t249)*s34r+6144*t71*(t139+z-1+t46-t256-t137)*s3l1-614
     #4*t261*t5*(t139-t137+t46))*l1*r*t40+((-6144*t150+6144*t152*(t53+t2
     #70-l3))*s2l1+6144*t138*t148*s34r+6144*t53*t5*t279)*s23r
      s6 = s7+(-6144*t160+6144*t53*t71*s34r+6144*t4*(t138+t46-1+t53-t80)
     #)*s2l1-6144*t97*t292*t127+(-12288*t117*t5*t296*s3l1+6144*t53*t71*t
     #249)*s34r-6144*t4*(-t105+z+l3-1+t138-t80)*s3l1+6144*t310*(t138+l3-
     #t80)
      s7 = s13r
      s5 = s6*s7
      s3 = s4+s5
      s2 = s3+t485*s1l1+((6144*t317*t81*s2l1-6144*t490+6144*t491)*s23r+(
     #12288*t323-12288*t326)*s2l1+12288*t498*t468*s34r+12288*t502-12288*
     #t325*t138)*t83*t86*t184
      s3 = s2+((-6144*t332*t186-12288*t468*t1*t6)*t333+((-6144*t338-6144
     #*(-t270+3-t104+t105)*t80*t148)*s2l1+(6144*t490-12288*t491)*s34r+61
     #44*(-1-t119-t104+t105)*t1*t343*s3l1-6144*(2-t119-t104+t105)*t1*t53
     #5)*s23r+(-12288*t348-6144*t97*t6*(t256-t340-t351+5)*s34r+6144*(t34
     #0-t420-2+t351-t357+t360)*t1*t364)*s2l1-18432*t468*t498*t127+(-1843
     #2*t502-36864*t189*t190*t296)*s34r-18432*t47*l3*t148*s3l1+18432*t47
     #*t1*t6*z*l3)*t8*t11*t57
      s5 = s3
      s8 = (6144*t47*t28*t80*s2l1+6144*t316*t6*t261*s34r+6144*t580*t5*t1
     #38)*t333+((6144*t586*t28*(t140-z-t46+2)*s34r+6144*(-2+z-t131+t351-
     #t137+t139)*l3*t5)*s2l1+6144*t317*t81*z*t127+(-6144*t586*t28*(-t46+
     #t140-z-1)*s3l1+6144*t138*t148*t580)*s34r-6144*(t270+2+t139-t46-t25
     #6-t137)*l3*t5*s3l1+6144*(-1-t137-t256+t29+t119+t139)*z*t364)*s23r+
     #(6144*t97*t6*(t131-t270-t29+1)*t127+6144*t117*t5*(-t119+1+t420+t40
     #7-t408+t409-t422+18*t53-10*l3)*s34r-6144*(t389-t631-t29+t409-t408+
     #t407)*t4)*s2l1+6144*t468*t498*t396+(6144*t502+6144*t189*t190*(t256
     #-t388-t351+3))*t127+(12288*t42*t227*t1*s3l1+6144*t53*t148*(12*l3-3
     #-t409-t357+t388+t651))*s34r+6144*t658*t5*s3l1-6144*t658*t28*z
      s9 = l1
      s7 = s8*s9
      s8 = r*t40
      s6 = s7*s8
      s4 = s5+s6
      s1 = s4+(-6144*t430*s2l1-6144*t138*t5*t431*s34r-6144*t455*l3*t310)
     #*t333+((-6144*t430*t678*s34r-6144*t678*l3*t4)*s2l1-6144*t535*t1*t4
     #31*t127+(6144*t430*(-l3+t53-z-1)*s3l1-6144*t53*t5*(2*t138+t270-t69
     #4+t46-t131))*s34r+6144*(t53-2-t270-l3)*t4*l3*s3l1-6144*(-t80+t138+
     #l3+z-t140)*t4*z)*s23r
      taux2 = s1+(-6144*t586*t28*(-t46+t140+1-t270)*t127-6144*t152*(1+t6
     #94-t118+t420-t631+2*t406-t119+9*t53-t460)*s34r+t480-t481+t482)*s2l
     #1-6144*t189*t80*t6*t431*t396+(-6144*t148*t80*s3l1-6144*t53*t148*(t
     #139-t137+t104+t270-t120))*t127+(-6144*t364*t279*s3l1-6144*z*t5*(-t
     #104-t651+2*t468+t120-z+t409-t475))*s34r-6144*t47*t4*s3l1+6144*t48*
     #z-6144*z*(z+2*s2l1)*t755*t37*t39*t760*t904/t907-(-6144*(-t913+t913
     #*z+t270)*r*t15*t918*t926*t927+6144*t4*s1vr*t1*t932*r*t15*t918*t926
     #)*t903*t39*t37/t906*t755

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet2 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff2)

CCC Sum

      rm1num1e3 = tFjet1*tcoff1+tFjet2*tcoff2
      RETURN
      END

      double precision function rm1num1e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux1 = 0
      taux2 = 0

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet2 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff2)

CCC Sum

      rm1num1e4 = tFjet1*tcoff1+tFjet2*tcoff2
      RETURN
      END

      double precision function rm1num2e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t4 = s1vr**2
      t12 = (-1+z)*(l3-1)
      t26 = s23r**2
      taux3 = ((192*s3l2+384*s4l2)*t4+((-192*s2l2-384*s3l2)*s23r-192*t12
     #*s34r*s2l2+(-192*t12*s3l2-384*t12*s4l2)*s34r)*s1vr+(384*s2l2+384*s
     #3l2+384*s4l2)*t26)*s1l1+((192*s3l1+384*s4l1)*t4+((-192*s2l1-384*s3
     #l1)*s23r-192*t12*s34r*s2l1+(-192*t12*s3l1-384*t12*s4l1)*s34r)*s1vr
     #+(384*s2l1+384*s3l1+384*s4l1)*t26)*s1l2
      t4 = s1vr**2
      t12 = (-l3+1)*(-1+z)
      t26 = s23r**2
      taux4 = ((768*s3l2+1536*s4l2)*t4+((-768*s2l2-1536*s3l2)*s23r+768*t
     #12*s34r*s2l2+(768*t12*s3l2+1536*t12*s4l2)*s34r)*s1vr+(1536*s2l2+15
     #36*s3l2+1536*s4l2)*t26)*s1l1+((-768*s3l1-1536*s4l1)*t4+((768*s2l1+
     #1536*s3l1)*s23r-768*t12*s34r*s2l1+(-768*t12*s3l1-1536*t12*s4l1)*s3
     #4r)*s1vr+(-1536*s2l1-1536*s3l1-1536*s4l1)*t26)*s1l2

CCC Coefficients

      tcoff3 = taux3
      tcoff4 = taux3
      tcoff5 = taux3
      tcoff6 = taux3
      tcoff7 = taux4
      tcoff8 = -taux4
      tcoff9 = taux4
      tcoff10 = -taux4

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet4 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff4)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet5 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+z
     #-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff5)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet6 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff6)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet7 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff7)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet8 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff8)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet9 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+z
     #-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff9)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet10 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,6.D0,1.D0,1.D0,Tcoeff*tcoff10)

CCC Sum

      rm1num2e0 = tFjet3*tcoff3+tFjet4*tcoff4+tFjet5*tcoff5+tFjet6*tcoff
     #6+tFjet7*tcoff7+tFjet8*tcoff8+tFjet9*tcoff9+tFjet10*tcoff10
      RETURN
      END

      double precision function rm1num2e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = 1-z
      t2 = l3-1
      t3 = t2*t1
      t4 = s1vr**2
      t8 = z*s23r
      t11 = -t1
      t12 = t11**2
      t14 = t2**2
      t30 = t2*t11
      t44 = s23r**2
      t72 = z*t11
      t98 = z**2
      taux3 = (-192*t3*z*t4+(-384*t3*t8-192*z*t12*t14*s34r)*s1vr)*s13r+(
     #(-192*s3l2-384*s4l2)*t4+((192*s2l2+384*s3l2)*s23r+192*t30*s34r*s2l
     #2+(192*t30*s3l2+384*t30*s4l2)*s34r)*s1vr+(-384*s2l2-384*s3l2-384*s
     #4l2)*t44)*s1l1+((-192*s3l1-384*s4l1)*t4+((192*s2l1+384*s3l1)*s23r+
     #192*t30*s34r*s2l1+(192*t30*s3l1+384*t30*s4l1)*s34r)*s1vr+(-384*s2l
     #1-384*s3l1-384*s4l1)*t44)*s1l2-384*t72*l3*t4*s1vr+(384*z*l3*t12*t2
     #*s34r+384*z*t1)*t4+(-384*t72*l3*t44+192*t8-192*(-2*z+1)*t11*t2*z*s
     #34r)*s1vr-384*t98*t44
      t4 = s1vr**2
      t13 = (4*l3-4)*(-1+z)
      t27 = s23r**2
      taux4 = ((-3072*s3l2-6144*s4l2)*t4+((3072*s2l2+6144*s3l2)*s23r+768
     #*t13*s34r*s2l2+(768*t13*s3l2+1536*t13*s4l2)*s34r)*s1vr+(-6144*s2l2
     #-6144*s3l2-6144*s4l2)*t27)*s1l1+((3072*s3l1+6144*s4l1)*t4+((-3072*
     #s2l1-6144*s3l1)*s23r-768*t13*s34r*s2l1+(-768*t13*s3l1-1536*t13*s4l
     #1)*s34r)*s1vr+(6144*s2l1+6144*s3l1+6144*s4l1)*t27)*s1l2

CCC Coefficients

      tcoff3 = taux3
      tcoff4 = taux3
      tcoff5 = taux3
      tcoff6 = taux3
      tcoff7 = taux4
      tcoff8 = -taux4
      tcoff9 = taux4
      tcoff10 = -taux4

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet4 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff4)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet5 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+z
     #-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff5)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet6 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff6)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet7 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff7)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet8 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff8)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet9 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+z
     #-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff9)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet10 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,6.D0,1.D0,1.D0,Tcoeff*tcoff10)

CCC Sum

      rm1num2e1 = tFjet3*tcoff3+tFjet4*tcoff4+tFjet5*tcoff5+tFjet6*tcoff
     #6+tFjet7*tcoff7+tFjet8*tcoff8+tFjet9*tcoff9+tFjet10*tcoff10
      RETURN
      END

      double precision function rm1num2e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = z*t1
      t3 = l3-1
      t4 = s1vr**2
      t11 = t1**2
      t13 = t3**2
      t32 = s23r**2
      t47 = z**2
      taux3 = (-192*t2*t3*t4+(-384*t2*t3*s23r+192*z*t11*t13*s34r)*s1vr)*
     #s13r+384*t2*l3*t4*s1vr+(-384*z*l3*t11*t3*s34r+384*t2)*t4+(384*t2*l
     #3*t32-192*z*s23r-192*(2*z-1)*t1*t3*z*s34r)*s1vr+384*t47*t32
      t4 = s1vr**2
      t13 = (-5*l3+5)*(-1+z)
      t27 = s23r**2
      taux4 = ((3840*s3l2+7680*s4l2)*t4+((-3840*s2l2-7680*s3l2)*s23r+768
     #*t13*s34r*s2l2+(768*t13*s3l2+1536*t13*s4l2)*s34r)*s1vr+(7680*s2l2+
     #7680*s3l2+7680*s4l2)*t27)*s1l1+((-3840*s3l1-7680*s4l1)*t4+((3840*s
     #2l1+7680*s3l1)*s23r-768*t13*s34r*s2l1+(-768*t13*s3l1-1536*t13*s4l1
     #)*s34r)*s1vr+(-7680*s2l1-7680*s3l1-7680*s4l1)*t27)*s1l2

CCC Coefficients

      tcoff3 = taux3
      tcoff4 = taux3
      tcoff5 = taux3
      tcoff6 = taux3
      tcoff7 = taux4
      tcoff8 = -taux4
      tcoff9 = taux4
      tcoff10 = -taux4

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet4 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff4)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet5 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+z
     #-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff5)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet6 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff6)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet7 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff7)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet8 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff8)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet9 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+z
     #-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff9)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet10 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,6.D0,1.D0,1.D0,Tcoeff*tcoff10)

CCC Sum

      rm1num2e2 = tFjet3*tcoff3+tFjet4*tcoff4+tFjet5*tcoff5+tFjet6*tcoff
     #6+tFjet7*tcoff7+tFjet8*tcoff8+tFjet9*tcoff9+tFjet10*tcoff10
      RETURN
      END

      double precision function rm1num2e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux3 = 0
      t4 = s1vr**2
      t12 = (-1+z)*(l3-1)
      t26 = s23r**2
      taux4 = ((-1536*s3l2-3072*s4l2)*t4+((1536*s2l2+3072*s3l2)*s23r+153
     #6*t12*s34r*s2l2+(1536*t12*s3l2+3072*t12*s4l2)*s34r)*s1vr+(-3072*s2
     #l2-3072*s3l2-3072*s4l2)*t26)*s1l1+((1536*s3l1+3072*s4l1)*t4+((-153
     #6*s2l1-3072*s3l1)*s23r-1536*t12*s34r*s2l1+(-1536*t12*s3l1-3072*t12
     #*s4l1)*s34r)*s1vr+(3072*s2l1+3072*s3l1+3072*s4l1)*t26)*s1l2

CCC Coefficients

      tcoff3 = taux3
      tcoff4 = taux3
      tcoff5 = taux3
      tcoff6 = taux3
      tcoff7 = taux4
      tcoff8 = -taux4
      tcoff9 = taux4
      tcoff10 = -taux4

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet4 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff4)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet5 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+z
     #-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff5)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet6 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff6)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet7 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff7)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet8 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff8)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet9 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+z
     #-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff9)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet10 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,6.D0,1.D0,1.D0,Tcoeff*tcoff10)

CCC Sum

      rm1num2e3 = tFjet3*tcoff3+tFjet4*tcoff4+tFjet5*tcoff5+tFjet6*tcoff
     #6+tFjet7*tcoff7+tFjet8*tcoff8+tFjet9*tcoff9+tFjet10*tcoff10
      RETURN
      END

      double precision function rm1num2e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux3 = 0
      taux4 = 0

CCC Coefficients

      tcoff3 = taux3
      tcoff4 = taux3
      tcoff5 = taux3
      tcoff6 = taux3
      tcoff7 = taux4
      tcoff8 = -taux4
      tcoff9 = taux4
      tcoff10 = -taux4

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet4 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff4)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet5 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+z
     #-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff5)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet6 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff6)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet7 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff7)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet8 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff8)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet9 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+z
     #-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff9)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet10 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,6.D0,1.D0,1.D0,Tcoeff*tcoff10)

CCC Sum

      rm1num2e4 = tFjet3*tcoff3+tFjet4*tcoff4+tFjet5*tcoff5+tFjet6*tcoff
     #6+tFjet7*tcoff7+tFjet8*tcoff8+tFjet9*tcoff9+tFjet10*tcoff10
      RETURN
      END

      double precision function rm1num3e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t3 = s1vr**2
      t5 = -l3+1
      t7 = -1+z
      t8 = 2*t5*t7
      t15 = -t5*t7
      taux5 = ((128.D0/3.D0*s3l2+128.D0/3.D0*s4l2)*t3+(64.D0/3.D0*t8*s34
     #r*s2l2+(64.D0/3.D0*t8*s3l2-128.D0/3.D0*t15*s4l2)*s34r)*s1vr)*s1l1+
     #((128.D0/3.D0*s3l1+128.D0/3.D0*s4l1)*t3+(64.D0/3.D0*t8*s34r*s2l1+(
     #64.D0/3.D0*t8*s3l1-128.D0/3.D0*t15*s4l1)*s34r)*s1vr)*s1l2
      t3 = s1vr**2
      t5 = 1-z
      t7 = l3-1
      t8 = 2*t5*t7
      t16 = t5*t7
      taux6 = ((512.D0/3.D0*s3l2+512.D0/3.D0*s4l2)*t3+(256.D0/3.D0*t8*s3
     #4r*s2l2+(256.D0/3.D0*t8*s3l2+512.D0/3.D0*t16*s4l2)*s34r)*s1vr)*s1l
     #1+((-512.D0/3.D0*s3l1-512.D0/3.D0*s4l1)*t3+(-256.D0/3.D0*t8*s34r*s
     #2l1+(-256.D0/3.D0*t8*s3l1-512.D0/3.D0*t16*s4l1)*s34r)*s1vr)*s1l2

CCC Coefficients

      tcoff11 = taux5
      tcoff12 = taux5
      tcoff13 = taux6
      tcoff14 = taux6

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet11 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,3.D0,1.D0,1.D0,Tcoeff*tcoff11)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet12 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,3.D0,1.D0,1.D0,Tcoeff*tcoff12)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet13 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,6.D0,1.D0,1.D0,Tcoeff*tcoff13)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet14 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,6.D0,1.D0,1.D0,Tcoeff*tcoff14)

CCC Sum

      rm1num3e0 = tFjet11*tcoff11+tFjet12*tcoff12+tFjet13*tcoff13+tFjet1
     #4*tcoff14
      RETURN
      END

      double precision function rm1num3e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t4 = s1vr**2
      t11 = l3-1
      t12 = -1+z
      t13 = t11*t12
      t14 = s34r*s2l2
      t27 = s23r**2
      t29 = -t12
      t30 = t29*t11
      t51 = s34r*s2l1
      t82 = t12**2
      t90 = z**2
      taux5 = ((-64.D0/3.D0*s3l2-128.D0/3.D0*s4l2)*t4+((-128.D0/3.D0*s2l
     #2-64*s3l2-64.D0/3.D0*s4l2)*s23r+64.D0/3.D0*t13*t14+(64.D0/3.D0*t13
     #*s3l2+128.D0/3.D0*t13*s4l2)*s34r)*s1vr+(128.D0/3.D0*s2l2+128.D0/3.
     #D0*s3l2+128.D0/3.D0*s4l2)*t27+(-128.D0/3.D0*t30*t14+(-128.D0/3.D0*
     #t30*s3l2-128.D0/3.D0*t30*s4l2)*s34r)*s23r)*s1l1+((-64.D0/3.D0*s3l1
     #-128.D0/3.D0*s4l1)*t4+((-128.D0/3.D0*s2l1-64*s3l1-64.D0/3.D0*s4l1)
     #*s23r+64.D0/3.D0*t13*t51+(64.D0/3.D0*t13*s3l1+128.D0/3.D0*t13*s4l1
     #)*s34r)*s1vr+(128.D0/3.D0*s2l1+128.D0/3.D0*s3l1+128.D0/3.D0*s4l1)*
     #t27+(-128.D0/3.D0*t30*t51+(-128.D0/3.D0*t30*s3l1-128.D0/3.D0*t30*s
     #4l1)*s34r)*s23r)*s1l2-128.D0/3.D0*z*t12*l3*t4*s1vr+(128.D0/3.D0*z*
     #l3*t82*t11*s34r+128.D0/3.D0*t29*z)*t4+128.D0/3.D0*t12*t90*t11*s34r
     #*s1vr
      t4 = s1vr**2
      t11 = -1+z
      t13 = l3-1
      t14 = 7*t11*t13
      t15 = s34r*s2l2
      t21 = 4*t11*t13
      t30 = s23r**2
      t33 = -t11*t13
      t54 = s34r*s2l1
      taux6 = ((-1792.D0/3.D0*s3l2-2048.D0/3.D0*s4l2)*t4+((-512.D0/3.D0*
     #s2l2-256*s3l2-256.D0/3.D0*s4l2)*s23r+256.D0/3.D0*t15*t14+(256.D0/3
     #.D0*t14*s3l2+512.D0/3.D0*t21*s4l2)*s34r)*s1vr+(512.D0/3.D0*s2l2+51
     #2.D0/3.D0*s3l2+512.D0/3.D0*s4l2)*t30+(-512.D0/3.D0*t15*t33+(-512.D
     #0/3.D0*t33*s3l2-512.D0/3.D0*t33*s4l2)*s34r)*s23r)*s1l1+((1792.D0/3
     #.D0*s3l1+2048.D0/3.D0*s4l1)*t4+((512.D0/3.D0*s2l1+256*s3l1+256.D0/
     #3.D0*s4l1)*s23r-256.D0/3.D0*t14*t54+(-256.D0/3.D0*t14*s3l1-512.D0/
     #3.D0*t21*s4l1)*s34r)*s1vr+(-512.D0/3.D0*s2l1-512.D0/3.D0*s3l1-512.
     #D0/3.D0*s4l1)*t30+(512.D0/3.D0*t33*t54+(512.D0/3.D0*t33*s3l1+512.D
     #0/3.D0*t33*s4l1)*s34r)*s23r)*s1l2

CCC Coefficients

      tcoff11 = taux5
      tcoff12 = taux5
      tcoff13 = taux6
      tcoff14 = taux6

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet11 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,3.D0,1.D0,1.D0,Tcoeff*tcoff11)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet12 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,3.D0,1.D0,1.D0,Tcoeff*tcoff12)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet13 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,6.D0,1.D0,1.D0,Tcoeff*tcoff13)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet14 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,6.D0,1.D0,1.D0,Tcoeff*tcoff14)

CCC Sum

      rm1num3e1 = tFjet11*tcoff11+tFjet12*tcoff12+tFjet13*tcoff13+tFjet1
     #4*tcoff14
      RETURN
      END

      double precision function rm1num3e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = 1-z
      t2 = l3-1
      t3 = t2*t1
      t4 = s1vr**2
      t11 = -t1
      t12 = t11**2
      t14 = t2**2
      t29 = t2*t11
      t31 = t29*s34r*s2l2
      t40 = s23r**2
      t60 = t29*s34r*s2l1
      t80 = z*t11
      t92 = 128.D0/3.D0*z*l3*t12*t2*s34r
      t113 = z**2
      taux5 = (64.D0/3.D0*t3*z*t4+(-128.D0/3.D0*t3*z*s23r+64.D0/3.D0*z*t
     #12*t14*s34r)*s1vr)*s13r+(-64.D0/3.D0*s3l2*t4+((128.D0/3.D0*s2l2+64
     #*s3l2+64.D0/3.D0*s4l2)*s23r+64.D0/3.D0*t31+64.D0/3.D0*t29*s3l2*s34
     #r)*s1vr+(-128.D0/3.D0*s2l2-128.D0/3.D0*s3l2-128.D0/3.D0*s4l2)*t40+
     #(-128.D0/3.D0*t31+(-128.D0/3.D0*t29*s3l2-128.D0/3.D0*t29*s4l2)*s34
     #r)*s23r)*s1l1+(-64.D0/3.D0*s3l1*t4+((128.D0/3.D0*s2l1+64*s3l1+64.D
     #0/3.D0*s4l1)*s23r+64.D0/3.D0*t60+64.D0/3.D0*t29*s3l1*s34r)*s1vr+(-
     #128.D0/3.D0*s2l1-128.D0/3.D0*s3l1-128.D0/3.D0*s4l1)*t40+(-128.D0/3
     #.D0*t60+(-128.D0/3.D0*t29*s3l1-128.D0/3.D0*t29*s4l1)*s34r)*s23r)*s
     #1l2+128.D0/3.D0*t80*l3*t4*s1vr+(64.D0/3.D0*t80*l3*s23r-t92+128.D0/
     #3.D0*t80)*t4+(-128.D0/3.D0*t80*l3*t40+(-t92-64.D0/3.D0*(-z-1)*z)*s
     #23r-64.D0/3.D0*(2*z-1)*t11*t2*z*s34r)*s1vr-128.D0/3.D0*t113*t40+12
     #8.D0/3.D0*t3*t113*s34r*s23r
      t4 = s1vr**2
      t11 = 1-z
      t13 = l3-1
      t14 = 6*t11*t13
      t15 = s34r*s2l2
      t22 = -t11
      t23 = -5*t13*t22
      t32 = s23r**2
      t35 = 4*t13*t22
      t56 = s34r*s2l1
      taux6 = ((512*s3l2+2560.D0/3.D0*s4l2)*t4+((2048.D0/3.D0*s2l2+1024*
     #s3l2+1024.D0/3.D0*s4l2)*s23r+256.D0/3.D0*t15*t14+(256.D0/3.D0*t14*
     #s3l2+512.D0/3.D0*t23*s4l2)*s34r)*s1vr+(-2048.D0/3.D0*s2l2-2048.D0/
     #3.D0*s3l2-2048.D0/3.D0*s4l2)*t32+(-512.D0/3.D0*t15*t35+(-512.D0/3.
     #D0*t35*s3l2-512.D0/3.D0*t35*s4l2)*s34r)*s23r)*s1l1+((-512*s3l1-256
     #0.D0/3.D0*s4l1)*t4+((-2048.D0/3.D0*s2l1-1024*s3l1-1024.D0/3.D0*s4l
     #1)*s23r-256.D0/3.D0*t14*t56+(-256.D0/3.D0*t14*s3l1-512.D0/3.D0*t23
     #*s4l1)*s34r)*s1vr+(2048.D0/3.D0*s2l1+2048.D0/3.D0*s3l1+2048.D0/3.D
     #0*s4l1)*t32+(512.D0/3.D0*t35*t56+(512.D0/3.D0*t35*s3l1+512.D0/3.D0
     #*t35*s4l1)*s34r)*s23r)*s1l2

CCC Coefficients

      tcoff11 = taux5
      tcoff12 = taux5
      tcoff13 = taux6
      tcoff14 = taux6

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet11 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,3.D0,1.D0,1.D0,Tcoeff*tcoff11)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet12 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,3.D0,1.D0,1.D0,Tcoeff*tcoff12)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet13 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,6.D0,1.D0,1.D0,Tcoeff*tcoff13)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet14 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,6.D0,1.D0,1.D0,Tcoeff*tcoff14)

CCC Sum

      rm1num3e2 = tFjet11*tcoff11+tFjet12*tcoff12+tFjet13*tcoff13+tFjet1
     #4*tcoff14
      RETURN
      END

      double precision function rm1num3e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = z*t1
      t3 = l3-1
      t4 = s1vr**2
      t11 = t1**2
      t13 = t3**2
      t25 = s23r**2
      t39 = t3*s34r
      t44 = z**2
      taux5 = (64.D0/3.D0*t2*t3*t4+(-128.D0/3.D0*t2*t3*s23r-64.D0/3.D0*z
     #*t11*t13*s34r)*s1vr)*s13r-64.D0/3.D0*t2*l3*s23r*t4+(128.D0/3.D0*t2
     #*l3*t25+(128.D0/3.D0*z*l3*t11*t3*s34r-64.D0/3.D0*(z+1)*z)*s23r-64.
     #D0/3.D0*t2*t39)*s1vr+128.D0/3.D0*t44*t25+128.D0/3.D0*t1*t44*t39*s2
     #3r
      t4 = s1vr**2
      t11 = 1-z
      t12 = l3-1
      t13 = t11*t12
      t14 = s34r*s2l2
      t20 = -t11*t12
      t29 = s23r**2
      t32 = 5*t11*t12
      t53 = s34r*s2l1
      taux6 = ((256.D0/3.D0*s3l2-1024.D0/3.D0*s4l2)*t4+((-2560.D0/3.D0*s
     #2l2-1280*s3l2-1280.D0/3.D0*s4l2)*s23r+256.D0/3.D0*t13*t14+(256.D0/
     #3.D0*t13*s3l2+1024.D0/3.D0*t20*s4l2)*s34r)*s1vr+(2560.D0/3.D0*s2l2
     #+2560.D0/3.D0*s3l2+2560.D0/3.D0*s4l2)*t29+(-512.D0/3.D0*t32*t14+(-
     #512.D0/3.D0*t32*s3l2-512.D0/3.D0*t32*s4l2)*s34r)*s23r)*s1l1+((-256
     #.D0/3.D0*s3l1+1024.D0/3.D0*s4l1)*t4+((2560.D0/3.D0*s2l1+1280*s3l1+
     #1280.D0/3.D0*s4l1)*s23r-256.D0/3.D0*t13*t53+(-256.D0/3.D0*t13*s3l1
     #-1024.D0/3.D0*t20*s4l1)*s34r)*s1vr+(-2560.D0/3.D0*s2l1-2560.D0/3.D
     #0*s3l1-2560.D0/3.D0*s4l1)*t29+(512.D0/3.D0*t32*t53+(512.D0/3.D0*t3
     #2*s3l1+512.D0/3.D0*t32*s4l1)*s34r)*s23r)*s1l2

CCC Coefficients

      tcoff11 = taux5
      tcoff12 = taux5
      tcoff13 = taux6
      tcoff14 = taux6

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet11 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,3.D0,1.D0,1.D0,Tcoeff*tcoff11)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet12 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,3.D0,1.D0,1.D0,Tcoeff*tcoff12)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet13 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,6.D0,1.D0,1.D0,Tcoeff*tcoff13)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet14 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,6.D0,1.D0,1.D0,Tcoeff*tcoff14)

CCC Sum

      rm1num3e3 = tFjet11*tcoff11+tFjet12*tcoff12+tFjet13*tcoff13+tFjet1
     #4*tcoff14
      RETURN
      END

      double precision function rm1num3e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux5 = 0
      t1 = s1vr**2
      t11 = (-1+z)*(l3-1)
      t13 = t11*s34r*s2l2
      t22 = s23r**2
      t42 = t11*s34r*s2l1
      taux6 = (-512.D0/3.D0*s3l2*t1+((1024.D0/3.D0*s2l2+512*s3l2+512.D0/
     #3.D0*s4l2)*s23r+512.D0/3.D0*t13+512.D0/3.D0*t11*s3l2*s34r)*s1vr+(-
     #1024.D0/3.D0*s2l2-1024.D0/3.D0*s3l2-1024.D0/3.D0*s4l2)*t22+(-1024.
     #D0/3.D0*t13+(-1024.D0/3.D0*t11*s3l2-1024.D0/3.D0*t11*s4l2)*s34r)*s
     #23r)*s1l1+(512.D0/3.D0*s3l1*t1+((-1024.D0/3.D0*s2l1-512*s3l1-512.D
     #0/3.D0*s4l1)*s23r-512.D0/3.D0*t42-512.D0/3.D0*t11*s3l1*s34r)*s1vr+
     #(1024.D0/3.D0*s2l1+1024.D0/3.D0*s3l1+1024.D0/3.D0*s4l1)*t22+(1024.
     #D0/3.D0*t42+(1024.D0/3.D0*t11*s3l1+1024.D0/3.D0*t11*s4l1)*s34r)*s2
     #3r)*s1l2

CCC Coefficients

      tcoff11 = taux5
      tcoff12 = taux5
      tcoff13 = taux6
      tcoff14 = taux6

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet11 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,3.D0,1.D0,1.D0,Tcoeff*tcoff11)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet12 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,3.D0,1.D0,1.D0,Tcoeff*tcoff12)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet13 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,6.D0,1.D0,1.D0,Tcoeff*tcoff13)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet14 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,6.D0,1.D0,1.D0,Tcoeff*tcoff14)

CCC Sum

      rm1num3e4 = tFjet11*tcoff11+tFjet12*tcoff12+tFjet13*tcoff13+tFjet1
     #4*tcoff14
      RETURN
      END

      double precision function rm1num4e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = l3-1
      t3 = t1*t2
      t4 = t3*s2l2
      t6 = t3*s3l2
      t7 = 192*t6
      t11 = t3*s4l2
      t12 = 192*t11
      t15 = t1**2
      t16 = t2**2
      t17 = t15*t16
      t18 = s34r*s2l2
      t19 = t17*t18
      t26 = t3*s2l1
      t28 = t3*s3l1
      t29 = 192*t28
      t33 = t3*s4l1
      t34 = 192*t33
      t45 = z*t15
      t46 = l3*t2
      t47 = s1vr**2
      t51 = -t6-t11
      t54 = -t28-t33
      t57 = z*l3
      t58 = t15*t1
      t59 = t58*t16
      t61 = t57*t59*s34r
      t66 = s4l1*s3l2
      t67 = t3*t66
      t68 = 192*t67
      t85 = t17*s3l2
      t87 = t17*s4l2
      t100 = t15**2
      t103 = s34r**2
      t117 = t1*l3
      t122 = t15*s34r
      t123 = t46*t122
      t131 = t59*l3*t103
      t138 = t117*s2l2
      t139 = t117*s3l2
      t140 = t117*s4l2
      t144 = -z-1
      t145 = 96*t144
      t147 = t15*s3l2
      t149 = t46*t147*s34r
      t153 = 96*s4l2
      t158 = 192*t123+384*z
      t162 = t15*t2
      t169 = -96+288*z
      t176 = 96*t131+96*t162*s34r
      t178 = l3*s3l2
      t184 = (1-3*z)*t1
      t185 = t2*s3l2
      t202 = t15*s3l1
      t204 = t46*t202*s34r
      t208 = 96*s4l1
      t229 = t2*s3l1
      t236 = l3**2
      t245 = t117*s3l1*s2l2
      t278 = -192+96*z
      t293 = -t1
      t294 = 384*t293
      t318 = 192*t1
      t328 = t1*z
      s3 = (((288*t4+t7)*s1vr+(-384*t4-t7-t12)*s23r-192*t19-192*t17*s3l2
     #*s34r)*s1l1+((288*t26+t29)*s1vr+(-384*t26-t29-t34)*s23r-192*t17*s3
     #4r*s2l1-192*t17*s3l1*s34r)*s1l2-96*t45*t46*t47+(96*t51*s2l1+96*t54
     #*s2l2+672*t61+(384*t6+t12)*s3l1+t68)*s1vr+(192*t51*s2l1+192*t54*s2
     #l2-384*t61+384*t51*s3l1-384*t67-384*t3*s4l2*s4l1)*s23r+(768*t19+(1
     #92*t85+384*t87)*s34r)*s2l1+(192*t17*s3l1+384*t17*s4l1)*s34r*s2l2-5
     #76*t57*t100*t16*t2*t103+((-384*t85-192*t87)*s3l1-192*t17*t66)*s34r
     #)*s13r
      s4 = ((192*t117*t47+(192*t117*s23r-576*t123)*s1vr+384*t46*t122*s23
     #r+384*t131)*s1l2-192*t117*s3l2*t47+((192*t138+192*t139+192*t140)*s
     #23r+t145*s2l2-96*t149-288*s3l2*t1+t153)*s1vr+(t158*s2l2+(288*t46*t
     #147+96*t162*l3*s4l2)*s34r+t169*s3l2+t169*s4l2)*s23r+t176*s2l2+288*
     #t59*t178*t103+(-96*t184*t185-t12)*s34r)*s1l1
      s2 = s3+s4
      s1 = s2+(-192*t117*s3l1*t47+((192*t117*s2l1+192*t117*s3l1+192*t117
     #*s4l1)*s23r+t145*s2l1-96*t204-288*s3l1*t1+t208)*s1vr+(t158*s2l1+(2
     #88*t46*t202+96*t162*l3*s4l1)*s34r+t169*s3l1+t169*s4l1)*s23r+t176*s
     #2l1+288*l3*t58*t16*s3l1*t103+(-96*t184*t229-t34)*s34r)*s1l2+(96*t4
     #5*t236*s23r+(192*t138+96*t139)*s2l1+96*t245-384*t117*s3l2*s3l1)*t4
     #7+(((-384*t138+192*t139)*s2l1+192*t245-192*z*t236*t58*t2*s34r+(384
     #*t139+192*t140)*s3l1+192*t117*t66+96*t45*l3)*s23r+((-384*t123-192+
     #192*z)*s2l2-192*t149+t278*s3l2-t153)*s2l1+(-192*t204+t278*s3l1-t20
     #8)*s2l2+(384*t162*t178*s3l1-96*t57*t162)*s34r+t294*s3l2*s3l1)*s1vr
      taux7 = s1+((t294*s2l2+192*z*s3l2+192*s4l2)*s2l1+(192*s3l1*z+192*s
     #4l1)*s2l2+192*t144*z*t15*t46*s34r+(-t294*s3l2+t318*s4l2)*s3l1+t318
     #*s4l1*s3l2)*s23r+(-384*t162*t18+(-192*t328*t185+192*t11)*s34r)*s2l
     #1+(-192*t328*t229+192*t33)*s34r*s2l2-192*t57*t59*t103+((-384*t293*
     #t1*t185-t12)*s3l1-t68)*s34r
      t1 = 1-z
      t2 = 3*t1
      t3 = l3-1
      t4 = t2*t3
      t8 = -t1
      t9 = -t8*t3
      t10 = t9*s3l2
      t11 = 768*t10
      t14 = t1*t3
      t17 = t9*s4l2
      t21 = t8**2
      t22 = t3**2
      t23 = t21*t22
      t34 = t9*s3l1
      t35 = 768*t34
      t40 = t9*s4l1
      t52 = t8*t3
      t53 = s4l2*s3l1
      t55 = s4l1*s3l2
      t57 = -t52*t53+t52*t55
      t83 = l3*t2
      t84 = s1vr**2
      t88 = t1*l3
      t97 = l3*t3
      t99 = t97*t21*s34r
      t101 = -384*t99-384*z-384
      t103 = t21*s3l2
      t114 = -768*t99+1536*z
      t118 = t21*t3
      t125 = 1-3*z
      t132 = t21*t8
      t133 = t132*t22
      t134 = s34r**2
      t139 = -384*t133*l3*t134+384*t118*s34r
      t145 = t125*t8
      t149 = t52*s4l2
      t168 = t21*s3l1
      t202 = t52*s4l1
      t208 = t8*l3
      s2 = (((-384*t4*s2l2-t11)*s1vr+(1536*t14*s2l2+t11+768*t17)*s23r-76
     #8*t23*s34r*s2l2-768*t23*s3l2*s34r)*s1l1+((384*t4*s2l1+t35)*s1vr+(-
     #1536*t14*s2l1-t35-768*t40)*s23r+768*t23*s34r*s2l1+768*t23*s3l1*s34
     #r)*s1l2+768*t57*s1vr+((-768*t10-768*t17)*s2l1+(768*t34+768*t40)*s2
     #l2)*s23r+768*t23*s4l2*s34r*s2l1-768*t23*s4l1*s34r*s2l2+(768*t23*t5
     #3-768*t23*t55)*s34r)*s13r+(384*t83*s3l2*t84+((-768*t88*s2l2-1152*t
     #88*s3l2-1152*t88*s4l2)*s23r+t101*s2l2+2304*t97*t103*s34r+384*t2*s3
     #l2+384*s4l2)*s1vr+(t114*s2l2+(-1152*t97*t103-384*t118*l3*s4l2)*s34
     #r-384*t125*s3l2-384*t125*s4l2)*s23r+t139*s2l2-1152*t133*l3*s3l2*t1
     #34+(-384*t145*t3*s3l2-768*t149)*s34r)*s1l1
      s1 = s2+(-384*t83*s3l1*t84+((768*t88*s2l1+1152*t88*s3l1+1152*t88*s
     #4l1)*s23r-t101*s2l1-2304*t97*t168*s34r-384*t2*s3l1-384*s4l1)*s1vr+
     #(-t114*s2l1+(1152*t97*t168+384*t118*l3*s4l1)*s34r+384*t125*s3l1+38
     #4*t125*s4l1)*s23r-t139*s2l1+1152*l3*t132*t22*s3l1*t134+(384*t145*t
     #3*s3l1+768*t202)*s34r)*s1l2+((-768*t208*s3l2*s2l1+768*t208*s3l1*s2
     #l2+768*t208*t53-768*t208*t55)*s23r+(384*s3l2+384*s4l2)*s2l1+(-384*
     #s3l1-384*s4l1)*s2l2+384*t53-384*t55)*s1vr
      taux8 = s1+((-768*z*s3l2-768*s4l2)*s2l1+(768*s3l1*z+768*s4l1)*s2l2
     #+768*t8*s4l2*s3l1-768*t8*s4l1*s3l2)*s23r+(-768*t14*s3l2-768*t149)*
     #s34r*s2l1+(768*t14*s3l1+768*t202)*s34r*s2l2+1536*t57*s34r

CCC Coefficients

      tcoff15 = taux7
      tcoff16 = taux7
      tcoff17 = taux7
      tcoff18 = taux7
      tcoff19 = taux8
      tcoff20 = -taux8
      tcoff21 = taux8
      tcoff22 = -taux8

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet15 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,3.D0,1.D0,1.D0,Tcoeff*tcoff15)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet16 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,3.D0,1.D0,1.D0,Tcoeff*tcoff16)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet17 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,3.D0,1.D0,1.D0,Tcoeff*tcoff17)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet18 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,3.D0,1.D0,1.D0,Tcoeff*tcoff18)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet19 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,6.D0,1.D0,1.D0,Tcoeff*tcoff19)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet20 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,6.D0,1.D0,1.D0,Tcoeff*tcoff20)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet21 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,6.D0,1.D0,1.D0,Tcoeff*tcoff21)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet22 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,6.D0,1.D0,1.D0,Tcoeff*tcoff22)

CCC Sum

      rm1num4e0 = tFjet15*tcoff15+tFjet16*tcoff16+tFjet17*tcoff17+tFjet1
     #8*tcoff18+tFjet19*tcoff19+tFjet20*tcoff20+tFjet21*tcoff21+tFjet22*
     #tcoff22
      RETURN
      END

      double precision function rm1num4e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = t1**2
      t3 = z*t2
      t4 = l3-1
      t5 = t4**2
      t8 = t1*t2
      t10 = t5*t4
      t15 = s13r**2
      t17 = t1*t4
      t19 = 384*t17*s2l2
      t20 = t17*s3l2
      t21 = 192*t20
      t24 = t17*s4l2
      t25 = 192*t24
      t28 = t2*t5
      t32 = s3l2*s34r
      t38 = 384*t17*s2l1
      t39 = t17*s3l1
      t40 = 192*t39
      t43 = t17*s4l1
      t50 = s3l1*s34r
      t55 = t4*l3
      t56 = s1vr**2
      t60 = -t20-t24
      t63 = -t39-t43
      t66 = z*l3
      t67 = t8*t5
      t70 = 192*t66*t67*s34r
      t74 = s4l1*s3l2
      t75 = t17*t74
      t76 = 192*t75
      t77 = 3*z
      t84 = -t60
      t93 = s4l1*s4l2
      t95 = 384*t17*t93
      t96 = -z-1
      t108 = t2**2
      t110 = s34r**2
      t130 = t1*l3
      t132 = 192*t130*s2l2
      t133 = t130*s3l2
      t135 = t130*s4l2
      t144 = t55*t2*s34r
      t146 = 192*z
      t147 = -576*t144-192+t146
      t150 = t55*t2*s3l2
      t152 = t2*t4
      t153 = l3*s4l2
      t155 = 288*t152*t153
      t163 = 384*t144+192-t146
      t169 = -96*t1
      t171 = t169*s4l2
      t179 = 288*t67*l3*t110-96*t152*s34r
      t181 = l3*s3l2
      t193 = 192*t130*s2l1
      t194 = t130*s3l1
      t196 = t130*s4l1
      t206 = t55*t2*s3l1
      t208 = l3*s4l1
      t210 = 288*t152*t208
      t222 = t169*s4l1
      t238 = l3**2
      t251 = t1*z
      t256 = z*t238
      t257 = s23r**2
      t277 = z**2
      t286 = -t169
      t316 = 192*t1
      t329 = 192*t96
      s3 = (-192*t3*t5*s1vr+192*z*t8*t10*s34r)*t15
      s5 = (((-t19-t21)*s1vr+(t19+t21+t25)*s23r+192*t28*s34r*s2l2+192*t2
     #8*t32)*s1l1+((-t38-t40)*s1vr+(t38+t40+192*t43)*s23r+192*t28*s34r*s
     #2l1+192*t28*t50)*s1l2-96*t3*t55*t56+(480*t60*s2l1+480*t63*s2l2+t70
     #+(-384*t20-t25)*s3l1-t76-96*(5-t77)*z*t17)*s1vr+(192*t84*s2l1-192*
     #t63*s2l2+t70+384*t84*s3l1+384*t75+t95-192*t96*z*t17)*s23r+192*t28*
     #t32*s2l1+192*t28*t50*s2l2-96*t66*t108*t10*t110+((384*t28*s3l2+192*
     #t28*s4l2)*s3l1+192*t28*t74+96*(1-t77)*z*t28)*s34r)*s13r
      s6 = ((t132+480*t133+96*t135)*t56+((-t132-288*t133-288*t135)*s23r+
     #t147*s2l2+(-576*t150-t155)*s34r+96*s3l2*t1)*s1vr+(t163*s2l2+(96*t1
     #50+t155)*s34r+t169*s3l2+t171)*s23r+t179*s2l2+(96*t67*t181+192*t67*
     #t153)*t110-96*t152*t32)*s1l1
      s4 = s5+s6
      s2 = s3+s4
      s1 = s2+((t193+480*t194+96*t196)*t56+((-t193-288*t194-288*t196)*s2
     #3r+t147*s2l1+(-576*t206-t210)*s34r+96*s3l1*t1)*s1vr+(t163*s2l1+(96
     #*t206+t210)*s34r+t169*s3l1+t222)*s23r+t179*s2l1+(96*l3*t8*t5*s3l1+
     #192*t67*t208)*t110-96*t152*t50)*s1l2+(96*t3*t238*s23r+(96*t133-96*
     #t135)*s2l1+(96*t194-96*t196)*s2l2+384*t130*s3l2*s3l1-192*t251*l3)*
     #t56+(192*t256*t2*t257+(192*t130*s4l2*s2l1+192*t130*s4l1*s2l2-96*t2
     #56*t8*t4*s34r+(-384*t133-192*t135)*s3l1-192*t130*t74-192*t277*t1*l
     #3)*s23r+(192*t152*t153*s34r+t286*s3l2+t171)*s2l1+(192*t152*t208*s3
     #4r+t286*s3l1+t222)*s2l2+(-384*t152*t181*s3l1+1056*t66*t152)*s34r+(
     #-384*t96*s3l2+480*s4l2)*s3l1+480*t74+192*t93+t146)*s1vr
      taux7 = s1+192*t3*l3*t257+(t316*s4l2*s2l1+t316*s4l1*s2l2-96*(7+z)*
     #z*t2*t55*s34r+(-384*z*s3l2+t329*s4l2)*s3l1+t329*s4l1*s3l2-384*t93+
     #96*(-1-3*t277)*z)*s23r+192*t152*s4l2*s34r*s2l1+192*t152*s4l1*s34r*
     #s2l2-480*t66*t67*t110+((-384*t251*t4*s3l2-t25)*s3l1-t76-t95+96*t15
     #2*z)*s34r
      t1 = -1+z
      t3 = l3-1
      t4 = 13*t1*t3
      t8 = 4*t1*t3
      t9 = t8*s3l2
      t10 = 768*t9
      t13 = 4*t1
      t14 = t13*t3
      t17 = t8*s4l2
      t21 = t1**2
      t22 = t3**2
      t23 = t21*t22
      t34 = t8*s3l1
      t35 = 768*t34
      t40 = t8*s4l1
      t52 = 2*t1
      t53 = t52*t3
      t64 = -t1
      t65 = 3*t64
      t66 = t65*t3
      t67 = s4l2*s3l1
      t70 = s4l1*s3l2
      t104 = t1*l3
      t107 = 6*t1
      t108 = t107*l3
      t112 = s1vr**2
      t114 = t13*l3
      t117 = t52*l3
      t124 = l3*t3
      t126 = t124*t21*s34r
      t129 = 2304*t126+384+1920*z
      t133 = t124*t21*s3l2*s34r
      t135 = 10*t1
      t138 = 1152*s4l2
      t143 = -768*t126+768-5376*z
      t147 = -4+10*z
      t154 = t21*t1
      t155 = t154*t22
      t156 = s34r**2
      t163 = -768*t155*l3*t156-1536*t3*t21*s34r
      t169 = t147*t1
      t170 = t3*s3l2
      t197 = t124*t21*s3l1*s34r
      t201 = 1152*s4l1
      t220 = t3*s3l1
      t237 = -t107*l3
      t240 = -t52*l3
      t258 = -3+6*z
      t272 = -t258
      t275 = -2*z-1
      t295 = (-3*z+4)*t1
      t297 = t64*t3
      t309 = t1*t3
      s3 = (((-384*t4*s2l2-t10)*s1vr+(1536*t14*s2l2+t10+768*t17)*s23r+30
     #72*t23*s34r*s2l2+3072*t23*s3l2*s34r)*s1l1+((384*t4*s2l1+t35)*s1vr+
     #(-1536*t14*s2l1-t35-768*t40)*s23r-3072*t23*s34r*s2l1-3072*t23*s3l1
     #*s34r)*s1l2+((384*t53*s3l2+384*t53*s4l2)*s2l1+(-384*t53*s3l1-384*t
     #53*s4l1)*s2l2-768*t66*t67+768*t66*t70)*s1vr+((-768*t9-768*t17)*s2l
     #1+(768*t34+768*t40)*s2l2)*s23r+(-768*t23*s3l2-2304*t23*s4l2)*s34r*
     #s2l1+(768*t23*s3l1+2304*t23*s4l1)*s34r*s2l2+(-2304*t23*t67+2304*t2
     #3*t70)*s34r)*s13r
      s4 = ((768*t104*s2l2+384*t108*s3l2)*t112+((-768*t114*s2l2-1152*t11
     #7*s3l2-1152*t117*s4l2)*s23r+t129*s2l2-3840*t133+384*t135*s3l2-t138
     #)*s1vr+(t143*s2l2+1536*t133-384*t147*s3l2-384*t147*s4l2)*s23r+t163
     #*s2l2+1536*t155*l3*s3l2*t156+(-384*t169*t170-768*t66*s4l2)*s34r)*s
     #1l1
      s2 = s3+s4
      s1 = s2+((-768*t104*s2l1-384*t108*s3l1)*t112+((768*t114*s2l1+1152*
     #t117*s3l1+1152*t117*s4l1)*s23r-t129*s2l1+3840*t197-384*t135*s3l1+t
     #201)*s1vr+(-t143*s2l1-1536*t197+384*t147*s3l1+384*t147*s4l1)*s23r-
     #t163*s2l1-1536*l3*t154*t22*s3l1*t156+(384*t169*t220+768*t66*s4l1)*
     #s34r)*s1l2+(-384*t108*s3l2*s2l1+384*t108*s3l1*s2l2)*t112
      taux8 = s1+(((-768*t237*s3l2-768*t240*s4l2)*s2l1+(768*t237*s3l1+76
     #8*t240*s4l1)*s2l2-2304*t104*t67+2304*t104*t70)*s23r+(2304*t133-384
     #*t258*s3l2-t138)*s2l1+(-2304*t197+384*t258*s3l1+t201)*s2l2+384*t67
     #-384*t70)*s1vr+((-768*t272*s3l2-768*t275*s4l2)*s2l1+(768*t272*s3l1
     #+768*t275*s4l1)*s2l2+768*t65*s4l2*s3l1-768*t65*s4l1*s3l2)*s23r+(-7
     #68*t295*t170-768*t297*s4l2)*s34r*s2l1+(768*t295*t220+768*t297*s4l1
     #)*s34r*s2l2+(3072*t309*t67-3072*t309*t70)*s34r

CCC Coefficients

      tcoff15 = taux7
      tcoff16 = taux7
      tcoff17 = taux7
      tcoff18 = taux7
      tcoff19 = taux8
      tcoff20 = -taux8
      tcoff21 = taux8
      tcoff22 = -taux8

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet15 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,3.D0,1.D0,1.D0,Tcoeff*tcoff15)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet16 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,3.D0,1.D0,1.D0,Tcoeff*tcoff16)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet17 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,3.D0,1.D0,1.D0,Tcoeff*tcoff17)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet18 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,3.D0,1.D0,1.D0,Tcoeff*tcoff18)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet19 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,6.D0,1.D0,1.D0,Tcoeff*tcoff19)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet20 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,6.D0,1.D0,1.D0,Tcoeff*tcoff20)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet21 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,6.D0,1.D0,1.D0,Tcoeff*tcoff21)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet22 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,6.D0,1.D0,1.D0,Tcoeff*tcoff22)

CCC Sum

      rm1num4e1 = tFjet15*tcoff15+tFjet16*tcoff16+tFjet17*tcoff17+tFjet1
     #8*tcoff18+tFjet19*tcoff19+tFjet20*tcoff20+tFjet21*tcoff21+tFjet22*
     #tcoff22
      RETURN
      END

      double precision function rm1num4e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = t1**2
      t3 = z*t2
      t4 = l3-1
      t5 = t4**2
      t8 = t1*t2
      t10 = t5*t4
      t15 = s13r**2
      t17 = t4*l3
      t18 = s1vr**2
      t22 = z*l3
      t23 = t8*t5
      t25 = t22*t23*s34r
      t29 = t1*t4
      t40 = t2**2
      t42 = s34r**2
      t54 = l3**2
      t62 = z*t54
      t65 = t62*t8*t4*s34r
      t67 = z**2
      t73 = s23r**2
      t92 = t17*s34r
      taux7 = (192*t3*t5*s1vr-192*z*t8*t10*s34r)*t15+(-576*t3*t17*t18+(4
     #80*t25-96*(-5+z)*z*t29)*s1vr+(192*t25-192*(z+1)*z*t29)*s23r+96*t22
     #*t40*t10*t42+96*(-3+z)*z*t2*t5*s34r)*s13r-192*t3*t54*t18*s1vr+(384
     #*t3*t54*s23r+576*t65-192*t67*t1*l3)*t18+(-192*t62*t2*t73+(-672*t65
     #+96*(-3+5*z)*z*t1*l3)*s23r-384*t5*z*t54*t40*t42+576*t67*t2*t92-192
     #*t1*z)*s1vr-192*t3*l3*t73+(-96*(-3+7*z)*z*t2*t92+96*(-1+t67)*z)*s2
     #3r-96*(-1+4*z)*l3*z*t23*t42+96*t2*t4*z*s34r
      t1 = 1-z
      t3 = l3-1
      t4 = 18*t1*t3
      t9 = -t1
      t10 = -5*t9*t3
      t11 = t10*s3l2
      t12 = 768*t11
      t15 = 5*t1
      t16 = t15*t3
      t19 = t10*s4l2
      t23 = t9**2
      t24 = t3**2
      t25 = t23*t24
      t36 = t10*s3l1
      t37 = 768*t36
      t42 = t10*s4l1
      t54 = 9*t1
      t55 = t54*t3
      t66 = t9*t3
      t67 = s4l2*s3l1
      t70 = s4l1*s3l2
      t104 = 3*t1
      t105 = t104*l3
      t108 = t15*l3
      t111 = t1*l3
      t112 = t111*s4l2
      t115 = s1vr**2
      t124 = l3*t3
      t126 = t124*t23*s34r
      t129 = -768*t126+1536-3072*z
      t132 = t124*t23*s3l2
      t134 = t23*t3
      t135 = l3*s4l2
      t136 = t134*t135
      t147 = 3072*t126-2304+5376*z
      t154 = 5-9*z
      t161 = t23*t9
      t162 = t161*t24
      t163 = s34r**2
      t168 = 1920*t162*l3*t163+1920*t134*s34r
      t177 = t154*t9
      t178 = t3*s3l2
      t191 = t111*s4l1
      t205 = t124*t23*s3l1
      t207 = l3*s4l1
      t208 = t134*t207
      t239 = t3*s3l1
      t249 = 13*t1*l3
      t260 = t9*l3
      t264 = -t104*l3
      t286 = 11-13*z
      t289 = 3-z
      t309 = 4*z-3
      t312 = 3*z
      t313 = -1+t312
      t333 = (t312-2)*t9
      t337 = (-z-1)*t9
      s3 = (((-384*t4*s2l2-t12)*s1vr+(1536*t16*s2l2+t12+768*t19)*s23r-38
     #40*t25*s34r*s2l2-3840*t25*s3l2*s34r)*s1l1+((384*t4*s2l1+t37)*s1vr+
     #(-1536*t16*s2l1-t37-768*t42)*s23r+3840*t25*s34r*s2l1+3840*t25*s3l1
     #*s34r)*s1l2+((384*t55*s3l2+384*t55*s4l2)*s2l1+(-384*t55*s3l1-384*t
     #55*s4l1)*s2l2-1536*t66*t67+1536*t66*t70)*s1vr+((-768*t11-768*t19)*
     #s2l1+(768*t36+768*t42)*s2l2)*s23r+(2304*t25*s3l2+1536*t25*s4l2)*s3
     #4r*s2l1+(-2304*t25*s3l1-1536*t25*s4l1)*s34r*s2l2+(1536*t25*t67-153
     #6*t25*t70)*s34r)*s13r
      s4 = ((768*t105*s2l2+384*t108*s3l2+384*t112)*t115+((-768*t108*s2l2
     #-1152*t111*s3l2-1152*t112)*s23r+t129*s2l2+(768*t132+1152*t136)*s34
     #r+384*t54*s3l2+768*s4l2)*s1vr+(t147*s2l2+(1152*t132+384*t136)*s34r
     #-384*t154*s3l2-384*t154*s4l2)*s23r+t168*s2l2+(1152*t162*l3*s3l2-76
     #8*t162*t135)*t163+(-384*t177*t178-1536*t66*s4l2)*s34r)*s1l1
      s2 = s3+s4
      s1 = s2+((-768*t105*s2l1-384*t108*s3l1-384*t191)*t115+((768*t108*s
     #2l1+1152*t111*s3l1+1152*t191)*s23r-t129*s2l1+(-768*t205-1152*t208)
     #*s34r-384*t54*s3l1-768*s4l1)*s1vr+(-t147*s2l1+(-1152*t205-384*t208
     #)*s34r+384*t154*s3l1+384*t154*s4l1)*s23r-t168*s2l1+(-1152*l3*t161*
     #t24*s3l1+768*t162*t207)*t163+(384*t177*t239+1536*t66*s4l1)*s34r)*s
     #1l2+((-384*t249*s3l2+384*t112)*s2l1+(384*t249*s3l1-384*t191)*s2l2)
     #*t115
      taux8 = s1+(((-6144*t260*s3l2-768*t264*s4l2)*s2l1+(6144*t260*s3l1+
     #768*t264*s4l1)*s2l2+1536*t260*t67-1536*t260*t70)*s23r+((-4608*t132
     #+768*t136)*s34r-384*t286*s3l2+384*t289*s4l2)*s2l1+((4608*t205-768*
     #t208)*s34r+384*t286*s3l1-384*t289*s4l1)*s2l2-1152*t67+1152*t70)*s1
     #vr+((-1536*t309*s3l2-768*t313*s4l2)*s2l1+(1536*t309*s3l1+768*t313*
     #s4l1)*s2l2+1536*t9*s4l2*s3l1-1536*t9*s4l1*s3l2)*s23r+(-1536*t333*t
     #178-768*t337*t3*s4l2)*s34r*s2l1+(1536*t333*t239+768*t337*t3*s4l1)*
     #s34r*s2l2

CCC Coefficients

      tcoff15 = taux7
      tcoff16 = taux7
      tcoff17 = taux7
      tcoff18 = taux7
      tcoff19 = taux8
      tcoff20 = -taux8
      tcoff21 = taux8
      tcoff22 = -taux8

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet15 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,3.D0,1.D0,1.D0,Tcoeff*tcoff15)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet16 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,3.D0,1.D0,1.D0,Tcoeff*tcoff16)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet17 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,3.D0,1.D0,1.D0,Tcoeff*tcoff17)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet18 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,3.D0,1.D0,1.D0,Tcoeff*tcoff18)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet19 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,6.D0,1.D0,1.D0,Tcoeff*tcoff19)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet20 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,6.D0,1.D0,1.D0,Tcoeff*tcoff20)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet21 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,6.D0,1.D0,1.D0,Tcoeff*tcoff21)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet22 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,6.D0,1.D0,1.D0,Tcoeff*tcoff22)

CCC Sum

      rm1num4e2 = tFjet15*tcoff15+tFjet16*tcoff16+tFjet17*tcoff17+tFjet1
     #8*tcoff18+tFjet19*tcoff19+tFjet20*tcoff20+tFjet21*tcoff21+tFjet22*
     #tcoff22
      RETURN
      END

      double precision function rm1num4e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux7 = 0
      t1 = -1+z
      t2 = l3-1
      t3 = t1*t2
      t5 = 3072*t3*s2l2
      t6 = t3*s3l2
      t7 = 1536*t6
      t10 = t3*s4l2
      t14 = t1**2
      t15 = t2**2
      t16 = t14*t15
      t20 = s3l2*s34r
      t26 = 3072*t3*s2l1
      t27 = t3*s3l1
      t28 = 1536*t27
      t31 = t3*s4l1
      t38 = s3l1*s34r
      t43 = t6+t10
      t46 = -t27-t31
      t67 = t1*l3
      t69 = 1536*t67*s2l2
      t70 = t67*s3l2
      t72 = t67*s4l2
      t75 = s1vr**2
      t81 = l3*t2
      t83 = t81*t14*s34r
      t85 = 1536*z
      t86 = -4608*t83-1536+t85
      t89 = t81*t14*s3l2
      t91 = t14*t2
      t92 = l3*s4l2
      t94 = 2304*t91*t92
      t98 = 768*s3l2*t1
      t102 = 3072*t83+1536-t85
      t107 = t1*s4l2
      t108 = 768*t107
      t111 = t14*t1
      t112 = t111*t15
      t113 = s34r**2
      t119 = 2304*t112*l3*t113-768*t91*s34r
      t133 = 1536*t67*s2l1
      t134 = t67*s3l1
      t136 = t67*s4l1
      t147 = t81*t14*s3l1
      t149 = l3*s4l1
      t151 = 2304*t91*t149
      t155 = 768*s3l1*t1
      t163 = t1*s4l1
      t164 = 768*t163
      s2 = (((-t5-t7)*s1vr+(t5+t7+1536*t10)*s23r+1536*t16*s34r*s2l2+1536
     #*t16*t20)*s1l1+((t26+t28)*s1vr+(-t26-t28-1536*t31)*s23r-1536*t16*s
     #34r*s2l1-1536*t16*t38)*s1l2+(3840*t43*s2l1+3840*t46*s2l2)*s1vr+(-1
     #536*t43*s2l1-1536*t46*s2l2)*s23r-1536*t16*t20*s2l1+1536*t16*t38*s2
     #l2)*s13r+((t69+3840*t70+768*t72)*t75+((-t69-2304*t70-2304*t72)*s23
     #r+t86*s2l2+(-4608*t89-t94)*s34r+t98)*s1vr+(t102*s2l2+(768*t89+t94)
     #*s34r-t98-t108)*s23r+t119*s2l2+(768*t112*l3*s3l2+1536*t112*t92)*t1
     #13-768*t91*t20)*s1l1
      s1 = s2+((-t133-3840*t134-768*t136)*t75+((t133+2304*t134+2304*t136
     #)*s23r-t86*s2l1+(4608*t147+t151)*s34r-t155)*s1vr+(-t102*s2l1+(-768
     #*t147-t151)*s34r+t155+t164)*s23r-t119*s2l1+(-768*l3*t111*t15*s3l1-
     #1536*t112*t149)*t113+768*t91*t38)*s1l2+((-768*t70+768*t72)*s2l1+(7
     #68*t134-768*t136)*s2l2)*t75
      taux8 = s1+((-1536*t67*s4l2*s2l1+1536*t67*s4l1*s2l2)*s23r+(-1536*t
     #91*t92*s34r-t98+t108)*s2l1+(1536*t91*t149*s34r+t155-t164)*s2l2-230
     #4*s4l2*s3l1+2304*s4l1*s3l2)*s1vr+(-1536*t107*s2l1+1536*t163*s2l2)*
     #s23r-1536*t91*s4l2*s34r*s2l1+1536*t91*s4l1*s34r*s2l2

CCC Coefficients

      tcoff15 = taux7
      tcoff16 = taux7
      tcoff17 = taux7
      tcoff18 = taux7
      tcoff19 = taux8
      tcoff20 = -taux8
      tcoff21 = taux8
      tcoff22 = -taux8

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet15 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,3.D0,1.D0,1.D0,Tcoeff*tcoff15)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet16 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,3.D0,1.D0,1.D0,Tcoeff*tcoff16)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet17 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,3.D0,1.D0,1.D0,Tcoeff*tcoff17)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet18 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,3.D0,1.D0,1.D0,Tcoeff*tcoff18)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet19 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,6.D0,1.D0,1.D0,Tcoeff*tcoff19)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet20 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,6.D0,1.D0,1.D0,Tcoeff*tcoff20)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet21 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,6.D0,1.D0,1.D0,Tcoeff*tcoff21)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet22 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,6.D0,1.D0,1.D0,Tcoeff*tcoff22)

CCC Sum

      rm1num4e3 = tFjet15*tcoff15+tFjet16*tcoff16+tFjet17*tcoff17+tFjet1
     #8*tcoff18+tFjet19*tcoff19+tFjet20*tcoff20+tFjet21*tcoff21+tFjet22*
     #tcoff22
      RETURN
      END

      double precision function rm1num4e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux7 = 0
      taux8 = 0

CCC Coefficients

      tcoff15 = taux7
      tcoff16 = taux7
      tcoff17 = taux7
      tcoff18 = taux7
      tcoff19 = taux8
      tcoff20 = -taux8
      tcoff21 = taux8
      tcoff22 = -taux8

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet15 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,3.D0,1.D0,1.D0,Tcoeff*tcoff15)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet16 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,3.D0,1.D0,1.D0,Tcoeff*tcoff16)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet17 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,3.D0,1.D0,1.D0,Tcoeff*tcoff17)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet18 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,3.D0,1.D0,1.D0,Tcoeff*tcoff18)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet19 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,6.D0,1.D0,1.D0,Tcoeff*tcoff19)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet20 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,6.D0,1.D0,1.D0,Tcoeff*tcoff20)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet21 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,6.D0,1.D0,1.D0,Tcoeff*tcoff21)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet22 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,6.D0,1.D0,1.D0,Tcoeff*tcoff22)

CCC Sum

      rm1num4e4 = tFjet15*tcoff15+tFjet16*tcoff16+tFjet17*tcoff17+tFjet1
     #8*tcoff18+tFjet19*tcoff19+tFjet20*tcoff20+tFjet21*tcoff21+tFjet22*
     #tcoff22
      RETURN
      END

