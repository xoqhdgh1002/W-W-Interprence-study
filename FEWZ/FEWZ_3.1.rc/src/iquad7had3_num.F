CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCC Numerator functions CCCCCCCCCCCCCCCCCCCCCCCCCC

      double precision function qbiq7num1e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = l3*t1
      t4 = t2*s3l2*s2l1
      t7 = t2*s3l1*s2l2
      t9 = s4l2*s3l1
      t11 = 192*t2*t9
      t12 = s4l1*s3l2
      t14 = 192*t2*t12
      t17 = 1/s2vr
      t18 = t17*s4l2
      t19 = t18*s3l1
      t20 = t2*t19
      t21 = t17*s4l1
      t22 = t21*s3l2
      t23 = t2*t22
      t24 = l3*z
      t25 = l3-t24-1+z
      t28 = t2*z*t25*t17
      t33 = t1*s2l1*l3
      t35 = t2*s3l1
      t37 = t2*s4l1
      t46 = t1**2
      t47 = l3-1
      t48 = t46*t47
      t49 = l3*s34r
      t50 = t48*t49
      t52 = 192*z
      t53 = -384*t50+192+t52
      t55 = l3*t47
      t56 = t46*s3l1
      t57 = t55*t56
      t59 = l3*s4l1
      t60 = t48*t59
      t64 = -96+t52
      t67 = -192+384*z
      t73 = s23r**2
      t76 = 96*t50-96-96*z
      t83 = -t64
      t87 = t46*t1
      t88 = t47**2
      t89 = t87*t88
      t90 = s34r**2
      t93 = 192*t89*l3*t90
      t94 = 3*z
      t100 = t93+96*(1-t94)*t1*t47*s34r
      t111 = (1-2*z)*t1
      t116 = (3-4*z)*t1
      t117 = t47*s4l1
      t123 = 1/s1vr
      t128 = l3*t17
      t129 = t48*t128
      t131 = r**2
      t132 = 1+t131
      t133 = r+t
      t137 = 1+r*t
      t139 = t132/t133/t137
      t140 = l1*r*t139
      t142 = t2*t17
      t143 = t17*s23r
      t145 = t128*s34r
      t146 = t48*t145
      t151 = t48*t128*s2l2
      t154 = t48*t128*s3l2
      t155 = 288*t154
      t156 = l3*t46
      t157 = t47*t17
      t160 = 192*t156*t157*s4l2
      t165 = t17*s2l2
      t168 = t17*s3l2
      t169 = t2*t168
      t170 = 288*t169
      t171 = t2*t18
      t172 = 96*t171
      t176 = (-l3+t24-2)*t17
      t181 = 2*l3
      t182 = 2*t24
      t184 = (-t181+t182+1)*t17
      t193 = t48*t128*s3l1
      t194 = 288*t193
      t197 = 192*t156*t157*s4l1
      t202 = t17*s2l1
      t205 = t17*s3l1
      t206 = t2*t205
      t207 = 288*t206
      t208 = t1*t17
      t209 = t59*t208
      t210 = 96*t209
      t221 = t46**2
      t222 = l3**2
      t224 = z*t88
      t227 = l1**2
      t229 = t132**2
      t230 = t133**2
      t233 = t137**2
      t235 = t229/t230/t233
      t236 = t227*t131*t235
      t239 = t222*t87
      t240 = t239*z
      t247 = t156*t47
      t251 = t224*t221
      t252 = t222*t17
      t253 = t252*s34r
      t256 = t168*s3l1
      t258 = 384*t247*t256
      t259 = t48*z
      t261 = 6*t24
      t277 = z*t47
      t279 = t277*t87*t253
      t282 = 192*t171
      t286 = 96*t28
      t290 = t1*t47
      t291 = t290*t17
      t298 = z*t17
      t301 = 2-z-t181+t182
      t302 = t301*t17
      t319 = 4*l3
      t333 = z**2
      t337 = t222*z
      s1 = ((192*t129*t140-192*t142-192*t2*t143-192*t146)*s1l2+(96*t151+
     #t155-t160)*l1*r*t139+(-192*t2*t165-t170-t172)*s23r-96*t176*s2l2+(-
     #t155+t160)*s34r-t170+96*t184*s4l2)*s1l1+((96*t48*t128*s2l1+t194-t1
     #97)*l1*r*t139+(-192*t2*t202-t207-t210)*s23r-96*t176*s2l1+(-t194+t1
     #97)*s34r-t207+96*t184*s4l1)*s1l2+288*t221*t222*t224*t17*t236+(-96*
     #t240*t157*s23r+(384*t151+t160)*s2l1+192*t247*t21*s2l2-384*t251*t25
     #3+t258-96*t259*l3*(-6*l3+t261-t94+3)*t17)*l1*r*t139+((-96*t169-96*
     #t171)*s2l1+(-96*t206-96*t209)*s2l2+192*t279+(-384*t169-t282)*s3l1-
     #192*t23-t286)*s23r+((-192*t146-384*t291)*s2l2+(96*t154-t160)*s34r+
     #96*t298*s3l2-96*t302*s4l2)*s2l1
      t345 = s1+((96*t193-t197)*s34r+96*t298*s3l1-96*t302*s4l1)*s2l2+96*
     #t251*t252*t90+(-t258+96*t259*l3*(2-t94-t319+4*t24)*t17)*s34r-384*t
     #2*t256-384*t18*s4l1+96*z*(t261-3*l3-3*l3*t333+3*t222-6*t337+3*t222
     #*t333)*t17
      t362 = t1*s2l2*l3
      t364 = t2*s3l2
      t366 = t2*s4l2
      t376 = t46*s3l2
      t377 = t55*t376
      t379 = l3*s4l2
      t380 = t48*t379
      t410 = t47*s4l2
      t419 = t290*s2l2
      t421 = t290*s3l2
      t423 = t290*s4l2
      t424 = 192*t423
      t425 = 192*t419
      t426 = 96*t421
      t430 = t46*t88
      t432 = t430*s34r*s2l2
      t434 = t430*s3l2
      t436 = t430*s4l2
      t444 = t290*s2l1
      t446 = t290*s3l1
      t448 = t290*s4l1
      t449 = 192*t448
      t451 = 96*t446
      t458 = t430*s3l1
      t460 = t430*s4l1
      t479 = l3*t87
      t481 = t479*t224*s34r
      t484 = 192*t290*t9
      t486 = 192*t290*t12
      t487 = s4l2*s4l1
      t489 = 384*t290*t487
      t528 = (-96*t419-288*t421-t424+((t425+t426+96*t423)*s23r+288*t432+
     #(288*t434+192*t436)*s34r)*t123)*s1l1+(-96*t444-288*t446-t449+((192
     #*t444+t451+96*t448)*s23r+288*t430*s34r*s2l1+(288*t458+192*t460)*s3
     #4r)*t123)*s1l2-192*t277*t156*s1vr+672*t277*t156*s23r+(-384*t419+t4
     #26-t424)*s2l1+(t451-t449)*s2l2+480*t481-t484-t486-t489+(-384*t277*
     #t156*t73+((t425+t426+288*t423)*s2l1+(t451+288*t448)*s2l2-864*t481+
     #t484+t486+t489)*s23r+(-192*t432+(-96*t434+96*t436)*s34r)*s2l1+(-96
     #*t458+96*t460)*s34r*s2l2-288*l3*t221*t88*t47*z*t90+(192*t430*t9+19
     #2*t430*t12+384*t430*t487)*s34r)*t123
      t567 = s13r**2
      t569 = z*t46
      t576 = t222*t47
      t577 = t87*t17
      t587 = t46*t222
      t591 = 96*t587*t205
      t593 = 192*t587*t21
      t597 = t576*t577*s34r
      t599 = -l3+t24+1
      t603 = 96*t597+192*t599*l3*t208
      t606 = (-1+t181)*l3
      t607 = t46*t17
      t616 = t587*t17*s34r
      t619 = -192*t616-96*t142
      t621 = t205*s34r
      t624 = 96*t206
      t625 = 192*t209
      t629 = t576*t577*t90
      t639 = -192*t629+96*t2*(-2+l3-t24)*t17*s34r-96*(-l3+t24+1+z)*t17
      t641 = t239*t47
      s2 = (96*t4+96*t7+t11+t14)*s1vr+(-96*t20-96*t23+96*t28)*s34r+((192
     #*t33+384*t35+384*t37)*s1vr+(-288*t33-480*t35-288*t37)*s23r+t53*s2l
     #1+(-672*t57-576*t60)*s34r+t64*s3l1+t67*s4l1+((96*t33+288*t35+96*t3
     #7)*t73+(t76*s2l1+(576*t57+96*t60)*s34r+96*s3l1+t83*s4l1)*s23r+t100
     #*s2l1+(288*t89*l3*s3l1+192*t89*t59)*t90+(96*t111*t47*s3l1+96*t116*
     #t117)*s34r)*t123)*s1l2
      s1 = s2-96*t22+t345*s13r+((384*t2*s1vr-384*t2*s23r-576*t50+(384*t2
     #*t73+576*t48*t49*s23r+t93)*t123)*s1l2+(192*t362+384*t364+384*t366)
     #*s1vr+(-288*t362-480*t364-288*t366)*s23r+t53*s2l2+(-672*t377-576*t
     #380)*s34r+t64*s3l2+t67*s4l2+((96*t362+288*t364+96*t366)*t73+(t76*s
     #2l2+(576*t377+96*t380)*s34r+96*s3l2+t83*s4l2)*s23r+t100*s2l2+(288*
     #t89*l3*s3l2+192*t89*t379)*t90+(96*t111*t47*s3l2+96*t116*t410)*s34r
     #)*t123)*s1l1
      t653 = s1+t528*s13r+(-96*t290*t165*s1l1-96*t290*t202*s1l2-480*t89*
     #t24*t17*t140+384*t259*t128*s23r+(-384*t290*t165-96*t290*t168-288*t
     #290*t18)*s2l1+(-96*t290*t205-288*t290*t21)*s2l2+480*t89*z*t145+96*
     #t290*z*(-5*l3+5*t24)*t17)*t567-96*t569*t222*t73-96*t19+t64*s4l1*s3
     #l2+((-96*t576*t577*s2l1-96*t576*t577*s3l1)*t227*t131*t235+((96*t58
     #7*t202+t591+t593)*s23r+t603*s2l1+96*t606*t607*s3l1+t210)*l1*r*t139
     #+(t619*s2l1+96*t587*t621-t624-t625)*s23r+t639*s2l1+96*t641*t205*t9
     #0+(96*t156*t205-288*t209)*s34r-t624-96*t21)*s1l2
      t658 = t2*(z+l3-t24)
      t659 = t168*s34r
      t662 = t599*t17
      t675 = 96*t169
      t691 = 192-288*z
      t700 = 384*s3l2
      t701 = -t1
      t702 = 192*t701
      t712 = (-2+z)*t1*t47
      t726 = 2*t701*t1
      t751 = 192*t142
      t763 = t576*t577*s2l2
      t765 = t576*t577*s3l2
      t774 = 96*t587*t168
      t776 = 192*t587*t18
      t818 = 96+96*z
      t838 = t222*l3
      t877 = t301*l3
      s2 = ((-384*t146-384*t291)*s2l2-96*t658*t659-96*t662*s3l2-192*t18)
     #*s2l1+(-96*t658*t621-96*t662*s3l1-192*t21)*s2l2+((t675+t282)*s2l1+
     #(t624+t625)*s2l2-96*t587*z*t25*t17*s34r+t286)*s23r
      s1 = s2+(-96*t569*l3*t73+(t691*s3l2*s2l1+t691*s3l1*s2l2+96*t333*t4
     #7*t156*s34r+(t700+t702*s4l2)*s3l1+t702*s4l1*s3l2)*s23r-96*t712*s3l
     #2*s34r*s2l1-96*t712*s3l1*s34r*s2l2-96*t479*t224*t90+((384*t421+96*
     #t726*t410)*s3l1+96*t726*t117*s3l2)*s34r)*t123+((192*t576*t577*t236
     #+(-192*t587*t143-768*t597-192*t606*t607)*l1*r*t139+(576*t616+t751)
     #*s23r+576*t629+192*t156*(t319-1)*t17*s34r+t751)*s1l2+(-96*t763-96*
     #t765)*t227*t131*t235+((96*t587*t165+t774+t776)*s23r+t603*s2l2+96*t
     #606*t607*s3l2+t172)*l1*r*t139+(t619*s2l2+96*t587*t659-t675-t282)*s
     #23r+t639*s2l2+96*t641*t168*t90+(96*t156*t168-288*t171)*s34r-t675-9
     #6*t18)*s1l1+(-t700+t64*s4l2)*s3l1
      t897 = s1+(-288*t4-288*t7+96*t277*t239*s34r-t11-t14)*s23r+(-96*t55
     #*t376*s34r+t818*s3l2)*s2l1+(-96*t55*t56*s34r+t818*s3l1)*s2l2+(-192
     #*t48*t379*s3l1-192*t48*t59*s3l2)*s34r+96*t240*t157*t90+(-96*t47*t8
     #38*t221*t298*s23r+(-384*t763-96*t765)*s2l1-96*t641*t205*s2l2)*t227
     #*t131*t235+(((-t774-t776)*s2l1+(-t591-t593)*s2l2-96*t838*t221*z*t1
     #57*s34r-192*t25*t46*t337*t17)*s23r+((384*t597+768*t129)*s2l2-96*t6
     #41*t659+96*t877*t208*s3l2+t282)*s2l1+(-96*t641*t621+96*t877*t208*s
     #3l1+t625)*s2l2+96*t279+96*t20+96*t23)*l1*r*t139
      taux1 = t653+t897
      t1 = -1+z
      t2 = l3-1
      t3 = t1*t2
      t4 = t3*s2l2
      t6 = -t1
      t7 = 3*t6
      t8 = t7*t2
      t11 = t6*t2
      t12 = t11*s4l2
      t20 = t1**2
      t21 = t2**2
      t22 = t20*t21
      t26 = t22*s3l2
      t29 = 768*t22*s4l2
      t33 = 1/s1vr
      t37 = t3*s2l1
      t41 = t11*s4l1
      t52 = t22*s3l1
      t55 = 768*t22*s4l1
      t63 = -t7*t2
      t64 = s3l2*s2l1
      t67 = s3l1*s2l2
      t70 = s4l2*s3l1
      t72 = 768*t3*t70
      t73 = s4l1*s3l2
      t75 = 768*t3*t73
      t76 = 2*t1
      t77 = t76*t2
      t106 = t1*s2l2*l3
      t108 = t6*l3
      t116 = t76*l3
      t119 = t7*l3
      t124 = -t2
      t125 = 2*t124
      t129 = t125*t20*l3*s34r+1+z
      t130 = 768*t129
      t132 = t124*t20
      t133 = l3*s3l2
      t136 = t2*t20
      t137 = l3*s4l2
      t142 = 2*z
      t143 = 1-t142
      t146 = t143*s4l2
      t149 = -t76*l3
      t153 = s23r**2
      t156 = -384*t129
      t159 = -t125*t20
      t169 = t20*t1
      t170 = t169*t21
      t171 = s34r**2
      t180 = 384*t170*l3*t171+384*(1-3*z)*t1*t2*s34r
      t185 = t143*t1
      t190 = (3-4*z)*t1
      t191 = t2*s4l2
      t201 = t1*s2l1*l3
      t218 = l3*s3l1
      t221 = l3*s4l1
      t228 = t143*s4l1
      t252 = t2*s4l1
      t261 = l3*t1
      t267 = 768*t108*t70
      t269 = 768*t108*t73
      t280 = 1+z
      t298 = t146*s3l1
      t300 = t228*s3l2
      t302 = -t143
      t310 = -3+t142
      t312 = t310*t1*t2
      t322 = -t310*t1
      t332 = 1/s2vr
      t333 = s2l2*t332
      t337 = t332*s2l1
      t341 = t332*s4l2
      t345 = t332*s4l1
      t350 = s13r**2
      t352 = l3*t332
      t356 = t352*s3l2
      t357 = t136*t356
      t358 = 768*t357
      t359 = l3*t20
      t360 = t2*t332
      t362 = t359*t360*s4l2
      t367 = r**2
      t368 = 1+t367
      t369 = r+t
      t373 = 1+r*t
      t375 = t368/t369/t373
      t379 = t332*s3l2
      t381 = 768*t261*t379
      t382 = t261*t341
      t388 = l3*z
      t392 = 384*t136*t352*s34r+384*(-l3+t388-2)*t332
      t397 = 2*l3
      t398 = 2*t388
      t400 = (t397-t398+1)*t332
      t408 = t352*s3l1
      t409 = t136*t408
      t410 = 768*t409
      t412 = t359*t360*s4l1
      t420 = t332*s3l1
      t422 = 768*t261*t420
      t423 = t1*t332
      t424 = t221*t423
      t447 = t108*t379
      t448 = t108*t341
      t452 = t108*t420
      t453 = t108*t345
      t457 = t341*s3l1
      t458 = t261*t457
      t460 = t345*s3l2
      t461 = t261*t460
      t465 = t359*t2
      t469 = (-2+z+t397-t398)*t332
      t472 = (l3+t142-1-t388)*t332
      t488 = l3**2
      t489 = t488*t2
      t490 = t169*t332
      t498 = l1**2
      t501 = t368**2
      t502 = t369**2
      t505 = t373**2
      t507 = t501/t502/t505
      t509 = t20*t488
      t512 = t509*t379
      t513 = 768*t512
      t514 = t509*t341
      t515 = 384*t514
      t524 = -768*t489*t490*s34r-768*(-l3+t388+1)*l3*t423
      t526 = t489*t169
      t527 = t379*s34r
      t531 = (-1+t397)*l3
      t532 = t20*t332
      t535 = 768*t531*t532*s3l2
      t536 = 384*t382
      t546 = 768*t509*t332*s34r+384*t261*t332
      t561 = 384*t489*t490*t171+384*t261*(3-z+t398-t397)*t332*s34r+384*(
     #-l3+t388+1+z)*t332
      t584 = t509*t420
      t585 = 768*t584
      t586 = t509*t345
      t587 = 384*t586
      t592 = t420*s34r
      t597 = 768*t531*t532*s3l1
      t598 = 384*t424
      t630 = z*t1
      t657 = z*t332
      s4 = ((-384*t4+384*t8*s3l2+768*t12+((768*t4-384*t11*s3l2-384*t12)*
     #s23r+1152*t22*s34r*s2l2+(1152*t26+t29)*s34r)*t33)*s1l1+(384*t37-38
     #4*t8*s3l1-768*t41+((-768*t37+384*t11*s3l1+384*t41)*s23r-1152*t22*s
     #34r*s2l1+(-1152*t52-t55)*s34r)*t33)*s1l2+384*t63*t64-384*t63*t67-t
     #72+t75+(((-768*t77*s3l2+768*t12)*s2l1+(768*t77*s3l1-768*t41)*s2l2+
     #t72-t75)*s23r+(-1536*t26-t29)*s34r*s2l1+(1536*t52+t55)*s34r*s2l2+(
     #768*t22*t70-768*t22*t73)*s34r)*t33)*s13r
      s5 = ((768*t106-768*t108*s3l2-1536*t108*s4l2)*s1vr+(-1152*t106+384
     #*t116*s3l2+384*t119*s4l2)*s23r+t130*s2l2+(768*t132*t133-2304*t136*
     #t137)*s34r-384*t143*s3l2-768*t146+((384*t106+384*t149*s3l2)*t153+(
     #t156*s2l2+(-384*t159*t133+384*t159*t137)*s34r+384*s3l2+384*t146)*s
     #23r+t180*s2l2+768*t170*t137*t171+(384*t185*t2*s3l2+384*t190*t191)*
     #s34r)*t33)*s1l1
      s3 = s4+s5
      s2 = s3+((-768*t201+768*t108*s3l1+1536*t108*s4l1)*s1vr+(1152*t201-
     #384*t116*s3l1-384*t119*s4l1)*s23r-t130*s2l1+(-768*t132*t218+2304*t
     #136*t221)*s34r+384*t143*s3l1+768*t228+((-384*t201-384*t149*s3l1)*t
     #153+(-t156*s2l1+(384*t159*t218-384*t159*t221)*s34r-384*s3l1-384*t2
     #28)*s23r-t180*s2l1-768*t170*t221*t171+(-384*t185*t2*s3l1-384*t190*
     #t252)*s34r)*t33)*s1l2+(-384*t261*t64+384*t261*t67-t267+t269)*s1vr+
     #(384*t116*t64-384*t116*t67+t267-t269)*s23r
      s1 = s2+(384*t159*t133*s34r-384*t280*s3l2)*s2l1+(-384*t159*t218*s3
     #4r+384*t280*s3l1)*s2l2+(-768*t136*t137*s3l1+768*t136*t221*s3l2)*s3
     #4r-384*t298+384*t300
      s3 = s1+((384*t302*s3l2*s2l1-384*t302*s3l1*s2l2+384*t298-384*t300)
     #*s23r+384*t312*s3l2*s34r*s2l1-384*t312*s3l1*s34r*s2l2+(384*t322*t1
     #91*s3l1-384*t322*t252*s3l2)*s34r)*t33
      s4 = s3-(384*t3*t333*s1l1-384*t3*t337*s1l2+768*t3*t341*s2l1-768*t3
     #*t345*s2l2)*t350
      s5 = s4
      s7 = -(((-384*t136*t352*s2l2-t358-768*t362)*l1*r*t375+(768*t261*t3
     #33+t381+1536*t382)*s23r+t392*s2l2+(768*t357+768*t362)*s34r+t381-38
     #4*t400*s4l2)*s1l1+((384*t136*t352*s2l1+t410+768*t412)*l1*r*t375+(-
     #768*t261*t337-t422-1536*t424)*s23r-t392*s2l1+(-768*t409-768*t412)*
     #s34r-t422+384*t400*s4l1)*s1l2+((-t358-384*t362)*s2l1+(t410+384*t41
     #2)*s2l2)*l1*r*t375+((384*t447+384*t448)*s2l1+(-384*t452-384*t453)*
     #s2l2+768*t458-768*t461)*s23r+(-384*t465*t341*s34r-384*t469*s3l2-38
     #4*t472*s4l2)*s2l1+(384*t465*t345*s34r+384*t469*s3l1+384*t472*s4l1)
     #*s2l2-384*t457+384*t460)*s13r
      s8 = -((384*t489*t490*s2l2+768*t489*t490*s3l2)*t498*t367*t507+((-3
     #84*t509*t333-t513-t515)*s23r+t524*s2l2-1536*t526*t527-t535-t536)*l
     #1*r*t375+(t546*s2l2+(t513+t515)*s34r+t381+t536)*s23r+t561*s2l2+768
     #*t526*t379*t171+(t535+1152*t382)*s34r+t381+384*t341)*s1l1
      s6 = s7+s8
      s2 = s5+s6
      taux2 = s2-((-384*t489*t490*s2l1-768*t489*t490*s3l1)*t498*t367*t50
     #7+((384*t509*t337+t585+t587)*s23r-t524*s2l1+1536*t526*t592+t597+t5
     #98)*l1*r*t375+(-t546*s2l1+(-t585-t587)*s34r-t422-t598)*s23r-t561*s
     #2l1-768*t526*t420*t171+(-t597-1152*t424)*s34r-t422-384*t345)*s1l2-
     #(((-384*t512-768*t514)*s2l1+(384*t584+768*t586)*s2l2)*s23r+(384*t6
     #30*t356-768*t448)*s2l1+(-384*t630*t408+768*t453)*s2l2)*l1*r*t375-(
     #(-384*t447+768*t382)*s2l1+(384*t452-768*t424)*s2l2)*s23r-(-384*t26
     #1*t527-384*t657*s3l2-768*t341)*s2l1-(384*t261*t592+384*t657*s3l1+7
     #68*t345)*s2l2-(768*t458-768*t461)*s34r

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux1
      tcoff4 = taux1
      tcoff5 = taux2
      tcoff6 = taux2
      tcoff7 = -taux2
      tcoff8 = -taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet2 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+z
     #-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet4 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff4)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet5 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff5)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet6 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+z
     #-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff6)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet7 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff7)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet8 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff8)

CCC Sum

      qbiq7num1e0 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tco
     #ff4+tFjet5*tcoff5+tFjet6*tcoff6+tFjet7*tcoff7+tFjet8*tcoff8
      RETURN
      END

      double precision function qbiq7num1e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3-1
      t2 = -1+z
      t3 = t2**2
      t4 = t1*t3
      t5 = 1/s2vr
      t6 = l3*t5
      t7 = t6*s3l2
      t8 = t4*t7
      t9 = 384*t8
      t10 = l3*t2
      t11 = 2*l3
      t12 = l3*z
      t13 = 2*t12
      t14 = 2*z
      t15 = -t11+t13-3-t14
      t23 = t5*s4l1
      t24 = t23*s3l2
      t27 = 4*z
      t37 = t10*s3l1
      t39 = t10*s4l1
      t47 = l3*s34r
      t49 = t4*t47*s2l1
      t51 = l3*t1
      t53 = t51*t3*s3l1
      t55 = l3*s4l1
      t56 = t4*t55
      t60 = -t2
      t61 = 192*t60
      t63 = 384*t60
      t68 = s23r**2
      t75 = -t61
      t80 = t3*t2
      t81 = t1**2
      t82 = t80*t81
      t83 = s34r**2
      t88 = 2*t2**2
      t92 = -480*t82*l3*t83+96*t88*t1*s34r
      t104 = 4*t2**2
      t105 = t1*s4l1
      t111 = 1/s1vr
      t115 = t1*t2
      t116 = t115*s3l2
      t118 = t115*s4l2
      t119 = 192*t118
      t123 = t3*t81
      t127 = t123*s3l2
      t130 = 192*t123*s4l2
      t137 = t115*s3l1
      t139 = t115*s4l1
      t147 = t123*s3l1
      t150 = 192*t123*s4l1
      t157 = z*t1
      t158 = t3*l3
      t165 = s3l2*s2l1
      t166 = t115*t165
      t168 = s3l1*s2l2
      t169 = t115*t168
      t172 = t81*z
      t175 = 1344*l3*t80*t172*s34r
      t179 = s4l1*s3l2
      t181 = 192*t115*t179
      t182 = s4l2*s4l1
      t185 = 1-t14
      t187 = z*t2
      t198 = 3*z
      t213 = t3**2
      t215 = t81*t1
      t235 = (96*t116+t119+((-96*t116-96*t118)*s23r-96*t123*s34r*s2l2+(-
     #96*t127-t130)*s34r)*t111)*s1l1+(96*t137+192*t139+((-96*t137-96*t13
     #9)*s23r-96*t123*s34r*s2l1+(-96*t147-t150)*s34r)*t111)*s1l2+384*t15
     #7*t158*s1vr-288*t157*t158*s23r-96*t166-96*t169-t175+(-768*t116-t11
     #9)*s3l1-t181+384*t115*t182-192*t185*t1*t187+(384*t157*t158*t68+(19
     #2*t166+192*t169+t175+(384*t116+t119)*s3l1+t181+96*(-1-t198)*t1*t18
     #7)*s23r+(384*t127-t130)*s34r*s2l1+(384*t147-t150)*s34r*s2l2+960*l3
     #*t213*t215*z*t83+((768*t127+t130)*s3l1+192*t123*t179-384*t123*t182
     #+96*(1-t27)*z*t123)*s34r)*t111
      t238 = (-t11+t13-3)*t5
      t241 = z*t3
      t242 = l3**2
      t252 = t5*s4l2
      t253 = t252*s4l1
      t255 = t242*t3
      t256 = z*t5
      t257 = t256*t68
      t260 = t213*t242
      t264 = t10*s3l2
      t266 = t10*s4l2
      t271 = 192*t266
      t275 = t4*t47*s2l2
      t278 = t51*t3*s3l2
      t279 = 768*t278
      t280 = l3*s4l2
      t281 = t4*t280
      t308 = t1*s3l2
      t310 = t1*s4l2
      t319 = t1*t5
      t321 = t158*t319*s4l2
      t323 = r**2
      t324 = 1+t323
      t325 = r+t
      t329 = 1+r*t
      t331 = t324/t325/t329
      t332 = l1*r*t331
      t335 = t252*s23r
      t338 = t4*l3
      t339 = t5*s34r
      t340 = t339*s2l2
      t346 = -l3+t12
      t347 = t346*t5
      t353 = t158*t319*s4l1
      t356 = t2*t5
      t360 = t339*s2l1
      t372 = l1**2
      t374 = t324**2
      t375 = t325**2
      t378 = t329**2
      t380 = t374/t375/t378
      t381 = t372*t323*t380
      t384 = t242*t80
      t385 = t384*z
      t393 = t6*s3l1
      t394 = t4*t393
      t399 = t172*t213
      t400 = t242*t5
      t401 = t400*s34r
      t404 = t252*s3l1
      t406 = 192*t338*t404
      t408 = 192*t338*t24
      t409 = t4*z
      t411 = 6*t12
      t421 = t5*s3l2
      t422 = t10*t421
      t423 = t10*t252
      t427 = t5*s3l1
      t429 = t55*t356
      t441 = 384*t10*t253
      t455 = 6*z
      t456 = 7*t12
      t457 = 7*l3
      t459 = (-t455+6+t456-t457)*t5
      t462 = 4*t12
      t463 = 4*l3
      t465 = (-t198+3+t462-t463)*t5
      t492 = (-t11+t13+3)*t5
      t499 = z**2
      t503 = t242*z
      s1 = (-96*t321*t332-192*t10*t335+288*t338*t340+96*t338*t252*s34r+9
     #6*t347*s4l2)*s1l1+(-96*t353*t332-192*t55*t356*s23r+288*t338*t360+9
     #6*t338*t23*s34r+96*t347*s4l1)*s1l2+288*t260*t172*t5*t381+(480*t385
     #*t319*s23r+(672*t8+384*t321)*s2l1+(672*t394+384*t353)*s2l2+192*t39
     #9*t401+t406+t408-96*t409*l3*(-6*l3+t411+4-t14)*t5)*l1*r*t331+((96*
     #t422+96*t423)*s2l1+(96*t10*t427+96*t429)*s2l2-1056*t157*t80*t401-1
     #92*t10*t404-192*t10*t24-t441-96*t10*z*(-5*l3+5*t12+4-8*z)*t5)*s23r
     #+((-t9+288*t321)*s34r-96*t459*s3l2-96*t465*s4l2)*s2l1
      t511 = s1+((-384*t394+288*t353)*s34r-96*t459*s3l1-96*t465*s4l1)*s2
     #l2-480*t399*t400*t83+(-t406-t408+96*t409*l3*(-2-2*z+2*l3-2*t12)*t5
     #)*s34r-96*t492*s4l2*s3l1-96*t492*t179-192*t253+96*z*(-t463+t411-2*
     #l3*t499-2+3*t242-6*t503+3*t242*t499)*t5
      t514 = (-1+z-t499)*z
      t516 = t1*t242
      t517 = t80*t5
      t519 = t516*t517*s4l2
      t524 = t516*t80
      t528 = t516*t517*s3l2
      t530 = -192*t528-192*t519
      t533 = (-t14+2-t463+t462)*t2
      t534 = t6*s4l2
      t544 = 192*t255*t421
      t556 = (3-t198+t13-t11)*t5
      t560 = 384*t516*t517*t83+96*t10*t556*s34r
      t565 = 1-z-l3+t12
      t567 = 2*t565*t5
      t569 = t10*t567*s4l2
      t574 = 2*t346*t5
      t583 = s3l2*s34r*s2l1
      s1 = ((-t9+96*t10*t15*t5*s4l2)*s3l1+96*t10*t15*t24+96*t10*z*(-2+t2
     #7+3*l3-3*t12)*t5)*s34r+((-192*t37-384*t39)*s1vr+(288*t37+192*t39)*
     #s23r+192*t49+(768*t53+576*t56)*s34r+t61*s3l1+t63*s4l1+((96*t37+288
     #*t39)*t68+(-288*t49+(-480*t53+288*t56)*s34r+t75*s3l1+t75*s4l1)*s23
     #r+t92*s2l1+(-576*t82*l3*s3l1-192*t82*t55)*t83+(96*t88*t1*s3l1+96*t
     #104*t105)*s34r)*t111)*s1l2+t235*s13r+96*t238*t179-576*t241*t242*t6
     #8+t61*s4l1*s3l2+192*(-l3+t12+z)*z*t5-384*t253
      t586 = s1-96*t255*t257-384*t172*t260*t83+((-192*t264-384*t266)*s1v
     #r+(288*t264+t271)*s23r+192*t275+(t279+576*t281)*s34r+t61*s3l2+t63*
     #s4l2+((96*t264+288*t266)*t68+(-288*t275+(-480*t278+288*t281)*s34r+
     #t75*s3l2+t75*s4l2)*s23r+t92*s2l2+(-576*t82*l3*s3l2-192*t82*t280)*t
     #83+(96*t88*t308+96*t104*t310)*s34r)*t111)*s1l1+t511*s13r+384*t514+
     #(192*t519*t381+(96*t255*t335-192*t524*t340+t530*s34r-96*t533*t534)
     #*l1*r*t331+(96*t255*t340+(t544-288*t255*t252)*s34r-96*t423)*s23r+t
     #560*s2l2+192*t524*t421*t83+(t544+96*t569)*s34r+96*t574*s4l2)*s1l1-
     #480*t385*t319*t83-288*t338*t583
      t588 = s3l1*s34r*s2l2
      t591 = t242*l3
      t595 = t421*s2l1
      t598 = t427*s2l2
      t606 = t421*s3l1
      t621 = 384*t528
      t622 = 192*t519
      t627 = (-5*z-t463+t462+5)*t2
      t634 = t516*t517*s3l1
      t637 = t516*t517*s4l1
      t644 = t10*t567*s4l1
      t648 = t621-t622
      t651 = 192*t524*t24
      t652 = t80*z
      t654 = t516*t652*t5
      t665 = (-1-t14-t463+t462)*t2
      t675 = t187*t5
      t682 = s1vr**2
      t692 = 4*t565*t5
      t701 = t565*t5
      t716 = t384*s34r
      t799 = s13r**2
      t809 = -192*t634-192*t637
      t821 = 192*t255*t427
      t871 = 288*t60
      t895 = 3*t2**2*t1
      t911 = (3+t14)*t2
      s2 = -288*t338*t588+(96*t591*t80*t257+(96*t255*t595+96*t255*t598+6
     #72*t591*t213*z*t319*s34r+384*t255*t606-384*t255*t253-96*(14*l3-14*
     #t12-9+11*z)*t3*t503*t5)*s23r+((t621+t622)*s34r+96*t627*t7+192*t569
     #)*s2l1+((384*t634+192*t637)*s34r+96*t627*t393+192*t644)*s2l2+(t648
     #*s3l1-t651+288*t654)*s34r+(384*(-1+t11)*l3*t3*t5*s3l2-96*t665*t534
     #)*s3l1-96*t665*l3*t24+t441-192*(-t11+t13+1)*l3*t675)*l1*r*t331-384
     #*t255*z*t682+(-384*t422+96*t238*s4l2)*s3l1
      s1 = s2+((-96*t10*t692*s3l1-192*t353)*s34r-96*t556*s3l1-192*t701*s
     #4l1)*s2l2+((-576+768*z)*s3l2+t61*s4l2)*s3l1+(-288*t10*t165-288*t10
     #*t168-960*t157*t716-384*t10*s3l2*s3l1+576*t499*t2*l3)*s23r+((-t279
     #+192*t281)*s3l1+192*t4*t55*s3l2-192*(3-t455)*t1*t241*l3)*s34r
      s2 = s1+((-96*t10*t692*s3l2-192*t321)*s34r-96*t556*s3l2-192*t701*s
     #4l2)*s2l1+(384*t255*z*s23r+768*t1*z*t716+(768*t264-t271)*s3l1-192*
     #t10*t179+384*t185*z*t10)*s1vr+(-192*t82*t12*t5*t332-384*t409*t6*s2
     #3r+(-288*t115*t421-96*t115*t252)*s2l1+(-288*t115*t427-96*t115*t23)
     #*s2l2+192*t82*z*t6*s34r+96*t115*z*(-2*l3+2*t12+2)*t5)*t799
      s3 = s2+(192*t637*t381+(96*t255*t23*s23r-192*t524*t360+t809*s34r-9
     #6*t533*t6*s4l1)*l1*r*t331+(96*t255*t360+(t821-288*t255*t23)*s34r-9
     #6*t429)*s23r+t560*s2l1+192*t524*t427*t83+(t821+96*t644)*s34r+96*t5
     #74*s4l1)*s1l2+(96*t241*t81-96*t652*t215*s34r*t111)*t799
      t942 = s3+(-96*t10*t595-96*t10*t598-96*t255*z*(6-7*z-t457+t456)*t5
     #*s34r-384*t10*t606+t441+96*(t457-t456+t27-2)*l3*t675)*s23r+(-96*(-
     #4+t455)*z*t10*t68+(t871*s3l2*s2l1+t871*s3l1*s2l2-96*(-12+10*z)*t1*
     #z*t158*s34r+((576-384*z)*s3l2+288*s4l2)*s3l1+288*t179-192*t514)*s2
     #3r-96*t895*t583-96*t895*t588+96*(8-t27)*l3*t80*t172*t83+((-192*(-3
     #+t27)*t2*t308+96*t911*t310)*s3l1+96*t911*t105*s3l2-192*(-1+t14-2*t
     #499)*t1*t187)*s34r)*t111+(-672*t1*t591*t213*t256*s23r+t530*s2l1+t8
     #09*s2l2-t648*s3l1+t651+192*t654)*t372*t323*t380
      taux1 = t586+t942
      t1 = 1-z
      t2 = 3*t1
      t3 = l3-1
      t4 = t3*t2
      t5 = t4*s2l2
      t7 = -t1
      t9 = 10*t7*t3
      t12 = 4*t7
      t13 = t12*t3
      t14 = t13*s4l2
      t22 = t7**2
      t23 = t3**2
      t24 = t22*t23
      t28 = t24*s3l2
      t30 = t24*s4l2
      t35 = 1/s1vr
      t39 = t4*s2l1
      t43 = t13*s4l1
      t54 = t24*s3l1
      t56 = t24*s4l1
      t65 = 5*t1*t3
      t66 = s3l2*s2l1
      t69 = s3l1*s2l2
      t72 = s4l2*s3l1
      t75 = s4l1*s3l2
      t78 = -t12
      t79 = t78*t3
      t81 = t7*t3
      t116 = l3*t2
      t117 = t116*s2l2
      t119 = t12*l3
      t128 = 11*t7*l3
      t135 = l3*s34r
      t139 = 5376*t3*t22*t135-2304-2304*z
      t142 = 3*t3*t22
      t143 = l3*s3l2
      t146 = t3*t22
      t147 = l3*s4l2
      t152 = 8*z
      t153 = -5+t152
      t156 = t153*s4l2
      t159 = 2*t7*l3
      t161 = t78*l3
      t165 = s23r**2
      t172 = -768*t3*t22*t135+1152+1152*z
      t174 = -t3
      t176 = 4*t174*t22
      t179 = 10*t174*t22
      t184 = 2*z
      t185 = -5+t184
      t191 = t22*t7
      t192 = t191*t23
      t193 = s34r**2
      t202 = -384*t192*l3*t193+384*(-5+11*z)*t7*t3*s34r
      t210 = t153*t7
      t215 = (-13+16*z)*t7
      t216 = t3*s4l2
      t225 = t116*s2l1
      t240 = l3*s3l1
      t243 = l3*s4l1
      t250 = t153*s4l1
      t279 = t3*s4l1
      t299 = 6*l3*t1
      t313 = -3-3*z
      t336 = 3-6*z
      t342 = -5+4*z
      t353 = (-10*z+9)*t7*t3
      t354 = s3l2*s34r
      t358 = s3l1*s34r
      t363 = (t152-11)*t7
      s3 = ((-384*t5+384*t9*s3l2+768*t14+((768*t5-384*t13*s3l2-384*t14)*
     #s23r-3840*t24*s34r*s2l2+(-3840*t28-3072*t30)*s34r)*t35)*s1l1+(384*
     #t39-384*t9*s3l1-768*t43+((-768*t39+384*t13*s3l1+384*t43)*s23r+3840
     #*t24*s34r*s2l1+(3840*t54+3072*t56)*s34r)*t35)*s1l2+384*t65*t66-384
     #*t65*t69-768*t65*t72+768*t65*t75+(((-768*t79*s3l2+768*t81*s4l2)*s2
     #l1+(768*t79*s3l1-768*t81*s4l1)*s2l2+768*t4*t72-768*t4*t75)*s23r+(4
     #608*t28+1536*t30)*s34r*s2l1+(-4608*t54-1536*t56)*s34r*s2l2+(-3840*
     #t24*t72+3840*t24*t75)*s34r)*t35)*s13r
      s4 = ((768*t117-768*t119*s3l2-1536*t119*s4l2)*s1vr+(-1152*t117+384
     #*t128*s4l2)*s23r+t139*s2l2+(768*t142*t143+9216*t146*t147)*s34r-384
     #*t153*s3l2-768*t156+((384*t117+384*t159*s3l2+384*t161*s4l2)*t165+(
     #t172*s2l2+(-384*t176*t143+384*t179*t147)*s34r+384*t185*s3l2+384*t1
     #56)*s23r+t202*s2l2+(768*t192*t143-3072*t192*t147)*t193+(384*t210*t
     #3*s3l2+384*t215*t216)*s34r)*t35)*s1l1
      s2 = s3+s4
      s1 = s2+((-768*t225+768*t119*s3l1+1536*t119*s4l1)*s1vr+(1152*t225-
     #384*t128*s4l1)*s23r-t139*s2l1+(-768*t142*t240-9216*t146*t243)*s34r
     #+384*t153*s3l1+768*t250+((-384*t225-384*t159*s3l1-384*t161*s4l1)*t
     #165+(-t172*s2l1+(384*t176*t240-384*t179*t243)*s34r-384*t185*s3l1-3
     #84*t250)*s23r-t202*s2l1+(-768*t192*t240+3072*t192*t243)*t193+(-384
     #*t210*t3*s3l1-384*t215*t279)*s34r)*t35)*s1l2+(-384*t116*t66+384*t1
     #16*t69-768*t119*t72+768*t119*t75)*s1vr+(384*t299*t66-384*t299*t69+
     #768*t159*t72-768*t159*t75)*s23r
      t373 = s1+(384*t179*t143*s34r-384*t313*s3l2)*s2l1+(-384*t179*t240*
     #s34r+384*t313*s3l1)*s2l2+(3072*t146*t147*s3l1-3072*t146*t243*s3l2)
     #*s34r-384*t156*s3l1+384*t250*s3l2+((384*t336*s3l2*s2l1-384*t336*s3
     #l1*s2l2+384*t342*s4l2*s3l1-384*t342*s4l1*s3l2)*s23r+384*t353*t354*
     #s2l1-384*t353*t358*s2l2+(384*t363*t216*s3l1-384*t363*t279*s3l2)*s3
     #4r)*t35
      t374 = 1/s2vr
      t375 = s2l2*t374
      t379 = t374*s2l1
      t383 = t374*s3l2
      t386 = t374*s4l2
      t391 = t374*s3l1
      t394 = t374*s4l1
      t400 = s13r**2
      t402 = l3*t374
      t407 = t146*t402*s3l2
      t409 = l3*t22
      t410 = t3*t374
      t412 = t409*t410*s4l2
      t417 = r**2
      t418 = 1+t417
      t419 = r+t
      t423 = 1+r*t
      t425 = t418/t419/t423
      t429 = t7*l3
      t431 = 768*t429*t383
      t432 = t429*t386
      t438 = 3*l3
      t439 = l3*z
      t440 = 3*t439
      t444 = 384*t146*t402*s34r+384*(t438-t440+6)*t374
      t449 = 2*l3
      t450 = 2*t439
      t452 = (-t449+t450-3)*t374
      t461 = t146*t402*s3l1
      t464 = t409*t410*s4l1
      t473 = 768*t429*t391
      t475 = t243*t7*t374
      t489 = l3*t3*t22
      t490 = t383*s2l1
      t493 = t391*s2l2
      t496 = t386*s3l1
      t497 = t489*t496
      t499 = t394*s3l2
      t500 = t489*t499
      t506 = t119*t383
      t511 = t119*t391
      t516 = t429*t496
      t518 = t429*t499
      t522 = t383*s34r
      t527 = (5*z-2-t439+l3)*t374
      t531 = (-1-t184)*t374
      t536 = t391*s34r
      t549 = (t449-t450-1)*t374
      t556 = l3**2
      t557 = t556*t3
      t558 = t191*t374
      t566 = l1**2
      t569 = t418**2
      t570 = t419**2
      t573 = t423**2
      t575 = t569/t570/t573
      t577 = t22*t556
      t580 = t577*t383
      t582 = t577*t386
      t594 = 384*t557*t558*s34r-768*(3*l3-3*t439-3)*t7*t402
      t596 = t557*t191
      t597 = t596*t522
      t599 = -1+t449
      t600 = t599*l3
      t601 = t22*t374
      t605 = 2*t429
      t606 = l3*t1
      t608 = (t605-t606)*t374
      t620 = -2688*t577*t374*s34r+384*t116*t374
      t622 = 1536*t580
      t629 = 3*z
      t642 = -384*(-t429*(-t629+t440+1-t438)+2*t429*(3-z+t450-t449))*t37
     #4*s34r+384*(3*l3-3*t439-3-3*z)*t374
      t651 = (-t489+2*t22*t599*l3)*t374
      t672 = t577*t391
      t674 = t577*t394
      t680 = t596*t536
      t693 = 1536*t672
      t742 = (-2*z*t7*l3-(9-t152+10*t439-10*l3)*t7*l3)*t374
      t747 = (2*t606-t429)*t374
      t783 = (-t429*(-t438+4+t440-t629)-t605)*t374
      t789 = (z+5*l3-5*t439-4)*t374
      s3 = -(384*t4*t375*s1l1-384*t4*t379*s1l2+(1536*t81*t383-768*t81*t3
     #86)*s2l1+(-1536*t81*t391+768*t81*t394)*s2l2)*t400
      s5 = -(((1152*t146*t402*s2l2+768*t407+768*t412)*l1*r*t425+(768*t11
     #6*t375-t431-3072*t432)*s23r+t444*s2l2+(-768*t407-768*t412)*s34r-t4
     #31-384*t452*s4l2)*s1l1+((-1152*t146*t402*s2l1-768*t461-768*t464)*l
     #1*r*t425+(-768*t116*t379+t473+3072*t475)*s23r-t444*s2l1+(768*t461+
     #768*t464)*s34r+t473+384*t452*s4l1)*s1l2+(-384*t489*t490+384*t489*t
     #493+768*t497-768*t500)*l1*r*t425+((384*t506+384*t119*t386)*s2l1+(-
     #384*t511-384*t119*t394)*s2l2-2304*t516+2304*t518)*s23r+(1152*t489*
     #t522-384*t527*s3l2-384*t531*s4l2)*s2l1+(-1152*t489*t536+384*t527*s
     #3l1+384*t531*s4l1)*s2l2+(-768*t497+768*t500)*s34r+384*t549*t72-384
     #*t549*t75)*s13r
      s6 = -((-1152*t557*t558*s2l2-768*t557*t558*s3l2)*t566*t417*t575+((
     #1152*t577*t375+768*t580+1152*t582)*s23r+t594*s2l2+2304*t597+768*t6
     #00*t601*s3l2+384*t608*s4l2)*l1*r*t425+(t620*s2l2+(-t622-2688*t582)
     #*s34r-t431-1152*t432)*s23r+t642*s2l2-1536*t596*t383*t193+(-768*t65
     #1*s3l2-1920*t432)*s34r-t431-1152*t386)*s1l1
      s4 = s5+s6
      s2 = s3+s4
      s1 = s2-((1152*t557*t558*s2l1+768*t557*t558*s3l1)*t566*t417*t575+(
     #(-1152*t577*t379-768*t672-1152*t674)*s23r-t594*s2l1-2304*t680-768*
     #t600*t601*s3l1-384*t608*s4l1)*l1*r*t425+(-t620*s2l1+(t693+2688*t67
     #4)*s34r+t473+1152*t475)*s23r-t642*s2l1+1536*t596*t391*t193+(768*t6
     #51*s3l1+1920*t475)*s34r+t473+1152*t394)*s1l2-(1920*t596*t490-1920*
     #t596*t493)*t566*t417*t575-(((t622+2304*t582)*s2l1+(-t693-2304*t674
     #)*s2l2-1536*t577*t496+1536*t577*t499)*s23r+(-1152*t597+384*t742*s3
     #l2+768*t747*s4l2)*s2l1+(1152*t680-384*t742*s3l1-768*t747*s4l1)*s2l
     #2-384*t161*t496+384*t161*t499)*l1*r*t425
      t807 = s1-((-384*t506-2304*t432)*s2l1+(384*t511-768*t116*t394)*s2l
     #2+1536*t516-1536*t518)*s23r-(-384*t783*t354-384*t789*s3l2+2304*t38
     #6)*s2l1-(384*t783*t358+384*t789*s3l1-2304*t394)*s2l2-(-2304*t516+2
     #304*t518)*s34r+1536*t496-1536*t499
      taux2 = t373+t807

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux1
      tcoff4 = taux1
      tcoff5 = taux2
      tcoff6 = taux2
      tcoff7 = -taux2
      tcoff8 = -taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet2 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+z
     #-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet4 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff4)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet5 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff5)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet6 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+z
     #-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff6)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet7 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff7)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet8 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff8)

CCC Sum

      qbiq7num1e1 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tco
     #ff4+tFjet5*tcoff5+tFjet6*tcoff6+tFjet7*tcoff7+tFjet8*tcoff8
      RETURN
      END

      double precision function qbiq7num1e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3-1
      t2 = l3**2
      t3 = l3*t2
      t5 = -1+z
      t6 = t5**2
      t7 = t6**2
      t9 = 1/s2vr
      t10 = z*t9
      t11 = t10*s23r
      t14 = t1**2
      t15 = t14*t3
      t16 = t7*t5
      t17 = t15*t16
      t18 = t10*s34r
      t22 = l3*z
      t24 = 4*z
      t28 = t6*t5
      t29 = t28*z
      t34 = l1**2
      t36 = r**2
      t38 = 1+t36
      t39 = t38**2
      t40 = r+t
      t41 = t40**2
      t45 = 1+r*t
      t46 = t45**2
      t48 = t39/t41/t46
      t50 = t7*t2
      t51 = z*t14
      t58 = t2*t28
      t59 = t58*z
      t64 = t51*t7
      t65 = t2*t9
      t66 = t65*s34r
      t70 = t6*t1*z
      t73 = 5*z
      t85 = t38/t40/t45
      t87 = z*t1
      t91 = l3*t5
      t92 = 2*l3
      t97 = t91*z*(-t92+2*t22+1-z)*t9
      t101 = s34r**2
      t105 = 4*l3
      t106 = 4*t22
      t109 = t9*s34r
      t115 = z**2
      t116 = l3*t115
      t118 = 6*t2
      t119 = z*t2
      t120 = 12*t119
      t121 = t2*t115
      t122 = 6*t121
      t129 = t6*l3
      t138 = l3*t28*t51*s34r
      t140 = 2*t5
      t142 = z*t5
      t150 = t14*t1
      t162 = 1/s1vr
      t174 = t14*t28
      t194 = s13r**2
      t208 = (1-2*z+t115)*z
      t210 = t6*t2
      t211 = s23r**2
      t212 = t10*t211
      t215 = z*t6
      t254 = t129*s34r
      t266 = 2*t115
      t267 = 3*z
      t275 = s1vr**2
      t280 = t87*t58*s34r
      t283 = t140*z*t91
      t325 = 16*t22
      s2 = (192*t1*t3*t7*t11+768*t17*t18+192*(-6*l3+6*t22+4-t24)*t1*t2*t
     #29*t9)*t34*t36*t48+(576*t50*t51*t9*t34*t36*t48+(192*t59*t1*t9*s23r
     #-384*t64*t66-96*t70*l3*(-12*l3+12*t22+5-t73)*t9)*l1*r*t85+(-480*t8
     #7*t28*t66-96*t97)*s23r-192*t64*t65*t101+96*t70*l3*(2-t73-t105+t106
     #)*t109+96*z*(-5*l3+10*t22-5*t116+t118-t120+t122)*t9)*s13r+(-576*t8
     #7*t129*s1vr+192*t87*t129*s23r+480*t138-192*t140*t1*t142+((288*t138
     #+96*t70)*s23r+96*l3*t7*t150*z*t101+96*(-3+t24)*z*t6*t14*s34r)*t162
     #)*s13r+192*(-4*t119+2*t121+2*t2+t106-2*t116-t92)*z*t9+(-288*t174*t
     #22*t9*l1*r*t85+288*t174*z*l3*t9*s34r+96*t1*t5*z*(-3*l3+3*t22)*t9)*
     #t194
      s1 = s2+384*t51*t50*t101+96*t59*t1*(-4*z-4*l3+4*t22)*t9*t101+384*t
     #208-96*t210*t212-288*t215*t2*t211
      taux1 = s1-384*t15*t16*z*t9*t34*l1*t36*r*t39*t38/t41/t40/t46/t45+(
     #96*t215*t14-96*t29*t150*s34r*t162)*t194+(-96*t210*t18+96*t97)*s23r
     #+(-288*z*t5*t91*t211+(-96*(-4+z)*t1*z*t254-192*t208)*s23r+96*(1+t2
     #4)*l3*t28*t51*t101-192*(1+t266-t267)*t1*t142*s34r)*t162+384*t210*z
     #*t275+(-96*t280-192*t283)*s23r-192*(-5+6*z)*t1*z*t254+96*t91*z*(8*
     #t2-16*t119+8*t121+1-t73+4*t115-10*l3+22*t22-12*t116)*t9*s34r+(-192
     #*t210*z*s23r-768*t280+384*t283)*s1vr+(96*t3*t28*t212-96*(-t267+3+t
     #106-t105)*t6*t2*t11-384*t17*t10*t101-96*t59*t1*(-16*l3+t325+10-12*
     #z)*t109-192*(-t120+t122-8*l3+t325-8*t116+t118+2-t24+t266)*l3*t142*
     #t9)*l1*r*t85
      t1 = -1+z
      t2 = l3-1
      t3 = t1*t2
      t4 = t3*s2l2
      t6 = -t1
      t8 = 9*t6*t2
      t11 = 5*t6
      t12 = t11*t2
      t13 = t12*s4l2
      t21 = t1**2
      t22 = t2**2
      t23 = t21*t22
      t27 = t23*s3l2
      t29 = t23*s4l2
      t34 = 1/s1vr
      t38 = t3*s2l1
      t42 = t12*s4l1
      t53 = t23*s3l1
      t55 = t23*s4l1
      t63 = 3*t6
      t64 = t63*t2
      t65 = s3l2*s2l1
      t68 = s3l1*s2l2
      t71 = 4*t1
      t72 = t71*t2
      t73 = s4l2*s3l1
      t76 = s4l1*s3l2
      t79 = t6*t2
      t118 = t1*s2l2*l3
      t120 = t11*l3
      t129 = 11*t6*l3
      t133 = 12*t6*l3
      t138 = -t2
      t141 = l3*s34r
      t145 = 5376*t138*t21*t141+1536+1536*z
      t148 = 6*t138*t21
      t149 = l3*s3l2
      t152 = t2*t21
      t153 = l3*s4l2
      t158 = 10*z
      t159 = 8-t158
      t162 = t159*s4l2
      t166 = -t63*l3
      t170 = -t11*l3
      t174 = s23r**2
      t179 = -384*t152*t141-768-768*z
      t182 = 5*t138*t21
      t185 = 9*t2*t21
      t191 = 8-6*z
      t197 = t21*t1
      t198 = t197*t22
      t199 = s34r**2
      t209 = 1152*t198*l3*t199+384*(8-12*z)*t1*t2*s34r
      t217 = t159*t1
      t222 = (18-20*z)*t1
      t223 = t2*s4l2
      t233 = t1*s2l1*l3
      t250 = l3*s3l1
      t253 = l3*s4l1
      t260 = t159*s4l1
      t291 = t2*s4l1
      t300 = l3*t1
      t301 = t300*t65
      t302 = t300*t68
      t310 = t6*l3
      t320 = 1+z
      t321 = t320*s3l2
      t328 = t320*s3l1
      t345 = 2*z
      t346 = -t345+5
      t357 = (-3+9*z)*t1*t2
      t367 = (-t158+9)*t1
      s3 = ((-768*t4+384*t8*s3l2+768*t13+((1536*t4-384*t12*s3l2-384*t13)
     #*s23r+3456*t23*s34r*s2l2+(3456*t27+3840*t29)*s34r)*t34)*s1l1+(768*
     #t38-384*t8*s3l1-768*t42+((-1536*t38+384*t12*s3l1+384*t42)*s23r-345
     #6*t23*s34r*s2l1+(-3456*t53-3840*t55)*s34r)*t34)*s1l2+384*t64*t65-3
     #84*t64*t68-768*t72*t73+768*t72*t76+(((-768*t79*s3l2+1536*t3*s4l2)*
     #s2l1+(768*t79*s3l1-1536*t3*s4l1)*s2l2+768*t3*t73-768*t3*t76)*s23r+
     #(-1536*t27-768*t29)*s34r*s2l1+(1536*t53+768*t55)*s34r*s2l2+(3072*t
     #23*t73-3072*t23*t76)*s34r)*t34)*s13r
      s4 = ((1536*t118-768*t120*s3l2-1536*t120*s4l2)*s1vr+(-2304*t118+38
     #4*t129*s3l2+384*t133*s4l2)*s23r+t145*s2l2+(768*t148*t149-11520*t15
     #2*t153)*s34r-384*t159*s3l2-768*t162+((768*t118+384*t166*s3l2+384*t
     #170*s4l2)*t174+(t179*s2l2+(-384*t182*t149+384*t185*t153)*s34r+384*
     #t191*s3l2+384*t162)*s23r+t209*s2l2+(768*t198*t149+3840*t198*t153)*
     #t199+(384*t217*t2*s3l2+384*t222*t223)*s34r)*t34)*s1l1
      s2 = s3+s4
      s1 = s2+((-1536*t233+768*t120*s3l1+1536*t120*s4l1)*s1vr+(2304*t233
     #-384*t129*s3l1-384*t133*s4l1)*s23r-t145*s2l1+(-768*t148*t250+11520
     #*t152*t253)*s34r+384*t159*s3l1+768*t260+((-768*t233-384*t166*s3l1-
     #384*t170*s4l1)*t174+(-t179*s2l1+(384*t182*t250-384*t185*t253)*s34r
     #-384*t191*s3l1-384*t260)*s23r-t209*s2l1+(-768*t198*t250-3840*t198*
     #t253)*t199+(-384*t217*t2*s3l1-384*t222*t291)*s34r)*t34)*s1l2+(-768
     #*t301+768*t302-768*t120*t73+768*t120*t76)*s1vr+(384*t301-384*t302+
     #768*t310*t73-768*t310*t76)*s23r
      t377 = s1+(384*t185*t149*s34r-768*t321)*s2l1+(-384*t185*t250*s34r+
     #768*t328)*s2l2+(-3840*t152*t153*s3l1+3840*t152*t253*s3l2)*s34r-384
     #*t162*s3l1+384*t260*s3l2+((384*t321*s2l1-384*t328*s2l2+384*t346*s4
     #l2*s3l1-384*t346*s4l1*s3l2)*s23r+384*t357*s3l2*s34r*s2l1-384*t357*
     #s3l1*s34r*s2l2+(384*t367*t223*s3l1-384*t367*t291*s3l2)*s34r)*t34
      t378 = 1/s2vr
      t379 = s2l2*t378
      t383 = t378*s2l1
      t387 = t378*s3l2
      t390 = t378*s4l2
      t395 = t378*s3l1
      t398 = t378*s4l1
      t404 = s13r**2
      t406 = l3*t378
      t411 = t152*t406*s3l2
      t412 = 1536*t411
      t413 = l3*t21
      t414 = t2*t378
      t416 = t413*t414*s4l2
      t417 = 1152*t416
      t421 = r**2
      t422 = 1+t421
      t423 = r+t
      t427 = 1+r*t
      t429 = t422/t423/t427
      t434 = 1536*t300*t387
      t435 = t300*t390
      t442 = l3*z
      t446 = -1152*t152*t406*s34r+768*(-l3+t442-2)*t378
      t450 = 3*l3
      t451 = 3*t442
      t453 = (-t450+t451+2)*t378
      t462 = t152*t406*s3l1
      t463 = 1536*t462
      t465 = t413*t414*s4l1
      t466 = 1152*t465
      t474 = 1536*t300*t395
      t475 = t1*t378
      t476 = t253*t475
      t489 = l3*t2*t21
      t499 = t120*t387
      t504 = t120*t395
      t509 = t390*s3l1
      t510 = t300*t509
      t512 = t398*s3l2
      t513 = t300*t512
      t521 = 8*z
      t523 = (-t521+6+t451-t450)*t378
      t527 = (-z+3)*t378
      t546 = l3**2
      t547 = t546*t2
      t548 = t197*t378
      t553 = t547*t548*s3l2
      t556 = t547*t548*s4l2
      t557 = 768*t556
      t559 = l1**2
      t562 = t422**2
      t563 = t423**2
      t566 = t427**2
      t568 = t562/t563/t566
      t570 = t546*t21
      t573 = t570*t387
      t575 = t570*t390
      t581 = -l3+t442+1
      t585 = 1536*t547*t548*s34r-1536*t581*l3*t475
      t589 = (768*t553-768*t556)*s34r
      t590 = 2*l3
      t592 = (-1+t590)*l3
      t593 = t21*t378
      t598 = 4*l3
      t599 = 4*t442
      t604 = (2*t310-(-t345+2-t598+t599)*t1*l3)*t378
      t616 = 2688*t570*t378*s34r+768*t300*t378
      t625 = 3*z
      t626 = 2*t442
      t639 = -384*(-t300*(3-t625+t626-t590)+2*t300*(-t625+t451+1-t450))*
     #t378*s34r+768*(-l3+t442+1+z)*t378
      t641 = t547*t197
      t647 = (-t570+2*t489)*t378
      t650 = 1-z-l3+t442
      t655 = (-2*t300*t650+2*t300)*t378
      t656 = t655*s4l2
      t662 = -2*t581*t378
      t671 = t547*t548*s3l1
      t674 = t547*t548*s4l1
      t675 = 768*t674
      t682 = t570*t395
      t684 = t570*t398
      t692 = (-768*t671+768*t674)*s34r
      t718 = t655*s4l1
      t732 = t641*t509
      t734 = t641*t512
      t765 = (2*(9-t521+10*t442-10*l3)*t1*l3-(-5*z-t598+t599+5)*t1*l3)*t
     #378
      t786 = (-2*t71*l3-(-1-t345-t598+t599)*t1*l3)*t378
      t813 = (-4*t300*t650+2*t300*(-t450+4+t451-t625))*t378
      t822 = (-8*l3+8*t442+5-t625)*t378
      t826 = (1+z+l3-t442)*t378
      t846 = (-t300*(-1-t345-t590+t626)-4*t300)*t378
      t853 = (-5+t590-t626)*t378
      s3 = -(768*t3*t379*s1l1-768*t3*t383*s1l2+(-1920*t3*t387-1152*t3*t3
     #90)*s2l1+(1920*t3*t395+1152*t3*t398)*s2l2)*t404
      s5 = -(((-768*t152*t406*s2l2+t412+t417)*l1*r*t429+(1536*t300*t379-
     #t434-768*t435)*s23r+t446*s2l2+(-t412-t417)*s34r-t434-384*t453*s4l2
     #)*s1l1+((768*t152*t406*s2l1-t463-t466)*l1*r*t429+(-1536*t300*t383+
     #t474+768*t476)*s23r-t446*s2l1+(t463+t466)*s34r+t474+384*t453*s4l1)
     #*s1l2+(1152*t489*t387*s2l1-1152*t489*t395*s2l2)*l1*r*t429+((384*t4
     #99+384*t120*t390)*s2l1+(-384*t504-384*t120*t398)*s2l2+768*t510-768
     #*t513)*s23r+((-768*t411+384*t416)*s34r-384*t523*s3l2-384*t527*s4l2
     #)*s2l1+((768*t462-384*t465)*s34r+384*t523*s3l1+384*t527*s4l1)*s2l2
     #+1152*t509-1152*t512)*s13r
      s6 = -((768*t547*t548*s2l2-1536*t553+t557)*t559*t421*t568+((-768*t
     #570*t379+1536*t573-384*t575)*s23r+t585*s2l2+t589+1536*t592*t593*s3
     #l2+384*t604*s4l2)*l1*r*t429+(t616*s2l2+(768*t573+2688*t575)*s34r-t
     #434+384*t435)*s23r+t639*s2l2+768*t641*t387*t199+(-768*t647*s3l2-38
     #4*t656)*s34r-t434-384*t662*s4l2)*s1l1
      s4 = s5+s6
      s2 = s3+s4
      s1 = s2-((-768*t547*t548*s2l1+1536*t671-t675)*t559*t421*t568+((768
     #*t570*t383-1536*t682+384*t684)*s23r-t585*s2l1+t692-1536*t592*t593*
     #s3l1-384*t604*s4l1)*l1*r*t429+(-t616*s2l1+(-768*t682-2688*t684)*s3
     #4r+t474-384*t476)*s23r-t639*s2l1-768*t641*t395*t199+(768*t647*s3l1
     #+384*t718)*s34r+t474+384*t662*s4l1)*s1l2-((-3072*t553+t557)*s2l1+(
     #3072*t671-t675)*s2l2+768*t732-768*t734)*t559*t421*t568-(((-1920*t5
     #73-1536*t575)*s2l1+(1920*t682+1536*t684)*s2l2+2304*t570*t509-2304*
     #t570*t512)*s23r+(t589+384*t765*s3l2+768*t656)*s2l1+(t692-384*t765*
     #s3l1-768*t718)*s2l2+(-768*t732+768*t734)*s34r+384*t786*t73-384*t78
     #6*t76)*l1*r*t429
      t858 = s1-((-384*t499+1536*t435)*s2l1+(384*t504-1536*t476)*s2l2-23
     #04*t510+2304*t513)*s23r-((-384*t813*s3l2+768*t416)*s34r-384*t822*s
     #3l2-768*t826*s4l2)*s2l1-((384*t813*s3l1-768*t465)*s34r+384*t822*s3
     #l1+768*t826*s4l1)*s2l2-(-384*t846*t73+384*t846*t76)*s34r+384*t853*
     #t73-384*t853*t76
      taux2 = t377+t858

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux1
      tcoff4 = taux1
      tcoff5 = taux2
      tcoff6 = taux2
      tcoff7 = -taux2
      tcoff8 = -taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet2 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+z
     #-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet4 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff4)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet5 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff5)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet6 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+z
     #-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff6)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet7 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff7)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet8 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff8)

CCC Sum

      qbiq7num1e2 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tco
     #ff4+tFjet5*tcoff5+tFjet6*tcoff6+tFjet7*tcoff7+tFjet8*tcoff8
      RETURN
      END

      double precision function qbiq7num1e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux1 = 0
      t1 = -1+z
      t2 = l3-1
      t3 = t1*t2
      t4 = t3*s3l2
      t6 = t3*s4l2
      t11 = t1**2
      t12 = t2**2
      t13 = t11*t12
      t17 = t13*s3l2
      t20 = 1536*t13*s4l2
      t24 = 1/s1vr
      t28 = t3*s3l1
      t30 = t3*s4l1
      t38 = t13*s3l1
      t41 = 1536*t13*s4l1
      t48 = s3l2*s2l1
      t49 = t3*t48
      t51 = s3l1*s2l2
      t52 = t3*t51
      t54 = s4l2*s3l1
      t55 = t3*t54
      t57 = s4l1*s3l2
      t58 = t3*t57
      t80 = l3*t1
      t81 = t80*s3l2
      t83 = t80*s4l2
      t91 = t11*t2
      t92 = l3*s34r
      t94 = t91*t92*s2l2
      t96 = l3*t2
      t98 = t96*t11*s3l2
      t100 = l3*s4l2
      t101 = t91*t100
      t105 = 2*t1
      t107 = 768*t105*s3l2
      t108 = t105*s4l2
      t113 = s23r**2
      t123 = t11*t1
      t124 = t123*t12
      t125 = s34r**2
      t129 = t105*t1
      t133 = -3840*t124*l3*t125+768*t129*t2*s34r
      t145 = 4*t1**2
      t146 = t2*s4l2
      t155 = t80*s3l1
      t157 = t80*s4l1
      t166 = t91*t92*s2l1
      t169 = t96*t11*s3l1
      t171 = l3*s4l1
      t172 = t91*t171
      t177 = 768*t105*s3l1
      t178 = t105*s4l1
      t203 = t2*s4l1
      t212 = t80*t54
      t213 = t80*t57
      t225 = t96*t11
      t227 = s3l2*s34r*s2l1
      t231 = s3l1*s34r*s2l2
      t245 = 3*t1
      t250 = 2*z
      t251 = t250+1
      t260 = t245*t1*t2
      t265 = t251*t1
      s2 = ((768*t4+1536*t6+((-768*t4-768*t6)*s23r-768*t13*s34r*s2l2+(-7
     #68*t17-t20)*s34r)*t24)*s1l1+(-768*t28-1536*t30+((768*t28+768*t30)*
     #s23r+768*t13*s34r*s2l1+(768*t38+t41)*s34r)*t24)*s1l2+768*t49-768*t
     #52-3072*t55+3072*t58+((-1536*t49+1536*t52+1536*t55-1536*t58)*s23r+
     #(-3072*t17+t20)*s34r*s2l1+(3072*t38-t41)*s34r*s2l2+(3072*t13*t54-3
     #072*t13*t57)*s34r)*t24)*s13r+((-1536*t81-3072*t83)*s1vr+(2304*t81+
     #1536*t83)*s23r+1536*t94+(6144*t98+4608*t101)*s34r-t107-1536*t108+(
     #(768*t81+2304*t83)*t113+(-2304*t94+(-3840*t98+2304*t101)*s34r+t107
     #+768*t108)*s23r+t133*s2l2+(-4608*t124*l3*s3l2-1536*t124*t100)*t125
     #+(768*t129*t2*s3l2+768*t145*t146)*s34r)*t24)*s1l1
      s1 = s2+((1536*t155+3072*t157)*s1vr+(-2304*t155-1536*t157)*s23r-15
     #36*t166+(-6144*t169-4608*t172)*s34r+t177+1536*t178+((-768*t155-230
     #4*t157)*t113+(2304*t166+(3840*t169-2304*t172)*s34r-t177-768*t178)*
     #s23r-t133*s2l1+(4608*t124*l3*s3l1+1536*t124*t171)*t125+(-768*t129*
     #t2*s3l1-768*t145*t203)*s34r)*t24)*s1l2+(-1536*t212+1536*t213)*s1vr
     #+(2304*t80*t48-2304*t80*t51+1536*t212-1536*t213)*s23r
      t275 = s1+2304*t225*t227-2304*t225*t231+(1536*t91*t100*s3l1-1536*t
     #91*t171*s3l2)*s34r-768*t108*s3l1+768*t178*s3l2+((768*t245*s3l2*s2l
     #1-768*t245*s3l1*s2l2+768*t251*s4l2*s3l1-768*t251*s4l1*s3l2)*s23r+7
     #68*t260*t227-768*t260*t231+(768*t265*t146*s3l1-768*t265*t203*s3l2)
     #*s34r)*t24
      t276 = 1/s2vr
      t277 = t276*s3l2
      t280 = t276*s4l2
      t285 = t276*s3l1
      t288 = t276*s4l1
      t294 = s13r**2
      t296 = t11*l3
      t297 = t2*t276
      t299 = t296*t297*s4l2
      t301 = r**2
      t302 = 1+t301
      t303 = r+t
      t307 = 1+r*t
      t309 = t302/t303/t307
      t310 = l1*r*t309
      t313 = t280*s23r
      t316 = t276*s34r
      t317 = t316*s2l2
      t323 = l3*z
      t324 = -l3+t323
      t325 = t324*t276
      t331 = t296*t297*s4l1
      t334 = t1*t276
      t338 = t316*s2l1
      t348 = l3*t276
      t349 = t348*s3l2
      t350 = t91*t349
      t355 = t348*s3l1
      t356 = t91*t355
      t361 = t280*s3l1
      t362 = t225*t361
      t364 = t288*s3l2
      t365 = t225*t364
      t372 = t80*t280
      t377 = t171*t334
      t382 = 1536*t80*t361
      t384 = 1536*t80*t364
      t395 = (-6*z+6+7*t323-7*l3)*t276
      t398 = 3*z
      t399 = 4*t323
      t400 = 4*l3
      t402 = (-t398+3+t399-t400)*t276
      t421 = (3-t400+t399)*t276
      t428 = l3**2
      t429 = t2*t428
      t430 = t123*t276
      t432 = t429*t430*s4l2
      t433 = l1**2
      t435 = t302**2
      t436 = t303**2
      t439 = t307**2
      t441 = t435/t436/t439
      t442 = t433*t301*t441
      t445 = t11*t428
      t448 = t429*t123
      t452 = t429*t430*s3l2
      t454 = 1536*t452+1536*t432
      t457 = (-t250+2-t400+t399)*t1
      t468 = 1536*t445*t277
      t479 = 2*t323
      t480 = 2*l3
      t482 = (3-t398+t479-t480)*t276
      t486 = -3072*t429*t430*t125-768*t80*t482*s34r
      t491 = 1-z-l3+t323
      t493 = 2*t491*t276
      t495 = t80*t493*s4l2
      t500 = 2*t324*t276
      t506 = t429*t430*s4l1
      t515 = t429*t430*s3l1
      t517 = -1536*t515-1536*t506
      t529 = 1536*t445*t285
      t543 = t80*t493*s4l1
      t555 = t448*t361
      t557 = t448*t364
      t563 = t277*s2l1
      t566 = t285*s2l2
      t581 = (-5*z-t400+t399+5)*t1
      t601 = (-1-t250-t400+t399)*t1*l3
      t617 = 4*t491*t276
      t626 = t491*t276
      t644 = t80*(-1-t250-t480+t479)
      t651 = (-t480+t479-3)*t276
      s3 = -((-2304*t3*t277-768*t3*t280)*s2l1+(2304*t3*t285+768*t3*t288)
     #*s2l2)*t294
      s5 = -((768*t299*t310+1536*t80*t313-2304*t225*t317-768*t225*t280*s
     #34r-768*t325*s4l2)*s1l1+(-768*t331*t310-1536*t171*t334*s23r+2304*t
     #225*t338+768*t225*t288*s34r+768*t325*s4l1)*s1l2+((5376*t350+3072*t
     #299)*s2l1+(-5376*t356-3072*t331)*s2l2-3072*t362+3072*t365)*l1*r*t3
     #09+((768*t80*t277+768*t372)*s2l1+(-768*t80*t285-768*t377)*s2l2+t38
     #2-t384)*s23r+((-3072*t350+2304*t299)*s34r-768*t395*s3l2-768*t402*s
     #4l2)*s2l1+((3072*t356-2304*t331)*s34r+768*t395*s3l1+768*t402*s4l1)
     #*s2l2+(3072*t362-3072*t365)*s34r+768*t421*t54-768*t421*t57)*s13r
      s6 = -(-1536*t432*t442+(-768*t445*t313+1536*t448*t317+t454*s34r+76
     #8*t457*t348*s4l2)*l1*r*t309+(-768*t445*t317+(-t468+2304*t445*t280)
     #*s34r+768*t372)*s23r+t486*s2l2-1536*t448*t277*t125+(-t468-768*t495
     #)*s34r-768*t500*s4l2)*s1l1
      s4 = s5+s6
      s2 = s3+s4
      s1 = s2-(1536*t506*t442+(768*t445*t288*s23r-1536*t448*t338+t517*s3
     #4r-768*t457*t348*s4l1)*l1*r*t309+(768*t445*t338+(t529-2304*t445*t2
     #88)*s34r-768*t377)*s23r-t486*s2l1+1536*t448*t285*t125+(t529+768*t5
     #43)*s34r+768*t500*s4l1)*s1l2-(-t454*s2l1-t517*s2l2-1536*t555+1536*
     #t557)*t433*t301*t441-((768*t445*t563-768*t445*t566+1536*t445*t361-
     #1536*t445*t364)*s23r+((3072*t452+1536*t432)*s34r+768*t581*t349+153
     #6*t495)*s2l1+((-3072*t515-1536*t506)*s34r-768*t581*t355-1536*t543)
     #*s2l2+(1536*t555-1536*t557)*s34r+768*t601*t361-768*t601*t364)*l1*r
     #*t309
      t656 = s1-(-768*t80*t563+768*t80*t566-t382+t384)*s23r-((-768*t80*t
     #617*s3l2-1536*t299)*s34r-768*t482*s3l2-1536*t626*s4l2)*s2l1-((768*
     #t80*t617*s3l1+1536*t331)*s34r+768*t482*s3l1+1536*t626*s4l1)*s2l2-(
     #-768*t644*t361+768*t644*t364)*s34r+768*t651*t54-768*t651*t57
      taux2 = t275+t656

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux1
      tcoff4 = taux1
      tcoff5 = taux2
      tcoff6 = taux2
      tcoff7 = -taux2
      tcoff8 = -taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet2 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+z
     #-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet4 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff4)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet5 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff5)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet6 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+z
     #-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff6)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet7 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff7)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet8 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff8)

CCC Sum

      qbiq7num1e3 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tco
     #ff4+tFjet5*tcoff5+tFjet6*tcoff6+tFjet7*tcoff7+tFjet8*tcoff8
      RETURN
      END

      double precision function qbiq7num1e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux1 = 0
      taux2 = 0

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux1
      tcoff4 = taux1
      tcoff5 = taux2
      tcoff6 = taux2
      tcoff7 = -taux2
      tcoff8 = -taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet2 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+z
     #-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet4 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff4)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet5 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff5)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet6 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+z
     #-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff6)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = -l3+1
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet7 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t7
     #+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff7)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet8 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff8)

CCC Sum

      qbiq7num1e4 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tco
     #ff4+tFjet5*tcoff5+tFjet6*tcoff6+tFjet7*tcoff7+tFjet8*tcoff8
      RETURN
      END

