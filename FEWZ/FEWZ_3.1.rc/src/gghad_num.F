CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCC Numerator functions CCCCCCCCCCCCCCCCCCCCCCCCCC

      double precision function ggrmnum1e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = s3l2*s4l1
      t3 = s3l1*s4l2
      t5 = s2l2*s3l1
      t6 = 512.D0/3.D0*t5
      t8 = s3vf(z,l1,l2,l3,l4)
      t9 = 1/t8
      t10 = s4vf(z,l1,l2,l3,l4)
      t11 = 1/t10
      t12 = t9*t11
      t13 = s14f(z,l1,l2,l3,l4)
      t14 = t13**2
      t18 = s2l2*t9
      t19 = s24f(z,l1,l2,l3,l4)
      t20 = t11*t19
      t22 = t18*t11
      t26 = s2l1*t9
      t28 = t26*t11
      t32 = 1024.D0/3.D0*t22
      t33 = t12*s3l2
      t34 = 512.D0/3.D0*t33
      t35 = s4l2*t9
      t36 = t35*t11
      t37 = 512.D0/3.D0*t36
      t38 = -t32-t34-t37
      t40 = t12*s3l1
      t41 = s4l1*t9
      t42 = t41*t11
      t43 = -t40-t42
      t44 = 512.D0/3.D0*t43
      t46 = z*t11
      t47 = t46*t9
      t48 = 512.D0/3.D0*t47
      t49 = t38*s2l1+t44*s2l2+t48
      t51 = 1024.D0/3.D0*t36
      t54 = 512.D0/3.D0*t40
      t55 = 1024.D0/3.D0*t42
      t56 = -t54-t55
      t62 = t19**2
      t64 = 1024.D0/3.D0*t33
      t65 = t64+t37
      t66 = t65*t19
      t67 = 512.D0/3.D0*t22
      t73 = 1024.D0/3.D0*t40
      t74 = 512.D0/3.D0*t42
      t75 = t73+t74
      t76 = t75*t19
      t77 = 512.D0/3.D0*t28
      t81 = t35*t11*s2l1
      t82 = 512.D0/3.D0*t81
      t84 = t41*t11*s2l2
      t85 = 512.D0/3.D0*t84
      t86 = t11*s3l1
      t87 = t35*t86
      t88 = 1024.D0/3.D0*t87
      t89 = t11*s3l2
      t90 = t41*t89
      t91 = 1024.D0/3.D0*t90
      t94 = s2l1*s3l2
      t96 = 512.D0/3.D0*t12*t94
      t98 = 512.D0/3.D0*t12*t5
      t99 = 2048.D0/3.D0*t87
      t100 = 2048.D0/3.D0*t90
      t102 = s4l2*t11*s4l1
      t103 = 1024.D0/3.D0*t102
      t106 = (t103+2048.D0/3.D0*t46)*t9
      t117 = (t103+512*t46)*t9
      t118 = 1024.D0/3.D0*s2l1*s2l2*t12*t14+((-512.D0/3.D0*t18*t20-512.D
     #0/3.D0*t22)*s1l1+(-512.D0/3.D0*t26*t20-512.D0/3.D0*t28)*s1l2+t49*t
     #19+(t32-t34-t51)*s2l1+t56*s2l2+t48)*t13+((512.D0/3.D0*t22+512.D0/3
     #.D0*t33)*t62+t66-t67+t34+t37)*s1l1+((512.D0/3.D0*t28+512.D0/3.D0*t
     #40)*t62+t76-t77+t54+t74)*s1l2+(t82+t85+t88+t91+t48)*t62+(t96+t98+t
     #99+t100+t106)*t19+(512.D0/3.D0*t33-512.D0/3.D0*t36)*s2l1+(512.D0/3
     #.D0*t40-512.D0/3.D0*t42)*s2l2+t88+t91+t117
      t119 = s13f(z,l1,l2,l3,l4)
      t120 = t119**2
      t122 = s3l1*t19
      t124 = 512.D0/3.D0*s2l1
      t125 = 512.D0/3.D0*s4l1
      t127 = s23f(z,l1,l2,l3,l4)
      t132 = -t77-t54-t55
      t135 = t127**2
      t139 = -2+z
      t140 = t139*t11
      t142 = 512.D0/3.D0*t140*t26
      t143 = t9*s3l1
      t146 = -1+z
      t147 = 512.D0/3.D0*t146
      t148 = t147*t11
      t152 = -t146
      t154 = 1024.D0/3.D0*t152*t11
      t155 = t154*t143
      t157 = -t147*t11
      t158 = t157*t41
      t164 = t148*t26
      t165 = t157*t143
      t166 = t154*t41
      t169 = t146**2
      t170 = t169*t9
      t173 = t146*t152
      t186 = 512.D0/3.D0*t46*t9*t62
      t187 = t33+t36
      t188 = 1024.D0/3.D0*t187
      t195 = (t64+2560.D0/3.D0*t36)*s3l1
      t196 = 2560.D0/3.D0*t90
      t202 = (t103+512.D0/3.D0*z*(6-z)*t11)*t9
      t205 = t9*s3l2
      t206 = t154*t205
      t207 = t146*t11
      t216 = 2048.D0/3.D0*z
      t218 = (1024-t216)*t11
      t219 = t35*s3l1
      t221 = t41*s3l2
      t222 = t218*t221
      t224 = t154*s4l2*s4l1
      t226 = 4*t146*z
      t235 = 512.D0/3.D0*t46*t9*t19
      t237 = 512.D0/3.D0*t187*s2l1
      t239 = -t44*s2l2
      t255 = -t67-t34-t51
      t262 = 512.D0/3.D0*t140*t18
      t268 = t157*t35
      t274 = t148*t18
      t275 = t157*t205
      t276 = t154*t35
      t290 = (3584.D0/3.D0-t216)*t11
      t294 = t290*t221
      t296 = 5*t146*z
      s1 = 512.D0/3.D0*t1+512.D0/3.D0*t3+t6+t118*t120+((-1024.D0/3.D0*t1
     #22+t124+t125)*t127-512.D0/3.D0*t122+t124+t125)*s1l2+((t132*t19+t54
     #)*t135+((-t77-t73-t74)*t62+(t142+512.D0/3.D0*t46*t143+t148*t41)*t1
     #9+t155+t158)*t127+(-512.D0/3.D0*t28-512.D0/3.D0*t40+512.D0/3.D0*t4
     #2)*t62+(t164+t165+t166)*t19+512.D0/3.D0*t170*t86-512.D0/3.D0*t173*
     #t42)*s1l2
      t301 = s1+1024.D0/3.D0*t146**2*z*t11*t9+(t186+(t188*s2l1-1024.D0/3
     #.D0*t43*s2l2+t195+t196+t202)*t19+(t206-1024.D0/3.D0*t207*t35)*s2l1
     #+(t155-1024.D0/3.D0*t207*t41)*s2l2+t218*t219+t222+(t224-512.D0/3.D
     #0*t226*t11)*t9)*t127+(t235+t237+t239+t88+t91+(1024.D0/3.D0*t102+10
     #24.D0/3.D0*t46)*t9)*t135+(1024.D0/3.D0*t94+1024.D0/3.D0*t5+1024.D0
     #/3.D0*t3+1024.D0/3.D0*t1)*t127+((1024.D0/3.D0*t12*t62*t135+1024.D0
     #/3.D0*t12*t62*t127)*s1l2+(t255*t19+t34)*t135+((-t67-t64-t37)*t62+(
     #t262+512.D0/3.D0*t46*t205+t148*t35)*t19+t206+t268)*t127+(-512.D0/3
     #.D0*t22-512.D0/3.D0*t33+512.D0/3.D0*t36)*t62+(t274+t275+t276)*t19+
     #512.D0/3.D0*t170*t89-512.D0/3.D0*t173*t36)*s1l1+((t206+t276)*s2l1+
     #(t155+t166)*s2l2+(t206+t290*t35)*s3l1+t294-512.D0/3.D0*t296*t12)*t
     #19
      t302 = 512.D0/3.D0*t94
      t303 = t188*s3l1
      t304 = 512*t47
      t313 = t11*t127
      t329 = t19*t127
      t333 = -t38
      t366 = 1024*t90
      t367 = 2048.D0/3.D0*t47
      t389 = -512.D0/3.D0*t22-512.D0/3.D0*t33-512.D0/3.D0*t36
      t396 = t11*t62
      t401 = (-512.D0/3.D0-512.D0/3.D0*z)*t11
      t405 = (512-1024.D0/3.D0*z)*t11
      t406 = t405*t205
      t409 = (512-512.D0/3.D0*z)*t11
      t410 = t409*t35
      t416 = -512.D0/3.D0*t28-512.D0/3.D0*t40-512.D0/3.D0*t42
      t426 = t405*t143
      t427 = t409*t41
      t433 = (t34+t51)*s2l1
      t435 = -t56*s2l2
      t439 = t65*s2l1
      t440 = t75*s2l2
      t441 = 2560.D0/3.D0*t87
      t442 = 2560.D0/3.D0*t47
      t447 = (t64+2048.D0/3.D0*t36)*s3l1
      t450 = t409*t205
      t451 = t405*t35
      t454 = t409*t143
      t455 = t405*t41
      t459 = (2048-t216)*t11
      t464 = 3*z
      s3 = ((-512.D0/3.D0*t18*t313-512.D0/3.D0*t22)*s1l1+(-512.D0/3.D0*t
     #26*t313-512.D0/3.D0*t28)*s1l2+t49*t127-t65*s2l1-t75*s2l2+t48)*t14
      s4 = ((1024.D0/3.D0*t12*t329*s1l2+(t333*t19-t67+t34+t51)*t127+t66+
     #t262+t64+t51)*s1l1+(((1024.D0/3.D0*t28+t54+t74)*t19-t77+t54+t55)*t
     #127+t76+t142+t73+t55)*s1l2+((t333*s2l1+t239+t99+t100-1024*t47)*t19
     #+1024.D0/3.D0*t81+1024.D0/3.D0*t84+t99+t100+(t103+2560.D0/3.D0*t46
     #)*t9)*t127+((t32+512*t33+t51)*s2l1+(512*t40+t55)*s2l2+(t64+1024*t3
     #6)*s3l1+t366+t367)*t19+(t148*t205+512.D0/3.D0*t46*t35)*s2l1+(t148*
     #t143+512.D0/3.D0*t46*t41)*s2l2+t195+t196+t202)*t13+((-1024.D0/3.D0
     #*t12*t62+1024.D0/3.D0*t12*t19)*t127*s1l2+(t389*t62+(t64+512*t36)*t
     #19-t67+t64+t37)*t127+512.D0/3.D0*t35*t396+(t401*t18+t406+t410)*t19
     #+t274+t206+t276)*s1l1
      s2 = s3+s4
      s1 = s2+((t416*t62+(t73+512*t42)*t19-t77+t73+t74)*t127+512.D0/3.D0
     #*t41*t396+(t401*t26+t426+t427)*t19+t164+t155+t166)*s1l2+(t186+(t43
     #3+t435+1024*t87+t366+t106)*t19+t439+t440+t441+t196+t442)*t127+(t43
     #3+t435+t447+t100+t367)*t62
      t482 = s1+((t450+t451)*s2l1+(t454+t455)*s2l2+(t64+t459*t35)*s3l1+t
     #459*t221+(t103-512.D0/3.D0*z*(-9+t464)*t11)*t9)*t19+(t206+t268)*s2
     #l1+(t155+t158)*s2l2+t290*t219+t294+(t224-512.D0/3.D0*t296*t11)*t9
      t487 = s3l2*t19
      t489 = 512.D0/3.D0*s2l2
      t490 = 512.D0/3.D0*s4l2
      t497 = t146*t139*t11
      t505 = s2l2*s4l1
      t521 = 1024.D0/3.D0*s4l2
      t526 = 1024.D0/3.D0*s4l1
      t582 = (5120.D0/3.D0-t216)*t11
      s1 = t302+(t237+t239+t303+t91+t304)*t62+(-512.D0/3.D0*t173*t40+512
     #.D0/3.D0*t169*s4l1*t12)*s2l2+t482*t119+((-1024.D0/3.D0*t329-1024.D
     #0/3.D0*t19)*s1l2+(-1024.D0/3.D0*t487+t489+t490)*t127-512.D0/3.D0*t
     #487+t489+t490)*s1l1+1024.D0/3.D0*t497*t219
      s2 = s1+1024.D0/3.D0*t497*t221+(((-1024.D0/3.D0*s4l2-1024.D0/3.D0*
     #s2l2)*s2l1-1024.D0/3.D0*t505)*t13+512.D0/3.D0*s1l1*s2l2*t19+512.D0
     #/3.D0*s1l2*s2l1*t19+(-1024.D0/3.D0*s2l2-t490)*s2l1-512.D0/3.D0*t50
     #5)*t119
      s3 = s2+(((t489+t521)*t127+t489+t521)*s1l1+((t124+t526)*t127+t124+
     #t526)*s1l2+(1024.D0/3.D0*t94+1024.D0/3.D0*t5+2048.D0/3.D0*t3+2048.
     #D0/3.D0*t1)*t127+t302+t6+1024.D0/3.D0*t3+1024.D0/3.D0*t1)*t13
      s4 = s3+((-1024.D0/3.D0*t12*t19*t135*s1l2+(t389*t19+t67+t34+t37)*t
     #135+((-t67+t64)*t19+t157*t18+t450+t451)*t127+(-t67+t34+t51)*t19-10
     #24.D0/3.D0*t207*t205+t276)*s1l1+((t416*t19+t77+t54+t74)*t135+((-t7
     #7+t73)*t19+t157*t26+t454+t455)*t127+(-t77+t54+t55)*t19-1024.D0/3.D
     #0*t207*t143+t166)*s1l2+(t235+t439+t440+t99+t100+t117)*t135+((t439+
     #t440+t447+t100+t442)*t19+(t406+t410)*s2l1+(t426+t427)*s2l2+(t64+t5
     #82*t35)*s3l1+t582*t221+(t103-512.D0/3.D0*z*(-7+t464)*t11)*t9)*t127
     #+(t433+t435+t441+t196+t442)*t19+(t275+t276)*s2l1+(t165+t166)*s2l2+
     #(t206+t218*t35)*s3l1+t222-512.D0/3.D0*t226*t12)*t13
      t635 = s4+(-512.D0/3.D0*t173*t33+512.D0/3.D0*t169*s4l2*t12)*s2l1+(
     #((512.D0/3.D0*t22+512.D0/3.D0*t36)*t135-t255*t127+t34+t37)*s1l1+((
     #512.D0/3.D0*t28+512.D0/3.D0*t42)*t135-t132*t127+t54+t74)*s1l2+(t96
     #+t98+t88+t91+t48)*t135+(t237+t239+t447+t100+t304)*t127+t82+t85+t30
     #3+t91+1024.D0/3.D0*t47)*t14
      taux1 = t301+t635
      t1 = -1+z
      t2 = 96*t1
      t3 = s4vf(z,l1,l2,l3,l4)
      t4 = 1/t3
      t5 = t2*t4
      t6 = s2l2*s3l1
      t8 = t3**2
      t9 = 1/t8
      t10 = s4l2*t9
      t11 = t10*s4l1
      t12 = 1024.D0/3.D0*t11
      t13 = s24f(z,l1,l2,l3,l4)
      t14 = t13*t9
      t15 = s23f(z,l1,l2,l3,l4)
      t16 = t15**2
      t17 = t16*t15
      t20 = t14*t16
      t23 = 1024.D0/3.D0*t14*t15
      t26 = t9*s3l2
      t29 = t9*s2l2
      t30 = 1024.D0/3.D0*t29
      t31 = 512*t10
      t34 = 512.D0/3.D0*t26
      t35 = 512.D0/3.D0*t10
      t38 = 1024.D0/3.D0*z
      t40 = (-2560.D0/3.D0+t38)*t9
      t42 = 512*z
      t44 = (-4096.D0/3.D0+t42)*t9
      t48 = 512*t29
      t49 = 1024.D0/3.D0*t26
      t53 = (-2048.D0/3.D0+t42)*t9
      t57 = (-3584.D0/3.D0+2560.D0/3.D0*z)*t9
      t64 = t1*t9
      t71 = t4*s3l2
      t73 = 96*t71*s2l1
      t74 = t4*s3l1
      t76 = 96*t74*s2l2
      t77 = s4l2*t4
      t78 = t71+t77
      t79 = 192*t78
      t81 = s4l1*t4
      t82 = t81*s3l2
      t83 = 192*t82
      t86 = z*t4
      t87 = s2l1*s3l2
      t92 = -t1
      t93 = 192*t92
      t94 = t93*t4
      t95 = s3l1*s4l2
      t97 = s3l2*s4l1
      t101 = t4*s2l2
      t102 = 192*t101
      t103 = 288*t77
      t113 = 192*t4*s2l1
      t114 = 288*t81
      t123 = t77*s3l1
      t124 = 192*t123
      t126 = (t73+t76+t124+t83)*t16
      t131 = s14f(z,l1,l2,l3,l4)
      t137 = t26*s2l1
      t138 = 1024.D0/3.D0*t137
      t139 = t9*s3l1
      t140 = t139*s2l2
      t141 = 1024.D0/3.D0*t140
      t142 = 2048.D0/3.D0*t26
      t143 = 1024.D0/3.D0*t10
      t146 = s4l1*t9
      t147 = t146*s3l2
      t148 = 1024.D0/3.D0*t147
      t159 = 2048.D0/3.D0*z
      t161 = (-5120.D0/3.D0+t159)*t9
      t164 = 4096.D0/3.D0*t11
      t167 = 1024.D0/3.D0*t1
      t168 = t167*t9
      t171 = -t30-t31
      t177 = 2048.D0/3.D0*t29
      t181 = 512.D0/3.D0*t29
      t184 = t9*s2l1
      t185 = 1024.D0/3.D0*t184
      t186 = 512*t146
      t187 = -t185-t186
      t193 = 2048.D0/3.D0*t184
      t197 = 512.D0/3.D0*t184
      t198 = 1024.D0/3.D0*t146
      t201 = t10*s3l1
      t202 = 2048.D0/3.D0*t201
      t203 = 2048.D0/3.D0*t147
      t210 = 512.D0/3.D0*t146
      t222 = 4096.D0/3.D0*t201
      t223 = 4096.D0/3.D0*t147
      t226 = 512.D0/3.D0*t137
      t227 = 512.D0/3.D0*t140
      t228 = 1024.D0/3.D0*t201
      t233 = t146*s2l2
      t234 = 512*t233
      t243 = -t30-t35
      t259 = t10*s2l1
      t261 = z*t9
      t262 = 1024.D0/3.D0*t261
      t267 = 1024.D0/3.D0*t139
      t270 = 2048.D0/3.D0*t11
      t275 = t139+t146
      t280 = 2048.D0/3.D0-t38
      t282 = t280*t9*s2l2
      t283 = 512.D0/3.D0*t92
      t284 = t283*t9
      t288 = 512.D0/3.D0*t139
      t293 = s13f(z,l1,l2,l3,l4)
      t294 = t293**2
      s1 = t5*t6-t12+((2048.D0/3.D0*t14*t17+1024*t20+t23)*s1l2+(1024.D0/
     #3.D0*t26*t13-t30-t31)*t17+((-t30+t34-t35)*t13+t40*s2l2+t44*s4l2)*t
     #16+((-t48-t49-t31)*t13+t53*s2l2+t57*s4l2)*t15+(-512.D0/3.D0*t29-51
     #2.D0/3.D0*t26-512.D0/3.D0*t10)*t13+512.D0/3.D0*t64*s2l2+1024.D0/3.
     #D0*t64*s4l2)*s1l1+((t73+t76+t79*s3l1+t83)*t13-96*t86*t87-96*t86*t6
     #+t94*t95+t94*t97)*t15+(((t102+t103)*t16+(t102+384*t77)*t15+96*t77)
     #*s1l1+((t113+t114)*t16+(t113+384*t81)*t15+96*t81)*s1l2+t126+(192*t
     #123+192*t82)*t15-t73-t76)*t131+(-t73-t76-192*t71*s3l1)*t13
      s2 = s1+((-t138-t141+(-t142-t143)*s3l1-t148)*t13+(t40*s3l2+t40*s4l
     #2)*s2l1+(t40*s3l1+t40*s4l1)*s2l2+t161*t95+t161*t97-t164)*t16+t168*
     #t95
      s3 = s2+t126
      s4 = s3+t5*t87
      s5 = s4
      s7 = ((t171*t17+(-2560.D0/3.D0*t29-4096.D0/3.D0*t10)*t16+(-t177-35
     #84.D0/3.D0*t10)*t15-t181-t143)*s1l1+(t187*t17+(-2560.D0/3.D0*t184-
     #4096.D0/3.D0*t146)*t16+(-t193-3584.D0/3.D0*t146)*t15-t197-t198)*s1
     #l2+(-t138-t141-t202-t203)*t17+((-2560.D0/3.D0*t26-t35)*s2l1+(-2560
     #.D0/3.D0*t139-t210)*s2l2-5120.D0/3.D0*t201-5120.D0/3.D0*t147)*t16+
     #((-t142-t35)*s2l1+(-2048.D0/3.D0*t139-t210)*s2l2-t222-t223)*t15-t2
     #26-t227-t228-t148)*t131
      s8 = ((((t177+t31)*s2l1+t234)*t15+(1024.D0/3.D0*t29+1024.D0/3.D0*t
     #10)*s2l1+1024.D0/3.D0*t233)*t131+((t243*t13-t30-t31)*t15-512.D0/3.
     #D0*t10*t13-t181-t143)*s1l1+(((-t185-t210)*t13-t185-t186)*t15-512.D
     #0/3.D0*t146*t13-t197-t198)*s1l2+((-512*t259-t234-t202-t203+t262)*t
     #13+(t177-t49-t35)*s2l1+(-t267-t210)*s2l2-t202-t203-t270)*t15+((t30
     #+t34+t35)*s2l1+512.D0/3.D0*t275*s2l2-t228-t148)*t13+(t282-t34+t284
     #*s4l2)*s2l1+(-t288+t284*s4l1)*s2l2-t228-t148-t12)*t294
      s6 = s7+s8
      t296 = s5+s6
      t307 = 512*t184
      t323 = t77*s2l1
      t324 = t81*s2l2
      t335 = 96*t71
      t336 = 192*t77
      t338 = (-t335-t336)*s2l1
      t339 = 96*t74
      t340 = 192*t81
      t342 = (-t339-t340)*s2l2
      t344 = 192*t77*s4l1
      t375 = 96*t77*t13
      t385 = 96*t81*t13
      t401 = (-192+96*z)*t4
      t404 = -t93*t4
      t427 = -t283*t9
      t451 = 512*t26
      t452 = 2048.D0/3.D0*t10
      t455 = 512*t139
      t460 = 1024*t147
      t474 = 1024*t10
      t480 = (-1024+t38)*t9
      t483 = (-5120.D0/3.D0+t42)*t9
      t490 = (-2+z)*t9
      t520 = -t275
      t534 = 512.D0/3.D0*z
      t536 = (-2560.D0/3.D0+t534)*t9
      t545 = (-2048+t159)*t9
      t562 = (-1024.D0/3.D0+t534)*t9
      t570 = -t280*t9
      s2 = ((t171*t16+(-t48-2560.D0/3.D0*t10)*t15-t181-t143)*s1l1+(t187*
     #t16+(-t307-2560.D0/3.D0*t146)*t15-t197-t198)*s1l2+((t177-t49+t31)*
     #s2l1+(-t267+t186)*s2l2-t202-t203)*t16+((1024*t29-t451+t452)*s2l1+(
     #-t455+2048.D0/3.D0*t146)*s2l2-1024*t201-t460)*t15+(t30-t34+t143)*s
     #2l1+(-t288+t198)*s2l2-t228-t148)*t131+((2048.D0/3.D0*t20+t23)*s1l2
     #+((-t30+t49+t31)*t13-t177-t474)*t16+((-t177-t34-t35)*t13+t480*s2l2
     #+t483*s4l2)*t15+(-t181-t34-t143)*t13+512.D0/3.D0*t490*s2l2+1024.D0
     #/3.D0*t490*s4l2)*s1l1
      s1 = s2+(((-t185+t267+t186)*t13-t193-1024*t146)*t16+((-t193-t288-t
     #210)*t13+t480*s2l1+t483*s4l1)*t15+(-t197-t288-t198)*t13+512.D0/3.D
     #0*t490*s2l1+1024.D0/3.D0*t490*s4l1)*s1l2+(1024.D0/3.D0*t261*t13+(t
     #30-t142-t452)*s2l1+2048.D0/3.D0*t520*s2l2-t222-t223-t164)*t16+(((t
     #30-t34-t143)*s2l1+(-t288-t198)*s2l2+(-t142-t474)*s3l1-t460+t262)*t
     #13+(t282+t480*s3l2+t536*s4l2)*s2l1+(t480*s3l1+t536*s4l1)*s2l2+t545
     #*t95+t545*t97-5120.D0/3.D0*t11)*t15
      t573 = s1+(1024.D0/3.D0*t29*s2l1+(-t49-t31)*s3l1-512*t147)*t13+(-t
     #167*t9*s2l2+t562*s3l2-t35)*s2l1+(t562*s3l1-t210)*s2l2+t570*t95+t57
     #0*t97-t270
      t601 = (384-288*z)*t4
      t606 = -t2*t4
      t629 = (-4096.D0/3.D0+1024*z)*t9
      s3 = ((1024.D0/3.D0*t139*t13-t185-t186)*t17+((-t185+t288-t210)*t13
     #+t40*s2l1+t44*s4l1)*t16+((-t307-t267-t186)*t13+t53*s2l1+t57*s4l1)*
     #t15+(-512.D0/3.D0*t184-512.D0/3.D0*t139-512.D0/3.D0*t146)*t13+512.
     #D0/3.D0*t64*s2l1+1024.D0/3.D0*t64*s4l1)*s1l2
      s4 = ((96*t323+96*t324)*t131-96*t77*s1l1-96*t81*s1l2+(-192*t323-19
     #2*t324-192*t123-192*t82)*t13+t338+t342-t124-t83-t344)*t294+(((-96*
     #t77*t15-96*t77)*s1l1+(-96*t81*t15-96*t81)*s1l2+((-384*t101-t335-t1
     #03)*s2l1+(-t339-t114)*s2l2-t124-t83)*t15-96*t78*s2l1+(-96*t74-96*t
     #81)*s2l2-t124-t83)*t131+(((t102+t335+t336)*t13+t102+t336)*t15+t375
     #+96*t86*s4l2)*s1l1+(((t113+t339+t340)*t13+t113+t340)*t15+t385+96*t
     #86*s4l1)*s1l2+((t124+t83-384*t86)*t13+t344)*t15+(t338+t342-t79*s3l
     #1-t83)*t13+(t401*s3l2+t404*s4l2)*s2l1+(t401*s3l1+t404*s4l1)*s2l2+t
     #404*t95+t404*t97-t344)*t293
      s2 = s3+s4
      s1 = s2+((512.D0/3.D0*t259+512.D0/3.D0*t233)*t13-t243*s2l1+512.D0/
     #3.D0*t233)*t294*t293+t168*t97+(t427*s3l2+t427*s4l2)*s2l1
      t653 = s1+t573*t293+(-t226-t227+(-t49-t35)*s3l1-512.D0/3.D0*t147)*
     #t13+((-1024.D0/3.D0*t26-1024.D0/3.D0*t10)*s2l1+1024.D0/3.D0*t520*s
     #2l2-t202-t203-t270)*t17+(t427*s3l1+t427*s4l1)*s2l2+((-96*t74*t13+t
     #113+t114)*t16+((t113+288*t74+t114)*t13+t94*s2l1+t601*s4l1)*t15+t38
     #5+t606*s4l1)*s1l2+(((-t451-t35)*s2l1+(-t455-t210)*s2l2+(-1024*t26-
     #t452)*s3l1-t203)*t13+(t53*s3l2+t53*s4l2)*s2l1+(t53*s3l1+t53*s4l1)*
     #s2l2+t629*t95+t629*t97-1024*t11)*t15+(-384*t16*t13*t4*s1l2+(-96*t7
     #1*t13+t102+t103)*t16+((t102+288*t71+t103)*t13+t94*s2l2+t601*s4l2)*
     #t15+t375+t606*s4l2)*s1l1
      taux2 = t296+t653
      t1 = s2l1*s4l2
      t2 = s2l2*s4l1
      t5 = s14f(z,l1,l2,l3,l4)
      t8 = s24f(z,l1,l2,l3,l4)
      t17 = s13f(z,l1,l2,l3,l4)
      t19 = 2048.D0/3.D0*s2l2
      t20 = 4096.D0/3.D0*s4l2
      t22 = s23f(z,l1,l2,l3,l4)
      t26 = 2048.D0/3.D0*s2l1
      t27 = 4096.D0/3.D0*s4l1
      t32 = s2l1*s3l2
      t34 = s2l2*s3l1
      t36 = s3l1*s4l2
      t38 = s3l2*s4l1
      t42 = 2048.D0/3.D0*t32
      t43 = 2048.D0/3.D0*t34
      t48 = s3l2*t8
      t50 = 2048.D0/3.D0*s4l2
      t56 = s3l1*t8
      t58 = 2048.D0/3.D0*s4l1
      t69 = s3vf(z,l1,l2,l3,l4)
      t70 = 1/t69
      t71 = s2l2*t70
      t72 = s4vf(z,l1,l2,l3,l4)
      t73 = 1/t72
      t74 = t73*t8
      t78 = s2l1*t70
      t82 = t70*t73
      t83 = t82*s3l2
      t84 = s4l2*t70
      t85 = t84*t73
      t86 = -t83+t85
      t87 = 2048.D0/3.D0*t86
      t88 = t87*s2l1
      t89 = t82*s3l1
      t90 = s4l1*t70
      t91 = t90*t73
      t92 = t89-t91
      t93 = 2048.D0/3.D0*t92
      t94 = t93*s2l2
      t95 = t88+t94
      t99 = t71*t73
      t100 = t99+t83
      t101 = 2048.D0/3.D0*t100
      t102 = t8**2
      t104 = 2048.D0/3.D0*t99
      t105 = 4096.D0/3.D0*t83
      t106 = 2048.D0/3.D0*t85
      t109 = 2048.D0/3.D0*t83
      t112 = t78*t73
      t113 = -t112-t89
      t114 = 2048.D0/3.D0*t113
      t116 = 2048.D0/3.D0*t112
      t117 = 4096.D0/3.D0*t89
      t118 = 2048.D0/3.D0*t91
      t121 = 2048.D0/3.D0*t89
      t125 = t84*t73*s2l1
      t126 = 2048.D0/3.D0*t125
      t128 = t90*t73*s2l2
      t129 = 2048.D0/3.D0*t128
      t130 = t73*s3l1
      t131 = t84*t130
      t132 = 4096.D0/3.D0*t131
      t133 = t73*s3l2
      t134 = t90*t133
      t135 = 4096.D0/3.D0*t134
      t138 = -t87
      t139 = t138*s2l1
      t140 = -t93
      t141 = t140*s2l2
      t142 = 8192.D0/3.D0*t131
      t143 = 8192.D0/3.D0*t134
      t145 = (t139+t141-t142+t143)*t8
      t147 = 2048.D0/3.D0*t82*t32
      t149 = 2048.D0/3.D0*t82*t34
      t151 = t17**2
      t153 = t73*t22
      t162 = t5**2
      t165 = 2048*t85
      t168 = 4096.D0/3.D0*t99
      t169 = 2048*t83
      t172 = 4096.D0/3.D0*t85
      t176 = 2048*t91
      t179 = 4096.D0/3.D0*t112
      t180 = 2048*t89
      t183 = 4096.D0/3.D0*t91
      t190 = 4096*t131
      t191 = 4096*t134
      t194 = z*t73
      t195 = t70*s3l2
      t199 = 2048.D0/3.D0*t194*t195-2048.D0/3.D0*t194*t84
      t201 = t70*s3l1
      t205 = -2048.D0/3.D0*t194*t201+2048.D0/3.D0*t194*t90
      t210 = -2048.D0/3.D0*t99-2048.D0/3.D0*t83+2048.D0/3.D0*t85
      t218 = -z+1
      t219 = 2*t218
      t220 = t219*t73
      t222 = 2*z
      t224 = (-t222+4)*t73
      t226 = z-3
      t227 = t226*t73
      t233 = 2048.D0/3.D0*t220*t195
      t235 = -t219*t73
      t237 = 2048.D0/3.D0*t235*t84
      t241 = 2048.D0/3.D0*t112+2048.D0/3.D0*t89-2048.D0/3.D0*t91
      t256 = 2048.D0/3.D0*t220*t201
      t258 = 2048.D0/3.D0*t235*t90
      t268 = (t105-t106)*s2l1
      t270 = (-t117+t118)*s2l2
      t271 = 10240.D0/3.D0*t131
      t272 = 10240.D0/3.D0*t134
      t275 = t109-t172
      t277 = -t121+t183
      t291 = 4*z
      t293 = (9-t291)*t73
      t294 = t84*s3l1
      t297 = t90*s3l2
      t302 = -t218
      t303 = t302*t73
      t305 = 4096.D0/3.D0*t303*t195
      t306 = t218*t73
      t308 = 2048.D0/3.D0*t306*t84
      t312 = 4096.D0/3.D0*t303*t201
      t314 = 2048.D0/3.D0*t306*t90
      t318 = 4*t218*t73
      t320 = 2048.D0/3.D0*t318*t294
      t322 = 2048.D0/3.D0*t318*t297
      s2 = (2048.D0/3.D0*t71*t153*s1l1-2048.D0/3.D0*t78*t153*s1l2+t95*t2
     #2+t88+t94)*t162+(((t138*t8-t104+t109-t165)*t22+(t168+t169-t106)*t8
     #+t105-t172)*s1l1+((t140*t8+t116-t121+t176)*t22+(-t179-t180+t118)*t
     #8-t117+t183)*s1l2+(t145+t126-t129-t142+t143)*t22+(-4096.D0/3.D0*t1
     #25+4096.D0/3.D0*t128-t190+t191)*t8+t199*s2l1+t205*s2l2-t142+t143)*
     #t5
      s1 = s2+((t210*t102+4096.D0/3.D0*t100*t8+t105-t172)*t22-t210*t102+
     #(2048.D0/3.D0*t220*t71+2048.D0/3.D0*t224*t195+2048.D0/3.D0*t227*t8
     #4)*t8+t233+t237)*s1l1+((t241*t102+4096.D0/3.D0*t113*t8-t117+t183)*
     #t22-t241*t102+(-2048.D0/3.D0*t220*t78-2048.D0/3.D0*t224*t201-2048.
     #D0/3.D0*t227*t90)*t8-t256-t258)*s1l2+(((t109-t165)*s2l1+(-t121+t17
     #6)*s2l2-t190+t191)*t8+t268+t270-t271+t272)*t22
      t323 = s1+(t275*s2l1+t277*s2l2-t142+t143)*t102+((-2048.D0/3.D0*t22
     #7*t195-2048.D0/3.D0*t224*t84)*s2l1+(2048.D0/3.D0*t227*t201+2048.D0
     #/3.D0*t224*t90)*s2l2-2048.D0/3.D0*t293*t294+2048.D0/3.D0*t293*t297
     #)*t8+(-t305-t308)*s2l1+(t312+t314)*s2l2-t320+t322
      s1 = ((4096.D0/3.D0*t1-4096.D0/3.D0*t2)*t5+2048.D0/3.D0*s1l1*s2l2*
     #t8-2048.D0/3.D0*s1l2*s2l1*t8+2048.D0/3.D0*t1-2048.D0/3.D0*t2)*t17+
     #(((-t19-t20)*t22-t19-t20)*s1l1+((t26+t27)*t22+t26+t27)*s1l2+(4096.
     #D0/3.D0*t32-4096.D0/3.D0*t34-8192.D0/3.D0*t36+8192.D0/3.D0*t38)*t2
     #2+t42-t43-4096.D0/3.D0*t36+4096.D0/3.D0*t38)*t5+((-4096.D0/3.D0*t4
     #8-t19-t50)*t22-2048.D0/3.D0*t48-t19-t50)*s1l1+((4096.D0/3.D0*t56+t
     #26+t58)*t22+2048.D0/3.D0*t56+t26+t58)*s1l2+(4096.D0/3.D0*t32-4096.
     #D0/3.D0*t34-4096.D0/3.D0*t36+4096.D0/3.D0*t38)*t22
      t325 = s1+t42-t43-2048.D0/3.D0*t36+2048.D0/3.D0*t38+((-2048.D0/3.D
     #0*t71*t74*s1l1+2048.D0/3.D0*t78*t74*s1l2+t95*t8+t88+t94)*t5+(t101*
     #t102+(t104+t105-t106)*t8+t109-t106)*s1l1+(t114*t102+(-t116-t117+t1
     #18)*t8-t121+t118)*s1l2+(-t126+t129-t132+t135)*t102+t145+t147-t149-
     #t132+t135)*t151+t323*t17
      t328 = t22**2
      t343 = t268+t270-t142+t143
      t357 = -t226*t73
      t361 = (t222-3)*t73
      t367 = t235*t195
      t370 = 4096.D0/3.D0*t303*t84
      t389 = t235*t201
      t392 = 4096.D0/3.D0*t303*t90
      t413 = (t291-7)*t73
      t422 = -4096.D0/3.D0*t86*s2l1
      t425 = -4096.D0/3.D0*t92*s2l2
      t428 = t306*t195
      t429 = t220*t84
      t433 = t306*t201
      t434 = t220*t90
      t439 = 8192.D0/3.D0*t303*t294
      t441 = 8192.D0/3.D0*t303*t297
      t451 = t73*t102
      t457 = t302*t218
      t460 = t302**2
      t485 = t139+t141-t132+t135
      t504 = t460*t70
      t515 = z**2
      t518 = (-2*t515-2+t291)*t73
      s3 = (((-2048.D0/3.D0*t99-2048.D0/3.D0*t85)*t328+(-t168+t109-t172)
     #*t22+t109-t106)*s1l1+((2048.D0/3.D0*t112+2048.D0/3.D0*t91)*t328+(t
     #179-t121+t183)*t22-t121+t118)*s1l2+(t147-t149-t132+t135)*t328+t343
     #*t22-t126+t129-t132+t135)*t162
      s5 = ((((2048.D0/3.D0*t99-2048.D0/3.D0*t83+2048.D0/3.D0*t85)*t8-t1
     #68+t109-t172)*t328+(-t101*t8+2048.D0/3.D0*t235*t71+2048.D0/3.D0*t3
     #57*t195+2048.D0/3.D0*t361*t84)*t22+t275*t8-2048.D0/3.D0*t367+t370)
     #*s1l1+(((-2048.D0/3.D0*t112+2048.D0/3.D0*t89-2048.D0/3.D0*t91)*t8+
     #t179-t121+t183)*t328+(-t114*t8-2048.D0/3.D0*t235*t78-2048.D0/3.D0*
     #t357*t201-2048.D0/3.D0*t361*t90)*t22+t277*t8+2048.D0/3.D0*t389-t39
     #2)*s1l2+t343*t328+(((t169-t106)*s2l1+(-t180+t118)*s2l2-t142+t143)*
     #t8+(-2048.D0/3.D0*t361*t195-2048.D0/3.D0*t357*t84)*s2l1+(2048.D0/3
     #.D0*t361*t201+2048.D0/3.D0*t357*t90)*s2l2+2048.D0/3.D0*t413*t294-2
     #048.D0/3.D0*t413*t297)*t22+(t422+t425-t271+t272)*t8+(2048.D0/3.D0*
     #t428-2048.D0/3.D0*t429)*s2l1+(-2048.D0/3.D0*t433+2048.D0/3.D0*t434
     #)*s2l2+t439-t441)*t5
      s6 = ((t87*t8+t109)*t328+(t87*t102+t199*t8+t233-t308)*t22-2048.D0/
     #3.D0*t84*t451+(2048.D0/3.D0*t428+t370)*t8-2048.D0/3.D0*t457*t83-20
     #48.D0/3.D0*t460*s4l2*t82)*s1l1
      s4 = s5+s6
      s2 = s3+s4
      s1 = s2+((t93*t8-t121)*t328+(t93*t102+t205*t8-t256+t314)*t22+2048.
     #D0/3.D0*t90*t451+(-2048.D0/3.D0*t433-t392)*t8+2048.D0/3.D0*t457*t8
     #9+2048.D0/3.D0*t460*s4l1*t82)*s1l2+t485*t328+((t422+t425-t142+t143
     #)*t8+(-t305+t237)*s2l1+(t312-t258)*s2l2+t439-t441)*t22
      t523 = s1+t485*t102+((-2048.D0/3.D0*t367-2048.D0/3.D0*t429)*s2l1+(
     #2048.D0/3.D0*t389+2048.D0/3.D0*t434)*s2l2-t320+t322)*t8+(2048.D0/3
     #.D0*t504*t133+2048.D0/3.D0*t457*t85)*s2l1+(-2048.D0/3.D0*t504*t130
     #-2048.D0/3.D0*t457*t91)*s2l2+2048.D0/3.D0*t518*t294-2048.D0/3.D0*t
     #518*t297
      taux3 = t325+t523
      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = t1**2
      t3 = 1/t2
      t4 = t3*s3l2
      t5 = s24f(z,l1,l2,l3,l4)
      t8 = t3*s2l2
      t9 = 4096.D0/3.D0*t8
      t10 = s4l2*t3
      t11 = 2048*t10
      t13 = s23f(z,l1,l2,l3,l4)
      t14 = t13**2
      t15 = t14*t13
      t17 = 10240.D0/3.D0*t4
      t18 = 2048.D0/3.D0*t10
      t21 = 2*z
      t22 = 5-t21
      t23 = t22*t3
      t26 = 3*z
      t28 = (8-t26)*t3
      t33 = 2048*t8
      t34 = 8192.D0/3.D0*t4
      t37 = -4+t26
      t38 = t37*t3
      t43 = (7-5*z)*t3
      t51 = -1+z
      t52 = t51*t3
      t55 = -t51
      t56 = 2*t55
      t57 = t56*t3
      t62 = t9+t11
      t67 = 2048.D0/3.D0*t8
      t68 = 4096.D0/3.D0*t10
      t71 = t3*s2l1
      t72 = 4096.D0/3.D0*t71
      t73 = s4l1*t3
      t74 = 2048*t73
      t75 = -t72-t74
      t77 = 2048*t71
      t81 = 2048.D0/3.D0*t71
      t82 = 4096.D0/3.D0*t73
      t85 = 4096.D0/3.D0*t4
      t88 = t3*s3l1
      t89 = 4096.D0/3.D0*t88
      t92 = t10*s3l1
      t93 = 8192.D0/3.D0*t92
      t94 = t73*s3l2
      t95 = 8192.D0/3.D0*t94
      t98 = 2048*t4
      t102 = 2048*t88
      t106 = 4096*t92
      t107 = 4096*t94
      t110 = 2048.D0/3.D0*t4
      t113 = 2048.D0/3.D0*t88
      t116 = 4096.D0/3.D0*t92
      t117 = 4096.D0/3.D0*t94
      t119 = s14f(z,l1,l2,l3,l4)
      t123 = 8192.D0/3.D0*t8
      t130 = (6-t21)*t3
      t134 = (-t26+10)*t3
      t141 = -2+z
      t142 = t141*t3
      t145 = -t21+4
      t146 = t145*t3
      t153 = 8192.D0/3.D0*t71
      t157 = 2048.D0/3.D0*t73
      t176 = 8192.D0/3.D0*t88
      t179 = 16384.D0/3.D0*t92
      t180 = 16384.D0/3.D0*t94
      t189 = z-3
      t190 = t189*t3
      t194 = -t189*t3
      t205 = 4*z
      t207 = (-12+t205)*t3
      t208 = s3l1*s4l2
      t211 = s3l2*s4l1
      t216 = t4*s2l1
      t217 = 4096.D0/3.D0*t216
      t218 = t88*s2l2
      t219 = 4096.D0/3.D0*t218
      t233 = -t145*t3
      t239 = s13f(z,l1,l2,l3,l4)
      t241 = 1/t1
      t242 = s4l2*t241
      t247 = s4l1*t241
      t252 = t241*s3l2
      t253 = 384*t252
      t254 = 1152*t242
      t257 = t241*s3l1
      t258 = 384*t257
      t259 = 1152*t247
      t262 = t242*s3l1
      t263 = 768*t262
      t264 = t247*s3l2
      t265 = 768*t264
      t277 = 768*t241*s2l2
      t278 = 768*t242
      t284 = 384*t242*t5
      t285 = z*t241
      t291 = 768*t241*s2l1
      t292 = 768*t247
      t298 = 384*t247*t5
      t304 = -768*t262+768*t264
      t306 = t242*s2l1
      t308 = t247*s2l2
      t313 = (-t253+t278)*s2l1
      t315 = (t258-t292)*s2l2
      t318 = t141*t241
      t320 = t56*t241
      t331 = 384*t320*t208
      t333 = 384*t320*t211
      t344 = t37*t241
      t349 = t51*t241
      t363 = t52*s4l1
      t367 = -t216+t218+t92-t94
      t373 = -t22*t3
      t385 = (-10+t205)*t3
      t393 = t52*s4l2
      t415 = (-8+6*z)*t3
      t438 = t10*s2l1
      t439 = t73*s2l2
      t440 = -t438+t439
      t488 = t239**2
      s3 = ((4096.D0/3.D0*t4*t5+t9+t11)*t15+((t9+t17+t18)*t5+2048.D0/3.D
     #0*t23*s2l2+2048.D0/3.D0*t28*s4l2)*t14+((t33+t34+t11)*t5-2048.D0/3.
     #D0*t38*s2l2+2048.D0/3.D0*t43*s4l2)*t13+(2048.D0/3.D0*t8+2048.D0/3.
     #D0*t4+2048.D0/3.D0*t10)*t5-2048.D0/3.D0*t52*s2l2+2048.D0/3.D0*t57*
     #s4l2)*s1l1
      s8 = ((t62*t14+(t33+10240.D0/3.D0*t10)*t13+t67+t68)*s1l1+(t75*t14+
     #(-t77-10240.D0/3.D0*t73)*t13-t81-t82)*s1l2+((-t85-t11)*s2l1+(t89+t
     #74)*s2l2+t93-t95)*t14+((-t98-8192.D0/3.D0*t10)*s2l1+(t102+8192.D0/
     #3.D0*t73)*s2l2+t106-t107)*t13+(-t110-t68)*s2l1+(t113+t82)*s2l2+t11
     #6-t117)*t119+(((-t9+t85-t11)*t5+t123+4096*t10)*t14+((t98+t18)*t5+2
     #048.D0/3.D0*t130*s2l2+2048.D0/3.D0*t134*s4l2)*t13+(t67+t110+t68)*t
     #5-2048.D0/3.D0*t142*s2l2+2048.D0/3.D0*t146*s4l2)*s1l1
      s7 = s8+(((t72-t89+t74)*t5-t153-4096*t73)*t14+((-t102-t157)*t5-204
     #8.D0/3.D0*t130*s2l1-2048.D0/3.D0*t134*s4l1)*t13+(-t81-t113-t82)*t5
     #+2048.D0/3.D0*t142*s2l1-2048.D0/3.D0*t146*s4l1)*s1l2+((-t34+t68)*s
     #2l1+(t176-t82)*s2l2+t179-t180)*t14+(((-t98+t68)*s2l1+(t102-t82)*s2
     #l2+t106-t107)*t5+(4096.D0/3.D0*t190*s3l2+2048.D0/3.D0*t194*s4l2)*s
     #2l1+(-4096.D0/3.D0*t190*s3l1-2048.D0/3.D0*t194*s4l1)*s2l2-2048.D0/
     #3.D0*t207*t208+2048.D0/3.D0*t207*t211)*t13
      s6 = s7+(-t217+t219+2048*t92-2048*t94)*t5+(2048.D0/3.D0*t142*s3l2+
     #2048.D0/3.D0*t10)*s2l1+(-2048.D0/3.D0*t142*s3l1-2048.D0/3.D0*t73)*
     #s2l2-2048.D0/3.D0*t233*t208+2048.D0/3.D0*t233*t211
      s7 = t239
      s5 = s6*s7
      s6 = (((384*t242*t13+384*t242)*s1l1+(-384*t247*t13-384*t247)*s1l2+
     #((-t253+t254)*s2l1+(t258-t259)*s2l2+t263-t265)*t13+(-384*t252+384*
     #t242)*s2l1+(384*t257-384*t247)*s2l2+t263-t265)*t119+(((t277+t253-t
     #278)*t5-t277-t278)*t13-t284-384*t285*s4l2)*s1l1+(((-t291-t258+t292
     #)*t5+t291+t292)*t13+t298+384*t285*s4l1)*s1l2+(t304*t5+1536*t306-15
     #36*t308)*t13+(t313+t315+t263-t265)*t5+(384*t318*s3l2+384*t320*s4l2
     #)*s2l1+(-384*t318*s3l1-384*t320*s4l1)*s2l2+t331-t333)*t239
      s4 = s5+s6
      s2 = s3+s4
      s1 = s2+((-384*t252*t5-t277-t254)*t14+((-t277-t253-t254)*t5-384*t3
     #20*s2l2+384*t344*s4l2)*t13-t284+384*t349*s4l2)*s1l1+((-4096.D0/3.D
     #0*t4+4096.D0/3.D0*t10)*s2l1+(4096.D0/3.D0*t88-4096.D0/3.D0*t73)*s2
     #l2+t93-t95)*t15+(-2048.D0/3.D0*t52*s3l1+2048.D0/3.D0*t363)*s2l2
      s2 = s1+2048.D0/3.D0*t367*t5+(4096.D0/3.D0*t367*t5+(2048.D0/3.D0*t
     #373*s3l2+2048.D0/3.D0*t23*s4l2)*s2l1+(-2048.D0/3.D0*t373*s3l1-2048
     #.D0/3.D0*t23*s4l1)*s2l2-2048.D0/3.D0*t385*t208+2048.D0/3.D0*t385*t
     #211)*t14
      s3 = s2+(2048.D0/3.D0*t52*s3l2-2048.D0/3.D0*t393)*s2l1
      s4 = s3+(((-t98+t18)*s2l1+(t102-t157)*s2l2+t93-t95)*t5+(2048.D0/3.
     #D0*t38*s3l2-2048.D0/3.D0*t38*s4l2)*s2l1+(-2048.D0/3.D0*t38*s3l1+20
     #48.D0/3.D0*t38*s4l1)*s2l2-2048.D0/3.D0*t415*t208+2048.D0/3.D0*t415
     #*t211)*t13
      t490 = s4+((384*t257*t5+t291+t259)*t14+((t291+t258+t259)*t5+384*t3
     #20*s2l1-384*t344*s4l1)*t13+t298-384*t349*s4l1)*s1l2+((2048*t440*t1
     #3-4096.D0/3.D0*t438+4096.D0/3.D0*t439)*t119+(((-t9+t18)*t5+t9+t11)
     #*t13+2048.D0/3.D0*t10*t5+t67+t68)*s1l1+(((t72-t157)*t5-t72-t74)*t1
     #3-2048.D0/3.D0*t73*t5-t81-t82)*s1l2+((2048*t438-2048*t439+t93-t95)
     #*t5+(-t85-t18)*s2l1+(t89+t157)*s2l2+t93-t95)*t13+((-2048.D0/3.D0*t
     #4-2048.D0/3.D0*t10)*s2l1+(2048.D0/3.D0*t88+2048.D0/3.D0*t73)*s2l2+
     #t116-t117)*t5+(-2048.D0/3.D0*t4+2048.D0/3.D0*t393)*s2l1+(2048.D0/3
     #.D0*t88-2048.D0/3.D0*t363)*s2l2+t116-t117)*t488
      t492 = -t56*t3
      t495 = t55*t241
      t496 = s2l2*s3l1
      t501 = t252*s2l1
      t502 = 384*t501
      t503 = t257*s2l2
      t504 = 384*t503
      t505 = t502-t504-t263+t265
      t506 = t505*t14
      t511 = 10240.D0/3.D0*t88
      t604 = s2l1*s3l2
      s1 = 2048.D0/3.D0*t492*t211+384*t495*t496-2048.D0/3.D0*t492*t208+t
     #506+((-4096.D0/3.D0*t88*t5-t72-t74)*t15+((-t72-t511-t157)*t5-2048.
     #D0/3.D0*t23*s2l1-2048.D0/3.D0*t28*s4l1)*t14+((-t77-t176-t74)*t5+20
     #48.D0/3.D0*t38*s2l1-2048.D0/3.D0*t43*s4l1)*t13+(-2048.D0/3.D0*t71-
     #2048.D0/3.D0*t88-2048.D0/3.D0*t73)*t5+2048.D0/3.D0*t52*s2l1-2048.D
     #0/3.D0*t57*s4l1)*s1l2+((t62*t15+(10240.D0/3.D0*t8+16384.D0/3.D0*t1
     #0)*t14+(t123+14336.D0/3.D0*t10)*t13+t67+t68)*s1l1+(t75*t15+(-10240
     #.D0/3.D0*t71-16384.D0/3.D0*t73)*t14+(-t153-14336.D0/3.D0*t73)*t13-
     #t81-t82)*s1l2+(-t217+t219+t93-t95)*t15+((-t17+t18)*s2l1+(t511-t157
     #)*s2l2+20480.D0/3.D0*t92-20480.D0/3.D0*t94)*t14+((-t34+t18)*s2l1+(
     #t176-t157)*s2l2+t179-t180)*t13-2048.D0/3.D0*t216+2048.D0/3.D0*t218
     #+t116-t117)*t119
      t628 = s1+(((-t277-t254)*t14+(-t277-1536*t242)*t13-384*t242)*s1l1+
     #((t291+t259)*t14+(t291+1536*t247)*t13+384*t247)*s1l2+t506+t304*t13
     #-t502+t504)*t119+(2048.D0/3.D0*t440*t5-2048.D0/3.D0*t438+2048.D0/3
     #.D0*t439)*t488*t239+(t505*t5-384*t285*t604+384*t285*t496-t331+t333
     #)*t13+((-384*t306+384*t308)*t119+384*t242*s1l1-384*t247*s1l2+(768*
     #t306-768*t308+768*t262-768*t264)*t5+t313+t315+t263-t265)*t488+(-38
     #4*t501+384*t503)*t5-384*t495*t604
      taux4 = t490+t628

CCC Coefficients

      tcoff1 = taux1+taux2
      tcoff2 = taux1+taux2
      tcoff3 = taux2
      tcoff4 = taux2
      tcoff5 = taux3+taux4
      tcoff6 = -taux3-taux4
      tcoff7 = taux4
      tcoff8 = -taux4

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet1 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet2 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = s23f(z,l1,l2,l3,l4)
      t2 = s13f(z,l1,l2,l3,l4)
      t3 = s24f(z,l1,l2,l3,l4)
      t4 = s14f(z,l1,l2,l3,l4)
      tFjet3 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = s24f(z,l1,l2,l3,l4)
      t2 = s14f(z,l1,l2,l3,l4)
      t3 = s23f(z,l1,l2,l3,l4)
      t4 = s13f(z,l1,l2,l3,l4)
      tFjet4 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t4-t2-t3-t1,-1+z-t3-t
     #1,-1+z-t4-t2,1+t4+t3,1+t2+t1,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff4)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet5 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t4-t2-t3-t1,-1+z-t3-t
     #1,-1+z-t4-t2,1+t4+t3,1+t2+t1,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,8.D0,1.D0,1.D0,Tcoeff*tcoff5)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet6 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t4-t2-t3-t1,-1+z-t3-t
     #1,-1+z-t4-t2,1+t4+t3,1+t2+t1,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,8.D0,1.D0,1.D0,Tcoeff*tcoff6)
      t1 = s23f(z,l1,l2,l3,l4)
      t2 = s13f(z,l1,l2,l3,l4)
      t3 = s24f(z,l1,l2,l3,l4)
      t4 = s14f(z,l1,l2,l3,l4)
      tFjet7 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t4-t2-t3-t1,-1+z-t3-t
     #1,-1+z-t4-t2,1+t4+t3,1+t2+t1,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,8.D0,1.D0,1.D0,Tcoeff*tcoff7)
      t1 = s24f(z,l1,l2,l3,l4)
      t2 = s14f(z,l1,l2,l3,l4)
      t3 = s23f(z,l1,l2,l3,l4)
      t4 = s13f(z,l1,l2,l3,l4)
      tFjet8 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t4-t2-t3-t1,-1+z-t3-t
     #1,-1+z-t4-t2,1+t4+t3,1+t2+t1,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,8.D0,1.D0,1.D0,Tcoeff*tcoff8)

CCC Sum

      ggrmnum1e0 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcof
     #f4+tFjet5*tcoff5+tFjet6*tcoff6+tFjet7*tcoff7+tFjet8*tcoff8
      RETURN
      END

      double precision function ggrmnum1e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = t1**2
      t3 = s3vf(z,l1,l2,l3,l4)
      t4 = 1/t3
      t5 = t2*t4
      t6 = s4vf(z,l1,l2,l3,l4)
      t7 = 1/t6
      t8 = t7*s2l2
      t11 = t1*t7
      t12 = t4*s3l2
      t14 = 512.D0/3.D0*t11*t12
      t17 = s2l2*s3l1
      t19 = s2l2*t4
      t22 = 512.D0/3.D0*t19*t7*s1l1
      t23 = s2l1*t4
      t26 = 512.D0/3.D0*t23*t7*s1l2
      t27 = z*t4
      t28 = s23f(z,l1,l2,l3,l4)
      t29 = t28**2
      t31 = t27*t7*t29
      t34 = s24f(z,l1,l2,l3,l4)
      t35 = t4*t34
      t36 = z*t7*t35
      t37 = 2048.D0/3.D0*t36
      t38 = t27*t7
      t42 = 1024*t36
      t43 = t7*s2l1
      t45 = 1024.D0/3.D0*t19*t43
      t46 = 512*t38
      t48 = s14f(z,l1,l2,l3,l4)
      t49 = t48**2
      t51 = t4*t7
      t52 = t51*t28
      t54 = 2048.D0/3.D0*t51
      t57 = t19*t7
      t58 = s4l2*t4
      t59 = t58*t7
      t63 = 512*t57
      t64 = t51*s3l2
      t65 = 512.D0/3.D0*t64
      t69 = (-2+z)*t7
      t70 = t69*t19
      t71 = 512.D0/3.D0*t70
      t72 = 1024.D0/3.D0*t59
      t75 = t23*t7
      t76 = s4l1*t4
      t77 = t76*t7
      t81 = 512*t75
      t82 = t51*s3l1
      t83 = 512.D0/3.D0*t82
      t87 = 512.D0/3.D0*t69*t23
      t88 = 1024.D0/3.D0*t77
      t94 = t34**2
      t96 = t27*t7*t94
      t97 = 2048.D0/3.D0*t96
      t98 = 2*z
      t101 = t51*t34
      t104 = 2048.D0/3.D0*t57
      t105 = 512.D0/3.D0*t59
      t108 = t76*t8
      t109 = 512.D0/3.D0*t108
      t114 = 512.D0/3.D0*z*(16-8*z)*t51
      t118 = 1024.D0/3.D0*t57
      t120 = (t118+t65)*s2l1
      t121 = t51*t17
      t122 = 512.D0/3.D0*t121
      t126 = z*(22-10*z)*t51
      t133 = 1024.D0/3.D0*t108
      t134 = -t1
      t138 = 4096.D0/3.D0*z*t134*t51
      t141 = 1024.D0/3.D0*t101
      t145 = 2048.D0/3.D0*t11*t4
      t150 = 512.D0/3.D0*t57
      t153 = -t57-t64
      t154 = 1024.D0/3.D0*t153
      t156 = 1024.D0/3.D0*z
      t158 = (-2048.D0/3.D0+t156)*t7
      t160 = 1024.D0/3.D0*t64
      t164 = 512.D0/3.D0*t1*t7
      t165 = t164*t19
      t167 = (512-t156)*t7
      t171 = 512.D0/3.D0*t77
      t174 = 512.D0/3.D0*t75
      t177 = -t75-t82
      t181 = 1024.D0/3.D0*t82
      t184 = t164*t23
      t188 = 2048.D0/3.D0*t38
      t192 = t58*t43
      t197 = (t118-t105)*s2l1
      t200 = 1024.D0/3.D0*s4l2*t7*s4l1
      t202 = 9*z*t134
      t211 = t27*t7*t94*t34
      t213 = 6*z
      t215 = z*(14-t213)
      t216 = t51*t94
      t224 = z**2
      t225 = 4*t224
      t232 = t11*t19
      t241 = 5*t224
      t243 = z*(-6+11*z-t241)
      s2 = (-t22-t26+512*t31+(t37+1024*t38)*t28+t42+t45+t46)*t49+(((1024
     #.D0/3.D0*t52+t54)*s1l2+(-512.D0/3.D0*t57+512.D0/3.D0*t59)*t28+(-t6
     #3-t65)*t34+t71+t65+t72)*s1l1+((-512.D0/3.D0*t75+512.D0/3.D0*t77)*t
     #28+(-t81-t83)*t34+t87+t83+t88)*s1l2+(t37+3584.D0/3.D0*t38)*t29+(t9
     #7-1024.D0/3.D0*z*(-8+t98)*t101+(t104+t105)*s2l1+t109+t114)*t28+358
     #4.D0/3.D0*t96+(t120+t122+512.D0/3.D0*t126)*t34+(-1024.D0/3.D0*t70-
     #1024.D0/3.D0*t59)*s2l1-t133+t138)*t48+(((t141+t54)*t28+t141-t145)*
     #s1l2+((-t63+t105)*t34-t150+t105)*t28+t154*t94+(t158*t19-t160+t105)
     #*t34+t165+t167*t58)*s1l1
      s1 = s2+(((-t81+t171)*t34-t174+t171)*t28+1024.D0/3.D0*t177*t94+(t1
     #58*t23-t181+t171)*t34+t184+t167*t76)*s1l2+(t42+t188)*t29+(5120.D0/
     #3.D0*t96+(-512.D0/3.D0*t192-512.D0/3.D0*t108+512.D0/3.D0*t126)*t34
     #+t197-t109+(-t200+512.D0/3.D0*t202*t7)*t4)*t28
      t248 = s1+1024.D0/3.D0*t211+512.D0/3.D0*t215*t216+((t118+t65-t72)*
     #s2l1+(t83-t88)*s2l2-512.D0/3.D0*z*(-18+20*z-t225)*t51)*t34+(-1024.
     #D0/3.D0*t232+t65+t164*t58)*s2l1+(t83+t164*t76)*s2l2+(t200-512.D0/3
     #.D0*t243*t7)*t4
      t249 = s13f(z,l1,l2,l3,l4)
      t251 = s2l1*s3l2
      t253 = t28*z
      t255 = z*t34
      t256 = 1024.D0/3.D0*t255
      t262 = 512.D0/3.D0*t255
      t268 = t4*s3l1
      t269 = t268*s2l2
      t283 = 4*z
      t284 = -5+t283
      t291 = 512.D0/3.D0*z*(-t98+1)
      t294 = 512*t36
      t296 = (t118+t105)*s2l1
      t300 = 512.D0/3.D0*z*(t283-3)*t51
      t318 = t27*t7*t29*t28
      t319 = 512.D0/3.D0*t318
      t326 = 3584.D0/3.D0*t36
      t330 = 512.D0/3.D0*z*(t213-8)*t51
      t335 = 512*t96
      t342 = 2048.D0/3.D0*t232
      t344 = 512.D0/3.D0*t11*t58
      t347 = t11*t76
      t355 = 512.D0/3.D0*z*(-4+9*z-t241)*t51
      t362 = 512.D0/3.D0*t211
      s1 = (1024.D0/3.D0*t5*t8-t14)*s2l1-512.D0/3.D0*t17+t248*t249-512.D
     #0/3.D0*t251+((2048.D0/3.D0*t253+t256+t156)*t48+(1024.D0/3.D0*z+102
     #4.D0/3.D0*t255)*t28+t262+1024.D0/3.D0*s2l2*s2l1+512.D0/3.D0*z)*t24
     #9+t262
      t363 = s1-512.D0/3.D0*t11*t269+((-512.D0/3.D0*s2l2-1024.D0/3.D0*s4
     #l2)*s1l1+(-512.D0/3.D0*s2l1-1024.D0/3.D0*s4l1)*s1l2+1024.D0/3.D0*t
     #29*z+(2048.D0/3.D0*t255-512.D0/3.D0*z*t284)*t28+t256+t291)*t48+(t2
     #94+t296+t109-t300)*t29+(((1024.D0/3.D0*t52+1024.D0/3.D0*t51)*s1l2+
     #512.D0/3.D0*t51*s3l2*t28+t65)*s1l1+(512.D0/3.D0*t51*s3l1*t28+512.D
     #0/3.D0*t82)*s1l2+t319+(t294-512.D0/3.D0*z*(t98-6)*t51)*t29+(t326+t
     #45-t330)*t28+t37+t45-t300)*t49+(t335+((t104+t160+t105)*s2l1+(t181+
     #t171)*s2l2+t138)*t34+(-t342+t65-t344)*s2l1+(512.D0/3.D0*t82-512.D0
     #/3.D0*t347)*s2l2-t355)*t28+(t256-1024.D0/3.D0*t251-1024.D0/3.D0*t1
     #7+t291)*t28+t362
      t375 = (z-3)*t7
      t387 = 512.D0/3.D0*t153
      t396 = 512.D0/3.D0*t177
      t425 = 1024.D0/3.D0*t51*s3l2*s3l1
      t438 = -z*t284
      t457 = t7*t34
      t458 = t457*t29
      t461 = t387*t94
      t475 = 512.D0/3.D0*t38
      t481 = t396*t94
      t509 = t249**2
      s2 = 512.D0/3.D0*t1*z*(-2*t224+t283-2)*t7*t4+(((1024.D0/3.D0*t51*t
     #29+(2048.D0/3.D0*t101-1024.D0/3.D0*t375*t4)*t28+t141-t145)*s1l2+((
     #-512.D0/3.D0*t57+512.D0/3.D0*t64)*t34+t65+t105)*t28+t387*t34-t14+t
     #105)*s1l1+(((-512.D0/3.D0*t75+512.D0/3.D0*t82)*t34+t83+t171)*t28+t
     #396*t34-512.D0/3.D0*t11*t268+t171)*s1l2+1024.D0/3.D0*t318+(t42+t29
     #6+t109-t330)*t29+(t97+(t120+t122+t114)*t34+(-1024.D0/3.D0*t375*t19
     #+t65+t105)*s2l1+(512.D0/3.D0*t82+512.D0/3.D0*t77)*s2l2-512.D0/3.D0
     #*z*(-10+16*z-t225)*t51)*t28+t97+((t104+t65)*s2l1+t122-t425+512.D0/
     #3.D0*t202*t51)*t34+(-t342+t65)*s2l1+t122-t355)*t48+(-t154*s2l1+102
     #4.D0/3.D0*t121+t425+512.D0/3.D0*t438*t51)*t94
      s1 = s2+(((1024.D0/3.D0*t101+1024.D0/3.D0*t51)*t29+(1024.D0/3.D0*t
     #216-1024.D0/3.D0*t69*t35-t145)*t28-1024.D0/3.D0*t11*t35+1024.D0/3.
     #D0*t5*t7)*s1l2-512.D0/3.D0*t19*t458+(t461+(t71-t160)*t34+t105)*t28
     #+t461+(t165+t164*t12+t105)*t34-t344)*s1l1+(512.D0/3.D0*t31+1024.D0
     #/3.D0*t27*t7*t28+t475)*t49*t48+(-512.D0/3.D0*t23*t458+(t481+(t87-t
     #181)*t34+t171)*t28+t481+(t184+t164*t268+t171)*t34-512.D0/3.D0*t347
     #)*s1l2+(1024.D0/3.D0*t34*s1l2-512.D0/3.D0*s2l2*t28-1024.D0/3.D0*s2
     #l2-512.D0/3.D0*s4l2)*s1l1
      t557 = s1+(-512.D0/3.D0*s2l1*t28-1024.D0/3.D0*s2l1-512.D0/3.D0*s4l
     #1)*s1l2+(512.D0/3.D0*t96+1024.D0/3.D0*t36+t475)*t509*t249+((-t22-t
     #26+(2048.D0/3.D0*t36+2048.D0/3.D0*t38)*t28+t335+5120.D0/3.D0*t36+t
     #197-t109+t46)*t48+(1024.D0/3.D0*t51*s1l2-1024.D0/3.D0*t19*t457-t15
     #0+t72)*s1l1+(-1024.D0/3.D0*t23*t457-t174+t88)*s1l2+(t335+t326+t188
     #)*t28+t362+512.D0/3.D0*z*(10-t98)*t216+(-1024.D0/3.D0*t192-t133+51
     #2.D0/3.D0*t215*t51)*t34-512.D0/3.D0*t192-t109+(t200+512.D0/3.D0*t4
     #38*t7)*t4)*t509-512.D0/3.D0*t224+((-t342+t167*t12)*s2l1+t167*t269+
     #t425-512.D0/3.D0*t243*t51)*t34+1024.D0/3.D0*t253*t49+t319
      taux1 = t363+t557
      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = 1/t1
      t3 = z*t2
      t4 = s23f(z,l1,l2,l3,l4)
      t5 = t4**2
      t7 = 96*t3*t5
      t8 = t3*t4
      t9 = 192*t8
      t12 = s14f(z,l1,l2,l3,l4)
      t13 = t12**2
      t15 = t1**2
      t16 = 1/t15
      t17 = t16*s2l2
      t18 = 1024.D0/3.D0*t17
      t19 = t16*s3l2
      t20 = 512.D0/3.D0*t19
      t21 = s4l2*t16
      t22 = 1024.D0/3.D0*t21
      t25 = t16*s3l1
      t27 = s4l1*t16
      t28 = 1024.D0/3.D0*t27
      t32 = 512.D0/3.D0*t21*s3l1
      t34 = 512.D0/3.D0*t27*s3l2
      t35 = 2*z
      t36 = -t35+1
      t41 = s24f(z,l1,l2,l3,l4)
      t45 = t5*t4
      t47 = 512.D0/3.D0*t21
      t48 = -t18-t47
      t51 = -1024.D0/3.D0+512.D0/3.D0*z
      t52 = t51*t16
      t53 = t52*s2l2
      t56 = 512*t17
      t59 = -1+z
      t61 = 512.D0/3.D0*t59*t16
      t64 = -t51*t16
      t68 = t17*t41
      t70 = t59*t16
      t75 = t3*t41
      t76 = 288*t75
      t80 = t2*s2l2
      t82 = 96*t80*s1l1
      t83 = t2*s2l1
      t85 = 96*t83*s1l2
      t86 = -t75-t3
      t89 = -5+t35
      t91 = t2*t41
      t94 = 4*z
      t95 = 5-t94
      t100 = s13f(z,l1,l2,l3,l4)
      t101 = t100**2
      t103 = z*t16
      t104 = t103*t41
      t108 = t41**2
      t109 = t103*t108
      t110 = 512.D0/3.D0*t109
      t111 = 512*t104
      t114 = 1024.D0/3.D0*t103
      t116 = t101*t100
      t118 = t59*z
      t121 = 512*t109
      t122 = 1024*t17
      t123 = 512*t19
      t129 = 7*z
      t136 = 3*z
      t141 = 512*t21
      t144 = t27*s2l2
      t145 = 512*t144
      t146 = t21*s4l1
      t147 = 1024.D0/3.D0*t146
      t148 = 11*z
      t149 = z**2
      t172 = 96*t3*t45
      t174 = -t59
      t181 = t2*s3l2
      t182 = t181*s2l1
      t184 = t2*s3l1*s2l2
      t190 = 96*t75
      t192 = 96*t184
      t194 = 96*t149*t2
      t197 = 512.D0/3.D0*t144
      t218 = s4l2*t2
      t220 = t80*t41
      t225 = s4l1*t2
      t227 = t83*t41
      t236 = 192*t3*t108
      t238 = z*(t35-3)
      t250 = 96*t218*s3l1
      t252 = 96*t225*s3l2
      t253 = 2*t149
      t259 = (-96*t8-96*t3)*t13+(t82+t85+t7+(96*t75-96*z*(-t35+4)*t2)*t4
     #-384*t75+(384*t80+96*t181)*s2l1+t192-96*z*(-t136+5)*t2)*t12+(96*t2
     #18*t4-96*t220-96*t3*s2l2)*s1l1+(96*t225*t4-96*t227-96*t3*s2l1)*s1l
     #2+(t76+192*t3)*t5+(t236-96*t238*t91-t194)*t4+192*t118*t91-192*t218
     #*s2l1-192*t225*s2l2-t250-t252+96*z*(-t253+5*z-2)*t2
      t261 = t103*t5
      t262 = t103*t4
      t267 = -512.D0/3.D0*t17+512.D0/3.D0*t21
      t271 = t16*s2l1
      t273 = -512.D0/3.D0*t271+512.D0/3.D0*t27
      t275 = 512.D0/3.D0*t27
      t278 = t103*t45
      t280 = 5120.D0/3.D0*t104
      t282 = z*(-16+t94)
      t289 = (-t18-t20-t47)*s2l1
      t290 = -t25-t27
      t292 = 512.D0/3.D0*t290*s2l2
      t300 = t21*s2l1
      t302 = 1024.D0/3.D0*t144
      t314 = (-2+z)*t16
      t320 = -1024.D0/3.D0*t271-t275
      t322 = 512*t271
      t325 = t52*s2l1
      t328 = t271*t41
      t334 = 1024.D0/3.D0*t104
      t353 = 9*z
      t364 = 2048.D0/3.D0*t21
      t367 = 2048.D0/3.D0*t144
      t369 = 4*t149
      t376 = 2048.D0/3.D0*t17
      t377 = 1024.D0/3.D0*t19
      s1 = (-512.D0/3.D0*t261-512.D0/3.D0*t262)*t13+((t267*t4+t47)*s1l1+
     #(t273*t4+t275)*s1l2-1024*t278+(-t280+512.D0/3.D0*t282*t16)*t5+(-25
     #60*t104+t289+t292+512.D0/3.D0*z*(-13+t129)*t16)*t4-2560.D0/3.D0*t1
     #04-1024.D0/3.D0*t300-t302+512.D0/3.D0*t238*t16)*t12+(t48*t5+((-t56
     #-t47)*t41+t53+t22)*t4-1024.D0/3.D0*t68-512.D0/3.D0*t314*s4l2)*s1l1
     #+(t320*t5+((-t322-t275)*t41+t325+t28)*t4-1024.D0/3.D0*t328-512.D0/
     #3.D0*t314*s4l1)*s1l2+(-t334-4096.D0/3.D0*t103)*t45+(-6656.D0/3.D0*
     #t104+(-5120.D0/3.D0*t17-t141)*s2l1-t145+1024.D0/3.D0*z*(t129-9)*t1
     #6)*t5
      t401 = s1+(-2048.D0/3.D0*t109+((-t122-t123-t141)*s2l1+512*t290*s2l
     #2+512.D0/3.D0*z*(-16+t353)*t16)*t41+((-8192.D0/3.D0+1024*z)*t16*s2
     #l2-t364)*s2l1-t367+t32+t34+t147+512.D0/3.D0*z*(-14+20*z-t369)*t16)
     #*t4-t121+((-t376-t377-t141)*s2l1+(-1024.D0/3.D0*t25-512*t27)*s2l2-
     #t32-t34-2560.D0/3.D0*z*t174*t16)*t41+((-1024+2048.D0/3.D0*z)*t16*s
     #2l2-t22)*s2l1-t302+2048.D0/3.D0*t146-512.D0/3.D0*z*(4+t253-t129)*t
     #16
      s1 = (-t7-t9-96*t3)*t13+((-t18-t20-t22)*s2l1+(-512.D0/3.D0*t25-t28
     #)*s2l2-t32-t34-512.D0/3.D0*z*t36*t16)*t41+((-512.D0/3.D0*t17-512.D
     #0/3.D0*t21)*t45+(t48*t41+t53)*t5+((-t56+t47)*t41+t61*s2l2+t64*s4l2
     #)*t4-512.D0/3.D0*t68-512.D0/3.D0*t70*s4l2)*s1l1+((-t9-t76-288*t3)*
     #t12+t82+t85+96*t86*t4+96*z*t89*t91-96*z*t95*t2)*t101+((-2048.D0/3.
     #D0*t104-2048.D0/3.D0*t103)*t4-t110-t111-1024.D0/3.D0*t17*s2l1-t114
     #)*t116-96*t118*t2+(-t121+((-t122-t123-t22)*s2l1+(-512*t25-t28)*s2l
     #2+t32+t34-512.D0/3.D0*z*(-t129+4)*t16)*t41+(1024.D0/3.D0*(-4+t136)
     #*t16*s2l2-t141)*s2l1-t145+t32+t34+t147-512.D0/3.D0*z*(4-t148+6*t14
     #9)*t16)*t4
      t403 = s1+192*t86*t116-t110+(1024.D0/3.D0*t70*s2l2-t47)*s2l1+((-96
     #*t80*t4-96*t80)*s1l1+(-96*t83*t4-96*t83)*s1l2+t172+(192*t75+192*z*
     #t174*t2)*t5+(96*t75-96*t182-96*t184+96*z*t174*t2)*t4-t190-96*t182-
     #t192+t194)*t12-t197+t147+t259*t100+t401*t100
      t431 = -t36
      t435 = t5**2
      t437 = 1024.D0/3.D0*t103*t435
      t446 = -512.D0/3.D0*z*t95*t16
      t472 = 96*t227
      t475 = (-192+96*z)*t2
      t480 = t59*t2
      t494 = 96*t220
      t544 = 512.D0/3.D0*t300
      t551 = 1024*t104
      t593 = (-2048.D0/3.D0*t261+(-t551-3584.D0/3.D0*t103)*t4-t111-t544-
     #t197-t114)*t12+(-512.D0/3.D0*t17*t4-512.D0/3.D0*t68+512.D0/3.D0*t2
     #1)*s1l1+(-512.D0/3.D0*t271*t4-512.D0/3.D0*t328+512.D0/3.D0*t27)*s1
     #l2+(-t551-5120.D0/3.D0*t103)*t5+(-t110+512.D0/3.D0*t282*t16*t41+(-
     #4096.D0/3.D0*t17-t47)*s2l1-t197+512.D0/3.D0*z*(8*z-14)*t16)*t4-t12
     #1+(t289+t292+512.D0/3.D0*z*(t136-7)*t16)*t41+((-1024+1024.D0/3.D0*
     #z)*t16*s2l2-t47)*s2l1-t197+t147+t446
      s1 = ((-512.D0/3.D0*t271-512.D0/3.D0*t27)*t45+(t320*t41+t325)*t5+(
     #(-t322+t275)*t41+t61*s2l1+t64*s4l1)*t4-512.D0/3.D0*t328-512.D0/3.D
     #0*t70*s4l1)*s1l2+t172+t190+(t236+384*z*t174*t91+t250+t252-96*z*(-t
     #253+t94-3)*t2)*t4-512.D0/3.D0*t118*t431*t16+t250+t252-t437
      s2 = s1+(-1024.D0/3.D0*t109+((-t376-t377-t22)*s2l1+1024.D0/3.D0*t2
     #90*s2l2+t446)*t41+(1024.D0/3.D0*t89*t16*s2l2-t364)*s2l1-t367+t32+t
     #34+512.D0/3.D0*z*(-7+14*z-t369)*t16)*t5+(-t334+(-t376-t22)*s2l1-t3
     #02+1024*t59*z*t16)*t45+((-96*t83-96*t225)*t5+(-t472+t475*s2l1-96*t
     #225)*t4-t472+96*t480*s2l1)*s1l2
      t595 = s2+(t76+288*z*t174*t2)*t5+((-96*t80-96*t218)*t5+(-t494+t475
     #*s2l2-96*t218)*t4-t494+96*t480*s2l2)*s1l1+(-512.D0/3.D0*t278-1024.
     #D0/3.D0*t261-512.D0/3.D0*t262)*t13+((t267*t5+(-512.D0/3.D0*t17+t22
     #)*t4+t47)*s1l1+(t273*t5+(-512.D0/3.D0*t271+t28)*t4+t275)*s1l2-t437
     #+(-2048.D0/3.D0*t104+512.D0/3.D0*z*(t94-7)*t16)*t45+(-t280+(-t18-t
     #20)*s2l1-512.D0/3.D0*t25*s2l2+512.D0/3.D0*z*(-9+t148)*t16)*t5+(-40
     #96.D0/3.D0*t104+t289+t292+512.D0/3.D0*z*(-5+t353)*t16)*t4-t334-t54
     #4-t197+512.D0/3.D0*z*t431*t16)*t12+t593*t101
      taux2 = t403+t595
      t1 = s2l1*s4l2
      t2 = s2l2*s4l1
      t5 = s14f(z,l1,l2,l3,l4)
      t8 = s24f(z,l1,l2,l3,l4)
      t17 = s13f(z,l1,l2,l3,l4)
      t22 = s23f(z,l1,l2,l3,l4)
      t24 = 8192.D0/3.D0*s2l2
      t32 = 8192.D0/3.D0*s2l1
      t36 = s2l1*s3l2
      t38 = s2l2*s3l1
      t40 = s3l1*s4l2
      t42 = s3l2*s4l1
      t48 = 4096*t40
      t49 = 4096*t42
      t52 = s3l2*t8
      t62 = s3l1*t8
      t80 = s3vf(z,l1,l2,l3,l4)
      t81 = 1/t80
      t82 = s2l2*t81
      t83 = s4vf(z,l1,l2,l3,l4)
      t84 = 1/t83
      t85 = t84*t8
      t86 = t82*t85
      t88 = t82*t84
      t89 = 2048.D0/3.D0*t88
      t92 = s2l1*t81
      t93 = t92*t85
      t95 = t92*t84
      t96 = 2048.D0/3.D0*t95
      t99 = t81*t84
      t100 = t99*s3l2
      t101 = s4l2*t81
      t102 = t101*t84
      t103 = t100-t102
      t104 = 2048*t103
      t105 = t104*s2l1
      t106 = t99*s3l1
      t107 = s4l1*t81
      t108 = t107*t84
      t109 = -t106+t108
      t110 = 2048*t109
      t111 = t110*s2l2
      t112 = t105+t111
      t116 = 4096.D0/3.D0*t88
      t117 = 2048*t100
      t119 = t8**2
      t121 = 4096*t100
      t122 = 4096.D0/3.D0*t102
      t127 = 4096.D0/3.D0*t95
      t128 = 2048*t106
      t131 = 4096*t106
      t132 = 4096.D0/3.D0*t108
      t137 = t84*s2l1
      t140 = t84*s2l2
      t143 = t84*s3l1
      t144 = t101*t143
      t145 = 4096*t144
      t146 = t84*s3l2
      t147 = t107*t146
      t148 = 4096*t147
      t155 = 8192*t144
      t156 = 8192*t147
      t160 = 2048*t99*t36
      t162 = 2048*t99*t38
      t164 = t17**2
      t166 = t84*t22
      t177 = t5**2
      t179 = -t104
      t186 = 2048*t102
      t189 = 2-z
      t190 = t189*t84
      t191 = t190*t82
      t193 = 10240.D0/3.D0*t102
      t196 = -t110
      t203 = 2048*t108
      t206 = t190*t92
      t208 = 10240.D0/3.D0*t108
      t211 = t179*s2l1
      t212 = t196*s2l2
      t217 = 4096.D0/3.D0*t100
      t218 = 4096*t102
      t220 = (-t217+t218)*s2l1
      t221 = 4096.D0/3.D0*t106
      t222 = 4096*t108
      t224 = (t221-t222)*s2l2
      t225 = 12288*t144
      t226 = 12288*t147
      t229 = 3*z
      t231 = (t229-1)*t84
      t232 = t81*s3l2
      t235 = (-t229-2)*t84
      t240 = t81*s3l1
      t254 = -t217+t186
      t256 = z*t81
      t259 = 6*z
      t261 = (-13+t259)*t84
      t265 = (8-t229)*t84
      t270 = -z+1
      t271 = t270*t84
      t273 = 2048.D0/3.D0*t271*t82
      t274 = -7+t259
      t275 = t274*t84
      t277 = 2048.D0/3.D0*t275*t232
      t279 = 5*t270*t84
      t290 = t221-t203
      t301 = 2048.D0/3.D0*t271*t92
      t303 = 2048.D0/3.D0*t275*t240
      t320 = 10240*t144
      t321 = 10240*t147
      t336 = 12*z
      t338 = (-30+t336)*t84
      t339 = t101*s3l1
      t342 = t107*s3l2
      t348 = 3*t270*t84
      t350 = 4096.D0/3.D0*t348*t232
      t353 = (5*z-6)*t84
      t359 = 4096.D0/3.D0*t348*t240
      t365 = (-14+t336)*t84
      t367 = 2048.D0/3.D0*t365*t339
      t369 = 2048.D0/3.D0*t365*t342
      s2 = ((-4096.D0/3.D0*t82*t166+t89)*s1l1+(4096.D0/3.D0*t92*t166-t96
     #)*s1l2+t112*t22+t105+t111)*t177+(((t179*t8+2048*t88-t117+16384.D0/
     #3.D0*t102)*t22+(-t89-14336.D0/3.D0*t100+t186)*t8+2048.D0/3.D0*t191
     #-t121+t193)*s1l1+((t196*t8-2048*t95+t128-16384.D0/3.D0*t108)*t22+(
     #t96+14336.D0/3.D0*t106-t203)*t8-2048.D0/3.D0*t206+t131-t208)*s1l2+
     #((t211+t212+t155-t156)*t8+t155-t156)*t22+(t220+t224+t225-t226)*t8+
     #(-2048.D0/3.D0*t231*t232-2048.D0/3.D0*t235*t101)*s2l1+(2048.D0/3.D
     #0*t231*t240+2048.D0/3.D0*t235*t107)*s2l2+t155-t156)*t5
      s1 = s2+(((t116+t117-t186)*t119+(-t89-t121+t122)*t8+t89-t121+t218)
     #*t22+t254*t119+(4096.D0/3.D0*t256*t140+2048.D0/3.D0*t261*t232+2048
     #.D0/3.D0*t265*t101)*t8+t273+t277+2048.D0/3.D0*t279*t101)*s1l1+(((-
     #t127-t128+t203)*t119+(t96+t131-t132)*t8-t96+t131-t222)*t22+t290*t1
     #19+(-4096.D0/3.D0*t256*t137-2048.D0/3.D0*t261*t240-2048.D0/3.D0*t2
     #65*t107)*t8-t301-t303-2048.D0/3.D0*t279*t107)*s1l2+(((-t117+14336.
     #D0/3.D0*t102)*s2l1+(t128-14336.D0/3.D0*t108)*s2l2+t225-t226)*t8+(-
     #t121+t193)*s2l1+(t131-t208)*s2l2+t320-t321)*t22
      t370 = s1+(t220+t224+t155-t156)*t119+((-2048.D0/3.D0*t265*t232-204
     #8.D0/3.D0*t261*t101)*s2l1+(2048.D0/3.D0*t265*t240+2048.D0/3.D0*t26
     #1*t107)*s2l2-2048.D0/3.D0*t338*t339+2048.D0/3.D0*t338*t342)*t8+(-t
     #350-2048.D0/3.D0*t353*t101)*s2l1+(t359+2048.D0/3.D0*t353*t107)*s2l
     #2-t367+t369
      s1 = ((-4096*t1+4096*t2)*t5-2048*s1l1*s2l2*t8+2048*s1l2*s2l1*t8-20
     #48*t1+2048*t2)*t17+(((2048*s2l2+4096*s4l2)*t22+t24+16384.D0/3.D0*s
     #4l2)*s1l1+((-2048*s2l1-4096*s4l1)*t22-t32-16384.D0/3.D0*s4l1)*s1l2
     #+(-4096*t36+4096*t38+8192*t40-8192*t42)*t22-2048*t36+2048*t38+t48-
     #t49)*t5+((4096*t52+t24+2048*s4l2)*t22+2048*t52+10240.D0/3.D0*s2l2+
     #8192.D0/3.D0*s4l2)*s1l1+((-4096*t62-t32-2048*s4l1)*t22-2048*t62-10
     #240.D0/3.D0*s2l1-8192.D0/3.D0*s4l1)*s1l2+(-16384.D0/3.D0*t36+16384
     #.D0/3.D0*t38+t48-t49)*t22
      t372 = s1-8192.D0/3.D0*t36+8192.D0/3.D0*t38+2048*t40-2048*t42+(((4
     #096.D0/3.D0*t86+t89)*s1l1+(-4096.D0/3.D0*t93-t96)*s1l2+t112*t8+t10
     #5+t111)*t5+((-t116-t117)*t119+(-t121+t122)*t8+t89-t117+t122)*s1l1+
     #((t127+t128)*t119+(t131-t132)*t8-t96+t128-t132)*s1l2+(2048*t101*t1
     #37-2048*t107*t140+t145-t148)*t119+((-t117+t122)*s2l1+(t128-t132)*s
     #2l2+t155-t156)*t8-t160+t162+t145-t148)*t164+t370*t17
      t374 = t22**2
      t376 = 8192.D0/3.D0*t88
      t383 = 8192.D0/3.D0*t95
      t394 = (-t121+t186)*s2l1+(t131-t203)*s2l2+t155-t156
      t409 = 4*t270
      t410 = t409*t84
      t414 = (t229-10)*t84
      t418 = (10-t259)*t84
      t423 = 10240.D0/3.D0*t100
      t427 = -t274*t84
      t431 = 4096.D0/3.D0*t348*t101
      t447 = 10240.D0/3.D0*t106
      t453 = 4096.D0/3.D0*t348*t107
      t476 = (22-t336)*t84
      t492 = -t409*t84
      t494 = t275*t101
      t499 = t275*t107
      t504 = 8192.D0/3.D0*t348*t339
      t506 = 8192.D0/3.D0*t348*t342
      t509 = t89+t117-t186
      t531 = -t270
      t535 = (t270*t189+2*t531**2)*t84
      t538 = t531**2
      t544 = -t96-t128+t203
      t604 = t538*t81
      t617 = z**2
      t620 = (6*t617-t336+6)*t84
      s3 = (((t116+t186)*t374+(t376-t117+t218)*t22-t117+t186)*s1l1+((-t1
     #27-t203)*t374+(-t383+t128-t222)*t22+t128-t203)*s1l2+(-t160+t162+t1
     #45-t148)*t374+t394*t22+(-2048.D0/3.D0*t100+t186)*s2l1+(2048.D0/3.D
     #0*t106-t203)*s2l2+t145-t148)*t177
      s7 = (((-t116+t117-t186)*t8+t376-t117+t218)*t374+(2048*t86+2048.D0
     #/3.D0*t410*t82+2048.D0/3.D0*t414*t232+2048.D0/3.D0*t418*t101)*t22+
     #(t89-t423+t218)*t8-2048.D0/3.D0*t427*t232+t431)*s1l1+(((t127-t128+
     #t203)*t8-t383+t128-t222)*t374+(-2048*t93-2048.D0/3.D0*t410*t92-204
     #8.D0/3.D0*t414*t240-2048.D0/3.D0*t418*t107)*t22+(-t96+t447-t222)*t
     #8+2048.D0/3.D0*t427*t240-t453)*s1l2+t394*t374+(((-16384.D0/3.D0*t1
     #00+t186)*s2l1+(16384.D0/3.D0*t106-t203)*s2l2+t155-t156)*t8+(-2048.
     #D0/3.D0*t418*t232-2048.D0/3.D0*t414*t101)*s2l1+(2048.D0/3.D0*t418*
     #t240+2048.D0/3.D0*t414*t107)*s2l2+2048.D0/3.D0*t476*t339-2048.D0/3
     #.D0*t476*t342)*t22
      s6 = s7+(-4096*t103*s2l1-4096*t109*s2l2+t320-t321)*t8+(2048.D0/3.D
     #0*t492*t232-2048.D0/3.D0*t494)*s2l1+(-2048.D0/3.D0*t492*t240+2048.
     #D0/3.D0*t499)*s2l2+t504-t506
      s7 = t5
      s5 = s6*s7
      s6 = ((t509*t8-t117+2048.D0/3.D0*t102)*t374+(t509*t119+(2048.D0/3.
     #D0*t191+2048.D0/3.D0*t235*t232+2048.D0/3.D0*t231*t101)*t8+t277-204
     #8.D0/3.D0*t492*t101)*t22+(t89+t186)*t119+(t273+2048.D0/3.D0*t353*t
     #232+t431)*t8-2048.D0/3.D0*t535*t232+2048*t538*s4l2*t99)*s1l1
      s4 = s5+s6
      s2 = s3+s4
      s1 = s2+((t544*t8+t128-2048.D0/3.D0*t108)*t374+(t544*t119+(-2048.D
     #0/3.D0*t206-2048.D0/3.D0*t235*t240-2048.D0/3.D0*t231*t107)*t8-t303
     #+2048.D0/3.D0*t492*t107)*t22+(-t96-t203)*t119+(-t301-2048.D0/3.D0*
     #t353*t240-t453)*t8+2048.D0/3.D0*t535*t240-2048*t538*s4l1*t99)*s1l2
     #+(t211+t212+t145-t148)*t374+(((-t423+t218)*s2l1+(t447-t222)*s2l2+t
     #155-t156)*t8+(-t350+2048.D0/3.D0*t427*t101)*s2l1+(t359-2048.D0/3.D
     #0*t427*t107)*s2l2+t504-t506)*t22
      t625 = s1+(t254*s2l1+t290*s2l2+t145-t148)*t119+((-2048.D0/3.D0*t27
     #9*t232-2048.D0/3.D0*t494)*s2l1+(2048.D0/3.D0*t279*t240+2048.D0/3.D
     #0*t499)*s2l2-t367+t369)*t8+(-2048*t604*t146+2048.D0/3.D0*t535*t101
     #)*s2l1+(2048*t604*t143-2048.D0/3.D0*t535*t107)*s2l2+2048.D0/3.D0*t
     #620*t339-2048.D0/3.D0*t620*t342
      taux3 = t372+t625
      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = 1/t1
      t3 = t2*s3l2
      t4 = t3*s2l1
      t5 = t2*s3l1
      t6 = t5*s2l2
      t9 = s24f(z,l1,l2,l3,l4)
      t13 = s4l2*t2
      t14 = t13*s3l1
      t15 = 2304*t14
      t16 = s4l1*t2
      t17 = t16*s3l2
      t18 = 2304*t17
      t19 = -1152*t4+1152*t6+t15-t18
      t20 = s23f(z,l1,l2,l3,l4)
      t21 = t20**2
      t22 = t19*t21
      t23 = t2*s2l2
      t24 = 1920*t23
      t25 = 3456*t13
      t31 = 1152*t13
      t34 = t2*s2l1
      t35 = 1920*t34
      t36 = 3456*t16
      t42 = 1152*t16
      t52 = s14f(z,l1,l2,l3,l4)
      t54 = -z+1
      t56 = t1**2
      t57 = 1/t56
      t58 = 6*t54*t57
      t59 = s3l2*s4l1
      t62 = s4l2*t57
      t63 = t62*s2l1
      t64 = s4l1*t57
      t65 = t64*s2l2
      t66 = t63-t65
      t73 = t57*s2l2
      t74 = 10240.D0/3.D0*t73
      t75 = 2048*t62
      t78 = 4096*t73
      t79 = 6144*t62
      t84 = 2048*t73
      t85 = 14336.D0/3.D0*t62
      t88 = t57*s2l1
      t89 = 10240.D0/3.D0*t88
      t90 = 2048*t64
      t93 = 4096*t88
      t94 = 6144*t64
      t99 = 2048*t88
      t100 = 14336.D0/3.D0*t64
      t105 = t62*s3l1
      t106 = 8192*t105
      t107 = t64*s3l2
      t108 = 8192*t107
      t111 = t57*s3l2
      t112 = 4096*t111
      t113 = 4096.D0/3.D0*t62
      t115 = (t112+t113)*s2l1
      t116 = t57*s3l1
      t117 = 4096*t116
      t118 = 4096.D0/3.D0*t64
      t120 = (-t117-t118)*s2l2
      t123 = 2048*t111
      t127 = 2048*t116
      t131 = 4096*t105
      t132 = 4096*t107
      t135 = 3*t54
      t136 = t135*t57
      t137 = t136*s4l2
      t141 = t136*s4l1
      t146 = s13f(z,l1,l2,l3,l4)
      t147 = t146**2
      t149 = s3l1*s4l2
      t156 = 384*t23
      t161 = 384*t34
      t166 = 1152*t3
      t169 = 1152*t5
      t182 = 2304*t13
      t185 = 1536*t23
      t189 = 384*t3
      t192 = z*t2
      t197 = 2304*t16
      t200 = 1536*t34
      t204 = 384*t5
      t214 = t13*s2l1
      t216 = t16*s2l2
      t226 = 3*z
      t228 = (-t226+4)*t2
      t230 = 6*z
      t232 = (-7+t230)*t2
      t243 = 384*t232*t149
      t245 = 384*t232*t59
      t277 = t21*t20
      t281 = 15-t230
      t282 = t281*t57
      t285 = -t281*t57
      t295 = 12*z
      t297 = (29-t295)*t57
      t304 = -t74-t79
      t306 = 6144*t73
      t312 = t89+t94
      t314 = 6144*t88
      t334 = 12288*t105
      t335 = 12288*t107
      t348 = 8192*t73
      t357 = (t230-18)*t57
      t360 = 9*z
      t362 = (t360-32)*t57
      t371 = (6-t226)*t57
      t376 = (-14+7*z)*t57
      t383 = 8192*t88
      t412 = 16384*t105
      t413 = 16384*t107
      t416 = 6144*t111
      t419 = 6144*t116
      t425 = (-t226+9)*t57
      t429 = (t226-10)*t57
      t441 = (35-t295)*t57
      t465 = (12-t230)*t57
      t480 = -t54
      t482 = 4*t480*t2
      t486 = (11-t360)*t2
      t493 = t135*t2
      s1 = (384*t4-384*t6)*t9+t22+(((t24+t25)*t21+(t24+4608*t13)*t20+t31
     #)*s1l1+((-t35-t36)*t21+(-t35-4608*t16)*t20-t42)*s1l2+t22+(-384*t4+
     #384*t6+t15-t18)*t20+768*t4-768*t6)*t52+2048.D0/3.D0*t58*t59+((6144
     #*t66*t20+14336.D0/3.D0*t63-14336.D0/3.D0*t65)*t52+(((t74-t75)*t9-t
     #78-t79)*t20-2048*t62*t9-t84-t85)*s1l1+(((-t89+t90)*t9+t93+t94)*t20
     #+2048*t64*t9+t99+t100)*s1l2+((-6144*t63+6144*t65-t106+t108)*t9+t11
     #5+t120-t106+t108)*t20+((t123+8192.D0/3.D0*t62)*s2l1+(-t127-8192.D0
     #/3.D0*t64)*s2l2-t131+t132)*t9+(t123+2048.D0/3.D0*t137)*s2l1+(-t127
     #-2048.D0/3.D0*t141)*s2l2-t131+t132)*t147-2048.D0/3.D0*t58*t149
      s3 = s1+(-2048.D0/3.D0*t136*s3l1+2048.D0/3.D0*t141)*s2l2
      s4 = s3
      s6 = ((((-t156-t31)*t20-t31)*s1l1+((t161+t42)*t20+t42)*s1l2+((t166
     #-t25)*s2l1+(-t169+t36)*s2l2-t15+t18)*t20+(768*t3-t31)*s2l1+(-768*t
     #5+t42)*s2l2-t15+t18)*t52+(((-t24-t166+t182)*t9+t185+2688*t13)*t20+
     #(-t156-t189+t31)*t9+1152*t192*s4l2)*s1l1+(((t35+t169-t197)*t9-t200
     #-2688*t16)*t20+(t161+t204-t42)*t9-1152*t192*s4l1)*s1l2+((2304*t14-
     #2304*t17)*t9-3456*t214+3456*t216)*t20+((t189-t182)*s2l1+(-t204+t19
     #7)*s2l2-t15+t18)*t9+(384*t228*s3l2+384*t232*s4l2)*s2l1+(-384*t228*
     #s3l1-384*t232*s4l1)*s2l2+t243-t245)*t146
      s7 = ((1152*t214-1152*t216)*t52+(384*t23*t9-t31)*s1l1+(-384*t34*t9
     #+t42)*s1l2+(-2304*t214+2304*t216-2304*t14+2304*t17)*t9+(t166-1920*
     #t13)*s2l1+(-t169+1920*t16)*s2l2-t15+t18)*t147
      s5 = s6+s7
      s2 = s4+s5
      s3 = s2+((4096*t111-4096*t62)*s2l1+(-4096*t116+4096*t64)*s2l2-t106
     #+t108)*t277
      s4 = s3+((t115+t120-t131+t132)*t9+(2048.D0/3.D0*t282*s3l2+2048.D0/
     #3.D0*t285*s4l2)*s2l1+(-2048.D0/3.D0*t282*s3l1-2048.D0/3.D0*t285*s4
     #l1)*s2l2-2048.D0/3.D0*t297*t149+2048.D0/3.D0*t297*t59)*t21
      s5 = s4
      s10 = ((t304*t21+(-t306-32768.D0/3.D0*t62)*t20-t84-t85)*s1l1+(t312
     #*t21+(t314+32768.D0/3.D0*t64)*t20+t99+t100)*s1l2+((t112+t79)*s2l1+
     #(-t117-t94)*s2l2-t106+t108)*t21+((20480.D0/3.D0*t111+26624.D0/3.D0
     #*t62)*s2l1+(-20480.D0/3.D0*t116-26624.D0/3.D0*t64)*s2l2-t334+t335)
     #*t20+(t123+16384.D0/3.D0*t62)*s2l1+(-t127-16384.D0/3.D0*t64)*s2l2-
     #t131+t132)*t52+(((t74-t112+t79)*t9-t348-38912.D0/3.D0*t62)*t21+((-
     #2048.D0/3.D0*t73-16384.D0/3.D0*t111-t113)*t9+2048.D0/3.D0*t357*s2l
     #2+2048.D0/3.D0*t362*s4l2)*t20+(-t84-t123-4096*t62)*t9-2048.D0/3.D0
     #*t371*s2l2+2048.D0/3.D0*t376*s4l2)*s1l1
      s9 = s10+(((-t89+t117-t94)*t9+t383+38912.D0/3.D0*t64)*t21+((2048.D
     #0/3.D0*t88+16384.D0/3.D0*t116+t118)*t9-2048.D0/3.D0*t357*s2l1-2048
     #.D0/3.D0*t362*s4l1)*t20+(t99+t127+4096*t64)*t9+2048.D0/3.D0*t371*s
     #2l1-2048.D0/3.D0*t376*s4l1)*s1l2+((8192*t111-t85)*s2l1+(-8192*t116
     #+t100)*s2l2-t412+t413)*t21+(((t416-t75)*s2l1+(-t419+t90)*s2l2-t334
     #+t335)*t9+(4096.D0/3.D0*t425*s3l2+2048.D0/3.D0*t429*s4l2)*s2l1+(-4
     #096.D0/3.D0*t425*s3l1-2048.D0/3.D0*t429*s4l1)*s2l2-2048.D0/3.D0*t4
     #41*t149+2048.D0/3.D0*t441*t59)*t20
      s8 = s9+((t112+t75)*s2l1+(-t117-t90)*s2l2-16384.D0/3.D0*t105+16384
     #.D0/3.D0*t107)*t9+(2048.D0/3.D0*t371*s3l2-t75)*s2l1+(-2048.D0/3.D0
     #*t371*s3l1+t90)*s2l2-2048.D0/3.D0*t465*t149+2048.D0/3.D0*t465*t59
      s9 = t146
      s7 = s8*s9
      s8 = ((-1152*t5*t9-t200-3072*t16)*t21+((-t200-1536*t5-t36)*t9+384*
     #t482*s2l1-384*t486*s4l1)*t20+(-t204-t42)*t9-384*t493*s4l1)*s1l2
      s6 = s7+s8
      t498 = s5+s6
      t499 = 2048.D0/3.D0*t62
      t502 = 2048.D0/3.D0*t64
      t510 = (12-t360)*t57
      t523 = (23-18*z)*t57
      t532 = 20480.D0/3.D0*t64
      t541 = (t360-26)*t57
      t553 = (-23+16*z)*t57
      t564 = 7*t480*t57
      t589 = t480*t2
      t590 = s2l2*s3l1
      t659 = 20480.D0/3.D0*t62
      t698 = (2-t226)*t2
      t699 = s2l1*s3l2
      s1 = (((t416-t499)*s2l1+(-t419+t502)*s2l2-26624.D0/3.D0*t105+26624
     #.D0/3.D0*t107)*t9+(2048.D0/3.D0*t510*s3l2-2048.D0/3.D0*t510*s4l2)*
     #s2l1+(-2048.D0/3.D0*t510*s3l1+2048.D0/3.D0*t510*s4l1)*s2l2-2048.D0
     #/3.D0*t523*t149+2048.D0/3.D0*t523*t59)*t20+((4096*t116*t9+t93+t532
     #)*t277+((t93+28672.D0/3.D0*t116+t118)*t9-2048.D0/3.D0*t285*s2l1-20
     #48.D0/3.D0*t541*s4l1)*t21+((t314+22528.D0/3.D0*t116+t532)*t9+2048.
     #D0/3.D0*t510*s2l1-2048.D0/3.D0*t553*s4l1)*t20+(2048*t88+2048*t116+
     #2048*t64)*t9+2048.D0/3.D0*t136*s2l1-2048.D0/3.D0*t564*s4l1)*s1l2+(
     #(1152*t3*t9+t185+3072*t13)*t21+((t185+1536*t3+t25)*t9-384*t482*s2l
     #2+384*t486*s4l2)*t20+(t189+t31)*t9+384*t493*s4l2)*s1l1+384*t589*t5
     #90+384*t14-384*t17
      s2 = s1+(2048.D0/3.D0*t136*s3l2-2048.D0/3.D0*t137)*s2l1+((t304*t27
     #7+(-28672.D0/3.D0*t73-51200.D0/3.D0*t62)*t21+(-t348-47104.D0/3.D0*
     #t62)*t20-t84-t85)*s1l1+(t312*t277+(28672.D0/3.D0*t88+51200.D0/3.D0
     #*t64)*t21+(t383+47104.D0/3.D0*t64)*t20+t99+t100)*s1l2+(4096*t111*s
     #2l1-4096*t116*s2l2-t106+t108)*t277+((32768.D0/3.D0*t111-t75)*s2l1+
     #(-32768.D0/3.D0*t116+t90)*s2l2-20480*t105+20480*t107)*t21+((26624.
     #D0/3.D0*t111-t113)*s2l1+(-26624.D0/3.D0*t116+t118)*s2l2-t412+t413)
     #*t20+(t123+t499)*s2l1+(-t127-t502)*s2l2-t131+t132)*t52+((t123+t113
     #)*s2l1+(-t127-t118)*s2l2-4096.D0/3.D0*t105+4096.D0/3.D0*t107)*t9
      t708 = s2+((-4096*t111*t9-t78-t659)*t277+((-t78-28672.D0/3.D0*t111
     #-t113)*t9+2048.D0/3.D0*t285*s2l2+2048.D0/3.D0*t541*s4l2)*t21+((-t3
     #06-22528.D0/3.D0*t111-t659)*t9-2048.D0/3.D0*t510*s2l2+2048.D0/3.D0
     #*t553*s4l2)*t20+(-2048*t73-2048*t111-2048*t62)*t9-2048.D0/3.D0*t13
     #6*s2l2+2048.D0/3.D0*t564*s4l2)*s1l1+(2048*t66*t9+2048*t63-2048*t65
     #)*t147*t146+(t19*t9-384*t698*t699+384*t698*t590-t243+t245)*t20-384
     #*t589*t699
      taux4 = t498+t708

CCC Coefficients

      tcoff1 = taux1+taux2
      tcoff2 = taux1+taux2
      tcoff3 = taux2
      tcoff4 = taux2
      tcoff5 = taux3+taux4
      tcoff6 = -taux3-taux4
      tcoff7 = taux4
      tcoff8 = -taux4

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet1 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet2 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = s23f(z,l1,l2,l3,l4)
      t2 = s13f(z,l1,l2,l3,l4)
      t3 = s24f(z,l1,l2,l3,l4)
      t4 = s14f(z,l1,l2,l3,l4)
      tFjet3 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = s24f(z,l1,l2,l3,l4)
      t2 = s14f(z,l1,l2,l3,l4)
      t3 = s23f(z,l1,l2,l3,l4)
      t4 = s13f(z,l1,l2,l3,l4)
      tFjet4 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff4)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet5 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,8.D0,1.D0,1.D0,Tcoeff*tcoff5)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet6 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,8.D0,1.D0,1.D0,Tcoeff*tcoff6)
      t1 = s23f(z,l1,l2,l3,l4)
      t2 = s13f(z,l1,l2,l3,l4)
      t3 = s24f(z,l1,l2,l3,l4)
      t4 = s14f(z,l1,l2,l3,l4)
      tFjet7 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,8.D0,1.D0,1.D0,Tcoeff*tcoff7)
      t1 = s24f(z,l1,l2,l3,l4)
      t2 = s14f(z,l1,l2,l3,l4)
      t3 = s23f(z,l1,l2,l3,l4)
      t4 = s13f(z,l1,l2,l3,l4)
      tFjet8 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,8.D0,1.D0,1.D0,Tcoeff*tcoff8)

CCC Sum

      ggrmnum1e1 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcof
     #f4+tFjet5*tcoff5+tFjet6*tcoff6+tFjet7*tcoff7+tFjet8*tcoff8
      RETURN
      END

      double precision function ggrmnum1e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t3 = s4vf(z,l1,l2,l3,l4)
      t4 = 1/t3
      t5 = z*t4
      t6 = s3vf(z,l1,l2,l3,l4)
      t7 = 1/t6
      t8 = s24f(z,l1,l2,l3,l4)
      t9 = t7*t8
      t10 = s23f(z,l1,l2,l3,l4)
      t11 = t10**2
      t14 = 512.D0/3.D0*t5*t9*t11
      t15 = s4l2*t7
      t17 = t15*t4*s3l1
      t18 = s4l1*t7
      t20 = t18*t4*s3l2
      t21 = z**2
      t22 = t21*t4
      t23 = t22*t7
      t29 = t5*t9
      t30 = z*t7
      t31 = t30*t4
      t34 = s14f(z,l1,l2,l3,l4)
      t36 = t8**2
      t38 = t30*t4*t36
      t40 = 512*t29
      t41 = 512.D0/3.D0*t31
      t43 = s13f(z,l1,l2,l3,l4)
      t44 = t43**2
      t46 = t4*t10
      t47 = t30*t46
      t50 = t34**2
      t55 = s2l2*t7
      t56 = t55*t4
      t58 = t7*t4
      t59 = t58*s3l2
      t66 = 512.D0/3.D0*t23
      t71 = (512.D0/3.D0*t56+512.D0/3.D0*t59)*t8
      t75 = s2l1*t7
      t76 = t75*t4
      t80 = (512.D0/3.D0*t76+512.D0/3.D0*t58*s3l1)*t8
      t84 = 512.D0/3.D0*t38
      t90 = 512.D0/3.D0*t15*t4*s2l1
      t93 = 512.D0/3.D0*t18*t4*s2l2
      t105 = (-512.D0/3.D0*t47-512.D0/3.D0*t31)*t50+(-1024.D0/3.D0*t5*t9
     #*t10+t40+(-1024.D0/3.D0*t56-512.D0/3.D0*t59)*s2l1-512.D0/3.D0*t58*
     #s3l1*s2l2+t66)*t34+(t71+512.D0/3.D0*t56)*s1l1+(t80+512.D0/3.D0*t76
     #)*s1l2+(t84+t40+t41)*t10+512*t38+(t90+t93+1024.D0/3.D0*t17+1024.D0
     #/3.D0*t20-512.D0/3.D0*z*(2*z-3)*t58)*t8+t90+t93+512.D0/3.D0*t17+51
     #2.D0/3.D0*t20-t66
      t115 = t4*t8
      t120 = -1+z
      t121 = t120*t4
      taux1 = 512.D0/3.D0*s1l1*s2l2-t14+(512.D0/3.D0*t17+512.D0/3.D0*t20
     #-512.D0/3.D0*t23)*t8+512.D0/3.D0*s1l2*s2l1+((512.D0/3.D0*t29-512.D
     #0/3.D0*t31)*t34+1024.D0/3.D0*t38+t40+t41)*t44+t105*t43+1024.D0/3.D
     #0*t10*z+1024.D0/3.D0*z*t34+t84+(-1024.D0/3.D0*t58*t8*t10*s1l2+(-51
     #2.D0/3.D0*t15*t115+512.D0/3.D0*t56)*t10+t71-512.D0/3.D0*t121*t55)*
     #s1l1+1024.D0/3.D0*z+1024.D0/3.D0*t11*z+512.D0/3.D0*t120*z*t58+(-51
     #2.D0/3.D0*t38+512.D0/3.D0*t22*t9-512.D0/3.D0*t31)*t10+((-512.D0/3.
     #D0*t18*t115+512.D0/3.D0*t76)*t10+t80-512.D0/3.D0*t121*t75)*s1l2+((
     #512.D0/3.D0*t55*t46+512.D0/3.D0*t56)*s1l1+(512.D0/3.D0*t75*t46+512
     #.D0/3.D0*t76)*s1l2-t14-512.D0/3.D0*t47+512.D0/3.D0*t29-t41)*t34+10
     #24.D0/3.D0*z*t50
      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = t1**2
      t3 = 1/t2
      t4 = s4l2*t3
      t5 = t4*s3l1
      t6 = 512.D0/3.D0*t5
      t7 = s4l1*t3
      t8 = t7*s3l2
      t9 = 512.D0/3.D0*t8
      t10 = z*t3
      t11 = s24f(z,l1,l2,l3,l4)
      t12 = t10*t11
      t14 = 512.D0/3.D0*t10
      t16 = s23f(z,l1,l2,l3,l4)
      t17 = t16**2
      t18 = t17*t16
      t22 = s14f(z,l1,l2,l3,l4)
      t24 = t3*s2l2
      t26 = 512.D0/3.D0*t24*s1l1
      t27 = t3*s2l1
      t29 = 512.D0/3.D0*t27*s1l2
      t33 = t11**2
      t34 = t10*t33
      t35 = 512.D0/3.D0*t34
      t38 = s13f(z,l1,l2,l3,l4)
      t39 = t38**2
      t41 = -1+z
      t42 = t41*z
      t44 = 512.D0/3.D0*t42*t3
      t45 = t4*s2l1
      t46 = t7*s2l2
      t53 = 1/t1
      t54 = z*t53
      t55 = t54*t16
      t59 = t11*t16
      t62 = t54*t11
      t64 = z**2
      t74 = -2+z
      t75 = z*t74
      t80 = t6+t9+(2048.D0/3.D0*t12+t14)*t18+((512.D0/3.D0*t12-512.D0/3.
     #D0*t10)*t22-t26-t29+(512*t12+t14)*t16+t35+1024.D0/3.D0*t12+t14)*t3
     #9-t44+(512.D0/3.D0*t45+512.D0/3.D0*t46+512.D0/3.D0*t5+512.D0/3.D0*
     #t8-512.D0/3.D0*z*(-2-z)*t3)*t11+((-96*t55-96*t54)*t22-96*t54*t59+1
     #92*t62+96*t64*t53)*t38-96*t42*t53+t35+(96*t62-96*t54)*t39+(96*t62-
     #96*t75*t53)*t16
      t88 = (-1024.D0/3.D0+512.D0/3.D0*z)*t3
      t90 = 512.D0/3.D0*t4
      t93 = t41*t3
      t98 = t10*t16
      t101 = t22**2
      t104 = 512.D0/3.D0*t10*t17
      t107 = 512.D0/3.D0*t12
      t108 = 1024.D0/3.D0*t24
      t112 = (-t108-512.D0/3.D0*t3*s3l2)*s2l1
      t115 = 512.D0/3.D0*t3*s3l1*s2l2
      t120 = t74*t3
      t126 = 512.D0/3.D0*t7
      t134 = 1024.D0/3.D0*t10
      t137 = 512*t34
      t145 = 1024.D0/3.D0*t34
      t152 = 512.D0/3.D0*t45
      t153 = 512.D0/3.D0*t46
      t156 = (-512.D0/3.D0*t98-512.D0/3.D0*t10)*t101+(-t26-t29+t104+1024
     #.D0/3.D0*t10*t59+t107+t112-t115+t44)*t22+((-t108-t90)*t16+512.D0/3
     #.D0*t120*s2l2)*s1l1+((-1024.D0/3.D0*t27-t126)*t16+512.D0/3.D0*t120
     #*s2l1)*s1l2+(3584.D0/3.D0*t12+t134)*t17+(t137+5632.D0/3.D0*t12+512
     #.D0/3.D0*z*(4-z)*t3)*t16+t145+(512.D0/3.D0*t45+512.D0/3.D0*t46+512
     #.D0/3.D0*t5+512.D0/3.D0*t8-512.D0/3.D0*z*(-4-z)*t3)*t11+t152+t153+
     #t6+t9-512.D0/3.D0*t75*t3
      t193 = 96*t54*t17
      t221 = ((-512.D0/3.D0*t24-512.D0/3.D0*t4)*t17+(-512.D0/3.D0*t4*t11
     #+t88*s2l2-t90)*t16+512.D0/3.D0*t93*s2l2)*s1l1+t156*t38+(-t104-1024
     #.D0/3.D0*t98-t14)*t101+t153+((-512.D0/3.D0*t27-512.D0/3.D0*t7)*t17
     #+(-512.D0/3.D0*t7*t11+t88*s2l1-t126)*t16+512.D0/3.D0*t93*s2l1)*s1l
     #2+(t145+5120.D0/3.D0*t12+512.D0/3.D0*z*(3-z)*t3)*t17+t152+(t137-51
     #2.D0/3.D0*z*(z-8)*t3*t11+t152+t153+t6+t9-512.D0/3.D0*z*(2*z-3)*t3)
     #*t16+(t193+192*t55+96*t54)*t22+96*t62+((-512.D0/3.D0*t24*t16-512.D
     #0/3.D0*t24)*s1l1+(-512.D0/3.D0*t27*t16-512.D0/3.D0*t27)*s1l2+512.D
     #0/3.D0*t10*t18+(t107+t134)*t17+(t107+t112-t115+512.D0/3.D0*z*(z+1)
     #*t3)*t16+t112-t115+512.D0/3.D0*t64*t3)*t22+t193
      taux2 = t80+t221
      t1 = s2l1*s4l2
      t2 = s2l2*s4l1
      t5 = s14f(z,l1,l2,l3,l4)
      t8 = s24f(z,l1,l2,l3,l4)
      t17 = s13f(z,l1,l2,l3,l4)
      t22 = s23f(z,l1,l2,l3,l4)
      t24 = 10240.D0/3.D0*s2l2
      t32 = 10240.D0/3.D0*s2l1
      t36 = s2l1*s3l2
      t38 = s2l2*s3l1
      t40 = s3l1*s4l2
      t42 = s3l2*s4l1
      t48 = 8192.D0/3.D0*t40
      t49 = 8192.D0/3.D0*t42
      t52 = s3l2*t8
      t62 = s3l1*t8
      t80 = s3vf(z,l1,l2,l3,l4)
      t81 = 1/t80
      t82 = s2l2*t81
      t83 = s4vf(z,l1,l2,l3,l4)
      t84 = 1/t83
      t87 = 2048.D0/3.D0*t82*t84*s1l1
      t88 = s2l1*t81
      t91 = 2048.D0/3.D0*t88*t84*s1l2
      t92 = t81*t84
      t93 = t92*s3l2
      t94 = s4l2*t81
      t95 = t94*t84
      t97 = -4096.D0/3.D0*t93+4096.D0/3.D0*t95
      t98 = t97*s2l1
      t99 = t92*s3l1
      t100 = s4l1*t81
      t101 = t100*t84
      t103 = 4096.D0/3.D0*t99-4096.D0/3.D0*t101
      t104 = t103*s2l2
      t105 = t98+t104
      t107 = 4096.D0/3.D0*t93
      t108 = 2048.D0/3.D0*t95
      t109 = -t107+t108
      t111 = 4096.D0/3.D0*t99
      t112 = 2048.D0/3.D0*t101
      t113 = t111-t112
      t117 = t8**2
      t121 = t82*t84
      t123 = 8192.D0/3.D0*t93
      t126 = 2048.D0/3.D0*t121
      t132 = t88*t84
      t134 = 8192.D0/3.D0*t99
      t137 = 2048.D0/3.D0*t132
      t141 = t94*t84*s2l1
      t144 = t100*t84*s2l2
      t146 = t84*s3l1
      t147 = t94*t146
      t148 = 8192.D0/3.D0*t147
      t149 = t84*s3l2
      t150 = t100*t149
      t151 = 8192.D0/3.D0*t150
      t153 = (-4096.D0/3.D0*t141+4096.D0/3.D0*t144-t148+t151)*t117
      t154 = -t97
      t155 = t154*s2l1
      t156 = -t103
      t157 = t156*s2l2
      t158 = 16384.D0/3.D0*t147
      t159 = 16384.D0/3.D0*t150
      t161 = (t155+t157-t158+t159)*t8
      t163 = -t109*s2l1
      t165 = -t113*s2l2
      t167 = t17**2
      t171 = t5**2
      t174 = 2048*t95
      t177 = 2048*t121
      t178 = 2048*t93
      t179 = 4096.D0/3.D0*t95
      t182 = -2+z
      t183 = t182*t84
      t185 = 2048.D0/3.D0*t183*t82
      t189 = 2048*t101
      t192 = 2048*t132
      t193 = 2048*t99
      t194 = 4096.D0/3.D0*t101
      t198 = 2048.D0/3.D0*t183*t88
      t205 = 8192.D0/3.D0*t95
      t207 = (t178-t205)*s2l1
      t208 = 8192.D0/3.D0*t101
      t210 = (-t193+t208)*s2l2
      t211 = 8192*t147
      t212 = 8192*t150
      t215 = 2*z
      t217 = (1-t215)*t84
      t218 = t81*s3l2
      t222 = (z+2)*t84
      t227 = t81*s3l1
      t245 = (t215-3)*t84
      t248 = 4*z
      t250 = (10-t248)*t84
      t257 = -1+z
      t258 = t257*t84
      t260 = 2048.D0/3.D0*t258*t82
      t262 = (5-t248)*t84
      t264 = 2048.D0/3.D0*t262*t218
      t265 = t258*t94
      t286 = 2048.D0/3.D0*t258*t88
      t288 = 2048.D0/3.D0*t262*t227
      t289 = t258*t100
      t294 = (t107-t174)*s2l1
      t296 = (-t111+t189)*s2l2
      t305 = 20480.D0/3.D0*t147
      t306 = 20480.D0/3.D0*t150
      t325 = 8*z
      t327 = (22-t325)*t84
      t328 = t94*s3l1
      t331 = t100*s3l2
      t336 = t258*t218
      t337 = 8192.D0/3.D0*t336
      t340 = (6-5*z)*t84
      t345 = t258*t227
      t346 = 8192.D0/3.D0*t345
      t352 = (11-t325)*t84
      t354 = 2048.D0/3.D0*t352*t328
      t356 = 2048.D0/3.D0*t352*t331
      s2 = (-t87+t91+t105*t22+t98+t104)*t171+(((t154*t8-t126+t107-t174)*
     #t22+(-t177+t178-t179)*t8+t185+t178-t179)*s1l1+((t156*t8+t137-t111+
     #t189)*t22+(t192-t193+t194)*t8-t198-t193+t194)*s1l2+(t161-2048*t141
     #+2048*t144-t158+t159)*t22+(t207+t210-t211+t212)*t8+(-2048.D0/3.D0*
     #t217*t218-4096.D0/3.D0*t222*t94)*s2l1+(2048.D0/3.D0*t217*t227+4096
     #.D0/3.D0*t222*t100)*s2l2-t158+t159)*t5
      s1 = s2+((t97*t117+(-t177+t123-t174)*t8-t126+t123-t174)*t22+(-4096
     #.D0/3.D0*t121+4096.D0/3.D0*t93-4096.D0/3.D0*t95)*t117+(2048.D0/3.D
     #0*t245*t82+2048.D0/3.D0*t250*t218+4096.D0/3.D0*t183*t94)*t8+t260+t
     #264+4096.D0/3.D0*t265)*s1l1+((t103*t117+(t192-t134+t189)*t8+t137-t
     #134+t189)*t22+(4096.D0/3.D0*t132-4096.D0/3.D0*t99+4096.D0/3.D0*t10
     #1)*t117+(-2048.D0/3.D0*t245*t88-2048.D0/3.D0*t250*t227-4096.D0/3.D
     #0*t183*t100)*t8-t286-t288-4096.D0/3.D0*t289)*s1l2+((t294+t296-t211
     #+t212)*t8+(t123-10240.D0/3.D0*t95)*s2l1+(-t134+10240.D0/3.D0*t101)
     #*s2l2-t305+t306)*t22
      t357 = s1+(-8192.D0/3.D0*t141+8192.D0/3.D0*t144-t158+t159)*t117+((
     #-4096.D0/3.D0*t183*t218-2048.D0/3.D0*t250*t94)*s2l1+(4096.D0/3.D0*
     #t183*t227+2048.D0/3.D0*t250*t100)*s2l2-2048.D0/3.D0*t327*t328+2048
     #.D0/3.D0*t327*t331)*t8+(-t337-2048.D0/3.D0*t340*t94)*s2l1+(t346+20
     #48.D0/3.D0*t340*t100)*s2l2-t354+t356
      s1 = ((8192.D0/3.D0*t1-8192.D0/3.D0*t2)*t5+4096.D0/3.D0*s1l1*s2l2*
     #t8-4096.D0/3.D0*s1l2*s2l1*t8+4096.D0/3.D0*t1-4096.D0/3.D0*t2)*t17+
     #(((-4096.D0/3.D0*s2l2-8192.D0/3.D0*s4l2)*t22-t24-20480.D0/3.D0*s4l
     #2)*s1l1+((4096.D0/3.D0*s2l1+8192.D0/3.D0*s4l1)*t22+t32+20480.D0/3.
     #D0*s4l1)*s1l2+(8192.D0/3.D0*t36-8192.D0/3.D0*t38-16384.D0/3.D0*t40
     #+16384.D0/3.D0*t42)*t22+4096.D0/3.D0*t36-4096.D0/3.D0*t38-t48+t49)
     #*t5+((-8192.D0/3.D0*t52-t24-4096.D0/3.D0*s4l2)*t22-4096.D0/3.D0*t5
     #2-6144*s2l2-10240.D0/3.D0*s4l2)*s1l1+((8192.D0/3.D0*t62+t32+4096.D
     #0/3.D0*s4l1)*t22+4096.D0/3.D0*t62+6144*s2l1+10240.D0/3.D0*s4l1)*s1
     #l2+(20480.D0/3.D0*t36-20480.D0/3.D0*t38-t48+t49)*t22
      t359 = s1+10240.D0/3.D0*t36-10240.D0/3.D0*t38-4096.D0/3.D0*t40+409
     #6.D0/3.D0*t42+((-t87+t91+t105*t8+t109*s2l1+t113*s2l2)*t5+(4096.D0/
     #3.D0*t92*s3l2*t117+(-4096.D0/3.D0*t121+t123)*t8-t126+t107)*s1l1+(-
     #4096.D0/3.D0*t92*s3l1*t117+(4096.D0/3.D0*t132-t134)*t8+t137-t111)*
     #s1l2+t153+t161+t163+t165-t148+t151)*t167+t357*t17
      t360 = t22**2
      t361 = t84*t360
      t364 = 2048.D0/3.D0*t93
      t371 = 2048.D0/3.D0*t99
      t396 = (6-t215)*t84
      t400 = (-4+t215)*t84
      t410 = (-4+3*z)*t84
      t413 = 8192.D0/3.D0*t265
      t432 = 8192.D0/3.D0*t289
      t460 = (-8+t248)*t84
      t470 = (3-t248)*t84
      t472 = t262*t94
      t477 = t262*t100
      t482 = 16384.D0/3.D0*t258*t328
      t484 = 16384.D0/3.D0*t258*t331
      t513 = (1-z-2*t257*t182)*t84
      t516 = t257**2
      t575 = t516*t81
      t588 = z**2
      t591 = (-5-4*t588+t325)*t84
      s3 = ((-4096.D0/3.D0*t94*t361+(t364-t205)*t22+t364-t179)*s1l1+(409
     #6.D0/3.D0*t100*t361+(-t371+t208)*t22-t371+t194)*s1l2+(4096.D0/3.D0
     #*t92*t36-4096.D0/3.D0*t92*t38-t148+t151)*t360+((t123-t179)*s2l1+(-
     #t134+t194)*s2l2-t158+t159)*t22+t155+t157-t148+t151)*t171
      s6 = ((t97*t8+t107-t205)*t360+((-t126+t178)*t8-t126+2048.D0/3.D0*t
     #396*t218+4096.D0/3.D0*t400*t94)*t22+(-t126+10240.D0/3.D0*t93-t205)
     #*t8-2048.D0/3.D0*t410*t218+t413)*s1l1+((t103*t8-t111+t208)*t360+((
     #t137-t193)*t8+t137-2048.D0/3.D0*t396*t227-4096.D0/3.D0*t400*t100)*
     #t22+(t137-10240.D0/3.D0*t99+t208)*t8+2048.D0/3.D0*t410*t227-t432)*
     #s1l2+((t123-t108)*s2l1+(-t134+t112)*s2l2-t158+t159)*t360+(((t178-t
     #179)*s2l1+(-t193+t194)*s2l2-t158+t159)*t8+(-4096.D0/3.D0*t400*t218
     #-2048.D0/3.D0*t396*t94)*s2l1+(4096.D0/3.D0*t400*t227+2048.D0/3.D0*
     #t396*t100)*s2l2+4096.D0/3.D0*t460*t328-4096.D0/3.D0*t460*t331)*t22
     #+(t207+t210-t305+t306)*t8+(2048.D0/3.D0*t470*t218-2048.D0/3.D0*t47
     #2)*s2l1+(-2048.D0/3.D0*t470*t227+2048.D0/3.D0*t477)*s2l2+t482-t484
      s7 = t5
      s5 = s6*s7
      s6 = (((-t126-t107+t179)*t8+t107-t179)*t360+((-t126-t364+t179)*t11
     #7+(t185+4096.D0/3.D0*t222*t218+2048.D0/3.D0*t217*t94)*t8+t264-2048
     #.D0/3.D0*t470*t94)*t22+(-t126+t364-t179)*t117+(t260+2048.D0/3.D0*t
     #340*t218+t413)*t8-2048.D0/3.D0*t513*t218-4096.D0/3.D0*t516*s4l2*t9
     #2)*s1l1
      s4 = s5+s6
      s2 = s3+s4
      s1 = s2+(((t137+t111-t194)*t8-t111+t194)*t360+((t137+t371-t194)*t1
     #17+(-t198-4096.D0/3.D0*t222*t227-2048.D0/3.D0*t217*t100)*t8-t288+2
     #048.D0/3.D0*t470*t100)*t22+(t137-t371+t194)*t117+(-t286-2048.D0/3.
     #D0*t340*t227-t432)*t8+2048.D0/3.D0*t513*t227+4096.D0/3.D0*t516*s4l
     #1*t92)*s1l2+(t163+t165-t148+t151)*t360+((t294+t296-t158+t159)*t8+(
     #-t337+2048.D0/3.D0*t410*t94)*s2l1+(t346-2048.D0/3.D0*t410*t100)*s2
     #l2+t482-t484)*t22
      t596 = s1+t153+((-4096.D0/3.D0*t336-2048.D0/3.D0*t472)*s2l1+(4096.
     #D0/3.D0*t345+2048.D0/3.D0*t477)*s2l2-t354+t356)*t8+(4096.D0/3.D0*t
     #575*t149+2048.D0/3.D0*t513*t94)*s2l1+(-4096.D0/3.D0*t575*t146-2048
     #.D0/3.D0*t513*t100)*s2l2+2048.D0/3.D0*t591*t328-2048.D0/3.D0*t591*
     #t331
      taux3 = t359+t596
      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = t1**2
      t3 = 1/t2
      t4 = t3*s2l2
      t5 = 4096.D0/3.D0*t4
      t6 = s4l2*t3
      t7 = 4096*t6
      t8 = t5+t7
      t9 = s23f(z,l1,l2,l3,l4)
      t10 = t9**2
      t11 = t10*t9
      t13 = 16384.D0/3.D0*t4
      t20 = 14336.D0/3.D0*t6
      t23 = t3*s2l1
      t24 = 4096.D0/3.D0*t23
      t25 = s4l1*t3
      t26 = 4096*t25
      t27 = -t24-t26
      t29 = 16384.D0/3.D0*t23
      t36 = 14336.D0/3.D0*t25
      t39 = t3*s3l2
      t42 = t3*s3l1
      t45 = t6*s3l1
      t46 = 16384.D0/3.D0*t45
      t47 = t25*s3l2
      t48 = 16384.D0/3.D0*t47
      t52 = 4096.D0/3.D0*t6
      t56 = 4096.D0/3.D0*t25
      t63 = 16384.D0/3.D0*t39
      t64 = 2048.D0/3.D0*t6
      t67 = 16384.D0/3.D0*t42
      t68 = 2048.D0/3.D0*t25
      t71 = 32768.D0/3.D0*t45
      t72 = 32768.D0/3.D0*t47
      t75 = 2048.D0/3.D0*t39
      t76 = 2048*t6
      t79 = 2048.D0/3.D0*t42
      t80 = 2048*t25
      t83 = 8192.D0/3.D0*t45
      t84 = 8192.D0/3.D0*t47
      t86 = s14f(z,l1,l2,l3,l4)
      t88 = 4*z
      t89 = -5+t88
      t90 = t89*t3
      t91 = s3l1*s4l2
      t94 = -1+z
      t95 = 1/t1
      t96 = t94*t95
      t97 = s2l2*s3l1
      t100 = t6*s2l1
      t101 = t25*s2l2
      t102 = -t100+t101
      t104 = s24f(z,l1,l2,l3,l4)
      t109 = s13f(z,l1,l2,l3,l4)
      t110 = t109**2
      t113 = 4096.D0/3.D0*t39
      t116 = 4096.D0/3.D0*t42
      t121 = 2*z
      t123 = (-5+t121)*t3
      t127 = (6-t88)*t3
      t138 = 8*z
      t140 = (-19+t138)*t3
      t143 = s3l2*s4l1
      t148 = t95*s3l2
      t149 = t148*s2l1
      t151 = t95*s3l1
      t152 = t151*s2l2
      t154 = s4l2*t95
      t155 = t154*s3l1
      t156 = 1536*t155
      t157 = s4l1*t95
      t158 = t157*s3l2
      t159 = 1536*t158
      t160 = 768*t149-768*t152-t156+t159
      t162 = -2+z
      t163 = t162*t95
      t164 = s2l1*s3l2
      t170 = -t89*t95
      t172 = 384*t170*t91
      t174 = 384*t170*t143
      t177 = t94*t3
      t181 = (t121-1)*t3
      t191 = t95*s2l2
      t195 = 384*t191
      t196 = 768*t154
      t199 = t95*s2l1
      t203 = 384*t199
      t204 = 768*t157
      t207 = 768*t148
      t208 = 2304*t154
      t211 = 768*t151
      t212 = 2304*t157
      t225 = 768*t191
      t226 = 1536*t154
      t229 = 1920*t154
      t234 = z*t95
      t241 = 768*t199
      t242 = 1536*t157
      t245 = 1920*t157
      t259 = t154*s2l1
      t261 = t157*s2l2
      t273 = -t94
      t275 = 4*t273*t95
      t298 = -t162*t95
      t301 = 6*z
      t303 = (-7+t301)*t95
      t310 = t273*t95
      s2 = ((t8*t11+(t13+38912.D0/3.D0*t6)*t10+(t13+40960.D0/3.D0*t6)*t9
     #+t5+t20)*s1l1+(t27*t11+(-t29-38912.D0/3.D0*t25)*t10+(-t29-40960.D0
     #/3.D0*t25)*t9-t24-t36)*s1l2+(-8192.D0/3.D0*t39*s2l1+8192.D0/3.D0*t
     #42*s2l2+t46-t48)*t11+((-22528.D0/3.D0*t39+t52)*s2l1+(22528.D0/3.D0
     #*t42-t56)*s2l2+40960.D0/3.D0*t45-40960.D0/3.D0*t47)*t10+((-t63-t64
     #)*s2l1+(t67+t68)*s2l2+t71-t72)*t9+(-t75-t76)*s2l1+(t79+t80)*s2l2+t
     #83-t84)*t86-2048.D0/3.D0*t90*t91+768*t96*t97
      s1 = s2+(4096.D0/3.D0*t102*t104-4096.D0/3.D0*t100+4096.D0/3.D0*t10
     #1)*t110*t109+(((-t113-t7)*s2l1+(t116+t26)*s2l2+t83-t84)*t104+(4096
     #.D0/3.D0*t123*s3l2+2048.D0/3.D0*t127*s4l2)*s2l1+(-4096.D0/3.D0*t12
     #3*s3l1-2048.D0/3.D0*t127*s4l1)*s2l2-2048.D0/3.D0*t140*t91+2048.D0/
     #3.D0*t140*t143)*t10+(t160*t104-768*t163*t164+768*t163*t97-t172+t17
     #4)*t9
      s2 = s1+(4096.D0/3.D0*t177*s3l2-2048.D0/3.D0*t181*s4l2)*s2l1+2048.
     #D0/3.D0*t90*t143+(768*t149-768*t152)*t104
      s3 = s2+((((768*t191+768*t154)*t9+t195+t196)*s1l1+((-768*t199-768*
     #t157)*t9-t203-t204)*s1l2+((-t207+t208)*s2l1+(t211-t212)*s2l2+t156-
     #t159)*t9+(-384*t148+t196)*s2l1+(384*t151-t204)*s2l2+t156-t159)*t86
     #+(((t225+t207-t226)*t104-t229)*t9+(t195+t207-t196)*t104-384*t234*s
     #2l2-768*t234*s4l2)*s1l1+(((-t241-t211+t242)*t104+t245)*t9+(-t203-t
     #211+t204)*t104+384*t234*s2l1+768*t234*s4l1)*s1l2+((-1536*t155+1536
     #*t158)*t104+768*t259-768*t261)*t9+((t207+t226)*s2l1+(-t211-t242)*s
     #2l2+t156-t159)*t104+(768*t234*s3l2+384*t275*s4l2)*s2l1+(-768*t234*
     #s3l1-384*t275*s4l1)*s2l2+t172-t174)*t109
      t317 = s3-384*t155+384*t158+((-768*t148*t104-t195-t229)*t10+((-t19
     #5-1536*t148-t208)*t104-384*t298*s2l2+384*t303*s4l2)*t9+(-t195-t207
     #-t196)*t104-384*t310*s2l2+768*t96*s4l2)*s1l1
      t324 = 8192.D0/3.D0*t39
      t327 = 8192.D0/3.D0*t42
      t354 = 4096*t4
      t355 = 26624.D0/3.D0*t6
      t361 = 4096*t23
      t362 = 26624.D0/3.D0*t25
      t373 = 14336.D0/3.D0*t39
      t377 = 14336.D0/3.D0*t42
      t381 = 8192*t45
      t382 = 8192*t47
      t385 = 20480.D0/3.D0*t6
      t388 = 20480.D0/3.D0*t25
      t399 = 3*z
      t401 = (-t399+10)*t3
      t405 = (25-t301)*t3
      t410 = 2048.D0/3.D0*t4
      t411 = 2048*t39
      t412 = 8192.D0/3.D0*t6
      t416 = (-4+t121)*t3
      t421 = (14-7*z)*t3
      t438 = 2048.D0/3.D0*t23
      t439 = 2048*t42
      t440 = 8192.D0/3.D0*t25
      t455 = 10240.D0/3.D0*t6
      t458 = 10240.D0/3.D0*t25
      t464 = (z-3)*t3
      t468 = (3-t121)*t3
      t480 = (-23+t138)*t3
      t491 = 4096.D0/3.D0*t45
      t492 = 4096.D0/3.D0*t47
      t495 = t162*t3
      t505 = (-9+t88)*t3
      t520 = (-4096.D0/3.D0*t4+4096.D0/3.D0*t6)*t104
      t521 = 2048*t4
      t528 = (4096.D0/3.D0*t23-4096.D0/3.D0*t25)*t104
      t529 = 2048*t23
      t595 = (8-t399)*t3
      t599 = (19-t301)*t3
      t608 = (-7+5*z)*t3
      t613 = (19-13*z)*t3
      t621 = 2*t94*t3
      t625 = 7*t273*t3
      t630 = t160*t10
      t666 = (-4+t399)*t3
      t670 = (-5+t301)*t3
      t683 = (-16+12*z)*t3
      s2 = (-4096.D0/3.D0*t177*s3l1+2048.D0/3.D0*t181*s4l1)*s2l2+((-t324
     #+t52)*s2l1+(t327-t56)*s2l2+t46-t48)*t11+((768*t151*t104+t203+t245)
     #*t10+((t203+1536*t151+t212)*t104+384*t298*s2l1-384*t303*s4l1)*t9+(
     #t203+t211+t204)*t104+384*t310*s2l1-768*t96*s4l1)*s1l2
      s4 = s2
      s8 = ((t8*t10+(t354+t355)*t9+t5+t20)*s1l1+(t27*t10+(-t361-t362)*t9
     #-t24-t36)*s1l2+((-t324-t7)*s2l1+(t327+t26)*s2l2+t46-t48)*t10+((-t3
     #73-22528.D0/3.D0*t6)*s2l1+(t377+22528.D0/3.D0*t25)*s2l2+t381-t382)
     #*t9+(-t75-t385)*s2l1+(t79+t388)*s2l2+t83-t84)*t86+(((-t5+t324-t7)*
     #t104+t354+t355)*t10+((-t5+t324-t64)*t104+2048.D0/3.D0*t401*s2l2+20
     #48.D0/3.D0*t405*s4l2)*t9+(-t410+t411+t412)*t104-2048.D0/3.D0*t416*
     #s2l2+2048.D0/3.D0*t421*s4l2)*s1l1
      s7 = s8+(((t24-t327+t26)*t104-t361-t362)*t10+((t24-t327+t68)*t104-
     #2048.D0/3.D0*t401*s2l1-2048.D0/3.D0*t405*s4l1)*t9+(t438-t439-t440)
     #*t104+2048.D0/3.D0*t416*s2l1-2048.D0/3.D0*t421*s4l1)*s1l2+((-t63+t
     #76)*s2l1+(t67-t80)*s2l2+t71-t72)*t10+(((-t411-t455)*s2l1+(t439+t45
     #8)*s2l2+t381-t382)*t104+(8192.D0/3.D0*t464*s3l2+2048.D0/3.D0*t468*
     #s4l2)*s2l1+(-8192.D0/3.D0*t464*s3l1-2048.D0/3.D0*t468*s4l1)*s2l2-2
     #048.D0/3.D0*t480*t91+2048.D0/3.D0*t480*t143)*t9
      s6 = s7+((-t113-t385)*s2l1+(t116+t388)*s2l2+t491-t492)*t104+(4096.
     #D0/3.D0*t495*s3l2-t64)*s2l1+(-4096.D0/3.D0*t495*s3l1+t68)*s2l2-204
     #8.D0/3.D0*t505*t91+2048.D0/3.D0*t505*t143
      s7 = t109
      s5 = s6*s7
      s3 = s4+s5
      s1 = s3+((4096*t102*t9-14336.D0/3.D0*t100+14336.D0/3.D0*t101)*t86+
     #((t520+t521+t7)*t9+t520+t5+t20)*s1l1+((t528-t529-t26)*t9+t528-t24-
     #t36)*s1l2+((4096*t100-4096*t101+t46-t48)*t104+(-t324-t64)*s2l1+(t3
     #27+t68)*s2l2+t46-t48)*t9+((-t75-t455)*s2l1+(t79+t458)*s2l2+t83-t84
     #)*t104+(-t113+2048.D0/3.D0*t416*s4l2)*s2l1+(t116-2048.D0/3.D0*t416
     #*s4l1)*s2l2+t83-t84)*t110+((-768*t259+768*t261)*t86+(-768*t191*t10
     #4+t195+t196)*s1l1+(768*t199*t104-t203-t204)*s1l2+(1536*t259-1536*t
     #261+1536*t155-1536*t158)*t104+(-768*t148+768*t154)*s2l1+(768*t151-
     #768*t157)*s2l2+t156-t159)*t110
      s2 = s1+((-t75-t20)*s2l1+(t79+t36)*s2l2-t491+t492)*t104+((-8192.D0
     #/3.D0*t42*t104-t529-t36)*t11+((-t24-t67+t68)*t104-2048.D0/3.D0*t59
     #5*s2l1-2048.D0/3.D0*t599*s4l1)*t10+((-t529-t377-t388)*t104+2048.D0
     #/3.D0*t608*s2l1-2048.D0/3.D0*t613*s4l1)*t9+(-t438-t439-t56)*t104+2
     #048.D0/3.D0*t621*s2l1-2048.D0/3.D0*t625*s4l1)*s1l2+t630
      t718 = s2+(((-t225-t208)*t10+(-1152*t191-3072*t154)*t9-t195-t196)*
     #s1l1+((t241+t212)*t10+(1152*t199+3072*t157)*t9+t203+t204)*s1l2+t63
     #0+(1152*t149-1152*t152-t156+t159)*t9+384*t149-384*t152)*t86-768*t9
     #6*t164+(((-t411-t412)*s2l1+(t439+t440)*s2l2+22528.D0/3.D0*t45-2252
     #8.D0/3.D0*t47)*t104+(4096.D0/3.D0*t666*s3l2-2048.D0/3.D0*t670*s4l2
     #)*s2l1+(-4096.D0/3.D0*t666*s3l1+2048.D0/3.D0*t670*s4l1)*s2l2-2048.
     #D0/3.D0*t683*t91+2048.D0/3.D0*t683*t143)*t9+((8192.D0/3.D0*t39*t10
     #4+t521+t20)*t11+((t5+t63-t64)*t104+2048.D0/3.D0*t595*s2l2+2048.D0/
     #3.D0*t599*s4l2)*t10+((t521+t373+t385)*t104-2048.D0/3.D0*t608*s2l2+
     #2048.D0/3.D0*t613*s4l2)*t9+(t410+t411+t52)*t104-2048.D0/3.D0*t621*
     #s2l2+2048.D0/3.D0*t625*s4l2)*s1l1
      taux4 = t317+t718

CCC Coefficients

      tcoff1 = taux1+taux2
      tcoff2 = taux1+taux2
      tcoff3 = taux2
      tcoff4 = taux2
      tcoff5 = taux3+taux4
      tcoff6 = -taux3-taux4
      tcoff7 = taux4
      tcoff8 = -taux4

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet1 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet2 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = s23f(z,l1,l2,l3,l4)
      t2 = s13f(z,l1,l2,l3,l4)
      t3 = s24f(z,l1,l2,l3,l4)
      t4 = s14f(z,l1,l2,l3,l4)
      tFjet3 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = s24f(z,l1,l2,l3,l4)
      t2 = s14f(z,l1,l2,l3,l4)
      t3 = s23f(z,l1,l2,l3,l4)
      t4 = s13f(z,l1,l2,l3,l4)
      tFjet4 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff4)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet5 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,8.D0,1.D0,1.D0,Tcoeff*tcoff5)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet6 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,8.D0,1.D0,1.D0,Tcoeff*tcoff6)
      t1 = s23f(z,l1,l2,l3,l4)
      t2 = s13f(z,l1,l2,l3,l4)
      t3 = s24f(z,l1,l2,l3,l4)
      t4 = s14f(z,l1,l2,l3,l4)
      tFjet7 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t2-t4-t1-t3,-1+z-t1-t
     #3,-1+z-t2-t4,1+t4+t3,1+t2+t1,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,8.D0,1.D0,1.D0,Tcoeff*tcoff7)
      t1 = s24f(z,l1,l2,l3,l4)
      t2 = s14f(z,l1,l2,l3,l4)
      t3 = s23f(z,l1,l2,l3,l4)
      t4 = s13f(z,l1,l2,l3,l4)
      tFjet8 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t2-t4-t1-t3,-1+z-t1-t
     #3,-1+z-t2-t4,1+t4+t3,1+t2+t1,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,8.D0,1.D0,1.D0,Tcoeff*tcoff8)

CCC Sum

      ggrmnum1e2 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcof
     #f4+tFjet5*tcoff5+tFjet6*tcoff6+tFjet7*tcoff7+tFjet8*tcoff8
      RETURN
      END

      double precision function ggrmnum1e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = z*t1
      t3 = s4vf(z,l1,l2,l3,l4)
      t4 = 1/t3
      t5 = s3vf(z,l1,l2,l3,l4)
      t6 = 1/t5
      t7 = t4*t6
      t8 = s24f(z,l1,l2,l3,l4)
      t9 = t7*t8
      t12 = z*t4
      t13 = s23f(z,l1,l2,l3,l4)
      t17 = t6*t8
      t18 = t12*t17
      t19 = 1024.D0/3.D0*t18
      t20 = t12*t6
      t21 = 512.D0/3.D0*t20
      t23 = s14f(z,l1,l2,l3,l4)
      t27 = t8**2
      t30 = 512.D0/3.D0*t12*t6*t27
      t38 = s13f(z,l1,l2,l3,l4)
      t42 = t38**2
      t45 = t12*t17*t13
      taux1 = -512.D0/3.D0*t2*t9+((512.D0/3.D0*t12*t6*t13+t19+t21)*t23+(
     #t19+t21)*t13+t30-1024.D0/3.D0*z*t1*t9-512.D0/3.D0*t2*t7)*t38+(512.
     #D0/3.D0*t18+512.D0/3.D0*t20)*t42+(512.D0/3.D0*t45+512.D0/3.D0*t18)
     #*t23+512.D0/3.D0*t45+t30-512.D0/3.D0*z
      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = t1**2
      t3 = 1/t2
      t4 = z*t3
      t5 = s23f(z,l1,l2,l3,l4)
      t6 = t4*t5
      t7 = s24f(z,l1,l2,l3,l4)
      t8 = t4*t7
      t11 = s14f(z,l1,l2,l3,l4)
      t14 = z**2
      t17 = 512.D0/3.D0*t14*t3*t7
      t19 = z*(-2+z)
      t23 = s13f(z,l1,l2,l3,l4)
      t25 = t5**2
      t27 = 512.D0/3.D0*t4*t25
      t31 = 512.D0/3.D0*t8
      t38 = t23**2
      taux2 = ((512.D0/3.D0*t6+512.D0/3.D0*t8+512.D0/3.D0*t4)*t11+1024.D
     #0/3.D0*t6-t17-512.D0/3.D0*t19*t3)*t23+t27-512.D0/3.D0*t19*t3*t5+(t
     #27+(t31+1024.D0/3.D0*t4)*t5+t31+512.D0/3.D0*t4)*t11+512.D0/3.D0*t4
     #*t38-t17-512.D0/3.D0*(-1+z)*z*t3
      t10 = s14f(z,l1,l2,l3,l4)
      t12 = s23f(z,l1,l2,l3,l4)
      t25 = s2l1*s3l2
      t26 = s2l2*s3l1
      t32 = s3vf(z,l1,l2,l3,l4)
      t33 = 1/t32
      t34 = s2l2*t33
      t35 = s4vf(z,l1,l2,l3,l4)
      t36 = 1/t35
      t38 = t34*t36*s1l1
      t39 = s2l1*t33
      t41 = t39*t36*s1l2
      t42 = s4l2*t33
      t44 = t42*t36*s2l1
      t45 = s4l1*t33
      t47 = t45*t36*s2l2
      t51 = s24f(z,l1,l2,l3,l4)
      t52 = t36*t51
      t55 = t34*t36
      t56 = 4096.D0/3.D0*t55
      t61 = t39*t36
      t62 = 4096.D0/3.D0*t61
      t65 = t44-t47
      t68 = 4096.D0/3.D0*t44
      t69 = 4096.D0/3.D0*t47
      t71 = s13f(z,l1,l2,l3,l4)
      t72 = t71**2
      t76 = t10**2
      t78 = t42*t36
      t82 = 4096*t55
      t83 = t33*t36
      t84 = t83*s3l2
      t85 = 4096.D0/3.D0*t84
      t89 = (-2+z)*t36
      t91 = 4096.D0/3.D0*t89*t34
      t94 = t45*t36
      t98 = 4096*t61
      t99 = t83*s3l1
      t100 = 4096.D0/3.D0*t99
      t104 = 4096.D0/3.D0*t89*t39
      t108 = -4096.D0/3.D0*t65
      t110 = t83*t25
      t111 = t83*t26
      t114 = (4096.D0/3.D0*t110-4096.D0/3.D0*t111)*t51
      t119 = 4096.D0/3.D0*t78
      t124 = -t55-t84
      t126 = t51**2
      t128 = 2*z
      t130 = (-5+t128)*t36
      t137 = (-1+z)*t36
      t139 = 4096.D0/3.D0*t137*t34
      t142 = 4096.D0/3.D0*t94
      t147 = t61+t99
      t156 = 4096.D0/3.D0*t137*t39
      t166 = t42*t36*s3l1
      t167 = 4096.D0/3.D0*t166
      t169 = t45*t36*s3l2
      t170 = 4096.D0/3.D0*t169
      t174 = (3-t128)*t36
      t175 = t42*s2l1
      t178 = t45*s2l2
      t181 = 2048.D0/3.D0*t166
      t182 = 2048.D0/3.D0*t169
      t199 = (-4096.D0/3.D0*t55+4096.D0/3.D0*t84)*t51
      t203 = t33*s3l2
      t210 = (4096.D0/3.D0*t61-4096.D0/3.D0*t99)*t51
      t214 = t33*s3l1
      t219 = t12**2
      t220 = t108*t219
      t233 = t52*t219
      t237 = 4096.D0/3.D0*t124*t126
      t254 = 4096.D0/3.D0*t147*t126
      s2 = ((4096.D0/3.D0*s2l2+8192.D0/3.D0*s4l2)*s1l1+(-4096.D0/3.D0*s2
     #l1-8192.D0/3.D0*s4l1)*s1l2)*t10+(4096.D0/3.D0*s2l2*t12+14336.D0/3.
     #D0*s2l2+4096.D0/3.D0*s4l2)*s1l1+(-4096.D0/3.D0*s2l1*t12-14336.D0/3
     #.D0*s2l1-4096.D0/3.D0*s4l1)*s1l2+(-8192.D0/3.D0*t25+8192.D0/3.D0*t
     #26)*t12
      s3 = s2-4096.D0/3.D0*t25+4096.D0/3.D0*t26
      s4 = s3+((-4096.D0/3.D0*t38+4096.D0/3.D0*t41+4096.D0/3.D0*t44-4096
     #.D0/3.D0*t47)*t10+(-8192.D0/3.D0*t34*t52-t56)*s1l1+(8192.D0/3.D0*t
     #39*t52+t62)*s1l2+8192.D0/3.D0*t65*t51+t68-t69)*t72
      s1 = s4+((-4096.D0/3.D0*t38+4096.D0/3.D0*t41)*t76+(((-4096.D0/3.D0
     #*t55-4096.D0/3.D0*t78)*t12+(-t82-t85)*t51+t91+t85)*s1l1+((4096.D0/
     #3.D0*t61+4096.D0/3.D0*t94)*t12+(t98+t100)*t51-t104-t100)*s1l2+t108
     #*t12+t114-2048.D0/3.D0*t110+2048.D0/3.D0*t111)*t10+(((-t82-t119)*t
     #51-t56-t119)*t12+8192.D0/3.D0*t124*t126+(4096.D0/3.D0*t130*t34-204
     #8.D0/3.D0*t84)*t51+t139+t85)*s1l1+(((t98+t142)*t51+t62+t142)*t12+8
     #192.D0/3.D0*t147*t126+(-4096.D0/3.D0*t130*t39+2048.D0/3.D0*t99)*t5
     #1-t156-t100)*s1l2+(-t108*t51-t68+t69)*t12+(2048.D0/3.D0*t44-2048.D
     #0/3.D0*t47-t167+t170)*t51-2048.D0/3.D0*t174*t175+2048.D0/3.D0*t174
     #*t178-t181+t182)*t71+((4096.D0/3.D0*t83*s3l2*t12+4096.D0/3.D0*t84)
     #*s1l1+(-4096.D0/3.D0*t83*s3l1*t12-4096.D0/3.D0*t99)*s1l2)*t76
      taux3 = s1+(((t199+t56+8192.D0/3.D0*t84)*t12+t199-4096.D0/3.D0*t89
     #*t203)*s1l1+((t210-t62-8192.D0/3.D0*t99)*t12+t210+4096.D0/3.D0*t89
     #*t214)*s1l2+t220+(t114-8192.D0/3.D0*t44+8192.D0/3.D0*t47)*t12+t114
     #+(4096.D0/3.D0*t84-4096.D0/3.D0*t78)*s2l1+(-4096.D0/3.D0*t99+4096.
     #D0/3.D0*t94)*s2l2)*t10+(-4096.D0/3.D0*t34*t233+(t237+(t91+2048.D0/
     #3.D0*t78)*t51+t85-t119)*t12+t237+(t139+2048.D0/3.D0*t174*t203)*t51
     #-4096.D0/3.D0*t137*t203)*s1l1+(4096.D0/3.D0*t39*t233+(t254+(-t104-
     #2048.D0/3.D0*t94)*t51-t100+t142)*t12+t254+(-t156-2048.D0/3.D0*t174
     #*t214)*t51+4096.D0/3.D0*t137*t214)*s1l2+t220+(t108*t51+4096.D0/3.D
     #0*t89*t175-4096.D0/3.D0*t89*t178)*t12+(-t68+t69-t181+t182)*t51+409
     #6.D0/3.D0*t137*t175-4096.D0/3.D0*t137*t178+t167-t170
      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = t1**2
      t3 = 1/t2
      t4 = s4l2*t3
      t5 = s23f(z,l1,l2,l3,l4)
      t6 = t5**2
      t9 = t3*s2l2
      t10 = 2048.D0/3.D0*t9
      t11 = 8192.D0/3.D0*t4
      t14 = 4096.D0/3.D0*t4
      t17 = s4l1*t3
      t20 = t3*s2l1
      t21 = 2048.D0/3.D0*t20
      t22 = 8192.D0/3.D0*t17
      t25 = 4096.D0/3.D0*t17
      t28 = t3*s3l2
      t30 = t3*s3l1
      t43 = 2048.D0/3.D0*t28
      t46 = 2048.D0/3.D0*t30
      t50 = s14f(z,l1,l2,l3,l4)
      t52 = t4*s2l1
      t53 = t17*s2l2
      t54 = t52-t53
      t55 = 4096.D0/3.D0*t54
      t59 = s24f(z,l1,l2,l3,l4)
      t71 = -t28+t4
      t74 = t30-t17
      t77 = 4096.D0/3.D0*t71*s2l1+4096.D0/3.D0*t74*s2l2
      t82 = s13f(z,l1,l2,l3,l4)
      t83 = t82**2
      t85 = 1/t1
      t86 = t85*s2l2
      t87 = t86*s1l1
      t88 = t85*s2l1
      t89 = t88*s1l2
      t94 = t85*s3l2*s2l1
      t96 = t85*s3l1*s2l2
      t100 = s4l2*t85
      t102 = t86*t59
      t103 = z*t85
      t108 = s4l1*t85
      t110 = t88*t59
      t119 = t100*s3l1
      t120 = 768*t119
      t121 = t108*s3l2
      t122 = 768*t121
      t125 = 4096.D0/3.D0*t28
      t129 = 4096.D0/3.D0*t30
      t133 = t4*s3l1
      t134 = 10240.D0/3.D0*t133
      t135 = t17*s3l2
      t136 = 10240.D0/3.D0*t135
      t145 = 4096.D0/3.D0*t133
      t146 = 4096.D0/3.D0*t135
      t149 = 14336.D0/3.D0*t52
      t150 = 14336.D0/3.D0*t53
      t155 = 2048.D0/3.D0*t133
      t159 = -2+z
      t160 = t159*t85
      t166 = -1+z
      t167 = t166*t85
      t172 = 2048.D0/3.D0*t135
      t194 = t6*t5
      t197 = 8192.D0/3.D0*t9+t14
      t200 = 3-2*z
      t201 = t200*t3
      t207 = 4096*t9
      t211 = z*t3
      t215 = -t200*t3
      t223 = -t166
      t224 = t223*t3
      t227 = t166*t3
      t250 = -8192.D0/3.D0*t20-t25
      t257 = 4096*t20
      t296 = 2*t223*t3
      t305 = -t159*t3
      t308 = t159*t3
      s1 = ((768*t86*t5+768*t86)*s1l1+(-768*t88*t5-768*t88)*s1l2+(-768*t
     #94+768*t96)*t5-768*t94+768*t96)*t50+(-768*t119+768*t121)*t5+t122+(
     #(4096.D0/3.D0*t9+4096.D0/3.D0*t4)*t194+(t197*t59+2048.D0/3.D0*t201
     #*s2l2+2048.D0/3.D0*t4)*t6+((t207-t125-10240.D0/3.D0*t4)*t59-2048.D
     #0/3.D0*t211*s2l2+2048.D0/3.D0*t215*s4l2)*t5+(4096.D0/3.D0*t9-4096.
     #D0/3.D0*t28)*t59-2048.D0/3.D0*t224*s2l2+4096.D0/3.D0*t227*s4l2)*s1
     #l1-2048*t53
      s2 = s1+8192.D0/3.D0*t54*t194+((8192.D0/3.D0*t71*s2l1+8192.D0/3.D0
     #*t74*s2l2)*t59+16384.D0/3.D0*t52-16384.D0/3.D0*t53-t145+t146)*t6
      s3 = s2+2048*t52
      s4 = s3+((-4096.D0/3.D0*t20-4096.D0/3.D0*t17)*t194+(t250*t59-2048.
     #D0/3.D0*t201*s2l1-2048.D0/3.D0*t17)*t6+((-t257+t129+10240.D0/3.D0*
     #t17)*t59+2048.D0/3.D0*t211*s2l1-2048.D0/3.D0*t215*s4l1)*t5+(-4096.
     #D0/3.D0*t20+4096.D0/3.D0*t30)*t59+2048.D0/3.D0*t224*s2l1-4096.D0/3
     #.D0*t227*s4l1)*s1l2
      t366 = s4+(((-4096.D0/3.D0*t4*t5-t10-t14)*s1l1+(4096.D0/3.D0*t17*t
     #5+t21+t25)*s1l2+t77*t5+(-t43+t11)*s2l1+(t46-t22)*s2l2)*t50+(t197*t
     #6+((16384.D0/3.D0*t9+t14)*t59+2048.D0/3.D0*t296*s2l2-2048*t4)*t5+(
     #t207-t125)*t59-2048.D0/3.D0*t305*s2l2+4096.D0/3.D0*t308*s4l2)*s1l1
     #+(t250*t6+((-16384.D0/3.D0*t20-t25)*t59-2048.D0/3.D0*t296*s2l1+204
     #8*t17)*t5+(-t257+t129)*t59+2048.D0/3.D0*t305*s2l1-4096.D0/3.D0*t30
     #8*s4l1)*s1l2+4096*t54*t6+((4096*t71*s2l1+4096*t74*s2l2)*t59+20480.
     #D0/3.D0*t52-20480.D0/3.D0*t53-t145+t146)*t5+((-8192.D0/3.D0*t28+61
     #44*t4)*s2l1+(8192.D0/3.D0*t30-6144*t17)*s2l2+t134-t136)*t59+t149-t
     #150-t155+t172)*t82+((768*t86+768*t100)*t6+(768*t102-768*t160*s2l2+
     #768*t100)*t5+768*t102-768*t167*s2l2)*s1l1
      s1 = ((-4096.D0/3.D0*t4*t6+(-t10-t11)*t5-t10-t14)*s1l1+(4096.D0/3.
     #D0*t17*t6+(t21+t22)*t5+t21+t25)*s1l2+(-4096.D0/3.D0*t28*s2l1+4096.
     #D0/3.D0*t30*s2l2)*t6+((-2048*t28+t14)*s2l1+(2048*t30-t25)*s2l2)*t5
     #+(-t43+t14)*s2l1+(t46-t25)*s2l2)*t50+(t55*t50+(4096.D0/3.D0*t9*t5+
     #8192.D0/3.D0*t9*t59-t10-t14)*s1l1+(-4096.D0/3.D0*t20*t5-8192.D0/3.
     #D0*t20*t59+t21+t25)*s1l2+t55*t5+t77*t59+8192.D0/3.D0*t52-8192.D0/3
     #.D0*t53)*t83+(-768*t87+768*t89)*t83+((-768*t87+768*t89+768*t94-768
     #*t96)*t50+(-768*t100*t5+768*t102+768*t103*s2l2)*s1l1+(768*t108*t5-
     #768*t110-768*t103*s2l1)*s1l2+1536*t100*s2l1-1536*t108*s2l2+t120-t1
     #22)*t82+((-t125+14336.D0/3.D0*t4)*s2l1+(t129-14336.D0/3.D0*t17)*s2
     #l2+t134-t136)*t59
      taux4 = s1+(((-4096*t28+t11)*s2l1+(4096*t30-t22)*s2l2-t145+t146)*t
     #59+t149-t150-2048*t133+2048*t135)*t5-t155+((-768*t88-768*t108)*t6+
     #(-768*t110+768*t160*s2l1-768*t108)*t5-768*t110+768*t167*s2l1)*s1l2
     #+t172-t120+t366

CCC Coefficients

      tcoff1 = taux1+taux2
      tcoff2 = taux1+taux2
      tcoff3 = taux2
      tcoff4 = taux2
      tcoff5 = taux3+taux4
      tcoff6 = -taux3-taux4
      tcoff7 = taux4
      tcoff8 = -taux4

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet1 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet2 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = s23f(z,l1,l2,l3,l4)
      t2 = s13f(z,l1,l2,l3,l4)
      t3 = s24f(z,l1,l2,l3,l4)
      t4 = s14f(z,l1,l2,l3,l4)
      tFjet3 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = s24f(z,l1,l2,l3,l4)
      t2 = s14f(z,l1,l2,l3,l4)
      t3 = s23f(z,l1,l2,l3,l4)
      t4 = s13f(z,l1,l2,l3,l4)
      tFjet4 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff4)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet5 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,8.D0,1.D0,1.D0,Tcoeff*tcoff5)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet6 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,8.D0,1.D0,1.D0,Tcoeff*tcoff6)
      t1 = s23f(z,l1,l2,l3,l4)
      t2 = s13f(z,l1,l2,l3,l4)
      t3 = s24f(z,l1,l2,l3,l4)
      t4 = s14f(z,l1,l2,l3,l4)
      tFjet7 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,8.D0,1.D0,1.D0,Tcoeff*tcoff7)
      t1 = s24f(z,l1,l2,l3,l4)
      t2 = s14f(z,l1,l2,l3,l4)
      t3 = s23f(z,l1,l2,l3,l4)
      t4 = s13f(z,l1,l2,l3,l4)
      tFjet8 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,8.D0,1.D0,1.D0,Tcoeff*tcoff8)

CCC Sum

      ggrmnum1e3 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcof
     #f4+tFjet5*tcoff5+tFjet6*tcoff6+tFjet7*tcoff7+tFjet8*tcoff8
      RETURN
      END

      double precision function ggrmnum1e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux1 = 0
      taux2 = 0
      t5 = s3vf(z,l1,l2,l3,l4)
      t6 = 1/t5
      t7 = s4vf(z,l1,l2,l3,l4)
      t8 = 1/t7
      t9 = t6*t8
      t16 = s14f(z,l1,l2,l3,l4)
      t18 = s24f(z,l1,l2,l3,l4)
      t19 = s3l2*t18
      t23 = s3l1*t18
      t27 = s4l2*t6
      t30 = 4096.D0/3.D0*t27*t8*s2l1
      t31 = s4l1*t6
      t34 = 4096.D0/3.D0*t31*t8*s2l2
      t36 = t27*t8*s3l1
      t39 = t31*t8*s3l2
      t46 = s13f(z,l1,l2,l3,l4)
      t49 = s23f(z,l1,l2,l3,l4)
      t50 = t8*t18*t49
      taux3 = -4096.D0/3.D0*s1l1*s2l2+4096.D0/3.D0*s1l2*s2l1+((-4096.D0/
     #3.D0*t9*s3l2*s2l1+4096.D0/3.D0*t9*s3l1*s2l2)*t16+4096.D0/3.D0*t9*t
     #19*s1l1-4096.D0/3.D0*t9*t23*s1l2+(-t30+t34-8192.D0/3.D0*t36+8192.D
     #0/3.D0*t39)*t18-t30+t34-4096.D0/3.D0*t36+4096.D0/3.D0*t39)*t46+(40
     #96.D0/3.D0*t27*t50+4096.D0/3.D0*t9*t19)*s1l1+(-4096.D0/3.D0*t31*t5
     #0-4096.D0/3.D0*t9*t23)*s1l2+(-4096.D0/3.D0*t36+4096.D0/3.D0*t39)*t
     #18
      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = t1**2
      t3 = 1/t2
      t4 = s4l2*t3
      t5 = t4*s3l1
      t6 = 4096.D0/3.D0*t5
      t7 = t3*s2l2
      t10 = s23f(z,l1,l2,l3,l4)
      t11 = t10**2
      t13 = s24f(z,l1,l2,l3,l4)
      t16 = (-2+z)*t3
      t17 = t16*s2l2
      t22 = (-1+z)*t3
      t27 = t7*s1l1
      t28 = t3*s2l1
      t29 = t28*s1l2
      t32 = s13f(z,l1,l2,l3,l4)
      t33 = t32**2
      t35 = s4l1*t3
      t36 = t35*s3l2
      t37 = 4096.D0/3.D0*t36
      t42 = t16*s2l1
      t51 = t3*s3l2*s2l1
      t53 = t3*s3l1*s2l2
      t56 = s14f(z,l1,l2,l3,l4)
      t72 = t4*s2l1
      t73 = t35*s2l2
      t75 = -4096.D0/3.D0*t72+4096.D0/3.D0*t73-4096.D0/3.D0*t5+4096.D0/3
     #.D0*t36
      t76 = t75*t13
      t77 = 4096.D0/3.D0*t72
      t78 = 4096.D0/3.D0*t73
      taux4 = -t6+((4096.D0/3.D0*t7+4096.D0/3.D0*t4)*t11+(4096.D0/3.D0*t
     #4*t13-4096.D0/3.D0*t17+4096.D0/3.D0*t4)*t10-4096.D0/3.D0*t22*s2l2)
     #*s1l1+(4096.D0/3.D0*t27-4096.D0/3.D0*t29)*t33+t37+((-4096.D0/3.D0*
     #t28-4096.D0/3.D0*t35)*t11+(-4096.D0/3.D0*t35*t13+4096.D0/3.D0*t42-
     #4096.D0/3.D0*t35)*t10+4096.D0/3.D0*t22*s2l1)*s1l2+((4096.D0/3.D0*t
     #27-4096.D0/3.D0*t29-4096.D0/3.D0*t51+4096.D0/3.D0*t53)*t56+((8192.
     #D0/3.D0*t7+4096.D0/3.D0*t4)*t10-4096.D0/3.D0*t17)*s1l1+((-8192.D0/
     #3.D0*t28-4096.D0/3.D0*t35)*t10+4096.D0/3.D0*t42)*s1l2+t76-t77+t78-
     #t6+t37)*t32+t78-t77+((4096.D0/3.D0*t7*t10+4096.D0/3.D0*t7)*s1l1+(-
     #4096.D0/3.D0*t28*t10-4096.D0/3.D0*t28)*s1l2+(-4096.D0/3.D0*t51+409
     #6.D0/3.D0*t53)*t10-4096.D0/3.D0*t51+4096.D0/3.D0*t53)*t56+t76+t75*
     #t10

CCC Coefficients

      tcoff1 = taux1+taux2
      tcoff2 = taux1+taux2
      tcoff3 = taux2
      tcoff4 = taux2
      tcoff5 = taux3+taux4
      tcoff6 = -taux3-taux4
      tcoff7 = taux4
      tcoff8 = -taux4

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet1 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet2 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = s23f(z,l1,l2,l3,l4)
      t2 = s13f(z,l1,l2,l3,l4)
      t3 = s24f(z,l1,l2,l3,l4)
      t4 = s14f(z,l1,l2,l3,l4)
      tFjet3 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = s24f(z,l1,l2,l3,l4)
      t2 = s14f(z,l1,l2,l3,l4)
      t3 = s23f(z,l1,l2,l3,l4)
      t4 = s13f(z,l1,l2,l3,l4)
      tFjet4 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff4)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet5 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,8.D0,1.D0,1.D0,Tcoeff*tcoff5)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet6 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s3
     #l2,8.D0,1.D0,1.D0,Tcoeff*tcoff6)
      t1 = s23f(z,l1,l2,l3,l4)
      t2 = s13f(z,l1,l2,l3,l4)
      t3 = s24f(z,l1,l2,l3,l4)
      t4 = s14f(z,l1,l2,l3,l4)
      tFjet7 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s4
     #l2,8.D0,1.D0,1.D0,Tcoeff*tcoff7)
      t1 = s24f(z,l1,l2,l3,l4)
      t2 = s14f(z,l1,l2,l3,l4)
      t3 = s23f(z,l1,l2,l3,l4)
      t4 = s13f(z,l1,l2,l3,l4)
      tFjet8 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,8.D0,1.D0,1.D0,Tcoeff*tcoff8)

CCC Sum

      ggrmnum1e4 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcof
     #f4+tFjet5*tcoff5+tFjet6*tcoff6+tFjet7*tcoff7+tFjet8*tcoff8
      RETURN
      END

      double precision function ggrmnum2e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l1-1
      t2 = t1**2
      t3 = -1+z
      t4 = t2*t3
      t5 = l1*l3
      t6 = z*l2
      t7 = t5*t6
      t8 = t5*l2
      t14 = z*l1
      t15 = t14*l3
      t16 = t14*l2
      t17 = 2*t7
      t18 = l1*l2
      t19 = 2*t8
      t20 = -t15-t16+t17+t5+t18-t19-2
      t24 = t3**2
      t25 = t24*t2
      t26 = l1**2
      t27 = l3**2
      t28 = t26*t27
      t29 = l2**2
      t30 = t28*t29
      t31 = 4*t30
      t32 = z*t26
      t33 = t32*t27
      t34 = 2*t33
      t35 = z**2
      t36 = t35*t26
      t37 = t36*t27
      t38 = t28*l2
      t39 = 4*t38
      t40 = t26*l3
      t41 = t40*t29
      t43 = t40*l2
      t44 = l1*t27
      t45 = t44*l2
      t47 = t29*z
      t48 = t40*t47
      t50 = 1+t31-t34+t37-t39-2*t41+t43-t45-2*t5-t18-t44+t28+4*t48
      t51 = t29*t35
      t52 = t40*t51
      t54 = t40*t6
      t55 = 2*t54
      t56 = t35*l2
      t57 = t40*t56
      t58 = t28*t47
      t59 = 8*t58
      t60 = t28*t51
      t61 = 4*t60
      t62 = t28*t6
      t63 = 8*t62
      t64 = t28*t56
      t65 = 4*t64
      t66 = t44*t6
      t67 = 6*t7
      t68 = 6*t8
      t69 = 2*t15
      t70 = t14*t27
      t71 = 2*l3
      t72 = -2*t52-t55+t57-t59+t61+t63-t65+t66-t67+t68+t69+t16+t70+t71
      t73 = t50+t72
      t78 = 4*t41
      t79 = t51*t26
      t80 = t47*t26
      t81 = 2*t80
      t82 = 2*t18
      t83 = t29*t26
      t84 = 8*t48
      t85 = 1+t31-2*t38-t78+t43-t45+t79-t81-t5-t82+t44+t83+t84
      t86 = 4*t52
      t89 = 4*t7
      t90 = 4*t8
      t91 = 2*t16
      t92 = -t86-t55+t57-t59+t61+4*t62-2*t64+t66-t89+t90+t15+t91-t70-l3
      t93 = t85+t92
      t113 = t40*t35
      t114 = t32*l2
      t115 = 2*t114
      t116 = t40*z
      t117 = 2*t116
      t118 = t36*l2
      t120 = 5*t43
      t121 = t26*l2
      t122 = 2*t79
      t123 = 4*t80
      t124 = 4*t18
      t125 = -3+t113-t115-t117+t118-t31+t34-t37+t39+6*t41-t120-t45+t14+t
     #40+t121-t122+t123+t124
      t127 = 2*t83
      t130 = 10*t54
      t131 = 5*t57
      t132 = 4*t16
      t134 = 2*t44-t28-t127-12*t48+6*t52+t130-t131+t59-t61-t63+t65+t66+t
     #89-l1-t90-t132-2*t70+t71
      t135 = t125+t134
      t139 = 4*t33
      t140 = 2*t37
      t142 = 3*t5
      t143 = -t113+t115+t117-t118+t31-t139+t140-6*t38-t78+t120+t45-t14-t
     #40-t121+t79-t81-t142
      t144 = 2*t28
      t147 = 3*t15
      t148 = -t18+t144+t83+t84-t86-t130+t131-t59+t61+12*t62-6*t64-t66-t1
     #7+l1+t19+t147+t16+l3
      t149 = t143+t148
      t163 = t24*t3*t2
      t172 = 4*t43
      t173 = 4*t5
      t174 = 2+t27+8*t30-t139+t140-8*t38-8*t41+t172+t122-t123-t173-t124+
     #t144
      t177 = 8*t54
      t178 = 4*t57
      t183 = 8*t7
      t186 = t127+16*t48-8*t52-t177+t178-16*t58+8*t60+16*t62-8*t64-t183+
     #8*t8+4*t15+t132-l3
      t187 = t174+t186
      t197 = 6*t43
      t198 = 3*t18
      t199 = -2+t31+t34-t37-t39-t78+t197-t79+t81+t142+t198-t28
      t200 = 12*t54
      t201 = 6*t57
      t203 = -t83+t84-t86-t200+t201-t59+t61+t63-t65+t67-t68-t147-3*t16
      t209 = k1(z,l1,l2,l3,l4)
      t210 = t209**2
      t212 = t3*t1
      t218 = 4*t54
      t219 = 2*t57
      t220 = 2*t43
      t221 = 4*t14
      t222 = 4+t91+t69+t19-t5-t18-t89+t218-t219-t220+t221
      t223 = t35*l1
      t224 = t223*l2
      t225 = t5*t56
      t227 = t5*t35
      t228 = 4*l1
      t229 = 4*z
      t230 = t40+t113-t115+t121-t117+t118-t224+2*t225-t227-t228-t229
      t232 = t1*(t222+t230)
      t237 = 2*t14
      t239 = 2+2*t113-t115-4*t116+t118+t41-t172+t237+2*t40+t121-t79+t81-
     #t173-t83
      t240 = 2*t48
      t241 = 2*l1
      t242 = 2*z
      t243 = 6*t15
      t244 = z*l3
      t245 = 2*t244
      t246 = 2*t227
      t247 = 4*t225
      t248 = -t240+t52+t177-t178-t183-t241-t242+t90+t243+t16-t245+t71-t2
     #24-t246+t247
      t249 = t239+t248
      t255 = 2*t121
      t256 = 2+t113-4*t114-t117+2*t118+t41-t197+t237+t40+t255+t79-t81-t1
     #24+t83
      t257 = 6*t16
      t258 = 2*t224
      t259 = -t240+t52+t200-t201-t183-t241-t242+t90+t15+t257+t244-l3-t25
     #8-t227+t247
      t260 = t256+t259
      t274 = t16+t15+t8-t5-t18-t7+t32+t54-t43-t14+t40-t114+t121-t116-t26
     #+l1
      t279 = 6*t114
      t280 = 3*t118
      t281 = 3*t121
      t282 = -4-t113+t279+t117-t280+t41+t220-t14-t40-t281+t26+t124-t240+
     #t52-t218
      t283 = 7*t16
      t284 = 2*t32
      t285 = 3*t224
      t286 = t219+t183+t241+t229-t90-t69-t283-t284-t223+t36-t245+t71+t28
     #5+t246-t247
      t287 = t282+t286
      t291 = 4*t113
      t292 = 8*t116
      t293 = 4*t40
      t294 = -1-t291+t292+t41+t172-t14-t293-t122+t123+t26+t173-t127-t240
     #+t52-t177
      t295 = 7*t15
      t296 = 3*t227
      t297 = t178+t183+t241+z-t90-t295-t91-t284-t223+t36+t244-l3+t258+t2
     #96-t247
      t298 = t294+t297
      t316 = t1*t24
      t325 = 8*t57-t291-4*t118+8*t114-16*t54+t292+8*t43-t293-4*t121+4*t2
     #24+4*t227
      t328 = -2-8*t225-t295-t283-t221+14*t7+t228+t198-t68+t142+t229
      t329 = t325+t328
      t348 = -4-t257-t243-t68+t142+t198+12*t7-t200+t201+t197-t221
      t353 = -3*t40-3*t113+t279-t281+6*t116-t280+t285-6*t225+t296+t228+t
     #229
      t361 = 2-2*z-2*l1+2*t14
      t362 = t361*t1
      t365 = (1-z-l1+t18+t14-t16)*t1
      t366 = t3*s3l2p
      t369 = t3*(-t91+z+t115-t237+t32+t241-t255+t82-t26-1)
      t375 = t3*s3l1p
      t382 = (1-z-t18+t16)*t1
      t387 = t3*(-z-t91+t115-3*t32+t221+1+t82-t255-t228+3*t26)
      t405 = t241+t242-t79+t81-t83-2*t35-t115+t118+4*t32-6*t14+4*t223-2*
     #t26-2*t36+t121
      t406 = t405*t3
      s3 = ((128.D0/3.D0*t4*(-2*t7+2*t8)*s1l2-64.D0/3.D0*t4*t20*s2l2-64.
     #D0/3.D0*t25*t73*s3l2p-64.D0/3.D0*t25*t93*s4l2p)*s1l1+(-64.D0/3.D0*
     #t4*t20*s2l1-64.D0/3.D0*t25*t73*s3l1p-64.D0/3.D0*t25*t93*s4l1p)*s1l
     #2+(-128.D0/3.D0*t4*(-2*t15-2*t16+2*t14+2*t7+2*t5+2*t18-2*l1-2*t8)*
     #s2l2+64.D0/3.D0*t25*t135*s3l2p-64.D0/3.D0*t25*t149*s4l2p)*s2l1+(64
     #.D0/3.D0*t25*t135*s3l1p-64.D0/3.D0*t25*t149*s4l1p)*s2l2+(-128.D0/3
     #.D0*t163*(-t15+t17-t16+t5-t19+t18-t71-1+2*t27)*s3l2p+64.D0/3.D0*t1
     #63*t187*s4l2p)*s3l1p+64.D0/3.D0*t163*t187*s4l1p*s3l2p+64.D0/3.D0*t
     #4*(t199+t203)*z)*t210
      s4 = ((128.D0/3.D0*t212*(2*t54-2*t43-2*t7+2*t8)*s1l2-64.D0/3.D0*t2
     #32*s2l2+64.D0/3.D0*t212*t249*s3l2p+64.D0/3.D0*t212*t260*s4l2p)*s1l
     #1+(-64.D0/3.D0*t232*s2l1+64.D0/3.D0*t212*t249*s3l1p+64.D0/3.D0*t21
     #2*t260*s4l1p)*s1l2+(256.D0/3.D0*t212*t274*s2l2-64.D0/3.D0*t212*t28
     #7*s3l2p-64.D0/3.D0*t212*t298*s4l2p)*s2l1+(-64.D0/3.D0*t212*t287*s3
     #l1p-64.D0/3.D0*t212*t298*s4l1p)*s2l2+(128.D0/3.D0*(-2+z+l1-t14+t5-
     #t15+t18-t19-t16+t17)*t1*t24*s3l2p+64.D0/3.D0*t316*t329*s4l2p)*s3l1
     #p+64.D0/3.D0*t316*t329*s4l1p*s3l2p+128.D0/3.D0*t1*(-l1+t14+1)*(-t1
     #9+t17+t18-t16-1+t5-t15)*t24*s4l2p*s4l1p-64.D0/3.D0*t1*(t348+t353)*
     #z)*t209
      s2 = s3+s4
      s1 = s2+(64.D0/3.D0*t362*s2l2-64.D0/3.D0*t365*t366-64.D0/3.D0*t369
     #*s4l2p)*s1l1+(64.D0/3.D0*t362*s2l1-64.D0/3.D0*t365*t375-64.D0/3.D0
     #*t369*s4l1p)*s1l2+(-64.D0/3.D0*t382*t366+64.D0/3.D0*t387*s4l2p)*s2
     #l1
      taux5 = s1+(-64.D0/3.D0*t382*t375+64.D0/3.D0*t387*s4l1p)*s2l2+(128
     #.D0/3.D0*t316*s3l2p-64.D0/3.D0*t406*s4l2p)*s3l1p-64.D0/3.D0*t406*s
     #4l1p*s3l2p-128.D0/3.D0*t24*(t81+t14-t115-t32+1-t127+t255+t26-t241)
     #*s4l2p*s4l1p-64.D0/3.D0*t361*z*t1
      t1 = -1+z
      t2 = t1**2
      t3 = l1-1
      t4 = t3**2
      t5 = t2*t4
      t6 = l1**2
      t7 = t6*l3
      t8 = l2**2
      t9 = t7*t8
      t11 = z*l1
      t12 = t11*l2
      t13 = t11*l3
      t15 = l1*l3
      t16 = t15*l2
      t18 = z*t6
      t19 = l3**2
      t20 = t18*t19
      t21 = 2*t20
      t22 = t8*z
      t23 = t7*t22
      t25 = 2*t15
      t26 = l1*l2
      t27 = t6*t19
      t28 = t27*l2
      t29 = 4*t28
      t30 = z**2
      t31 = t8*t30
      t32 = t7*t31
      t34 = z*l2
      t35 = t15*t34
      t37 = -1+2*t9-t12-2*t13-3*t16+t21-4*t23+t25+t26+t29+2*t32+3*t35
      t38 = t30*l2
      t39 = t7*t38
      t40 = t27*t31
      t41 = 4*t40
      t42 = t7*l2
      t43 = l1*t19
      t44 = t43*l2
      t45 = t27*t8
      t46 = 4*t45
      t47 = t27*t22
      t48 = 8*t47
      t49 = t27*t34
      t50 = 8*t49
      t51 = t27*t38
      t52 = 4*t51
      t53 = t30*t6
      t54 = t53*t19
      t55 = t43*t34
      t56 = t7*t34
      t57 = 2*t56
      t58 = -t39-t27-t41-t42-t44-t46+t48-t50+t52-t54+t55+t57
      t59 = t37+t58
      t62 = 8*t23
      t63 = 4*t32
      t67 = 4*t9
      t69 = 1+t62-t63-4*t35+t39+t41-t48+4*t49-2*t51-l3-t67+2*t12+t13
      t70 = 4*t16
      t72 = t11*t19
      t73 = t31*t6
      t74 = t22*t6
      t75 = 2*t74
      t76 = 2*t26
      t77 = t8*t6
      t78 = t70-2*t28+t42-t44+t46-t72+t73-t75-t15-t76+t43+t77+t55-t57
      t79 = t69+t78
      t95 = 5*t39
      t98 = 3*t13
      t100 = 5*t42
      t101 = 1+12*t23-6*t32-5*t35+t95+t41-t48+t50-t52-t7-6*t9+3*t12+t98+
     #5*t16-t21-t29+t100-t44
      t102 = t7*t30
      t103 = t18*l2
      t104 = 2*t103
      t105 = t7*z
      t106 = 2*t105
      t107 = t53*l2
      t108 = 2*t73
      t109 = 4*t74
      t110 = 3*t15
      t112 = 2*t77
      t113 = 10*t56
      t114 = t6*l2
      t115 = t46+t54-t72+l1-t102+t104+t106-t107-t11+t108-t109-t110-3*t26
     #+t27+t43+t112+t55-t113-t114
      t116 = t101+t115
      t119 = 2*t35
      t122 = 2*t16
      t123 = 4*t20
      t125 = t62-t63-t119+t95+t41-t48+12*t49-6*t51+l3-t7-t67+t12+t98+t12
     #2-t123-6*t28+t100
      t126 = 2*t54
      t127 = 2*t27
      t128 = t44+t46+t126+l1-t102+t104+t106-t107-t11+t73-t75-t110-t26+t1
     #27+t77-t55-t113-t114
      t129 = t125+t128
      t143 = t2*t1*t4
      t146 = 8*t35
      t147 = 4*t39
      t153 = 4*t12
      t154 = 4*t13
      t155 = 2+16*t23-8*t32-t146+t147+8*t40-16*t47+16*t49-8*t51-l3-8*t9+
     #t153+t154
      t158 = 4*t42
      t160 = 4*t15
      t161 = 4*t26
      t162 = 8*t56
      t163 = 8*t16-t123-8*t28+t158+8*t45+t126+t19+t108-t109-t160-t161+t1
     #27+t112-t162
      t164 = t155+t163
      t174 = k1(z,l1,l2,l3,l4)
      t175 = t174**2
      t177 = t1*t3
      t178 = 2*t23
      t181 = 4*t15*t38
      t182 = 2*z
      t183 = -2+t178-t32+t146+t147-2*t7-t9-t12-t154-t70+t158-t181+t182
      t184 = 2*l1
      t187 = 2*t11
      t188 = t30*l1
      t189 = t188*l2
      t190 = t15*t30
      t191 = 2*t190
      t192 = t184-2*t102+t104+4*t105-t107-t187+t73-t75+t189+t191+t25+t77
     #-t162-t114
      t193 = t183+t192
      t198 = -2-t178+t32+t146+3*t39+l3-t7+t9-t153-t13-t70+3*t42-t181
      t201 = z*l3
      t202 = 2*t189
      t205 = t182+t184-t102+4*t103+t106-2*t107-t187-t201+t202+t190+t76-6
     #*t56-2*t114
      t206 = t198+t205
      t222 = 2-t6+t178-t32-t146-2*t39+t7-t9+7*t12+t154+t70-2*t42+t181-t1
     #82
      t223 = 6*t103
      t224 = 3*t107
      t225 = 2*t18
      t228 = 3*t114
      t229 = t102-t223-t106+t224-t11+t225+t188-t53-3*t189-t191-t25-t161+
     #4*t56+t228
      t230 = t222+t229
      t236 = 1-t6-t178+t32-t146-t95+l3+3*t7+t9+t153+7*t13+t70-t100+t181-
     #z+3*t102
      t239 = -t223-6*t105+t224-t11-t201+t225+t188-t53-t73+t75-t202-3*t19
     #0-t160-t76-t77+t113+t228
      t240 = t236+t239
      t256 = t2*t3*(-4*t11+4*l1+4*z-4)
      t257 = -t122+t119+t26-t12-1+t15-t13
      t269 = (-1+z+l1-t26-t11+t12)*t1
      t272 = -t1
      t273 = 1-z-t18+t187+t6-t184
      t274 = t272*t273
      t286 = (1-z-t26+t12)*t3
      t290 = -t272*t273
      t309 = -2+4*t18+4*t188-t77-t73+t75-2*t53+t114+t107-8*t11-t104-2*t3
     #0+4*l1-2*t6+4*z
      t310 = t309*t1
      s1 = ((256.D0/3.D0*t5*t59*s3l2p+256.D0/3.D0*t5*t79*s4l2p)*s1l1+(-2
     #56.D0/3.D0*t5*t59*s3l1p-256.D0/3.D0*t5*t79*s4l1p)*s1l2+(-256.D0/3.
     #D0*t5*t116*s3l2p+256.D0/3.D0*t5*t129*s4l2p)*s2l1+(256.D0/3.D0*t5*t
     #116*s3l1p-256.D0/3.D0*t5*t129*s4l1p)*s2l2-256.D0/3.D0*t143*t164*s4
     #l2p*s3l1p+256.D0/3.D0*t143*t164*s4l1p*s3l2p)*t175+((-256.D0/3.D0*t
     #177*t193*s3l2p+256.D0/3.D0*t177*t206*s4l2p)*s1l1+(256.D0/3.D0*t177
     #*t193*s3l1p-256.D0/3.D0*t177*t206*s4l1p)*s1l2+(256.D0/3.D0*t177*t2
     #30*s3l2p-256.D0/3.D0*t177*t240*s4l2p)*s2l1+(-256.D0/3.D0*t177*t230
     #*s3l1p+256.D0/3.D0*t177*t240*s4l1p)*s2l2+256.D0/3.D0*t256*t257*s4l
     #2p*s3l1p-256.D0/3.D0*t256*t257*s4l1p*s3l2p)*t174+(256.D0/3.D0*t269
     #*t3*s3l2p+256.D0/3.D0*t274*s4l2p)*s1l1+(-256.D0/3.D0*t269*t3*s3l1p
     #-256.D0/3.D0*t274*s4l1p)*s1l2
      taux6 = s1+(-256.D0/3.D0*t286*t1*s3l2p-256.D0/3.D0*t290*s4l2p)*s2l
     #1+(256.D0/3.D0*t286*t1*s3l1p+256.D0/3.D0*t290*s4l1p)*s2l2+256.D0/3
     #.D0*t310*s4l2p*s3l1p-256.D0/3.D0*t310*s4l1p*s3l2p

CCC Coefficients

      tcoff9 = taux5
      tcoff10 = taux6

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet9 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff9)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet10 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff10)

CCC Sum

      ggrmnum2e0 = tFjet9*tcoff9+tFjet10*tcoff10
      RETURN
      END

      double precision function ggrmnum2e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = t1**2
      t3 = l1-1
      t4 = t3**2
      t7 = l1*l3
      t8 = t7*l2
      t9 = 2*t8
      t10 = z*l2
      t11 = t7*t10
      t12 = 2*t11
      t13 = l1*l2
      t14 = z*l1
      t15 = t14*l2
      t16 = t14*l3
      t19 = l3**2
      t20 = l1*t19
      t22 = 3*t7
      t24 = t14*t19
      t26 = -t9+t12+t13-t15-2*t20+t22-1+t19-l3-3*t16+2*t24
      t28 = k1(z,l1,l2,l3,l4)
      t29 = t28**2
      t34 = t4*t1
      t35 = t20*t10
      t36 = t20*l2
      t37 = t16+t15-t12+t35-t24-t7-t13+t9-t36+t20+1-l3
      t41 = t24-t16-t20+t7
      t45 = t2*t4
      t47 = 2*t36
      t49 = 2*t35
      t50 = 3*t8
      t51 = 1-t13+t20-t7-2*l3+t16-t47-3*t11+t49+t50+t15-t24+t19
      t68 = t20-t47-t11+t49+t8-t24-t19
      t78 = l1**2
      t79 = t78*l1
      t80 = t19*t79
      t81 = z**2
      t82 = t81*z
      t83 = t82*l2
      t86 = t81*l2
      t97 = t79*l2
      t98 = t97*l3
      t100 = t78*t19
      t101 = l2**2
      t105 = t78*t101
      t107 = 2*t105*t82
      t108 = t79*t101
      t109 = t108*z
      t111 = t108*l3
      t113 = t78*l3
      t114 = t101*z
      t115 = t113*t114
      t117 = t101*t81
      t118 = t113*t117
      t120 = t113*t86
      t122 = z*l3
      t123 = t78*l2
      t124 = 6*t123
      t126 = 2-4*t80*t83+12*t80*t86-12*t80*t10+3*t80*z+2*t20*t81+4*t80*l
     #2-4*t98+8*t100*t101-4*z-t107+9*t109+10*t111+24*t115-24*t118+6*t120
     #-t122+t124-3*l1
      t127 = t81*t78
      t132 = t113*t101
      t134 = t113*l2
      t135 = 2*t134
      t136 = t117*t78
      t149 = t7*t86
      t151 = t108*t122
      t153 = t113*t81
      t155 = z*t78
      t156 = t155*l2
      t158 = t113*z
      t159 = 12*t158
      t160 = t127*l2
      t162 = 3*t127*t19-8*t100*l2-8*t132-t135+3*t136+6*t113-24*t100*t114
     #+24*t100*t117+24*t100*t10-24*t100*t86-18*t11+3*t14-t105+l3+12*t149
     #-30*t151+6*t153-12*t156-t159+6*t160
      t164 = t81*l1
      t165 = t164*l2
      t167 = t7*t81
      t170 = t79*t101*l2
      t171 = t170*l3
      t173 = 3*t13
      t176 = t19*z
      t183 = t19*t82
      t186 = t170*t81
      t188 = t170*t82
      t190 = t170*z
      t198 = -6*t165-8*t167-4*t171-t173-6*t7+3*t20+t176+6*t8+9*t15+14*t1
     #6+2*t170-3*t80*t81-2*t183*t78+6*t186-2*t188-6*t190+t80*t82-t80-8*t
     #105*t183-12*t108*t81*t19
      t199 = t82*l3
      t200 = t108*t199
      t202 = t123*t199
      t204 = t97*t199
      t212 = l3*t81
      t213 = t97*t212
      t215 = t108*t81
      t219 = t108*t82
      t221 = t97*t122
      t223 = t170*t122
      t225 = t170*t199
      t227 = t108*t212
      t231 = t170*t212
      t235 = -10*t200-4*t202+4*t204-3*t108-t19-5*t24+4*t108*t183+12*t108
     #*t176-12*t213-9*t215-4*t108*t19+3*t219+12*t221+12*t223+4*t225+30*t
     #227+8*t105*t199-12*t231+8*t100*t83-t100
      t243 = t1*t3
      t244 = t113*t10
      t245 = 2*t244
      t246 = t114*t78
      t247 = 2*l1
      t248 = -t115-t156+t245-t158+t246+t132+t123-t135+t113-t105+t16+t15-
     #t12+t50-t247-l3+2
      t252 = 2*t13
      t253 = 2*t7
      t254 = 2*t16
      t257 = 2*t15
      t258 = 2*t156
      t259 = 2*t246
      t260 = 3-t252-t253+t254-4*t11+4*t8+t257-t105+t123-t258+t160-t136+t
     #259
      t261 = t3*t260
      t264 = 2-t13-t12+t9+t15+t122-l1+t14-z
      t268 = 4*t115
      t271 = 1-t7+t16-t12+t9-t268-3*t120-l1-3*t134-t105+t113
      t272 = 2*t118
      t274 = 2*t132
      t276 = t272+t123-t258-2*t158+t153+t160+t14+t274-t136+6*t244+t259
      t277 = t271+t276
      t291 = 1-t173-t22+l3+t16-t12+t50+t15+t115+l1+t123-t156-t132
      t295 = -2+t13+t253-t254+t12-t9-t15+t122
      t299 = -1+t252+t7-t16+t12-t9-t257-t268-t120-t134-t105+t272+t274-t1
     #36+t245+t259
      t326 = 3*t127+5*t81-8*t7*t83+3*t98-6*z+t107-3*t109+3*t111+8*t246+2
     #4*t244-30*t120+3*t78+t124-4*l1-6*t134
      t328 = t79*l3
      t345 = -7*t136+6*t328*z+12*t79*z*l2+3*t113-10*t11+12*t14-3*t105-2*
     #t328-4*t97+18*t149-9*t151+15*t153-20*t156-t159+22*t160
      t359 = -9*t165-9*t167-2*t171+5*t15+5*t16+t170+3*t186-t188-3*t190-3
     #*t200+12*t202-3*t204+t108-6*t155-8*t164
      t386 = 9*t213+3*t215-t219-9*t221+6*t223+2*t225+9*t227-6*t231-12*t7
     #9*t81*l2+4*t79*t82*l2+4*t7*t82+2*t328*t82-8*t78*t82*l2+4*t13*t82-6
     #*t328*t81-6*t113*t82
      t399 = t3*s2l2
      t402 = 64.D0/3.D0*t243*s3l2p
      t405 = t1*(t15-t14-t258+t246+t155+2*t123-1-t105-t78+t247)
      t412 = t243*s3l1p
      t423 = t1*(t15-t246+1+t105-t247)
      t443 = 1+t105-2*t81+2*z-t123+t258-t160+l1+3*t164-t78+2*t155-4*t14-
     #t127-t259+t136
      s2 = -64.D0/3.D0*t2*t4*t3*(-t9+t12+t13-t15-1+t7-t16)*t26*z*t29*t28
     #+((128.D0/3.D0*t34*t37*s1l2-64.D0/3.D0*t34*t41*s2l2-64.D0/3.D0*t45
     #*t51*s3l2p)*s1l1+(-64.D0/3.D0*t34*t41*s2l1-64.D0/3.D0*t45*t51*s3l1
     #p)*s1l2+(-128.D0/3.D0*t34*(-t16+t35+t7-t36-l3)*s2l2+64.D0/3.D0*t45
     #*t68*s3l2p)*s2l1+64.D0/3.D0*t45*t68*s3l1p*s2l2+64.D0/3.D0*t34*(t12
     #6+t162+t198+t235)*z)*t29
      s1 = s2+((128.D0/3.D0*t243*t248*s1l2-64.D0/3.D0*t261*s2l2+64.D0/3.
     #D0*t243*t264*s3l2p+64.D0/3.D0*t243*t277*s4l2p)*s1l1+(-64.D0/3.D0*t
     #261*s2l1+64.D0/3.D0*t243*t264*s3l1p+64.D0/3.D0*t243*t277*s4l1p)*s1
     #l2+(128.D0/3.D0*t243*t291*s2l2-64.D0/3.D0*t243*t295*s3l2p-64.D0/3.
     #D0*t243*t299*s4l2p)*s2l1+(-64.D0/3.D0*t243*t295*s3l1p-64.D0/3.D0*t
     #243*t299*s4l1p)*s2l2-64.D0/3.D0*t3*(t326+t345+t359+t386)*z)*t28+(-
     #128.D0/3.D0*t1*(1-l1+t13)*t3*s1l2+64*t399-t402-64.D0/3.D0*t405*s4l
     #2p)*s1l1+(64*t3*s2l1-64.D0/3.D0*t412-64.D0/3.D0*t405*s4l1p)*s1l2
      taux5 = s1+(128.D0/3.D0*t1*(-1+t13)*t399-t402+64.D0/3.D0*t423*s4l2
     #p)*s2l1+(-64.D0/3.D0*t412+64.D0/3.D0*t423*s4l1p)*s2l2-64.D0/3.D0*t
     #1*s4l2p*s3l1p-64.D0/3.D0*t1*s4l1p*s3l2p-64.D0/3.D0*t443*z*t3
      t1 = l1-1
      t2 = t1**2
      t3 = -1+z
      t4 = t2*t3
      t5 = z*l1
      t6 = t5*l2
      t7 = 2*t6
      t8 = t5*l3
      t9 = 2*t8
      t10 = l1**2
      t11 = l3**2
      t12 = t10*t11
      t13 = t12*l2
      t14 = 2*t13
      t15 = t10*l3
      t16 = l2**2
      t17 = z**2
      t18 = t16*t17
      t19 = t15*t18
      t20 = 2*t19
      t21 = l1*l3
      t22 = 2*t21
      t23 = l1*l2
      t24 = 2*t23
      t25 = t16*t10
      t26 = t18*t10
      t27 = z*t16
      t28 = t27*t10
      t29 = 2*t28
      t30 = z*l2
      t31 = t12*t30
      t32 = 4*t31
      t33 = t17*l2
      t34 = t12*t33
      t35 = 2*t34
      t36 = 2*l3
      t37 = z*t10
      t38 = t37*t11
      t39 = 2*t38
      t40 = t15*t27
      t41 = 4*t40
      t42 = t17*t10
      t43 = t42*t11
      t44 = t15*t16
      t45 = 2*t44
      t46 = -1-t7+t9-t14+t20-t22+t24-t25-t26+t29+t32-t35+t36-t39-t41+t43
     #+t12+t45
      t50 = t3**2
      t51 = t50*t2
      t52 = 4*t13
      t53 = 2*t11
      t54 = t21*l2
      t55 = 5*t54
      t56 = 1-t22-t23+t12+t6+t9-t52+t53-t36-t39+t43-t45+t55
      t57 = 4*t34
      t58 = t21*t30
      t59 = 5*t58
      t60 = t12*t16
      t61 = 4*t60
      t62 = t15*l2
      t63 = l1*t11
      t64 = t63*l2
      t65 = t15*t30
      t66 = 2*t65
      t67 = t15*t33
      t68 = t12*t27
      t69 = 8*t68
      t70 = t12*t18
      t71 = 4*t70
      t72 = t63*t30
      t73 = 8*t31
      t74 = -t57+t41-t59+t61+t62-t64-t66+t67-t69+t71+t72-t20+t73
      t77 = 3*t54
      t78 = 3*t58
      t79 = -1+t45-t6-t9-t77+t39-t41+t22+t23+t52+t20+t78
      t80 = -t67-t12-t71-t62-t64-t61+t69-t73+t57-t43+t72+t66
      t84 = -t51*(t56+t74)+2*t51*(t79+t80)
      t87 = 4*t44
      t88 = 4*t54
      t89 = t5*t11
      t90 = 1-t21-t24+t25+t7+t8-t14+t26-l3-t29-t87+t88-t89
      t91 = 8*t40
      t93 = 4*t19
      t94 = -t35+t91-4*t58+t61+t62-t64-t66+t67-t69+t71+t72+t63-t93+t32
      t95 = t90+t94
      t111 = 3*t23
      t112 = 2*t25
      t113 = 3*t6
      t114 = 2*t26
      t115 = 4*t28
      t116 = 6*t44
      t117 = 12*t40
      t118 = -1+t21+t111-t112-t12-t113-t8+t52-t114-t53+t36+t115+t39-t43+
     #t116-t77-t89+t57-t117
      t119 = 5*t62
      t120 = 10*t65
      t121 = 5*t67
      t122 = t10*l2
      t123 = t15*t17
      t124 = t37*l2
      t125 = 2*t124
      t126 = t15*z
      t127 = 2*t126
      t128 = t42*l2
      t129 = 6*t19
      t130 = t78-t61-t119-t64+t120-t121+t69-t71+t15+t122-l1+t5+t72+t63+t
     #123-t125-t127+t128+t129-t73
      t133 = 3*t21
      t134 = 3*t8
      t135 = 1-t133-t111+t112+t12+t113+t134-t52+t114-t115-t39+t43-t116+t
     #55-t89-t57+t117-t59
      t136 = t61+t119-t64-t120+t121-t69+t71-t15-t122+l1-t5+t72+t63-t123+
     #t125+t127-t128-t129+t73
      t140 = -t51*(t118+t130)+2*t51*(t135+t136)
      t143 = 2*t12
      t145 = 4*t38
      t146 = 2*t43
      t147 = 2*t54
      t149 = 2*t58
      t150 = -t133-t23+t25+t143+t6+t134-6*t13+t26+l3-t29-t145+t146-t87+t
     #147-6*t34+t91-t149
      t152 = t61+t119+t64-t120+t121-t69+t71-t15-t122+l1-t5-t72-t123+t125
     #+t127-t128-t93+12*t31
      t153 = t150+t152
      t167 = t50*t3*t2
      t168 = 4*t21
      t169 = 4*t23
      t170 = 4*t6
      t171 = 4*t8
      t173 = 2-t168-t169+t112+t143+t170+t171-8*t13+t114+t11-l3-t115-t145
      t178 = 8*t58
      t180 = 4*t62
      t181 = 8*t65
      t182 = 4*t67
      t187 = t146-8*t44+8*t54-8*t34+16*t40-t178+8*t60+t180-t181+t182-16*
     #t68+8*t70-8*t19+16*t31
      t188 = t173+t187
      t198 = k1(z,l1,l2,l3,l4)
      t199 = t198**2
      t201 = t3*t1
      t202 = 2*t122
      t203 = 2*t15
      t204 = -t125+t202-t203-t9+t22+t7-t24+1-t36+t127
      t207 = z*l3
      t208 = 2*t40
      t209 = 2*z
      t211 = 4*t21*t33
      t212 = 1-t21+t23-t25+t134-t26+t207+l3+t29+t44+t147-t208-t209+t211
      t213 = 6*t58
      t214 = t21*t17
      t215 = 2*t214
      t216 = 2*l1
      t217 = 2*t5
      t218 = 2*t123
      t219 = 4*t126
      t220 = t17*l1
      t221 = t220*l2
      t222 = -t213-t215-t180+t181-t182+t203+t122-t216+t217+t218-t125-t21
     #9+t128+t19-t221
      t225 = -2+t22+t25-t6-t171+t26-t29-t44-t88+t208+t209-t211+t178
      t226 = t215+t180-t181+t182-t203-t122+t216-t217-t218+t125+t219-t128
     #-t19+t221
      t230 = -t201*(t212+t222)+2*t201*(t225+t226)
      t232 = 1+t21-t23+t113+t207-l3+t44+t147-t208-t209+t211-t213-t214
      t233 = 4*t124
      t234 = 2*t128
      t235 = 2*t221
      t236 = -t119+t120-t121+t15+t202-t216+t217+t123-t233-t127+t234+t19-
     #t235
      t239 = -2+t24-t170-t8-t207+l3+t44-t88-t208+t209-t211+t178+t214
      t240 = 3*t62
      t241 = 6*t65
      t242 = 3*t67
      t243 = t240-t241+t242-t15-t202+t216-t217-t123+t233+t127-t234+t19+t
     #235
      t247 = -t201*(t232+t236)+2*t201*(t239+t243)
      t260 = 2*t37
      t261 = -2+t21+t111-6*t6-t134+t10+t207+l3+t44-t147-t208+z-t260-t220
     #+t42
      t262 = 2*t62
      t263 = 4*t65
      t264 = 2*t67
      t265 = 3*t122
      t266 = 6*t124
      t267 = 3*t128
      t268 = 3*t221
      t269 = -t211+t213+t215+t262-t263+t264-t15-t265+t5-t123+t266+t127-t
     #267+t19+t268
      t273 = 2-t22-t169+7*t6+t171-t10-t44+t88+t208-t209+t260+t220-t42+t2
     #11
      t274 = -t178-t215-t262+t263-t264+t15+t265-t5+t123-t266-t127+t267-t
     #19-t268
      t278 = -t201*(t261+t269)+2*t201*(t273+t274)
      t281 = t133+t23-t25-t113-6*t8-t26+t10+t207-l3+t29+t44-t147-t208+z-
     #t260-t220
      t282 = 3*t214
      t283 = 3*t15
      t284 = 3*t123
      t285 = 6*t126
      t286 = t42-t211+t213+t282+t240-t241+t242-t283-t122+t5-t284+t125+t2
     #85-t128+t19+t235
      t290 = 1-t168-t24-t25+t170+7*t8-t26-t10-t207+l3+t29+t44+t88-t208-z
     #+t260
      t291 = t220-t42+t211-t178-t282-t119+t120-t121+t283+t265-t5+t284-t2
     #66-t285+t267+t19-t235
      t295 = -t201*(t281+t286)+2*t201*(t290+t291)
      t305 = t50*t1
      t317 = (-t305*(4*t5-4*l1-4*z+3)+2*t305*(-4*t5+4*l1+4*z-4))*(-t147+
     #t149+t23-t6-1+t21-t8)
      t318 = s4l2p*s3l1p
      t321 = s4l1p*s3l2p
      t328 = (1-2*l2)*t3
      t329 = l1*t1
      t334 = 3*z
      t336 = (t111-3*l1+3*t5-t113-t334+2)*t3
      t337 = t1*s3l2p
      t339 = -t3
      t340 = t6+t37-t10+z+l1-t112-t217+t23-t125+t29+t202
      t342 = 2*t3
      t343 = 1-z-t37+t217+t10-t216
      t345 = t339*t340+t342*t343
      t352 = t1*s3l1p
      t359 = (t111-t113+t334-2)*t3
      t361 = -t216+t112+t23+t10-t202-t37-t29+t5+t125+t6-z
      t365 = t339*t361-t342*t343
      t386 = 4-12*t37-12*t220+3*t25+3*t26-6*t28+6*t42+23*t5+t266-t265-t2
     #67+6*t10+6*t17-11*l1-12*z
      t387 = t386*t3
      s1 = ((-256.D0/3.D0*t4*t46*s2l2-256.D0/3.D0*t84*s3l2p-256*t51*t95*
     #s4l2p)*s1l1+(256.D0/3.D0*t4*t46*s2l1+256.D0/3.D0*t84*s3l1p+256*t51
     #*t95*s4l1p)*s1l2+(256.D0/3.D0*t140*s3l2p-256*t51*t153*s4l2p)*s2l1+
     #(-256.D0/3.D0*t140*s3l1p+256*t51*t153*s4l1p)*s2l2+256*t167*t188*s4
     #l2p*s3l1p-256*t167*t188*s4l1p*s3l2p)*t199+((256.D0/3.D0*t201*t204*
     #s2l2+256.D0/3.D0*t230*s3l2p-256.D0/3.D0*t247*s4l2p)*s1l1+(-256.D0/
     #3.D0*t201*t204*s2l1-256.D0/3.D0*t230*s3l1p+256.D0/3.D0*t247*s4l1p)
     #*s1l2+(-256.D0/3.D0*t278*s3l2p+256.D0/3.D0*t295*s4l2p)*s2l1+(256.D
     #0/3.D0*t278*s3l1p-256.D0/3.D0*t295*s4l1p)*s2l2-256.D0/3.D0*t317*t3
     #18+256.D0/3.D0*t317*t321)*t198+(-256.D0/3.D0*t328*t329*s2l2+256.D0
     #/3.D0*t336*t337+256.D0/3.D0*t345*s4l2p)*s1l1+(256.D0/3.D0*t328*t32
     #9*s2l1-256.D0/3.D0*t336*t352-256.D0/3.D0*t345*s4l1p)*s1l2
      taux6 = s1+(-256.D0/3.D0*t359*t337-256.D0/3.D0*t365*s4l2p)*s2l1+(2
     #56.D0/3.D0*t359*t352+256.D0/3.D0*t365*s4l1p)*s2l2+256.D0/3.D0*t387
     #*t318-256.D0/3.D0*t387*t321

CCC Coefficients

      tcoff9 = taux5
      tcoff10 = taux6

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet9 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff9)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet10 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff10)

CCC Sum

      ggrmnum2e1 = tFjet9*tcoff9+tFjet10*tcoff10
      RETURN
      END

      double precision function ggrmnum2e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l1-1
      t2 = t1**2
      t3 = -1+z
      t6 = l1**2
      t7 = t6*l3
      t8 = z**2
      t9 = t8*l2
      t10 = t7*t9
      t12 = l3**2
      t13 = t6*t12
      t14 = l2**2
      t15 = t14*z
      t18 = t14*t8
      t21 = z*l2
      t30 = t7*t8
      t32 = z*t6
      t33 = t32*l2
      t35 = t7*z
      t37 = t8*t6
      t38 = t37*l2
      t40 = l1*l3
      t43 = z*l1
      t46 = -1+2*l1+8*t10-16*t13*t15+8*t13*t18+16*t13*t21-8*t13*t9+2*t18
     #*t6-4*t15*t6-2*t30+4*t33+4*t35-2*t38-2*t40*t21+t43*l3+t43*l2
      t47 = l1*l2
      t53 = t6*l2
      t55 = t40*l2
      t67 = t7*l2
      t73 = t7*t21
      t75 = -t40-t47+2*t13+2*t14*t6-2*t43-2*t7-2*t53+2*t55+8*t13*t14-4*t
     #32*t12+2*t37*t12-8*t13*l2-8*t7*t14+8*t67+16*t7*t15-8*t7*t18-16*t73
      t78 = k1(z,l1,l2,l3,l4)
      t79 = t78**2
      t83 = t3*t1
      t89 = t1*s2l2
      t96 = t1*s2l1
      t106 = l3-1
      t124 = -5+4*l1+t53-4*t55-2*t35+2*t47+2*t40-6*t43-2*t33+t38+4*t73
      t127 = t8*l1
      t138 = -2*t67+t30-2*t10+t7-2*t127*l2-2*t40*t8-2*t6+4*t32+2*t127-2*
     #t37+4*t40*t9+z
      t145 = t3*l1
      t157 = t3*(-l1+t47)
      taux5 = 64.D0/3.D0*t2*t3*(t46+t75)*z*t79+((128.D0/3.D0*t83*l1*l3*l
     #2*s1l2-64.D0/3.D0*t89+64.D0/3.D0*t83*l3*s3l2p)*s1l1+(-64.D0/3.D0*t
     #96+64.D0/3.D0*t83*l3*s3l1p)*s1l2+(128.D0/3.D0*t83*(l1+t55-t47-t40)
     #*s2l2-64.D0/3.D0*t83*t106*s3l2p)*s2l1-64.D0/3.D0*t83*t106*s3l1p*s2
     #l2-64.D0/3.D0*t1*(t124+t138)*z)*t78+(64.D0/3.D0*t89-64.D0/3.D0*t14
     #5*l2*s4l2p)*s1l1+(64.D0/3.D0*t96-64.D0/3.D0*t145*l2*s4l1p)*s1l2+64
     #.D0/3.D0*t157*s4l2p*s2l1+64.D0/3.D0*t157*s4l1p*s2l2-64.D0/3.D0*t3*
     #s4l2p*s3l1p-64.D0/3.D0*t3*s4l1p*s3l2p-64.D0/3.D0*(-l1+t43+4)*z*t1
      t1 = l1-1
      t2 = t1**2
      t3 = -1+z
      t4 = t2*t3
      t5 = l3**2
      t6 = l1*t5
      t7 = l1*l3
      t8 = z*l1
      t9 = t8*l3
      t10 = t6*l2
      t11 = 2*t10
      t12 = z*l2
      t13 = t7*t12
      t14 = 2*t13
      t15 = t6*t12
      t16 = 2*t15
      t17 = t7*l2
      t18 = 2*t17
      t19 = t8*t5
      t22 = t8*l2
      t23 = 2*t22
      t24 = 2*t9
      t25 = l1**2
      t26 = t25*t5
      t27 = t26*l2
      t28 = 2*t27
      t29 = t25*l3
      t30 = l2**2
      t31 = z**2
      t32 = t30*t31
      t33 = t29*t32
      t34 = 2*t33
      t35 = 2*t7
      t36 = l1*l2
      t37 = 2*t36
      t38 = t30*t25
      t39 = t32*t25
      t40 = z*t30
      t41 = t40*t25
      t42 = 2*t41
      t43 = t26*t12
      t44 = 4*t43
      t45 = t31*l2
      t46 = t26*t45
      t47 = 2*t46
      t48 = 2*l3
      t49 = z*t25
      t50 = t49*t5
      t51 = 2*t50
      t52 = t29*t40
      t53 = 4*t52
      t54 = t31*t25
      t55 = t54*t5
      t56 = t29*t30
      t57 = 2*t56
      t58 = -1-t23+t24-t28+t34-t35+t37-t38-t39+t42+t44-t47+t48-t51-t53+t
     #55+t26+t57
      t61 = -t4*(t6-t7+t9-t11-t14+t16+t18-t19)+2*t4*t58
      t64 = t3**2
      t65 = t64*t2
      t66 = 3*t13
      t67 = 3*t17
      t68 = 1-t36+t6-t7-t48+t9-t11-t66+t16+t67+t22-t19+t5
      t70 = 2*t5
      t72 = 4*t27
      t73 = 1-t36+t26+t70-t48+t24-t10+5*t17+t22-t72-t51+t55-t57
      t74 = t29*t12
      t75 = 2*t74
      t76 = t29*t45
      t77 = t26*t40
      t78 = 8*t77
      t79 = t26*t32
      t80 = 4*t79
      t81 = 8*t43
      t82 = 4*t46
      t84 = t26*t30
      t85 = 4*t84
      t86 = t29*l2
      t87 = -t75+t76-t78+t80-t34+t81-t82+t53+t15-5*t13-t35+t85+t86
      t91 = -t65*t68+2*t65*(t73+t87)
      t95 = 4*t56
      t96 = 1-t37+t38-l3+t9-t10+4*t17-t19+t23-t28+t39-t42-t95
      t97 = 4*t33
      t98 = 8*t52
      t100 = -t75+t76-t78+t80-t97+t44-t47+t98+t15-4*t13+t6-t7+t85+t86
      t101 = t96+t100
      t118 = 3*t36
      t119 = 2*t38
      t120 = t29*t31
      t121 = t49*l2
      t122 = 2*t121
      t123 = t29*z
      t124 = 2*t123
      t125 = t54*l2
      t126 = 3*t22
      t127 = 2*t39
      t128 = 4*t41
      t129 = -1+t118-t119-t26-t70+t120-t122-t124+t125+t48-t9-t10-t67-t19
     #-t126+t72-t127+t128+t51
      t131 = 10*t74
      t132 = 5*t76
      t133 = t25*l2
      t136 = 5*t86
      t137 = -t55+6*t56-l1+t131-t132+t78-t80+t8+t29+t133+6*t33-t81+t82-1
     #2*t52+t15+t66+t6+t7-t85-t136
      t141 = -t65*(t6-t11-t13+t16+t17-t19-t5)+2*t65*(t129+t137)
      t144 = 2*t26
      t145 = 3*t9
      t147 = 4*t50
      t148 = 2*t55
      t149 = -t36+t38+t144-t120+t122+t124-t125+l3+t145+t10+t18+t22-6*t27
     #+t39-t42-t147+t148
      t152 = 3*t7
      t153 = -t95+l1-t131+t132-t78+t80-t8-t29-t133-t97+12*t43-6*t46+t98-
     #t15-t14-t152+t85+t136
      t154 = t149+t153
      t168 = t64*t3*t2
      t174 = 2-4*t36+t119+t144+t5-l3+4*t9+8*t17+4*t22-8*t27+t127-t128-t1
     #47
      t176 = 8*t74
      t177 = 4*t76
      t187 = 4*t86
      t188 = t148-8*t56-t176+t177-16*t77+8*t79-8*t33+16*t43-8*t46+16*t52
     #-8*t13-4*t7+8*t84+t187
      t189 = t174+t188
      t199 = k1(z,l1,l2,l3,l4)
      t200 = t199**2
      t202 = t3*t1
      t203 = 2*t52
      t204 = 2*t86
      t207 = 2*t133
      t208 = 2*t29
      t212 = -t202*(t57-t152+t118+t41-t203-t121+t75-t38+t133-t204)+2*t20
     #2*(-t122+t207-t208-t24+t35+t23-t37+1-t48+t124)
      t214 = z*l3
      t219 = 2*l1
      t220 = 1+t36-t38+2*t120-t122-4*t123+t125+l3+t145+t18-t39+t42+t56-t
     #219
      t221 = t31*l1
      t222 = t221*l2
      t223 = t7*t31
      t224 = 2*t223
      t225 = 2*t8
      t226 = 6*t13
      t228 = 4*t7*t45
      t229 = 2*z
      t230 = -t222-t224+t176-t177+t225+t208+t133+t33-t203-t226-t7-t187+t
     #228-t229+t214
      t234 = -t202*(t8+t7+1+t214-l1-z-t9+t48)+2*t202*(t220+t230)
      t236 = 6*t74
      t237 = 3*t86
      t238 = 3*t76
      t239 = -t124+t57+t236+t36-t53+t34-t38-t237+t120-t39-t238-t122+t42+
     #t8-l1+t29+t133+t125-t22
      t241 = 4*t121
      t242 = 2*t125
      t243 = 2*t222
      t244 = 1-t36+t120-t241-t124+t242-l3+t18+t126+t56-t219-t243-t223
      t245 = t131-t132+t225+t29+t207+t33-t203-t226+t7-t136+t228-t229+t21
     #4
      t249 = -t202*t239+2*t202*(t244+t245)
      t267 = -2+t25+t118-t120+6*t121+t124-3*t125+l3-t145-t18-6*t22+t56+3
     #*t222+t224-4*t74
      t270 = 2*t49
      t271 = 2*t76+t8-t29-3*t133+t33-t203+t226+t7+t204-t228+z+t214-t270-
     #t221+t54
      t275 = -t202*(-t9+t214+t7+t48-3)+2*t202*(t267+t271)
      t277 = t34-t22-t86+t57+t75+t36-t76-t53-t38+t42-t39
      t283 = t25+t36-t38-3*t120+t122+6*t123-t125-l3-6*t9-t18-t126-t39+t4
     #2+t56+t243+3*t223
      t285 = -t236+t238+t8-3*t29-t133+t33-t203+t226+t152+t237-t228+z+t21
     #4-t270-t221+t54
      t289 = -t202*t277+2*t202*(t283+t285)
      t304 = t64*t1*(4*t8-4*l1-4*z+3)
      t305 = -t18+t14+t36-t22-1+t7-t9
      t318 = (-1+2*l2)*t3
      t319 = l1*t1
      t324 = (-t36+t22+z+l1-t8)*t3
      t325 = t1*s3l2p
      t328 = -t3
      t331 = 2*t3
      t332 = t22+t49-t25+z+l1-t119-t225+t36-t122+t42+t207
      t334 = t328*(t37-t38+t41+t22-t25+t49+l1+t207-t8-t122)+t331*t332
      t342 = t1*s3l1p
      t350 = (-t36+t22-z)*t3
      t356 = -t219+t119+t36+t25-t207-t49-t42+t8+t122+t22-z
      t358 = t328*(t37+t38-t41+t22-3*l1)+t331*t356
      t377 = -3-4*t31-14*t8-t127-t241+t242-4*t54-4*t25+8*t221+8*t49+6*l1
     #-t119+t128+8*z+t207
      t378 = t377*t3
      s2 = ((256.D0/3.D0*t61*s2l2-256.D0/3.D0*t91*s3l2p+512.D0/3.D0*t65*
     #t101*s4l2p)*s1l1+(-256.D0/3.D0*t61*s2l1+256.D0/3.D0*t91*s3l1p-512.
     #D0/3.D0*t65*t101*s4l1p)*s1l2+(256.D0/3.D0*t141*s3l2p+512.D0/3.D0*t
     #65*t154*s4l2p)*s2l1+(-256.D0/3.D0*t141*s3l1p-512.D0/3.D0*t65*t154*
     #s4l1p)*s2l2-512.D0/3.D0*t168*t189*s4l2p*s3l1p+512.D0/3.D0*t168*t18
     #9*s4l1p*s3l2p)*t200+((-256.D0/3.D0*t212*s2l2+256.D0/3.D0*t234*s3l2
     #p-256.D0/3.D0*t249*s4l2p)*s1l1+(256.D0/3.D0*t212*s2l1-256.D0/3.D0*
     #t234*s3l1p+256.D0/3.D0*t249*s4l1p)*s1l2+(-256.D0/3.D0*t275*s3l2p+2
     #56.D0/3.D0*t289*s4l2p)*s2l1+(256.D0/3.D0*t275*s3l1p-256.D0/3.D0*t2
     #89*s4l1p)*s2l2-512.D0/3.D0*t304*t305*s4l2p*s3l1p+512.D0/3.D0*t304*
     #t305*s4l1p*s3l2p)*t199
      s1 = s2+(-512.D0/3.D0*t318*t319*s2l2+512.D0/3.D0*t324*t325+256.D0/
     #3.D0*t334*s4l2p)*s1l1+(512.D0/3.D0*t318*t319*s2l1-512.D0/3.D0*t324
     #*t342-256.D0/3.D0*t334*s4l1p)*s1l2
      taux6 = s1+(-512.D0/3.D0*t350*t325-256.D0/3.D0*t358*s4l2p)*s2l1+(5
     #12.D0/3.D0*t350*t342+256.D0/3.D0*t358*s4l1p)*s2l2+256.D0/3.D0*t378
     #*s4l2p*s3l1p-256.D0/3.D0*t378*s4l1p*s3l2p

CCC Coefficients

      tcoff9 = taux5
      tcoff10 = taux6

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet9 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff9)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet10 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff10)

CCC Sum

      ggrmnum2e2 = tFjet9*tcoff9+tFjet10*tcoff10
      RETURN
      END

      double precision function ggrmnum2e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l1-1
      t2 = l1*l3
      t9 = z*l1
      t14 = k1(z,l1,l2,l3,l4)
      taux5 = -64.D0/3.D0*t1*(-2*t2*l2+2*t2*z*l2+l1*l2-t9*l2-1+t2-t9*l3)
     #*z*t14-64.D0/3.D0*z*t1
      t1 = l1-1
      t2 = t1**2
      t3 = -1+z
      t4 = t2*t3
      t5 = l3**2
      t6 = l1*t5
      t7 = l1*l3
      t8 = z*l1
      t9 = t8*l3
      t11 = 2*t6*l2
      t12 = z*l2
      t13 = t7*t12
      t16 = 2*t6*t12
      t17 = t7*l2
      t19 = t8*t5
      t20 = t6-t7+t9-t11-2*t13+t16+2*t17-t19
      t23 = t3**2
      t24 = t23*t2
      t25 = l1*l2
      t26 = 2*l3
      t29 = t8*l2
      t30 = 1-t25+t6-t7-t26+t9-t11-3*t13+t16+3*t17+t29-t19+t5
      t43 = t6-t11-t13+t16+t17-t19-t5
      t53 = k1(z,l1,l2,l3,l4)
      t54 = t53**2
      t56 = t3*t1
      t59 = l1**2
      t60 = t59*l3
      t61 = l2**2
      t63 = 2*t60*t61
      t66 = z*t61
      t67 = t66*t59
      t68 = t60*t66
      t70 = z*t59
      t71 = t70*l2
      t72 = t60*t12
      t73 = 2*t72
      t74 = t61*t59
      t75 = t59*l2
      t76 = t60*l2
      t81 = -t56*(t25-t7)+2*t56*(t63-3*t7+3*t25+t67-2*t68-t71+t73-t74+t7
     #5-2*t76)
      t85 = z*l3
      t89 = -t56*l3+2*t56*(t8+t7+1+t85-l1-z-t9+t26)
      t95 = 4*t68
      t96 = z**2
      t97 = t61*t96
      t99 = 2*t60*t97
      t102 = t97*t59
      t104 = t60*t96*l2
      t106 = 2*t71
      t107 = 2*t67
      t110 = -2*t60*z+t63+6*t72+t25-t95+t99-t74-3*t76+t60*t96-t102-3*t10
     #4-t106+t107+t8-l1+t60+t75+t96*t59*l2-t29
      t130 = -t56*(l3-1)+2*t56*(-t9+t85+t7+t26-3)
      t133 = t99-t29-t76+t63+t73+t25-t104-t95-t74+t107-t102
      t148 = -t3
      t151 = 2*t3
      t152 = 2*t25
      t156 = t148*l1*l2+t151*(t152-t74+t67+t29-t59+t70+l1+2*t75-t8-t106)
      t168 = t148*(-l1+t25)+t151*(t152+t74-t67+t29-3*l1)
      t175 = 5*t3
      taux6 = ((512.D0/3.D0*t4*t20*s2l2-512.D0/3.D0*t24*t30*s3l2p)*s1l1+
     #(-512.D0/3.D0*t4*t20*s2l1+512.D0/3.D0*t24*t30*s3l1p)*s1l2+512.D0/3
     #.D0*t24*t43*s3l2p*s2l1-512.D0/3.D0*t24*t43*s3l1p*s2l2)*t54+((-256.
     #D0/3.D0*t81*s2l2+256.D0/3.D0*t89*s3l2p-512.D0/3.D0*t56*t110*s4l2p)
     #*s1l1+(256.D0/3.D0*t81*s2l1-256.D0/3.D0*t89*s3l1p+512.D0/3.D0*t56*
     #t110*s4l1p)*s1l2+(-256.D0/3.D0*t130*s3l2p+512.D0/3.D0*t56*t133*s4l
     #2p)*s2l1+(256.D0/3.D0*t130*s3l1p-512.D0/3.D0*t56*t133*s4l1p)*s2l2)
     #*t53+256.D0/3.D0*t156*s4l2p*s1l1-256.D0/3.D0*t156*s4l1p*s1l2-256.D
     #0/3.D0*t168*s4l2p*s2l1+256.D0/3.D0*t168*s4l1p*s2l2+256.D0/3.D0*t17
     #5*s4l2p*s3l1p-256.D0/3.D0*t175*s4l1p*s3l2p

CCC Coefficients

      tcoff9 = taux5
      tcoff10 = taux6

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet9 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff9)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet10 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff10)

CCC Sum

      ggrmnum2e3 = tFjet9*tcoff9+tFjet10*tcoff10
      RETURN
      END

      double precision function ggrmnum2e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux5 = 0
      t1 = -1+z
      t3 = t1*(l1-1)
      t4 = l1*l2
      t6 = t4-l1*l3
      t21 = l3-1
      t31 = k1(z,l1,l2,l3,l4)
      t33 = t1*l1
      t43 = t1*(-l1+t4)
      taux6 = ((-512.D0/3.D0*t3*t6*s2l2+512.D0/3.D0*t3*l3*s3l2p)*s1l1+(5
     #12.D0/3.D0*t3*t6*s2l1-512.D0/3.D0*t3*l3*s3l1p)*s1l2-512.D0/3.D0*t3
     #*t21*s3l2p*s2l1+512.D0/3.D0*t3*t21*s3l1p*s2l2)*t31+512.D0/3.D0*t33
     #*l2*s4l2p*s1l1-512.D0/3.D0*t33*l2*s4l1p*s1l2-512.D0/3.D0*t43*s4l2p
     #*s2l1+512.D0/3.D0*t43*s4l1p*s2l2+512.D0/3.D0*t1*s4l2p*s3l1p-512.D0
     #/3.D0*t1*s4l1p*s3l2p

CCC Coefficients

      tcoff9 = taux5
      tcoff10 = taux6

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet9 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-t
     #3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,4.D0,1.D0,1.D0,Tcoeff*tcoff9)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet10 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff10)

CCC Sum

      ggrmnum2e4 = tFjet9*tcoff9+tFjet10*tcoff10
      RETURN
      END

      double precision function ggrmnum3e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = -1+z
      t5 = t4**2
      t6 = t5**2
      t7 = t3*t6
      t8 = t7*l3
      t9 = 1/s4vr
      t10 = 1/s3vr
      t11 = t9*t10
      t12 = t11*s2l2
      t13 = t8*t12
      t15 = t11*s3l2
      t16 = t8*t15
      t18 = t9*s4l2
      t19 = t18*t10
      t20 = t8*t19
      t24 = t11*s3l1
      t26 = t9*s4l1
      t27 = t26*t10
      t29 = t8*t24+t8*t27
      t44 = t2**2
      t45 = t6*t4
      t47 = t44*t45*l3
      t49 = t11*s34r*s2l2
      t66 = s13r**2
      t69 = t2*t6
      t70 = l3**2
      t71 = t69*t70
      t72 = t71*t12
      t74 = t71*t15
      t75 = 64.D0/3.D0*t74
      t77 = s1vr**2
      t79 = 512.D0/3.D0*t72
      t81 = t71*t19
      t86 = t3*t45*t70
      t87 = t86*t49
      t90 = t11*s3l2*s34r
      t95 = 128.D0/3.D0*t74
      t96 = 128.D0/3.D0*t81
      t98 = s23r**2
      t101 = t86*t15
      t103 = t86*t19
      t109 = t6*t5
      t111 = t44*t109*t70
      t112 = s34r**2
      t114 = t11*t112*s2l2
      t123 = t11*s2l1
      t124 = t71*t123
      t126 = t71*t24
      t127 = 64.D0/3.D0*t126
      t130 = 512.D0/3.D0*t124
      t132 = t71*t27
      t137 = t11*s34r*s2l1
      t138 = t86*t137
      t141 = t11*s3l1*s34r
      t147 = 128.D0/3.D0*t132
      t151 = t86*t24
      t153 = t86*t27
      t160 = t11*t112*s2l1
      t174 = t10*s3l1
      t175 = t18*t174
      t176 = t71*t175
      t178 = t10*s3l2
      t179 = t26*t178
      t180 = t71*t179
      t181 = 128.D0/3.D0*t180
      t193 = 512.D0/3.D0*t176
      t194 = 512.D0/3.D0*t180
      t195 = t70*z
      t196 = t195*t6
      t197 = t2*t9
      t198 = t197*t10
      t199 = t196*t198
      t200 = 512.D0/3.D0*t199
      t203 = t11*s34r
      t206 = 2*z
      t207 = t206-3
      t208 = l3*t207
      t209 = t5*t4
      t215 = 64.D0/3.D0*t101
      t217 = t215+64*t103
      t219 = l3*t209
      t220 = t219*t2
      t222 = (z+2)*t9
      t226 = t69*l3
      t231 = 64.D0/3.D0*t151
      t233 = t231+64*t153
      t242 = t86*t175
      t243 = t86*t179
      t248 = t11*s3l2*s3l1
      t249 = t220*t248
      t251 = s4l1*t10
      t252 = t18*t251
      t253 = t220*t252
      t254 = 128.D0/3.D0*t253
      t257 = -t74-t81
      t258 = 128.D0/3.D0*t257
      t260 = -t126-t132
      t269 = z*t9
      t271 = t220*t269*t178
      t273 = 3*z
      t275 = (-t273+6)*t9
      t276 = s4l2*t10
      t293 = t3*t9
      t295 = t195*t45*t293*t10
      t306 = t10*t112
      t307 = t18*t306
      t310 = z+1
      t311 = t310*t9
      t312 = t311*t178
      t314 = -2+z
      t316 = l3*t314*t6
      t324 = t26*t306
      t348 = t70*l3
      t349 = t348*t6
      t350 = t349*t1
      t355 = t11*t98
      t359 = t348*t45*t2
      t361 = t11*s34r*s23r
      t366 = t98*s23r
      t367 = t11*t366
      t371 = t11*s34r*t98
      t375 = t348*t109*t3
      t377 = t11*t112*s23r
      t382 = t350*t12
      t384 = t350*t15
      t385 = 128.D0/3.D0*t384
      t386 = t350*t19
      t388 = -256.D0/3.D0*t382-t385-128.D0/3.D0*t386
      t391 = t1*t209*t70
      t392 = t391*t12
      t394 = t391*t15
      t400 = 128*t386
      t407 = t1*t9
      t408 = t407*t10
      t411 = 256.D0/3.D0*t359*t203-128.D0/3.D0*t70*t207*t209*t408
      t413 = t359*t15
      t414 = t359*t19
      t415 = t413+t414
      t416 = 64*t415
      t418 = t6*t1
      t419 = t418*t70
      t429 = t10*s34r
      t439 = 512.D0/3.D0*t419*t12
      t442 = -t314
      t443 = t442*t9
      t445 = t391*t443*t178
      t447 = t273-2
      t448 = t447*t9
      t456 = t69*t70*(-t206+5)
      t464 = -z+4
      t465 = t464*t9
      t468 = t314*t9
      t483 = t350*t123
      t485 = t350*t24
      t487 = t350*t27
      t493 = t391*t24
      t503 = t359*t24
      t504 = t359*t27
      t505 = t503+t504
      t506 = 64*t505
      t523 = -128.D0/3.D0*t485-128.D0/3.D0*t487
      t562 = t350*t175
      t564 = t350*t179
      t566 = t348*z
      t568 = t566*t6*t408
      t569 = 512.D0/3.D0*t568
      t575 = 64.D0/3.D0*t391*t19
      t583 = t195*t209
      t585 = 64.D0/3.D0*t583*t408
      t590 = 64*t384+64.D0/3.D0*t386
      t594 = 64*t485+64.D0/3.D0*t487
      t603 = t70*t447*t209
      t604 = t407*t178
      t608 = t70*t314*t209
      t609 = t407*t276
      t616 = t407*t174
      t619 = t407*t251
      t635 = t419*t179
      t637 = 4*z
      t646 = l3*t5
      t647 = -t4
      t648 = t646*t647
      t653 = 256.D0/3.D0*t81
      t656 = t646*t1
      t657 = -4+t273
      t658 = t657*t9
      t683 = t656*t19
      t687 = t656*t179
      t691 = -t657
      t692 = t691*t9
      t707 = 256.D0/3.D0*t394
      t708 = t419*t19
      t713 = t18*s4l1
      t714 = t391*t713
      t717 = t195*t418*t9
      t728 = (-z+5)*t9
      t731 = z-3
      t732 = t70*t731
      t735 = t732*t6*t197*t276
      t739 = z**2
      t741 = t646*(t739-2)
      t746 = t646*(t739-6*z+4)
      t804 = -t206+1
      t805 = t804*t9
      t844 = t70**2
      t845 = t844*t6
      t848 = t348*t209
      t857 = t844*t45*t1
      t860 = t348*t207
      t862 = t209*t9*t10
      t883 = t845*t15
      t885 = t845*t19
      t891 = t848*t15
      t910 = t848*(-z+6)
      t913 = t848*t691
      t920 = t70*t5
      t921 = t647*t9
      t922 = t921*t10
      t925 = 64*t350*t203+64.D0/3.D0*t920*t922
      t931 = -t447
      t932 = t920*t931
      t934 = 64.D0/3.D0*t932*t15
      t935 = t920*z
      t946 = t848*t314
      t948 = t848*z
      t953 = t70*t6
      t957 = -t464*t9
      t966 = t920*(t739-t637+2)
      t977 = t70*t209
      t979 = t977*(-t637+2)
      t981 = 3*t647
      t982 = t977*t981
      t997 = t845*t24
      t999 = t845*t27
      t1035 = 64.D0/3.D0*t932*t24
      t1083 = t845*t9
      t1084 = t178*s2l1
      t1087 = t174*s2l2
      t1090 = t276*s3l1
      t1093 = t251*s3l2
      t1098 = t848*t9
      t1111 = t920*t9
      t1127 = -t848*t207
      t1129 = t11*s3l2*s2l1
      t1133 = t11*s3l1*s2l2
      t1136 = t860*t209
      t1144 = s4l2*s4l1*t10
      t1164 = t920*t804
      t1175 = t4*l3
      t1176 = t1175*t647
      t1199 = t977*t442
      t1207 = t920*(t739-t273+1)
      t1220 = -t981*t9
      t1226 = t646*z
      t1282 = -t310
      s3 = (((256.D0/3.D0*t13+64.D0/3.D0*t16+64.D0/3.D0*t20)*s2l1+64.D0/
     #3.D0*t29*s2l2)*s1vr+((-512.D0/3.D0*t13-128.D0/3.D0*t16-128.D0/3.D0
     #*t20)*s2l1-128.D0/3.D0*t29*s2l2)*s23r+(-256.D0/3.D0*t47*t49+(-64.D
     #0/3.D0*t47*t15-64.D0/3.D0*t47*t19)*s34r)*s2l1+(-64.D0/3.D0*t47*t24
     #-64.D0/3.D0*t47*t27)*s34r*s2l2)*t66*s13r
      s8 = ((-128.D0/3.D0*t72-t75)*t77+((t79+64*t74+64.D0/3.D0*t81)*s23r
     #+256.D0/3.D0*t87+128.D0/3.D0*t86*t90)*s1vr+(-t79-t95-t96)*t98+(-51
     #2.D0/3.D0*t87+(-64*t101-64.D0/3.D0*t103)*s34r)*s23r-128.D0/3.D0*t1
     #11*t114-64.D0/3.D0*t111*t11*s3l2*t112)*s1l1+((-128.D0/3.D0*t124-t1
     #27)*t77+((t130+64*t126+64.D0/3.D0*t132)*s23r+256.D0/3.D0*t138+128.
     #D0/3.D0*t86*t141)*s1vr+(-t130-128.D0/3.D0*t126-t147)*t98+(-512.D0/
     #3.D0*t138+(-64*t151-64.D0/3.D0*t153)*s34r)*s23r-128.D0/3.D0*t111*t
     #160-64.D0/3.D0*t111*t11*s3l1*t112)*s1l2
      s7 = s8+((-256.D0/3.D0*t72-t75-t96)*s2l1+(-t127-t147)*s2l2-128.D0/
     #3.D0*t176-t181)*t77+(((256*t72+256.D0/3.D0*t74+128*t81)*s2l1+(256.
     #D0/3.D0*t126+128*t132)*s2l2+t193+t194-t200)*s23r+((256.D0/3.D0*t86
     #*t203-128.D0/3.D0*t208*t209*t198)*s2l2+t217*s34r-64.D0/3.D0*t220*t
     #222*t178-64.D0/3.D0*t226*t19)*s2l1+(t233*s34r-64.D0/3.D0*t220*t222
     #*t174-64.D0/3.D0*t226*t27)*s2l2+(256.D0/3.D0*t242+256.D0/3.D0*t243
     #)*s34r-128.D0/3.D0*t249+t254)*s1vr+(t258*s2l1+128.D0/3.D0*t260*s2l
     #2-t193-t194+t200)*t98
      s6 = s7+((256*t226*t12-t217*s34r+64*t271-64.D0/3.D0*t220*t275*t276
     #)*s2l1+(-t233*s34r+64*t220*t269*t174-64.D0/3.D0*t220*t275*t251)*s2
     #l2+(-512.D0/3.D0*t242-512.D0/3.D0*t243+512.D0/3.D0*t295)*s34r+256.
     #D0/3.D0*t249-256.D0/3.D0*t253)*s23r+(128.D0/3.D0*t208*t7*t49-64.D0
     #/3.D0*t111*t307+(64.D0/3.D0*t8*t312+64.D0/3.D0*t316*t293*t276)*s34
     #r)*s2l1+(-64.D0/3.D0*t111*t324+(64.D0/3.D0*t8*t311*t174+64.D0/3.D0
     #*t316*t293*t251)*s34r)*s2l2+(-128.D0/3.D0*t111*t175-128.D0/3.D0*t1
     #11*t179)*t112+(128.D0/3.D0*t8*t248-128.D0/3.D0*t8*t252)*s34r
      s7 = t66
      s5 = s6*s7
      s10 = ((-256.D0/3.D0*t350*t11*s23r*t77+(256*t350*t355+512.D0/3.D0*
     #t359*t361)*s1vr-512.D0/3.D0*t350*t367-256*t359*t371-256.D0/3.D0*t3
     #75*t377)*s1l2+(t388*s23r-64.D0/3.D0*t392+64.D0/3.D0*t394)*t77+((51
     #2.D0/3.D0*t382+256.D0/3.D0*t384+t400)*t98+(t411*s2l2+t416*s34r-64.
     #D0/3.D0*t419*t15-64.D0/3.D0*t391*t311*t276)*s23r+256.D0/3.D0*t71*t
     #49+64.D0/3.D0*t71*t18*t429)*s1vr+(-128.D0/3.D0*t384-128.D0/3.D0*t3
     #86)*t366+(t439-t416*s34r-64.D0/3.D0*t445+64.D0/3.D0*t391*t448*t276
     #)*t98+(-128.D0/3.D0*t456*t49+(-64.D0/3.D0*t375*t15-64.D0/3.D0*t375
     #*t19)*t112+(-64.D0/3.D0*t71*t465*t178+64.D0/3.D0*t71*t468*t276)*s3
     #4r)*s23r-64*t86*t114+(-64.D0/3.D0*t101-64.D0/3.D0*t103)*t112)*s1l1
      s11 = (((-256.D0/3.D0*t483-128.D0/3.D0*t485-128.D0/3.D0*t487)*s23r
     #-64.D0/3.D0*t391*t123+64.D0/3.D0*t493)*t77+((512.D0/3.D0*t483+256.
     #D0/3.D0*t485+128*t487)*t98+(t411*s2l1+t506*s34r-64.D0/3.D0*t419*t2
     #4-64.D0/3.D0*t391*t311*t251)*s23r+256.D0/3.D0*t71*t137+64.D0/3.D0*
     #t71*t26*t429)*s1vr+t523*t366+(512.D0/3.D0*t419*t123-t506*s34r-64.D
     #0/3.D0*t391*t443*t174+64.D0/3.D0*t391*t448*t251)*t98+(-128.D0/3.D0
     #*t456*t137+(-64.D0/3.D0*t375*t24-64.D0/3.D0*t375*t27)*t112+(-64.D0
     #/3.D0*t71*t465*t174+64.D0/3.D0*t71*t468*t251)*s34r)*s23r-64*t86*t1
     #60+(-64.D0/3.D0*t151-64.D0/3.D0*t153)*t112)*s1l2
      s9 = s10+s11
      s10 = s9+((t388*s2l1+t523*s2l2-256.D0/3.D0*t562-256.D0/3.D0*t564+t
     #569)*s23r+(-128.D0/3.D0*t392+64*t394-t575)*s2l1+(64*t493-64.D0/3.D
     #0*t391*t27)*s2l2+t585)*t77
      s11 = s10
      s13 = ((t590*s2l1+t594*s2l2+512.D0/3.D0*t562+512.D0/3.D0*t564-t569
     #)*t98+((-t439+64.D0/3.D0*t415*s34r-64.D0/3.D0*t603*t604-64*t608*t6
     #09)*s2l1+(64.D0/3.D0*t505*s34r-64.D0/3.D0*t603*t616-64*t608*t619)*
     #s2l2+(256.D0/3.D0*t359*t175+256.D0/3.D0*t359*t179-512.D0/3.D0*t566
     #*t45*t198)*s34r-256.D0/3.D0*t419*t175-256.D0/3.D0*t635-128.D0/3.D0
     #*t583*(-t637+5)*t1*t11)*s23r+((128.D0/3.D0*t71*t203+128.D0/3.D0*t6
     #48*t408)*s2l2+(-t75+t653)*s34r+64.D0/3.D0*t656*t658*t178+64.D0/3.D
     #0*t648*t609)*s2l1+((-t127+256.D0/3.D0*t132)*s34r+64.D0/3.D0*t656*t
     #658*t174+64.D0/3.D0*t648*t619)*s2l2+((t95+t653)*s3l1+256.D0/3.D0*t
     #180)*s34r+(128.D0/3.D0*t656*t312+64.D0/3.D0*t683)*s3l1+64.D0/3.D0*
     #t687)*s1vr
      s14 = ((-64.D0/3.D0*t391*t692*t178+64.D0/3.D0*t391*t269*t276)*s2l1
     #+(-64.D0/3.D0*t391*t692*t174+64.D0/3.D0*t391*t269*t251)*s2l2+(-t70
     #7+512.D0/3.D0*t708)*s3l1+512.D0/3.D0*t635+(256.D0/3.D0*t714-512.D0
     #/3.D0*t717)*t10)*t98
      s12 = s13+s14
      s8 = s11+s12
      s9 = s8+((-256.D0/3.D0*t6*l3*t1*t12+(-64.D0/3.D0*t71*t728*t178+64.
     #D0/3.D0*t735)*s34r-64.D0/3.D0*t741*t604-64.D0/3.D0*t746*t609)*s2l1
     #+((-64.D0/3.D0*t71*t728*t174+64.D0/3.D0*t71*t731*t9*t251)*s34r-64.
     #D0/3.D0*t741*t616-64.D0/3.D0*t746*t619)*s2l2+((-128*t74+256.D0/3.D
     #0*t735)*s3l1+256.D0/3.D0*t732*t69*t179+(128.D0/3.D0*t71*t713+128.D
     #0/3.D0*t196*t2*(-t637+3)*t9)*t10)*s34r+(-128.D0/3.D0*t656*(t273-1)
     #*t9*t178-128.D0/3.D0*t683)*s3l1-128.D0/3.D0*t687+128.D0/3.D0*t646*
     #t1*t731*t252)*s23r+(128.D0/3.D0*t226*t49+(-t215-128.D0/3.D0*t103)*
     #t112+(-128.D0/3.D0*t226*t15-64.D0/3.D0*t220*t805*t276)*s34r)*s2l1
      s7 = s9+((-t231-128.D0/3.D0*t153)*t112+(-128.D0/3.D0*t226*t24-64.D
     #0/3.D0*t220*t805*t251)*s34r)*s2l2+((-128.D0/3.D0*t101-256.D0/3.D0*
     #t103)*s3l1-256.D0/3.D0*t243-64.D0/3.D0*t295)*t112+((-128.D0/3.D0*t
     #271-64.D0/3.D0*t220*t19)*s3l1-64.D0/3.D0*t220*t179-t254)*s34r
      s8 = s13r
      s6 = s7*s8
      s4 = s5+s6
      s2 = s3+s4
      s4 = s2
      s7 = ((-256.D0/3.D0*t845*t355-128.D0/3.D0*t848*t11*s23r)*t77+(256.
     #D0/3.D0*t845*t367+(256.D0/3.D0*t857*t203-128.D0/3.D0*t860*t862)*t9
     #8+256.D0/3.D0*t350*t361)*s1vr+256.D0/3.D0*t349*t367+128.D0/3.D0*t3
     #49*t1*t207*t371-128.D0/3.D0*t359*t377)*s1l2+((-128.D0/3.D0*t845*t1
     #2-64.D0/3.D0*t883-128.D0/3.D0*t885)*t98+(-64.D0/3.D0*t848*t12-256.
     #D0/3.D0*t891-64.D0/3.D0*t848*t19)*s23r)*t77+((64.D0/3.D0*t883+64.D
     #0/3.D0*t885)*t366+(-256.D0/3.D0*t349*t12+(64.D0/3.D0*t857*t15+64.D
     #0/3.D0*t857*t19)*s34r+64.D0/3.D0*t910*t15+64.D0/3.D0*t913*t19)*t98
     #+(t925*s2l2+(448.D0/3.D0*t384+256.D0/3.D0*t386)*s34r+t934-64.D0/3.
     #D0*t935*t19)*s23r+64.D0/3.D0*t391*t49-64.D0/3.D0*t391*t90)*s1vr+(6
     #4.D0/3.D0*t946*t15+64.D0/3.D0*t948*t19)*t366
      s6 = s7+(-128.D0/3.D0*t953*t12+(64.D0/3.D0*t350*t957*t178-64.D0/3.
     #D0*t350*t921*t276)*s34r-t934-64.D0/3.D0*t966*t19)*t98+(64*t419*t49
     #+(-128.D0/3.D0*t413-64.D0/3.D0*t414)*t112+(-64.D0/3.D0*t979*t604-6
     #4.D0/3.D0*t982*t609)*s34r)*s23r-64.D0/3.D0*t71*t114-64.D0/3.D0*t71
     #*t307
      s7 = s1l1
      s5 = s6*s7
      s3 = s4+s5
      s4 = s3
      s6 = (((-128.D0/3.D0*t845*t123-64.D0/3.D0*t997-128.D0/3.D0*t999)*t
     #98+(-64.D0/3.D0*t848*t123-256.D0/3.D0*t848*t24-64.D0/3.D0*t848*t27
     #)*s23r)*t77+((64.D0/3.D0*t997+64.D0/3.D0*t999)*t366+(-256.D0/3.D0*
     #t349*t123+(64.D0/3.D0*t857*t24+64.D0/3.D0*t857*t27)*s34r+64.D0/3.D
     #0*t910*t24+64.D0/3.D0*t913*t27)*t98+(t925*s2l1+(448.D0/3.D0*t485+2
     #56.D0/3.D0*t487)*s34r+t1035-64.D0/3.D0*t935*t27)*s23r+64.D0/3.D0*t
     #391*t137-64.D0/3.D0*t391*t141)*s1vr+(64.D0/3.D0*t946*t24+64.D0/3.D
     #0*t948*t27)*t366+(-128.D0/3.D0*t953*t123+(64.D0/3.D0*t350*t957*t17
     #4-64.D0/3.D0*t350*t921*t251)*s34r-t1035-64.D0/3.D0*t966*t27)*t98+(
     #64*t419*t137+(-128.D0/3.D0*t503-64.D0/3.D0*t504)*t112+(-64.D0/3.D0
     #*t979*t616-64.D0/3.D0*t982*t619)*s34r)*s23r-64.D0/3.D0*t71*t160-64
     #.D0/3.D0*t71*t324)*s1l2
      s7 = ((-64.D0/3.D0*t1083*t1084-64.D0/3.D0*t1083*t1087-128.D0/3.D0*
     #t1083*t1090-128.D0/3.D0*t1083*t1093)*t98+(-128.D0/3.D0*t1098*t1084
     #-128.D0/3.D0*t1098*t1087-128.D0/3.D0*t1098*t1090-128.D0/3.D0*t1098
     #*t1093+64.D0/3.D0*t566*t862)*s23r+64.D0/3.D0*t1111*t1084+64.D0/3.D
     #0*t1111*t1087+(-256.D0/3.D0*t920*t15+64.D0/3.D0*t920*t19)*s3l1+64.
     #D0/3.D0*t1111*t1093)*t77
      s5 = s6+s7
      s1 = s4+s5
      s3 = s1+((64.D0/3.D0*t1127*t1129+64.D0/3.D0*t1127*t1133+(128.D0/3.
     #D0*t891-128.D0/3.D0*t1136*t19)*s3l1-128.D0/3.D0*t1136*t179-128.D0/
     #3.D0*t1098*t1144)*t98+((t590*s34r+t934)*s2l1+(t594*s34r+t1035)*s2l
     #2+((t385+t400)*s3l1+128*t564+64.D0/3.D0*t568)*s34r+(128.D0/3.D0*t9
     #20*t310*t15+64.D0/3.D0*t1164*t19)*s3l1+64.D0/3.D0*t1164*t179-64.D0
     #/3.D0*t935*t922)*s23r-64.D0/3.D0*t1176*t1129-64.D0/3.D0*t1176*t113
     #3+((t707-t575)*s3l1-64.D0/3.D0*t391*t179-t585)*s34r+(-256.D0/3.D0*
     #t1175*t4*t15-64.D0/3.D0*t1176*t19)*s3l1-64.D0/3.D0*t1176*t179)*s1v
     #r
      s2 = s3+(64.D0/3.D0*t1199*t1129+64.D0/3.D0*t1199*t1133+(-128.D0/3.
     #D0*t920*t647*t15-128.D0/3.D0*t1207*t19)*s3l1-128.D0/3.D0*t1207*t17
     #9-128.D0/3.D0*t977*t9*t1144)*t98+(((64.D0/3.D0*t391*t1220*t178+64.
     #D0/3.D0*t708)*s34r-64.D0/3.D0*t1226*t15)*s2l1+((64.D0/3.D0*t391*t1
     #220*t174+64.D0/3.D0*t419*t27)*s34r-64.D0/3.D0*t1226*t24)*s2l2+((-1
     #28.D0/3.D0*t445-128.D0/3.D0*t977*t931*t609)*s3l1-128.D0/3.D0*t977*
     #t931*t1*t179+(128.D0/3.D0*t714+64.D0/3.D0*t717)*t10)*s34r+(128.D0/
     #3.D0*t1175*(t739-1)*t15+64.D0/3.D0*t646*t19)*s3l1+64.D0/3.D0*t646*
     #t9*t1093)*s23r
      taux7 = s2+64.D0/3.D0*t257*t112*s2l1+64.D0/3.D0*t260*t112*s2l2+(t2
     #58*s3l1-t181-64.D0/3.D0*t199)*t112+((128.D0/3.D0*t219*t1*t15+64.D0
     #/3.D0*t646*t1282*t609)*s3l1+64.D0/3.D0*t646*t1282*t1*t179)*s34r
      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = -1+z
      t5 = t4**2
      t6 = t5**2
      t8 = t3*t6*l3
      t9 = 1/s4vr
      t10 = 1/s3vr
      t11 = t9*t10
      t12 = t11*s3l2
      t14 = t9*s4l2
      t15 = t14*t10
      t17 = t8*t12-t8*t15
      t20 = t11*s3l1
      t22 = t9*s4l1
      t23 = t22*t10
      t25 = -t8*t20+t8*t23
      t38 = t2**2
      t39 = t6*t4
      t41 = t38*t39*l3
      t55 = s13r**2
      t58 = t2*t6
      t59 = l3**2
      t60 = t58*t59
      t61 = t11*s2l2
      t62 = t60*t61
      t64 = t60*t12
      t65 = 256.D0/3.D0*t64
      t67 = s1vr**2
      t70 = 256*t64
      t71 = t60*t15
      t76 = t3*t39*t59
      t77 = s34r*s2l2
      t78 = t11*t77
      t80 = 1024.D0/3.D0*t76*t78
      t82 = t11*s3l2*s34r
      t87 = -t64+t71
      t88 = 512.D0/3.D0*t87
      t89 = s23r**2
      t91 = t76*t12
      t93 = t76*t15
      t99 = t6*t5
      t101 = t38*t99*t59
      t102 = s34r**2
      t104 = t11*t102*s2l2
      t113 = t11*s2l1
      t114 = t60*t113
      t116 = t60*t20
      t117 = 256.D0/3.D0*t116
      t121 = 256*t116
      t122 = t60*t23
      t126 = s34r*s2l1
      t127 = t11*t126
      t129 = 1024.D0/3.D0*t76*t127
      t131 = t11*s3l1*s34r
      t136 = t116-t122
      t137 = 512.D0/3.D0*t136
      t139 = t76*t20
      t141 = t76*t23
      t148 = t11*t102*s2l1
      t163 = t10*s3l1
      t164 = t14*t163
      t165 = t60*t164
      t167 = t10*s3l2
      t168 = t22*t167
      t169 = t60*t168
      t181 = 2048.D0/3.D0*t165
      t182 = 2048.D0/3.D0*t169
      t185 = 256.D0/3.D0*t91
      t187 = t185-256*t93
      t189 = t5*t4
      t190 = l3*t189
      t191 = t190*t2
      t192 = -z+2
      t193 = t192*t9
      t197 = t58*l3
      t202 = 256.D0/3.D0*t139
      t204 = -t202+256*t141
      t215 = -t76*t164+t76*t168
      t216 = 1024.D0/3.D0*t215
      t226 = 3*z
      t227 = -t226+4
      t228 = t227*t9
      t232 = t226-2
      t233 = t232*t9
      t234 = s4l2*t10
      t245 = s4l1*t10
      t256 = t10*t102
      t260 = -z+3
      t261 = t260*t9
      t264 = -t192
      t266 = l3*t264*t6
      t267 = t3*t9
      t294 = t59*l3
      t295 = t294*t6
      t296 = t295*t1
      t297 = t296*t12
      t298 = t296*t15
      t300 = -512.D0/3.D0*t297+512.D0/3.D0*t298
      t302 = t1*t189
      t303 = t302*t59
      t306 = t303*t12
      t316 = t294*t39
      t317 = t316*t2
      t318 = t317*t12
      t319 = t317*t15
      t320 = t318-t319
      t321 = 256*t320
      t323 = t59*t189
      t325 = t323*(-z-3)
      t326 = t1*t9
      t327 = t326*t167
      t330 = t323*t260
      t331 = t326*t234
      t338 = t10*s34r
      t344 = t89*s23r
      t347 = t6*t1*t59
      t353 = t323*(z+2)
      t356 = t323*t192
      t362 = t294*t99*t3
      t369 = t59*z*t6
      t370 = t2*t9
      t371 = t370*t167
      t374 = (-z+6)*t9
      t389 = t296*t20
      t390 = t296*t23
      t392 = 512.D0/3.D0*t389-512.D0/3.D0*t390
      t396 = t303*t20
      t406 = t317*t20
      t407 = t317*t23
      t408 = -t406+t407
      t409 = 256*t408
      t411 = t326*t163
      t414 = t326*t245
      t442 = t370*t163
      t460 = t296*t164
      t462 = t296*t168
      t476 = 256*t297
      t478 = t476-256.D0/3.D0*t298
      t480 = 256*t389
      t482 = -t480+256.D0/3.D0*t390
      t491 = t323*(-t226+6)
      t495 = -t323*t232
      t513 = t347*t164
      t515 = t347*t168
      t522 = t190*t1
      t525 = l3*t5
      t526 = t525*z
      t540 = -t165+t169
      t543 = t525*t1
      t544 = t543*t164
      t546 = t543*t168
      t550 = -t227
      t551 = t323*t550
      t553 = z*t9
      t554 = t553*t234
      t560 = t553*t245
      t570 = (-5+z)*t9
      t573 = -t260
      t574 = t59*t573
      t581 = z**2
      t583 = -t581+4*z-2
      t584 = t525*t583
      t587 = 2*z
      t589 = t525*(-t581+t587)
      t608 = t574*t58
      t621 = t587-3
      t623 = l3*t621*t189
      t652 = t59**2
      t653 = t652*t6
      t656 = t653*t12
      t658 = t653*t15
      t662 = t294*t189
      t668 = t5*t59
      t679 = t652*t39*t1
      t685 = t662*t264
      t688 = t662*t550
      t696 = -t4
      t701 = -256*t296*t11*s34r-256.D0/3.D0*t668*t696*t9*t10
      t706 = t668*t260
      t709 = t668*t696
      t718 = t662*t192
      t720 = t662*z
      t725 = t59*t6
      t729 = t295*(-z+4)
      t731 = t316*t1
      t736 = t668*t192
      t739 = t668*t583
      t764 = t653*t20
      t766 = t653*t23
      t846 = t653*t9
      t847 = t167*s2l1
      t850 = t163*s2l2
      t853 = t234*s3l1
      t856 = t245*s3l2
      t861 = t662*t9
      t869 = t668*t9
      t877 = -t662*t621
      t879 = t11*s3l2*s2l1
      t883 = t11*s3l1*s2l2
      t887 = t294*t621*t189
      t895 = t668*t232
      t909 = t668*(1+t587)
      t916 = t323*t326
      t929 = z*l3*t4
      t941 = t668*(-t581+t226-1)
      t949 = 3*t323*t696
      t951 = t323*t696
      t970 = t302*t59*t232
      t976 = t525*t9
      t999 = t525*z*t1
      s3 = ((256.D0/3.D0*t17*s2l1+256.D0/3.D0*t25*s2l2)*s1vr+(-512.D0/3.
     #D0*t17*s2l1-512.D0/3.D0*t25*s2l2)*s23r+(-256.D0/3.D0*t41*t12+256.D
     #0/3.D0*t41*t15)*s34r*s2l1+(256.D0/3.D0*t41*t20-256.D0/3.D0*t41*t23
     #)*s34r*s2l2)*t55*s13r
      s7 = ((-512.D0/3.D0*t62-t65)*t67+((1024.D0/3.D0*t62+t70-256.D0/3.D
     #0*t71)*s23r+t80+512.D0/3.D0*t76*t82)*s1vr+t88*t89+(-t80+(-256*t91+
     #256.D0/3.D0*t93)*s34r)*s23r-512.D0/3.D0*t101*t104-256.D0/3.D0*t101
     #*t11*s3l2*t102)*s1l1+((512.D0/3.D0*t114+t117)*t67+((-1024.D0/3.D0*
     #t114-t121+256.D0/3.D0*t122)*s23r-t129-512.D0/3.D0*t76*t131)*s1vr+t
     #137*t89+(t129+(256*t139-256.D0/3.D0*t141)*s34r)*s23r+512.D0/3.D0*t
     #101*t148+256.D0/3.D0*t101*t11*s3l1*t102)*s1l2+((-t65+512.D0/3.D0*t
     #71)*s2l1+(t117-512.D0/3.D0*t122)*s2l2+512.D0/3.D0*t165-512.D0/3.D0
     #*t169)*t67+(((1024.D0/3.D0*t64-512*t71)*s2l1+(-1024.D0/3.D0*t116+5
     #12*t122)*s2l2-t181+t182)*s23r+(t187*s34r+256.D0/3.D0*t191*t193*t16
     #7+256.D0/3.D0*t197*t15)*s2l1+(t204*s34r-256.D0/3.D0*t191*t193*t163
     #-256.D0/3.D0*t197*t23)*s2l2+t216*s34r)*s1vr
      s6 = s7+(t88*s2l1+t137*s2l2+t181-t182)*t89+((-t187*s34r-256.D0/3.D
     #0*t191*t228*t167-256.D0/3.D0*t191*t233*t234)*s2l1+(-t204*s34r+256.
     #D0/3.D0*t191*t228*t163+256.D0/3.D0*t191*t233*t245)*s2l2-2048.D0/3.
     #D0*t215*s34r)*s23r+(256.D0/3.D0*t101*t14*t256+(-256.D0/3.D0*t8*t26
     #1*t167-256.D0/3.D0*t266*t267*t234)*s34r)*s2l1+(-256.D0/3.D0*t101*t
     #22*t256+(256.D0/3.D0*t8*t261*t163+256.D0/3.D0*t266*t267*t245)*s34r
     #)*s2l2+(512.D0/3.D0*t101*t164-512.D0/3.D0*t101*t168)*t102
      s7 = t55
      s5 = s6*s7
      s10 = ((t300*s23r-256.D0/3.D0*t303*t61+256.D0/3.D0*t306)*t67+((-10
     #24.D0/3.D0*t296*t61+1024.D0/3.D0*t297-512*t298)*t89+(t321*s34r+256
     #.D0/3.D0*t325*t327-256.D0/3.D0*t330*t331)*s23r+1024.D0/3.D0*t60*t7
     #8-256.D0/3.D0*t60*t14*t338)*s1vr+t300*t344+(-1024.D0/3.D0*t347*t61
     #-t321*s34r+256.D0/3.D0*t353*t327+256*t356*t331)*t89+((-256.D0/3.D0
     #*t362*t12+256.D0/3.D0*t362*t15)*t102+(256.D0/3.D0*t369*t371+256.D0
     #/3.D0*t60*t374*t234)*s34r)*s23r-256*t76*t104+(-256.D0/3.D0*t91+256
     #.D0/3.D0*t93)*t102)*s1l1
      s11 = ((t392*s23r+256.D0/3.D0*t303*t113-256.D0/3.D0*t396)*t67+((10
     #24.D0/3.D0*t296*t113-1024.D0/3.D0*t389+512*t390)*t89+(t409*s34r-25
     #6.D0/3.D0*t325*t411+256.D0/3.D0*t330*t414)*s23r-1024.D0/3.D0*t60*t
     #127+256.D0/3.D0*t60*t22*t338)*s1vr+t392*t344+(1024.D0/3.D0*t347*t1
     #13-t409*s34r-256.D0/3.D0*t353*t411-256*t356*t414)*t89+((256.D0/3.D
     #0*t362*t20-256.D0/3.D0*t362*t23)*t102+(-256.D0/3.D0*t369*t442-256.
     #D0/3.D0*t60*t374*t245)*s34r)*s23r+256*t76*t148+(256.D0/3.D0*t139-2
     #56.D0/3.D0*t141)*t102)*s1l2
      s9 = s10+s11
      s8 = s9+((t300*s2l1+t392*s2l2+1024.D0/3.D0*t460-1024.D0/3.D0*t462)
     #*s23r+(-256.D0/3.D0*t306+256.D0/3.D0*t303*t15)*s2l1+(256.D0/3.D0*t
     #396-256.D0/3.D0*t303*t23)*s2l2)*t67+((t478*s2l1+t482*s2l2-2048.D0/
     #3.D0*t460+2048.D0/3.D0*t462)*t89+((256.D0/3.D0*t320*s34r+256.D0/3.
     #D0*t491*t327-256.D0/3.D0*t495*t331)*s2l1+(256.D0/3.D0*t408*s34r-25
     #6.D0/3.D0*t491*t411+256.D0/3.D0*t495*t414)*s2l2+(-1024.D0/3.D0*t31
     #7*t164+1024.D0/3.D0*t317*t168)*s34r+1024.D0/3.D0*t513-1024.D0/3.D0
     #*t515)*s23r+((t70-1024.D0/3.D0*t71)*s34r-256.D0/3.D0*t522*t12+256.
     #D0/3.D0*t526*t331)*s2l1+((-t121+1024.D0/3.D0*t122)*s34r+256.D0/3.D
     #0*t522*t20-256.D0/3.D0*t526*t414)*s2l2+1024.D0/3.D0*t540*s34r+256.
     #D0/3.D0*t544-256.D0/3.D0*t546)*s1vr+((256.D0/3.D0*t551*t327-256.D0
     #/3.D0*t303*t554)*s2l1+(-256.D0/3.D0*t551*t411+256.D0/3.D0*t303*t56
     #0)*s2l2-2048.D0/3.D0*t513+2048.D0/3.D0*t515)*t89
      s7 = s8+(((256.D0/3.D0*t60*t570*t167-256.D0/3.D0*t574*t6*t370*t234
     #)*s34r+256.D0/3.D0*t584*t327-256.D0/3.D0*t589*t331)*s2l1+((-256.D0
     #/3.D0*t60*t570*t163+256.D0/3.D0*t60*t573*t9*t245)*s34r-256.D0/3.D0
     #*t584*t411+256.D0/3.D0*t589*t414)*s2l2+(-1024.D0/3.D0*t608*t164+10
     #24.D0/3.D0*t608*t168)*s34r-512.D0/3.D0*t544+512.D0/3.D0*t546)*s23r
     #+((-t185+512.D0/3.D0*t93)*t102+(256.D0/3.D0*t623*t371-512.D0/3.D0*
     #t191*t554)*s34r)*s2l1+((t202-512.D0/3.D0*t141)*t102+(-256.D0/3.D0*
     #t623*t442+512.D0/3.D0*t191*t560)*s34r)*s2l2-t216*t102+(-256.D0/3.D
     #0*t191*t164+256.D0/3.D0*t191*t168)*s34r
      s8 = s13r
      s6 = s7*s8
      s4 = s5+s6
      s2 = s3+s4
      s3 = s2+(((512.D0/3.D0*t653*t61-256.D0/3.D0*t656+512.D0/3.D0*t658)
     #*t89+(256.D0/3.D0*t662*t61+256.D0/3.D0*t662*t15)*s23r+256.D0/3.D0*
     #t668*t12)*t67+((256.D0/3.D0*t656-256.D0/3.D0*t658)*t344+(1024.D0/3
     #.D0*t295*t61+(256.D0/3.D0*t679*t12-256.D0/3.D0*t679*t15)*s34r-256.
     #D0/3.D0*t685*t12+256.D0/3.D0*t688*t15)*t89+(t701*s2l2+(t476-1024.D
     #0/3.D0*t298)*s34r-256.D0/3.D0*t706*t12-256.D0/3.D0*t709*t15)*s23r-
     #256*t303*t82)*s1vr+(-256.D0/3.D0*t718*t12-256.D0/3.D0*t720*t15)*t3
     #44+(512.D0/3.D0*t725*t61+(-256.D0/3.D0*t729*t327-256.D0/3.D0*t731*
     #t15)*s34r+256.D0/3.D0*t736*t12-256.D0/3.D0*t739*t15)*t89+(-256*t34
     #7*t78+(-512.D0/3.D0*t318+256.D0/3.D0*t319)*t102+(256*t306-256.D0/3
     #.D0*t551*t331)*s34r)*s23r+(256.D0/3.D0*t64+256.D0/3.D0*t71)*t102)*
     #s1l1
      s4 = s3
      s6 = (((-512.D0/3.D0*t653*t113+256.D0/3.D0*t764-512.D0/3.D0*t766)*
     #t89+(-256.D0/3.D0*t662*t113-256.D0/3.D0*t662*t23)*s23r-256.D0/3.D0
     #*t668*t20)*t67+((-256.D0/3.D0*t764+256.D0/3.D0*t766)*t344+(-1024.D
     #0/3.D0*t295*t113+(-256.D0/3.D0*t679*t20+256.D0/3.D0*t679*t23)*s34r
     #+256.D0/3.D0*t685*t20-256.D0/3.D0*t688*t23)*t89+(-t701*s2l1+(-t480
     #+1024.D0/3.D0*t390)*s34r+256.D0/3.D0*t706*t20+256.D0/3.D0*t709*t23
     #)*s23r+256*t303*t131)*s1vr+(256.D0/3.D0*t718*t20+256.D0/3.D0*t720*
     #t23)*t344+(-512.D0/3.D0*t725*t113+(256.D0/3.D0*t729*t411+256.D0/3.
     #D0*t731*t23)*s34r-256.D0/3.D0*t736*t20+256.D0/3.D0*t739*t23)*t89+(
     #256*t347*t127+(512.D0/3.D0*t406-256.D0/3.D0*t407)*t102+(-256*t396+
     #256.D0/3.D0*t551*t414)*s34r)*s23r+(-256.D0/3.D0*t116-256.D0/3.D0*t
     #122)*t102)*s1l2
      s7 = ((-256.D0/3.D0*t846*t847+256.D0/3.D0*t846*t850+512.D0/3.D0*t8
     #46*t853-512.D0/3.D0*t846*t856)*t89+(-512.D0/3.D0*t861*t847+512.D0/
     #3.D0*t861*t850+512.D0/3.D0*t861*t853-512.D0/3.D0*t861*t856)*s23r-2
     #56.D0/3.D0*t869*t853+256.D0/3.D0*t869*t856)*t67
      s5 = s6+s7
      s1 = s4+s5
      s2 = s1+((256.D0/3.D0*t877*t879-256.D0/3.D0*t877*t883+512.D0/3.D0*
     #t887*t164-512.D0/3.D0*t887*t168)*t89+((t478*s34r-256.D0/3.D0*t895*
     #t12)*s2l1+(t482*s34r+256.D0/3.D0*t895*t20)*s2l2+(-512*t460+512*t46
     #2)*s34r+256.D0/3.D0*t909*t164-256.D0/3.D0*t909*t168)*s23r+256.D0/3
     #.D0*t916*t167*t126-256.D0/3.D0*t916*t163*t77+(256.D0/3.D0*t303*t16
     #4-256.D0/3.D0*t303*t168)*s34r-256.D0/3.D0*t929*t164+256.D0/3.D0*t9
     #29*t168)*s1vr+(256.D0/3.D0*t356*t879-256.D0/3.D0*t356*t883-512.D0/
     #3.D0*t941*t164+512.D0/3.D0*t941*t168)*t89+(((-256.D0/3.D0*t949*t32
     #7+256.D0/3.D0*t951*t331)*s34r-256.D0/3.D0*t526*t12)*s2l1+((256.D0/
     #3.D0*t949*t411-256.D0/3.D0*t951*t414)*s34r+256.D0/3.D0*t526*t20)*s
     #2l2+(-512.D0/3.D0*t970*t164+512.D0/3.D0*t970*t168)*s34r+256.D0/3.D
     #0*t976*t853-256.D0/3.D0*t976*t856)*s23r
      taux8 = s2+(256.D0/3.D0*t87*t102+256.D0/3.D0*t522*t82)*s2l1+(256.D
     #0/3.D0*t136*t102-256.D0/3.D0*t522*t131)*s2l2-512.D0/3.D0*t540*t102
     #+(256.D0/3.D0*t999*t164-256.D0/3.D0*t999*t168)*s34r

CCC Coefficients

      tcoff11 = taux7
      tcoff12 = taux7
      tcoff13 = taux8
      tcoff14 = taux8

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet11 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff11)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet12 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff12)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet13 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff13)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet14 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff14)

CCC Sum

      ggrmnum3e0 = tFjet11*tcoff11+tFjet12*tcoff12+tFjet13*tcoff13+tFjet
     #14*tcoff14
      RETURN
      END

      double precision function ggrmnum3e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = -1+z
      t5 = t4**2
      t6 = t5**2
      t7 = t6*t4
      t8 = t3*t7
      t9 = t8*z
      t10 = l3**2
      t11 = 1/s4vr
      t12 = t10*t11
      t13 = 1/s3vr
      t14 = s1vr**2
      t19 = t13*s23r
      t22 = t2**2
      t23 = t6*t5
      t24 = t22*t23
      t26 = t13*s34r
      t32 = z*t10
      t33 = t24*t32
      t34 = t11*t13
      t36 = t34*s34r*s23r
      t39 = t22*t1
      t40 = t5*t4
      t41 = t6*t40
      t44 = s34r**2
      t45 = t13*t44
      t50 = s13r**2
      t54 = t2*t40*l3
      t55 = t34*s3l2
      t57 = t11*s4l2
      t58 = t57*t13
      t59 = t54*t58
      t60 = -t54*t55+t59
      t61 = 64.D0/3.D0*t60
      t66 = t3*t6
      t67 = t66*l3
      t75 = t34*s3l1
      t77 = t11*s4l1
      t78 = t77*t13
      t79 = t54*t78
      t80 = -t54*t75+t79
      t81 = 64.D0/3.D0*t80
      t93 = t10*l3
      t95 = t93*t7*z
      t96 = t2*t11
      t97 = t14*s1vr
      t98 = t13*t97
      t105 = t3*t23
      t106 = t105*t93
      t107 = z*t11
      t108 = t107*t26
      t109 = t106*t108
      t112 = t96*t13
      t117 = t32*t6
      t118 = -z+5
      t126 = t34*s3l2*s2l1
      t130 = t34*s3l1*s2l2
      t133 = -2+z
      t136 = t3*t11
      t142 = z+1
      t148 = s23r**2
      t156 = t107*t45
      t159 = t32*t8
      t167 = t34*s2l2
      t171 = t34*s3l2*s34r
      t178 = t13*s3l1
      t179 = s34r*s2l2
      t183 = t6**2
      t187 = t13*t44*s34r
      t188 = t107*t187
      t191 = -z+3
      t196 = (t61*s1vr-128.D0/3.D0*t60*s23r+(64.D0/3.D0*t67*t55-64.D0/3.
     #D0*t67*t58)*s34r)*s1l1+(t81*s1vr-128.D0/3.D0*t80*s23r+(64.D0/3.D0*
     #t67*t75-64.D0/3.D0*t67*t78)*s34r)*s1l2-128.D0/3.D0*t95*t96*t98+(12
     #8*t95*t96*t19+64*t109-64.D0/3.D0*t32*t7*t112)*t14+((-128.D0/3.D0*t
     #109-128.D0/3.D0*t117*t2*t118*t34)*s23r-64.D0/3.D0*t54*t126-64.D0/3
     #.D0*t54*t130+128.D0/3.D0*t32*t133*t7*t136*t26)*s1vr+(-256.D0/3.D0*
     #t109+256.D0/3.D0*t117*t2*t142*t34)*t148+(-t61*s2l1-t81*s2l2-256.D0
     #/3.D0*t22*t41*t93*t156+128.D0/3.D0*t159*t118*t11*t26)*s23r+(-128.D
     #0/3.D0*t5*t2*t167+64.D0/3.D0*t67*t171)*s2l1+64.D0/3.D0*t66*l3*t11*
     #t178*t179-64.D0/3.D0*t39*t183*t93*t188+64.D0/3.D0*t33*t191*t11*t45
      t198 = t10*t6
      t199 = t198*t2
      t207 = t34*t44
      t208 = t8*t10*t207
      t212 = t10*t40
      t213 = t212*t1
      t221 = t34*s34r
      t223 = l3*t5
      t224 = t1*t11
      t225 = t224*t13
      t227 = t199*t221+t223*t225
      t228 = 64.D0/3.D0*t227
      t231 = 64.D0/3.D0*t199*t171
      t233 = l3*t40*t1
      t234 = t233*t55
      t235 = 64.D0/3.D0*t234
      t238 = t213*t55
      t239 = t213*t58
      t240 = -t238+t239
      t244 = -128.D0/3.D0*t227
      t248 = -t199*t55+t199*t58
      t258 = -64.D0/3.D0*t208-64.D0/3.D0*t54*t221
      t260 = l3*t133
      t261 = t260*t40
      t262 = t13*s3l2
      t279 = t34*s3l1*s34r
      t281 = 64.D0/3.D0*t199*t279
      t282 = t233*t75
      t283 = 64.D0/3.D0*t282
      t287 = t213*t78
      t288 = -t213*t75+t287
      t294 = -t199*t75+t199*t78
      t310 = t93*t6
      t311 = t310*z
      t315 = t10**2
      t316 = t315*t7
      t317 = t316*t1
      t323 = t315*t23*t2
      t324 = t323*t108
      t334 = t2*t7
      t335 = t334*t93
      t338 = t32*t40
      t339 = -t133
      t343 = 64.D0/3.D0*t338*t339*t1*t34
      t346 = t148*s23r
      t347 = t13*t346
      t352 = 5*z
      t364 = t93*z
      t365 = t364*t334
      t366 = 2*z
      t379 = t223*t1
      t382 = t379*t58
      t386 = t379*t78
      t395 = t6*t2
      t396 = t32*t395
      t397 = t339*t11
      t398 = t397*t26
      t402 = t34*s3l2*s3l1
      t404 = 128.D0/3.D0*t379*t402
      t405 = z*l3
      t408 = 64.D0/3.D0*t405*t5*t225
      t413 = -t4
      t415 = t413*t11*t347
      t435 = t223*t142
      t436 = t224*t262
      t439 = t223*t191
      t448 = t224*t178
      t451 = s4l1*t13
      t463 = 3*z
      t469 = t57*s4l1
      t471 = t5*t1
      t481 = t395*l3
      t487 = t4*t1
      s2 = ((128.D0/3.D0*t199*t34*s34r*s1vr-256.D0/3.D0*t199*t36-128.D0/
     #3.D0*t208)*s1l2+64.D0/3.D0*t213*t34*s3l2*t14+(-128.D0/3.D0*t213*t5
     #7*t19+t228*s2l2-t231+t235)*s1vr+64*t240*t148+(t244*s2l2+64*t248*s3
     #4r-64*t234+64.D0/3.D0*t233*t58)*s23r+t258*s2l2+(-64.D0/3.D0*t261*t
     #96*t262-64.D0/3.D0*t59)*s34r)*s1l1+(64.D0/3.D0*t213*t34*s3l1*t14+(
     #-128.D0/3.D0*t213*t77*t19+t228*s2l1-t281+t283)*s1vr+64*t288*t148+(
     #t244*s2l1+64*t294*s34r-64*t282+64.D0/3.D0*t233*t78)*s23r+t258*s2l1
     #+(-64.D0/3.D0*t261*t96*t178-64.D0/3.D0*t79)*s34r)*s1l2-64.D0/3.D0*
     #t311*t224*t98
      s1 = s2+(-128*t317*t107*t13*t148+(-256.D0/3.D0*t324+640.D0/3.D0*t3
     #11*t225)*s23r+64.D0/3.D0*t213*t126+64.D0/3.D0*t213*t130+256.D0/3.D
     #0*t335*t108+t343)*t14+(256.D0/3.D0*t317*t107*t347+(640.D0/3.D0*t32
     #4-128.D0/3.D0*t311*(t352-1)*t1*t34)*t148+(256.D0/3.D0*t3*t41*t315*
     #t156-128.D0/3.D0*t365*(t366+3)*t11*t26-128.D0/3.D0*t338*(-t352+6)*
     #t1*t34)*s23r+(128.D0/3.D0*t379*t167-t231+t235+128.D0/3.D0*t382)*s2
     #l1+(-t281+t283+128.D0/3.D0*t386)*s2l2-64.D0/3.D0*t93*t23*z*t136*t4
     #5-128.D0/3.D0*t396*t398+t404-t408)*s1vr-256.D0/3.D0*t364*t6*t1*t41
     #5
      t521 = s1+(64.D0/3.D0*t240*s2l1+64.D0/3.D0*t288*s2l2-640.D0/3.D0*t
     #365*t413*t11*t26-256.D0/3.D0*t117*t142*t1*t34)*t148+((64.D0/3.D0*t
     #248*s34r-64.D0/3.D0*t435*t436-64.D0/3.D0*t439*t224*s4l2*t13)*s2l1+
     #(64.D0/3.D0*t294*s34r-64.D0/3.D0*t435*t448-64.D0/3.D0*t439*t224*t4
     #51)*s2l2-128.D0/3.D0*t364*t105*(-t366+4)*t11*t45+128.D0/3.D0*t396*
     #(-t463+4)*t11*t26-t404+(-128.D0/3.D0*t379*t469+128.D0/3.D0*t405*t4
     #71*t11)*t13)*s23r+(128.D0/3.D0*t471*t167+(-64.D0/3.D0*t481*t55-128
     #.D0/3.D0*t59)*s34r+64.D0/3.D0*t487*t55-64.D0/3.D0*t487*t58)*s2l1+(
     #(-64.D0/3.D0*t481*t75-128.D0/3.D0*t79)*s34r+64.D0/3.D0*t487*t75-64
     #.D0/3.D0*t487*t78)*s2l2-128.D0/3.D0*z*t22*t41*t93*t11*t187+64.D0/3
     #.D0*t159*t397*t45+(-128.D0/3.D0*t54*t402+64.D0/3.D0*t405*t40*t112)
     #*s34r
      t523 = t310*t1
      t524 = t523*t221
      t525 = t10*t5
      t526 = t525*t34
      t527 = -t524+t526
      t535 = t335*t207
      t541 = t199*t207
      t542 = 128.D0/3.D0*t541
      t545 = t93*t40
      t546 = t545*t11
      t549 = t525*t55
      t553 = t545*t55
      t554 = t545*t58
      t558 = 64.D0/3.D0*t527
      t560 = t523*t171
      t563 = t525*(-z+4)
      t564 = t563*t55
      t566 = t525*t58
      t570 = t34*t179
      t571 = t213*t570
      t573 = t213*t171
      t575 = l3*t4
      t576 = t575*t142
      t592 = -t463+5
      t593 = t525*t592
      t596 = 128.D0/3.D0*t566
      t605 = 128.D0/3.D0*t535+64.D0/3.D0*t198*t1*t221+64.D0/3.D0*t223*t3
     #4
      t608 = t34*s3l2*t44
      t612 = t212*(-t463+6)
      t617 = t405*t4
      t619 = -t191*t11
      t620 = t619*t262
      t632 = -t542-64.D0/3.D0*t379*(z+2)*t11*t26
      t634 = t199*t608
      t636 = t405*t471
      t647 = t545*t75
      t648 = t545*t78
      t653 = t523*t279
      t655 = t563*t75
      t657 = t525*t78
      t662 = t34*s34r*s2l1
      t665 = t213*t279
      t689 = t34*s3l1*t44
      t696 = t619*t178
      t704 = t199*t689
      t710 = t315*l3
      t712 = t710*t7*z
      t717 = t315*t6*z
      t728 = t224*t26
      t738 = t262*s2l1
      t740 = 64.D0/3.D0*t546*t738
      t741 = t178*s2l2
      t743 = 64.D0/3.D0*t546*t741
      t747 = t364*t40
      t755 = t525*t11
      t779 = z**2
      t806 = t451*s3l2
      t808 = 128.D0/3.D0*t755*t806
      t834 = t575*t133
      t848 = t212*t11
      t877 = 128.D0/3.D0*t239
      t905 = t77*t262
      t931 = t260*t5
      t932 = t931*t436
      t936 = t4*t11
      s2 = (128.D0/3.D0*t9*t12*t13*t14+(-256.D0/3.D0*t9*t12*t19-256.D0/3
     #.D0*t24*z*t12*t26)*s1vr+256.D0/3.D0*t33*t36+128.D0/3.D0*t39*t41*z*
     #t12*t45)*t50*s13r+t196*t50+t521*s13r+((128.D0/3.D0*t527*s23r*s1vr+
     #(256.D0/3.D0*t524-128.D0/3.D0*t526)*t148+(256.D0/3.D0*t535-128.D0/
     #3.D0*t213*t398)*s23r-t542)*s1l2+(-64.D0/3.D0*t546*t262*s23r-64.D0/
     #3.D0*t549)*t14+((64.D0/3.D0*t553+64.D0/3.D0*t554)*t148+(t558*s2l2+
     #64.D0/3.D0*t560+64.D0/3.D0*t564+64.D0/3.D0*t566)*s23r+64.D0/3.D0*t
     #571+64.D0/3.D0*t573+64.D0/3.D0*t576*t55)*s1vr+(64.D0/3.D0*t553-64.
     #D0/3.D0*t554)*t346+(128.D0/3.D0*t523*t570+(128.D0/3.D0*t523*t55-64
     #.D0/3.D0*t523*t58)*s34r-64.D0/3.D0*t593*t55-t596)*t148+(t605*s2l2+
     #64.D0/3.D0*t335*t608+(-64.D0/3.D0*t612*t436-64.D0/3.D0*t239)*s34r+
     #64.D0/3.D0*t617*t620+64.D0/3.D0*t576*t58)*s23r+t632*s2l2-64.D0/3.D
     #0*t634-128.D0/3.D0*t636*t171)*s1l1
      s3 = s2+((-64.D0/3.D0*t546*t178*s23r-64.D0/3.D0*t525*t75)*t14+((64
     #.D0/3.D0*t647+64.D0/3.D0*t648)*t148+(t558*s2l1+64.D0/3.D0*t653+64.
     #D0/3.D0*t655+64.D0/3.D0*t657)*s23r+64.D0/3.D0*t213*t662+64.D0/3.D0
     #*t665+64.D0/3.D0*t576*t75)*s1vr+(64.D0/3.D0*t647-64.D0/3.D0*t648)*
     #t346+(128.D0/3.D0*t523*t662+(128.D0/3.D0*t523*t75-64.D0/3.D0*t523*
     #t78)*s34r-64.D0/3.D0*t593*t75-128.D0/3.D0*t657)*t148+(t605*s2l1+64
     #.D0/3.D0*t335*t689+(-64.D0/3.D0*t612*t448-64.D0/3.D0*t287)*s34r+64
     #.D0/3.D0*t617*t696+64.D0/3.D0*t576*t78)*s23r+t632*s2l1-64.D0/3.D0*
     #t704-128.D0/3.D0*t636*t279)*s1l2+(128.D0/3.D0*t712*t34*t148+64.D0/
     #3.D0*t717*t34*s23r)*t97
      s4 = s3+(-128.D0/3.D0*t712*t34*t346+(-64*t710*t23*z*t728-64.D0/3.D
     #0*t717*(-t352+7)*t11*t13)*t148+(-t740-t743-320.D0/3.D0*t316*z*t728
     #-64.D0/3.D0*t747*(-t366+1)*t11*t13)*s23r-64.D0/3.D0*t755*t738-64.D
     #0/3.D0*t755*t741+64.D0/3.D0*t523*t108-256.D0/3.D0*t755*t262*s3l1)*
     #t14
      s1 = s4+(256.D0/3.D0*t717*t413*t11*t347+(t740+t743+128.D0/3.D0*t31
     #5*z*t7*t1*t592*t11*t26+128.D0/3.D0*t747*(2*t779-6*z+4)*t11*t13)*t1
     #48+((64.D0/3.D0*t560+64.D0/3.D0*t564-64.D0/3.D0*t566)*s2l1+(64.D0/
     #3.D0*t653+64.D0/3.D0*t655-64.D0/3.D0*t657)*s2l2+128*t323*t156+64.D
     #0/3.D0*t364*t6*(-8*z+7)*t728+(128*t549+t596)*s3l1+t808-64.D0/3.D0*
     #t32*t5*(-t779+z+1)*t11*t13)*s23r+(128.D0/3.D0*t571+64*t573-64.D0/3
     #.D0*t617*t55)*s2l1+(64*t665-64.D0/3.D0*t617*t75)*s2l2-64.D0/3.D0*t
     #335*t156+(128*t213*t402-t343)*s34r+(-128.D0/3.D0*t834*t55-64.D0/3.
     #D0*t575*t58)*s3l1-64.D0/3.D0*t575*t11*t806)*s1vr+128.D0/3.D0*t311*
     #t415
      s2 = s1+(64.D0/3.D0*t848*t738+64.D0/3.D0*t848*t741-64.D0/3.D0*t364
     #*t6*(3*t779-10*z+7)*t728+(-128.D0/3.D0*t549-128.D0/3.D0*t566)*s3l1
     #-t808+(-128.D0/3.D0*t525*t469+64.D0/3.D0*t32*t40*(t779-4*z+3)*t11)
     #*t13)*t148+(((64.D0/3.D0*t213*t620+t877)*s34r+64*t223*t55-64.D0/3.
     #D0*t223*t58)*s2l1+((64.D0/3.D0*t213*t696+128.D0/3.D0*t287)*s34r+64
     #*t223*t75-64.D0/3.D0*t223*t78)*s2l2-128*t365*t413*t11*t45+((-256.D
     #0/3.D0*t238-t877)*s3l1-128.D0/3.D0*t213*t905+64.D0/3.D0*t117*(-t46
     #3+2)*t1*t34)*s34r+128.D0/3.D0*t834*t402+(128.D0/3.D0*t575*t469-64.
     #D0/3.D0*t405*t5*t11)*t13)*s23r+((-128.D0/3.D0*t541+128.D0/3.D0*t23
     #3*t221)*s2l2-128.D0/3.D0*t634+(64.D0/3.D0*t932-64.D0/3.D0*t382)*s3
     #4r-64.D0/3.D0*t936*t262)*s2l1+(-128.D0/3.D0*t704+(64.D0/3.D0*t931*
     #t448-64.D0/3.D0*t386)*s34r-64.D0/3.D0*t936*t178)*s2l2
      taux7 = s2-64.D0/3.D0*t106*t188+(-128.D0/3.D0*t199*t402+64.D0/3.D0
     #*t117*t112)*t44+((128.D0/3.D0*t932+64.D0/3.D0*t382)*s3l1+64.D0/3.D
     #0*t379*t905+t408)*s34r+64.D0/3.D0*t57*t178+64.D0/3.D0*t905
      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = -1+z
      t5 = t4**2
      t6 = t5**2
      t8 = t3*t6*l3
      t9 = 1/s4vr
      t10 = 1/s3vr
      t11 = t9*t10
      t12 = t11*s3l2
      t14 = t9*s4l2
      t15 = t14*t10
      t17 = -t8*t12+t8*t15
      t20 = t11*s3l1
      t22 = t9*s4l1
      t23 = t22*t10
      t25 = t8*t20-t8*t23
      t38 = t2**2
      t39 = t6*t4
      t41 = t38*t39*l3
      t55 = s13r**2
      t58 = l3**2
      t59 = t58*t6
      t60 = t59*t2
      t61 = t11*s2l2
      t62 = t60*t61
      t64 = t60*t12
      t65 = 256*t64
      t67 = s1vr**2
      t71 = t60*t15
      t72 = 256*t71
      t76 = t3*t39*t58
      t78 = t11*s34r*s2l2
      t80 = 2048.D0/3.D0*t76*t78
      t82 = t11*s3l2*s34r
      t88 = 512*t64-512*t71
      t89 = s23r**2
      t91 = t76*t12
      t93 = t76*t15
      t94 = 256*t93
      t99 = t6*t5
      t101 = t38*t99*t58
      t102 = s34r**2
      t113 = t11*s2l1
      t114 = t60*t113
      t116 = t60*t20
      t117 = 256*t116
      t122 = t60*t23
      t123 = 256*t122
      t127 = t11*s34r*s2l1
      t129 = 2048.D0/3.D0*t76*t127
      t131 = t11*s3l1*s34r
      t137 = -512*t116+512*t122
      t139 = t76*t20
      t141 = t76*t23
      t142 = 256*t141
      t163 = t10*s3l1
      t164 = t14*t163
      t165 = t60*t164
      t167 = t10*s3l2
      t168 = t22*t167
      t169 = t60*t168
      t181 = 2048*t165
      t182 = 2048*t169
      t187 = -256*t91+768*t93
      t189 = t5*t4
      t190 = l3*t189
      t191 = t2*z
      t192 = t190*t191
      t193 = -z+2
      t194 = t2*t193
      t198 = (-t192+2*t190*t194)*t9
      t202 = t6*t2*l3
      t209 = 256*t139-768*t141
      t219 = t76*t164-t76*t168
      t220 = 1024*t219
      t230 = 3*z
      t231 = t230-2
      t233 = t190*t2*t231
      t234 = -t230+4
      t236 = t190*t2*t234
      t239 = (-t233+2*t236)*t9
      t244 = (-t236+2*t233)*t9
      t245 = s4l2*t10
      t254 = s4l1*t10
      t264 = t10*t102
      t265 = t14*t264
      t271 = -z+3
      t276 = (-l3*t39*t3+2*l3*t6*t3*t271)*t9
      t279 = -t193
      t281 = l3*t279*t6
      t282 = t3*t9
      t290 = t22*t264
      t309 = t58*l3
      t310 = t309*t6
      t311 = t310*t1
      t312 = t311*t12
      t313 = t311*t15
      t315 = 512*t312-512*t313
      t318 = t1*t189*t58
      t331 = t309*t39
      t332 = t331*t2
      t333 = t332*t12
      t334 = t332*t15
      t335 = -t333+t334
      t336 = 768*t335
      t338 = t58*t189
      t339 = z-4
      t345 = (-t338*t339+2*t338*(-z-3))*t1
      t349 = t338*(z+2)
      t353 = (-t349+2*t338*t271)*t1
      t358 = t11*s34r
      t361 = l3*t5
      t362 = t1*t9
      t366 = -1792.D0/3.D0*t60*t358+256.D0/3.D0*t361*t362*t10
      t369 = -512.D0/3.D0*t64+t72
      t371 = t361*t1
      t374 = t371*t15
      t378 = t89*s23r
      t381 = t6*t1*t58
      t386 = -t339
      t390 = (-t338*t386+2*t349)*t1
      t393 = t338*z
      t394 = t338*t193
      t397 = (-t393+2*t394)*t1
      t403 = t309*t99*t3
      t415 = (-t59*t2*(-z+7)+2*t59*t191)*t9
      t424 = (-t58*t39*t2+2*t59*t2*(6-z))*t9
      t434 = t190*t2
      t437 = 1280.D0/3.D0*t76*t11*t102-256*t434*t358
      t449 = t311*t20
      t450 = t311*t23
      t452 = -512*t449+512*t450
      t466 = t332*t20
      t467 = t332*t23
      t468 = t466-t467
      t469 = 768*t468
      t480 = 512.D0/3.D0*t116-t123
      t484 = t371*t23
      t525 = t311*t164
      t527 = t311*t168
      t542 = 256*t313
      t546 = 256*t450
      t561 = (-t338*(t230-1)+2*t338*(-t230+6))*t1
      t564 = t230-5
      t567 = -t338*t231
      t570 = (-t338*t564+2*t567)*t1
      t588 = t381*t164
      t590 = t381*t168
      t598 = -t271
      t602 = (-t361*t598+2*t190)*t1
      t605 = -t4
      t608 = 2*t361*z
      t610 = (-t361*t605+t608)*t1
      t625 = t165-t169
      t628 = t371*t164
      t630 = t371*t168
      t634 = -t234
      t636 = 2*t338*t634
      t638 = (-t567+t636)*t1
      t640 = t338*t279
      t643 = (-t640-2*t393)*t1
      t663 = (-t59*t194+2*t59*t2*(-5+z))*t9
      t666 = t59*t2*t598
      t669 = (t60-3*t666)*t9
      t674 = z**2
      t675 = 2*z
      t678 = 4*z
      t679 = -t674+t678-2
      t683 = (-t361*(-1+t674-t675)+2*t361*t679)*t1
      t692 = (-t361*(t674-t678+1)+2*t361*(-t674+t675))*t1
      t721 = t675-3
      t726 = (t434+2*t190*t2*t721)*t9
      t728 = -t675+1
      t733 = (-t190*t2*t728+4*t192)*t9
      t738 = t605**2
      t739 = t738*t1
      t770 = t58**2
      t771 = t770*t6
      t774 = t771*t12
      t776 = t771*t15
      t780 = t309*t189
      t785 = t780*t15
      t789 = t5*t58
      t800 = t770*t39*t1
      t810 = (-t780*t271+2*t780*t279)*t9
      t818 = (t780*t564+2*t780*t634)*t9
      t825 = t789*t605
      t831 = 1280.D0/3.D0*t311*t358+256.D0/3.D0*(-t789+2*t825)*t9*t10
      t838 = t789*(2-t678)
      t842 = (-t838+2*t789*t271)*t9
      t848 = (2*t789-3*t825)*t9
      t857 = z*l3
      t858 = t857*t4
      t863 = t780*z
      t864 = t780*t193
      t867 = (-t863+2*t864)*t9
      t871 = (-t864+2*t863)*t9
      t882 = (-t310*z+2*t310*t386)*t1
      t887 = (-t310*t271+2*t331)*t1
      t895 = (-t838+2*t789*t193)*t9
      t903 = (-t789*(-t230+t674)+2*t789*t679)*t9
      t912 = 1280.D0/3.D0*t381*t358-256.D0/3.D0*t361*t11
      t923 = (-t338*(4-5*z)+6*t338)*t1
      t927 = (3*t393+t636)*t1
      t932 = t4*l3
      t940 = l3*t1*t189
      t945 = z+1
      t946 = t361*t945
      t956 = t771*t20
      t958 = t771*t23
      t966 = t780*t23
      t1056 = t771*t9
      t1057 = t167*s2l1
      t1060 = t163*s2l2
      t1063 = t245*s3l1
      t1066 = t254*s3l2
      t1071 = t780*t9
      t1082 = t789*t9
      t1097 = (t780+3*t780*t721)*t9
      t1107 = t309*t721*t189
      t1117 = t789*z
      t1121 = (2*t1117+2*t789*t231)*t9
      t1140 = (2*t1117+2*t789*(1+t675))*t9
      t1147 = t932*t605
      t1163 = (-t1147+2*t858)*t9
      t1172 = (t338-3*t394)*t9
      t1183 = t674-t230+1
      t1189 = -3*t789*t1183*t9
      t1202 = (t338*t728+6*t338*t605)*t1
      t1207 = (-t640+2*t338*t605)*t1
      t1215 = (t361*t945+t608)*t9
      t1233 = (-t567+2*t338*t231)*t1*t9
      t1239 = t361*t9
      t1250 = t738*t9
      t1267 = t857*t5*t1
      t1273 = t4*t9
      s3 = ((256*t17*s2l1+256*t25*s2l2)*s1vr+(-512*t17*s2l1-512*t25*s2l2
     #)*s23r+(256*t41*t12-256*t41*t15)*s34r*s2l1+(-256*t41*t20+256*t41*t
     #23)*s34r*s2l2)*t55*s13r
      s7 = ((1024.D0/3.D0*t62+t65)*t67+((-2048.D0/3.D0*t62-768*t64+t72)*
     #s23r-t80-512*t76*t82)*s1vr+t88*t89+(t80+(768*t91-t94)*s34r)*s23r+1
     #024.D0/3.D0*t101*t11*t102*s2l2+256*t101*t11*s3l2*t102)*s1l1+((-102
     #4.D0/3.D0*t114-t117)*t67+((2048.D0/3.D0*t114+768*t116-t123)*s23r+t
     #129+512*t76*t131)*s1vr+t137*t89+(-t129+(-768*t139+t142)*s34r)*s23r
     #-1024.D0/3.D0*t101*t11*t102*s2l1-256*t101*t11*s3l1*t102)*s1l2+((t6
     #5-512*t71)*s2l1+(-t117+512*t122)*s2l2-512*t165+512*t169)*t67+(((-1
     #024*t64+1536*t71)*s2l1+(1024*t116-1536*t122)*s2l2+t181-t182)*s23r+
     #(t187*s34r-256.D0/3.D0*t198*t167-256*t202*t15)*s2l1+(t209*s34r+256
     #.D0/3.D0*t198*t163+256*t202*t23)*s2l2+t220*s34r)*s1vr
      s6 = s7+(t88*s2l1+t137*s2l2-t181+t182)*t89+((-t187*s34r+256.D0/3.D
     #0*t239*t167+256.D0/3.D0*t244*t245)*s2l1+(-t209*s34r-256.D0/3.D0*t2
     #39*t163-256.D0/3.D0*t244*t254)*s2l2-2048*t219*s34r)*s23r+(-256*t10
     #1*t265+(256.D0/3.D0*t276*t167+256*t281*t282*t245)*s34r)*s2l1+(256*
     #t101*t290+(-256.D0/3.D0*t276*t163-256*t281*t282*t254)*s34r)*s2l2+(
     #-512*t101*t164+512*t101*t168)*t102
      s7 = t55
      s5 = s6*s7
      s10 = ((t315*s23r+512.D0/3.D0*t318*t61-512.D0/3.D0*t318*t12)*t67+(
     #(2048.D0/3.D0*t311*t61-1024*t312+1536*t313)*t89+(t336*s34r-256.D0/
     #3.D0*t345*t12+256.D0/3.D0*t353*t15)*s23r+t366*s2l2+t369*s34r+256.D
     #0/3.D0*t371*t12+256.D0/3.D0*t374)*s1vr+t315*t378+(2048.D0/3.D0*t38
     #1*t61-t336*s34r-256.D0/3.D0*t390*t12-256*t397*t15)*t89+((256*t403*
     #t12-256*t403*t15)*t102+(-256.D0/3.D0*t415*t167-256.D0/3.D0*t424*t2
     #45)*s34r)*s23r+t437*s2l2+(1024.D0/3.D0*t91-t94)*t102+(-256.D0/3.D0
     #*t434*t12-256.D0/3.D0*t434*t15)*s34r)*s1l1
      s11 = ((t452*s23r-512.D0/3.D0*t318*t113+512.D0/3.D0*t318*t20)*t67+
     #((-2048.D0/3.D0*t311*t113+1024*t449-1536*t450)*t89+(t469*s34r+256.
     #D0/3.D0*t345*t20-256.D0/3.D0*t353*t23)*s23r-t366*s2l1+t480*s34r-25
     #6.D0/3.D0*t371*t20-256.D0/3.D0*t484)*s1vr+t452*t378+(-2048.D0/3.D0
     #*t381*t113-t469*s34r+256.D0/3.D0*t390*t20+256*t397*t23)*t89+((-256
     #*t403*t20+256*t403*t23)*t102+(256.D0/3.D0*t415*t163+256.D0/3.D0*t4
     #24*t254)*s34r)*s23r-t437*s2l1+(-1024.D0/3.D0*t139+t142)*t102+(256.
     #D0/3.D0*t434*t20+256.D0/3.D0*t434*t23)*s34r)*s1l2
      s9 = s10+s11
      s8 = s9+((t315*s2l1+t452*s2l2-1024*t525+1024*t527)*s23r-256*t318*t
     #14*t10*s2l1+256*t318*t22*t10*s2l2)*t67+(((-768*t312+t542)*s2l1+(76
     #8*t449-t546)*s2l2+2048*t525-2048*t527)*t89+((256*t335*s34r-256.D0/
     #3.D0*t561*t12+256.D0/3.D0*t570*t15)*s2l1+(256*t468*s34r+256.D0/3.D
     #0*t561*t20-256.D0/3.D0*t570*t23)*s2l2+(1024*t332*t164-1024*t332*t1
     #68)*s34r-1024*t588+1024*t590)*s23r+((-1280.D0/3.D0*t64+1024*t71)*s
     #34r+256.D0/3.D0*t602*t12-256.D0/3.D0*t610*t15)*s2l1+((1280.D0/3.D0
     #*t116-1024*t122)*s34r-256.D0/3.D0*t602*t20+256.D0/3.D0*t610*t23)*s
     #2l2+1024*t625*s34r-512.D0/3.D0*t628+512.D0/3.D0*t630)*s1vr+((-256.
     #D0/3.D0*t638*t12-256.D0/3.D0*t643*t15)*s2l1+(256.D0/3.D0*t638*t20+
     #256.D0/3.D0*t643*t23)*s2l2+2048*t588-2048*t590)*t89
      s7 = s8+(((-256.D0/3.D0*t663*t167-256.D0/3.D0*t669*t245)*s34r-256.
     #D0/3.D0*t683*t12+256.D0/3.D0*t692*t15)*s2l1+((256.D0/3.D0*t663*t16
     #3+256.D0/3.D0*t669*t254)*s34r+256.D0/3.D0*t683*t20-256.D0/3.D0*t69
     #2*t23)*s2l2+(1024*t666*t164-1024*t666*t168)*s34r+1024.D0/3.D0*t628
     #-1024.D0/3.D0*t630)*s23r+((512.D0/3.D0*t91-512*t93)*t102+(-256.D0/
     #3.D0*t726*t167+256.D0/3.D0*t733*t245)*s34r+256.D0/3.D0*t739*t12+25
     #6.D0/3.D0*t739*t15)*s2l1+((-512.D0/3.D0*t139+512*t141)*t102+(256.D
     #0/3.D0*t726*t163-256.D0/3.D0*t733*t254)*s34r-256.D0/3.D0*t739*t20-
     #256.D0/3.D0*t739*t23)*s2l2-t220*t102+(512.D0/3.D0*t434*t164-512.D0
     #/3.D0*t434*t168)*s34r
      s8 = s13r
      s6 = s7*s8
      s4 = s5+s6
      s2 = s3+s4
      s4 = s2
      s7 = ((-1024.D0/3.D0*t771*t61+256*t774-512*t776)*t89+(-512.D0/3.D0
     #*t780*t61+256*t780*t12-256*t785)*s23r-256*t789*t12)*t67+((-256*t77
     #4+256*t776)*t378+(-2048.D0/3.D0*t310*t61+(-256*t800*t12+256*t800*t
     #15)*s34r+256.D0/3.D0*t810*t167-256.D0/3.D0*t818*t245)*t89+(t831*s2
     #l2+(-2560.D0/3.D0*t312+1024*t313)*s34r+256.D0/3.D0*t842*t167-256.D
     #0/3.D0*t848*t245)*s23r+256.D0/3.D0*t318*t78+512*t318*t82-256.D0/3.
     #D0*t858*t12)*s1vr+(256.D0/3.D0*t867*t167+256.D0/3.D0*t871*t245)*t3
     #78+(-1024.D0/3.D0*t59*t61+(256.D0/3.D0*t882*t12+256.D0/3.D0*t887*t
     #15)*s34r-256.D0/3.D0*t895*t167+256.D0/3.D0*t903*t245)*t89
      s6 = s7+(t912*s2l2+(1024.D0/3.D0*t333-256*t334)*t102+(-256.D0/3.D0
     #*t923*t12+256.D0/3.D0*t927*t15)*s34r+256.D0/3.D0*t932*t12+256.D0/3
     #.D0*t932*t15)*s23r+256.D0/3.D0*t940*t78-256*t60*t265+(256.D0/3.D0*
     #t946*t362*t167-256.D0/3.D0*t374)*s34r
      s7 = s1l1
      s5 = s6*s7
      s3 = s4+s5
      s5 = s3
      s8 = ((1024.D0/3.D0*t771*t113-256*t956+512*t958)*t89+(512.D0/3.D0*
     #t780*t113-256*t780*t20+256*t966)*s23r+256*t789*t20)*t67+((256*t956
     #-256*t958)*t378+(2048.D0/3.D0*t310*t113+(256*t800*t20-256*t800*t23
     #)*s34r-256.D0/3.D0*t810*t163+256.D0/3.D0*t818*t254)*t89+(-t831*s2l
     #1+(2560.D0/3.D0*t449-1024*t450)*s34r-256.D0/3.D0*t842*t163+256.D0/
     #3.D0*t848*t254)*s23r-256.D0/3.D0*t318*t127-512*t318*t131+256.D0/3.
     #D0*t858*t20)*s1vr+(-256.D0/3.D0*t867*t163-256.D0/3.D0*t871*t254)*t
     #378+(1024.D0/3.D0*t59*t113+(-256.D0/3.D0*t882*t20-256.D0/3.D0*t887
     #*t23)*s34r+256.D0/3.D0*t895*t163-256.D0/3.D0*t903*t254)*t89
      s7 = s8+(-t912*s2l1+(-1024.D0/3.D0*t466+256*t467)*t102+(256.D0/3.D
     #0*t923*t20-256.D0/3.D0*t927*t23)*s34r-256.D0/3.D0*t932*t20-256.D0/
     #3.D0*t932*t23)*s23r-256.D0/3.D0*t940*t127+256*t60*t290+(-256.D0/3.
     #D0*t946*t362*t163+256.D0/3.D0*t484)*s34r
      s8 = s1l2
      s6 = s7*s8
      s4 = s5+s6
      s1 = s4+((256*t1056*t1057-256*t1056*t1060-512*t1056*t1063+512*t105
     #6*t1066)*t89+(1280.D0/3.D0*t1071*t1057-1280.D0/3.D0*t1071*t1060-51
     #2*t1071*t1063+512*t1071*t1066)*s23r-512.D0/3.D0*t1082*t1057+512.D0
     #/3.D0*t1082*t1060+256*t1082*t1063-256*t1082*t1066)*t67+(((256.D0/3
     #.D0*t1097*t167+256.D0/3.D0*t785)*s2l1+(-256.D0/3.D0*t1097*t163-256
     #.D0/3.D0*t966)*s2l2-512*t1107*t164+512*t1107*t168)*t89+(((-2048.D0
     #/3.D0*t312+t542)*s34r+256.D0/3.D0*t1121*t167)*s2l1+((2048.D0/3.D0*
     #t449-t546)*s34r-256.D0/3.D0*t1121*t163)*s2l2+(1536*t525-1536*t527)
     #*s34r-256.D0/3.D0*t1140*t1063+256.D0/3.D0*t1140*t1066)*s23r+256*t1
     #147*t11*s3l2*s2l1-256*t1147*t11*s3l1*s2l2+(-256*t318*t164+256*t318
     #*t168)*s34r+256.D0/3.D0*t1163*t1063-256.D0/3.D0*t1163*t1066)*s1vr
      taux8 = s1+((256.D0/3.D0*t1172*t167+256.D0/3.D0*t338*t15)*s2l1+(-2
     #56.D0/3.D0*t1172*t163-256.D0/3.D0*t338*t23)*s2l2+512.D0/3.D0*t1189
     #*t1063-512.D0/3.D0*t1189*t1066)*t89+(((256.D0/3.D0*t1202*t12-256.D
     #0/3.D0*t1207*t15)*s34r+256.D0/3.D0*t1215*t167)*s2l1+((-256.D0/3.D0
     #*t1202*t20+256.D0/3.D0*t1207*t23)*s34r-256.D0/3.D0*t1215*t163)*s2l
     #2+(512.D0/3.D0*t1233*t1063-512.D0/3.D0*t1233*t1066)*s34r-512.D0/3.
     #D0*t1239*t1063+512.D0/3.D0*t1239*t1066)*s23r+(-t369*t102-256.D0/3.
     #D0*t940*t82-256.D0/3.D0*t1250*t167)*s2l1+(-t480*t102+256.D0/3.D0*t
     #940*t131+256.D0/3.D0*t1250*t163)*s2l2-512*t625*t102+(-256*t1267*t1
     #64+256*t1267*t168)*s34r-256.D0/3.D0*t1273*t1063+256.D0/3.D0*t1273*
     #t1066

CCC Coefficients

      tcoff11 = taux7
      tcoff12 = taux7
      tcoff13 = taux8
      tcoff14 = taux8

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet11 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff11)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet12 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff12)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet13 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff13)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet14 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff14)

CCC Sum

      ggrmnum3e1 = tFjet11*tcoff11+tFjet12*tcoff12+tFjet13*tcoff13+tFjet
     #14*tcoff14
      RETURN
      END

      double precision function ggrmnum3e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = -1+z
      t5 = t4**2
      t6 = t5**2
      t8 = t3*t6*z
      t9 = 1/s4vr
      t10 = l3*t9
      t11 = 1/s3vr
      t16 = t11*s23r
      t20 = t2**2
      t21 = t6*t4
      t24 = t11*s34r
      t29 = s13r**2
      t32 = l3**2
      t33 = t32*z
      t34 = t33*t6
      t35 = t2*t9
      t36 = s1vr**2
      t43 = t2*t6
      t46 = t43*z*t10*t11
      t50 = s23r**2
      t51 = t11*t50
      t55 = t33*t21
      t56 = t3*t9
      t57 = t56*t24
      t65 = t11*s2l2
      t69 = t6*t5
      t72 = s34r**2
      t73 = t11*t72
      t85 = l3*t5
      t86 = t85*t1
      t87 = t9*t11
      t96 = t5*t4
      t97 = l3*t96
      t98 = t97*t2
      t100 = t87*s34r*s2l2
      t114 = t87*s34r*s2l1
      t119 = t32*l3
      t120 = t119*z
      t121 = t120*t6
      t122 = t1*t9
      t125 = t33*t96
      t126 = t122*t11
      t134 = t120*t21
      t135 = t35*t24
      t136 = t134*t135
      t144 = t87*s2l2
      t147 = t9*s4l2
      t148 = t147*t11
      t149 = t86*t148
      t153 = t9*s4l1
      t159 = t85*z
      t160 = z+3
      t163 = t159*t160*t1*t87
      t167 = t50*s23r
      t177 = t87*s3l2
      t182 = t87*s3l1
      t184 = t153*t11
      t190 = t56*t73
      t194 = 3*z
      t200 = z**2
      t214 = t4*t1
      t233 = (t194+1)*t9
      s1 = (64.D0/3.D0*t86*t87*s2l2*s1vr-128.D0/3.D0*t86*t87*s2l2*s23r-6
     #4.D0/3.D0*t98*t100)*s1l1+(64.D0/3.D0*t86*t87*s2l1*s1vr-128.D0/3.D0
     #*t86*t87*s2l1*s23r-64.D0/3.D0*t98*t114)*s1l2+(128.D0/3.D0*t121*t12
     #2*t16+128.D0/3.D0*t125*t126)*t36+(-128.D0/3.D0*t121*t122*t51+(-128
     #.D0/3.D0*t136-128.D0/3.D0*t125*(-z+3)*t1*t87)*s23r+(128.D0/3.D0*t8
     #6*t144+64.D0/3.D0*t149)*s2l1+64.D0/3.D0*t86*t153*t65-256.D0/3.D0*t
     #34*t135-64.D0/3.D0*t163)*s1vr-256.D0/3.D0*t121*t122*t11*t167
      t237 = s1+(-128*t136-512.D0/3.D0*t34*t126)*t50+((-64.D0/3.D0*t86*t
     #177-64.D0/3.D0*t149)*s2l1+(-64.D0/3.D0*t86*t182-64.D0/3.D0*t86*t18
     #4)*s2l2-128.D0/3.D0*t120*t69*t190+128.D0/3.D0*t33*t43*(-t194+7)*t9
     #*t24+128.D0/3.D0*t159*(-t200+t194+2)*t1*t87)*s23r+(128.D0/3.D0*t5*
     #t1*t144-64.D0/3.D0*t98*t147*t24+64.D0/3.D0*t214*t177-64.D0/3.D0*t2
     #14*t148)*s2l1+(-64.D0/3.D0*t98*t153*t24+64.D0/3.D0*t214*t182-64.D0
     #/3.D0*t214*t184)*s2l2+256.D0/3.D0*t55*t190+64.D0/3.D0*t97*t2*z*t23
     #3*t24
      t239 = t32*t5
      t240 = t239*t9
      t243 = t87*t50
      t246 = t32*t96*t1
      t254 = t239*t177
      t255 = t239*t148
      t276 = t87*s2l1
      t278 = t239*t182
      t279 = t239*t184
      t300 = t32**2
      t301 = t300*z
      t302 = t301*t6
      t311 = t87*t167
      t315 = t122*t24
      t324 = t11*s3l2
      t325 = t324*s2l1
      t328 = t11*s3l1
      t329 = t328*s2l2
      t335 = s4l2*t11*s3l1
      t337 = 128.D0/3.D0*t240*t335
      t339 = s4l1*t11*s3l2
      t341 = 128.D0/3.D0*t240*t339
      t349 = t4*l3*t9
      t372 = t160*t9*t11
      t377 = t85*t9
      t382 = t35*t73
      t385 = t147*t328
      t387 = t153*t324
      t396 = t4*t9
      s2 = (128.D0/3.D0*t8*t10*t11*s1vr-256.D0/3.D0*t8*t10*t16-128.D0/3.
     #D0*t20*t21*z*t10*t24)*t29*s13r+(-64.D0/3.D0*t34*t35*t11*t36+(-128.
     #D0/3.D0*t34*t35*t16-128.D0/3.D0*t46)*s1vr+512.D0/3.D0*t34*t35*t51+
     #(512.D0/3.D0*t55*t57+128*t46)*s23r-128.D0/3.D0*t5*t2*t9*t65*s2l1+6
     #4.D0/3.D0*t33*t69*t20*t9*t73+128.D0/3.D0*l3*z*(-2+z)*t6*t57)*t29+t
     #237*s13r+((128.D0/3.D0*t240*t16*s1vr-128.D0/3.D0*t239*t243-128.D0/
     #3.D0*t246*t87*s34r*s23r)*s1l2+(64.D0/3.D0*t239*t144+64.D0/3.D0*t25
     #4+64.D0/3.D0*t255)*s23r*s1vr+(-64.D0/3.D0*t254-64.D0/3.D0*t255)*t5
     #0+(64.D0/3.D0*t85*t144+(-64.D0/3.D0*t246*t177-64.D0/3.D0*t246*t148
     #)*s34r)*s23r-64.D0/3.D0*t86*t100)*s1l1
      s1 = s2+((64.D0/3.D0*t239*t276+64.D0/3.D0*t278+64.D0/3.D0*t279)*s2
     #3r*s1vr+(-64.D0/3.D0*t278-64.D0/3.D0*t279)*t50+(64.D0/3.D0*t85*t27
     #6+(-64.D0/3.D0*t246*t182-64.D0/3.D0*t246*t184)*s34r)*s23r-64.D0/3.
     #D0*t86*t114)*s1l2+(-64.D0/3.D0*t302*t243-128.D0/3.D0*t120*t96*t87*
     #s23r)*t36+(128.D0/3.D0*t302*t311+(128.D0/3.D0*t301*t21*t315+256.D0
     #/3.D0*t120*t96*t9*t11)*t50+(64.D0/3.D0*t240*t325+64.D0/3.D0*t240*t
     #329+128*t121*t315+t337+t341-64.D0/3.D0*t33*t5*t233*t11)*s23r-64.D0
     #/3.D0*t349*t325-64.D0/3.D0*t349*t329-128.D0/3.D0*t125*t315-64.D0/3
     #.D0*t349*t335-64.D0/3.D0*t349*t339)*s1vr+128.D0/3.D0*t121*t311
      taux7 = s1+(-64.D0/3.D0*t119*t6*z*(-2*z+8)*t315-t337-t341+64.D0/3.
     #D0*t125*t372)*t50+(64.D0/3.D0*t377*t325+64.D0/3.D0*t377*t329-128*t
     #134*t382+(-128.D0/3.D0*t246*t385-128.D0/3.D0*t246*t387)*s34r-64.D0
     #/3.D0*t159*t372)*s23r-64.D0/3.D0*t396*t325-64.D0/3.D0*t396*t329+64
     #*t34*t382+(64.D0/3.D0*t86*t385+64.D0/3.D0*t86*t387+64.D0/3.D0*t163
     #)*s34r+64.D0/3.D0*t385+64.D0/3.D0*t387
      t1 = -1+z
      t2 = t1**2
      t3 = t2**2
      t5 = l3-1
      t6 = t5**2
      t7 = t6*t5
      t8 = l3*t3*t7
      t9 = 1/s4vr
      t10 = 1/s3vr
      t11 = t9*t10
      t12 = t11*s3l2
      t13 = t8*t12
      t14 = t9*s4l2
      t15 = t14*t10
      t16 = t8*t15
      t17 = t13-t16
      t20 = t11*s3l1
      t21 = t8*t20
      t22 = t9*s4l1
      t23 = t22*t10
      t24 = t8*t23
      t25 = -t21+t24
      t38 = t6**2
      t39 = t3*t1
      t41 = t38*t39*l3
      t55 = s13r**2
      t58 = l3**2
      t59 = t58*t3
      t60 = t59*t6
      t61 = s1vr**2
      t66 = t60*t12
      t68 = t60*t15
      t69 = 512.D0/3.D0*t68
      t73 = t7*t39*t58
      t75 = t11*s3l2*s34r
      t78 = t2*t1
      t79 = l3*t78
      t80 = t79*t6
      t81 = t80*t12
      t83 = t80*t15
      t88 = -1024.D0/3.D0*t66+1024.D0/3.D0*t68
      t89 = s23r**2
      t91 = t73*t12
      t93 = t73*t15
      t94 = 512.D0/3.D0*t93
      t101 = t3*t2
      t103 = t38*t101*t58
      t104 = s34r**2
      t118 = t60*t20
      t120 = t60*t23
      t121 = 512.D0/3.D0*t120
      t125 = t11*s3l1*s34r
      t128 = t80*t20
      t130 = t80*t23
      t135 = 1024.D0/3.D0*t118-1024.D0/3.D0*t120
      t137 = t73*t20
      t139 = t73*t23
      t140 = 512.D0/3.D0*t139
      t164 = t10*s3l1
      t165 = t14*t164
      t166 = t60*t165
      t168 = t10*s3l2
      t169 = t22*t168
      t170 = t60*t169
      t182 = 4096.D0/3.D0*t166
      t183 = 4096.D0/3.D0*t170
      t188 = 512.D0/3.D0*t91-512*t93
      t194 = (-t80+2*t79*t6*z)*t9
      t198 = t3*t6*l3
      t205 = -512.D0/3.D0*t137+512*t139
      t215 = -t73*t165+t73*t169
      t216 = 2048.D0/3.D0*t215
      t226 = 3*z
      t227 = t226-2
      t232 = (-t80+2*t79*t6*t227)*t9
      t235 = 4-t226
      t240 = (-t80+2*t79*t6*t235)*t9
      t241 = s4l2*t10
      t250 = s4l1*t10
      t260 = t10*t104
      t261 = t14*t260
      t268 = (-t8+2*l3*t39*t7)*t9
      t271 = -2+z
      t273 = l3*t271*t3
      t274 = t7*t9
      t282 = t22*t260
      t301 = t58*l3
      t302 = t301*t3
      t303 = t302*t5
      t304 = t303*t12
      t305 = t303*t15
      t307 = -1024.D0/3.D0*t304+1024.D0/3.D0*t305
      t309 = t58*t78
      t310 = t309*t5
      t311 = t310*t12
      t320 = t301*t39*t6
      t321 = t320*t12
      t322 = t320*t15
      t323 = t321-t322
      t324 = 512*t323
      t326 = z-4
      t327 = t309*t326
      t328 = t5*t9
      t329 = t328*t168
      t336 = (-2*t309+2*t309*(z+2))*t5
      t341 = t11*s34r
      t343 = l3*t2
      t347 = -256.D0/3.D0*t60*t341-256.D0/3.D0*t343*t328*t10
      t352 = t343*t271
      t355 = (-t352-2*t343)*t5
      t358 = t343*t5
      t359 = t358*t15
      t363 = t89*s23r
      t367 = 3*t309
      t372 = (-t367-2*t309*t326)*t5
      t375 = t309*z
      t378 = (-t309+2*t375)*t5
      t384 = t301*t101*t7
      t390 = 3*t60
      t396 = (-t390+2*t59*t6*(-z+7))*t9
      t402 = (-t390+2*t58*t39*t6)*t9
      t407 = t79*t5
      t419 = 256.D0/3.D0*t73*t11*t104+256*t80*t341
      t424 = z-3
      t425 = t6*t424
      t427 = 2*t80
      t429 = (-t79*t425-t427)*t9
      t435 = t303*t20
      t436 = t303*t23
      t438 = 1024.D0/3.D0*t435-1024.D0/3.D0*t436
      t440 = t310*t20
      t448 = t320*t20
      t449 = t320*t23
      t450 = -t448+t449
      t451 = 512*t450
      t453 = t328*t164
      t467 = t358*t23
      t508 = t303*t165
      t510 = t303*t169
      t527 = 512.D0/3.D0*t305
      t531 = 512.D0/3.D0*t436
      t541 = t309*(t226-1)
      t544 = t226-5
      t545 = t309*t544
      t546 = t328*t241
      t555 = t328*t250
      t565 = t59*t5
      t566 = t565*t165
      t568 = t565*t169
      t579 = (-t352+2*t343*t424)*t5
      t582 = -t1
      t586 = (-2*t343+2*t343*t582)*t5
      t601 = -t166+t170
      t607 = -t309*t227
      t610 = (-t309+2*t607)*t5
      t612 = t309*t271
      t615 = (-t309+2*t612)*t5
      t629 = -t271
      t634 = (-t60+2*t59*t6*t629)*t9
      t636 = t59*t425
      t639 = (-t390+2*t636)*t9
      t644 = t343*z
      t645 = z**2
      t646 = 2*z
      t651 = (-t644+2*t343*(-1+t645-t646))*t5
      t655 = 4*z
      t660 = (-t343*t629+2*t343*(t645-t655+1))*t5
      t688 = (-t79*t6*t271-t427)*t9
      t690 = -t646+1
      t695 = (-2*t80+2*t79*t6*t690)*t9
      t702 = 3-t226+2*t1*t582
      t703 = t702*t5
      t727 = t58**2
      t728 = t727*t3
      t729 = t728*t12
      t731 = t728*t15
      t735 = t301*t78
      t739 = 512.D0/3.D0*t735*t15
      t742 = t2*t58
      t751 = t727*t39*t5
      t757 = -t424
      t761 = (-t735+2*t735*t757)*t9
      t764 = -t544
      t768 = (-t735+2*t735*t764)*t9
      t776 = 256.D0/3.D0*t303*t341+256.D0/3.D0*t742*t11
      t782 = t742*t629
      t785 = 2*t742*(2-t655)
      t787 = (-t782+t785)*t9
      t794 = (-5*t742+2*t742*t582)*t9
      t800 = t11*s34r*s2l2
      t803 = t310*t75
      t806 = z*l3*t1
      t814 = (-t735+2*t735*z)*t9
      t819 = (-t735+2*t735*t629)*t9
      t827 = (-2*t302+2*t302*z)*t5
      t832 = (-t302+2*t302*t757)*t5
      t839 = (-t742*t235+t785)*t9
      t846 = (-t742+2*t742*(-t226+t645))*t9
      t854 = 256.D0/3.D0*t565*t341+256.D0/3.D0*t343*t11
      t866 = (-t309*t764+2*t309*(4-5*z))*t5
      t873 = t1*l3
      t878 = (-t873*(t645-t646)-2*t873)*t9
      t890 = z+1
      t894 = (-2*t644+2*t343*t890)*t5
      t901 = t728*t20
      t903 = t728*t23
      t910 = 512.D0/3.D0*t735*t23
      t944 = t11*s34r*s2l1
      t947 = t310*t125
      t998 = t728*t9
      t999 = t168*s2l1
      t1002 = t164*s2l2
      t1005 = t241*s3l1
      t1008 = t250*s3l2
      t1013 = t735*t9
      t1024 = t742*t9
      t1036 = -t646+3
      t1040 = (-3*t735+2*t735*t1036)*t9
      t1051 = -t301*t1036*t78
      t1061 = t742*z
      t1064 = (-t782-4*t1061)*t9
      t1081 = (-4*t742-4*t1061)*t9
      t1090 = t873*t582
      t1093 = (-3*t873+5*t1090)*t9
      t1110 = (-2*t873+2*t1090)*t9
      t1120 = (-t367+2*t309*t629)*t9
      t1137 = (-2*t742+2*t742*(t645-t226+1))*t9
      t1148 = (-t59-2*t309*t690)*t5
      t1159 = (-t343-2*t343*t890)*t9
      t1177 = (-2*t309+2*t607)*t5*t9
      t1189 = t702*t9
      t1208 = (-2*t343-2*t644)*t5*t9
      t1215 = (-1-t646)*t9
      s3 = ((512.D0/3.D0*t17*s2l1+512.D0/3.D0*t25*s2l2)*s1vr+(-1024.D0/3
     #.D0*t17*s2l1-1024.D0/3.D0*t25*s2l2)*s23r+(-512.D0/3.D0*t41*t12+512
     #.D0/3.D0*t41*t15)*s34r*s2l1+(512.D0/3.D0*t41*t20-512.D0/3.D0*t41*t
     #23)*s34r*s2l2)*t55*s13r
      s8 = (-512.D0/3.D0*t60*t11*s3l2*t61+((512*t66-t69)*s23r+1024.D0/3.
     #D0*t73*t75+256.D0/3.D0*t81+256.D0/3.D0*t83)*s1vr+t88*t89+((-512*t9
     #1+t94)*s34r-512.D0/3.D0*t81-512.D0/3.D0*t83)*s23r-512.D0/3.D0*t103
     #*t11*s3l2*t104+(-256.D0/3.D0*t13-256.D0/3.D0*t16)*s34r)*s1l1+(512.
     #D0/3.D0*t60*t11*s3l1*t61+((-512*t118+t121)*s23r-1024.D0/3.D0*t73*t
     #125-256.D0/3.D0*t128-256.D0/3.D0*t130)*s1vr+t135*t89+((512*t137-t1
     #40)*s34r+512.D0/3.D0*t128+512.D0/3.D0*t130)*s23r+512.D0/3.D0*t103*
     #t11*s3l1*t104+(256.D0/3.D0*t21+256.D0/3.D0*t24)*s34r)*s1l2
      s7 = s8+((-512.D0/3.D0*t66+1024.D0/3.D0*t68)*s2l1+(512.D0/3.D0*t11
     #8-1024.D0/3.D0*t120)*s2l2+1024.D0/3.D0*t166-1024.D0/3.D0*t170)*t61
     #+(((2048.D0/3.D0*t66-1024*t68)*s2l1+(-2048.D0/3.D0*t118+1024*t120)
     #*s2l2-t182+t183)*s23r+(t188*s34r-256.D0/3.D0*t194*t168+512.D0/3.D0
     #*t198*t15)*s2l1+(t205*s34r+256.D0/3.D0*t194*t164-512.D0/3.D0*t198*
     #t23)*s2l2+t216*s34r)*s1vr
      s6 = s7+(t88*s2l1+t135*s2l2+t182-t183)*t89+((-t188*s34r+256.D0/3.D
     #0*t232*t168+256.D0/3.D0*t240*t241)*s2l1+(-t205*s34r-256.D0/3.D0*t2
     #32*t164-256.D0/3.D0*t240*t250)*s2l2-4096.D0/3.D0*t215*s34r)*s23r+(
     #512.D0/3.D0*t103*t261+(256.D0/3.D0*t268*t168-512.D0/3.D0*t273*t274
     #*t241)*s34r)*s2l1+(-512.D0/3.D0*t103*t282+(-256.D0/3.D0*t268*t164+
     #512.D0/3.D0*t273*t274*t250)*s34r)*s2l2+(1024.D0/3.D0*t103*t165-102
     #4.D0/3.D0*t103*t169)*t104
      s7 = t55
      s5 = s6*s7
      s10 = ((t307*s23r-256.D0/3.D0*t311)*t61+((2048.D0/3.D0*t304-1024*t
     #305)*t89+(t324*s34r-512.D0/3.D0*t327*t329+256.D0/3.D0*t336*t15)*s2
     #3r+t347*s2l2+(1280.D0/3.D0*t66-t69)*s34r+256.D0/3.D0*t355*t12-256.
     #D0/3.D0*t359)*s1vr+t307*t363+(-t324*s34r-256.D0/3.D0*t372*t12-256*
     #t378*t15)*t89+((-512.D0/3.D0*t384*t12+512.D0/3.D0*t384*t15)*t104+(
     #-256.D0/3.D0*t396*t168-256.D0/3.D0*t402*t241)*s34r+256*t407*t12+25
     #6.D0/3.D0*t407*t15)*s23r+t419*s2l2+(-1024.D0/3.D0*t91+t94)*t104-25
     #6.D0/3.D0*t429*t168*s34r)*s1l1
      s11 = ((t438*s23r+256.D0/3.D0*t440)*t61+((-2048.D0/3.D0*t435+1024*
     #t436)*t89+(t451*s34r+512.D0/3.D0*t327*t453-256.D0/3.D0*t336*t23)*s
     #23r-t347*s2l1+(-1280.D0/3.D0*t118+t121)*s34r-256.D0/3.D0*t355*t20+
     #256.D0/3.D0*t467)*s1vr+t438*t363+(-t451*s34r+256.D0/3.D0*t372*t20+
     #256*t378*t23)*t89+((512.D0/3.D0*t384*t20-512.D0/3.D0*t384*t23)*t10
     #4+(256.D0/3.D0*t396*t164+256.D0/3.D0*t402*t250)*s34r-256*t407*t20-
     #256.D0/3.D0*t407*t23)*s23r-t419*s2l1+(1024.D0/3.D0*t137-t140)*t104
     #+256.D0/3.D0*t429*t164*s34r)*s1l2
      s9 = s10+s11
      s8 = s9+((t307*s2l1+t438*s2l2+2048.D0/3.D0*t508-2048.D0/3.D0*t510)
     #*s23r+(256*t311+512.D0/3.D0*t310*t15)*s2l1+(-256*t440-512.D0/3.D0*
     #t310*t23)*s2l2)*t61+(((512*t304-t527)*s2l1+(-512*t435+t531)*s2l2-4
     #096.D0/3.D0*t508+4096.D0/3.D0*t510)*t89+((512.D0/3.D0*t323*s34r-51
     #2.D0/3.D0*t541*t329+512.D0/3.D0*t545*t546)*s2l1+(512.D0/3.D0*t450*
     #s34r+512.D0/3.D0*t541*t453-512.D0/3.D0*t545*t555)*s2l2+(-2048.D0/3
     #.D0*t320*t165+2048.D0/3.D0*t320*t169)*s34r+2048.D0/3.D0*t566-2048.
     #D0/3.D0*t568)*s23r+((-256.D0/3.D0*t66-2048.D0/3.D0*t68)*s34r+256.D
     #0/3.D0*t579*t12-256.D0/3.D0*t586*t15)*s2l1+((256.D0/3.D0*t118+2048
     #.D0/3.D0*t120)*s34r-256.D0/3.D0*t579*t20+256.D0/3.D0*t586*t23)*s2l
     #2+2048.D0/3.D0*t601*s34r)*s1vr
      s7 = s8+((-256.D0/3.D0*t610*t12-256.D0/3.D0*t615*t15)*s2l1+(256.D0
     #/3.D0*t610*t20+256.D0/3.D0*t615*t23)*s2l2-4096.D0/3.D0*t566+4096.D
     #0/3.D0*t568)*t89+(((-256.D0/3.D0*t634*t168-256.D0/3.D0*t639*t241)*
     #s34r-256.D0/3.D0*t651*t12+256.D0/3.D0*t660*t15)*s2l1+((256.D0/3.D0
     #*t634*t164+256.D0/3.D0*t639*t250)*s34r+256.D0/3.D0*t651*t20-256.D0
     #/3.D0*t660*t23)*s2l2+(-2048.D0/3.D0*t636*t165+2048.D0/3.D0*t636*t1
     #69)*s34r)*s23r+(1024.D0/3.D0*t73*t261+(-256.D0/3.D0*t688*t168+256.
     #D0/3.D0*t695*t241)*s34r+256.D0/3.D0*t703*t12+256.D0/3.D0*t703*t15)
     #*s2l1+(-1024.D0/3.D0*t73*t282+(256.D0/3.D0*t688*t164-256.D0/3.D0*t
     #695*t250)*s34r-256.D0/3.D0*t703*t20-256.D0/3.D0*t703*t23)*s2l2-t21
     #6*t104
      s8 = s13r
      s6 = s7*s8
      s4 = s5+s6
      s2 = s3+s4
      s3 = s2+(((-512.D0/3.D0*t729+1024.D0/3.D0*t731)*t89+(-1280.D0/3.D0
     #*t735*t12+t739)*s23r+256.D0/3.D0*t742*t12)*t61+((512.D0/3.D0*t729-
     #512.D0/3.D0*t731)*t363+((512.D0/3.D0*t751*t12-512.D0/3.D0*t751*t15
     #)*s34r+256.D0/3.D0*t761*t168-256.D0/3.D0*t768*t241)*t89+(t776*s2l2
     #+(1792.D0/3.D0*t304-2048.D0/3.D0*t305)*s34r+256.D0/3.D0*t787*t168-
     #256.D0/3.D0*t794*t241)*s23r-256.D0/3.D0*t310*t800+256.D0/3.D0*t803
     #+256.D0/3.D0*t806*t12)*s1vr+(256.D0/3.D0*t814*t168+256.D0/3.D0*t81
     #9*t241)*t363+((256.D0/3.D0*t827*t12+256.D0/3.D0*t832*t15)*s34r-256
     #.D0/3.D0*t839*t168+256.D0/3.D0*t846*t241)*t89+(t854*s2l2+(-256.D0/
     #3.D0*t321+512.D0/3.D0*t322)*t104+(-256.D0/3.D0*t866*t12-512*t375*t
     #546)*s34r+256.D0/3.D0*t878*t168-256.D0/3.D0*t873*t15)*s23r-256.D0/
     #3.D0*t407*t800+(-256*t66+t69)*t104+(-256.D0/3.D0*t894*t12+256.D0/3
     #.D0*t359)*s34r)*s1l1
      s4 = s3+(((512.D0/3.D0*t901-1024.D0/3.D0*t903)*t89+(1280.D0/3.D0*t
     #735*t20-t910)*s23r-256.D0/3.D0*t742*t20)*t61+((-512.D0/3.D0*t901+5
     #12.D0/3.D0*t903)*t363+((-512.D0/3.D0*t751*t20+512.D0/3.D0*t751*t23
     #)*s34r-256.D0/3.D0*t761*t164+256.D0/3.D0*t768*t250)*t89+(-t776*s2l
     #1+(-1792.D0/3.D0*t435+2048.D0/3.D0*t436)*s34r-256.D0/3.D0*t787*t16
     #4+256.D0/3.D0*t794*t250)*s23r+256.D0/3.D0*t310*t944-256.D0/3.D0*t9
     #47-256.D0/3.D0*t806*t20)*s1vr+(-256.D0/3.D0*t814*t164-256.D0/3.D0*
     #t819*t250)*t363+((-256.D0/3.D0*t827*t20-256.D0/3.D0*t832*t23)*s34r
     #+256.D0/3.D0*t839*t164-256.D0/3.D0*t846*t250)*t89+(-t854*s2l1+(256
     #.D0/3.D0*t448-512.D0/3.D0*t449)*t104+(256.D0/3.D0*t866*t20+512*t37
     #5*t555)*s34r-256.D0/3.D0*t878*t164+256.D0/3.D0*t873*t23)*s23r+256.
     #D0/3.D0*t407*t944+(256*t118-t121)*t104+(256.D0/3.D0*t894*t20-256.D
     #0/3.D0*t467)*s34r)*s1l2
      s1 = s4+((-512.D0/3.D0*t998*t999+512.D0/3.D0*t998*t1002+1024.D0/3.
     #D0*t998*t1005-1024.D0/3.D0*t998*t1008)*t89+(-256.D0/3.D0*t1013*t99
     #9+256.D0/3.D0*t1013*t1002+1024.D0/3.D0*t1013*t1005-1024.D0/3.D0*t1
     #013*t1008)*s23r+256*t1024*t999-256*t1024*t1002-512.D0/3.D0*t1024*t
     #1005+512.D0/3.D0*t1024*t1008)*t61+(((256.D0/3.D0*t1040*t168-t739)*
     #s2l1+(-256.D0/3.D0*t1040*t164+t910)*s2l2+1024.D0/3.D0*t1051*t165-1
     #024.D0/3.D0*t1051*t169)*t89+(((256*t304-t527)*s34r+256.D0/3.D0*t10
     #64*t168)*s2l1+((-256*t435+t531)*s34r-256.D0/3.D0*t1064*t164)*s2l2+
     #(-1024*t508+1024*t510)*s34r-256.D0/3.D0*t1081*t1005+256.D0/3.D0*t1
     #081*t1008)*s23r+(-256*t803-256.D0/3.D0*t1093*t168)*s2l1+(256*t947+
     #256.D0/3.D0*t1093*t164)*s2l2+(512.D0/3.D0*t310*t165-512.D0/3.D0*t3
     #10*t169)*s34r+256.D0/3.D0*t1110*t1005-256.D0/3.D0*t1110*t1008)*s1v
     #r
      taux8 = s1+((256.D0/3.D0*t1120*t168-512.D0/3.D0*t309*t15)*s2l1+(-2
     #56.D0/3.D0*t1120*t164+512.D0/3.D0*t309*t23)*s2l2+512.D0/3.D0*t1137
     #*t1005-512.D0/3.D0*t1137*t1008)*t89+(((256.D0/3.D0*t1148*t12-512.D
     #0/3.D0*t612*t546)*s34r+256.D0/3.D0*t1159*t168)*s2l1+((-256.D0/3.D0
     #*t1148*t20+512.D0/3.D0*t612*t555)*s34r-256.D0/3.D0*t1159*t164)*s2l
     #2+(512.D0/3.D0*t1177*t1005-512.D0/3.D0*t1177*t1008)*s34r)*s23r+(51
     #2.D0/3.D0*t60*t261-256.D0/3.D0*t407*t75-256.D0/3.D0*t1189*t168)*s2
     #l1+(-512.D0/3.D0*t60*t282+256.D0/3.D0*t407*t125+256.D0/3.D0*t1189*
     #t164)*s2l2-1024.D0/3.D0*t601*t104+(-256.D0/3.D0*t1208*t1005+256.D0
     #/3.D0*t1208*t1008)*s34r-256.D0/3.D0*t1215*t1005+256.D0/3.D0*t1215*
     #t1008

CCC Coefficients

      tcoff11 = taux7
      tcoff12 = taux7
      tcoff13 = taux8
      tcoff14 = taux8

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet11 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff11)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet12 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff12)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet13 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff13)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet14 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff14)

CCC Sum

      ggrmnum3e2 = tFjet11*tcoff11+tFjet12*tcoff12+tFjet13*tcoff13+tFjet
     #14*tcoff14
      RETURN
      END

      double precision function ggrmnum3e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3**2
      t2 = t1*z
      t3 = -1+z
      t4 = t3**2
      t5 = t4*t3
      t6 = t2*t5
      t7 = l3-1
      t8 = 1/s4vr
      t9 = t7*t8
      t10 = 1/s3vr
      t11 = s1vr**2
      t20 = t4**2
      t21 = t2*t20
      t22 = t7**2
      t23 = t22*t8
      t24 = t10*s34r
      t25 = t23*t24
      t26 = t21*t25
      t28 = z*l3
      t29 = t28*t4
      t31 = t29*t9*t10
      t38 = t20*t3
      t42 = s34r**2
      t43 = t10*t42
      t52 = l3*t1
      t53 = t52*z
      t54 = t53*t5
      t55 = t8*t10
      t60 = s23r**2
      t65 = t9*t24
      t66 = t53*t20*t65
      t68 = z**2
      t71 = t4*t8*t10
      taux7 = (64.D0/3.D0*t6*t9*t10*t11+(-128.D0/3.D0*t6*t9*t10*s23r-128
     #.D0/3.D0*t26-64.D0/3.D0*t31)*s1vr+(128.D0/3.D0*t26+128.D0/3.D0*t31
     #)*s23r+64.D0/3.D0*t2*t38*t22*t7*t8*t43+64.D0/3.D0*t28*t5*t25)*s13r
     #-64.D0/3.D0*t54*t55*s23r*t11+(128.D0/3.D0*t54*t55*t60+(64*t66-64.D
     #0/3.D0*t1*t68*t71)*s23r-64.D0/3.D0*t6*t65)*s1vr+(-128.D0/3.D0*t66+
     #128.D0/3.D0*t2*t5*t8*t10)*t60+(-128.D0/3.D0*t52*t22*t38*z*t8*t43+6
     #4.D0/3.D0*t21*t65-64.D0/3.D0*t28*t71)*s23r+64.D0/3.D0*t21*t23*t43+
     #64.D0/3.D0*t29*t65
      t1 = l3-1
      t2 = t1**2
      t3 = -1+z
      t4 = t3**2
      t5 = t4*t3
      t7 = t2*t5*l3
      t8 = 1/s4vr
      t9 = 1/s3vr
      t10 = t8*t9
      t11 = t10*s3l2
      t13 = t8*s4l2
      t14 = t13*t9
      t15 = t7*t14
      t16 = -t7*t11-t15
      t17 = 512.D0/3.D0*t16
      t22 = t2*t1
      t23 = t4**2
      t24 = t22*t23
      t25 = t24*l3
      t33 = t10*s3l1
      t35 = t8*s4l1
      t36 = t35*t9
      t37 = t7*t36
      t38 = t7*t33+t37
      t39 = 512.D0/3.D0*t38
      t52 = t10*s3l2*s2l1
      t55 = t10*s3l1*s2l2
      t67 = t24*l3*t8
      t68 = t9*s3l2
      t69 = s34r*s2l1
      t73 = t9*s3l1
      t74 = s34r*s2l2
      t79 = s13r**2
      t81 = l3**2
      t82 = t81*t5
      t83 = t82*t1
      t84 = s1vr**2
      t89 = t9*s23r
      t93 = t81*t23
      t94 = t93*t2
      t95 = t10*s34r
      t97 = l3*t4
      t98 = t1*t8
      t102 = -512.D0/3.D0*t94*t95-512.D0/3.D0*t97*t98*t9
      t105 = t10*s3l2*s34r
      t107 = 512.D0/3.D0*t94*t105
      t108 = -2+z
      t109 = t97*t108
      t110 = t98*t68
      t112 = 512.D0/3.D0*t109*t110
      t113 = t97*t1
      t114 = t113*t14
      t115 = 512.D0/3.D0*t114
      t119 = t83*t14
      t120 = -t83*t11-t119
      t122 = s23r**2
      t126 = -t94*t11-t94*t14
      t130 = l3*t5*t1
      t137 = t23*t3
      t140 = s34r**2
      t146 = 512.D0/3.D0*t81*t137*t22*t10*t140+512*t7*t95
      t149 = (z-3)*t8
      t168 = t10*s3l1*s34r
      t170 = 512.D0/3.D0*t94*t168
      t171 = t98*t73
      t173 = 512.D0/3.D0*t109*t171
      t174 = t113*t36
      t175 = 512.D0/3.D0*t174
      t179 = t83*t36
      t180 = t83*t33+t179
      t185 = t94*t33+t94*t36
      t225 = t97*z
      t228 = (-t97+2*t225)*t1
      t231 = -t108
      t235 = (-t97+2*t97*t231)*t1
      t250 = t108*t8
      t257 = 5*t3
      t258 = t257*t1
      t279 = t81*l3
      t280 = t279*t5
      t281 = t280*t8
      t284 = t4*t81
      t289 = t280*t11
      t290 = t280*t14
      t295 = t279*t23*t1
      t299 = 512.D0/3.D0*t295*t95+512.D0/3.D0*t284*t10
      t302 = 512.D0/3.D0*t295*t105
      t306 = (-t284+2*t284*t231)*t8
      t308 = 256.D0/3.D0*t306*t68
      t310 = 256.D0/3.D0*t284*t14
      t313 = t10*t74
      t317 = 512.D0/3.D0*t83*t105
      t319 = z*l3*t3
      t326 = t122*s23r
      t334 = 3*z
      t339 = (-t284+2*t284*(4-t334))*t8
      t344 = t93*t1
      t348 = 512.D0/3.D0*t344*t95+512.D0/3.D0*t97*t10
      t351 = t279*t137*t2
      t353 = t10*s3l2*t140
      t360 = (-t82+2*t82*(-t334+5))*t1
      t365 = t3*l3
      t366 = z**2
      t369 = t365*(t366-2*z)
      t392 = t280*t33
      t393 = t280*t36
      t400 = 512.D0/3.D0*t295*t168
      t402 = 256.D0/3.D0*t306*t73
      t404 = 256.D0/3.D0*t284*t36
      t407 = t10*t69
      t411 = 512.D0/3.D0*t83*t168
      t432 = t10*s3l1*t140
      t455 = t68*s2l1
      t457 = t73*s2l2
      t460 = -512.D0/3.D0*t281*t455+512.D0/3.D0*t281*t457
      t462 = t284*t8
      t476 = s4l2*t9*s3l1
      t478 = 512*t462*t476
      t480 = s4l1*t9*s3l2
      t482 = 512*t462*t480
      t490 = (5*t365-2*t365*t3)*t8
      t499 = t365*t8
      t506 = t82*t8
      t525 = t13*t73
      t527 = t35*t68
      t536 = t257*t8
      s3 = ((t17*s1vr-1024.D0/3.D0*t16*s23r+(512.D0/3.D0*t25*t11+512.D0/
     #3.D0*t25*t14)*s34r)*s1l1+(t39*s1vr-1024.D0/3.D0*t38*s23r+(-512.D0/
     #3.D0*t25*t33-512.D0/3.D0*t25*t36)*s34r)*s1l2+(-512.D0/3.D0*t7*t52+
     #512.D0/3.D0*t7*t55)*s1vr+(-t17*s2l1-t39*s2l2)*s23r+512.D0/3.D0*t67
     #*t68*t69-512.D0/3.D0*t67*t73*t74)*t79
      s7 = (512.D0/3.D0*t83*t10*s3l2*t84+(1024.D0/3.D0*t83*t13*t89+t102*
     #s2l2-t107+t112-t115)*s1vr+512*t120*t122+(512*t126*s34r-512*t130*t1
     #1-512.D0/3.D0*t130*t14)*s23r+t146*s2l2+(-512.D0/3.D0*t7*t149*t68+1
     #024.D0/3.D0*t15)*s34r)*s1l1+(-512.D0/3.D0*t83*t10*s3l1*t84+(-1024.
     #D0/3.D0*t83*t35*t89-t102*s2l1+t170-t173+t175)*s1vr+512*t180*t122+(
     #512*t185*s34r+512*t130*t33+512.D0/3.D0*t130*t36)*s23r-t146*s2l1+(5
     #12.D0/3.D0*t7*t149*t73-1024.D0/3.D0*t37)*s34r)*s1l2+(512.D0/3.D0*t
     #83*t52-512.D0/3.D0*t83*t55)*t84+((-t107+t112-256*t114)*s2l1+(t170-
     #t173+256*t174)*s2l2)*s1vr
      s6 = s7+(512.D0/3.D0*t120*s2l1+512.D0/3.D0*t180*s2l2)*t122+((512.D
     #0/3.D0*t126*s34r-256.D0/3.D0*t228*t11+256.D0/3.D0*t235*t14)*s2l1+(
     #512.D0/3.D0*t185*s34r+256.D0/3.D0*t228*t33-256.D0/3.D0*t235*t36)*s
     #2l2)*s23r+((-512.D0/3.D0*t7*t250*t68+256*t15)*s34r+256.D0/3.D0*t25
     #8*t11+256.D0/3.D0*t258*t14)*s2l1+((512.D0/3.D0*t7*t250*t73-256*t37
     #)*s34r-256.D0/3.D0*t258*t33-256.D0/3.D0*t258*t36)*s2l2
      s7 = s13r
      s5 = s6*s7
      s6 = ((-512.D0/3.D0*t281*t68*s23r+512.D0/3.D0*t284*t11)*t84+((512.
     #D0/3.D0*t289-512.D0/3.D0*t290)*t122+(t299*s2l2+t302+t308-t310)*s23
     #r-512.D0/3.D0*t83*t313-t317+512.D0/3.D0*t319*t11)*s1vr+(512.D0/3.D
     #0*t289+512.D0/3.D0*t290)*t326+((1024.D0/3.D0*t295*t11+512.D0/3.D0*
     #t295*t14)*s34r-256.D0/3.D0*t339*t68+t310)*t122+(t348*s2l2+512.D0/3
     #.D0*t351*t353+(-256.D0/3.D0*t360*t11-256.D0/3.D0*t119)*s34r+512.D0
     #/3.D0*t369*t11-512.D0/3.D0*t365*t14)*s23r-512.D0/3.D0*t130*t313-51
     #2.D0/3.D0*t94*t353+(-1024.D0/3.D0*t225*t110+t115)*s34r)*s1l1
      s4 = s5+s6
      s2 = s3+s4
      s1 = s2+((512.D0/3.D0*t281*t73*s23r-512.D0/3.D0*t284*t33)*t84+((-5
     #12.D0/3.D0*t392+512.D0/3.D0*t393)*t122+(-t299*s2l1-t400-t402+t404)
     #*s23r+512.D0/3.D0*t83*t407+t411-512.D0/3.D0*t319*t33)*s1vr+(-512.D
     #0/3.D0*t392-512.D0/3.D0*t393)*t326+((-1024.D0/3.D0*t295*t33-512.D0
     #/3.D0*t295*t36)*s34r+256.D0/3.D0*t339*t73-t404)*t122+(-t348*s2l1-5
     #12.D0/3.D0*t351*t432+(256.D0/3.D0*t360*t33+256.D0/3.D0*t179)*s34r-
     #512.D0/3.D0*t369*t33+512.D0/3.D0*t365*t36)*s23r+512.D0/3.D0*t130*t
     #407+512.D0/3.D0*t94*t432+(1024.D0/3.D0*t225*t171-t175)*s34r)*s1l2+
     #(t460*s23r+512.D0/3.D0*t462*t455-512.D0/3.D0*t462*t457)*t84+(-t460
     #*t122+((t302+t308)*s2l1+(-t400-t402)*s2l2-t478+t482)*s23r+(-t317-2
     #56.D0/3.D0*t490*t68)*s2l1+(t411+256.D0/3.D0*t490*t73)*s2l2+256*t49
     #9*t476-256*t499*t480)*s1vr
      taux8 = s1+(512.D0/3.D0*t506*t455-512.D0/3.D0*t506*t457+t478-t482)
     #*t122+((512.D0/3.D0*t344*t105+256.D0/3.D0*t97*t11)*s2l1+(-512.D0/3
     #.D0*t344*t168-256.D0/3.D0*t97*t33)*s2l2+(512*t83*t525-512*t83*t527
     #)*s34r)*s23r+(-512.D0/3.D0*t130*t105-256.D0/3.D0*t536*t68)*s2l1+(5
     #12.D0/3.D0*t130*t168+256.D0/3.D0*t536*t73)*s2l2+(-256*t113*t525+25
     #6*t113*t527)*s34r-1280.D0/3.D0*t525+1280.D0/3.D0*t527

CCC Coefficients

      tcoff11 = taux7
      tcoff12 = taux7
      tcoff13 = taux8
      tcoff14 = taux8

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet11 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff11)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet12 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff12)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet13 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff13)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet14 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff14)

CCC Sum

      ggrmnum3e3 = tFjet11*tcoff11+tFjet12*tcoff12+tFjet13*tcoff13+tFjet
     #14*tcoff14
      RETURN
      END

      double precision function ggrmnum3e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux7 = 0
      t1 = -1+z
      t2 = t1**2
      t3 = l3*t2
      t4 = l3-1
      t5 = t3*t4
      t6 = 1/s4vr
      t7 = t6*s4l2
      t8 = 1/s3vr
      t12 = t6*s4l1
      t19 = t6*t8
      t20 = t19*s3l2
      t22 = t7*t8
      t27 = t19*s3l1
      t29 = t12*t8
      t36 = t2*t1
      t38 = t4**2
      t39 = l3*t36*t38
      t40 = t8*s34r
      t43 = t1*t4
      t58 = l3**2
      t59 = t2*t58
      t63 = 512.D0/3.D0*t59*t20-512.D0/3.D0*t59*t22
      t67 = s23r**2
      t70 = t58*t36*t4
      t82 = -512.D0/3.D0*t59*t27+512.D0/3.D0*t59*t29
      t95 = t59*t6
      t96 = t8*s3l2
      t97 = t96*s2l1
      t100 = t8*s3l1
      t101 = t100*s2l2
      t105 = s4l2*t8*s3l1
      t106 = t95*t105
      t109 = s4l1*t8*s3l2
      t110 = t95*t109
      t115 = l3*t1*t6
      t129 = t3*t6
      t134 = t7*t100
      t136 = t12*t96
      t143 = t1*t6
      s1 = ((-512.D0/3.D0*t5*t7*t8*s2l1+512.D0/3.D0*t5*t12*t8*s2l2)*s1vr
     #+((-512.D0/3.D0*t5*t20+512.D0/3.D0*t5*t22)*s2l1+(512.D0/3.D0*t5*t2
     #7-512.D0/3.D0*t5*t29)*s2l2)*s23r+(512.D0/3.D0*t39*t7*t40+512.D0/3.
     #D0*t43*t20+512.D0/3.D0*t43*t22)*s2l1+(-512.D0/3.D0*t39*t12*t40-512
     #.D0/3.D0*t43*t27-512.D0/3.D0*t43*t29)*s2l2)*s13r+(t63*s23r*s1vr-t6
     #3*t67+(-512.D0/3.D0*t70*t20+512.D0/3.D0*t70*t22)*s34r*s23r)*s1l1+(
     #t82*s23r*s1vr-t82*t67+(512.D0/3.D0*t70*t27-512.D0/3.D0*t70*t29)*s3
     #4r*s23r)*s1l2+((512.D0/3.D0*t95*t97-512.D0/3.D0*t95*t101-1024.D0/3
     #.D0*t106+1024.D0/3.D0*t110)*s23r-512.D0/3.D0*t115*t97+512.D0/3.D0*
     #t115*t101+512.D0/3.D0*t115*t105-512.D0/3.D0*t115*t109)*s1vr+(1024.
     #D0/3.D0*t106-1024.D0/3.D0*t110)*t67
      taux8 = s1+(512.D0/3.D0*t129*t97-512.D0/3.D0*t129*t101+(1024.D0/3.
     #D0*t70*t134-1024.D0/3.D0*t70*t136)*s34r)*s23r-512.D0/3.D0*t143*t97
     #+512.D0/3.D0*t143*t101+(-512.D0/3.D0*t5*t134+512.D0/3.D0*t5*t136)*
     #s34r-512.D0/3.D0*t134+512.D0/3.D0*t136

CCC Coefficients

      tcoff11 = taux7
      tcoff12 = taux7
      tcoff13 = taux8
      tcoff14 = taux8

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet11 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff11)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet12 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff12)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet13 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff13)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet14 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff14)

CCC Sum

      ggrmnum3e4 = tFjet11*tcoff11+tFjet12*tcoff12+tFjet13*tcoff13+tFjet
     #14*tcoff14
      RETURN
      END

      double precision function ggrmnum4e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = 1/s4vr
      t3 = t1*t2
      t4 = 1/s3vr
      t5 = t4*s3l2
      t6 = t5*s2l1
      t9 = -2+z
      t10 = t9*t2
      t11 = s4l2*t4
      t12 = t11*s3l1
      t15 = s4l1*t4
      t16 = t15*s3l2
      t19 = t4*s3l1
      t20 = t19*s2l2
      t23 = t1**2
      t24 = l3*t23
      t25 = l3-1
      t26 = t24*t25
      t27 = t2*s4l2
      t28 = t27*t19
      t29 = t26*t28
      t31 = t2*s4l1
      t32 = t31*t5
      t33 = t26*t32
      t35 = z*l3
      t36 = t35*t23
      t38 = t25*t2*t4
      t40 = 192*t36*t38
      t43 = t24*t2
      t48 = t23*t1
      t50 = l3**2
      t51 = t25*t48*t50
      t52 = t51*t28
      t54 = t51*t32
      t56 = t50*z
      t58 = t56*t48*t38
      t62 = t1*l3
      t65 = t62*(-3*z+1)
      t71 = t23*t2*t4
      t76 = t25**2
      t77 = t76*t25
      t78 = t77*t48
      t79 = t2*t4
      t80 = t79*s2l2
      t83 = t27*t4
      t93 = s13r**2
      t94 = t93*s13r
      t97 = t76*t48*l3
      t103 = 384*t97*t80
      t104 = t97*t83
      t108 = t23**2
      t110 = t77*t108*l3
      t112 = t79*s34r*s2l2
      t121 = t79*s2l1
      t124 = t31*t4
      t125 = t97*t124
      t130 = t79*s34r*s2l1
      t135 = 192*t104
      t139 = t31*t4*s2l2
      t144 = t76*t2*t4
      t145 = t35*t48*t144
      t149 = t79*s3l2
      t154 = t79*s3l1
      t160 = t97*t28
      t162 = t97*t32
      t164 = 384*t145
      t167 = t23*t76
      t171 = t4*s34r
      t172 = t27*t171
      t177 = z-3
      t178 = t167*t177
      t183 = t31*t171
      t197 = t167*t2
      t204 = t50*l3
      t205 = t204*t48
      t206 = s4vr**2
      t207 = 1/t206
      t208 = t207*s4l1
      t209 = s23r**2
      t210 = t209*s23r
      t214 = t50*t23
      t215 = t208*t209
      t218 = t208*s23r
      t223 = t207*s4l2
      t224 = t223*s3l1
      t226 = t208*s3l2
      t231 = t223*s2l1
      t233 = t208*s2l2
      s1 = 192*t3*t6+96*t10*t12+96*t10*t16+192*t3*t20+(-96*t29-96*t33-t4
     #0)*s34r
      s2 = s1+(-192*t43*t6-192*t43*t20+(288*t52+288*t54-192*t58)*s34r+96
     #*t65*t28+96*t65*t32+192*t35*t71)*s23r+((384*t78*t80+96*t78*t83)*s2
     #l1+96*t78*t2*t15*s2l2)*t94
      t238 = s2+((-192*t97*t79*s2l2*s1vr+(t103+96*t104)*s23r+192*t110*t1
     #12)*s1l1+(-192*t97*t79*s2l1*s1vr+(384*t97*t121+96*t125)*s23r+192*t
     #110*t130)*s1l2+((-t103-t135)*s2l1-192*t97*t139+192*t145)*s1vr+((t1
     #03+384*t97*t149+t135)*s2l1+(384*t97*t154+192*t125)*s2l2+384*t160+3
     #84*t162-t164)*s23r+(-384*t167*t9*t80+96*t110*t172-192*t167*t149-96
     #*t178*t83)*s2l1+(96*t110*t183-192*t167*t154-96*t178*t124)*s2l2-192
     #*t35*t108*t77*t2*t171-96*t197*t12-96*t197*t16)*t93+(96*t205*t208*t
     #210+192*t214*t215-288*t62*t218)*s1l2+(-192*t62*t224-192*t62*t226)*
     #s23r+(96*t78*t231+96*t78*t233)*t94
      t240 = t223*t209
      t243 = t223*s23r
      t274 = t1*t25
      t329 = t79*t209
      t332 = t214*t2
      t337 = t332*t12
      t339 = t332*t16
      t345 = t62*t2
      t364 = 384*t214*t154
      t371 = t205*t2
      t375 = t48*t50
      t379 = t204*t108*t25
      t386 = t79*s34r
      t390 = 192*t51*t386-192*t24*t79
      t393 = 384*t51*t154
      t394 = t51*t124
      t398 = t35*t1
      t421 = t50*t108*t76
      t423 = t79*s34r*s23r
      t431 = 384*t51*t149
      t432 = t51*t83
      t434 = -384*t51*t80-t431-192*t432
      t436 = t26*t80
      t443 = t177*t2
      t447 = 192*t421*t386-192*t26*t443*t4
      t456 = l3*t48*t25
      t467 = 192*t394
      t468 = -384*t51*t121-t393-t467
      t496 = 384*t58
      t529 = 2*z
      t530 = t529-3
      t531 = t530*t2
      t560 = t24*t25*t530
      t577 = t274*t9
      t596 = t274*t177
      t629 = 384*t214*t149
      s1 = -96*t224+((576*t51*t240-192*t26*t243)*s1l1+(576*t51*t215-192*
     #t26*t218)*s1l2+(96*t51*t231+96*t51*t233+384*t51*t224+384*t51*t226)
     #*t209+(576*t26*t231+576*t26*t233+192*t26*t224+192*t26*t226)*s23r+9
     #6*t274*t231+96*t274*t233-192*t274*t224-192*t274*t226)*s13r+(288*t2
     #14*t224+288*t214*t226)*t209+(96*t205*t223*t210+192*t214*t240-288*t
     #62*t243)*s1l1+(96*t97*t223*s23r*s1l1+96*t97*t208*s23r*s1l2+(576*t9
     #7*t231+576*t97*t233+384*t97*t224+384*t97*t226)*s23r+192*t167*t231+
     #192*t167*t233-96*t167*t224-96*t167*t226)*t93
      s2 = s1+(192*t204*z*t48*t329+(-192*t332*t6-192*t332*t20-576*t337-5
     #76*t339+192*t56*t71)*s23r+192*t345*t6+192*t345*t20+192*t345*t12+19
     #2*t345*t16)*s1vr+(((-192*t205*t121-192*t205*t124)*t209+(-192*t214*
     #t121-t364-192*t214*t124)*s23r)*s1vr+96*t371*t15*t210+(-192*t375*t1
     #21+96*t379*t183+t364-96*t375*t124)*t209+(t390*s2l1+(t393+96*t394)*
     #s34r-96*t398*t124)*s23r+192*t26*t130)*s1l2
      s3 = s2+(288*t337+288*t339+192*t56*t48*t2*t4)*t209
      s4 = s3-96*t226
      s5 = s4
      s10 = ((-384*t51*t79*s23r*s1vr+384*t51*t329+384*t421*t423)*s1l2+(t
     #434*s23r-192*t436)*s1vr-t434*t209+(t447*s2l2+(384*t421*t149+96*t42
     #1*t83)*s34r-96*t456*t83)*s23r+384*t97*t112)*s1l1+((t468*s23r-192*t
     #26*t121)*s1vr-t468*t209+(t447*s2l1+(384*t421*t154+96*t421*t124)*s3
     #4r-96*t456*t124)*s23r+384*t97*t130)*s1l2
      s9 = s10+((t434*s2l1+(-t393-t467)*s2l2-768*t52-768*t54+t496)*s23r+
     #(-384*t436+192*t26*t149-192*t26*t83)*s2l1+(192*t26*t154-192*t26*t1
     #24)*s2l2+192*t29+192*t33+t40)*s1vr+(96*t51*t27*t4*s2l1+96*t51*t139
     #+384*t52+384*t54-t496)*t209+((-384*t456*t80+96*t421*t172-192*t26*t
     #531*t5-96*t26*t443*t11)*s2l1+(96*t421*t183-192*t26*t531*t19-96*t26
     #*t443*t15)*s2l2+(384*t421*t28+384*t421*t32-192*t56*t108*t144)*s34r
     #-192*t560*t28-192*t560*t32+96*t36*(t529-6)*t25*t79)*s23r
      s8 = s9+(-384*t23*t25*t80+96*t97*t172+192*t577*t149-96*t577*t83)*s
     #2l1+(96*t97*t183+192*t577*t154-96*t577*t124)*s2l2+(-96*t160-96*t16
     #2-t164)*s34r+96*t596*t28+96*t596*t32
      s9 = s13r
      s7 = s8*s9
      s8 = (((-384*t205*t329-384*t214*t79*s23r)*s1vr+384*t205*t79*t210+(
     #384*t379*t386+384*t214*t79)*t209+384*t51*t423)*s1l2+((-192*t205*t8
     #0-192*t205*t83)*t209+(-192*t214*t80-t629-192*t214*t83)*s23r)*s1vr+
     #96*t371*t11*t210+(-192*t375*t80+96*t379*t172+t629-96*t375*t83)*t20
     #9+(t390*s2l2+(t431+96*t432)*s34r-96*t398*t83)*s23r+192*t26*t112)*s
     #1l1
      s6 = s7+s8
      t659 = s5+s6
      taux9 = t238+t659
      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = -1+z
      t5 = t4**2
      t6 = t5*t4
      t7 = t3*t6
      t8 = s4vr**2
      t9 = 1/t8
      t10 = t9*s4l2
      t11 = t10*s2l1
      t13 = t9*s4l1
      t14 = t13*s2l2
      t18 = s13r**2
      t19 = t18*s13r
      t22 = t2*t6*l3
      t35 = t10*s3l1
      t38 = t13*s3l2
      t43 = t5*t2
      t54 = l3**2
      t55 = t54*t6
      t56 = t55*t1
      t57 = s23r**2
      t58 = t10*t57
      t61 = l3*t5
      t62 = t61*t1
      t63 = t10*s23r
      t68 = t13*t57
      t71 = t13*s23r
      t96 = -t4
      t97 = t96*t1
      t103 = 2*t96*t1
      t110 = t54*l3
      t111 = t110*t6
      t112 = t57*s23r
      t116 = t54*t5
      t119 = l3*t4
      t145 = 1/s4vr
      t146 = t7*t145
      t147 = 1/s3vr
      t148 = s4l2*t147
      t151 = s4l1*t147
      t157 = t145*t147
      t162 = t145*s4l2
      t163 = t147*s23r
      t167 = t5**2
      t169 = t3*t167*l3
      t171 = t157*s34r*s2l2
      t180 = t145*s4l1
      t185 = t157*s34r*s2l1
      t191 = t162*t147*s2l1
      t194 = t180*t147*s2l2
      t199 = t157*s3l2
      t202 = t162*t147
      t207 = t157*s3l1
      t210 = t180*t147
      t215 = t147*s3l1
      t216 = t162*t215
      t217 = t22*t216
      t219 = t147*s3l2
      t220 = t180*t219
      t221 = t22*t220
      t225 = t147*s34r
      t226 = t162*t225
      t228 = t43*t96
      t233 = t180*t225
      t239 = t43*t145
      t240 = t148*s3l1
      t243 = t151*s3l2
      t248 = t56*t199
      t250 = t56*t202
      t252 = -1536*t248+768*t250
      t254 = t157*s2l2
      t258 = 768*t62*t199
      t264 = t54*t167*t2
      t268 = t1*t145
      t272 = 768*t264*t157*s34r+768*l3*t6*t268*t147
      t280 = 3-z
      t281 = t61*t280
      t282 = t268*t148
      t290 = t157*s3l2*s34r
      t295 = t56*t207
      t297 = t56*t210
      t299 = 1536*t295-768*t297
      t301 = t157*s2l1
      t305 = 768*t62*t207
      t318 = t268*t151
      t326 = t157*s3l1*s34r
      t333 = t56*t216
      t335 = t56*t220
      t343 = t62*t216
      t345 = t62*t220
      t359 = 2*z
      t361 = t61*(-t359+4)
      t365 = t61*t96
      t386 = t61*t1*(t359-3)
      t395 = t4*z*t1
      t408 = t96**2
      t410 = t408*t1*t145
      t423 = t116*t199
      t429 = 768*t119*t199
      t432 = t111*t145
      t439 = t110*t167*t1
      t443 = t116*t280
      t455 = t119*(-z+2)
      t470 = t116*t207
      t476 = 768*t119*t207
      t505 = t116*t145
      t506 = t219*s2l1
      t509 = t215*s2l2
      t512 = t505*t240
      t514 = t505*t243
      t518 = t119*t145
      t528 = t61*t145
      t537 = 3*t119*t4
      t547 = z*t145
      s2 = (-384*t7*t11+384*t7*t14)*t19+(-384*t22*t10*s23r*s1l1+384*t22*
     #t13*s23r*s1l2+(-2304*t22*t11+2304*t22*t14-1536*t22*t35+1536*t22*t3
     #8)*s23r-768*t43*t11+768*t43*t14+384*t43*t35-384*t43*t38)*t18+((-23
     #04*t56*t58+768*t62*t63)*s1l1+(2304*t56*t68-768*t62*t71)*s1l2+(-384
     #*t56*t11+384*t56*t14-1536*t56*t35+1536*t56*t38)*t57+(-2304*t62*t11
     #+2304*t62*t14-768*t62*t35+768*t62*t38)*s23r+384*t97*t11-384*t97*t1
     #4-384*t103*t35+384*t103*t38)*s13r+(-384*t111*t10*t112-768*t116*t58
     #+1152*t119*t63)*s1l1+(384*t111*t13*t112+768*t116*t68-1152*t119*t71
     #)*s1l2
      s1 = s2+(-1152*t116*t35+1152*t116*t38)*t57+(768*t119*t35-768*t119*
     #t38)*s23r+384*t35-384*t38+(-384*t146*t148*s2l1+384*t146*t151*s2l2)
     #*t19
      s3 = s1+((-768*t22*t157*s2l2*s1vr-384*t22*t162*t163+768*t169*t171)
     #*s1l1+(768*t22*t157*s2l1*s1vr+384*t22*t180*t163-768*t169*t185)*s1l
     #2+(768*t22*t191-768*t22*t194)*s1vr+((1536*t22*t199-768*t22*t202)*s
     #2l1+(-1536*t22*t207+768*t22*t210)*s2l2-1536*t217+1536*t221)*s23r+(
     #-384*t169*t226-384*t228*t202)*s2l1+(384*t169*t233+384*t228*t210)*s
     #2l2+384*t239*t240-384*t239*t243)*t18
      s5 = s3
      s8 = ((t252*s23r-768*t62*t254+t258)*s1vr-t252*t57+(t272*s2l2+(1536
     #*t264*t199-384*t264*t202)*s34r-t258-384*t281*t282)*s23r+768*t22*t1
     #71-768*t22*t290)*s1l1+((t299*s23r+768*t62*t301-t305)*s1vr-t299*t57
     #+(-t272*s2l1+(-1536*t264*t207+384*t264*t210)*s34r+t305+384*t281*t3
     #18)*s23r-768*t22*t185+768*t22*t326)*s1l2+((t252*s2l1+t299*s2l2+307
     #2*t333-3072*t335)*s23r+768*t62*t191-768*t62*t194-768*t343+768*t345
     #)*s1vr+(-384*t56*t191+384*t56*t194-1536*t333+1536*t335)*t57+((-384
     #*t264*t226+768*t361*t268*t219-384*t365*t282)*s2l1+(384*t264*t233-7
     #68*t361*t268*t215+384*t365*t318)*s2l2+(-1536*t264*t216+1536*t264*t
     #220)*s34r+768*t386*t216-768*t386*t220)*s23r
      s7 = s8+(-384*t22*t226+384*t395*t202)*s2l1+(384*t22*t233-384*t395*
     #t210)*s2l2+(384*t217-384*t221)*s34r-384*t410*t240+384*t410*t243
      s8 = s13r
      s6 = s7*s8
      s4 = s5+s6
      s2 = s4+(((768*t111*t254+768*t111*t202)*t57+(768*t116*t254-768*t42
     #3+768*t116*t202)*s23r+t429)*s1vr-384*t432*t148*t112+(768*t55*t254-
     #384*t439*t226+768*t423-384*t443*t202)*t57+(768*t61*t254+(768*t248-
     #384*t250)*s34r-t429-384*t455*t202)*s23r-768*t62*t290)*s1l1+(((-768
     #*t111*t301-768*t111*t210)*t57+(-768*t116*t301+768*t470-768*t116*t2
     #10)*s23r-t476)*s1vr+384*t432*t151*t112+(-768*t55*t301+384*t439*t23
     #3-768*t470+384*t443*t210)*t57+(-768*t61*t301+(-768*t295+384*t297)*
     #s34r+t476+384*t455*t210)*s23r+768*t62*t326)*s1l2
      taux10 = s2+((-1536*t505*t506+1536*t505*t509+2304*t512-2304*t514)*
     #s23r-768*t518*t240+768*t518*t243)*s1vr+(-1152*t512+1152*t514)*t57+
     #(-1536*t528*t506+1536*t528*t509+(-1152*t333+1152*t335)*s34r+384*t5
     #37*t216-384*t537*t220)*s23r+(384*t343-384*t345)*s34r-384*t547*t240
     #+384*t547*t243

CCC Coefficients

      tcoff15 = taux9
      tcoff16 = taux9
      tcoff17 = taux9
      tcoff18 = taux9
      tcoff19 = taux10
      tcoff20 = -taux10
      tcoff21 = taux10
      tcoff22 = -taux10

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet15 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff15)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet16 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff16)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet17 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff17)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = 1-l3
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet18 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff18)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet19 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff19)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet20 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff20)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet21 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff21)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = 1-l3
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet22 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff22)

CCC Sum

      ggrmnum4e0 = tFjet15*tcoff15+tFjet16*tcoff16+tFjet17*tcoff17+tFjet
     #18*tcoff18+tFjet19*tcoff19+tFjet20*tcoff20+tFjet21*tcoff21+tFjet22
     #*tcoff22
      RETURN
      END

      double precision function ggrmnum4e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -2+z
      t2 = 1/s4vr
      t3 = t1*t2
      t4 = 1/s3vr
      t6 = s4l2*t4*s3l1
      t9 = -1+z
      t10 = t9*t2
      t11 = t4*s3l2
      t12 = t11*s2l1
      t15 = s4l1*t4
      t16 = t15*s3l2
      t19 = s4vr**2
      t20 = 1/t19
      t21 = t20*s4l2
      t22 = t21*s3l1
      t24 = t20*s4l1
      t25 = t24*s3l2
      t27 = t4*s3l1
      t28 = t27*s2l2
      t31 = t9**2
      t32 = l3*t31
      t33 = l3-1
      t34 = t32*t33
      t43 = t31**2
      t44 = t33*t43
      t45 = l3**2
      t46 = t45*l3
      t48 = z*t20
      t49 = s23r**2
      t53 = t45*z
      t54 = t31*t9
      t55 = t53*t54
      t56 = t33*t20
      t60 = z*l3
      t61 = t31*t33
      t67 = t33**2
      t68 = t43*t9
      t70 = t67*t68*t46
      t71 = t48*s34r
      t74 = 3*z
      t75 = t74-1
      t77 = t54*t33
      t83 = t21*s2l1
      t86 = t24*s2l2
      t89 = t53*t43
      t91 = t67*t20*s34r
      t98 = t60*t31
      t99 = 2*z
      t107 = t9*t33
      t112 = t60*t54
      t121 = t67*t33
      t122 = t121*t43
      t123 = t122*z
      t127 = t67**2
      t129 = t127*t68*l3
      t133 = s13r**2
      t134 = t133*s13r
      t136 = z*t46
      t137 = t136*t43
      t138 = t56*s34r
      t141 = t45*t31
      t146 = t54*t20
      t151 = t32*t2
      t157 = t67*t2
      t158 = s34r**2
      t159 = t4*t158
      t160 = t157*t159
      t163 = t77*t45
      t164 = t2*s4l2
      t165 = t164*t27
      t168 = t2*s4l1
      t169 = t168*t11
      t175 = t2*t4
      t181 = t9*l3
      t183 = t181*(t99-1)
      t191 = 2*t98
      t198 = t34*t165
      t199 = t34*t169
      t204 = (-t60*t31*t1-t191)*t33*t175
      t209 = t67*t43*t45
      t213 = t54*t67
      t214 = t213*t20
      t220 = t121*t68*t45
      t223 = z+3
      t229 = t31*t67
      t245 = z*t2
      t246 = t4*s34r
      t247 = t245*t246
      t252 = t49*s23r
      t253 = t175*t252
      s1 = -96*t3*t6-192*t10*t12-96*t3*t16+96*t22+96*t25-192*t10*t28+(-9
     #6*t34*t21*s23r*s1l1-96*t34*t24*s23r*s1l2+(-480*t44*t46*t48*t49+768
     #*t55*t56*s23r+96*t60*t61*t20)*s1vr+(288*t70*t71-192*t53*t75*t77*t2
     #0)*t49+(-288*t34*t83-288*t34*t86-384*t89*t91-192*t34*t22-192*t34*t
     #25+96*t98*t33*(t99-6)*t20)*s23r-96*t107*t83-96*t107*t86-288*t112*t
     #91+96*t107*t22+96*t107*t25)*s13r
      t256 = s1+(96*t123*l3*t20*s1vr-96*t129*t71)*t134+(288*t137*t138-19
     #2*t141*t22-192*t141*t25-192*t53*t146)*t49+(192*t151*t12+192*t151*t
     #28+288*t136*t68*t160+(-192*t163*t165-192*t163*t169+96*t55*(-4*z+2)
     #*t33*t175)*s34r+96*t183*t165+96*t183*t169-96*(-t60*t31*(z+2)+t191)
     #*t2*t4)*s23r+(96*t198+96*t199-96*t204)*s34r+((480*t209*t48*s23r+19
     #2*t60*t214)*s1vr+(-192*t220*t71-96*t60*t223*t214)*s23r-96*t229*t83
     #-96*t229*t86-288*t60*t43*t121*t20*s34r)*t133+(96*t123*l3*t2*t4*s1v
     #r-96*t129*t247)*t134-96*t137*t253
      t257 = t175*s2l1
      t259 = t175*s3l1
      t260 = t141*t259
      t261 = t168*t4
      t262 = t141*t261
      t279 = t60*t9
      t285 = t175*s34r*s2l1
      t294 = t175*s2l2
      t296 = 384*t34*t294
      t297 = t164*t4
      t298 = t34*t297
      t299 = 96*t298
      t302 = t213*l3
      t304 = t175*s34r*s2l2
      t316 = 96*t34*t261
      t323 = t33*t2
      t324 = s1vr**2
      t325 = t4*t324
      t333 = t70*t247
      t349 = t157*t246
      t362 = t175*s3l2
      t371 = t43*t31
      t375 = t121*t2*t159
      t378 = z**2
      t379 = t45*t378
      t400 = t9*t1*t33
      t423 = t107*t2
      t428 = (192*t34*t175*s2l2*s1vr+(-t296-t299)*s23r-192*t302*t304)*s1
     #l1+(192*t34*t175*s2l1*s1vr+(-384*t34*t257-t316)*s23r-192*t302*t285
     #)*s1l2-192*t55*t323*t325+(-480*t137*t323*t4*t49+(-576*t333+192*t55
     #*t223*t33*t175)*s23r+(t296+192*t298)*s2l1+192*t34*t168*t4*s2l2+480
     #*t89*t349+96*t204)*s1vr+(288*t333-192*t55*t33*t75*t175)*t49+((-192
     #*t34*t362-t299)*s2l1+(-192*t34*t259-t316)*s2l2+288*t46*t371*z*t375
     #-384*t379*t43*t349-192*t198-192*t199+96*t98*(t378-1)*t33*t175)*s23
     #r+(384*t61*t294-96*t302*t164*t246+192*t107*t362+96*t400*t297)*s2l1
     #+(-96*t302*t168*t246+192*t107*t259+96*t400*t261)*s2l2-192*t53*t68*
     #t375-96*t60*t213*(-t99+3)*t2*t246+96*t423*t6+96*t423*t16
      t441 = t141*t2
      t442 = t4*s23r
      t445 = t175*t49
      t454 = t141*t362
      t455 = t141*t297
      t480 = t45**2
      t481 = t480*t43
      t482 = t48*t252
      t488 = t31*t20
      t500 = t220*t247
      t502 = z-3
      t535 = (z-4)*t2*t246
      t553 = t441*t6
      t555 = t441*t16
      t563 = t481*z
      t568 = t323*t246
      t570 = t136*t54
      t596 = t181*t2
      s1 = ((192*t141*t257+192*t260+192*t262)*s23r*s1vr+(-192*t260-96*t2
     #62)*t49+(192*t32*t257+(-192*t163*t259-96*t163*t261)*s34r+96*t279*t
     #261)*s23r-192*t34*t285)*s1l2+t428*s13r-96*t98*t138-96*t89*t160+(-2
     #88*t141*t24*t49+288*t181*t24*s23r)*s1l2+((384*t441*t442*s1vr-384*t
     #141*t445-384*t163*t175*s34r*s23r)*s1l2+(192*t141*t294+192*t454+192
     #*t455)*s23r*s1vr+(-192*t454-96*t455)*t49+(192*t32*t294+(-192*t163*
     #t362-96*t163*t297)*s34r+96*t279*t297)*s23r-192*t34*t304)*s1l1+(-96
     #*t481*t482-192*t136*t146*t49+288*t53*t488*s23r)*s1vr
      s2 = s1+(-192*t209*t245*t325+(480*t209*t245*t442+288*t500-96*t112*
     #t67*t502*t175)*s1vr+(-192*t500-96*t112*t67*t223*t175)*s23r+(-384*t
     #229*t294-96*t229*t297)*s2l1-96*t229*t2*t15*s2l2-96*z*t127*t371*t45
     #*t2*t159+96*t60*t122*t535)*t133+(-288*t141*t21*t49+288*t181*t21*s2
     #3r)*s1l1-96*t43*t46*t482
      t625 = s2+(-96*t136*t44*t535-192*t553-192*t555+96*t55*t502*t2*t4)*
     #t49+(-96*t563*t253+(-96*t480*t68*z*t568+96*t570*(t74-5)*t2*t4)*t49
     #+(192*t441*t12+192*t441*t28-672*t137*t568+384*t553+384*t555-96*(-3
     #*t379*t31+2*t53*t31)*t2*t4)*s23r-192*t596*t12-192*t596*t28+192*t55
     #*t568-192*t596*t6-192*t596*t16)*s1vr+(-192*t55*t138+96*t181*t22+96
     #*t181*t25+288*t60*t488)*s23r+(192*t563*t445+192*t570*t175*s23r)*t3
     #24
      taux9 = t256+t625
      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = -1+z
      t5 = t4**2
      t6 = t5*t4
      t7 = t3*t6
      t8 = s4vr**2
      t9 = 1/t8
      t10 = t9*s4l2
      t11 = t10*s2l1
      t13 = t9*s4l1
      t14 = t13*s2l2
      t18 = s13r**2
      t19 = t18*s13r
      t22 = t2*t6*l3
      t35 = t10*s3l1
      t38 = t13*s3l2
      t43 = t5*t2
      t54 = l3**2
      t55 = t54*t6
      t56 = t55*t1
      t57 = s23r**2
      t58 = t10*t57
      t61 = l3*t5
      t62 = t61*t1
      t63 = t10*s23r
      t68 = t13*t57
      t71 = t13*s23r
      t97 = 4*t4*t1
      t103 = 7*t4*t1
      t110 = t54*l3
      t111 = t110*t6
      t112 = t57*s23r
      t116 = t54*t5
      t119 = l3*t4
      t145 = 1/s4vr
      t146 = t7*t145
      t147 = 1/s3vr
      t148 = s4l2*t147
      t151 = s4l1*t147
      t157 = t145*t147
      t162 = t145*s4l2
      t163 = t147*s23r
      t167 = t5**2
      t169 = t3*t167*l3
      t171 = t157*s34r*s2l2
      t180 = t145*s4l1
      t185 = t157*s34r*s2l1
      t191 = t162*t147*s2l1
      t194 = t180*t147*s2l2
      t199 = t157*s3l2
      t202 = t162*t147
      t207 = t157*s3l1
      t210 = t180*t147
      t215 = t147*s3l1
      t216 = t162*t215
      t217 = t22*t216
      t219 = t147*s3l2
      t220 = t180*t219
      t221 = t22*t220
      t225 = t147*s34r
      t226 = t162*t225
      t231 = z-4
      t233 = -t4
      t237 = (-t43*t231+2*t43*t233)*t145
      t242 = t180*t225
      t251 = t43*t145
      t252 = t148*s3l1
      t255 = t151*s3l2
      s1 = (1152*t7*t11-1152*t7*t14)*t19+(1152*t22*t10*s23r*s1l1-1152*t2
     #2*t13*s23r*s1l2+(6912*t22*t11-6912*t22*t14+4608*t22*t35-4608*t22*t
     #38)*s23r+2688*t43*t11-2688*t43*t14-1152*t43*t35+1152*t43*t38)*t18+
     #((6912*t56*t58-1920*t62*t63)*s1l1+(-6912*t56*t68+1920*t62*t71)*s1l
     #2+(1152*t56*t11-1152*t56*t14+4608*t56*t35-4608*t56*t38)*t57+(8064*
     #t62*t11-8064*t62*t14+3072*t62*t35-3072*t62*t38)*s23r+384*t97*t11-3
     #84*t97*t14-384*t103*t35+384*t103*t38)*s13r+(1152*t111*t10*t112+345
     #6*t116*t58-4608*t119*t63)*s1l1+(-1152*t111*t13*t112-3456*t116*t68+
     #4608*t119*t71)*s1l2
      t260 = s1+(4224*t116*t35-4224*t116*t38)*t57+(-2688*t119*t35+2688*t
     #119*t38)*s23r-1536*t35+1536*t38+(1152*t146*t148*s2l1-1152*t146*t15
     #1*s2l2)*t19+((1536*t22*t157*s2l2*s1vr+1152*t22*t162*t163-1536*t169
     #*t171)*s1l1+(-1536*t22*t157*s2l1*s1vr-1152*t22*t180*t163+1536*t169
     #*t185)*s1l2+(-2304*t22*t191+2304*t22*t194)*s1vr+((-4608*t22*t199+2
     #304*t22*t202)*s2l1+(4608*t22*t207-2304*t22*t210)*s2l2+4608*t217-46
     #08*t221)*s23r+(1152*t169*t226+768*t43*t199+384*t237*t148)*s2l1+(-1
     #152*t169*t242-768*t43*t207-384*t237*t151)*s2l2-1152*t251*t252+1152
     #*t251*t255)*t18
      t261 = t56*t199
      t263 = t56*t202
      t265 = 4608*t261-2304*t263
      t267 = t157*s2l2
      t270 = t62*t199
      t271 = 1536*t270
      t277 = t54*t167*t2
      t285 = -1536*t277*t157*s34r-1536*l3*t6*t1*t145*t147
      t293 = -2+z
      t295 = 3-z
      t299 = (-t61*t293+2*t61*t295)*t1
      t307 = t157*s3l2*s34r
      t312 = t56*t207
      t314 = t56*t210
      t316 = -4608*t312+2304*t314
      t318 = t157*s2l1
      t321 = t62*t207
      t322 = 1536*t321
      t342 = t157*s3l1*s34r
      t349 = t56*t216
      t351 = t56*t220
      t365 = t62*t216
      t367 = t62*t220
      t381 = 2*z
      t382 = -4+t381
      t388 = -3*t61*t382*t1
      t395 = (-t61*t231+2*t61*t233)*t1
      t418 = (t61-3*t61*(t381-3))*t1*t145
      t428 = t233*t293*t1
      t432 = 3*t233
      t435 = (t4*t293-t432*z)*t1
      t456 = (t233*t231+2*t4*t233)*t1*t145
      t472 = 3840*t116*t199
      t478 = 2304*t119*t199
      t481 = t111*t145
      t488 = t110*t167*t1
      t495 = (-t116*t293+2*t116*t295)*t145
      t511 = (t119*z+3*t119*t293)*t145
      t529 = 3840*t116*t207
      t535 = 2304*t119*t207
      t563 = t116*t145
      t564 = t219*s2l1
      t567 = t215*s2l2
      t570 = t563*t252
      t572 = t563*t255
      t576 = t119*t145
      t590 = t61*t145
      t605 = (-t119*(-5*z+2)-2*t119*t432)*t145
      t612 = t4*t145
      t622 = (-2+4*z)*t145
      s6 = ((t265*s23r+2304*t62*t267-t271)*s1vr-t265*t57+(t285*s2l2+(-46
     #08*t277*t199+1152*t277*t202)*s34r+t271+384*t299*t202)*s23r-2304*t2
     #2*t171+1536*t22*t307)*s1l1+((t316*s23r-2304*t62*t318+t322)*s1vr-t3
     #16*t57+(-t285*s2l1+(4608*t277*t207-1152*t277*t210)*s34r-t322-384*t
     #299*t210)*s23r+2304*t22*t185-1536*t22*t342)*s1l2
      s5 = s6+((t265*s2l1+t316*s2l2-9216*t349+9216*t351)*s23r+(-768*t270
     #-3072*t62*t202)*s2l1+(768*t321+3072*t62*t210)*s2l2+2304*t365-2304*
     #t367)*s1vr+(1152*t56*t191-1152*t56*t194+4608*t349-4608*t351)*t57+(
     #(1152*t277*t226-768*t388*t199+384*t395*t202)*s2l1+(-1152*t277*t242
     #+768*t388*t207-384*t395*t210)*s2l2+(4608*t277*t216-4608*t277*t220)
     #*s34r+768*t418*t252-768*t418*t255)*s23r
      s4 = s5+(1536*t22*t226+768*t428*t199-384*t435*t202)*s2l1+(-1536*t2
     #2*t242-768*t428*t207+384*t435*t210)*s2l2+(-1152*t217+1152*t221)*s3
     #4r-384*t456*t252+384*t456*t255
      s5 = s13r
      s3 = s4*s5
      s4 = (((-1536*t111*t267-2304*t111*t202)*t57+(-2304*t116*t267+t472-
     #3072*t116*t202)*s23r-t478)*s1vr+1152*t481*t148*t112+(-1536*t55*t26
     #7+1152*t488*t226-t472+384*t495*t148)*t57+(-2304*t61*t267+(-3840*t2
     #61+1536*t263)*s34r+t478-384*t511*t148)*s23r+2304*t62*t307)*s1l1
      s2 = s3+s4
      s1 = s2+(((1536*t111*t318+2304*t111*t210)*t57+(2304*t116*t318-t529
     #+3072*t116*t210)*s23r+t535)*s1vr-1152*t481*t151*t112+(1536*t55*t31
     #8-1152*t488*t242+t529-384*t495*t151)*t57+(2304*t61*t318+(3840*t312
     #-1536*t314)*s34r-t535+384*t511*t151)*s23r-2304*t62*t342)*s1l2+((46
     #08*t563*t564-4608*t563*t567-8448*t570+8448*t572)*s23r-768*t576*t56
     #4+768*t576*t567+3072*t576*t252-3072*t576*t255)*s1vr+(4224*t570-422
     #4*t572)*t57
      t627 = s1+(4608*t590*t564-4608*t590*t567+(4224*t349-4224*t351)*s34
     #r-384*t605*t252+384*t605*t255)*s23r-768*t612*t564+768*t612*t567+(-
     #1536*t365+1536*t367)*s34r+384*t622*t252-384*t622*t255
      taux10 = t260+t627

CCC Coefficients

      tcoff15 = taux9
      tcoff16 = taux9
      tcoff17 = taux9
      tcoff18 = taux9
      tcoff19 = taux10
      tcoff20 = -taux10
      tcoff21 = taux10
      tcoff22 = -taux10

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet15 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff15)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet16 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff16)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet17 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff17)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = 1-l3
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet18 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff18)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet19 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff19)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet20 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff20)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet21 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff21)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = 1-l3
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet22 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff22)

CCC Sum

      ggrmnum4e1 = tFjet15*tcoff15+tFjet16*tcoff16+tFjet17*tcoff17+tFjet
     #18*tcoff18+tFjet19*tcoff19+tFjet20*tcoff20+tFjet21*tcoff21+tFjet22
     #*tcoff22
      RETURN
      END

      double precision function ggrmnum4e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = z*l3
      t2 = -1+z
      t3 = t2**2
      t4 = t1*t3
      t5 = l3-1
      t6 = s4vr**2
      t7 = 1/t6
      t8 = t5*t7
      t9 = t8*s34r
      t12 = l3**2
      t13 = t12*z
      t14 = t3*t2
      t15 = t13*t14
      t25 = t3**2
      t26 = t13*t25
      t27 = t5**2
      t28 = t27*t7
      t29 = t28*s34r
      t32 = t5*(z+3)
      t38 = t1*t14
      t44 = t12*l3*z
      t45 = t44*t25
      t48 = t14*t7
      t52 = s23r**2
      t56 = t1*t25
      t57 = t27*t5
      t63 = s13r**2
      t65 = t44*t14
      t66 = 1/s4vr
      t67 = 1/s3vr
      t68 = t66*t67
      t72 = t5*t66
      t73 = t67*s34r
      t74 = t72*t73
      t75 = t45*t74
      t77 = z**2
      t96 = s1vr**2
      t105 = t27*t66
      t107 = t26*t105*t73
      t109 = -2+z
      t121 = t25*t2
      t123 = t57*t66
      t124 = s34r**2
      t125 = t67*t124
      t140 = t3*t7
      t146 = t105*t125
      s1 = 96*t4*t9+((-192*t15*t8*s23r-96*t1*t3*t5*t7)*s1vr+(96*t26*t29+
     #96*t4*t32*t7)*s23r+192*t38*t29)*s13r+(-192*t45*t9+288*t13*t48)*t52
     #+(-96*t38*t28*s1vr+96*t56*t57*t7*s34r)*t63+(288*t65*t68*t52+(480*t
     #75-288*t12*t77*t3*t66*t67)*s23r-192*t15*t74)*s1vr+(-192*t75+288*t1
     #3*t14*t66*t67)*t52+(192*t15*t72*t67*t96+(-192*t15*t72*t67*s23r-288
     #*t107+96*t4*t109*t5*t68)*s1vr+(96*t107+96*t4*t32*t68)*s23r+96*t13*
     #t121*t123*t125-96*t1*t14*t27*(z-3)*t66*t73)*s13r
      taux9 = s1+(288*t44*t48*t52-288*t13*t140*s23r)*s1vr+96*t26*t146-96
     #*t1*t3*t109*t74+(-192*t44*t121*t146+96*t13*t14*(3*z-2)*t74-96*t4*(
     #z+2)*t66*t67)*s23r+(-96*t38*t105*t67*s1vr+96*t56*t123*t73)*t63-192
     #*t65*t68*s23r*t96+(96*t15*t9-288*t1*t140)*s23r
      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = -1+z
      t5 = t4**2
      t6 = t5*t4
      t7 = t3*t6
      t8 = s4vr**2
      t9 = 1/t8
      t10 = t9*s4l2
      t11 = t10*s2l1
      t13 = t9*s4l1
      t14 = t13*s2l2
      t18 = s13r**2
      t19 = t18*s13r
      t22 = t2*t6*l3
      t23 = s23r*s1l1
      t27 = s23r*s1l2
      t35 = t10*s3l1
      t38 = t13*s3l2
      t43 = t5*t2
      t54 = l3**2
      t56 = t54*t6*t1
      t57 = s23r**2
      t58 = t10*t57
      t61 = l3*t5
      t62 = t61*t1
      t63 = t10*s23r
      t68 = t13*t57
      t71 = t13*s23r
      t96 = -t4
      t98 = 5*t96*t1
      t104 = 7*t96*t1
      t111 = t54*l3
      t112 = t111*t6
      t113 = t57*s23r
      t117 = t54*t5
      t120 = l3*t4
      t146 = 1/s4vr
      t147 = t7*t146
      t148 = 1/s3vr
      t149 = s4l2*t148
      t152 = s4l1*t148
      t160 = l3*t6*t2*t146
      t167 = t146*s4l2
      t169 = t167*t148*s2l1
      t171 = t146*s4l1
      t173 = t171*t148*s2l2
      t178 = t146*t148
      t179 = t178*s3l2
      t182 = t167*t148
      t187 = t178*s3l1
      t190 = t171*t148
      t195 = t148*s3l1
      t196 = t167*t195
      t197 = t22*t196
      t199 = t148*s3l2
      t200 = t171*t199
      t201 = t22*t200
      t205 = t5**2
      t207 = t3*t205*l3
      t208 = t148*s34r
      t209 = t167*t208
      t214 = z-4
      t218 = (-t43+2*t43*t214)*t146
      t223 = t171*t208
      t232 = t43*t146
      t233 = t149*s3l1
      t236 = t152*s3l2
      s1 = (-768*t7*t11+768*t7*t14)*t19+(-768*t22*t10*t23+768*t22*t13*t2
     #7+(-4608*t22*t11+4608*t22*t14-3072*t22*t35+3072*t22*t38)*s23r-2688
     #*t43*t11+2688*t43*t14+768*t43*t35-768*t43*t38)*t18+((-4608*t56*t58
     #+384*t62*t63)*s1l1+(4608*t56*t68-384*t62*t71)*s1l2+(-768*t56*t11+7
     #68*t56*t14-3072*t56*t35+3072*t56*t38)*t57+(-8064*t62*t11+8064*t62*
     #t14-3840*t62*t35+3840*t62*t38)*s23r+384*t98*t11-384*t98*t14-384*t1
     #04*t35+384*t104*t38)*s13r+(-768*t112*t10*t113-4992*t117*t58+5760*t
     #120*t63)*s1l1+(768*t112*t13*t113+4992*t117*t68-5760*t120*t71)*s1l2
      t241 = s1+(-4608*t117*t35+4608*t117*t38)*t57+(2688*t120*t35-2688*t
     #120*t38)*s23r+1920*t35-1920*t38+(-768*t147*t149*s2l1+768*t147*t152
     #*s2l2)*t19+(-768*t160*t149*t23+768*t160*t152*t27+(1536*t22*t169-15
     #36*t22*t173)*s1vr+((3072*t22*t179-1536*t22*t182)*s2l1+(-3072*t22*t
     #187+1536*t22*t190)*s2l2-3072*t197+3072*t201)*s23r+(-768*t207*t209-
     #1536*t43*t179+384*t218*t149)*s2l1+(768*t207*t223+1536*t43*t187-384
     #*t218*t152)*s2l2+768*t232*t233-768*t232*t236)*t18
      t242 = t56*t179
      t244 = t56*t182
      t246 = -3072*t242+1536*t244
      t248 = t178*s2l2
      t256 = t2*t205*t54
      t263 = -2+z
      t267 = (-t61+2*t61*t263)*t1
      t278 = t56*t187
      t280 = t56*t190
      t282 = 3072*t278-1536*t280
      t284 = t178*s2l1
      t309 = t56*t196
      t311 = t56*t200
      t327 = t62*t196
      t329 = t62*t200
      t343 = 2*z
      t348 = (-t61+2*t61*(-4+t343))*t1
      t354 = (-t61+2*t61*t214)*t1
      t378 = (-3*t61+2*t61*(t343-3))*t1*t146
      t387 = 2*t4
      t390 = (1-z+t387*t263)*t1
      t393 = 3*t96
      t397 = (t393*t263-t387*z)*t1
      t416 = (1-z+t387*t214)*t1*t146
      t423 = t112*t146
      t430 = 5376*t117*t179
      t436 = 1536*t120*t179
      t443 = t111*t205*t1
      t449 = (-t117+2*t117*t263)*t146
      t466 = (-3*t120*z-2*t120*t263)*t146
      t483 = 5376*t117*t187
      t489 = 1536*t120*t187
      t517 = t117*t146
      t518 = t199*s2l1
      t521 = t195*s2l2
      t524 = t517*t233
      t526 = t517*t236
      t530 = t120*t146
      t544 = t61*t146
      t554 = 5*z
      t559 = (-t120*(t343-1)+2*t120*(-t554+2))*t146
      t566 = t393*t146
      t575 = (6-t554)*t146
      s5 = ((t246*s23r-1536*t62*t248)*s1vr-t246*t57+((3072*t256*t179-768
     #*t256*t182)*s34r+384*t267*t182)*s23r+1536*t22*t178*s34r*s2l2)*s1l1
     #+((t282*s23r+1536*t62*t284)*s1vr-t282*t57+((-3072*t256*t187+768*t2
     #56*t190)*s34r-384*t267*t190)*s23r-1536*t22*t178*s34r*s2l1)*s1l2+((
     #t246*s2l1+t282*s2l2+6144*t309-6144*t311)*s23r+(1536*t62*t179+3840*
     #t62*t182)*s2l1+(-1536*t62*t187-3840*t62*t190)*s2l2-1536*t327+1536*
     #t329)*s1vr+(-768*t56*t169+768*t56*t173-3072*t309+3072*t311)*t57+((
     #-768*t256*t209-768*t348*t179+384*t354*t182)*s2l1+(768*t256*t223+76
     #8*t348*t187-384*t354*t190)*s2l2+(-3072*t256*t196+3072*t256*t200)*s
     #34r+768*t378*t233-768*t378*t236)*s23r
      s4 = s5+(-1920*t22*t209+768*t390*t179-384*t397*t182)*s2l1+(1920*t2
     #2*t223-768*t390*t187+384*t397*t190)*s2l2+(768*t197-768*t201)*s34r-
     #384*t416*t233+384*t416*t236
      s5 = s13r
      s3 = s4*s5
      s4 = ((1536*t423*t149*t57+(1536*t117*t248-t430+3840*t117*t182)*s23
     #r+t436)*s1vr-768*t423*t149*t113+(-768*t443*t209+t430+384*t449*t149
     #)*t57+(1536*t61*t248+(5376*t242-1920*t244)*s34r-t436-384*t466*t149
     #)*s23r-1536*t62*t178*s3l2*s34r)*s1l1
      s2 = s3+s4
      s1 = s2+((-1536*t423*t152*t57+(-1536*t117*t284+t483-3840*t117*t190
     #)*s23r-t489)*s1vr+768*t423*t152*t113+(768*t443*t223-t483-384*t449*
     #t152)*t57+(-1536*t61*t284+(-5376*t278+1920*t280)*s34r+t489+384*t46
     #6*t152)*s23r+1536*t62*t178*s3l1*s34r)*s1l2+((-3840*t517*t518+3840*
     #t517*t521+9216*t524-9216*t526)*s23r+2304*t530*t518-2304*t530*t521-
     #3840*t530*t233+3840*t530*t236)*s1vr+(-4608*t524+4608*t526)*t57
      t580 = s1+(-3840*t544*t518+3840*t544*t521+(-4608*t309+4608*t311)*s
     #34r-384*t559*t233+384*t559*t236)*s23r-768*t566*t518+768*t566*t521+
     #(1920*t327-1920*t329)*s34r+384*t575*t233-384*t575*t236
      taux10 = t241+t580

CCC Coefficients

      tcoff15 = taux9
      tcoff16 = taux9
      tcoff17 = taux9
      tcoff18 = taux9
      tcoff19 = taux10
      tcoff20 = -taux10
      tcoff21 = taux10
      tcoff22 = -taux10

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet15 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff15)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet16 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff16)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet17 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff17)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = 1-l3
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet18 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff18)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet19 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff19)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet20 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff20)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet21 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff21)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = 1-l3
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet22 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff22)

CCC Sum

      ggrmnum4e2 = tFjet15*tcoff15+tFjet16*tcoff16+tFjet17*tcoff17+tFjet
     #18*tcoff18+tFjet19*tcoff19+tFjet20*tcoff20+tFjet21*tcoff21+tFjet22
     #*tcoff22
      RETURN
      END

      double precision function ggrmnum4e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux9 = 0
      t1 = -1+z
      t2 = t1**2
      t3 = l3-1
      t4 = t3**2
      t5 = t2*t4
      t6 = s4vr**2
      t7 = 1/t6
      t8 = t7*s4l2
      t9 = t8*s2l1
      t11 = t7*s4l1
      t12 = t11*s2l2
      t16 = s13r**2
      t18 = l3*t2
      t19 = t18*t3
      t20 = s23r*s1l1
      t24 = s23r*s1l2
      t32 = t8*s3l1
      t35 = t11*s3l2
      t40 = t1*t3
      t51 = l3**2
      t52 = t51*t2
      t53 = s23r**2
      t56 = l3*t1
      t81 = 1/s4vr
      t82 = t5*t81
      t83 = 1/s3vr
      t84 = s4l2*t83
      t87 = s4l1*t83
      t94 = t18*t3*t81
      t101 = t81*s4l2
      t105 = t81*s4l1
      t112 = t81*t83
      t113 = t112*s3l2
      t116 = t101*t83
      t121 = t112*s3l1
      t124 = t105*t83
      t129 = t83*s3l1
      t130 = t101*t129
      t131 = t19*t130
      t133 = t83*s3l2
      t134 = t105*t133
      t135 = t19*t134
      t139 = t2*t1
      t141 = l3*t139*t4
      t142 = t83*s34r
      t148 = -2+z
      t150 = t1*t148*t3
      t164 = t40*t81
      t165 = t84*s3l1
      t168 = t87*s3l2
      t173 = t52*t113
      t174 = t52*t116
      t184 = t51*t139*t3
      t191 = t56*z
      t198 = t52*t121
      t199 = t52*t124
      t220 = t52*t81
      t221 = t133*s2l1
      t224 = t129*s2l2
      t227 = t220*t165
      t229 = t220*t168
      t233 = t56*t81
      t247 = t18*t81
      t259 = t56*(2*z-1)
      t266 = t1*t81
      t274 = t148*t81
      s2 = (768*t5*t9-768*t5*t12)*t16+(768*t19*t8*t20-768*t19*t11*t24+(2
     #304*t19*t9-2304*t19*t12+1536*t19*t32-1536*t19*t35)*s23r+768*t40*t9
     #-768*t40*t12-768*t40*t32+768*t40*t35)*s13r+(2304*t52*t8*t53-2304*t
     #56*t8*s23r)*s1l1+(-2304*t52*t11*t53+2304*t56*t11*s23r)*s1l2+(1536*
     #t52*t32-1536*t52*t35)*t53
      s1 = s2+(-768*t56*t32+768*t56*t35)*s23r-768*t32+768*t35+(768*t82*t
     #84*s2l1-768*t82*t87*s2l2)*t16+(768*t94*t84*t20-768*t94*t87*t24+(-1
     #536*t19*t101*t83*s2l1+1536*t19*t105*t83*s2l2)*s1vr+((-1536*t19*t11
     #3+768*t19*t116)*s2l1+(1536*t19*t121-768*t19*t124)*s2l2+1536*t131-1
     #536*t135)*s23r+(768*t141*t101*t142+1536*t40*t113-768*t150*t116)*s2
     #l1+(-768*t141*t105*t142-1536*t40*t121+768*t150*t124)*s2l2-768*t164
     #*t165+768*t164*t168)*s13r
      taux10 = s1+((1536*t173-1536*t174)*s23r*s1vr+(-1536*t173+768*t174)
     #*t53+((-1536*t184*t113+768*t184*t116)*s34r-768*t191*t116)*s23r)*s1
     #l1+((-1536*t198+1536*t199)*s23r*s1vr+(1536*t198-768*t199)*t53+((15
     #36*t184*t121-768*t184*t124)*s34r+768*t191*t124)*s23r)*s1l2+((1536*
     #t220*t221-1536*t220*t224-3072*t227+3072*t229)*s23r-1536*t233*t221+
     #1536*t233*t224+1536*t233*t165-1536*t233*t168)*s1vr+(1536*t227-1536
     #*t229)*t53+(1536*t247*t221-1536*t247*t224+(1536*t184*t130-1536*t18
     #4*t134)*s34r-768*t259*t130+768*t259*t134)*s23r-1536*t266*t221+1536
     #*t266*t224+(-768*t131+768*t135)*s34r+768*t274*t165-768*t274*t168

CCC Coefficients

      tcoff15 = taux9
      tcoff16 = taux9
      tcoff17 = taux9
      tcoff18 = taux9
      tcoff19 = taux10
      tcoff20 = -taux10
      tcoff21 = taux10
      tcoff22 = -taux10

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet15 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff15)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet16 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff16)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet17 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff17)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = 1-l3
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet18 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff18)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet19 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff19)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet20 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff20)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet21 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff21)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = 1-l3
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet22 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff22)

CCC Sum

      ggrmnum4e3 = tFjet15*tcoff15+tFjet16*tcoff16+tFjet17*tcoff17+tFjet
     #18*tcoff18+tFjet19*tcoff19+tFjet20*tcoff20+tFjet21*tcoff21+tFjet22
     #*tcoff22
      RETURN
      END

      double precision function ggrmnum4e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux9 = 0
      taux10 = 0

CCC Coefficients

      tcoff15 = taux9
      tcoff16 = taux9
      tcoff17 = taux9
      tcoff18 = taux9
      tcoff19 = taux10
      tcoff20 = -taux10
      tcoff21 = taux10
      tcoff22 = -taux10

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet15 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff15)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet16 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff16)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet17 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff17)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = 1-l3
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet18 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff18)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet19 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff19)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s1vr
      t8 = t5*s23r
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet20 = Fjet(var,ndim,z,ux,-1-t4-t6+z,t6-t8-t12,t4,t8,t12,t6,-1+
     #z-t6+t12,1+t4+t8,-t4-t8-t12+z,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff20)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s23r
      t4 = 1-l3
      t6 = t4*t1*s13r
      t7 = t2*s1vr
      t9 = t1**2
      t11 = l3*t4*t9*s34r
      tFjet21 = Fjet(var,ndim,z,ux,t3,t6,t7-t3-t11,-1-t6-t7+z,t11,-1+z-t
     #7+t11,t7,-t6-t3-t11+z,1+t6+t3,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff21)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = 1-l3
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet22 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t
     #3+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff22)

CCC Sum

      ggrmnum4e4 = tFjet15*tcoff15+tFjet16*tcoff16+tFjet17*tcoff17+tFjet
     #18*tcoff18+tFjet19*tcoff19+tFjet20*tcoff20+tFjet21*tcoff21+tFjet22
     #*tcoff22
      RETURN
      END

      double precision function ggrmnum5e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = t1**2
      t3 = t2**2
      t4 = l3-1
      t5 = t4**2
      t6 = t5**2
      t8 = s4vr**2
      t9 = 1/t8
      t11 = s3vr**2
      t12 = 1/t11
      t14 = s13r**2
      t15 = t14**2
      t20 = l3*t3
      t21 = t5*t4
      t22 = t20*t21
      t23 = t9*t12
      t32 = t3*t1
      t34 = l3*t32*t6
      t55 = t23*s2l2
      t58 = t23*s3l2
      t61 = t9*s4l2
      t62 = t61*t12
      t67 = t23*s3l1
      t69 = t9*s4l1
      t70 = t69*t12
      t75 = z*l3
      t76 = t75*t3
      t77 = t21*t9
      t78 = t77*t12
      t79 = t76*t78
      t84 = t23*s2l2*s2l1
      t90 = t23*s34r
      t103 = t2*t1
      t104 = t103*t21
      t123 = t6*t9
      t124 = t12*s34r
      t131 = l3**2
      t132 = t131*t3
      t133 = t132*t5
      t137 = s23r**2
      t138 = t23*t137
      t140 = t131*t32
      t141 = t140*t21
      t148 = s1vr**2
      t153 = t133*t55
      t154 = t133*t58
      t155 = t133*t62
      t159 = t141*t90
      t160 = t5*t9
      t161 = t160*t12
      t162 = t20*t161
      t163 = -t159-t162
      t164 = 768*t163
      t167 = t23*s3l2*s34r
      t171 = l3*t103*t5
      t173 = 768*t171*t58
      t182 = 3072*t159+2304*t162
      t184 = t141*t58
      t185 = t141*t62
      t187 = 768*t184-768*t185
      t193 = t3*t2
      t195 = t131*t193*t6
      t196 = s34r**2
      t197 = t23*t196
      t199 = -2+z
      t200 = l3*t199
      t201 = t200*t3
      t202 = t77*t124
      t203 = t201*t202
      t205 = 768*t195*t197+768*t203
      t208 = t23*s3l2*t196
      t219 = t23*s2l1
      t221 = t133*t67
      t222 = t133*t70
      t228 = t23*s3l1*s34r
      t232 = 768*t171*t67
      t240 = t141*t67
      t241 = t141*t70
      t243 = 768*t240-768*t241
      t251 = t23*s3l1*t196
      t259 = t23*s3l2*s2l1
      t262 = t23*s3l1*s2l2
      t264 = t12*s3l1
      t265 = t61*t264
      t266 = t133*t265
      t267 = t12*s3l2
      t268 = t69*t267
      t269 = t133*t268
      t281 = z*t131
      t282 = t281*t3
      t283 = t282*t161
      t284 = 768*t283
      t294 = l3*(z-4)*t103
      t295 = t160*t267
      t298 = t20*t5
      t300 = 768*t298*t62
      t306 = t160*t264
      t310 = 768*t298*t70
      t313 = t141*t265
      t315 = t141*t268
      t317 = t281*t32
      t318 = t317*t78
      t326 = t76*t161
      t341 = t298*t58
      t347 = t298*t67
      t356 = z**2
      t357 = 3*z
      t358 = t356-t357+1
      t364 = t12*t196
      t365 = t61*t364
      t370 = s4l2*t12
      t376 = t103*t5
      t383 = t69*t364
      t388 = s4l1*t12
      t419 = t2*t5*t9
      t420 = t370*s3l1
      t423 = t388*s3l2
      s2 = ((1536*t133*t23*s23r*s1vr-1536*t133*t138-1536*t141*t23*s34r*s
     #23r)*s1l2+768*t133*t23*s3l2*t148+((-768*t153-768*t154+768*t155)*s2
     #3r+t164*s2l2-1536*t141*t167-t173)*s1vr+3072*t133*t23*s2l2*t137+(t1
     #82*s2l2+t187*s34r+t173-768*t171*t62)*s23r+t205*s2l2+768*t195*t208+
     #768*t22*t167)*s1l1+(768*t133*t23*s3l1*t148+((-768*t133*t219-768*t2
     #21+768*t222)*s23r+t164*s2l1-1536*t141*t228-t232)*s1vr+3072*t133*t2
     #3*s2l1*t137+(t182*s2l1+t243*s34r+t232-768*t171*t70)*s23r+t205*s2l1
     #+768*t195*t251+768*t22*t228)*s1l2+(768*t133*t259+768*t133*t262+768
     #*t266+768*t269)*t148
      s1 = s2+(((-3072*t153+1536*t154-1536*t155)*s2l1+(1536*t221-1536*t2
     #22)*s2l2+t284)*s23r+(1536*t163*s2l2+(-768*t184-768*t185)*s34r+768*
     #t294*t295-t300)*s2l1+((-768*t240-768*t241)*s34r+768*t294*t306-t310
     #)*s2l2+(-1536*t313-1536*t315+768*t318)*s34r-1536*t171*t265-1536*t1
     #71*t268+768*t326)*s1vr+(-1536*t133*t84-3072*t283)*t137+(((-1536*t1
     #59-4608*t162)*s2l2-t187*s34r+768*t341-t300)*s2l1+(-t243*s34r+768*t
     #347-t310)*s2l2-3072*t317*t202-2304*t326)*s23r
      t426 = s1+((-1536*t203-1536*t358*t2*t161)*s2l2+768*t195*t365+(-768
     #*t201*t77*t267+768*t76*t77*t370)*s34r-1536*t376*t58+768*t376*t62)*
     #s2l1+(768*t195*t383+(-768*t201*t77*t264+768*t76*t77*t388)*s34r-153
     #6*t376*t67+768*t376*t70)*s2l2+(768*t195*t265+768*t195*t268-768*t28
     #1*t193*t123*t12)*t196+(1536*t22*t265+1536*t22*t268-768*t76*t21*t19
     #9*t23)*s34r+768*t419*t420+768*t419*t423
      t428 = t131*l3
      t429 = t428*t3
      t430 = t429*t4
      t434 = t428*t32*t5
      t435 = t434*t90
      t436 = t4*t9
      t437 = t436*t12
      t438 = t132*t437
      t440 = -1536*t435-1536*t438
      t444 = t137*s23r
      t445 = t23*t444
      t453 = t428*t193*t21
      t454 = t453*t197
      t455 = t140*t5
      t456 = t455*t90
      t465 = t131*t103
      t466 = t465*t4
      t471 = t430*t55
      t473 = t430*t58
      t475 = t430*t62
      t479 = t434*t58
      t481 = t434*t62
      t485 = z+1
      t486 = t131*t485
      t487 = t486*t103
      t488 = t436*t267
      t491 = t132*t4
      t493 = 768*t491*t62
      t497 = t75*t2
      t499 = -t133*t90-t497*t437
      t500 = 768*t499
      t504 = l3*t2
      t505 = t504*t4
      t507 = 1536*t505*t58
      t516 = -2304*t435-3072*t438
      t526 = z-3
      t529 = t160*t124
      t533 = t356-4*z+1
      t535 = l3*t533*t2
      t538 = -768*t454-1536*t131*t526*t3*t529-768*t535*t437
      t545 = t486*t3
      t547 = t160*t370
      t548 = t545*t547
      t552 = t436*t370
      t553 = t497*t552
      t560 = 2*z-1
      t561 = l3*t560
      t565 = 1536*t141*t197+768*t561*t103*t529
      t582 = t430*t67
      t584 = t430*t70
      t588 = t434*t67
      t590 = t434*t70
      t594 = t436*t264
      t598 = 768*t491*t70
      t605 = 1536*t505*t67
      t627 = t160*t388
      t628 = t545*t627
      t632 = t436*t388
      t633 = t497*t632
      t646 = t430*t265
      t647 = t430*t268
      t655 = t466*t265
      t657 = t466*t268
      t663 = 768*t475
      t669 = t428*z
      t670 = t669*t3
      t671 = t670*t437
      t682 = t131*(t357-5)*t103
      t712 = l3*(-4+t357)*t2
      t731 = t2*t4
      t732 = l3*t526*t731
      t737 = t356*l3
      t739 = t737*t2*t437
      t749 = t281*t103
      t750 = t749*t488
      t752 = t749*t552
      t759 = -768*t749*t594+768*t749*t632
      t761 = t669*t32
      t764 = t282*t437
      t780 = l3*(t356+1)*t2
      t800 = t281*t3*t5
      t810 = t75*t731
      t811 = t810*t265
      t813 = t810*t268
      t831 = l3*t485*t103
      t837 = t1*t358*t4
      t840 = z*t1
      t841 = t840*t4
      t863 = t200*t376
      t873 = t731*t9
      s3 = (((-3072*t430*t138+t440*s23r)*s1vr+3072*t430*t445+(4608*t435+
     #1536*t438)*t137+(1536*t454+1536*t456)*s23r)*s1l2+(-1536*t430*t23*s
     #3l2*s23r+1536*t466*t58)*t148+((-768*t471+1536*t473-1536*t475)*t137
     #+((2304*t479-768*t481)*s34r-768*t487*t488-t493)*s23r+t500*s2l2-307
     #2*t133*t167-t507)*s1vr-1536*t430*t23*s2l2*t444+(t516*s2l2+(-768*t4
     #79+768*t481)*s34r+768*t491*t58-t493)*t137+(t538*s2l2+(-768*t453*t5
     #8+768*t453*t62)*t196+(768*t545*t295+768*t548)*s34r+t507+1536*t553)
     #*s23r+t565*s2l2+1536*t141*t208+1536*t171*t167)*s1l1
      s4 = ((-1536*t430*t23*s3l1*s23r+1536*t466*t67)*t148+((-768*t430*t2
     #19+1536*t582-1536*t584)*t137+((2304*t588-768*t590)*s34r-768*t487*t
     #594-t598)*s23r+t500*s2l1-3072*t133*t228-t605)*s1vr-1536*t430*t23*s
     #2l1*t444+(t516*s2l1+(-768*t588+768*t590)*s34r+768*t491*t67-t598)*t
     #137+(t538*s2l1+(-768*t453*t67+768*t453*t70)*t196+(768*t545*t306+76
     #8*t628)*s34r+t605+1536*t633)*s23r+t565*s2l1+1536*t141*t251+1536*t1
     #71*t228)*s1l2+((-1536*t430*t259-1536*t430*t262-1536*t646-1536*t647
     #)*s23r+1536*t466*t259+1536*t466*t262+1536*t655+1536*t657)*t148
      s2 = s3+s4
      s1 = s2+(((1536*t471-768*t473+t663)*s2l1+(-768*t582+768*t584)*s2l2
     #+768*t671)*t137+((-t440*s2l2+(768*t479+768*t481)*s34r-768*t682*t48
     #8+t493)*s2l1+((768*t588+768*t590)*s34r-768*t682*t594+t598)*s2l2+(1
     #536*t434*t265+1536*t434*t268)*s34r-1536*t491*t265-1536*t491*t268)*
     #s23r+(1536*t499*s2l2+(-768*t154-768*t155)*s34r+768*t712*t488-768*t
     #553)*s2l1+((-768*t221-768*t222)*s34r+768*t712*t594-768*t633)*s2l2+
     #(-2304*t266-2304*t269+t284)*s34r+768*t732*t265+768*t732*t268+768*t
     #739)*s1vr+1536*t670*t436*t12*t444+((1536*t491*t55-768*t750+768*t75
     #2)*s2l1+t759*s2l2+2304*t761*t529+3072*t764)*t137
      t878 = s1+(((1536*t456+1536*t20*t437)*s2l2+(768*t455*t58+768*t548)
     #*s34r-768*t535*t488+768*t780*t552)*s2l1+((768*t455*t67+768*t628)*s
     #34r-768*t535*t594+768*t780*t632)*s2l2+768*t669*t193*t77*t364+(1536
     #*t800*t265+1536*t800*t268+1536*t282*t5*t526*t23)*s34r+1536*t811+15
     #36*t813+768*t497*t533*t4*t23)*s23r+((-1536*t298*t90-1536*z*t2*t437
     #)*s2l2+768*t141*t365+(-768*t341+768*t831*t547)*s34r+768*t837*t58+7
     #68*t841*t62)*s2l1+(768*t141*t383+(-768*t347+768*t831*t627)*s34r+76
     #8*t837*t67+768*t841*t70)*s2l2+(768*t313+768*t315-1536*t318)*t196+(
     #-768*t863*t265-768*t863*t268-768*t75*t103*t5*t560*t23)*s34r-768*t8
     #73*t420-768*t873*t423
      t880 = t131**2
      t881 = t880*t3
      t885 = t880*t32*t4
      t886 = t885*t90
      t887 = t429*t23
      t888 = t886+t887
      t893 = t2*t9*t12
      t894 = t281*t893
      t895 = -t430*t90-t894
      t900 = t137**2
      t913 = t436*t124
      t914 = t428*t199*t3*t913
      t918 = t434*t197
      t925 = t881*t9
      t930 = t428*t103*t9
      t934 = t131*t2
      t945 = 768*t888
      t954 = t428*(z+2)*t103
      t961 = 768*t895
      t966 = t281*t2
      t975 = t1*l3
      t977 = 768*t975*t58
      t981 = t669*t103
      t989 = 768*t914+768*t132*t23
      t992 = t428*t485*t3
      t1009 = -768*t918-1536*t491*t90-768*t75*t893
      t1016 = t737*t1
      t1024 = 768*t133*t197+768*t497*t913
      t1074 = 768*t975*t67
      t1111 = t267*s2l1
      t1113 = t264*s2l2
      t1127 = t934*t9
      t1138 = t880*z
      t1143 = t428*t560*t103
      t1156 = t3*t9*t12
      t1162 = t131*t560*t2
      t1172 = t131*(t357-1)*t2
      t1177 = t356*t131
      t1182 = t561*t1
      t1190 = t504*t9
      t1205 = t1177*t2
      t1216 = t160*t364
      t1220 = t281*t103*t4
      t1236 = t840*t9
      t1246 = z*t9
      s2 = -1536*t3*t6*t9*t12*s2l2*s2l1*t15+((768*t22*t23*s2l2*s1vr-1536
     #*t22*t23*s2l2*s23r-768*t34*t23*s34r*s2l2)*s1l1+(768*t22*t23*s2l1*s
     #1vr-1536*t22*t23*s2l1*s23r-768*t34*t23*s34r*s2l1)*s1l2+((1536*t22*
     #t55-768*t22*t58+768*t22*t62)*s2l1+(-768*t22*t67+768*t22*t70)*s2l2-
     #768*t79)*s1vr+(3072*t22*t84+1536*t79)*s23r+((1536*t34*t90+3072*t3*
     #t21*t23)*s2l2+(768*t34*t58-768*t34*t62)*s34r+768*t104*t58-768*t104
     #*t62)*s2l1+((768*t34*t67-768*t34*t70)*s34r+768*t104*t67-768*t104*t
     #70)*s2l2+768*t75*t32*t123*t124)*t14*s13r+t426*t14+t878*s13r
      s4 = s2
      s7 = ((1536*t881*t445+1536*t888*t137+1536*t895*s23r)*s1vr-1536*t88
     #1*t23*t900+(-3072*t886-1536*t887)*t444+(-1536*t880*t193*t5*t197-15
     #36*t914+1536*t894)*t137+(1536*t918+1536*t749*t913)*s23r)*s1l2+(768
     #*t925*t267*t137-1536*t930*t267*s23r+768*t934*t58)*t148+((768*t881*
     #t55-768*t881*t58+768*t881*t62)*t444+(t945*s2l2+(-768*t885*t58+768*
     #t885*t62)*s34r+768*t954*t58+768*t429*t62)*t137+(t961*s2l2+(2304*t4
     #73-t663)*s34r-768*t966*t58-768*t966*t62)*s23r-1536*t466*t167-t977)
     #*s1vr+(768*t429*t55-768*t981*t58+768*t981*t62)*t444
      s6 = s7+(t989*s2l2+(-768*t992*t488+768*t670*t552)*s34r+768*t465*t5
     #8+768*t749*t62)*t137+(t1009*s2l2-768*t434*t208+(768*t750-768*t752)
     #*s34r+t977-768*t1016*t62)*s23r+t1024*s2l2+768*t133*t208+768*t505*t
     #167
      s7 = s1l1
      s5 = s6*s7
      s3 = s4+s5
      s4 = s3+((768*t925*t264*t137-1536*t930*t264*s23r+768*t934*t67)*t14
     #8+((768*t881*t219-768*t881*t67+768*t881*t70)*t444+(t945*s2l1+(-768
     #*t885*t67+768*t885*t70)*s34r+768*t954*t67+768*t429*t70)*t137+(t961
     #*s2l1+(2304*t582-768*t584)*s34r-768*t966*t67-768*t966*t70)*s23r-15
     #36*t466*t228-t1074)*s1vr+(768*t429*t219-768*t981*t67+768*t981*t70)
     #*t444+(t989*s2l1+(-768*t992*t594+768*t670*t632)*s34r+768*t465*t67+
     #768*t749*t70)*t137+(t1009*s2l1-768*t434*t251-t759*s34r+t1074-768*t
     #1016*t70)*s23r+t1024*s2l1+768*t133*t251+768*t505*t228)*s1l2
      s1 = s4+((768*t925*t1111+768*t925*t1113+768*t925*t420+768*t925*t42
     #3)*t137+(-1536*t930*t1111-1536*t930*t1113-1536*t930*t420-1536*t930
     #*t423)*s23r+768*t1127*t1111+768*t1127*t1113+768*t1127*t420+768*t11
     #27*t423)*t148+(-768*t1138*t3*t445+(768*t1143*t259+768*t1143*t262-7
     #68*t1138*t32*t913+1536*t981*t265+1536*t981*t268-768*t669*t1156)*t1
     #37+(-1536*t1162*t259-1536*t1162*t262+(768*t646+768*t647+768*t671)*
     #s34r-768*t1172*t265-768*t1172*t268+768*t1177*t893)*s23r+768*t1182*
     #t259+768*t1182*t262+(-768*t655-768*t657)*s34r+768*t1190*t420+768*t
     #1190*t423)*s1vr
      taux11 = s1-768*t670*t445+(768*t749*t259+768*t749*t262-768*t669*t3
     #*t199*t913+768*t1205*t265+768*t1205*t268-768*t281*t1156)*t137+(-15
     #36*t497*t259-1536*t497*t262+768*t761*t1216+(768*t1220*t265+768*t12
     #20*t268+1536*t764)*s34r-768*t497*t265-768*t497*t268+768*t737*t893)
     #*s23r+768*t1236*t1111+768*t1236*t1113-768*t282*t1216+(-768*t811-76
     #8*t813-768*t739)*s34r-768*t1246*t420-768*t1246*t423
      t1 = -1+z
      t2 = t1**2
      t3 = t2**2
      t4 = l3*t3
      t5 = l3-1
      t6 = t5**2
      t7 = t6*t5
      t8 = t4*t7
      t9 = s4vr**2
      t10 = 1/t9
      t11 = s3vr**2
      t12 = 1/t11
      t13 = t10*t12
      t17 = t3*t1
      t18 = l3*t17
      t19 = t6**2
      t20 = t18*t19
      t21 = s34r*s2l2
      t30 = s34r*s2l1
      t36 = t13*s3l2
      t38 = t10*s4l2
      t39 = t38*t12
      t44 = t13*s3l1
      t46 = t10*s4l1
      t47 = t46*t12
      t67 = s13r**2
      t70 = l3**2
      t71 = t70*t3
      t72 = t71*t6
      t73 = s1vr**2
      t78 = t13*s2l2
      t81 = t72*t36
      t83 = t72*t39
      t84 = 3072*t83
      t88 = t70*t17*t7
      t89 = t13*s34r
      t90 = t88*t89
      t91 = t6*t10
      t93 = t4*t91*t12
      t95 = -3072*t90-3072*t93
      t98 = t13*s3l2*s34r
      t101 = t2*t1
      t102 = l3*t101
      t103 = t102*t6
      t105 = 6144*t103*t36
      t110 = 6144*t90-3072*t93
      t112 = t88*t36
      t113 = t88*t39
      t115 = 3072*t112+3072*t113
      t121 = t3*t2
      t123 = t70*t121*t19
      t124 = s34r**2
      t125 = t13*t124
      t130 = 3072*t123*t125+3072*t18*t7*t89
      t133 = t13*s3l2*t124
      t144 = t13*s2l1
      t147 = t72*t44
      t149 = t72*t47
      t150 = 3072*t149
      t156 = t13*s3l1*s34r
      t160 = 6144*t103*t44
      t165 = t88*t44
      t166 = t88*t47
      t168 = -3072*t165-3072*t166
      t177 = t13*s3l1*t124
      t185 = t13*s3l2*s2l1
      t188 = t13*s3l1*s2l2
      t190 = t12*s3l1
      t191 = t38*t190
      t192 = t72*t191
      t193 = t12*s3l2
      t194 = t46*t193
      t195 = t72*t194
      t210 = -z+3
      t211 = t210*t10
      t212 = t211*t193
      t215 = t4*t6
      t223 = t211*t190
      t232 = t88*t191-t88*t194
      t243 = -z-1
      t244 = t243*t10
      t248 = s4l2*t12
      t259 = s4l1*t12
      t267 = t12*t124
      t268 = t38*t267
      t272 = -t1
      t273 = t272*t10
      t274 = t273*t248
      t281 = t46*t267
      t285 = t273*t259
      t304 = t70*l3
      t305 = t304*t3
      t306 = t305*t5
      t310 = t70*t101
      t311 = t310*t5
      t318 = t306*t36
      t319 = 6144*t318
      t320 = t306*t39
      t323 = s23r**2
      t325 = t304*t17
      t326 = t325*t6
      t327 = t326*t89
      t328 = t5*t10
      t329 = t328*t12
      t330 = t71*t329
      t332 = 6144*t327+6144*t330
      t334 = t326*t36
      t336 = t326*t39
      t340 = t310*t272
      t341 = t328*t193
      t344 = t71*t5
      t346 = 3072*t344*t39
      t350 = z*l3
      t351 = t350*t2
      t354 = -3072*t72*t89-3072*t351*t329
      t358 = l3*t2
      t359 = -t210
      t360 = t358*t359
      t362 = 3072*t360*t341
      t367 = -3072*t327+6144*t330
      t372 = t310*t210
      t375 = t328*t248
      t381 = t304*t121*t7
      t385 = -3072*t381*t125+3072*t4*t329
      t393 = (-z+2)*t10
      t397 = (-z-2)*t10
      t402 = (-3072*t72*t393*t193+3072*t72*t397*t248)*s34r
      t404 = -3*z+1
      t405 = t358*t404
      t411 = t350*t101
      t416 = 3072*t88*t125+3072*t411*t91*t12*s34r
      t421 = t102*t6*t359
      t435 = t306*t44
      t436 = 6144*t435
      t437 = t306*t47
      t443 = t326*t44
      t445 = t326*t47
      t449 = t328*t190
      t453 = 3072*t344*t47
      t461 = 3072*t360*t449
      t471 = t328*t259
      t489 = (3072*t72*t393*t190-3072*t72*t397*t259)*s34r
      t504 = t306*t191
      t505 = t306*t194
      t513 = t311*t191
      t515 = t311*t194
      t531 = 3*t310*t272
      t557 = 2*z
      t558 = -t557+3
      t559 = t358*t558
      t580 = l3*t359*t2*t5
      t587 = t310*t243
      t600 = z**2
      t602 = t358*(z+2-t600)
      t606 = t358*(-t600-z)
      t617 = t70*z
      t619 = t617*t3*t6
      t626 = t358*t243*t5
      t635 = t558*t10
      t660 = t102*t6*t210
      t668 = t70**2
      t669 = t668*t3
      t670 = t669*t10
      t674 = t304*t101
      t675 = t674*t10
      t679 = t70*t2
      t689 = t323*s23r
      t692 = t668*t17*t5
      t696 = -3072*t692*t89-3072*t305*t13
      t703 = t674*t243
      t712 = t2*t10*t12
      t715 = 3072*t306*t89+3072*t617*t712
      t721 = t679*(-t557+1)
      t724 = t617*t2
      t729 = t311*t98
      t732 = 3072*t358*t36
      t736 = t674*t272
      t746 = -3072*t325*t5*t89-3072*t71*t13
      t748 = t305*t272
      t763 = 3072*t344*t89+3072*t350*t712
      t766 = 2*t310*t272
      t772 = t350*t1
      t777 = t102*t5
      t822 = t311*t156
      t825 = 3072*t358*t44
      t862 = t193*s2l1
      t864 = t190*s2l2
      t866 = t248*s3l1
      t868 = t259*s3l2
      t880 = t679*t10
      t892 = t304*z*t101
      t901 = t679*t404
      t916 = -t70*t404*t2
      t924 = t1*l3*t272
      t936 = t358*t10
      t946 = t679*(-t600+1)
      t953 = t358*t243
      t963 = t272*t5
      t964 = t310*t963
      t976 = t102*t328
      t983 = t358*t963
      s3 = ((3072*t8*t13*s2l2*s1vr-3072*t20*t13*t21)*s1l1+(-3072*t8*t13*
     #s2l1*s1vr+3072*t20*t13*t30)*s1l2+((-3072*t8*t36-3072*t8*t39)*s2l1+
     #(3072*t8*t44+3072*t8*t47)*s2l2)*s1vr+(3072*t20*t36+3072*t20*t39)*s
     #34r*s2l1+(-3072*t20*t44-3072*t20*t47)*s34r*s2l2)*t67*s13r
      s8 = (3072*t72*t13*s3l2*t73+((-9216*t72*t78-3072*t81-t84)*s23r+t95
     #*s2l2-6144*t88*t98-t105)*s1vr+(t110*s2l2+t115*s34r+t105+6144*t103*
     #t39)*s23r+t130*s2l2+3072*t123*t133+6144*t8*t98)*s1l1+(-3072*t72*t1
     #3*s3l1*t73+((9216*t72*t144+3072*t147+t150)*s23r-t95*s2l1+6144*t88*
     #t156+t160)*s1vr+(-t110*s2l1+t168*s34r-t160-6144*t103*t47)*s23r-t13
     #0*s2l1-3072*t123*t177-6144*t8*t156)*s1l2
      s7 = s8+(3072*t72*t185-3072*t72*t188-3072*t192+3072*t195)*t73+(((6
     #144*t81+6144*t83)*s2l1+(-6144*t147-6144*t149)*s2l2)*s23r+((-3072*t
     #112+3072*t113)*s34r-3072*t103*t212+3072*t215*t39)*s2l1+((3072*t165
     #-3072*t166)*s34r+3072*t103*t223-3072*t215*t47)*s2l2+6144*t232*s34r
     #+6144*t103*t191-6144*t103*t194)*s1vr
      s6 = s7+((-t115*s34r-3072*t103*t244*t193-3072*t103*t244*t248)*s2l1
     #+(-t168*s34r+3072*t103*t244*t190+3072*t103*t244*t259)*s2l2)*s23r+(
     #-3072*t123*t268+(3072*t8*t212+3072*t8*t274)*s34r)*s2l1+(3072*t123*
     #t281+(-3072*t8*t223-3072*t8*t285)*s34r)*s2l2+(-3072*t123*t191+3072
     #*t123*t194)*t124+(-6144*t8*t191+6144*t8*t194)*s34r
      s7 = t67
      s5 = s6*s7
      s10 = ((-6144*t306*t13*s3l2*s23r+6144*t311*t36)*t73+((9216*t306*t7
     #8+t319+6144*t320)*t323+(t332*s2l2+(9216*t334+3072*t336)*s34r+3072*
     #t340*t341+t346)*s23r+t354*s2l2-9216*t72*t98+t362)*s1vr+(t367*s2l2+
     #(-3072*t334-3072*t336)*s34r-3072*t372*t341-3072*t372*t375)*t323+(t
     #385*s2l2+(-3072*t381*t36-3072*t381*t39)*t124+t402-t362+3072*t405*t
     #375)*s23r+t416*s2l2+3072*t88*t133-3072*t421*t98)*s1l1
      s11 = ((6144*t306*t13*s3l1*s23r-6144*t311*t44)*t73+((-9216*t306*t1
     #44-t436-6144*t437)*t323+(-t332*s2l1+(-9216*t443-3072*t445)*s34r-30
     #72*t340*t449-t453)*s23r-t354*s2l1+9216*t72*t156-t461)*s1vr+(-t367*
     #s2l1+(3072*t443+3072*t445)*s34r+3072*t372*t449+3072*t372*t471)*t32
     #3+(-t385*s2l1+(3072*t381*t44+3072*t381*t47)*t124+t489+t461-3072*t4
     #05*t471)*s23r-t416*s2l1-3072*t88*t177+3072*t421*t156)*s1l2
      s9 = s10+s11
      s8 = s9+((-6144*t306*t185+6144*t306*t188+6144*t504-6144*t505)*s23r
     #+6144*t311*t185-6144*t311*t188-6144*t513+6144*t515)*t73+(((-3072*t
     #318-3072*t320)*s2l1+(3072*t435+3072*t437)*s2l2)*t323+(((3072*t334-
     #3072*t336)*s34r+3072*t531*t341-t346)*s2l1+((-3072*t443+3072*t445)*
     #s34r-3072*t531*t449+t453)*s2l2+(-6144*t326*t191+6144*t326*t194)*s3
     #4r+6144*t344*t191-6144*t344*t194)*s23r+((-6144*t81+t84)*s34r-3072*
     #t559*t341+3072*t351*t375)*s2l1+((6144*t147-t150)*s34r+3072*t559*t4
     #49-3072*t351*t471)*s2l2+(9216*t192-9216*t195)*s34r-3072*t580*t191+
     #3072*t580*t194)*s1vr+((3072*t587*t341+3072*t587*t375)*s2l1+(-3072*
     #t587*t449-3072*t587*t471)*s2l2)*t323
      s7 = s8+((t402+3072*t602*t341+3072*t606*t375)*s2l1+(t489-3072*t602
     #*t449-3072*t606*t471)*s2l2+(-6144*t619*t191+6144*t619*t194)*s34r+6
     #144*t626*t191-6144*t626*t194)*s23r+(-3072*t88*t268+(3072*t103*t635
     #*t193-3072*t411*t91*t248)*s34r)*s2l1+(3072*t88*t281+(-3072*t103*t6
     #35*t190+3072*t411*t91*t259)*s34r)*s2l2-3072*t232*t124+(-3072*t660*
     #t191+3072*t660*t194)*s34r
      s8 = s13r
      s6 = s7*s8
      s4 = s5+s6
      s2 = s3+s4
      s3 = s2+((3072*t670*t193*t323-6144*t675*t193*s23r+3072*t679*t36)*t
     #73+((-3072*t669*t78-3072*t669*t36-3072*t669*t39)*t689+(t696*s2l2+(
     #-3072*t692*t36-3072*t692*t39)*s34r-3072*t703*t36-3072*t305*t39)*t3
     #23+(t715*s2l2+(t319+3072*t320)*s34r+3072*t721*t36+3072*t724*t39)*s
     #23r-3072*t729+t732)*s1vr+(-3072*t305*t78+3072*t736*t36+3072*t736*t
     #39)*t689+(t746*s2l2+(3072*t748*t341+3072*t748*t375)*s34r+6144*t310
     #*t36+3072*t340*t39)*t323+(t763*s2l2+(-3072*t766*t341-3072*t340*t37
     #5)*s34r-t732-3072*t772*t274)*s23r-3072*t777*t98)*s1l1
      s4 = s3
      s6 = ((-3072*t670*t190*t323+6144*t675*t190*s23r-3072*t679*t44)*t73
     #+((3072*t669*t144+3072*t669*t44+3072*t669*t47)*t689+(-t696*s2l1+(3
     #072*t692*t44+3072*t692*t47)*s34r+3072*t703*t44+3072*t305*t47)*t323
     #+(-t715*s2l1+(-t436-3072*t437)*s34r-3072*t721*t44-3072*t724*t47)*s
     #23r+3072*t822-t825)*s1vr+(3072*t305*t144-3072*t736*t44-3072*t736*t
     #47)*t689+(-t746*s2l1+(-3072*t748*t449-3072*t748*t471)*s34r-6144*t3
     #10*t44-3072*t340*t47)*t323+(-t763*s2l1+(3072*t766*t449+3072*t340*t
     #471)*s34r+t825+3072*t772*t285)*s23r+3072*t777*t156)*s1l2
      s7 = ((3072*t670*t862-3072*t670*t864-3072*t670*t866+3072*t670*t868
     #)*t323+(-6144*t675*t862+6144*t675*t864+6144*t675*t866-6144*t675*t8
     #68)*s23r+3072*t880*t862-3072*t880*t864-3072*t880*t866+3072*t880*t8
     #68)*t73
      s5 = s6+s7
      s1 = s4+s5
      taux12 = s1+((6144*t892*t185-6144*t892*t188-6144*t892*t191+6144*t8
     #92*t194)*t323+((3072*t306*t98+3072*t901*t36)*s2l1+(-3072*t306*t156
     #-3072*t901*t44)*s2l2+(-3072*t504+3072*t505)*s34r+3072*t916*t191-30
     #72*t916*t194)*s23r+(-3072*t729-3072*t924*t36)*s2l1+(3072*t822+3072
     #*t924*t44)*s2l2+(3072*t513-3072*t515)*s34r-3072*t936*t866+3072*t93
     #6*t868)*s1vr+(-3072*t587*t185+3072*t587*t188+3072*t946*t191-3072*t
     #946*t194)*t323+((3072*t344*t98+3072*t953*t36)*s2l1+(-3072*t344*t15
     #6-3072*t953*t44)*s2l2+(3072*t964*t191-3072*t964*t194)*s34r-3072*t9
     #53*t191+3072*t953*t194)*s23r-3072*t976*t193*t30+3072*t976*t190*t21
     #+(-3072*t983*t191+3072*t983*t194)*s34r

CCC Coefficients

      tcoff23 = taux11
      tcoff24 = taux12

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet23 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff23)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet24 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff24)

CCC Sum

      ggrmnum5e0 = tFjet23*tcoff23+tFjet24*tcoff24
      RETURN
      END

      double precision function ggrmnum5e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = t1**2
      t3 = t2**2
      t4 = l3-1
      t5 = t4**2
      t6 = t5**2
      t8 = s4vr**2
      t9 = 1/t8
      t11 = s3vr**2
      t12 = 1/t11
      t14 = s13r**2
      t15 = t14**2
      t20 = l3*t3
      t21 = t5*t4
      t22 = t20*t21
      t23 = t9*t12
      t32 = t3*t1
      t34 = l3*t32*t6
      t55 = t23*s2l2
      t58 = t23*s3l2
      t61 = t9*s4l2
      t62 = t61*t12
      t67 = t23*s3l1
      t69 = t9*s4l1
      t70 = t69*t12
      t75 = z*l3
      t76 = t75*t3
      t77 = t21*t9
      t79 = t76*t77*t12
      t84 = t23*s2l2*s2l1
      t90 = t23*s34r
      t93 = t3*t21
      t103 = t2*t1
      t104 = t103*t21
      t124 = t12*s34r
      t131 = l3**2
      t132 = t131*t3
      t133 = t132*t5
      t137 = s23r**2
      t138 = t23*t137
      t140 = t131*t32
      t141 = t140*t21
      t148 = s1vr**2
      t153 = t133*t55
      t154 = t133*t58
      t155 = t133*t62
      t159 = t141*t90
      t160 = t5*t9
      t161 = t160*t12
      t162 = t20*t161
      t163 = t159+t162
      t164 = 768*t163
      t167 = t23*s3l2*s34r
      t171 = l3*t103*t5
      t173 = 768*t171*t58
      t182 = -3072*t159-2304*t162
      t184 = t141*t58
      t185 = t141*t62
      t187 = -768*t184+768*t185
      t193 = t3*t2
      t195 = t131*t193*t6
      t196 = s34r**2
      t197 = t23*t196
      t199 = -2+z
      t200 = l3*t199
      t201 = t200*t3
      t202 = t77*t124
      t203 = t201*t202
      t205 = -768*t195*t197-768*t203
      t208 = t23*s3l2*t196
      t219 = t23*s2l1
      t221 = t133*t67
      t222 = t133*t70
      t228 = t23*s3l1*s34r
      t232 = 768*t171*t67
      t240 = t141*t67
      t241 = t141*t70
      t243 = -768*t240+768*t241
      t251 = t23*s3l1*t196
      t259 = t23*s3l2*s2l1
      t262 = t23*s3l1*s2l2
      t264 = t12*s3l1
      t265 = t61*t264
      t266 = t133*t265
      t267 = t12*s3l2
      t268 = t69*t267
      t269 = t133*t268
      t270 = z*t131
      t271 = z+1
      t272 = t270*t271
      t273 = t3*t5
      t287 = t270*t3
      t288 = t287*t161
      t299 = l3*(z-4)*t103
      t300 = t160*t267
      t303 = t20*t5
      t305 = 768*t303*t62
      t311 = t160*t264
      t315 = 768*t303*t70
      t318 = t141*t265
      t320 = t141*t268
      t322 = t32*t21
      t323 = 2*z
      t327 = t270*t322
      t338 = t103*t5
      t359 = t303*t58
      t365 = t303*t67
      t376 = z**2
      t377 = 3*z
      t378 = t376-t377+1
      t384 = t12*t196
      t385 = t61*t384
      t390 = s4l2*t12
      t402 = t69*t384
      t407 = s4l1*t12
      t421 = t376*t131
      t422 = t193*t6
      t435 = t376*l3
      t446 = t2*t5*t9
      t447 = t390*s3l1
      t450 = t407*s3l2
      s2 = ((-1536*t133*t23*s23r*s1vr+1536*t133*t138+1536*t141*t23*s34r*
     #s23r)*s1l2-768*t133*t23*s3l2*t148+((768*t153+768*t154-768*t155)*s2
     #3r+t164*s2l2+1536*t141*t167+t173)*s1vr-3072*t133*t23*s2l2*t137+(t1
     #82*s2l2+t187*s34r-t173+768*t171*t62)*s23r+t205*s2l2-768*t195*t208-
     #768*t22*t167)*s1l1+(-768*t133*t23*s3l1*t148+((768*t133*t219+768*t2
     #21-768*t222)*s23r+t164*s2l1+1536*t141*t228+t232)*s1vr-3072*t133*t2
     #3*s2l1*t137+(t182*s2l1+t243*s34r-t232+768*t171*t70)*s23r+t205*s2l1
     #-768*t195*t251-768*t22*t228)*s1l2+(-768*t133*t259-768*t133*t262-76
     #8*t266-768*t269-768*t272*t273*t23)*t148
      s1 = s2+(((3072*t153-1536*t154+1536*t155)*s2l1+(-1536*t221+1536*t2
     #22)*s2l2-768*t288)*s23r+(1536*t163*s2l2+(768*t184+768*t185)*s34r-7
     #68*t299*t300+t305)*s2l1+((768*t240+768*t241)*s34r-768*t299*t311+t3
     #15)*s2l2+(1536*t318+1536*t320-768*(-t270*t322*(t323+1)+t327)*t9*t1
     #2)*s34r+1536*t171*t265+1536*t171*t268-768*(-t75*t338*t271+t75*t273
     #)*t9*t12)*s1vr+(1536*t133*t84+3072*t288)*t137+(((1536*t159+4608*t1
     #62)*s2l2-t187*s34r-768*t359+t305)*s2l1+(-t243*s34r-768*t365+t315)*
     #s2l2+3072*t270*t32*t202+2304*t76*t161)*s23r
      t453 = s1+((1536*t203+1536*t378*t2*t161)*s2l2-768*t195*t385+(768*t
     #201*t77*t267-768*t76*t77*t390)*s34r+1536*t338*t58-768*t338*t62)*s2
     #l1+(-768*t195*t402+(768*t201*t77*t264-768*t76*t77*t407)*s34r+1536*
     #t338*t67-768*t338*t70)*s2l2+(-768*t195*t265-768*t195*t268+768*(-t4
     #21*t422+t270*t422)*t9*t12)*t196+(-1536*t22*t265-1536*t22*t268+768*
     #(-t435*t93+t75*t93*t199)*t9*t12)*s34r-768*t446*t447-768*t446*t450
      t455 = t131*l3
      t456 = t455*t3
      t457 = t456*t4
      t461 = t455*t32*t5
      t462 = t461*t90
      t463 = t4*t9
      t464 = t463*t12
      t465 = t132*t464
      t467 = 1536*t462+1536*t465
      t471 = t137*s23r
      t472 = t23*t471
      t480 = t455*t193*t21
      t481 = t480*t197
      t482 = t140*t5
      t483 = t482*t90
      t492 = t131*t103
      t493 = t492*t4
      t498 = t457*t55
      t500 = t457*t58
      t502 = t457*t62
      t506 = t461*t58
      t508 = t461*t62
      t512 = t131*t271
      t513 = t512*t103
      t514 = t463*t267
      t517 = t132*t4
      t519 = 768*t517*t62
      t523 = t75*t2
      t525 = t133*t90+t523*t464
      t526 = 768*t525
      t530 = l3*t2
      t531 = t530*t4
      t533 = 1536*t531*t58
      t542 = 2304*t462+3072*t465
      t552 = z-3
      t555 = t160*t124
      t559 = t376-4*z+1
      t561 = l3*t559*t2
      t564 = 768*t481+1536*t131*t552*t3*t555+768*t561*t464
      t571 = t512*t3
      t573 = t160*t390
      t574 = t571*t573
      t578 = t463*t390
      t579 = t523*t578
      t585 = t323-1
      t586 = l3*t585
      t590 = -1536*t141*t197-768*t586*t103*t555
      t607 = t457*t67
      t609 = t457*t70
      t613 = t461*t67
      t615 = t461*t70
      t619 = t463*t264
      t623 = 768*t517*t70
      t630 = 1536*t531*t67
      t652 = t160*t407
      t653 = t571*t652
      t657 = t463*t407
      t658 = t523*t657
      t671 = t457*t265
      t672 = t457*t268
      t673 = t455*z
      t674 = t673*t271
      t676 = t3*t4*t23
      t685 = t673*t32
      t686 = t685*t555
      t688 = t493*t265
      t690 = t493*t268
      t692 = t103*t4
      t700 = 768*t502
      t706 = t673*t3
      t718 = t131*(t377-5)*t103
      t732 = t32*t5
      t753 = l3*(-4+t377)*t2
      t770 = 768*t673*t193*t77*t384
      t773 = t421*t273
      t775 = t270*t273
      t783 = t2*t4
      t784 = l3*t552*t783
      t789 = t2*t271
      t791 = t435*t2
      t804 = t270*t103
      t805 = t804*t514
      t807 = t804*t578
      t814 = 768*t804*t619-768*t804*t657
      t817 = t287*t464
      t833 = l3*(t376+1)*t2
      t850 = t376+z
      t862 = t75*t783
      t863 = t862*t265
      t865 = t862*t268
      t888 = l3*t271*t103
      t894 = t1*t378*t4
      t897 = z*t1
      t898 = t897*t4
      t924 = t200*t338
      t937 = t783*t9
      s3 = (((3072*t457*t138+t467*s23r)*s1vr-3072*t457*t472+(-4608*t462-
     #1536*t465)*t137+(-1536*t481-1536*t483)*s23r)*s1l2+(1536*t457*t23*s
     #3l2*s23r-1536*t493*t58)*t148+((768*t498-1536*t500+1536*t502)*t137+
     #((-2304*t506+768*t508)*s34r+768*t513*t514+t519)*s23r+t526*s2l2+307
     #2*t133*t167+t533)*s1vr+1536*t457*t23*s2l2*t471+(t542*s2l2+(768*t50
     #6-768*t508)*s34r-768*t517*t58+t519)*t137+(t564*s2l2+(768*t480*t58-
     #768*t480*t62)*t196+(-768*t571*t300-768*t574)*s34r-t533-1536*t579)*
     #s23r+t590*s2l2-1536*t141*t208-1536*t171*t167)*s1l1
      s4 = ((1536*t457*t23*s3l1*s23r-1536*t493*t67)*t148+((768*t457*t219
     #-1536*t607+1536*t609)*t137+((-2304*t613+768*t615)*s34r+768*t513*t6
     #19+t623)*s23r+t526*s2l1+3072*t133*t228+t630)*s1vr+1536*t457*t23*s2
     #l1*t471+(t542*s2l1+(768*t613-768*t615)*s34r-768*t517*t67+t623)*t13
     #7+(t564*s2l1+(768*t480*t67-768*t480*t70)*t196+(-768*t571*t311-768*
     #t653)*s34r-t630-1536*t658)*s23r+t590*s2l1-1536*t141*t251-1536*t171
     #*t228)*s1l2+((1536*t457*t259+1536*t457*t262+1536*t671+1536*t672+15
     #36*t674*t676)*s23r-1536*t493*t259-1536*t493*t262+768*t686-1536*t68
     #8-1536*t690-768*t272*t692*t23)*t148
      s2 = s3+s4
      s1 = s2+(((-1536*t498+768*t500-t700)*s2l1+(768*t607-768*t609)*s2l2
     #-768*t706*t464)*t137+((-t467*s2l2+(-768*t506-768*t508)*s34r+768*t7
     #18*t514-t519)*s2l1+((-768*t613-768*t615)*s34r+768*t718*t619-t623)*
     #s2l2+(-1536*t461*t265-1536*t461*t268-1536*t674*t732*t23)*s34r+1536
     #*t517*t265+1536*t517*t268+1536*t272*t676)*s23r+(1536*t525*s2l2+(76
     #8*t154+768*t155)*s34r-768*t753*t514+768*t579)*s2l1+((768*t221+768*
     #t222)*s34r-768*t753*t619+768*t658)*s2l2-t770+(2304*t266+2304*t269-
     #768*(-3*t773+t775)*t9*t12)*s34r-768*t784*t265-768*t784*t268-768*(-
     #t75*t789+t791)*t4*t23)*s1vr-1536*t706*t463*t12*t471+((-1536*t517*t
     #55+768*t805-768*t807)*s2l1+t814*s2l2-2304*t686-3072*t817)*t137
      s2 = s1+(((-1536*t483-1536*t20*t464)*s2l2+(-768*t482*t58-768*t574)
     #*s34r+768*t561*t514-768*t833*t578)*s2l1+((-768*t482*t67-768*t653)*
     #s34r+768*t561*t619-768*t833*t657)*s2l2-t770+(-1536*t775*t265-1536*
     #t775*t268+1536*(-t270*t273*t850-t270*t273*t552)*t9*t12)*s34r-1536*
     #t863-1536*t865+768*(-2*t75*t2*t850-t75*t2*t559)*t4*t23)*s23r+((153
     #6*t303*t90+1536*z*t2*t464)*s2l2-768*t141*t385+(768*t359-768*t888*t
     #573)*s34r-768*t894*t58-768*t898*t62)*s2l1+(-768*t141*t402+(768*t36
     #5-768*t888*t652)*s34r-768*t894*t67-768*t898*t70)*s2l2
      t942 = s2+(-768*t318-768*t320+1536*(-t421*t322+t327)*t9*t12)*t196+
     #(768*t924*t265+768*t924*t268+768*(-2*t435*t338+t75*t338*t585)*t9*t
     #12)*s34r+768*t937*t447+768*t937*t450
      t944 = t131**2
      t945 = t944*t3
      t949 = t944*t32*t4
      t950 = t949*t90
      t951 = t456*t23
      t952 = -t950-t951
      t957 = t2*t9*t12
      t958 = t270*t957
      t959 = t457*t90+t958
      t964 = t137**2
      t977 = t463*t124
      t978 = t455*t199*t3*t977
      t982 = t461*t197
      t989 = t945*t9
      t994 = t455*t103*t9
      t998 = t131*t2
      t1009 = 768*t952
      t1018 = t455*(z+2)*t103
      t1025 = 768*t959
      t1030 = t270*t2
      t1039 = t1*l3
      t1041 = 768*t1039*t58
      t1045 = t673*t103
      t1053 = -768*t978-768*t132*t23
      t1056 = t455*t271*t3
      t1073 = 768*t982+1536*t517*t90+768*t75*t957
      t1080 = t435*t1
      t1088 = -768*t133*t197-768*t523*t977
      t1138 = 768*t1039*t67
      t1175 = t267*s2l1
      t1177 = t264*s2l2
      t1181 = t944*z
      t1194 = t1181*t32*t977
      t1206 = t998*t9
      t1223 = t455*t585*t103
      t1234 = z-1+2*t376
      t1244 = t131*t585*t2
      t1250 = t160*t384
      t1253 = t455*t376
      t1254 = t1253*t3
      t1263 = t131*(t377-1)*t2
      t1270 = t421*t2
      t1277 = t586*t1
      t1287 = t530*t9
      t1324 = t270*t692
      t1343 = t897*t9
      t1355 = z*t9
      s2 = 1536*t3*t6*t9*t12*s2l2*s2l1*t15+((-768*t22*t23*s2l2*s1vr+1536
     #*t22*t23*s2l2*s23r+768*t34*t23*s34r*s2l2)*s1l1+(-768*t22*t23*s2l1*
     #s1vr+1536*t22*t23*s2l1*s23r+768*t34*t23*s34r*s2l1)*s1l2+((-1536*t2
     #2*t55+768*t22*t58-768*t22*t62)*s2l1+(768*t22*t67-768*t22*t70)*s2l2
     #+768*t79)*s1vr+(-3072*t22*t84-1536*t79)*s23r+((-1536*t34*t90-3072*
     #t93*t23)*s2l2+(-768*t34*t58+768*t34*t62)*s34r-768*t104*t58+768*t10
     #4*t62)*s2l1+((-768*t34*t67+768*t34*t70)*s34r-768*t104*t67+768*t104
     #*t70)*s2l2-768*t75*t32*t6*t9*t124)*t14*s13r+t453*t14+t942*s13r
      s4 = s2
      s7 = ((-1536*t945*t472+1536*t952*t137+1536*t959*s23r)*s1vr+1536*t9
     #45*t23*t964+(3072*t950+1536*t951)*t471+(1536*t944*t193*t5*t197+153
     #6*t978-1536*t958)*t137+(-1536*t982-1536*t804*t977)*s23r)*s1l2+(-76
     #8*t989*t267*t137+1536*t994*t267*s23r-768*t998*t58)*t148+((-768*t94
     #5*t55+768*t945*t58-768*t945*t62)*t471+(t1009*s2l2+(768*t949*t58-76
     #8*t949*t62)*s34r-768*t1018*t58-768*t456*t62)*t137+(t1025*s2l2+(-23
     #04*t500+t700)*s34r+768*t1030*t58+768*t1030*t62)*s23r+1536*t493*t16
     #7+t1041)*s1vr+(-768*t456*t55+768*t1045*t58-768*t1045*t62)*t471
      s6 = s7+(t1053*s2l2+(768*t1056*t514-768*t706*t578)*s34r-768*t492*t
     #58-768*t804*t62)*t137+(t1073*s2l2+768*t461*t208+(-768*t805+768*t80
     #7)*s34r-t1041+768*t1080*t62)*s23r+t1088*s2l2-768*t133*t208-768*t53
     #1*t167
      s7 = s1l1
      s5 = s6*s7
      s3 = s4+s5
      s4 = s3+((-768*t989*t264*t137+1536*t994*t264*s23r-768*t998*t67)*t1
     #48+((-768*t945*t219+768*t945*t67-768*t945*t70)*t471+(t1009*s2l1+(7
     #68*t949*t67-768*t949*t70)*s34r-768*t1018*t67-768*t456*t70)*t137+(t
     #1025*s2l1+(-2304*t607+768*t609)*s34r+768*t1030*t67+768*t1030*t70)*
     #s23r+1536*t493*t228+t1138)*s1vr+(-768*t456*t219+768*t1045*t67-768*
     #t1045*t70)*t471+(t1053*s2l1+(768*t1056*t619-768*t706*t657)*s34r-76
     #8*t492*t67-768*t804*t70)*t137+(t1073*s2l1+768*t461*t251-t814*s34r-
     #t1138+768*t1080*t70)*s23r+t1088*s2l1-768*t133*t251-768*t531*t228)*
     #s1l2
      s5 = s4
      s7 = ((-768*t989*t1175-768*t989*t1177-768*t989*t447-768*t989*t450-
     #768*t1181*t271*t3*t9*t12)*t137+(1536*t994*t1175+1536*t994*t1177-76
     #8*t1194+1536*t994*t447+1536*t994*t450+768*t674*t103*t9*t12)*s23r-7
     #68*t1206*t1175-768*t1206*t1177+768*t706*t977-768*t1206*t447-768*t1
     #206*t450)*t148
      s8 = (768*t1181*t3*t472+(-768*t1223*t259-768*t1223*t262+1536*t1194
     #-1536*t1045*t265-1536*t1045*t268+768*(-t673*t103*t1234+t706)*t9*t1
     #2)*t137+(1536*t1244*t259+1536*t1244*t262+768*t1181*t193*t1250+(-76
     #8*t671-768*t672+768*(-t1254-t706)*t4*t23)*s34r+768*t1263*t265+768*
     #t1263*t268-768*(-t270*t2*t1234+t1270)*t9*t12)*s23r-768*t1277*t259-
     #768*t1277*t262-768*t685*t1250+(768*t688+768*t690+768*t817)*s34r-76
     #8*t1287*t447-768*t1287*t450)*s1vr
      s6 = s7+s8
      s1 = s5+s6
      taux11 = s1+768*t706*t472+(-768*t804*t259-768*t804*t262-768*(-t125
     #4-t673*t3*t199)*t4*t90-768*t1270*t265-768*t1270*t268+768*(-t270*t1
     #03*t850+t287)*t9*t12)*t137+(1536*t523*t259+1536*t523*t262-768*(-t1
     #253*t732+t673*t732)*t9*t384+(-768*t1324*t265-768*t1324*t268-1536*t
     #817)*s34r+768*t523*t265+768*t523*t268-768*(-t435*t789+t791)*t9*t12
     #)*s23r-768*t1343*t1175-768*t1343*t1177+768*(-t773+t775)*t9*t384+(7
     #68*t863+768*t865)*s34r+768*t1355*t447+768*t1355*t450
      t1 = -1+z
      t2 = t1**2
      t3 = t2**2
      t4 = l3*t3
      t5 = l3-1
      t6 = t5**2
      t7 = t6*t5
      t8 = t4*t7
      t9 = s4vr**2
      t10 = 1/t9
      t11 = s3vr**2
      t12 = 1/t11
      t13 = t10*t12
      t17 = t3*t1
      t18 = l3*t17
      t19 = t6**2
      t20 = t18*t19
      t36 = t13*s3l2
      t38 = t10*s4l2
      t39 = t38*t12
      t44 = t13*s3l1
      t46 = t10*s4l1
      t47 = t46*t12
      t59 = t2*t1
      t60 = t59*t7
      t79 = s13r**2
      t82 = l3**2
      t83 = t82*t3
      t84 = t83*t6
      t85 = s1vr**2
      t90 = t13*s2l2
      t93 = t84*t36
      t95 = t84*t39
      t96 = 12288*t95
      t99 = t82*t17
      t100 = t99*t7
      t101 = t13*s34r
      t102 = t100*t101
      t103 = t6*t10
      t105 = t4*t103*t12
      t107 = 9216*t102+9216*t105
      t110 = t13*s3l2*s34r
      t113 = l3*t59
      t114 = t113*t6
      t116 = 21504*t114*t36
      t121 = -18432*t102+9216*t105
      t123 = t100*t36
      t124 = t100*t39
      t126 = -12288*t123-12288*t124
      t132 = t3*t2
      t134 = t82*t132*t19
      t135 = s34r**2
      t136 = t13*t135
      t141 = -9216*t134*t136-9216*t18*t7*t101
      t144 = t13*s3l2*t135
      t155 = t13*s2l1
      t158 = t84*t44
      t160 = t84*t47
      t161 = 12288*t160
      t167 = t13*s3l1*s34r
      t171 = 21504*t114*t44
      t176 = t100*t44
      t177 = t100*t47
      t179 = 12288*t176+12288*t177
      t188 = t13*s3l1*t135
      t196 = t13*s3l2*s2l1
      t199 = t13*s3l1*s2l2
      t201 = t12*s3l1
      t202 = t38*t201
      t203 = t84*t202
      t204 = t12*s3l2
      t205 = t46*t204
      t206 = t84*t205
      t224 = -z+3
      t227 = 3*t113*t6*t224
      t229 = (t113*t6*(z-4)-t227)*t10
      t232 = t4*t6
      t248 = -t100*t202+t100*t205
      t259 = -z-1
      t264 = (t232-3*t113*t6*t259)*t10
      t267 = s4l2*t12
      t276 = s4l1*t12
      t283 = t12*t135
      t284 = t38*t283
      t287 = -2+z
      t294 = (t4*t7*t287-3*t4*t7*t224)*t10
      t298 = -t1
      t303 = (t4*t7*z-3*t4*t7*t298)*t10
      t308 = t59*t6
      t315 = t46*t283
      t340 = t2*t6*t10
      t341 = t267*s3l1
      t344 = t276*s3l2
      s2 = (-12288*t84*t13*s3l2*t85+((27648*t84*t90+12288*t93+t96)*s23r+
     #t107*s2l2+24576*t100*t110+t116)*s1vr+(t121*s2l2+t126*s34r-t116-215
     #04*t114*t39)*s23r+t141*s2l2-12288*t134*t144-21504*t8*t110)*s1l1+(1
     #2288*t84*t13*s3l1*t85+((-27648*t84*t155-12288*t158-t161)*s23r-t107
     #*s2l1-24576*t100*t167-t171)*s1vr+(-t121*s2l1+t179*s34r+t171+21504*
     #t114*t47)*s23r-t141*s2l1+12288*t134*t188+21504*t8*t167)*s1l2
      s1 = s2+(-12288*t84*t196+12288*t84*t199+12288*t203-12288*t206)*t85
     #+(((-24576*t93-24576*t95)*s2l1+(24576*t158+24576*t160)*s2l2)*s23r+
     #((12288*t123-12288*t124)*s34r-3072*t229*t204-12288*t232*t39)*s2l1+
     #((-12288*t176+12288*t177)*s34r+3072*t229*t201+12288*t232*t47)*s2l2
     #+24576*t248*s34r-24576*t114*t202+24576*t114*t205)*s1vr+((-t126*s34
     #r-3072*t264*t204-3072*t264*t267)*s2l1+(-t179*s34r+3072*t264*t201+3
     #072*t264*t276)*s2l2)*s23r
      t347 = s1+(12288*t134*t284+(3072*t294*t204+3072*t303*t267)*s34r+61
     #44*t308*t36+3072*t308*t39)*s2l1+(-12288*t134*t315+(-3072*t294*t201
     #-3072*t303*t276)*s34r-6144*t308*t44-3072*t308*t47)*s2l2+(12288*t13
     #4*t202-12288*t134*t205)*t135+(24576*t8*t202-24576*t8*t205)*s34r+30
     #72*t340*t341-3072*t340*t344
      t349 = t82*l3
      t350 = t349*t3
      t351 = t350*t5
      t355 = t82*t59
      t356 = t355*t5
      t363 = t351*t36
      t365 = t351*t39
      t368 = s23r**2
      t370 = t349*t17
      t371 = t370*t6
      t372 = t371*t101
      t373 = t5*t10
      t374 = t373*t12
      t375 = t83*t374
      t377 = -18432*t372-18432*t375
      t379 = t371*t36
      t381 = t371*t39
      t385 = -t259
      t388 = 3*t355*t298
      t390 = (t355*t385-t388)*t5
      t393 = t83*t5
      t395 = 12288*t393*t39
      t399 = z*l3
      t400 = t399*t2
      t403 = 9216*t84*t101+9216*t400*t374
      t407 = l3*t2
      t409 = -t224
      t413 = (2*t407-3*t407*t409)*t5
      t415 = 3072*t413*t36
      t420 = 9216*t372-18432*t375
      t428 = (t83-3*t355*t224)*t5
      t436 = t349*t132*t7
      t440 = 9216*t436*t136-9216*t4*t374
      t447 = t6*t385
      t448 = t83*t447
      t452 = -3*t83*t6*t287
      t454 = (t448-t452)*t10
      t456 = -z-2
      t461 = (t448-3*t83*t6*t456)*t10
      t462 = t461*t267
      t466 = 2*t400
      t467 = 3*z
      t468 = -t467+1
      t472 = (t466-3*t407*t468)*t5
      t483 = -9216*t100*t136-9216*t399*t59*t103*t12*s34r
      t492 = (2*t114-3*t113*t6*t409)*t10
      t493 = t204*s34r
      t507 = t351*t44
      t509 = t351*t47
      t515 = t371*t44
      t517 = t371*t47
      t524 = 12288*t393*t47
      t532 = 3072*t413*t44
      t554 = t461*t276
      t566 = t201*s34r
      t573 = t351*t202
      t574 = t351*t205
      t582 = t356*t202
      t584 = t356*t205
      t605 = (t355*(t467-5)-9*t355*t298)*t5
      t633 = 2*z
      t634 = -t633+3
      t638 = (t407*(-4+t467)-3*t407*t634)*t5
      t660 = t2*t5
      t661 = l3*t409*t660
      t668 = t355*z
      t671 = t668-3*t355*t259
      t672 = t671*t5
      t687 = (t99*t6-t452)*t10
      t692 = z**2
      t693 = 4*z
      t700 = (t407*(t692-t693+1)-3*t407*(z+2-t692))*t5
      t709 = (t407*(t692+1)-3*t407*(-t692-z))*t5
      t724 = t82*z
      t726 = t724*t3*t6
      t733 = 3*t407*t259
      t734 = t400-t733
      t736 = t734*t5*t10
      t749 = (t232-3*t113*t6*t634)*t10
      t755 = (t113*t447+3*t399*t308)*t10
      t762 = t1*(t692-t467+1)*t5
      t765 = z*t1
      t766 = t765*t5
      t790 = (t113*t6*t287-t227)*t10
      t796 = t660*t10
      s3 = ((24576*t351*t13*s3l2*s23r-24576*t356*t36)*t85+((-27648*t351*
     #t90-24576*t363-24576*t365)*t368+(t377*s2l2+(-36864*t379-12288*t381
     #)*s34r+3072*t390*t36-t395)*s23r+t403*s2l2+39936*t84*t110+t415)*s1v
     #r+(t420*s2l2+(12288*t379+12288*t381)*s34r-3072*t428*t36-3072*t428*
     #t39)*t368+(t440*s2l2+(12288*t436*t36+12288*t436*t39)*t135+(-3072*t
     #454*t204+3072*t462)*s34r-t415+3072*t472*t39)*s23r+t483*s2l2-15360*
     #t100*t144-3072*t492*t493)*s1l1
      s4 = ((-24576*t351*t13*s3l1*s23r+24576*t356*t44)*t85+((27648*t351*
     #t155+24576*t507+24576*t509)*t368+(-t377*s2l1+(36864*t515+12288*t51
     #7)*s34r-3072*t390*t44+t524)*s23r-t403*s2l1-39936*t84*t167-t532)*s1
     #vr+(-t420*s2l1+(-12288*t515-12288*t517)*s34r+3072*t428*t44+3072*t4
     #28*t47)*t368+(-t440*s2l1+(-12288*t436*t44-12288*t436*t47)*t135+(30
     #72*t454*t201-3072*t554)*s34r+t532-3072*t472*t47)*s23r-t483*s2l1+15
     #360*t100*t188+3072*t492*t566)*s1l2+((24576*t351*t196-24576*t351*t1
     #99-24576*t573+24576*t574)*s23r-24576*t356*t196+24576*t356*t199+245
     #76*t582-24576*t584)*t85
      s2 = s3+s4
      s3 = s2+(((12288*t363+12288*t365)*s2l1+(-12288*t507-12288*t509)*s2
     #l2)*t368+(((-12288*t379+12288*t381)*s34r+3072*t605*t36+t395)*s2l1+
     #((12288*t515-12288*t517)*s34r-3072*t605*t44-t524)*s2l2+(24576*t371
     #*t202-24576*t371*t205)*s34r-24576*t393*t202+24576*t393*t205)*s23r+
     #((21504*t93-t96)*s34r-3072*t638*t36-12288*t400*t373*t267)*s2l1+((-
     #21504*t158+t161)*s34r+3072*t638*t44+12288*t400*t373*t276)*s2l2+(-3
     #6864*t203+36864*t206)*s34r+12288*t661*t202-12288*t661*t205)*s1vr
      s1 = s3+((3072*t672*t36+3072*t672*t39)*s2l1+(-3072*t672*t44-3072*t
     #672*t47)*s2l2)*t368+(((-3072*t687*t204+3072*t462)*s34r+3072*t700*t
     #36+3072*t709*t39)*s2l1+((3072*t687*t201-3072*t554)*s34r-3072*t700*
     #t44-3072*t709*t47)*s2l2+(24576*t726*t202-24576*t726*t205)*s34r+614
     #4*t736*t341-6144*t736*t344)*s23r
      t801 = s1+(12288*t100*t284+(3072*t749*t204+3072*t755*t267)*s34r-30
     #72*t762*t36+3072*t766*t39)*s2l1+(-12288*t100*t315+(-3072*t749*t201
     #-3072*t755*t276)*s34r+3072*t762*t44-3072*t766*t47)*s2l2-12288*t248
     #*t135+(-3072*t790*t341+3072*t790*t344)*s34r-3072*t796*t341+3072*t7
     #96*t344
      t803 = t82**2
      t804 = t803*t3
      t805 = t804*t10
      t809 = t349*t59
      t810 = t809*t10
      t814 = t82*t2
      t826 = t368*s23r
      t829 = t803*t17*t5
      t833 = 9216*t829*t101+9216*t350*t13
      t845 = (-t809*t456-3*t809*t259)*t10
      t854 = t2*t10*t12
      t857 = -9216*t351*t101-9216*t724*t854
      t863 = t724*t2
      t864 = -t633+1
      t868 = (t863-3*t814*t864)*t10
      t875 = t356*t110
      t877 = t1*l3
      t880 = (t877-3*t407)*t10
      t882 = 3072*t880*t204
      t887 = t809*z
      t891 = (t887-3*t809*t298)*t10
      t902 = 9216*t370*t5*t101+9216*t83*t13
      t906 = 3*t350*t298
      t908 = (t350*t385-t906)*t5
      t913 = (t349*z*t3-t906)*t5
      t920 = t668-t388
      t921 = t920*t10
      t929 = -9216*t393*t101-9216*t399*t854
      t937 = (t668-6*t355*t298)*t5
      t939 = t920*t5
      t950 = (t692*l3*t1-3*t399*t1*t298)*t10
      t960 = (t407-3*t113)*t5*t10
      t1008 = t356*t167
      t1011 = 3072*t880*t201
      t1054 = t204*s2l1
      t1056 = t201*s2l2
      t1070 = t814*t10
      t1081 = -t864
      t1085 = (t809*t1081+6*t887)*t10
      t1103 = (t814*(t693-2)-3*t814*t468)*t10
      t1119 = -t82*t468*t2
      t1131 = (t877*t1081-3*t877*t298)*t10
      t1144 = t407*t10
      t1151 = t671*t10
      t1160 = (t692*t82*t2-3*t814*(-t692+1))*t10
      t1169 = (t466-t733)*t10
      t1180 = t939*t10
      t1186 = t734*t10
      t1193 = t113*t5
      t1210 = (t400-3*t407*t298)*t5*t10
      t1216 = z*t10
      s2 = ((-9216*t8*t13*s2l2*s1vr+9216*t20*t13*s34r*s2l2)*s1l1+(9216*t
     #8*t13*s2l1*s1vr-9216*t20*t13*s34r*s2l1)*s1l2+((12288*t8*t36+12288*
     #t8*t39)*s2l1+(-12288*t8*t44-12288*t8*t47)*s2l2)*s1vr+((-12288*t20*
     #t36-12288*t20*t39)*s34r-3072*t60*t36-3072*t60*t39)*s2l1+((12288*t2
     #0*t44+12288*t20*t47)*s34r+3072*t60*t44+3072*t60*t47)*s2l2)*t79*s13
     #r+t347*t79+t801*s13r
      s3 = s2+((-12288*t805*t204*t368+24576*t810*t204*s23r-12288*t814*t3
     #6)*t85+((9216*t804*t90+12288*t804*t36+12288*t804*t39)*t826+(t833*s
     #2l2+(12288*t829*t36+12288*t829*t39)*s34r-3072*t845*t204+12288*t350
     #*t39)*t368+(t857*s2l2+(-27648*t363-12288*t365)*s34r+3072*t868*t204
     #-12288*t863*t39)*s23r+15360*t875+t882)*s1vr+(9216*t350*t90+3072*t8
     #91*t204+3072*t891*t267)*t826+(t902*s2l2+(3072*t908*t36+3072*t913*t
     #39)*s34r-21504*t355*t36+3072*t921*t267)*t368+(t929*s2l2+3072*t371*
     #t144+(-3072*t937*t36-3072*t939*t39)*s34r-t882-3072*t950*t267)*s23r
     #-3072*t84*t144-3072*t960*t493)*s1l1
      s4 = s3+((12288*t805*t201*t368-24576*t810*t201*s23r+12288*t814*t44
     #)*t85+((-9216*t804*t155-12288*t804*t44-12288*t804*t47)*t826+(-t833
     #*s2l1+(-12288*t829*t44-12288*t829*t47)*s34r+3072*t845*t201-12288*t
     #350*t47)*t368+(-t857*s2l1+(27648*t507+12288*t509)*s34r-3072*t868*t
     #201+12288*t863*t47)*s23r-15360*t1008-t1011)*s1vr+(-9216*t350*t155-
     #3072*t891*t201-3072*t891*t276)*t826+(-t902*s2l1+(-3072*t908*t44-30
     #72*t913*t47)*s34r+21504*t355*t44-3072*t921*t276)*t368+(-t929*s2l1-
     #3072*t371*t188+(3072*t937*t44+3072*t939*t47)*s34r+t1011+3072*t950*
     #t276)*s23r+3072*t84*t188+3072*t960*t566)*s1l2
      s1 = s4+((-12288*t805*t1054+12288*t805*t1056+12288*t805*t341-12288
     #*t805*t344)*t368+(24576*t810*t1054-24576*t810*t1056-24576*t810*t34
     #1+24576*t810*t344)*s23r-12288*t1070*t1054+12288*t1070*t1056+12288*
     #t1070*t341-12288*t1070*t344)*t85+((-3072*t1085*t1054+3072*t1085*t1
     #056+24576*t887*t202-24576*t887*t205)*t368+((-9216*t351*t110+3072*t
     #1103*t204)*s2l1+(9216*t351*t167-3072*t1103*t201)*s2l2+(12288*t573-
     #12288*t574)*s34r-12288*t1119*t202+12288*t1119*t205)*s23r+(9216*t87
     #5-3072*t1131*t204)*s2l1+(-9216*t1008+3072*t1131*t201)*s2l2+(-12288
     #*t582+12288*t584)*s34r+12288*t1144*t341-12288*t1144*t344)*s1vr
      taux12 = s1+(-3072*t1151*t1054+3072*t1151*t1056+3072*t1160*t341-30
     #72*t1160*t344)*t368+((-9216*t393*t110+3072*t1169*t204)*s2l1+(9216*
     #t393*t167-3072*t1169*t201)*s2l2+(3072*t1180*t341-3072*t1180*t344)*
     #s34r-3072*t1186*t341+3072*t1186*t344)*s23r+(9216*t1193*t110-3072*t
     #765*t36)*s2l1+(-9216*t1193*t167+3072*t765*t44)*s2l2+(-3072*t1210*t
     #341+3072*t1210*t344)*s34r-3072*t1216*t341+3072*t1216*t344

CCC Coefficients

      tcoff23 = taux11
      tcoff24 = taux12

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet23 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff23)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet24 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff24)

CCC Sum

      ggrmnum5e1 = tFjet23*tcoff23+tFjet24*tcoff24
      RETURN
      END

      double precision function ggrmnum5e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3**2
      t2 = z*t1
      t3 = z+1
      t4 = -1+z
      t5 = t4**2
      t6 = t5**2
      t7 = t3*t6
      t9 = l3-1
      t10 = t9**2
      t11 = s4vr**2
      t12 = 1/t11
      t13 = t10*t12
      t14 = s3vr**2
      t15 = 1/t14
      t16 = s1vr**2
      t21 = t4*t6
      t22 = t10*t9
      t28 = t15*s34r
      t31 = z*l3
      t32 = t5*t4
      t35 = t12*t15
      t41 = z**2
      t42 = t41*t1
      t43 = t6*t5
      t45 = t10**2
      t47 = s34r**2
      t48 = t15*t47
      t52 = t41*l3
      t54 = t22*t12
      t59 = s13r**2
      t61 = t1*l3
      t62 = t61*z
      t64 = t9*t12
      t69 = t62*t21
      t70 = t13*t28
      t73 = t3*t2
      t90 = t54*t48
      t93 = t42*t6
      t96 = t31*t5
      t105 = t41+z
      t106 = t105*t12
      t125 = t1**2
      t126 = t125*z
      t129 = s23r**2
      t135 = t64*t28
      t136 = t126*t21*t135
      t153 = (z-1+2*t41)*t12*t15
      t159 = t13*t48
      t161 = t61*t41
      t163 = t161*t6*t135
      t184 = t52*t5
      s1 = (768*t2*t7*t13*t15*t16+(-768*t2*t21*t22*(2*z+1)*t12*t28-768*t
     #31*t32*t10*t3*t35)*s1vr+768*t42*t43*t45*t12*t48+768*t52*t6*t54*t28
     #)*t59+((-1536*t62*t7*t64*t15*s23r-768*t69*t70+768*t73*t32*t9*t35)*
     #t16+((1536*t62*t3*t21*t70-1536*t73*t6*t9*t35)*s23r+768*t62*t43*t90
     #-2304*t93*t70-768*t96*t3*t9*t35)*s1vr+(1536*t2*t6*t10*t106*t28+153
     #6*t96*t105*t9*t35)*s23r+1536*t42*t21*t90+1536*t52*t32*t70)*s13r+(7
     #68*t126*t3*t6*t12*t15*t129+(768*t136-768*t62*t3*t32*t12*t15)*s23r-
     #768*t62*t6*t135)*t16+((-768*t136+768*t62*t32*t153)*t129+(-768*t126
     #*t43*t159+768*t163-768*t2*t5*t153)*s23r+768*t69*t159-768*t2*t6*t13
     #5)*s1vr
      taux11 = s1+(-768*t163+768*t2*t32*t106*t15)*t129+(-768*t161*t21*t1
     #59-768*t184*t3*t12*t15)*s23r+768*t93*t159+768*t184*t135
      t1 = -1+z
      t2 = t1**2
      t3 = t2**2
      t4 = l3*t3
      t5 = l3-1
      t6 = t5**2
      t7 = t6*t5
      t8 = t4*t7
      t9 = s4vr**2
      t10 = 1/t9
      t11 = s3vr**2
      t12 = 1/t11
      t13 = t10*t12
      t17 = t3*t1
      t18 = l3*t17
      t19 = t6**2
      t20 = t18*t19
      t36 = t13*s3l2
      t38 = t10*s4l2
      t39 = t38*t12
      t44 = t13*s3l1
      t46 = t10*s4l1
      t47 = t46*t12
      t59 = t2*t1
      t60 = t59*t7
      t79 = s13r**2
      t82 = l3**2
      t83 = t82*t3
      t84 = t83*t6
      t85 = s1vr**2
      t90 = t13*s2l2
      t93 = t84*t36
      t95 = t84*t39
      t96 = 15360*t95
      t99 = t82*t17
      t100 = t99*t7
      t101 = t13*s34r
      t102 = t100*t101
      t103 = t6*t10
      t105 = t4*t103*t12
      t107 = -6144*t102-6144*t105
      t110 = t13*s3l2*s34r
      t113 = l3*t59
      t114 = t113*t6
      t116 = 21504*t114*t36
      t121 = 12288*t102-6144*t105
      t123 = t100*t36
      t124 = t100*t39
      t126 = 15360*t123+15360*t124
      t132 = t3*t2
      t134 = t82*t132*t19
      t135 = s34r**2
      t136 = t13*t135
      t141 = 6144*t134*t136+6144*t18*t7*t101
      t144 = t13*s3l2*t135
      t155 = t13*s2l1
      t158 = t84*t44
      t160 = t84*t47
      t161 = 15360*t160
      t167 = t13*s3l1*s34r
      t171 = 21504*t114*t44
      t176 = t100*t44
      t177 = t100*t47
      t179 = -15360*t176-15360*t177
      t188 = t13*s3l1*t135
      t196 = t13*s3l2*s2l1
      t199 = t13*s3l1*s2l2
      t201 = t12*s3l1
      t202 = t38*t201
      t203 = t84*t202
      t204 = t12*s3l2
      t205 = t46*t204
      t206 = t84*t205
      t225 = -z+3
      t228 = 2*t113*t6*t225
      t230 = (-3*t113*t6*(z-4)+t228)*t10
      t233 = t4*t6
      t249 = t100*t202-t100*t205
      t260 = 3*t233
      t261 = -z-1
      t266 = (-t260+2*t113*t6*t261)*t10
      t269 = s4l2*t12
      t278 = s4l1*t12
      t285 = t12*t135
      t286 = t38*t285
      t289 = -2+z
      t297 = (-3*t4*t7*t289+2*t4*t7*t225)*t10
      t302 = -t1
      t307 = (-3*t4*t7*z+2*t4*t7*t302)*t10
      t312 = t59*t6
      t319 = t46*t285
      t344 = t2*t6*t10
      t345 = t269*s3l1
      t348 = t278*s3l2
      s2 = (15360*t84*t13*s3l2*t85+((-18432*t84*t90-15360*t93-t96)*s23r+
     #t107*s2l2-30720*t100*t110-t116)*s1vr+(t121*s2l2+t126*s34r+t116+215
     #04*t114*t39)*s23r+t141*s2l2+15360*t134*t144+21504*t8*t110)*s1l1+(-
     #15360*t84*t13*s3l1*t85+((18432*t84*t155+15360*t158+t161)*s23r-t107
     #*s2l1+30720*t100*t167+t171)*s1vr+(-t121*s2l1+t179*s34r-t171-21504*
     #t114*t47)*s23r-t141*s2l1-15360*t134*t188-21504*t8*t167)*s1l2
      s1 = s2+(15360*t84*t196-15360*t84*t199-15360*t203+15360*t206)*t85+
     #(((30720*t93+30720*t95)*s2l1+(-30720*t158-30720*t160)*s2l2)*s23r+(
     #(-15360*t123+15360*t124)*s34r-3072*t230*t204+15360*t233*t39)*s2l1+
     #((15360*t176-15360*t177)*s34r+3072*t230*t201-15360*t233*t47)*s2l2+
     #30720*t249*s34r+30720*t114*t202-30720*t114*t205)*s1vr+((-t126*s34r
     #-3072*t266*t204-3072*t266*t269)*s2l1+(-t179*s34r+3072*t266*t201+30
     #72*t266*t278)*s2l2)*s23r
      t351 = s1+(-15360*t134*t286+(3072*t297*t204+3072*t307*t269)*s34r-1
     #8432*t312*t36-9216*t312*t39)*s2l1+(15360*t134*t319+(-3072*t297*t20
     #1-3072*t307*t278)*s34r+18432*t312*t44+9216*t312*t47)*s2l2+(-15360*
     #t134*t202+15360*t134*t205)*t135+(-30720*t8*t202+30720*t8*t205)*s34
     #r-9216*t344*t345+9216*t344*t348
      t353 = t82*l3
      t354 = t353*t3
      t355 = t354*t5
      t359 = t82*t59
      t360 = t359*t5
      t367 = t355*t36
      t369 = t355*t39
      t372 = s23r**2
      t374 = t353*t17
      t375 = t374*t6
      t376 = t375*t101
      t377 = t5*t10
      t378 = t377*t12
      t379 = t83*t378
      t381 = 12288*t376+12288*t379
      t383 = t375*t36
      t385 = t375*t39
      t389 = -t261
      t393 = 2*t359*t302
      t395 = (-3*t359*t389+t393)*t5
      t398 = t83*t5
      t400 = 15360*t398*t39
      t404 = z*l3
      t405 = t404*t2
      t408 = -6144*t84*t101-6144*t405*t378
      t412 = l3*t2
      t414 = -t225
      t418 = (-6*t412+2*t412*t414)*t5
      t420 = 3072*t418*t36
      t425 = -6144*t376+12288*t379
      t434 = (-3*t83+2*t359*t225)*t5
      t442 = t353*t132*t7
      t446 = -6144*t442*t136+6144*t4*t378
      t453 = t6*t389
      t455 = 3*t83*t453
      t459 = -2*t83*t6*t289
      t461 = (-t455+t459)*t10
      t463 = -z-2
      t468 = (-t455+2*t83*t6*t463)*t10
      t469 = t468*t269
      t473 = 6*t405
      t474 = 3*z
      t475 = -t474+1
      t479 = (-t473+2*t412*t475)*t5
      t490 = 6144*t100*t136+6144*t404*t59*t103*t12*s34r
      t499 = (-6*t114+2*t113*t6*t414)*t10
      t500 = t204*s34r
      t514 = t355*t44
      t516 = t355*t47
      t522 = t375*t44
      t524 = t375*t47
      t531 = 15360*t398*t47
      t539 = 3072*t418*t44
      t561 = t468*t278
      t573 = t201*s34r
      t580 = t355*t202
      t581 = t355*t205
      t589 = t360*t202
      t591 = t360*t205
      t613 = (-3*t359*(t474-5)+6*t359*t302)*t5
      t642 = 2*z
      t643 = -t642+3
      t647 = (-3*t412*(-4+t474)+2*t412*t643)*t5
      t669 = t2*t5
      t670 = l3*t414*t669
      t678 = 3*t359*z
      t681 = -t678+2*t359*t261
      t682 = t681*t5
      t698 = (-3*t99*t6+t459)*t10
      t703 = z**2
      t704 = 4*z
      t712 = (-3*t412*(t703-t704+1)+2*t412*(z+2-t703))*t5
      t722 = (-3*t412*(t703+1)+2*t412*(-t703-z))*t5
      t737 = t82*z
      t739 = t737*t3*t6
      t745 = 3*t405
      t747 = 2*t412*t261
      t748 = -t745+t747
      t750 = t748*t5*t10
      t763 = (-t260+2*t113*t6*t643)*t10
      t770 = (-3*t113*t453-2*t404*t312)*t10
      t777 = t1*(t703-t474+1)*t5
      t780 = z*t1
      t781 = t780*t5
      t806 = (-3*t113*t6*t289+t228)*t10
      t812 = t669*t10
      s3 = ((-30720*t355*t13*s3l2*s23r+30720*t360*t36)*t85+((18432*t355*
     #t90+30720*t367+30720*t369)*t372+(t381*s2l2+(46080*t383+15360*t385)
     #*s34r+3072*t395*t36+t400)*s23r+t408*s2l2-55296*t84*t110+t420)*s1vr
     #+(t425*s2l2+(-15360*t383-15360*t385)*s34r-3072*t434*t36-3072*t434*
     #t39)*t372+(t446*s2l2+(-15360*t442*t36-15360*t442*t39)*t135+(-3072*
     #t461*t204+3072*t469)*s34r-t420+3072*t479*t39)*s23r+t490*s2l2+24576
     #*t100*t144-3072*t499*t500)*s1l1
      s4 = ((30720*t355*t13*s3l1*s23r-30720*t360*t44)*t85+((-18432*t355*
     #t155-30720*t514-30720*t516)*t372+(-t381*s2l1+(-46080*t522-15360*t5
     #24)*s34r-3072*t395*t44-t531)*s23r-t408*s2l1+55296*t84*t167-t539)*s
     #1vr+(-t425*s2l1+(15360*t522+15360*t524)*s34r+3072*t434*t44+3072*t4
     #34*t47)*t372+(-t446*s2l1+(15360*t442*t44+15360*t442*t47)*t135+(307
     #2*t461*t201-3072*t561)*s34r+t539-3072*t479*t47)*s23r-t490*s2l1-245
     #76*t100*t188+3072*t499*t573)*s1l2+((-30720*t355*t196+30720*t355*t1
     #99+30720*t580-30720*t581)*s23r+30720*t360*t196-30720*t360*t199-307
     #20*t589+30720*t591)*t85
      s2 = s3+s4
      s3 = s2+(((-15360*t367-15360*t369)*s2l1+(15360*t514+15360*t516)*s2
     #l2)*t372+(((15360*t383-15360*t385)*s34r+3072*t613*t36-t400)*s2l1+(
     #(-15360*t522+15360*t524)*s34r-3072*t613*t44+t531)*s2l2+(-30720*t37
     #5*t202+30720*t375*t205)*s34r+30720*t398*t202-30720*t398*t205)*s23r
     #+((-21504*t93+t96)*s34r-3072*t647*t36+15360*t405*t377*t269)*s2l1+(
     #(21504*t158-t161)*s34r+3072*t647*t44-15360*t405*t377*t278)*s2l2+(4
     #6080*t203-46080*t206)*s34r-15360*t670*t202+15360*t670*t205)*s1vr
      s1 = s3+((3072*t682*t36+3072*t682*t39)*s2l1+(-3072*t682*t44-3072*t
     #682*t47)*s2l2)*t372+(((-3072*t698*t204+3072*t469)*s34r+3072*t712*t
     #36+3072*t722*t39)*s2l1+((3072*t698*t201-3072*t561)*s34r-3072*t712*
     #t44-3072*t722*t47)*s2l2+(-30720*t739*t202+30720*t739*t205)*s34r+61
     #44*t750*t345-6144*t750*t348)*s23r
      t817 = s1+(-15360*t100*t286+(3072*t763*t204+3072*t770*t269)*s34r+9
     #216*t777*t36-9216*t781*t39)*s2l1+(15360*t100*t319+(-3072*t763*t201
     #-3072*t770*t278)*s34r-9216*t777*t44+9216*t781*t47)*s2l2-15360*t249
     #*t135+(-3072*t806*t345+3072*t806*t348)*s34r+9216*t812*t345-9216*t8
     #12*t348
      t819 = t82**2
      t820 = t819*t3
      t821 = t820*t10
      t825 = t353*t59
      t826 = t825*t10
      t830 = t82*t2
      t842 = t372*s23r
      t845 = t819*t17*t5
      t849 = -6144*t845*t101-6144*t354*t13
      t862 = (3*t825*t463+2*t825*t261)*t10
      t871 = t2*t10*t12
      t874 = 6144*t355*t101+6144*t737*t871
      t880 = t737*t2
      t882 = -t642+1
      t886 = (-3*t880+2*t830*t882)*t10
      t893 = t360*t110
      t895 = t1*l3
      t899 = (-3*t895+2*t412)*t10
      t901 = 3072*t899*t204
      t906 = t825*z
      t911 = (-3*t906+2*t825*t302)*t10
      t922 = -6144*t374*t5*t101-6144*t83*t13
      t927 = 2*t354*t302
      t929 = (-3*t354*t389+t927)*t5
      t935 = (-3*t353*z*t3+t927)*t5
      t942 = -t678+t393
      t943 = t942*t10
      t951 = 6144*t398*t101+6144*t404*t871
      t959 = (-t678+4*t359*t302)*t5
      t961 = t942*t5
      t973 = (-3*t703*l3*t1+2*t404*t1*t302)*t10
      t984 = (-3*t412+2*t113)*t5*t10
      t1032 = t360*t167
      t1035 = 3072*t899*t201
      t1078 = t204*s2l1
      t1080 = t201*s2l2
      t1094 = t830*t10
      t1105 = -t882
      t1110 = (-3*t825*t1105-4*t906)*t10
      t1129 = (-3*t830*(t704-2)+2*t830*t475)*t10
      t1145 = -t82*t475*t2
      t1158 = (-3*t895*t1105+2*t895*t302)*t10
      t1171 = t412*t10
      t1178 = t681*t10
      t1188 = (-3*t703*t82*t2+2*t830*(-t703+1))*t10
      t1197 = (-t473+t747)*t10
      t1208 = t961*t10
      t1214 = t748*t10
      t1221 = t113*t5
      t1238 = (-t745+2*t412*t302)*t5*t10
      t1244 = z*t10
      s2 = ((6144*t8*t13*s2l2*s1vr-6144*t20*t13*s34r*s2l2)*s1l1+(-6144*t
     #8*t13*s2l1*s1vr+6144*t20*t13*s34r*s2l1)*s1l2+((-15360*t8*t36-15360
     #*t8*t39)*s2l1+(15360*t8*t44+15360*t8*t47)*s2l2)*s1vr+((15360*t20*t
     #36+15360*t20*t39)*s34r+9216*t60*t36+9216*t60*t39)*s2l1+((-15360*t2
     #0*t44-15360*t20*t47)*s34r-9216*t60*t44-9216*t60*t47)*s2l2)*t79*s13
     #r+t351*t79+t817*s13r
      s3 = s2+((15360*t821*t204*t372-30720*t826*t204*s23r+15360*t830*t36
     #)*t85+((-6144*t820*t90-15360*t820*t36-15360*t820*t39)*t842+(t849*s
     #2l2+(-15360*t845*t36-15360*t845*t39)*s34r-3072*t862*t204-15360*t35
     #4*t39)*t372+(t874*s2l2+(39936*t367+15360*t369)*s34r+3072*t886*t204
     #+15360*t880*t39)*s23r-24576*t893+t901)*s1vr+(-6144*t354*t90+3072*t
     #911*t204+3072*t911*t269)*t842+(t922*s2l2+(3072*t929*t36+3072*t935*
     #t39)*s34r+21504*t359*t36+3072*t943*t269)*t372+(t951*s2l2-9216*t375
     #*t144+(-3072*t959*t36-3072*t961*t39)*s34r-t901-3072*t973*t269)*s23
     #r+9216*t84*t144-3072*t984*t500)*s1l1
      s4 = s3+((-15360*t821*t201*t372+30720*t826*t201*s23r-15360*t830*t4
     #4)*t85+((6144*t820*t155+15360*t820*t44+15360*t820*t47)*t842+(-t849
     #*s2l1+(15360*t845*t44+15360*t845*t47)*s34r+3072*t862*t201+15360*t3
     #54*t47)*t372+(-t874*s2l1+(-39936*t514-15360*t516)*s34r-3072*t886*t
     #201-15360*t880*t47)*s23r+24576*t1032-t1035)*s1vr+(6144*t354*t155-3
     #072*t911*t201-3072*t911*t278)*t842+(-t922*s2l1+(-3072*t929*t44-307
     #2*t935*t47)*s34r-21504*t359*t44-3072*t943*t278)*t372+(-t951*s2l1+9
     #216*t375*t188+(3072*t959*t44+3072*t961*t47)*s34r+t1035+3072*t973*t
     #278)*s23r-9216*t84*t188+3072*t984*t573)*s1l2
      s1 = s4+((15360*t821*t1078-15360*t821*t1080-15360*t821*t345+15360*
     #t821*t348)*t372+(-30720*t826*t1078+30720*t826*t1080+30720*t826*t34
     #5-30720*t826*t348)*s23r+15360*t1094*t1078-15360*t1094*t1080-15360*
     #t1094*t345+15360*t1094*t348)*t85+((-3072*t1110*t1078+3072*t1110*t1
     #080-30720*t906*t202+30720*t906*t205)*t372+((6144*t355*t110+3072*t1
     #129*t204)*s2l1+(-6144*t355*t167-3072*t1129*t201)*s2l2+(-15360*t580
     #+15360*t581)*s34r+15360*t1145*t202-15360*t1145*t205)*s23r+(-6144*t
     #893-3072*t1158*t204)*s2l1+(6144*t1032+3072*t1158*t201)*s2l2+(15360
     #*t589-15360*t591)*s34r-15360*t1171*t345+15360*t1171*t348)*s1vr
      taux12 = s1+(-3072*t1178*t1078+3072*t1178*t1080+3072*t1188*t345-30
     #72*t1188*t348)*t372+((6144*t398*t110+3072*t1197*t204)*s2l1+(-6144*
     #t398*t167-3072*t1197*t201)*s2l2+(3072*t1208*t345-3072*t1208*t348)*
     #s34r-3072*t1214*t345+3072*t1214*t348)*s23r+(-6144*t1221*t110+9216*
     #t780*t36)*s2l1+(6144*t1221*t167-9216*t780*t44)*s2l2+(-3072*t1238*t
     #345+3072*t1238*t348)*s34r+9216*t1244*t345-9216*t1244*t348

CCC Coefficients

      tcoff23 = taux11
      tcoff24 = taux12

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet23 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff23)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet24 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff24)

CCC Sum

      ggrmnum5e2 = tFjet23*tcoff23+tFjet24*tcoff24
      RETURN
      END

      double precision function ggrmnum5e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux11 = 0
      t1 = -1+z
      t2 = t1**2
      t3 = t2**2
      t4 = l3*t3
      t5 = l3-1
      t6 = t5**2
      t7 = t6*t5
      t8 = t4*t7
      t9 = s4vr**2
      t10 = 1/t9
      t11 = s3vr**2
      t12 = 1/t11
      t13 = t10*t12
      t14 = t13*s3l2
      t16 = t10*s4l2
      t17 = t16*t12
      t22 = t13*s3l1
      t24 = t10*s4l1
      t25 = t24*t12
      t32 = t3*t1
      t34 = t6**2
      t35 = l3*t32*t34
      t41 = t2*t1
      t42 = t41*t7
      t61 = s13r**2
      t64 = l3**2
      t65 = t64*t3
      t66 = t65*t6
      t67 = s1vr**2
      t72 = t66*t14
      t73 = t66*t17
      t74 = t72+t73
      t77 = t64*t32
      t78 = t77*t7
      t80 = t13*s3l2*s34r
      t83 = l3*t41
      t84 = t83*t6
      t86 = 6144*t84*t14
      t89 = t78*t14
      t90 = t78*t17
      t92 = -6144*t89-6144*t90
      t98 = t3*t2
      t100 = t64*t98*t34
      t101 = s34r**2
      t103 = t13*s3l2*t101
      t114 = t66*t22
      t115 = t66*t25
      t116 = -t114-t115
      t120 = t13*s3l1*s34r
      t124 = 6144*t84*t22
      t127 = t78*t22
      t128 = t78*t25
      t130 = 6144*t127+6144*t128
      t137 = t13*s3l1*t101
      t145 = t13*s3l2*s2l1
      t148 = t13*s3l1*s2l2
      t150 = t12*s3l1
      t151 = t16*t150
      t152 = t66*t151
      t153 = t12*s3l2
      t154 = t24*t153
      t155 = t66*t154
      t171 = (z-4)*t10
      t175 = t4*t6
      t177 = 6144*t175*t17
      t187 = 6144*t175*t25
      t192 = -t78*t151+t78*t154
      t203 = t175*t14
      t209 = t175*t22
      t215 = t12*t101
      t216 = t16*t215
      t219 = -2+z
      t220 = t219*t10
      t223 = z*t10
      t224 = s4l2*t12
      t230 = t41*t6
      t237 = t24*t215
      t242 = s4l1*t12
      t265 = t2*t6*t10
      t266 = t224*s3l1
      t269 = t242*s3l2
      s1 = (-6144*t66*t13*s3l2*t67+(6144*t74*s23r+12288*t78*t80+t86)*s1v
     #r+(t92*s34r-t86-6144*t84*t17)*s23r-6144*t100*t103-6144*t8*t80)*s1l
     #1+(6144*t66*t13*s3l1*t67+(6144*t116*s23r-12288*t78*t120-t124)*s1vr
     #+(t130*s34r+t124+6144*t84*t25)*s23r+6144*t100*t137+6144*t8*t120)*s
     #1l2+(-6144*t66*t145+6144*t66*t148+6144*t152-6144*t155)*t67+((-1228
     #8*t74*s2l1-12288*t116*s2l2)*s23r+((6144*t89-6144*t90)*s34r-6144*t8
     #4*t171*t153-t177)*s2l1+((-6144*t127+6144*t128)*s34r+6144*t84*t171*
     #t150+t187)*s2l2+12288*t192*s34r-12288*t84*t151+12288*t84*t154)*s1v
     #r+((-t92*s34r-6144*t203-t177)*s2l1+(-t130*s34r+6144*t209+t187)*s2l
     #2)*s23r
      t272 = s1+(6144*t100*t216+(6144*t8*t220*t153+6144*t8*t223*t224)*s3
     #4r+12288*t230*t14+6144*t230*t17)*s2l1+(-6144*t100*t237+(-6144*t8*t
     #220*t150-6144*t8*t223*t242)*s34r-12288*t230*t22-6144*t230*t25)*s2l
     #2+(6144*t100*t151-6144*t100*t154)*t101+(12288*t8*t151-12288*t8*t15
     #4)*s34r+6144*t265*t266-6144*t265*t269
      t274 = t64*l3
      t275 = t274*t3
      t276 = t275*t5
      t280 = t64*t41
      t281 = t280*t5
      t286 = t276*t14
      t287 = t276*t17
      t288 = -t286-t287
      t290 = s23r**2
      t293 = t274*t32*t6
      t294 = t293*t14
      t296 = t293*t17
      t300 = z+1
      t301 = t280*t300
      t302 = t5*t10
      t303 = t302*t153
      t306 = t65*t5
      t308 = 6144*t306*t17
      t313 = l3*t2
      t314 = t313*t5
      t316 = 12288*t314*t14
      t327 = t274*t98*t7
      t333 = t300*t10
      t336 = t333*t224
      t337 = t66*t336
      t342 = l3*z*t2
      t343 = t302*t224
      t344 = t342*t343
      t361 = t276*t22
      t362 = t276*t25
      t363 = t361+t362
      t366 = t293*t22
      t368 = t293*t25
      t372 = t302*t150
      t376 = 6144*t306*t25
      t382 = 12288*t314*t22
      t399 = t333*t242
      t400 = t66*t399
      t404 = t302*t242
      t405 = t342*t404
      t417 = t276*t151
      t418 = t276*t154
      t426 = t281*t151
      t428 = t281*t154
      t443 = 3*z
      t445 = t280*(t443-5)
      t472 = t313*(-4+t443)
      t491 = t2*t5
      t492 = l3*(z-3)*t491
      t499 = t280*z
      t503 = 6144*t499*t303+6144*t499*t343
      t508 = -6144*t499*t372-6144*t499*t404
      t512 = t77*t6
      t517 = z**2
      t518 = 4*z
      t520 = t313*(t517-t518+1)
      t524 = t313*(t517+1)
      t541 = t64*z*t3*t6
      t547 = z*t5
      t548 = t313*t547
      t549 = t548*t151
      t551 = t548*t154
      t563 = t1*(t517-t443+1)*t5
      t566 = z*t1
      t567 = t566*t5
      t588 = t83*t6*t219
      t594 = t491*t10
      s3 = ((12288*t276*t13*s3l2*s23r-12288*t281*t14)*t67+(12288*t288*t2
     #90+((-18432*t294-6144*t296)*s34r+6144*t301*t303-t308)*s23r+24576*t
     #66*t80+t316)*s1vr+((6144*t294+6144*t296)*s34r-6144*t306*t14-t308)*
     #t290+((6144*t327*t14+6144*t327*t17)*t101+(-6144*t66*t333*t153+6144
     #*t337)*s34r-t316+12288*t344)*s23r-12288*t78*t103-12288*t84*t80)*s1
     #l1
      s4 = ((-12288*t276*t13*s3l1*s23r+12288*t281*t22)*t67+(12288*t363*t
     #290+((18432*t366+6144*t368)*s34r-6144*t301*t372+t376)*s23r-24576*t
     #66*t120-t382)*s1vr+((-6144*t366-6144*t368)*s34r+6144*t306*t22+t376
     #)*t290+((-6144*t327*t22-6144*t327*t25)*t101+(6144*t66*t333*t150-61
     #44*t400)*s34r+t382-12288*t405)*s23r+12288*t78*t137+12288*t84*t120)
     #*s1l2+((12288*t276*t145-12288*t276*t148-12288*t417+12288*t418)*s23
     #r-12288*t281*t145+12288*t281*t148+12288*t426-12288*t428)*t67
      s2 = s3+s4
      s1 = s2+((-6144*t288*s2l1-6144*t363*s2l2)*t290+(((-6144*t294+6144*
     #t296)*s34r+6144*t445*t303+t308)*s2l1+((6144*t366-6144*t368)*s34r-6
     #144*t445*t372-t376)*s2l2+(12288*t293*t151-12288*t293*t154)*s34r-12
     #288*t306*t151+12288*t306*t154)*s23r+((6144*t72-6144*t73)*s34r-6144
     #*t472*t303-6144*t344)*s2l1+((-6144*t114+6144*t115)*s34r+6144*t472*
     #t372+6144*t405)*s2l2+(-18432*t152+18432*t155)*s34r+6144*t492*t151-
     #6144*t492*t154)*s1vr+(t503*s2l1+t508*s2l2)*t290+(((-6144*t512*t14+
     #6144*t337)*s34r+6144*t520*t303+6144*t524*t343)*s2l1+((6144*t512*t2
     #2-6144*t400)*s34r-6144*t520*t372-6144*t524*t404)*s2l2+(12288*t541*
     #t151-12288*t541*t154)*s34r+12288*t549-12288*t551)*s23r
      t599 = s1+(6144*t78*t216+(6144*t203+6144*t84*t336)*s34r-6144*t563*
     #t14+6144*t567*t17)*s2l1+(-6144*t78*t237+(-6144*t209-6144*t84*t399)
     #*s34r+6144*t563*t22-6144*t567*t25)*s2l2-6144*t192*t101+(-6144*t588
     #*t151+6144*t588*t154)*s34r-6144*t594*t266+6144*t594*t269
      t601 = t64**2
      t602 = t601*t3
      t603 = t602*t10
      t607 = t274*t41
      t608 = t607*t10
      t612 = t64*t2
      t621 = t290*s23r
      t624 = t601*t32*t5
      t631 = t607*(z+2)
      t642 = t612*z
      t651 = t1*l3
      t653 = 6144*t651*t14
      t656 = t607*z
      t662 = t275*t300
      t664 = t275*z
      t680 = t517*l3*t1
      t730 = 6144*t651*t22
      t763 = t153*s2l1
      t765 = t150*s2l2
      t779 = t612*t10
      t791 = 2*z-1
      t792 = t607*t791
      t804 = t612*(t518-2)
      t814 = t64*(t443-1)*t2
      t821 = t651*t791
      t829 = t313*t10
      t838 = t612*t517
      t848 = t280*t547
      t860 = t566*t10
      s2 = (((6144*t8*t14+6144*t8*t17)*s2l1+(-6144*t8*t22-6144*t8*t25)*s
     #2l2)*s1vr+((-6144*t35*t14-6144*t35*t17)*s34r-6144*t42*t14-6144*t42
     #*t17)*s2l1+((6144*t35*t22+6144*t35*t25)*s34r+6144*t42*t22+6144*t42
     #*t25)*s2l2)*t61*s13r+t272*t61+t599*s13r
      s3 = s2+((-6144*t603*t153*t290+12288*t608*t153*s23r-6144*t612*t14)
     #*t67+((6144*t602*t14+6144*t602*t17)*t621+((6144*t624*t14+6144*t624
     #*t17)*s34r-6144*t631*t14+6144*t275*t17)*t290+((-18432*t286-6144*t2
     #87)*s34r+6144*t642*t14-6144*t642*t17)*s23r+12288*t281*t80+t653)*s1
     #vr+(6144*t656*t14+6144*t656*t17)*t621+((6144*t662*t303+6144*t664*t
     #343)*s34r-6144*t280*t14+6144*t499*t17)*t290+(6144*t293*t103-t503*s
     #34r-t653-6144*t680*t17)*s23r-6144*t66*t103-6144*t314*t80)*s1l1
      s4 = s3+((6144*t603*t150*t290-12288*t608*t150*s23r+6144*t612*t22)*
     #t67+((-6144*t602*t22-6144*t602*t25)*t621+((-6144*t624*t22-6144*t62
     #4*t25)*s34r+6144*t631*t22-6144*t275*t25)*t290+((18432*t361+6144*t3
     #62)*s34r-6144*t642*t22+6144*t642*t25)*s23r-12288*t281*t120-t730)*s
     #1vr+(-6144*t656*t22-6144*t656*t25)*t621+((-6144*t662*t372-6144*t66
     #4*t404)*s34r+6144*t280*t22-6144*t499*t25)*t290+(-6144*t293*t137-t5
     #08*s34r+t730+6144*t680*t25)*s23r+6144*t66*t137+6144*t314*t120)*s1l
     #2
      s1 = s4+((-6144*t603*t763+6144*t603*t765+6144*t603*t266-6144*t603*
     #t269)*t290+(12288*t608*t763-12288*t608*t765-12288*t608*t266+12288*
     #t608*t269)*s23r-6144*t779*t763+6144*t779*t765+6144*t779*t266-6144*
     #t779*t269)*t67+((-6144*t792*t145+6144*t792*t148+12288*t656*t151-12
     #288*t656*t154)*t290+(6144*t804*t145-6144*t804*t148+(6144*t417-6144
     #*t418)*s34r-6144*t814*t151+6144*t814*t154)*s23r-6144*t821*t145+614
     #4*t821*t148+(-6144*t426+6144*t428)*s34r+6144*t829*t266-6144*t829*t
     #269)*s1vr
      taux12 = s1+(-6144*t499*t145+6144*t499*t148+6144*t838*t151-6144*t8
     #38*t154)*t290+(12288*t342*t145-12288*t342*t148+(6144*t848*t151-614
     #4*t848*t154)*s34r-6144*t342*t151+6144*t342*t154)*s23r-6144*t860*t7
     #63+6144*t860*t765+(-6144*t549+6144*t551)*s34r-6144*t223*t266+6144*
     #t223*t269

CCC Coefficients

      tcoff23 = taux11
      tcoff24 = taux12

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet23 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff23)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet24 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff24)

CCC Sum

      ggrmnum5e3 = tFjet23*tcoff23+tFjet24*tcoff24
      RETURN
      END

      double precision function ggrmnum5e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux11 = 0
      taux12 = 0

CCC Coefficients

      tcoff23 = taux11
      tcoff24 = taux12

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet23 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff23)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet24 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+
     #z-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff24)

CCC Sum

      ggrmnum5e4 = tFjet23*tcoff23+tFjet24*tcoff24
      RETURN
      END

      double precision function ggrmnum6e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = t1**2
      t3 = 1/t2
      t4 = s4l2*t3
      t5 = t4*s2l1
      t6 = s4l1*t3
      t7 = t6*s2l2
      t10 = s23f(z,l1,l2,l3,l4)
      t12 = 64.D0/3.D0*t5
      t13 = 64.D0/3.D0*t7
      t15 = s13f(z,l1,l2,l3,l4)
      t16 = t15**2
      t19 = t10**2
      t20 = t4*t19
      t22 = t4*t10
      t26 = t6*t19
      t28 = t6*t10
      t34 = t4*s3l1
      t36 = t6*s3l2
      t40 = 128.D0/3.D0*t5
      t41 = 128.D0/3.D0*t7
      t42 = 128*t34
      t43 = 128*t36
      t46 = 64.D0/3.D0*t34
      t47 = 64.D0/3.D0*t36
      t50 = t19*t10
      t51 = t4*t50
      t53 = 128.D0/3.D0*t20
      t56 = t6*t50
      t58 = 128.D0/3.D0*t26
      t65 = -t34-t36
      taux13 = ((256.D0/3.D0*t5+256.D0/3.D0*t7)*t10+t12+t13)*t16*t15+((-
     #256.D0/3.D0*t20-64*t22)*s1l1+(-256.D0/3.D0*t26-64*t28)*s1l2+(-256.
     #D0/3.D0*t5-256.D0/3.D0*t7-512.D0/3.D0*t34-512.D0/3.D0*t36)*t19+(t4
     #0+t41-t42-t43)*t10+t40+t41-t46-t47)*t16+((256.D0/3.D0*t51+t53)*s1l
     #1+(256.D0/3.D0*t56+t58)*s1l2+(-64*t5-64*t7-t42-t43)*t19+128*t65*t1
     #0+t12+t13-128.D0/3.D0*t34-128.D0/3.D0*t36)*t15+(64.D0/3.D0*t51+t53
     #+64.D0/3.D0*t22)*s1l1+(64.D0/3.D0*t56+t58+64.D0/3.D0*t28)*s1l2+64.
     #D0/3.D0*t65*t19+128.D0/3.D0*t65*t10-t46-t47
      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = t1**2
      t3 = 1/t2
      t4 = s4l2*t3
      t5 = t4*s2l1
      t6 = s4l1*t3
      t7 = t6*s2l2
      t10 = s23f(z,l1,l2,l3,l4)
      t12 = 256.D0/3.D0*t5
      t13 = 256.D0/3.D0*t7
      t15 = s13f(z,l1,l2,l3,l4)
      t16 = t15**2
      t19 = t10**2
      t20 = t4*t19
      t22 = t4*t10
      t26 = t6*t19
      t28 = t6*t10
      t34 = t4*s3l1
      t36 = t6*s3l2
      t40 = 512.D0/3.D0*t5
      t41 = 512.D0/3.D0*t7
      t42 = 512*t34
      t43 = 512*t36
      t46 = 256.D0/3.D0*t34
      t47 = 256.D0/3.D0*t36
      t50 = t19*t10
      t51 = t4*t50
      t53 = 512.D0/3.D0*t20
      t56 = t6*t50
      t58 = 512.D0/3.D0*t26
      t65 = t34-t36
      taux14 = ((-1024.D0/3.D0*t5+1024.D0/3.D0*t7)*t10-t12+t13)*t16*t15+
     #((1024.D0/3.D0*t20+256*t22)*s1l1+(-1024.D0/3.D0*t26-256*t28)*s1l2+
     #(1024.D0/3.D0*t5-1024.D0/3.D0*t7+2048.D0/3.D0*t34-2048.D0/3.D0*t36
     #)*t19+(-t40+t41+t42-t43)*t10-t40+t41+t46-t47)*t16+((-1024.D0/3.D0*
     #t51-t53)*s1l1+(1024.D0/3.D0*t56+t58)*s1l2+(256*t5-256*t7+t42-t43)*
     #t19+512*t65*t10-t12+t13+512.D0/3.D0*t34-512.D0/3.D0*t36)*t15+(-256
     #.D0/3.D0*t51-t53-256.D0/3.D0*t22)*s1l1+(256.D0/3.D0*t56+t58+256.D0
     #/3.D0*t28)*s1l2+256.D0/3.D0*t65*t19+512.D0/3.D0*t65*t10+t46-t47

CCC Coefficients

      tcoff25 = taux13
      tcoff26 = taux13
      tcoff27 = taux14
      tcoff28 = -taux14

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet25 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff25)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet26 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff26)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet27 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff27)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet28 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff28)

CCC Sum

      ggrmnum6e0 = tFjet25*tcoff25+tFjet26*tcoff26+tFjet27*tcoff27+tFjet
     #28*tcoff28
      RETURN
      END

      double precision function ggrmnum6e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = t1**2
      t3 = 1/t2
      t4 = z*t3
      t5 = s23f(z,l1,l2,l3,l4)
      t6 = t5**2
      t7 = t4*t6
      t8 = 512.D0/3.D0*t7
      t9 = s24f(z,l1,l2,l3,l4)
      t10 = t4*t9
      t15 = 64.D0/3.D0*t10
      t16 = s4l2*t3
      t17 = t16*s2l1
      t18 = 64.D0/3.D0*t17
      t19 = s4l1*t3
      t20 = t19*s2l2
      t21 = 64.D0/3.D0*t20
      t22 = 64.D0/3.D0*t4
      t24 = s13f(z,l1,l2,l3,l4)
      t25 = t24**2
      t29 = t4*t5
      t30 = 64*t29
      t32 = s14f(z,l1,l2,l3,l4)
      t35 = t16*t5*s1l1
      t38 = t19*t5*s1l2
      t40 = t6*t5
      t41 = t4*t40
      t43 = 2*z
      t55 = 64.D0/3.D0*z*(-13+6*z)*t3
      t58 = 64*t10
      t59 = 128.D0/3.D0*t17
      t60 = 128.D0/3.D0*t20
      t61 = t16*s3l1
      t62 = 64.D0/3.D0*t61
      t63 = t19*s3l2
      t64 = 64.D0/3.D0*t63
      t67 = z*(z-3)*t3
      t69 = (-256.D0/3.D0*t7-t30-t22)*t32+64.D0/3.D0*t35+64.D0/3.D0*t38-
     #512.D0/3.D0*t41+(-256.D0/3.D0*t10+256.D0/3.D0*z*(-5+t43)*t3)*t6+(-
     #512.D0/3.D0*t10+t55)*t5-t58-t59-t60+t62+t64+64.D0/3.D0*t67
      t89 = 128.D0/3.D0*t61
      t90 = 128.D0/3.D0*t63
      t94 = 64.D0/3.D0*z*(3-t43)*t3
      t95 = (-256.D0/3.D0*t41-t8-128*t29-128.D0/3.D0*t4)*t32-128.D0/3.D0
     #*t35-128.D0/3.D0*t38-128*t41+(-t58+t18+t21+t55)*t6+(-128*t10-t59-t
     #60-128.D0/3.D0*z*(5-3*z)*t3)*t5-t58-t18-t21+t89+t90-t94
      t97 = 64.D0/3.D0*t41
      taux13 = (-t8+(-256.D0/3.D0*t10-128*t4)*t5-t15-t18-t21-t22)*t25*t2
     #4+t69*t25+t95*t24+(-t97-64*t7-t30-t22)*t32+(-64.D0/3.D0*t16*t40-12
     #8.D0/3.D0*t16*t6-64.D0/3.D0*t16*t5)*s1l1+(-64.D0/3.D0*t19*t40-128.
     #D0/3.D0*t6*t19-64.D0/3.D0*t19*t5)*s1l2-t97+(-64.D0/3.D0*t10+64.D0/
     #3.D0*t61+64.D0/3.D0*t63+64.D0/3.D0*t67)*t6+(-128.D0/3.D0*t10+t89+t
     #90-t94)*t5-t15+t62+t64+64.D0/3.D0*z*(-1+z)*t3
      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = t1**2
      t3 = 1/t2
      t4 = s4l2*t3
      t5 = t4*s2l1
      t6 = s4l1*t3
      t7 = t6*s2l2
      t10 = s23f(z,l1,l2,l3,l4)
      t12 = 1024.D0/3.D0*t5
      t13 = 1024.D0/3.D0*t7
      t15 = s13f(z,l1,l2,l3,l4)
      t16 = t15**2
      t19 = t10**2
      t20 = t4*t19
      t22 = t4*t10
      t26 = t6*t19
      t28 = t6*t10
      t34 = t4*s3l1
      t36 = t6*s3l2
      t42 = 1536*t34
      t43 = 1536*t36
      t48 = 1024.D0/3.D0*t34
      t49 = 1024.D0/3.D0*t36
      t52 = t19*t10
      t53 = t4*t52
      t59 = t6*t52
      t87 = -t34+t36
      taux14 = ((1024*t5-1024*t7)*t10+t12-t13)*t16*t15+((-1024*t20-2560.
     #D0/3.D0*t22)*s1l1+(1024*t26+2560.D0/3.D0*t28)*s1l2+(-1024*t5+1024*
     #t7-2048*t34+2048*t36)*t19+(512*t5-512*t7-t42+t43)*t10+2048.D0/3.D0
     #*t5-2048.D0/3.D0*t7-t48+t49)*t16+((1024*t53+512*t20+512.D0/3.D0*t2
     #2)*s1l1+(-1024*t59-512*t26-512.D0/3.D0*t28)*s1l2+(-2560.D0/3.D0*t5
     #+2560.D0/3.D0*t7-t42+t43)*t19+(512.D0/3.D0*t5-512.D0/3.D0*t7-t42+t
     #43)*t10+t12-t13-2048.D0/3.D0*t34+2048.D0/3.D0*t36)*t15+(1024.D0/3.
     #D0*t53+2048.D0/3.D0*t20+1024.D0/3.D0*t22)*s1l1+(-1024.D0/3.D0*t59-
     #2048.D0/3.D0*t26-1024.D0/3.D0*t28)*s1l2+1024.D0/3.D0*t87*t19+2048.
     #D0/3.D0*t87*t10-t48+t49

CCC Coefficients

      tcoff25 = taux13
      tcoff26 = taux13
      tcoff27 = taux14
      tcoff28 = -taux14

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet25 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff25)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet26 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff26)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet27 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff27)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet28 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff28)

CCC Sum

      ggrmnum6e1 = tFjet25*tcoff25+tFjet26*tcoff26+tFjet27*tcoff27+tFjet
     #28*tcoff28
      RETURN
      END

      double precision function ggrmnum6e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = t1**2
      t3 = 1/t2
      t4 = z*t3
      t5 = s24f(z,l1,l2,l3,l4)
      t6 = t4*t5
      t9 = s13f(z,l1,l2,l3,l4)
      t10 = t9**2
      t13 = s23f(z,l1,l2,l3,l4)
      t14 = t4*t13
      t17 = s14f(z,l1,l2,l3,l4)
      t20 = 64*t6
      t21 = s4l2*t3
      t23 = 64.D0/3.D0*t21*s2l1
      t24 = s4l1*t3
      t26 = 64.D0/3.D0*t24*s2l2
      t29 = z*(3-z)*t3
      t44 = t13**2
      t46 = 128.D0/3.D0*t6
      t47 = t21*s3l1
      t49 = t24*s3l2
      t54 = 64.D0/3.D0*t47
      t55 = 64.D0/3.D0*t49
      t60 = 64.D0/3.D0*z*(2*z-3)*t3
      t61 = (128.D0/3.D0*t14+128.D0/3.D0*t4)*t17+64.D0/3.D0*t21*t13*s1l1
     #+64.D0/3.D0*t24*t13*s1l2+(-64.D0/3.D0*t6+64.D0/3.D0*t4)*t44+(t46+t
     #23+t26+128.D0/3.D0*t47+128.D0/3.D0*t49+256.D0/3.D0*t4)*t13+t20-t23
     #-t26+t54+t55-t60
      t65 = 64.D0/3.D0*t4*t44*t13
      taux13 = (64.D0/3.D0*t6+64.D0/3.D0*t4)*t10*t9+((-64.D0/3.D0*t14+64
     #.D0/3.D0*t4)*t17+64.D0/3.D0*t14+t20-t23-t26+64.D0/3.D0*t29)*t10+t6
     #1*t9+(t65+64*t4*t44+64*t14+64.D0/3.D0*t4)*t17+(-64.D0/3.D0*t21*t44
     #-64.D0/3.D0*t21*t13)*s1l1+(-64.D0/3.D0*t24*t44-64.D0/3.D0*t24*t13)
     #*s1l2+t65+(64.D0/3.D0*t6+64.D0/3.D0*t29)*t44+(t46+t54+t55-t60)*t13
     #+64.D0/3.D0*t6+t54+t55-64.D0/3.D0*z*(-1+z)*t3
      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = t1**2
      t3 = 1/t2
      t4 = s4l2*t3
      t5 = t4*s2l1
      t6 = s4l1*t3
      t7 = t6*s2l2
      t10 = s23f(z,l1,l2,l3,l4)
      t15 = s13f(z,l1,l2,l3,l4)
      t16 = t15**2
      t19 = t10**2
      t20 = t4*t19
      t22 = t4*t10
      t26 = t6*t19
      t28 = t6*t10
      t34 = t4*s3l1
      t36 = t6*s3l2
      t40 = 1024.D0/3.D0*t5
      t41 = 1024.D0/3.D0*t7
      t42 = 1024*t34
      t43 = 1024*t36
      t46 = 768*t5
      t47 = 768*t7
      t52 = t19*t10
      t53 = t4*t52
      t59 = t6*t52
      t87 = t34-t36
      taux14 = ((-2048.D0/3.D0*t5+2048.D0/3.D0*t7)*t10-1280.D0/3.D0*t5+1
     #280.D0/3.D0*t7)*t16*t15+((2048.D0/3.D0*t20+768*t22)*s1l1+(-2048.D0
     #/3.D0*t26-768*t28)*s1l2+(2048.D0/3.D0*t5-2048.D0/3.D0*t7+4096.D0/3
     #.D0*t34-4096.D0/3.D0*t36)*t19+(-t40+t41+t42-t43)*t10-t46+t47+1280.
     #D0/3.D0*t34-1280.D0/3.D0*t36)*t16+((-2048.D0/3.D0*t53-1024.D0/3.D0
     #*t20-1792.D0/3.D0*t22)*s1l1+(2048.D0/3.D0*t59+1024.D0/3.D0*t26+179
     #2.D0/3.D0*t28)*s1l2+(t46-t47+t42-t43)*t19+(-1792.D0/3.D0*t5+1792.D
     #0/3.D0*t7+2560.D0/3.D0*t34-2560.D0/3.D0*t36)*t10-t40+t41+768*t34-7
     #68*t36)*t15+(-1280.D0/3.D0*t53-768*t20-1024.D0/3.D0*t22)*s1l1+(128
     #0.D0/3.D0*t59+768*t26+1024.D0/3.D0*t28)*s1l2+1280.D0/3.D0*t87*t19+
     #768*t87*t10+1024.D0/3.D0*t34-1024.D0/3.D0*t36

CCC Coefficients

      tcoff25 = taux13
      tcoff26 = taux13
      tcoff27 = taux14
      tcoff28 = -taux14

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet25 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff25)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet26 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t3-
     #t1,-1+z-t4-t2,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff26)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet27 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t3-
     #t1,-1+z-t4-t2,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff27)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet28 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t3-
     #t1,-1+z-t4-t2,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff28)

CCC Sum

      ggrmnum6e2 = tFjet25*tcoff25+tFjet26*tcoff26+tFjet27*tcoff27+tFjet
     #28*tcoff28
      RETURN
      END

      double precision function ggrmnum6e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = t1**2
      t3 = 1/t2
      t4 = z*t3
      t5 = s23f(z,l1,l2,l3,l4)
      t6 = t4*t5
      t7 = 128.D0/3.D0*t6
      t8 = s24f(z,l1,l2,l3,l4)
      t9 = t4*t8
      t10 = 64.D0/3.D0*t9
      t11 = 64.D0/3.D0*t4
      t13 = s13f(z,l1,l2,l3,l4)
      t14 = t13**2
      t18 = s14f(z,l1,l2,l3,l4)
      t20 = t5**2
      t21 = t4*t20
      t25 = z*(-2+z)*t3
      t33 = 64.D0/3.D0*t21
      taux13 = (t7+t10+t11)*t14+((64.D0/3.D0*t6+64.D0/3.D0*t4)*t18+128.D
     #0/3.D0*t21+(t10-128.D0/3.D0*t25)*t5+128.D0/3.D0*t9-64.D0/3.D0*t25)
     #*t13+(t33+t7+t11)*t18+t33+(64.D0/3.D0*t9-64.D0/3.D0*t25)*t5+t10-64
     #.D0/3.D0*z*(-1+z)*t3
      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = t1**2
      t3 = 1/t2
      t4 = s4l2*t3
      t5 = t4*s2l1
      t6 = s4l1*t3
      t7 = t6*s2l2
      t9 = 512.D0/3.D0*t5-512.D0/3.D0*t7
      t10 = s13f(z,l1,l2,l3,l4)
      t11 = t10**2
      t14 = s23f(z,l1,l2,l3,l4)
      t16 = t4*t14*s1l1
      t19 = t6*t14*s1l2
      t21 = 256.D0/3.D0*t5
      t22 = 256.D0/3.D0*t7
      t23 = t4*s3l1
      t25 = t6*s3l2
      t32 = t14**2
      t40 = 256.D0/3.D0*t23
      t41 = 256.D0/3.D0*t25
      t44 = t32*t14
      t61 = -t23+t25
      taux14 = t9*t11*t10+(-512.D0/3.D0*t16+512.D0/3.D0*t19+t21-t22-512.
     #D0/3.D0*t23+512.D0/3.D0*t25)*t11+(1792.D0/3.D0*t16-1792.D0/3.D0*t1
     #9-t9*t32+(1792.D0/3.D0*t5-1792.D0/3.D0*t7+512*t23-512*t25)*t14-t21
     #+t22-t40+t41)*t10+(512.D0/3.D0*t4*t44+256.D0/3.D0*t4*t32-256.D0/3.
     #D0*t4*t14)*s1l1+(-512.D0/3.D0*t6*t44-256.D0/3.D0*t6*t32+256.D0/3.D
     #0*t6*t14)*s1l2+512.D0/3.D0*t61*t32+256.D0/3.D0*t61*t14+t40-t41

CCC Coefficients

      tcoff25 = taux13
      tcoff26 = taux13
      tcoff27 = taux14
      tcoff28 = -taux14

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet25 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t3-
     #t1,-1+z-t4-t2,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff25)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet26 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t3-
     #t1,-1+z-t4-t2,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff26)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet27 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t3-
     #t1,-1+z-t4-t2,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff27)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet28 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t3-
     #t1,-1+z-t4-t2,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff28)

CCC Sum

      ggrmnum6e3 = tFjet25*tcoff25+tFjet26*tcoff26+tFjet27*tcoff27+tFjet
     #28*tcoff28
      RETURN
      END

      double precision function ggrmnum6e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux13 = 0
      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = t1**2
      t3 = 1/t2
      t4 = s4l2*t3
      t5 = t4*s2l1
      t6 = s4l1*t3
      t7 = t6*s2l2
      t10 = s13f(z,l1,l2,l3,l4)
      t11 = t10**2
      t13 = s23f(z,l1,l2,l3,l4)
      t20 = 512.D0/3.D0*t5
      t21 = 512.D0/3.D0*t7
      t22 = t4*s3l1
      t24 = t6*s3l2
      t28 = 512.D0/3.D0*t22
      t29 = 512.D0/3.D0*t24
      t32 = t13**2
      taux14 = (512.D0/3.D0*t5-512.D0/3.D0*t7)*t11+(-512.D0/3.D0*t4*t13*
     #s1l1+512.D0/3.D0*t6*t13*s1l2+(-t20+t21-1024.D0/3.D0*t22+1024.D0/3.
     #D0*t24)*t13+t20-t21-t28+t29)*t10+(512.D0/3.D0*t4*t32+512.D0/3.D0*t
     #4*t13)*s1l1+(-512.D0/3.D0*t6*t32-512.D0/3.D0*t6*t13)*s1l2+(-512.D0
     #/3.D0*t22+512.D0/3.D0*t24)*t13-t28+t29

CCC Coefficients

      tcoff25 = taux13
      tcoff26 = taux13
      tcoff27 = taux14
      tcoff28 = -taux14

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet25 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff25)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet26 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff26)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet27 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff27)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet28 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff28)

CCC Sum

      ggrmnum6e4 = tFjet25*tcoff25+tFjet26*tcoff26+tFjet27*tcoff27+tFjet
     #28*tcoff28
      RETURN
      END

      double precision function ggrmnum7e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = 1/t1
      t3 = s4l2*t2
      t4 = t3*s2l1
      t5 = s4l1*t2
      t6 = t5*s2l2
      t9 = s24f(z,l1,l2,l3,l4)
      t11 = t2*s2l2
      t12 = -t11-t3
      t14 = 128.D0/3.D0*t12*s2l1
      t15 = 128.D0/3.D0*t6
      t17 = s13f(z,l1,l2,l3,l4)
      t18 = t17**2
      t22 = s23f(z,l1,l2,l3,l4)
      t25 = s14f(z,l1,l2,l3,l4)
      t27 = 64.D0/3.D0*t11
      t28 = 128.D0/3.D0*t3
      t29 = t27+t28
      t33 = t3*t9
      t37 = t2*s2l1
      t38 = 64.D0/3.D0*t37
      t39 = 128.D0/3.D0*t5
      t40 = t38+t39
      t44 = t5*t9
      t50 = t3*s3l1
      t51 = 256.D0/3.D0*t50
      t52 = t5*s3l2
      t53 = 256.D0/3.D0*t52
      t56 = 128.D0/3.D0*t11
      t57 = t2*s3l2
      t58 = 128.D0/3.D0*t57
      t59 = 64.D0/3.D0*t3
      t62 = t2*s3l1
      t63 = 128.D0/3.D0*t62
      t64 = 64.D0/3.D0*t5
      t69 = 64.D0/3.D0*t57
      t70 = 64*t3
      t73 = 64.D0/3.D0*t62
      t74 = 64*t5
      t77 = 128.D0/3.D0*t50
      t78 = 128.D0/3.D0*t52
      t81 = -1+z
      t85 = 128.D0/3.D0*z
      t86 = -64+t85
      t87 = t86*t2
      t96 = t22**2
      t113 = (t63+t64)*s2l2
      t116 = t57*s2l1
      t118 = t62*s2l2
      t121 = 128*t52
      t126 = (64.D0/3.D0*t57-64.D0/3.D0*t3)*s2l1
      t129 = (64.D0/3.D0*t62-64.D0/3.D0*t5)*s2l2
      t132 = t9*t2
      t139 = (-t27-t58-t59)*t9
      t146 = (128.D0/3.D0-64.D0/3.D0*z)*t2
      t149 = (320.D0/3.D0-t85)*t2
      t156 = -64.D0/3.D0*t81
      t157 = t156*t2
      t161 = (2*z-3)*t2
      t167 = (-t38-t63-t64)*t9
      t183 = z*t2
      t199 = (256.D0/3.D0-t85)*t2
      t202 = 64.D0/3.D0*t183*s4l2
      t207 = 64.D0/3.D0*t183*s4l1
      t212 = (512.D0/3.D0-256.D0/3.D0*z)*t2
      t213 = s3l1*s4l2
      t215 = s3l2*s4l1
      t221 = 64*t52
      t226 = -t156*t2
      t235 = -t86*t2
      t236 = t235*t213
      t237 = t235*t215
      t241 = t96*t22
      t242 = 64.D0/3.D0*t12*t241
      t251 = (-64.D0/3.D0*t37-64.D0/3.D0*t5)*t241
      t258 = 64.D0/3.D0*t116
      t259 = 64.D0/3.D0*t118
      t261 = (t258+t259+t77+t78)*t96
      t275 = 64.D0/3.D0*t33
      t279 = t81*t2
      t287 = 64.D0/3.D0*t44
      s2 = ((-128.D0/3.D0*t4-128.D0/3.D0*t6)*t9+t14-t15)*t18*t17+(((t14-
     #t15)*t22+t14-t15)*t25+((t29*t9+t27+t28)*t22+128.D0/3.D0*t33+t27+t2
     #8)*s1l1+((t40*t9+t38+t39)*t22+128.D0/3.D0*t44+t38+t39)*s1l2+((64.D
     #0/3.D0*t4+64.D0/3.D0*t6+t51+t53)*t9+(-t56+t58-t59)*s2l1+(t63-t64)*
     #s2l2+t51+t53)*t22+((-t56-t69-t70)*s2l1+(-t73-t74)*s2l2+t77+t78)*t9
     #+(128.D0/3.D0*t81*t2*s2l2+t69+t87*s4l2)*s2l1+(t73+t87*s4l1)*s2l2+t
     #77+t78)*t18
      s4 = s2
      s8 = ((t29*t96+(t56+256.D0/3.D0*t3)*t22+t27+t28)*s1l1+(t40*t96+(12
     #8.D0/3.D0*t37+256.D0/3.D0*t5)*t22+t38+t39)*s1l2+((t56+t58+t59)*s2l
     #1+t113+t51+t53)*t96+(64*t116+64*t118+128*t50+t121)*t22+t126+t129+t
     #77+t78)*t25+((-128.D0/3.D0*t132*t96-128.D0/3.D0*t132*t22)*s1l2+(t1
     #39+t59)*t96+((t27+t70)*t9+t146*s2l2+t149*s4l2)*t22+(t27+t69+t70)*t
     #9+t157*s2l2-64.D0/3.D0*t161*s4l2)*s1l1
      s7 = s8+((t167+t64)*t96+((t38+t74)*t9+t146*s2l1+t149*s4l1)*t22+(t3
     #8+t73+t74)*t9+t157*s2l1-64.D0/3.D0*t161*s4l1)*s1l2+(128.D0/3.D0*t1
     #83*t9+128.D0/3.D0*t116+128.D0/3.D0*t118+t51+t53)*t96+(((t58+t59)*s
     #2l1+t113+(256.D0/3.D0*t57+128*t3)*s3l1+t121)*t9+(t199*s3l2-t202)*s
     #2l1+(t199*s3l1-t207)*s2l2+t212*t213+t212*t215)*t22
      s6 = s7+(t126+t129+(t58+t70)*s3l1+t221)*t9+(t157*s3l2+t226*s4l2)*s
     #2l1+(t157*s3l1+t226*s4l1)*s2l2+t236+t237
      s7 = t17
      s5 = s6*s7
      s3 = s4+s5
      s1 = s3+((t242-64.D0/3.D0*t11*t96+128.D0/3.D0*t3*t22+t59)*s1l1+(t2
     #51-64.D0/3.D0*t37*t96+128.D0/3.D0*t5*t22+t64)*s1l2+t261+(t258+t259
     #+64*t50+t221)*t22+64.D0/3.D0*t50+64.D0/3.D0*t52)*t25+(128.D0/3.D0*
     #t132*t241*s1l2+t242+(t139+t226*s2l2+t202)*t96+(t275+t146*s4l2)*t22
     #+t275-64.D0/3.D0*t279*s4l2)*s1l1
      taux15 = s1+(t251+(t167+t226*s2l1+t207)*t96+(t287+t146*s4l1)*t22+t
     #287-64.D0/3.D0*t279*s4l1)*s1l2+t261+((t258+t259+(128.D0/3.D0*t57+1
     #28.D0/3.D0*t3)*s3l1+t78)*t9+t157*s3l2*s2l1+t157*s3l1*s2l2+t236+t23
     #7)*t22+(64.D0/3.D0*t50+64.D0/3.D0*t52)*t9+t157*t213+t157*t215
      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = 1/t1
      t3 = s4l2*t2
      t4 = t3*s2l1
      t5 = s4l1*t2
      t6 = t5*s2l2
      t8 = 512.D0/3.D0*t4-512.D0/3.D0*t6
      t9 = s24f(z,l1,l2,l3,l4)
      t11 = 512.D0/3.D0*t4
      t12 = 512.D0/3.D0*t6
      t14 = s13f(z,l1,l2,l3,l4)
      t15 = t14**2
      t18 = s23f(z,l1,l2,l3,l4)
      t21 = s14f(z,l1,l2,l3,l4)
      t23 = t2*s2l2
      t24 = 256.D0/3.D0*t23
      t25 = 512.D0/3.D0*t3
      t30 = t3*t9
      t34 = t2*s2l1
      t35 = 256.D0/3.D0*t34
      t36 = 512.D0/3.D0*t5
      t41 = t5*t9
      t47 = t3*s3l1
      t48 = 1024.D0/3.D0*t47
      t49 = t5*s3l2
      t50 = 1024.D0/3.D0*t49
      t53 = t2*s3l2
      t54 = 512.D0/3.D0*t53
      t55 = 256.D0/3.D0*t3
      t58 = t2*s3l1
      t59 = 512.D0/3.D0*t58
      t60 = 256.D0/3.D0*t5
      t65 = 256.D0/3.D0*t53
      t66 = 256*t3
      t69 = 256.D0/3.D0*t58
      t70 = 256*t5
      t73 = 512.D0/3.D0*t47
      t74 = 512.D0/3.D0*t49
      t77 = 2*z
      t78 = t77-3
      t79 = t78*t2
      t91 = t18**2
      t108 = (t54-t55)*s2l1
      t110 = (-t59+t60)*s2l2
      t113 = t53*s2l1
      t115 = t58*s2l2
      t117 = 512*t47
      t118 = 512*t49
      t123 = (256.D0/3.D0*t53+256.D0/3.D0*t3)*s2l1
      t126 = (-256.D0/3.D0*t58-256.D0/3.D0*t5)*s2l2
      t136 = (-2+z)*t2
      t140 = (-5+t77)*t2
      t147 = -1+z
      t148 = t147*t2
      t152 = -t78*t2
      t189 = z*t2
      t191 = 256.D0/3.D0*t189*s4l2
      t197 = 256.D0/3.D0*t189*s4l1
      t200 = s3l1*s4l2
      t203 = s3l2*s4l1
      t208 = 256*t47
      t209 = 256*t49
      t214 = -t147*t2
      t215 = t214*s4l2
      t220 = t214*s4l1
      t231 = 256.D0/3.D0*t23+256.D0/3.D0*t3
      t232 = t91*t18
      t233 = t231*t232
      t241 = -256.D0/3.D0*t34-256.D0/3.D0*t5
      t242 = t241*t232
      t249 = 256.D0/3.D0*t113
      t250 = 256.D0/3.D0*t115
      t251 = t249-t250-t73+t74
      t252 = t251*t91
      s2 = (t8*t9+t11-t12)*t15*t14+((t8*t18+t11-t12)*t21+(((t24-t25)*t9-
     #t24-t25)*t18-512.D0/3.D0*t30-t24-t25)*s1l1+(((-t35+t36)*t9+t35+t36
     #)*t18+512.D0/3.D0*t41+t35+t36)*s1l2+((-256.D0/3.D0*t4+256.D0/3.D0*
     #t6-t48+t50)*t9+(t54+t55)*s2l1+(-t59-t60)*s2l2-t48+t50)*t18+((t65+t
     #66)*s2l1+(-t69-t70)*s2l2-t73+t74)*t9+(256.D0/3.D0*t53-256.D0/3.D0*
     #t79*s4l2)*s2l1+(-256.D0/3.D0*t58+256.D0/3.D0*t79*s4l1)*s2l2-t73+t7
     #4)*t15
      s4 = s2
      s8 = (((-t24-t25)*t91+(-512.D0/3.D0*t23-1024.D0/3.D0*t3)*t18-t24-t
     #25)*s1l1+((t35+t36)*t91+(512.D0/3.D0*t34+1024.D0/3.D0*t5)*t18+t35+
     #t36)*s1l2+(t108+t110-t48+t50)*t91+(256*t113-256*t115-t117+t118)*t1
     #8+t123+t126-t73+t74)*t21+(((-t24-t54+t55)*t9-t55)*t91+((-t24-t54-t
     #66)*t9+256.D0/3.D0*t136*s2l2+256.D0/3.D0*t140*s4l2)*t18+(-t24-t65-
     #t66)*t9+256.D0/3.D0*t148*s2l2-256.D0/3.D0*t152*s4l2)*s1l1
      s7 = s8+(((t35+t59-t60)*t9+t60)*t91+((t35+t59+t70)*t9-256.D0/3.D0*
     #t136*s2l1-256.D0/3.D0*t140*s4l1)*t18+(t35+t69+t70)*t9-256.D0/3.D0*
     #t148*s2l1+256.D0/3.D0*t152*s4l1)*s1l2+((512.D0/3.D0*t53-512.D0/3.D
     #0*t3)*s2l1+(-512.D0/3.D0*t58+512.D0/3.D0*t5)*s2l2-t48+t50)*t91+((t
     #108+t110-t117+t118)*t9+(-512.D0/3.D0*t136*s3l2+t191)*s2l1+(512.D0/
     #3.D0*t136*s3l1-t197)*s2l2+1024.D0/3.D0*t136*t200-1024.D0/3.D0*t136
     #*t203)*t18
      s6 = s7+(t123+t126-t208+t209)*t9+(-256.D0/3.D0*t148*s3l2+256.D0/3.
     #D0*t215)*s2l1+(256.D0/3.D0*t148*s3l1-256.D0/3.D0*t220)*s2l2+256.D0
     #/3.D0*t79*t200-256.D0/3.D0*t79*t203
      s7 = t14
      s5 = s6*s7
      s3 = s4+s5
      s1 = s3+((t233+256.D0/3.D0*t23*t91-512.D0/3.D0*t3*t18-t55)*s1l1+(t
     #242-256.D0/3.D0*t34*t91+512.D0/3.D0*t5*t18+t60)*s1l2+t252+(t249-t2
     #50-t208+t209)*t18-256.D0/3.D0*t47+256.D0/3.D0*t49)*t21+(t233+(t231
     #*t9+256.D0/3.D0*t214*s2l2-t191)*t91+(-256.D0/3.D0*t30+256.D0/3.D0*
     #t136*s4l2)*t18-256.D0/3.D0*t30-256.D0/3.D0*t215)*s1l1
      taux16 = s1+(t242+(t241*t9-256.D0/3.D0*t214*s2l1+t197)*t91+(256.D0
     #/3.D0*t41-256.D0/3.D0*t136*s4l1)*t18+256.D0/3.D0*t41+256.D0/3.D0*t
     #220)*s1l2+t252+(t251*t9-256.D0/3.D0*t148*s3l2*s2l1+256.D0/3.D0*t14
     #8*s3l1*s2l2-256.D0/3.D0*t152*t200+256.D0/3.D0*t152*t203)*t18+(-256
     #.D0/3.D0*t47+256.D0/3.D0*t49)*t9-256.D0/3.D0*t214*t200+256.D0/3.D0
     #*t214*t203

CCC Coefficients

      tcoff29 = taux15
      tcoff30 = taux15
      tcoff31 = taux15
      tcoff32 = taux15
      tcoff33 = taux16
      tcoff34 = -taux16
      tcoff35 = taux16
      tcoff36 = -taux16

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet29 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff29)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet30 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff30)
      t1 = s23f(z,l1,l2,l3,l4)
      t2 = s13f(z,l1,l2,l3,l4)
      t3 = s24f(z,l1,l2,l3,l4)
      t4 = s14f(z,l1,l2,l3,l4)
      tFjet31 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff31)
      t1 = s24f(z,l1,l2,l3,l4)
      t2 = s14f(z,l1,l2,l3,l4)
      t3 = s23f(z,l1,l2,l3,l4)
      t4 = s13f(z,l1,l2,l3,l4)
      tFjet32 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff32)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet33 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff33)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet34 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t3-t1-t4-t2,-1+z-t3-
     #t1,-1+z-t4-t2,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff34)
      t1 = s23f(z,l1,l2,l3,l4)
      t2 = s13f(z,l1,l2,l3,l4)
      t3 = s24f(z,l1,l2,l3,l4)
      t4 = s14f(z,l1,l2,l3,l4)
      tFjet35 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t3-t1-t4-t2,-1+z-t3-
     #t1,-1+z-t4-t2,1+t3+t4,1+t1+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff35)
      t1 = s24f(z,l1,l2,l3,l4)
      t2 = s14f(z,l1,l2,l3,l4)
      t3 = s23f(z,l1,l2,l3,l4)
      t4 = s13f(z,l1,l2,l3,l4)
      tFjet36 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t3-t1-t4-t2,-1+z-t3-
     #t1,-1+z-t4-t2,1+t3+t4,1+t1+t2,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff36)

CCC Sum

      ggrmnum7e0 = tFjet29*tcoff29+tFjet30*tcoff30+tFjet31*tcoff31+tFjet
     #32*tcoff32+tFjet33*tcoff33+tFjet34*tcoff34+tFjet35*tcoff35+tFjet36
     #*tcoff36
      RETURN
      END

      double precision function ggrmnum7e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = 1/t1
      t3 = z*t2
      t4 = s24f(z,l1,l2,l3,l4)
      t5 = t3*t4
      t6 = t5+t3
      t8 = s23f(z,l1,l2,l3,l4)
      t10 = t4**2
      t11 = t3*t10
      t12 = 128.D0/3.D0*t11
      t13 = 256.D0/3.D0*t5
      t14 = 128.D0/3.D0*t3
      t16 = s13f(z,l1,l2,l3,l4)
      t17 = t16**2
      t20 = t8**2
      t21 = t3*t20
      t28 = s14f(z,l1,l2,l3,l4)
      t30 = t2*s4l2
      t32 = 128.D0/3.D0*t30*t4
      t33 = t2*s2l2
      t34 = 64.D0/3.D0*t33
      t35 = 128.D0/3.D0*t30
      t38 = t2*s4l1
      t40 = 128.D0/3.D0*t38*t4
      t41 = t2*s2l1
      t42 = 64.D0/3.D0*t41
      t43 = 128.D0/3.D0*t38
      t49 = 4*z
      t52 = t2*t4
      t56 = 128.D0/3.D0*t33*s2l1
      t58 = 2*z-3
      t64 = 320.D0/3.D0*t11
      t69 = 1-z
      t76 = t3*t8
      t79 = t28**2
      t89 = t20*t8
      t90 = t3*t89
      t91 = 128.D0/3.D0*t90
      t99 = 128.D0/3.D0*t33
      t100 = 64.D0/3.D0*t30
      t104 = 64.D0/3.D0*t38*s2l2
      t105 = 8*z
      t112 = 64*t5
      t113 = -t69
      t114 = z*t113
      t124 = 256.D0/3.D0*t33
      t125 = 64*t30
      t128 = t2*s3l2
      t129 = 64.D0/3.D0*t128
      t132 = 64.D0/3.D0*z
      t134 = (-64+t132)*t2
      t136 = t58*t2
      t143 = 256.D0/3.D0*t41
      t144 = 64*t38
      t147 = 128.D0/3.D0*t41
      t148 = t2*s3l1
      t149 = 64.D0/3.D0*t148
      t158 = t99+t100
      t160 = 6*z
      t169 = t148*s2l2
      t170 = 64.D0/3.D0*t169
      t178 = t113*t2
      t184 = z**2
      t200 = 5*z
      t201 = 2*t184
      s1 = (128.D0/3.D0*t21+128.D0/3.D0*t76)*t79+(((-t34-t35)*t8-t34-t35
     #)*s1l1+((-t42-t43)*t8-t42-t43)*s1l2+t91+(t13-64.D0/3.D0*z*(-11+t49
     #)*t2)*t20+(192*t5+(t99-t100)*s2l1-t104+64.D0/3.D0*z*(-t105+11)*t2)
     #*t8+t112+t56-128.D0/3.D0*t114*t2)*t28+(128.D0/3.D0*t52*t8*s1l2-64.
     #D0/3.D0*t33*t20+(-t32-t124-t125)*t8+(-t99-t129-t125)*t4+t134*s2l2+
     #64.D0/3.D0*t136*s4l2)*s1l1+(-64.D0/3.D0*t41*t20+(-t40-t143-t144)*t
     #8+(-t147-t149-t144)*t4+t134*s2l1+64.D0/3.D0*t136*s4l1)*s1l2+t91+(5
     #12.D0/3.D0*t5+t158*s2l1+t104+64.D0/3.D0*z*(-t160+11)*t2)*t20
      t206 = s1+(t64+((t99+t129)*s2l1+t170-64.D0/3.D0*z*(-17+9*z)*t2)*t4
     #-128.D0/3.D0*t178*s2l2*s2l1+128.D0/3.D0*t30*s4l1+64.D0/3.D0*z*(4*t
     #184+13-14*z)*t2)*t8+256.D0/3.D0*t11+64.D0/3.D0*z*(8-t160)*t52-64.D
     #0/3.D0*t30*s2l1-t104+64.D0/3.D0*z*(4-t200+t201)*t2
      t219 = 64.D0/3.D0*t38
      t227 = t128*s2l1
      t228 = 64.D0/3.D0*t227
      t229 = 3*z
      t239 = z*(8-t49)
      t245 = 2-z
      t262 = (-256.D0/3.D0+t132)*t2
      t270 = (t229-5)*t2
      t279 = 2*t113*t2
      t312 = t30*s3l1
      t313 = 64.D0/3.D0*t312
      t314 = t38*s3l2
      t315 = 64.D0/3.D0*t314
      s2 = (256.D0/3.D0*t6*t8+t12+t13+t14)*t17*t16+((256.D0/3.D0*t21+(t1
     #3+512.D0/3.D0*t3)*t8+128.D0/3.D0*t5+t14)*t28+(-t32-t34-t35)*s1l1+(
     #-t40-t42-t43)*s1l2+128*t6*t20+(64*t11-64.D0/3.D0*z*(-17+t49)*t52+t
     #56-256.D0/3.D0*z*t58*t2)*t8+t64+64.D0/3.D0*z*(-t49+9)*t52+256.D0/3
     #.D0*z*t69*t2)*t17+t206*t16
      s3 = s2+(64.D0/3.D0*t90+128.D0/3.D0*t21+64.D0/3.D0*t76)*t79
      s1 = s3+((-t158*t20+(-t124-t35)*t8-t99-t100)*s1l1+((-t147-t219)*t2
     #0+(-t143-t43)*t8-t147-t219)*s1l2+256.D0/3.D0*t90+(t112-t228-t170+6
     #4.D0/3.D0*z*(10-t229)*t2)*t20+(t13-128.D0/3.D0*t227-128.D0/3.D0*t1
     #69+64.D0/3.D0*t239*t2)*t8+64.D0/3.D0*t5-t228-t170+64.D0/3.D0*z*t24
     #5*t2)*t28+((128.D0/3.D0*t52*t20+128.D0/3.D0*t52*t8)*s1l2+(-64.D0/3
     #.D0*t33-64.D0/3.D0*t30)*t89+(-64.D0/3.D0*t33*t4+t262*s2l2-t125)*t2
     #0+((-64*t33-t129-t100)*t4+64.D0/3.D0*t270*s2l2+t134*s4l2)*t8+(-t99
     #-t129-t100)*t4+64.D0/3.D0*t279*s2l2+64.D0/3.D0*t178*s4l2)*s1l1+((-
     #64.D0/3.D0*t41-64.D0/3.D0*t38)*t89+(-64.D0/3.D0*t41*t4+t262*s2l1-t
     #144)*t20+((-64*t41-t149-t219)*t4+64.D0/3.D0*t270*s2l1+t134*s4l1)*t
     #8+(-t147-t149-t219)*t4+64.D0/3.D0*t279*s2l1+64.D0/3.D0*t178*s4l1)*
     #s1l2
      taux15 = s1+64*t90+(320.D0/3.D0*t5+t313+t315+64.D0/3.D0*z*(8-t200)
     #*t2)*t20+(t12+64.D0/3.D0*t239*t52+128.D0/3.D0*t312+128.D0/3.D0*t31
     #4-64.D0/3.D0*z*(-7+t105-t201)*t2)*t8+64.D0/3.D0*t11-64.D0/3.D0*z*t
     #58*t52+t313+t315-64.D0/3.D0*t114*t245*t2
      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = 1/t1
      t3 = s4l2*t2
      t4 = t3*s2l1
      t5 = s4l1*t2
      t6 = t5*s2l2
      t8 = -512*t4+512*t6
      t9 = s24f(z,l1,l2,l3,l4)
      t11 = 512*t4
      t12 = 512*t6
      t14 = s13f(z,l1,l2,l3,l4)
      t15 = t14**2
      t18 = s23f(z,l1,l2,l3,l4)
      t21 = s14f(z,l1,l2,l3,l4)
      t23 = t2*s2l2
      t24 = 256*t23
      t25 = 512*t3
      t32 = 1024.D0/3.D0*t23
      t33 = 2048.D0/3.D0*t3
      t36 = t2*s2l1
      t37 = 256*t36
      t38 = 512*t5
      t45 = 1024.D0/3.D0*t36
      t46 = 2048.D0/3.D0*t5
      t51 = t3*s3l1
      t52 = 1024*t51
      t53 = t5*s3l2
      t54 = 1024*t53
      t57 = t2*s3l2
      t58 = 512*t57
      t59 = 256*t3
      t62 = t2*s3l1
      t63 = 512*t62
      t64 = 256*t5
      t69 = 256*t57
      t73 = 256*t62
      t77 = 512*t51
      t78 = 512*t53
      t81 = 6*z
      t83 = (-t81+9)*t2
      t95 = t18**2
      t112 = (-t58+t59)*s2l1
      t114 = (t63-t64)*s2l2
      t125 = 1536*t51
      t126 = 1536*t53
      t137 = 512.D0/3.D0*t23
      t145 = 3*z
      t147 = (-t145+7)*t2
      t151 = (18-t81)*t2
      t156 = 1024.D0/3.D0*t57
      t160 = 4*z
      t162 = (-t160+5)*t2
      t167 = (8*z-12)*t2
      t172 = 512.D0/3.D0*t36
      t186 = 1024.D0/3.D0*t62
      t207 = (6-t145)*t2
      t210 = z*t2
      t221 = s3l1*s4l2
      t224 = s3l2*s4l1
      t233 = 768*t51
      t234 = 768*t53
      t237 = 4-t145
      t238 = t237*t2
      t241 = -t237*t2
      t258 = t95*t18
      t265 = 256.D0/3.D0*t23
      t266 = 1024.D0/3.D0*t3
      t276 = 256.D0/3.D0*t36
      t277 = 1024.D0/3.D0*t5
      t280 = t57*s2l1
      t281 = 512.D0/3.D0*t280
      t282 = t62*s2l2
      t283 = 512.D0/3.D0*t282
      t288 = 256*t51
      t289 = 256*t53
      t297 = -1+z
      t299 = 3*t297*t2
      t303 = (t145-1)*t2
      t311 = (-t160+7)*t2
      t319 = t297*t2
      t323 = 4*t297*t2
      t354 = 256*t280
      t355 = 256*t282
      t362 = s2l1*s3l2
      t365 = s2l2*s3l1
      t369 = (-11+t81)*t2
      t381 = -t297*t2
      s3 = (t8*t9-t11+t12)*t15*t14
      s5 = ((t8*t18-t11+t12)*t21+(((-t24+t25)*t9+t24+t25)*t18+2048.D0/3.
     #D0*t3*t9+t32+t33)*s1l1+(((t37-t38)*t9-t37-t38)*t18-2048.D0/3.D0*t5
     #*t9-t45-t46)*s1l2+((256*t4-256*t6+t52-t54)*t9+(-t58-t59)*s2l1+(t63
     #+t64)*s2l2+t52-t54)*t18+((-t69-768*t3)*s2l1+(t73+768*t5)*s2l2+t77-
     #t78)*t9+(-t69-256.D0/3.D0*t83*s4l2)*s2l1+(t73+256.D0/3.D0*t83*s4l1
     #)*s2l2+t77-t78)*t15
      s9 = (((t24+t25)*t95+(1792.D0/3.D0*t23+3584.D0/3.D0*t3)*t18+t32+t3
     #3)*s1l1+((-t37-t38)*t95+(-1792.D0/3.D0*t36-3584.D0/3.D0*t5)*t18-t4
     #5-t46)*s1l2+(t112+t114+t52-t54)*t95+((-768*t57+256.D0/3.D0*t3)*s2l
     #1+(768*t62-256.D0/3.D0*t5)*s2l2+t125-t126)*t18+(-256*t57-256*t3)*s
     #2l1+(256*t62+256*t5)*s2l2+t77-t78)*t21+(((t137+t58-t59)*t9+t59)*t9
     #5+((t137+t58+2816.D0/3.D0*t3)*t9+256.D0/3.D0*t147*s2l2+256.D0/3.D0
     #*t151*s4l2)*t18+(t24+t156+1024*t3)*t9+256.D0/3.D0*t162*s2l2-256.D0
     #/3.D0*t167*s4l2)*s1l1
      s8 = s9+(((-t172-t63+t64)*t9-t64)*t95+((-t172-t63-2816.D0/3.D0*t5)
     #*t9-256.D0/3.D0*t147*s2l1-256.D0/3.D0*t151*s4l1)*t18+(-t37-t186-10
     #24*t5)*t9-256.D0/3.D0*t162*s2l1+256.D0/3.D0*t167*s4l1)*s1l2+((-t58
     #+1280.D0/3.D0*t3)*s2l1+(t63-1280.D0/3.D0*t5)*s2l2+t52-t54)*t95+((t
     #112+t114+t125-t126)*t9+(-512.D0/3.D0*t207*s3l2-256*t210*s4l2)*s2l1
     #+(512.D0/3.D0*t207*s3l1+256*t210*s4l1)*s2l2+1024.D0/3.D0*t207*t221
     #-1024.D0/3.D0*t207*t224)*t18
      s7 = s8+((-t156-t59)*s2l1+(t186+t64)*s2l2+t233-t234)*t9+(-256.D0/3
     #.D0*t238*s3l2+256.D0/3.D0*t241*s4l2)*s2l1+(256.D0/3.D0*t238*s3l1-2
     #56.D0/3.D0*t241*s4l1)*s2l2+256.D0/3.D0*t83*t221-256.D0/3.D0*t83*t2
     #24
      s8 = t14
      s6 = s7*s8
      s4 = s5+s6
      s2 = s3+s4
      s1 = s2+(((-t137-t59)*t258+(-256.D0/3.D0*t23+256.D0/3.D0*t3)*t95+(
     #t137+t33)*t18+t265+t266)*s1l1+((t172+t64)*t258+(256.D0/3.D0*t36-25
     #6.D0/3.D0*t5)*t95+(-t172-t46)*t18-t276-t277)*s1l2+(-t281+t283+t77-
     #t78)*t95+(-t281+t283+t233-t234)*t18+t288-t289)*t21+((-t24-t266)*t2
     #58+((-t24+256.D0/3.D0*t57-t59)*t9+256.D0/3.D0*t299*s2l2+256.D0/3.D
     #0*t303*s4l2)*t95+((t69+t266)*t9+t265+256.D0/3.D0*t311*s4l2)*t18+(t
     #265+512.D0/3.D0*t57+t266)*t9-256.D0/3.D0*t319*s2l2-256.D0/3.D0*t32
     #3*s4l2)*s1l1+((t37+t277)*t258+((t37-256.D0/3.D0*t62+t64)*t9-256.D0
     #/3.D0*t299*s2l1-256.D0/3.D0*t303*s4l1)*t95+((-t73-t277)*t9-t276-25
     #6.D0/3.D0*t311*s4l1)*t18+(-t276-512.D0/3.D0*t62-t277)*t9+256.D0/3.
     #D0*t319*s2l1+256.D0/3.D0*t323*s4l1)*s1l2
      taux16 = s1+(-t354+t355+1792.D0/3.D0*t51-1792.D0/3.D0*t53)*t95+((-
     #t354+t355+t77-t78)*t9-256.D0/3.D0*t238*t362+256.D0/3.D0*t238*t365-
     #256.D0/3.D0*t369*t221+256.D0/3.D0*t369*t224)*t18+(-256.D0/3.D0*t28
     #0+256.D0/3.D0*t282+t288-t289)*t9-256.D0/3.D0*t381*t362+256.D0/3.D0
     #*t381*t365-256.D0/3.D0*t241*t221+256.D0/3.D0*t241*t224

CCC Coefficients

      tcoff29 = taux15
      tcoff30 = taux15
      tcoff31 = taux15
      tcoff32 = taux15
      tcoff33 = taux16
      tcoff34 = -taux16
      tcoff35 = taux16
      tcoff36 = -taux16

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet29 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff29)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet30 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff30)
      t1 = s23f(z,l1,l2,l3,l4)
      t2 = s13f(z,l1,l2,l3,l4)
      t3 = s24f(z,l1,l2,l3,l4)
      t4 = s14f(z,l1,l2,l3,l4)
      tFjet31 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff31)
      t1 = s24f(z,l1,l2,l3,l4)
      t2 = s14f(z,l1,l2,l3,l4)
      t3 = s23f(z,l1,l2,l3,l4)
      t4 = s13f(z,l1,l2,l3,l4)
      tFjet32 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff32)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet33 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff33)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet34 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff34)
      t1 = s23f(z,l1,l2,l3,l4)
      t2 = s13f(z,l1,l2,l3,l4)
      t3 = s24f(z,l1,l2,l3,l4)
      t4 = s14f(z,l1,l2,l3,l4)
      tFjet35 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff35)
      t1 = s24f(z,l1,l2,l3,l4)
      t2 = s14f(z,l1,l2,l3,l4)
      t3 = s23f(z,l1,l2,l3,l4)
      t4 = s13f(z,l1,l2,l3,l4)
      tFjet36 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff36)

CCC Sum

      ggrmnum7e1 = tFjet29*tcoff29+tFjet30*tcoff30+tFjet31*tcoff31+tFjet
     #32*tcoff32+tFjet33*tcoff33+tFjet34*tcoff34+tFjet35*tcoff35+tFjet36
     #*tcoff36
      RETURN
      END

      double precision function ggrmnum7e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = 1/t1
      t3 = z*t2
      t4 = s24f(z,l1,l2,l3,l4)
      t5 = t3*t4
      t8 = s14f(z,l1,l2,l3,l4)
      t10 = 64.D0/3.D0*t5
      t11 = 64.D0/3.D0*t3
      t13 = s13f(z,l1,l2,l3,l4)
      t14 = t13**2
      t16 = s23f(z,l1,l2,l3,l4)
      t17 = t3*t16
      t20 = t8**2
      t22 = 64*t5
      t26 = t2*s2l2
      t29 = -2+z
      t35 = t26*t16
      t36 = t26*t4
      t40 = t2*s2l1
      t41 = t40*t16
      t42 = t40*t4
      t48 = t16**2
      t54 = 256.D0/3.D0*t5
      t55 = s4l2*t2
      t58 = s4l1*t2
      t64 = 64.D0/3.D0*z*(4-z)*t2
      t67 = t3*t48
      t80 = 64.D0/3.D0*t3*t48*t16
      t83 = t2*s3l2*s2l1
      t85 = t2*s3l1*s2l2
      t99 = t29*t2
      t105 = -1+z
      t106 = t105*t2
      t130 = 64.D0/3.D0*t55*s3l1
      t132 = 64.D0/3.D0*t58*s3l2
      s1 = ((128.D0/3.D0*t5+128.D0/3.D0*t3)*t8+t10+t11)*t14+((128.D0/3.D
     #0*t17+128.D0/3.D0*t3)*t20+((t22+256.D0/3.D0*t3)*t16+t22+128.D0/3.D
     #0*t26*s2l1-128.D0/3.D0*z*t29*t2)*t8+(-64.D0/3.D0*t35-64.D0/3.D0*t3
     #6-64.D0/3.D0*t26)*s1l1+(-64.D0/3.D0*t41-64.D0/3.D0*t42-64.D0/3.D0*
     #t40)*s1l2+(-64.D0/3.D0*t5+64.D0/3.D0*t3)*t48+(128.D0/3.D0*t5+320.D
     #0/3.D0*t3)*t16+t54-64.D0/3.D0*t55*s2l1-64.D0/3.D0*t58*s2l2+t64)*t1
     #3+(64.D0/3.D0*t67+128.D0/3.D0*t17+t11)*t20+((-64.D0/3.D0*t35-64.D0
     #/3.D0*t26)*s1l1+(-64.D0/3.D0*t41-64.D0/3.D0*t40)*s1l2+t80+128*t67+
     #(64.D0/3.D0*t5-64.D0/3.D0*t83-64.D0/3.D0*t85+64.D0/3.D0*z*(9-z)*t2
     #)*t16+t10-64.D0/3.D0*t83-64.D0/3.D0*t85+t64)*t8+((-64.D0/3.D0*t26-
     #64.D0/3.D0*t55)*t48+(-64.D0/3.D0*t36+64.D0/3.D0*t99*s2l2-64.D0/3.D
     #0*t55)*t16-64.D0/3.D0*t36+64.D0/3.D0*t106*s2l2)*s1l1+((-64.D0/3.D0
     #*t40-64.D0/3.D0*t58)*t48+(-64.D0/3.D0*t42+64.D0/3.D0*t99*s2l1-64.D
     #0/3.D0*t58)*t16-64.D0/3.D0*t42+64.D0/3.D0*t106*s2l1)*s1l2
      taux15 = s1+t80+(64.D0/3.D0*t5+64.D0/3.D0*z*(5-z)*t2)*t48+(t54+t13
     #0+t132-64.D0/3.D0*z*(-7+4*z)*t2)*t16+t22+t130+t132-64*t105*z*t2
      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = 1/t1
      t3 = s4l2*t2
      t4 = t3*s2l1
      t5 = s4l1*t2
      t6 = t5*s2l2
      t8 = 1024.D0/3.D0*t4-1024.D0/3.D0*t6
      t9 = s24f(z,l1,l2,l3,l4)
      t11 = 1024.D0/3.D0*t4
      t12 = 1024.D0/3.D0*t6
      t14 = s13f(z,l1,l2,l3,l4)
      t15 = t14**2
      t18 = s23f(z,l1,l2,l3,l4)
      t21 = s14f(z,l1,l2,l3,l4)
      t23 = t2*s2l2
      t24 = 512.D0/3.D0*t23
      t25 = 1024.D0/3.D0*t3
      t32 = 1280.D0/3.D0*t23
      t33 = 2560.D0/3.D0*t3
      t36 = t2*s2l1
      t37 = 512.D0/3.D0*t36
      t38 = 1024.D0/3.D0*t5
      t45 = 1280.D0/3.D0*t36
      t46 = 2560.D0/3.D0*t5
      t51 = t3*s3l1
      t52 = 2048.D0/3.D0*t51
      t53 = t5*s3l2
      t54 = 2048.D0/3.D0*t53
      t57 = t2*s3l2
      t58 = 1024.D0/3.D0*t57
      t59 = 512.D0/3.D0*t3
      t61 = (t58+t59)*s2l1
      t62 = t2*s3l1
      t63 = 1024.D0/3.D0*t62
      t64 = 512.D0/3.D0*t5
      t66 = (-t63-t64)*s2l2
      t69 = 512.D0/3.D0*t57
      t73 = 512.D0/3.D0*t62
      t77 = 1024.D0/3.D0*t51
      t78 = 1024.D0/3.D0*t53
      t81 = 2*z
      t83 = (t81-3)*t2
      t95 = t18**2
      t97 = 1792.D0/3.D0*t23
      t105 = 1792.D0/3.D0*t36
      t111 = t58-t59
      t113 = -t63+t64
      t117 = 512*t57
      t118 = 256*t3
      t121 = 512*t62
      t122 = 256*t5
      t125 = 1024*t51
      t126 = 1024*t53
      t139 = 256.D0/3.D0*t23
      t146 = (-10+t81)*t2
      t149 = 4*z
      t151 = (-19+t149)*t2
      t160 = 5*z
      t162 = (t160-9)*t2
      t167 = (-10*z+15)*t2
      t174 = 256.D0/3.D0*t36
      t213 = (-2+z)*t2
      t214 = t213*s3l2
      t217 = (t81-1)*t2
      t222 = t213*s3l1
      t228 = s3l1*s4l2
      t231 = s3l2*s4l1
      t236 = 512*t51
      t237 = 512*t53
      t241 = 1-z
      t243 = 2*t241*t2
      t259 = t95*t18
      t267 = 1024.D0/3.D0*t23
      t268 = 1280.D0/3.D0*t3
      t278 = 1024.D0/3.D0*t36
      t279 = 1280.D0/3.D0*t5
      t282 = t57*s2l1
      t284 = t62*s2l2
      t292 = 512.D0/3.D0*t282
      t293 = 512.D0/3.D0*t284
      t303 = (-2-z)*t2
      t308 = (-2-2*z)*t2
      t318 = (-3*z+7)*t2
      t322 = (-10+t160)*t2
      t330 = 4*t241*t2
      t334 = 5*t241*t2
      t372 = s2l1*s3l2
      t375 = s2l2*s3l1
      t379 = (-t149+7)*t2
      t390 = -t241*t2
      s3 = (t8*t9+t11-t12)*t15*t14
      s5 = ((t8*t18+t11-t12)*t21+(((t24-t25)*t9-t24-t25)*t18-2560.D0/3.D
     #0*t3*t9-t32-t33)*s1l1+(((-t37+t38)*t9+t37+t38)*t18+2560.D0/3.D0*t5
     #*t9+t45+t46)*s1l2+((-512.D0/3.D0*t4+512.D0/3.D0*t6-t52+t54)*t9+t61
     #+t66-t52+t54)*t18+((t69+512*t3)*s2l1+(-t73-512*t5)*s2l2-t77+t78)*t
     #9+(512.D0/3.D0*t57-512.D0/3.D0*t83*s4l2)*s2l1+(-512.D0/3.D0*t62+51
     #2.D0/3.D0*t83*s4l1)*s2l2-t77+t78)*t15
      s9 = (((-t24-t25)*t95+(-t97-3584.D0/3.D0*t3)*t18-t32-t33)*s1l1+((t
     #37+t38)*t95+(t105+3584.D0/3.D0*t5)*t18+t45+t46)*s1l2+(t111*s2l1+t1
     #13*s2l2-t52+t54)*t95+((t117-t118)*s2l1+(-t121+t122)*s2l2-t125+t126
     #)*t18+(512.D0/3.D0*t57+512.D0/3.D0*t3)*s2l1+(-512.D0/3.D0*t62-512.
     #D0/3.D0*t5)*s2l2-t77+t78)*t21+((-t111*t9-t139-t59)*t95+((-t139-t58
     #-1024*t3)*t9+256.D0/3.D0*t146*s2l2+256.D0/3.D0*t151*s4l2)*t18+(-t3
     #2-1280.D0/3.D0*t57-1280*t3)*t9+256.D0/3.D0*t162*s2l2-256.D0/3.D0*t
     #167*s4l2)*s1l1
      s8 = s9+((-t113*t9+t174+t64)*t95+((t174+t63+1024*t5)*t9-256.D0/3.D
     #0*t146*s2l1-256.D0/3.D0*t151*s4l1)*t18+(t45+1280.D0/3.D0*t62+1280*
     #t5)*t9-256.D0/3.D0*t162*s2l1+256.D0/3.D0*t167*s4l1)*s1l2+((t58-256
     #.D0/3.D0*t3)*s2l1+(-t63+256.D0/3.D0*t5)*s2l2-t52+t54)*t95+(((256*t
     #57-t59)*s2l1+(-256*t62+t64)*s2l2-t125+t126)*t9+(-1024.D0/3.D0*t214
     #+256.D0/3.D0*t217*s4l2)*s2l1+(1024.D0/3.D0*t222-256.D0/3.D0*t217*s
     #4l1)*s2l2+2048.D0/3.D0*t213*t228-2048.D0/3.D0*t213*t231)*t18
      s7 = s8+(t61+t66-t236+t237)*t9+(-512.D0/3.D0*t214+256.D0/3.D0*t243
     #*s4l2)*s2l1+(512.D0/3.D0*t222-256.D0/3.D0*t243*s4l1)*s2l2+512.D0/3
     #.D0*t83*t228-512.D0/3.D0*t83*t231
      s8 = t14
      s6 = s7*s8
      s4 = s5+s6
      s2 = s3+s4
      s3 = s2+((512.D0/3.D0*t3*t259+(-256*t23-256*t3)*t95+(-t97-t33)*t18
     #-t267-t268)*s1l1+(-512.D0/3.D0*t5*t259+(256*t36+256*t5)*t95+(t105+
     #t46)*t18+t278+t279)*s1l2+(256.D0/3.D0*t282-256.D0/3.D0*t284-t77+t7
     #8)*t95+(256*t282-256*t284-t236+t237)*t18+t292-t293-512.D0/3.D0*t51
     #+512.D0/3.D0*t53)*t21
      s1 = s3+((t139+t118)*t259+((t139-t69+t59)*t9+256.D0/3.D0*t303*s2l2
     #+256.D0/3.D0*t308*s4l2)*t95+((-256*t23-t117-t268)*t9-256.D0/3.D0*t
     #318*s2l2+256.D0/3.D0*t322*s4l2)*t18+(-t267-t58-t268)*t9-256.D0/3.D
     #0*t330*s2l2-256.D0/3.D0*t334*s4l2)*s1l1+((-t174-t122)*t259+((-t174
     #+t73-t64)*t9-256.D0/3.D0*t303*s2l1-256.D0/3.D0*t308*s4l1)*t95+((25
     #6*t36+t121+t279)*t9+256.D0/3.D0*t318*s2l1-256.D0/3.D0*t322*s4l1)*t
     #18+(t278+t63+t279)*t9+256.D0/3.D0*t330*s2l1+256.D0/3.D0*t334*s4l1)
     #*s1l2
      taux16 = s1+(t292-t293-1280.D0/3.D0*t51+1280.D0/3.D0*t53)*t95+((t2
     #92-t293-t77+t78)*t9-512.D0/3.D0*t213*t372+512.D0/3.D0*t213*t375-25
     #6.D0/3.D0*t379*t228+256.D0/3.D0*t379*t231)*t18+(512.D0/3.D0*t282-5
     #12.D0/3.D0*t284-512.D0/3.D0*t51+512.D0/3.D0*t53)*t9-512.D0/3.D0*t3
     #90*t372+512.D0/3.D0*t390*t375-256.D0/3.D0*t243*t228+256.D0/3.D0*t2
     #43*t231

CCC Coefficients

      tcoff29 = taux15
      tcoff30 = taux15
      tcoff31 = taux15
      tcoff32 = taux15
      tcoff33 = taux16
      tcoff34 = -taux16
      tcoff35 = taux16
      tcoff36 = -taux16

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet29 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff29)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet30 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t3-t1-t4-t2,-1+z-t3-
     #t1,-1+z-t4-t2,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff30)
      t1 = s23f(z,l1,l2,l3,l4)
      t2 = s13f(z,l1,l2,l3,l4)
      t3 = s24f(z,l1,l2,l3,l4)
      t4 = s14f(z,l1,l2,l3,l4)
      tFjet31 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t3-t1-t4-t2,-1+z-t3-
     #t1,-1+z-t4-t2,1+t3+t4,1+t1+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff31)
      t1 = s24f(z,l1,l2,l3,l4)
      t2 = s14f(z,l1,l2,l3,l4)
      t3 = s23f(z,l1,l2,l3,l4)
      t4 = s13f(z,l1,l2,l3,l4)
      tFjet32 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t3-t1-t4-t2,-1+z-t3-
     #t1,-1+z-t4-t2,1+t3+t4,1+t1+t2,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff32)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet33 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t3-t1-t4-t2,-1+z-t3-
     #t1,-1+z-t4-t2,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff33)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet34 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t3-t1-t4-t2,-1+z-t3-
     #t1,-1+z-t4-t2,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff34)
      t1 = s23f(z,l1,l2,l3,l4)
      t2 = s13f(z,l1,l2,l3,l4)
      t3 = s24f(z,l1,l2,l3,l4)
      t4 = s14f(z,l1,l2,l3,l4)
      tFjet35 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t3-t1-t4-t2,-1+z-t3-
     #t1,-1+z-t4-t2,1+t3+t4,1+t1+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff35)
      t1 = s24f(z,l1,l2,l3,l4)
      t2 = s14f(z,l1,l2,l3,l4)
      t3 = s23f(z,l1,l2,l3,l4)
      t4 = s13f(z,l1,l2,l3,l4)
      tFjet36 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t3-t1-t4-t2,-1+z-t3-
     #t1,-1+z-t4-t2,1+t3+t4,1+t1+t2,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff36)

CCC Sum

      ggrmnum7e2 = tFjet29*tcoff29+tFjet30*tcoff30+tFjet31*tcoff31+tFjet
     #32*tcoff32+tFjet33*tcoff33+tFjet34*tcoff34+tFjet35*tcoff35+tFjet36
     #*tcoff36
      RETURN
      END

      double precision function ggrmnum7e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = 1/t1
      t3 = z*t2
      t4 = s24f(z,l1,l2,l3,l4)
      t5 = t3*t4
      t8 = s23f(z,l1,l2,l3,l4)
      t10 = 64.D0/3.D0*t5
      t11 = 64.D0/3.D0*t3
      t13 = s13f(z,l1,l2,l3,l4)
      t15 = t8**2
      t17 = 64.D0/3.D0*t3*t15
      t21 = s14f(z,l1,l2,l3,l4)
      taux15 = ((-64.D0/3.D0*t5+64.D0/3.D0*t3)*t8+t10+t11)*t13+(t17+128.
     #D0/3.D0*t3*t8+t11)*t21+t17+(64.D0/3.D0*t5-64.D0/3.D0*z*(-2+z)*t2)*
     #t8+t10-64.D0/3.D0*(-1+z)*z*t2
      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = 1/t1
      t3 = t2*s4l2
      t4 = s24f(z,l1,l2,l3,l4)
      t7 = t2*s2l2
      t8 = 512.D0/3.D0*t7
      t9 = 1024.D0/3.D0*t3
      t12 = t2*s4l1
      t15 = t2*s2l1
      t16 = 512.D0/3.D0*t15
      t17 = 1024.D0/3.D0*t12
      t21 = s13f(z,l1,l2,l3,l4)
      t22 = t21**2
      t24 = t8+t9
      t25 = s23f(z,l1,l2,l3,l4)
      t29 = -t16-t17
      t33 = t3*s2l1
      t34 = t12*s2l2
      t36 = 512.D0/3.D0*t33-512.D0/3.D0*t34
      t39 = s14f(z,l1,l2,l3,l4)
      t41 = t25**2
      t46 = 512*t3
      t49 = 1280.D0/3.D0*t7
      t50 = t2*s3l2
      t54 = 2*z
      t56 = (5-t54)*t2
      t60 = (t54-3)*t2
      t69 = 512*t12
      t72 = 1280.D0/3.D0*t15
      t73 = t2*s3l1
      t85 = t50*s2l1
      t86 = t73*s2l2
      t87 = t85-t86
      t88 = 512.D0/3.D0*t87
      t99 = 512.D0/3.D0*t7+512.D0/3.D0*t3
      t103 = 256*t7
      t104 = 512.D0/3.D0*t3
      t108 = -512.D0/3.D0*t15-512.D0/3.D0*t12
      t112 = 256*t15
      t113 = 512.D0/3.D0*t12
      t125 = t41*t25
      t130 = (7-t54)*t2
      t140 = (-8+5*z)*t2
      t149 = -1+z
      t151 = 3*t149*t2
      t154 = t149*t2
      t183 = t3*s3l1
      t184 = t12*s3l2
      t185 = -t183+t184
      s2 = ((1024.D0/3.D0*t3*t4+t8+t9)*s1l1+(-1024.D0/3.D0*t12*t4-t16-t1
     #7)*s1l2)*t22+(((t24*t25+t8+t9)*s1l1+(t29*t25-t16-t17)*s1l2+t36*t25
     #)*t39+(512.D0/3.D0*t7*t41+(t24*t4+1792.D0/3.D0*t7+t46)*t25+(t49+51
     #2.D0/3.D0*t50+t46)*t4+256.D0/3.D0*t56*s2l2-512.D0/3.D0*t60*s4l2)*s
     #1l1+(-512.D0/3.D0*t15*t41+(t29*t4-1792.D0/3.D0*t15-t69)*t25+(-t72-
     #512.D0/3.D0*t73-t69)*t4-256.D0/3.D0*t56*s2l1+512.D0/3.D0*t60*s4l1)
     #*s1l2-t36*t41+(t88*t4+512.D0/3.D0*t33-512.D0/3.D0*t34)*t25+256*t33
     #-256*t34)*t21
      s1 = s2+((t99*t41+(t49+t9)*t25+t103+t104)*s1l1+(t108*t41+(-t72-t17
     #)*t25-t112-t113)*s1l2-t88*t41-1280.D0/3.D0*t87*t25-256*t85+256*t86
     #)*t39+(t99*t125+(512.D0/3.D0*t7*t4+256.D0/3.D0*t130*s2l2+1792.D0/3
     #.D0*t3)*t41+((t49+t104)*t4-256.D0/3.D0*t140*s2l2+256.D0/3.D0*t130*
     #s4l2)*t25+(t103+t104)*t4-256.D0/3.D0*t151*s2l2-512.D0/3.D0*t154*s4
     #l2)*s1l1
      taux16 = s1+(t108*t125+(-512.D0/3.D0*t15*t4-256.D0/3.D0*t130*s2l1-
     #1792.D0/3.D0*t12)*t41+((-t72-t113)*t4+256.D0/3.D0*t140*s2l1-256.D0
     #/3.D0*t130*s4l1)*t25+(-t112-t113)*t4+256.D0/3.D0*t151*s2l1+512.D0/
     #3.D0*t154*s4l1)*s1l2+512.D0/3.D0*t185*t41+1280.D0/3.D0*t185*t25-25
     #6*t183+256*t184

CCC Coefficients

      tcoff29 = taux15
      tcoff30 = taux15
      tcoff31 = taux15
      tcoff32 = taux15
      tcoff33 = taux16
      tcoff34 = -taux16
      tcoff35 = taux16
      tcoff36 = -taux16

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet29 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff29)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet30 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff30)
      t1 = s23f(z,l1,l2,l3,l4)
      t2 = s13f(z,l1,l2,l3,l4)
      t3 = s24f(z,l1,l2,l3,l4)
      t4 = s14f(z,l1,l2,l3,l4)
      tFjet31 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff31)
      t1 = s24f(z,l1,l2,l3,l4)
      t2 = s14f(z,l1,l2,l3,l4)
      t3 = s23f(z,l1,l2,l3,l4)
      t4 = s13f(z,l1,l2,l3,l4)
      tFjet32 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff32)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet33 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff33)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet34 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff34)
      t1 = s23f(z,l1,l2,l3,l4)
      t2 = s13f(z,l1,l2,l3,l4)
      t3 = s24f(z,l1,l2,l3,l4)
      t4 = s14f(z,l1,l2,l3,l4)
      tFjet35 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff35)
      t1 = s24f(z,l1,l2,l3,l4)
      t2 = s14f(z,l1,l2,l3,l4)
      t3 = s23f(z,l1,l2,l3,l4)
      t4 = s13f(z,l1,l2,l3,l4)
      tFjet36 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff36)

CCC Sum

      ggrmnum7e3 = tFjet29*tcoff29+tFjet30*tcoff30+tFjet31*tcoff31+tFjet
     #32*tcoff32+tFjet33*tcoff33+tFjet34*tcoff34+tFjet35*tcoff35+tFjet36
     #*tcoff36
      RETURN
      END

      double precision function ggrmnum7e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,l4,
     & l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux15 = 0
      t1 = s4vf(z,l1,l2,l3,l4)
      t2 = 1/t1
      t3 = t2*s2l2
      t4 = s23f(z,l1,l2,l3,l4)
      t5 = t3*t4
      t6 = s24f(z,l1,l2,l3,l4)
      t7 = t3*t6
      t11 = t2*s2l1
      t12 = t11*t4
      t13 = t11*t6
      t17 = s4l2*t2
      t20 = s4l1*t2
      t24 = s13f(z,l1,l2,l3,l4)
      t33 = t2*s3l2*s2l1
      t35 = t2*s3l1*s2l2
      t42 = s14f(z,l1,l2,l3,l4)
      t46 = t4**2
      t49 = (-2+z)*t2
      t56 = (-1+z)*t2
      t73 = t17*s3l1
      t74 = t20*s3l2
      taux16 = ((512.D0/3.D0*t5+512.D0/3.D0*t7+512.D0/3.D0*t3)*s1l1+(-51
     #2.D0/3.D0*t12-512.D0/3.D0*t13-512.D0/3.D0*t11)*s1l2+512.D0/3.D0*t1
     #7*s2l1-512.D0/3.D0*t20*s2l2)*t24+((512.D0/3.D0*t5+512.D0/3.D0*t3)*
     #s1l1+(-512.D0/3.D0*t12-512.D0/3.D0*t11)*s1l2+(-512.D0/3.D0*t33+512
     #.D0/3.D0*t35)*t4-512.D0/3.D0*t33+512.D0/3.D0*t35)*t42+((512.D0/3.D
     #0*t3+512.D0/3.D0*t17)*t46+(512.D0/3.D0*t7-512.D0/3.D0*t49*s2l2+512
     #.D0/3.D0*t17)*t4+512.D0/3.D0*t7-512.D0/3.D0*t56*s2l2)*s1l1+((-512.
     #D0/3.D0*t11-512.D0/3.D0*t20)*t46+(-512.D0/3.D0*t13+512.D0/3.D0*t49
     #*s2l1-512.D0/3.D0*t20)*t4-512.D0/3.D0*t13+512.D0/3.D0*t56*s2l1)*s1
     #l2+(-512.D0/3.D0*t73+512.D0/3.D0*t74)*t4-512.D0/3.D0*t73+512.D0/3.
     #D0*t74

CCC Coefficients

      tcoff29 = taux15
      tcoff30 = taux15
      tcoff31 = taux15
      tcoff32 = taux15
      tcoff33 = taux16
      tcoff34 = -taux16
      tcoff35 = taux16
      tcoff36 = -taux16

CCC Jet functions

      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet29 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff29)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet30 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff30)
      t1 = s23f(z,l1,l2,l3,l4)
      t2 = s13f(z,l1,l2,l3,l4)
      t3 = s24f(z,l1,l2,l3,l4)
      t4 = s14f(z,l1,l2,l3,l4)
      tFjet31 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,4.D0,1.D0,1.D0,Tcoeff*tcoff31)
      t1 = s24f(z,l1,l2,l3,l4)
      t2 = s14f(z,l1,l2,l3,l4)
      t3 = s23f(z,l1,l2,l3,l4)
      t4 = s13f(z,l1,l2,l3,l4)
      tFjet32 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,4.D0,1.D0,1.D0,Tcoeff*tcoff32)
      t1 = s13f(z,l1,l2,l3,l4)
      t2 = s23f(z,l1,l2,l3,l4)
      t3 = s14f(z,l1,l2,l3,l4)
      t4 = s24f(z,l1,l2,l3,l4)
      tFjet33 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff33)
      t1 = s14f(z,l1,l2,l3,l4)
      t2 = s24f(z,l1,l2,l3,l4)
      t3 = s13f(z,l1,l2,l3,l4)
      t4 = s23f(z,l1,l2,l3,l4)
      tFjet34 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s1l1,s2l1,s4l1,s3l1,s1l2,s2l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff34)
      t1 = s23f(z,l1,l2,l3,l4)
      t2 = s13f(z,l1,l2,l3,l4)
      t3 = s24f(z,l1,l2,l3,l4)
      t4 = s14f(z,l1,l2,l3,l4)
      tFjet35 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,s
     #4l2,8.D0,1.D0,1.D0,Tcoeff*tcoff35)
      t1 = s24f(z,l1,l2,l3,l4)
      t2 = s14f(z,l1,l2,l3,l4)
      t3 = s23f(z,l1,l2,l3,l4)
      t4 = s13f(z,l1,l2,l3,l4)
      tFjet36 = Fjet(var,ndim,z,ux,t1,t2,t3,t4,-1+z-t1-t3-t2-t4,-1+z-t1-
     #t3,-1+z-t2-t4,1+t3+t4,1+t1+t2,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s
     #3l2,8.D0,1.D0,1.D0,Tcoeff*tcoff36)

CCC Sum

      ggrmnum7e4 = tFjet29*tcoff29+tFjet30*tcoff30+tFjet31*tcoff31+tFjet
     #32*tcoff32+tFjet33*tcoff33+tFjet34*tcoff34+tFjet35*tcoff35+tFjet36
     #*tcoff36
      RETURN
      END

