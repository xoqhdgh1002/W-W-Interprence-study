CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCC Numerator functions CCCCCCCCCCCCCCCCCCCCCCCCCC

      double precision function ACnum1e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = l3-1
      t3 = t2**2
      t4 = t1*t3
      t5 = 1/s3vr
      t6 = t5*s2l2
      t8 = 128.D0/3.D0*t4*t6
      t9 = t1**2
      t10 = t9*t3
      t11 = t5*s3l2p
      t12 = t10*t11
      t13 = 64.D0/3.D0*t12
      t15 = s1vr**2
      t17 = s4l2p*t5
      t18 = t10*t17
      t22 = t3*t2
      t23 = t9*t22
      t24 = t5*s34r
      t25 = t24*s2l2
      t26 = t23*t25
      t28 = t9*t1
      t29 = t28*t22
      t30 = t11*s34r
      t37 = t5*s2l1
      t39 = 128.D0/3.D0*t4*t37
      t40 = t5*s3l1p
      t41 = t10*t40
      t42 = 64.D0/3.D0*t41
      t45 = s4l1p*t5
      t46 = t10*t45
      t50 = t24*s2l1
      t53 = t40*s34r
      t60 = l3*z
      t62 = t3*t5
      t74 = t28*t3
      t75 = t74*t11
      t77 = t74*t17
      t81 = t45*s3l2p
      t82 = t74*t81
      t93 = t22*t5
      t102 = s4l2p*s4l1p*t5
      t123 = t9**2
      t124 = t123*t22
      t138 = s13r**2
      t140 = t2*t1
      t145 = l3*t9
      t146 = t145*t3
      t153 = l3*t2
      t154 = t1*t5
      t156 = t153*t154*s2l2
      t158 = t2*t5
      t159 = t158*s3l2p
      t160 = t145*t159
      t163 = t2*s4l2p*t5
      t164 = t145*t163
      t168 = t62*s34r
      t169 = t145*t168
      t171 = z*t2
      t174 = -256.D0/3.D0*t169-64.D0/3.D0*t171*t5
      t176 = t74*l3
      t177 = t176*t30
      t185 = s23r**2
      t189 = 128*t169+128.D0/3.D0*t158
      t192 = -2+z
      t193 = t192*t2
      t194 = t154*s3l2p
      t198 = t1*s4l2p*t5
      t200 = 64.D0/3.D0*t171*t198
      t203 = l3*t28
      t204 = t203*t22
      t205 = s34r**2
      t206 = t5*t205
      t210 = l3*t123
      t211 = t210*t22
      t212 = t11*t205
      t219 = -128.D0/3.D0*t169+128.D0/3.D0*t140*t5
      t221 = l3*t5
      t222 = t221*s3l2p
      t223 = t74*t222
      t224 = l3*s4l2p
      t225 = t224*t5
      t226 = t74*t225
      t230 = t9*t2
      t233 = t230*t17
      t240 = t153*t154*s2l1
      t242 = t158*s3l1p
      t243 = t145*t242
      t246 = t2*s4l1p*t5
      t247 = t145*t246
      t252 = t176*t53
      t263 = t154*s3l1p
      t267 = t1*s4l1p*t5
      t269 = 64.D0/3.D0*t171*t267
      t275 = t40*t205
      t281 = t221*s3l1p
      t282 = t74*t281
      t283 = l3*s4l1p
      t284 = t283*t5
      t285 = t74*t284
      t297 = l3**2
      t298 = z*t297
      t299 = t298*t9
      t303 = t145*t2
      t304 = t11*s2l1
      t307 = t40*s2l2
      t311 = t15*s1vr
      t317 = 64.D0/3.D0*t160+64.D0/3.D0*t164
      t320 = 64.D0/3.D0*t243+64.D0/3.D0*t247
      t323 = t298*t28*t168
      t325 = t2*t28
      t326 = t325*l3
      t327 = t11*s3l1p
      t330 = t224*s4l1p
      t331 = t325*t330
      t333 = -t1
      t334 = 2*t333
      t335 = t334*t2
      t336 = z*t1
      t337 = t336*l3
      t350 = (-4+5*z)*t1
      t363 = t62*s3l2p
      t364 = t210*t363
      t367 = t3*s4l2p*t5
      t368 = t210*t367
      t373 = t210*t3*t81
      t374 = 128.D0/3.D0*t373
      t377 = z*t9
      t378 = t377*t2
      t405 = 128.D0/3.D0*t226
      t413 = 128.D0/3.D0*t285
      t421 = t93*t205
      t431 = z**2
      t456 = t93*s3l2p
      t460 = t22*s4l2p*t5
      t465 = t377*t3
      t483 = t123*t1
      t484 = l3*t483
      t498 = s3l1p*s34r
      t506 = t297*t1
      t510 = t2*t297
      t511 = t510*t9
      t517 = t9*t5
      t519 = t510*t517*s34r
      t520 = 256.D0/3.D0*t519
      t521 = l3*t1
      t522 = t521*t5
      t527 = t28*t5
      t528 = t527*t205
      t529 = t3*t297*t528
      t530 = 256.D0/3.D0*t529
      t531 = t158*s34r
      t532 = t521*t531
      t540 = t297*t9
      t541 = t15**2
      t545 = t540*t11
      t546 = 128.D0/3.D0*t545
      t547 = t540*t17
      t548 = 64.D0/3.D0*t547
      t551 = t511*t25
      t553 = t510*t28
      t554 = t553*t30
      t556 = t192*t1
      t561 = t506*t6
      t567 = 64.D0/3.D0*t519+64.D0/3.D0*t60*t5
      t569 = t527*s3l2p
      t570 = t510*t569
      t572 = -t2
      t574 = 2*t572*t297
      t576 = t28*s4l2p*t5
      t581 = -3+z
      t589 = -t192
      t591 = t589*l3*t1
      t596 = t171*l3
      t598 = t517*s3l2p*s34r
      t601 = 64.D0/3.D0*t194
      t606 = t185*s23r
      t608 = -1-z
      t612 = -t520+64.D0/3.D0*t608*l3*t5
      t617 = 3*z
      t618 = 1-t617
      t627 = z*t5
      t629 = -128.D0/3.D0*t529-64.D0/3.D0*t337*t531+64.D0/3.D0*t627
      t631 = t297*t123
      t632 = t631*t363
      t633 = t631*t367
      t637 = t193*l3
      t641 = -t608*t1
      t651 = 128.D0/3.D0*t10*t221*t205+64.D0/3.D0*t531
      t660 = 128.D0/3.D0*t519-128.D0/3.D0*t522
      t662 = t28*t297
      t663 = t662*t163
      t674 = 128.D0/3.D0*t529+128.D0/3.D0*t532-128.D0/3.D0*t627
      t679 = t572*l3
      t680 = t517*s3l2p
      t683 = t9*s4l2p*t5
      t699 = t540*t40
      t700 = 128.D0/3.D0*t699
      t701 = t540*t45
      t702 = 64.D0/3.D0*t701
      t707 = t553*t53
      t709 = t192*l3
      t714 = t506*t37
      t719 = t527*s3l1p
      t720 = t510*t719
      t722 = t28*s4l1p
      t739 = t517*t498
      t742 = 64.D0/3.D0*t263
      t759 = t631*t62*s3l1p
      t762 = t631*t3*s4l1p*t5
      t781 = t662*t246
      t795 = t517*s3l1p
      t798 = t9*s4l1p*t5
      t812 = 64.D0/3.D0*t540*t304
      t814 = 64.D0/3.D0*t540*t307
      t815 = t662*t11
      t816 = 128.D0/3.D0*t815
      t818 = 64.D0/3.D0*t662*t17
      t822 = 64.D0/3.D0*t662*t81
      t826 = t297*l3*t5
      t834 = t171*t28
      t837 = 256.D0/3.D0*t834*t826*s34r
      t845 = 128.D0/3.D0*t551
      t846 = 256.D0/3.D0*t570
      t847 = 64.D0/3.D0*t663
      t851 = (-2+t617)*t1
      t856 = 256.D0/3.D0*t720
      t857 = 64.D0/3.D0*t781
      t868 = 128*t2*t123*t297*t5*s3l2p
      t870 = 64.D0/3.D0*t631*t163
      t875 = 64.D0/3.D0*t631*t2*t81
      t878 = t192*t9
      t892 = 4*t333
      t893 = t892*z
      t901 = 2*z
      t902 = -3+t901
      t903 = t902*t1
      t906 = t334*t1
      t926 = 4*z
      t928 = (-t926+6)*t2
      t938 = 1-t901
      t939 = t938*t9
      t957 = t631*t3
      t960 = t928*t9
      t963 = t589*t2*l3
      t969 = -t938*t1
      t1005 = 128.D0/3.D0*t680
      t1006 = t333*t1
      t1008 = 64.D0/3.D0*t1006*t17
      t1041 = t335*l3
      t1083 = (-z+t431)*t1
      t1102 = t892*t3*l3
      t1107 = -t334
      t1108 = t1107*t2
      s3 = (((t8-t13)*t15+((-t8+t13+64.D0/3.D0*t18)*s23r-64.D0/3.D0*t26+
     #64.D0/3.D0*t29*t30)*s1vr)*s1l1+((t39-t42)*t15+((-t39+t42+64.D0/3.D
     #0*t46)*s23r-64.D0/3.D0*t23*t50+64.D0/3.D0*t29*t53)*s1vr)*s1l2+(128
     #.D0/3.D0*t60*t9*t62*s23r+(-64*t12-128.D0/3.D0*t18)*s2l1+(-64*t41-1
     #28.D0/3.D0*t46)*s2l2+(128.D0/3.D0*t75+64.D0/3.D0*t77)*s3l1p+64.D0/
     #3.D0*t82)*t15+(((64.D0/3.D0*t12+64.D0/3.D0*t18)*s2l1+(64.D0/3.D0*t
     #41+64.D0/3.D0*t46)*s2l2-128.D0/3.D0*t60*t28*t93*s34r+(-128.D0/3.D0
     #*t75-128.D0/3.D0*t77)*s3l1p-128.D0/3.D0*t82-128.D0/3.D0*t74*t102)*
     #s23r+(-128.D0/3.D0*t26+(128.D0/3.D0*t29*t11+64.D0/3.D0*t29*t17)*s3
     #4r)*s2l1+(128.D0/3.D0*t29*t40+64.D0/3.D0*t29*t45)*s34r*s2l2+((-128
     #.D0/3.D0*t124*t11-64.D0/3.D0*t124*t17)*s3l1p-64.D0/3.D0*t124*t81)*
     #s34r)*s1vr)*t138
      s6 = ((128.D0/3.D0*t140*l3*t5*s23r*t15-128.D0/3.D0*t146*t24*s23r*s
     #1vr)*s1l2+((-64*t156+128.D0/3.D0*t160-128.D0/3.D0*t164)*s23r+t174*
     #s2l2+128.D0/3.D0*t177)*t15+((256.D0/3.D0*t156-64*t160-64*t164)*t18
     #5+(t189*s2l2-256.D0/3.D0*t177+64.D0/3.D0*t193*t194-t200)*s23r+128.
     #D0/3.D0*t204*t206*s2l2-128.D0/3.D0*t211*t212)*s1vr+(t219*s2l2+(128
     #.D0/3.D0*t223+128.D0/3.D0*t226)*s34r-128.D0/3.D0*t230*t11-128.D0/3
     #.D0*t233)*t185)*s1l1+(((-64*t240+128.D0/3.D0*t243-128.D0/3.D0*t247
     #)*s23r+t174*s2l1+128.D0/3.D0*t252)*t15+((256.D0/3.D0*t240-64*t243-
     #64*t247)*t185+(t189*s2l1-256.D0/3.D0*t252+64.D0/3.D0*t193*t263-t26
     #9)*s23r+128.D0/3.D0*t204*t206*s2l1-128.D0/3.D0*t211*t275)*s1vr+(t2
     #19*s2l1+(128.D0/3.D0*t282+128.D0/3.D0*t285)*s34r-128.D0/3.D0*t230*
     #t40-128.D0/3.D0*t230*t45)*t185)*s1l2
      s7 = s6+(-128.D0/3.D0*t299*t158*s23r+256.D0/3.D0*t303*t304+256.D0/
     #3.D0*t303*t307)*t311
      s8 = s7
      s10 = (-128.D0/3.D0*t299*t158*t185+(t317*s2l1+t320*s2l2-128.D0/3.D
     #0*t323-128.D0/3.D0*t326*t327+(128.D0/3.D0*t331+64.D0/3.D0*t335*t33
     #7)*t5)*s23r+((128.D0/3.D0*t223+256.D0/3.D0*t226)*s34r+64.D0/3.D0*t
     #350*t159+t200)*s2l1+((128.D0/3.D0*t282+256.D0/3.D0*t285)*s34r+64.D
     #0/3.D0*t350*t242+t269)*s2l2+((-256.D0/3.D0*t364-128.D0/3.D0*t368)*
     #s3l1p-t374)*s34r-128.D0/3.D0*t378*t327)*t15
      s13 = (-t317*s2l1-t320*s2l2+256.D0/3.D0*t323+(128.D0/3.D0*t325*t22
     #2+128.D0/3.D0*t325*t225)*s3l1p+128.D0/3.D0*t326*t81+(128.D0/3.D0*t
     #331+128.D0/3.D0*t333*t2*t337)*t5)*t185+((128.D0/3.D0*t146*t25+(-25
     #6.D0/3.D0*t223-t405)*s34r-64.D0/3.D0*t336*t159-t200)*s2l1+((-256.D
     #0/3.D0*t282-t413)*s34r-64.D0/3.D0*t336*t242-t269)*s2l2+256.D0/3.D0
     #*t298*t123*t421+((128*t364+256.D0/3.D0*t368)*s3l1p+256.D0/3.D0*t37
     #3+(128.D0/3.D0*t123*t3*t330+128.D0/3.D0*t431*t3*t145)*t5)*s34r+(12
     #8.D0/3.D0*t377*t159+128.D0/3.D0*t377*t163)*s3l1p+128.D0/3.D0*t378*
     #t81+128.D0/3.D0*t378*t102)*s23r+((256.D0/3.D0*t203*t421+128.D0/3.D
     #0*t336*t168)*s2l2+(-256.D0/3.D0*t210*t456-128.D0/3.D0*t210*t460)*t
     #205-128.D0/3.D0*t465*t30)*s2l1
      s12 = s13+((-256.D0/3.D0*t210*t93*s3l1p-128.D0/3.D0*t210*t22*s4l1p
     #*t5)*t205-128.D0/3.D0*t465*t53)*s2l2+((256.D0/3.D0*t484*t456+128.D
     #0/3.D0*t484*t460)*s3l1p+128.D0/3.D0*t484*t22*t81)*t205+128.D0/3.D0
     #*z*t28*t3*t11*t498
      s13 = s1vr
      s11 = s12*s13
      s9 = s10+s11
      s5 = s8+s9
      s6 = s13r
      s4 = s5*s6
      s2 = s3+s4
      s3 = s2
      s7 = ((-128.D0/3.D0*t506*t5*t185-256.D0/3.D0*t511*t24*s23r)*t15+((
     #t520-128.D0/3.D0*t522)*t185+(t530+128.D0/3.D0*t532)*s23r)*s1vr)*s1
     #l2-64.D0/3.D0*t540*t11*t541+((t546+t548)*s23r+64.D0/3.D0*t551+64.D
     #0/3.D0*t554-64.D0/3.D0*t556*t222)*t311
      s6 = s7+((64.D0/3.D0*t561-t546+t548)*t185+(t567*s2l2+(-64*t570-64.
     #D0/3.D0*t574*t576)*s34r+64.D0/3.D0*t581*t1*t222+64.D0/3.D0*t556*t2
     #25)*s23r-64.D0/3.D0*t591*t158*s34r*s2l2+64.D0/3.D0*t596*t598+t601)
     #*t15+((-128.D0/3.D0*t561+128.D0/3.D0*t545+128.D0/3.D0*t547)*t606+(
     #t612*s2l2+256.D0/3.D0*t554+128.D0/3.D0*t521*t11-64.D0/3.D0*t618*t1
     #*t225)*t185+(t629*s2l2+(128.D0/3.D0*t632-128.D0/3.D0*t633)*t205-64
     #.D0/3.D0*t637*t598-64.D0/3.D0*t641*t11-64.D0/3.D0*t198)*s23r+t651*
     #s2l2-128.D0/3.D0*t176*t212-64.D0/3.D0*t140*t30)*s1vr+(t660*s2l2+(-
     #128.D0/3.D0*t570-128.D0/3.D0*t663)*s34r+128.D0/3.D0*t145*t11+128.D
     #0/3.D0*t145*t17)*t606+(t674*s2l2+(-128.D0/3.D0*t632-128.D0/3.D0*t6
     #33)*t205+(128.D0/3.D0*t679*t680+128.D0/3.D0*t679*t683)*s34r+128.D0
     #/3.D0*t336*t11+128.D0/3.D0*t336*t17)*t185
      s7 = s1l1
      s5 = s6*s7
      s8 = -64.D0/3.D0*t540*t40*t541+((t700+t702)*s23r+64.D0/3.D0*t511*t
     #50+64.D0/3.D0*t707-64.D0/3.D0*t709*t263)*t311+((64.D0/3.D0*t714-t7
     #00+t702)*t185+(t567*s2l1+(-64*t720-64.D0/3.D0*t574*t722*t5)*s34r+6
     #4.D0/3.D0*t581*l3*t263+64.D0/3.D0*t709*t267)*s23r-64.D0/3.D0*t591*
     #t158*s34r*s2l1+64.D0/3.D0*t596*t739+t742)*t15
      s7 = s8+((-128.D0/3.D0*t714+128.D0/3.D0*t699+128.D0/3.D0*t701)*t60
     #6+(t612*s2l1+256.D0/3.D0*t707+128.D0/3.D0*t521*t40-64.D0/3.D0*t618
     #*l3*t267)*t185+(t629*s2l1+(128.D0/3.D0*t759-128.D0/3.D0*t762)*t205
     #-64.D0/3.D0*t637*t739-64.D0/3.D0*t641*t40-64.D0/3.D0*t267)*s23r+t6
     #51*s2l1-128.D0/3.D0*t176*t275-64.D0/3.D0*t140*t53)*s1vr+(t660*s2l1
     #+(-128.D0/3.D0*t720-128.D0/3.D0*t781)*s34r+128.D0/3.D0*t145*t40+12
     #8.D0/3.D0*t145*t45)*t606+(t674*s2l1+(-128.D0/3.D0*t759-128.D0/3.D0
     #*t762)*t205+(128.D0/3.D0*t679*t795+128.D0/3.D0*t679*t798)*s34r+128
     #.D0/3.D0*t336*t40+128.D0/3.D0*t336*t45)*t185
      s8 = s1l2
      s6 = s7*s8
      s4 = s5+s6
      s1 = s3+s4
      s2 = s1+(-t812-t814+(-t816+t818)*s3l1p+t822)*t541
      s3 = s2+(128.D0/3.D0*t377*t826*t185+((-t546+t548)*s2l1+(-t700+t702
     #)*s2l2+t837+(256.D0/3.D0*t815-t818)*s3l1p-t822-128.D0/3.D0*t662*t1
     #02)*s23r+(t845+(-t846-t847)*s34r-64.D0/3.D0*t851*t222)*s2l1+((-t85
     #6-t857)*s34r-64.D0/3.D0*t851*t281)*s2l2+((t868-t870)*s3l1p-t875)*s
     #34r+(-128.D0/3.D0*t878*t222+64.D0/3.D0*t878*t225)*s3l1p+64.D0/3.D0
     #*t878*l3*t81)*t311
      s4 = s3
      s8 = (t812+t814-t837+(-t816-t818)*s3l1p-t822-64.D0/3.D0*t893*t506*
     #t5)*t185+((-t845+(t846-t847)*s34r-64.D0/3.D0*t903*t222-64.D0/3.D0*
     #t906*t225)*s2l1+((t856-t857)*s34r-64.D0/3.D0*t903*t281-64.D0/3.D0*
     #t906*t284)*s2l2-256.D0/3.D0*z*t3*t123*t826*t205+((-t868-t870)*s3l1
     #p-t875-64.D0/3.D0*t928*z*t540*t5)*s34r+(128.D0/3.D0*t902*t9*t222+6
     #4.D0/3.D0*t939*t225)*s3l1p+64.D0/3.D0*t939*l3*t81+128.D0/3.D0*t589
     #*t9*l3*t102)*s23r+((-t530-128.D0/3.D0*t591*t531)*s2l2+256.D0/3.D0*
     #t957*t212+(64.D0/3.D0*t960*t222+64.D0/3.D0*t963*t683)*s34r-64.D0/3
     #.D0*t969*t11)*s2l1+(256.D0/3.D0*t957*t275+(64.D0/3.D0*t960*t281+64
     #.D0/3.D0*t963*t798)*s34r-64.D0/3.D0*t969*t40)*s2l2
      s7 = s8-256.D0/3.D0*t3*t483*t297*t11*s3l1p*t205+((128.D0/3.D0*(t61
     #7-4)*t2*t28*t222-64.D0/3.D0*t834*t225)*s3l1p-64.D0/3.D0*t834*t283*
     #t11)*s34r+(t1005+t1008)*s3l1p+64.D0/3.D0*t1006*t81
      s8 = t15
      s6 = s7*s8
      s9 = (64.D0/3.D0*t145*t304+64.D0/3.D0*t145*t307+64.D0/3.D0*t892*t2
     #*z*t540*t24+(-128.D0/3.D0*t203*t11-64.D0/3.D0*t203*t17)*s3l1p-64.D
     #0/3.D0*t203*t81-64.D0/3.D0*(-2+t926-2*t431)*z*t221)*t185+((-128.D0
     #/3.D0*t303*t25+(-128.D0/3.D0*t1041*t680-64.D0/3.D0*t596*t683)*s34r
     #+t601-t1008)*s2l1+((-128.D0/3.D0*t1041*t795-64.D0/3.D0*t596*t798)*
     #s34r+t742-64.D0/3.D0*t1006*t45)*s2l2+64.D0/3.D0*t893*t3*t662*t206+
     #((-128*t2*t1*l3*t569-64.D0/3.D0*t637*t576)*s3l1p-64.D0/3.D0*t637*t
     #722*t11+(-128.D0/3.D0*t331-128.D0/3.D0*t60*t230)*t5)*s34r+(-t1005-
     #64.D0/3.D0*t1083*t17)*s3l1p-64.D0/3.D0*t1083*t81-128.D0/3.D0*t1006
     #*t102)*s23r+((-256.D0/3.D0*t3*l3*t528-128.D0/3.D0*t140*t24)*s2l2+(
     #-64.D0/3.D0*t1102*t569-t405)*t205+(64.D0/3.D0*t1108*t194-64.D0/3.D
     #0*t140*t17)*s34r)*s2l1
      s8 = s9+((-64.D0/3.D0*t1102*t719-t413)*t205+(64.D0/3.D0*t1108*t263
     #-64.D0/3.D0*t140*t45)*s34r)*s2l2+((-128.D0/3.D0*t1107*t3*l3*t123*t
     #5*s3l2p+128.D0/3.D0*t368)*s3l1p+t374)*t205+((-128.D0/3.D0*t325*t11
     #+64.D0/3.D0*t233)*s3l1p+64.D0/3.D0*t230*t81)*s34r
      s9 = s1vr
      s7 = s8*s9
      s5 = s6+s7
      taux1 = s4+s5
      t1 = 1-z
      t2 = 2*t1
      t3 = l3-1
      t4 = t3**2
      t5 = t2*t4
      t6 = 1/s3vr
      t7 = t6*s2l2
      t9 = -t1
      t10 = t9**2
      t11 = t10*t4
      t12 = t6*s3l2p
      t13 = t11*t12
      t16 = s1vr**2
      t18 = t1*t4
      t21 = 256.D0/3.D0*t13
      t22 = s4l2p*t6
      t23 = t11*t22
      t27 = t4*t3
      t28 = t10*t27
      t29 = t6*s34r
      t30 = t29*s2l2
      t33 = t10*t9
      t34 = t33*t27
      t35 = t12*s34r
      t42 = t6*s2l1
      t44 = t6*s3l1p
      t45 = t11*t44
      t51 = 256.D0/3.D0*t45
      t52 = s4l1p*t6
      t53 = t11*t52
      t57 = t29*s2l1
      t60 = t44*s34r
      t73 = t33*t4
      t74 = t22*s3l1p
      t77 = t52*s3l2p
      t96 = t10**2
      t97 = t96*t27
      t106 = s13r**2
      t108 = l3*t3
      t109 = t9*t6
      t111 = t108*t109*s2l2
      t113 = l3*t10
      t114 = t3*t6
      t115 = t114*s3l2p
      t116 = t113*t115
      t120 = t4*t6
      t122 = t113*t120*s34r
      t124 = z*t3
      t127 = -1024.D0/3.D0*t122-256.D0/3.D0*t124*t6
      t129 = t73*l3
      t138 = t113*t3*s4l2p*t6
      t139 = 256*t138
      t141 = s23r**2
      t144 = -t3
      t145 = 2*t144
      t148 = 512*t122-256.D0/3.D0*t145*t6
      t150 = l3*t6
      t151 = t150*s3l2p
      t152 = t73*t151
      t154 = l3*s4l2p
      t155 = t154*t6
      t156 = t73*t155
      t160 = -2+z
      t161 = t160*t3
      t162 = t109*s3l2p
      t166 = t9*s4l2p*t6
      t168 = 256.D0/3.D0*t124*t166
      t171 = l3*t33
      t172 = t171*t27
      t173 = s34r**2
      t174 = t6*t173
      t178 = l3*t96
      t179 = t178*t27
      t180 = t12*t173
      t188 = -512.D0/3.D0*t122-512.D0/3.D0*t144*t9*t6
      t193 = t10*t3
      t203 = t108*t109*s2l1
      t205 = t114*s3l1p
      t206 = t113*t205
      t220 = t113*t3*s4l1p*t6
      t221 = 256*t220
      t226 = t150*s3l1p
      t227 = t73*t226
      t229 = l3*s4l1p
      t230 = t229*t6
      t231 = t73*t230
      t235 = t109*s3l1p
      t239 = t9*s4l1p*t6
      t241 = 256.D0/3.D0*t124*t239
      t247 = t44*t173
      t271 = t33*t3
      t272 = t271*l3
      t281 = -512.D0/3.D0*t152-1024.D0/3.D0*t156
      t283 = z*t9
      t285 = 256.D0/3.D0*t283*t115
      t290 = 512.D0/3.D0*t227+1024.D0/3.D0*t231
      t293 = 256.D0/3.D0*t283*t205
      t296 = t178*t4
      t300 = 512.D0/3.D0*t296*t74-512.D0/3.D0*t296*t77
      t324 = -t300
      t342 = l3*t96*t9*t27
      t352 = l3**2
      t353 = t352*t10
      t354 = t16**2
      t358 = t353*t12
      t359 = 512.D0/3.D0*t358
      t360 = t353*t22
      t361 = 256.D0/3.D0*t360
      t362 = t359+t361
      t364 = t353*t3
      t368 = t3*t352*t33
      t371 = t160*t9
      t373 = 256.D0/3.D0*t371*t151
      t375 = t16*s1vr
      t377 = t1*t352
      t378 = t377*t7
      t382 = t144*t10
      t383 = t352*t6
      t384 = t383*s34r
      t385 = t382*t384
      t386 = z*l3
      t389 = -256.D0/3.D0*t385+256.D0/3.D0*t386*t6
      t392 = 3*t33*t3
      t393 = t383*s3l2p
      t396 = -t145*t33
      t398 = t352*s4l2p*t6
      t403 = -3+z
      t411 = -t160
      t413 = t411*l3*t9
      t418 = t124*l3
      t419 = t10*t6
      t429 = t141*s23r
      t431 = 4*t144
      t434 = -1-z
      t438 = 256.D0/3.D0*t431*t10*t384+256.D0/3.D0*t434*l3*t6
      t443 = -t431*t33
      t448 = t2*l3
      t451 = t434*t9
      t459 = t4*t352*t33*t6*t173
      t462 = t114*s34r
      t465 = z*t6
      t467 = -512.D0/3.D0*t459-256.D0/3.D0*t386*t9*t462+256.D0/3.D0*t465
      t469 = t352*t96
      t476 = 512.D0/3.D0*t469*t120*s3l2p+512.D0/3.D0*t469*t4*s4l2p*t6
      t478 = t161*t10
      t481 = t144*l3
      t483 = t10*s4l2p*t6
      t484 = t481*t483
      t489 = -t434*t9
      t499 = 512.D0/3.D0*t11*t150*t173+256.D0/3.D0*t462
      t503 = t9*t3
      t511 = -512.D0/3.D0*t385+512.D0/3.D0*t1*l3*t6
      t513 = t144*t33
      t514 = t513*t393
      t515 = t513*t398
      t529 = 512.D0/3.D0*t459-512.D0/3.D0*t1*t3*t150*s34r-512.D0/3.D0*t4
     #65
      t533 = t419*s3l2p
      t549 = t353*t44
      t550 = 512.D0/3.D0*t549
      t551 = t353*t52
      t552 = 256.D0/3.D0*t551
      t553 = -t550-t552
      t559 = t160*l3
      t561 = 256.D0/3.D0*t559*t235
      t564 = t377*t42
      t570 = t383*s3l1p
      t573 = t352*s4l1p*t6
      t621 = -512.D0/3.D0*t469*t120*s3l1p-512.D0/3.D0*t469*t4*s4l1p*t6
      t626 = t10*s4l1p*t6
      t627 = t481*t626
      t646 = t513*t570
      t647 = t513*t573
      t661 = t419*s3l1p
      t674 = t12*s2l1
      t676 = t44*s2l2
      t678 = t33*t352
      t679 = t678*t74
      t680 = t678*t77
      t682 = -256.D0/3.D0*t353*t674+256.D0/3.D0*t353*t676-256.D0/3.D0*t6
     #79+256.D0/3.D0*t680
      t692 = -512.D0/3.D0*t514-256.D0/3.D0*t515
      t698 = 512.D0/3.D0*t646+256.D0/3.D0*t647
      t702 = t469*t3
      t709 = t160*t10*l3
      t721 = (-3+2*z)*t9
      t724 = -t2
      t725 = t724*t9
      t739 = t144*t96*t352
      t752 = t724*t3*t10
      t758 = t1*t6
      t760 = 256.D0/3.D0*t758*s3l2p
      t769 = 256.D0/3.D0*t758*s3l1p
      t772 = t124*t33
      t778 = 256.D0/3.D0*t772*t154*t44-256.D0/3.D0*t772*t229*t12
      t780 = t1*t9
      t795 = t2*t3*l3
      t798 = t411*t3*l3
      t816 = z*t10
      s3 = (((-256.D0/3.D0*t5*t7-256.D0/3.D0*t13)*t16+((512.D0/3.D0*t18*
     #t7+t21+256.D0/3.D0*t23)*s23r-256.D0/3.D0*t28*t30+256.D0/3.D0*t34*t
     #35)*s1vr)*s1l1+((256.D0/3.D0*t5*t42+256.D0/3.D0*t45)*t16+((-512.D0
     #/3.D0*t18*t42-t51-256.D0/3.D0*t53)*s23r+256.D0/3.D0*t28*t57-256.D0
     #/3.D0*t34*t60)*s1vr)*s1l2+((t21+512.D0/3.D0*t23)*s2l1+(-t51-512.D0
     #/3.D0*t53)*s2l2-256.D0/3.D0*t73*t74+256.D0/3.D0*t73*t77)*t16+(((-2
     #56.D0/3.D0*t13-256.D0/3.D0*t23)*s2l1+(256.D0/3.D0*t45+256.D0/3.D0*
     #t53)*s2l2)*s23r-256.D0/3.D0*t34*s4l2p*t57+256.D0/3.D0*t34*s4l1p*t3
     #0+(256.D0/3.D0*t97*t74-256.D0/3.D0*t97*t77)*s34r)*s1vr)*t106
      s6 = (((-256*t111+512.D0/3.D0*t116)*s23r+t127*s2l2+512.D0/3.D0*t12
     #9*t35)*t16+((1024.D0/3.D0*t111-256*t116-t139)*t141+(t148*s2l2+(-10
     #24.D0/3.D0*t152-512.D0/3.D0*t156)*s34r+256.D0/3.D0*t161*t162-t168)
     #*s23r+512.D0/3.D0*t172*t174*s2l2-512.D0/3.D0*t179*t180)*s1vr+(t188
     #*s2l2+(512.D0/3.D0*t152+512.D0/3.D0*t156)*s34r-512.D0/3.D0*t193*t1
     #2-512.D0/3.D0*t193*t22)*t141)*s1l1+(((256*t203-512.D0/3.D0*t206)*s
     #23r-t127*s2l1-512.D0/3.D0*t129*t60)*t16+((-1024.D0/3.D0*t203+256*t
     #206+t221)*t141+(-t148*s2l1+(1024.D0/3.D0*t227+512.D0/3.D0*t231)*s3
     #4r-256.D0/3.D0*t161*t235+t241)*s23r-512.D0/3.D0*t172*t174*s2l1+512
     #.D0/3.D0*t179*t247)*s1vr+(-t188*s2l1+(-512.D0/3.D0*t227-512.D0/3.D
     #0*t231)*s34r+512.D0/3.D0*t193*t44+512.D0/3.D0*t193*t52)*t141)*s1l2
      s5 = s6+(((-256.D0/3.D0*t116-t139)*s2l1+(256.D0/3.D0*t206+t221)*s2
     #l2+512.D0/3.D0*t272*t74-512.D0/3.D0*t272*t77)*s23r+(t281*s34r-t285
     #-t168)*s2l1+(t290*s34r+t293+t241)*s2l2+t300*s34r)*t16+(((256.D0/3.
     #D0*t116+256.D0/3.D0*t138)*s2l1+(-256.D0/3.D0*t206-256.D0/3.D0*t220
     #)*s2l2)*t141+((-t281*s34r+t285-256.D0/3.D0*t161*t166)*s2l1+(-t290*
     #s34r-t293+256.D0/3.D0*t161*t239)*s2l2+t324*s34r+512.D0/3.D0*t271*t
     #74-512.D0/3.D0*t271*t77)*s23r+512.D0/3.D0*t179*t22*t173*s2l1-512.D
     #0/3.D0*t179*t52*t173*s2l2+(-512.D0/3.D0*t342*t74+512.D0/3.D0*t342*
     #t77)*t173)*s1vr
      s6 = s13r
      s4 = s5*s6
      s2 = s3+s4
      s3 = s2
      s7 = -256.D0/3.D0*t353*t12*t354+(t362*s23r+256.D0/3.D0*t364*t30+25
     #6.D0/3.D0*t368*t35-t373)*t375+((-256.D0/3.D0*t378-t359-t361)*t141+
     #(t389*s2l2+(-256.D0/3.D0*t392*t393-256.D0/3.D0*t396*t398)*s34r+256
     #.D0/3.D0*t403*t9*t151+256.D0/3.D0*t371*t155)*s23r-256.D0/3.D0*t413
     #*t114*s34r*s2l2+256.D0/3.D0*t418*t419*s3l2p*s34r+256.D0/3.D0*t162)
     #*t16
      s6 = s7+((512.D0/3.D0*t378+512.D0/3.D0*t358+512.D0/3.D0*t360)*t429
     #+(t438*s2l2+(512.D0/3.D0*t396*t393+256.D0/3.D0*t443*t398)*s34r-256
     #.D0/3.D0*t448*t12-256.D0/3.D0*t451*t155)*t141+(t467*s2l2+t476*t173
     #+(-256.D0/3.D0*t478*t151-512.D0/3.D0*t484)*s34r-256.D0/3.D0*t489*t
     #12-256.D0/3.D0*t166)*s23r+t499*s2l2-512.D0/3.D0*t129*t180-256.D0/3
     #.D0*t503*t35)*s1vr+(t511*s2l2+(512.D0/3.D0*t514+512.D0/3.D0*t515)*
     #s34r+512.D0/3.D0*t113*t12+512.D0/3.D0*t113*t22)*t429+(t529*s2l2-t4
     #76*t173+(512.D0/3.D0*t481*t533+512.D0/3.D0*t484)*s34r+512.D0/3.D0*
     #t283*t12+512.D0/3.D0*t283*t22)*t141
      s7 = s1l1
      s5 = s6*s7
      s8 = 256.D0/3.D0*t353*t44*t354+(t553*s23r-256.D0/3.D0*t364*t57-256
     #.D0/3.D0*t368*t60+t561)*t375+((256.D0/3.D0*t564+t550+t552)*t141+(-
     #t389*s2l1+(256.D0/3.D0*t392*t570+256.D0/3.D0*t396*t573)*s34r-256.D
     #0/3.D0*t403*l3*t235-256.D0/3.D0*t559*t239)*s23r+256.D0/3.D0*t413*t
     #114*s34r*s2l1-256.D0/3.D0*t418*t419*s3l1p*s34r-256.D0/3.D0*t235)*t
     #16
      s7 = s8+((-512.D0/3.D0*t564-512.D0/3.D0*t549-512.D0/3.D0*t551)*t42
     #9+(-t438*s2l1+(-512.D0/3.D0*t396*t570-256.D0/3.D0*t443*t573)*s34r+
     #256.D0/3.D0*t448*t44+256.D0/3.D0*t451*t230)*t141+(-t467*s2l1+t621*
     #t173+(256.D0/3.D0*t478*t226+512.D0/3.D0*t627)*s34r+256.D0/3.D0*t48
     #9*t44+256.D0/3.D0*t239)*s23r-t499*s2l1+512.D0/3.D0*t129*t247+256.D
     #0/3.D0*t503*t60)*s1vr+(-t511*s2l1+(-512.D0/3.D0*t646-512.D0/3.D0*t
     #647)*s34r-512.D0/3.D0*t113*t44-512.D0/3.D0*t113*t52)*t429+(-t529*s
     #2l1-t621*t173+(-512.D0/3.D0*t481*t661-512.D0/3.D0*t627)*s34r-512.D
     #0/3.D0*t283*t44-512.D0/3.D0*t283*t52)*t141
      s8 = s1l2
      s6 = s7*s8
      s4 = s5+s6
      s1 = s3+s4
      s2 = s1+t682*t354
      s3 = s2+((t362*s2l1+t553*s2l2+256.D0/3.D0*t679-256.D0/3.D0*t680)*s
     #23r+(t692*s34r-t373)*s2l1+(t698*s34r+t561)*s2l2+(256.D0/3.D0*t702*
     #t74-256.D0/3.D0*t702*t77)*s34r-256.D0/3.D0*t709*t74+256.D0/3.D0*t7
     #09*t77)*t375
      s4 = s3
      s6 = (t682*t141+((-t692*s34r+256.D0/3.D0*t721*t151+256.D0/3.D0*t72
     #5*t155)*s2l1+(-t698*s34r-256.D0/3.D0*t721*t226-256.D0/3.D0*t725*t2
     #30)*s2l2+(256.D0/3.D0*t739*t74-256.D0/3.D0*t739*t77)*s34r-256.D0/3
     #.D0*t113*t74+256.D0/3.D0*t113*t77)*s23r+((256.D0/3.D0*t752*t151+25
     #6.D0/3.D0*t478*t155)*s34r-t760)*s2l1+((-256.D0/3.D0*t752*t226-256.
     #D0/3.D0*t478*t230)*s34r+t769)*s2l2+t778*s34r-256.D0/3.D0*t780*t74+
     #256.D0/3.D0*t780*t77)*t16
      s7 = ((-256.D0/3.D0*t113*t674+256.D0/3.D0*t113*t676-256.D0/3.D0*t1
     #71*t74+256.D0/3.D0*t171*t77)*t141+(((256.D0/3.D0*t795*t533+256.D0/
     #3.D0*t798*t483)*s34r+t760+256.D0/3.D0*t483)*s2l1+((-256.D0/3.D0*t7
     #95*t661-256.D0/3.D0*t798*t626)*s34r-t769-256.D0/3.D0*t626)*s2l2-t7
     #78*s34r-256.D0/3.D0*t816*t74+256.D0/3.D0*t816*t77)*s23r+(512.D0/3.
     #D0*t129*t22*t173+256.D0/3.D0*t503*t22*s34r)*s2l1+(-512.D0/3.D0*t12
     #9*t52*t173-256.D0/3.D0*t503*t52*s34r)*s2l2+t324*t173+(256.D0/3.D0*
     #t382*t74-256.D0/3.D0*t382*t77)*s34r)*s1vr
      s5 = s6+s7
      taux2 = s4+s5

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = -taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet2 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet4 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      ACnum1e0 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcoff4
      RETURN
      END

      double precision function ACnum1e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = t1**2
      t3 = z*t2
      t4 = l3-1
      t5 = t4**2
      t6 = t5*t4
      t7 = 1/s3vr
      t8 = t6*t7
      t9 = s1vr**2
      t12 = t2*t1
      t14 = t5**2
      t16 = t7*s34r
      t21 = s13r**2
      t24 = t1*t5
      t25 = t7*s2l2
      t26 = t24*t25
      t27 = t2*t5
      t28 = t7*s3l2p
      t29 = t27*t28
      t33 = 128.D0/3.D0*t26
      t34 = 64.D0/3.D0*t29
      t35 = s4l2p*t7
      t36 = t27*t35
      t40 = t2*t6
      t41 = t16*s2l2
      t42 = t40*t41
      t44 = t12*t6
      t45 = t28*s34r
      t52 = t7*s2l1
      t53 = t24*t52
      t54 = t7*s3l1p
      t55 = t27*t54
      t60 = 64.D0/3.D0*t55
      t61 = s4l1p*t7
      t62 = t27*t61
      t66 = t16*s2l1
      t69 = t54*s34r
      t76 = l3*z
      t77 = t76*t2
      t78 = t5*t7
      t79 = t9*s1vr
      t94 = t76*t12*t8*s34r
      t96 = t12*t5
      t97 = t96*t28
      t99 = t96*t35
      t103 = t61*s3l2p
      t104 = t96*t103
      t106 = t1*z
      t107 = t106*t78
      t119 = 128.D0/3.D0*t97+128.D0/3.D0*t99
      t122 = s4l2p*s4l1p
      t125 = 3*z
      t127 = (1-t125)*z
      t135 = t35*s34r
      t143 = t2**2
      t144 = t143*t6
      t145 = t144*t28
      t147 = t144*t35
      t161 = l3*t2
      t162 = t161*t5
      t166 = t16*s23r
      t168 = l3*t7
      t169 = s34r**2
      t170 = t168*t169
      t171 = t44*t170
      t177 = t4*t7
      t178 = t177*s3l2p
      t179 = t161*t178
      t180 = 128.D0/3.D0*t179
      t182 = t4*s4l2p*t7
      t183 = t161*t182
      t184 = 64.D0/3.D0*t183
      t187 = l3*t4
      t188 = t1*t7
      t190 = t187*t188*s2l2
      t195 = t78*s34r
      t196 = t161*t195
      t198 = z*t4
      t200 = 64.D0/3.D0*t198*t7
      t201 = 64*t196+t200
      t203 = t168*s3l2p
      t204 = t96*t203
      t206 = l3*s4l2p
      t207 = t206*t7
      t208 = t96*t207
      t209 = 128.D0/3.D0*t208
      t212 = t1*t4
      t215 = t2*t4
      t216 = t215*t35
      t221 = 64*t179
      t222 = 64*t183
      t224 = s23r**2
      t227 = 1+z
      t231 = -192*t196-64.D0/3.D0*t227*t4*t7
      t237 = 2-z
      t238 = t237*t4
      t239 = t188*s3l2p
      t243 = t1*s4l2p*t7
      t249 = t27*t16
      t251 = -320.D0/3.D0*t171+64.D0/3.D0*t249
      t253 = l3*t143
      t254 = t8*s3l2p
      t255 = t253*t254
      t258 = t6*s4l2p*t7
      t259 = t253*t258
      t263 = 2*z
      t265 = (3-t263)*t2
      t266 = t78*s3l2p
      t268 = 2-t125
      t269 = t268*t2
      t271 = t5*s4l2p*t7
      t278 = t212*t7
      t280 = 128.D0/3.D0*t196-128.D0/3.D0*t278
      t282 = -t204-t208
      t291 = 128.D0/3.D0*t171-128.D0/3.D0*t249
      t294 = -128.D0/3.D0*t255-128.D0/3.D0*t259
      t299 = t14*t7
      t300 = t169*s34r
      t301 = t299*t300
      t303 = t7*t169
      t306 = 128.D0/3.D0*t253*t301-128.D0/3.D0*t44*t303
      t308 = t14*l3
      t309 = t143*t1
      t310 = t309*t7
      t311 = t310*s3l2p
      t314 = t309*s4l2p*t7
      t324 = t177*s3l1p
      t325 = t161*t324
      t326 = 128.D0/3.D0*t325
      t328 = t4*s4l1p*t7
      t329 = t161*t328
      t330 = 64.D0/3.D0*t329
      t334 = t187*t188*s2l1
      t340 = t168*s3l1p
      t341 = t96*t340
      t343 = l3*s4l1p
      t344 = t343*t7
      t345 = t96*t344
      t346 = 128.D0/3.D0*t345
      t351 = t215*t61
      t356 = 64*t325
      t365 = t188*s3l1p
      t368 = t1*s4l1p
      t369 = t368*t7
      t376 = t253*t8*s3l1p
      t380 = t253*t6*s4l1p*t7
      t384 = t78*s3l1p
      t387 = t5*s4l1p*t7
      t395 = -t341-t345
      t405 = -128.D0/3.D0*t376-128.D0/3.D0*t380
      t415 = t310*s3l1p
      t418 = t309*s4l1p*t7
      t430 = l3**2
      t431 = z*t430
      t432 = t431*t2
      t433 = t9**2
      t445 = t431*t12*t195
      t447 = 4*z
      t448 = -3+t447
      t463 = t325+t329
      t467 = t4*t12
      t468 = t467*l3
      t469 = t28*s3l1p
      t474 = 128.D0/3.D0*t467*t206*s4l1p
      t490 = -1+t263
      t491 = t490*t1
      t494 = 2*t1
      t495 = t494*t1
      t509 = t431*t143
      t511 = t509*t8*t169
      t513 = t253*t266
      t515 = t253*t271
      t520 = t253*t5*t103
      t522 = 6*z
      t531 = -t490
      t535 = -t227
      t536 = t535*t2
      t546 = t490*z
      t547 = t546*t4
      t560 = t467*t207
      t565 = 128.D0/3.D0*t468*t103
      t566 = z**2
      t567 = t566*t4
      t568 = t1*l3
      t579 = t96*l3
      t582 = t448*t1
      t589 = t61*s34r
      t604 = t27*t7
      t609 = -t494
      t610 = t609*t4
      t611 = t2*t7
      t612 = t611*s3l2p
      t614 = t2*s4l2p
      t615 = t614*t7
      t638 = t253*t6
      t643 = t490*t2
      t663 = l3*t309
      t673 = z+2
      t684 = -t1
      t685 = t684*t12
      t698 = l3*t566
      t707 = t430*t4
      t708 = t707*t2
      t714 = t5*t430
      t715 = t12*t7
      t716 = t715*t169
      t717 = t714*t716
      t718 = 128.D0/3.D0*t717
      t721 = t491*t4*t168*s34r
      t733 = t78*t169
      t740 = t430*t2
      t749 = t707*t12
      t752 = t106*t203
      t756 = t430*t1
      t757 = t756*t25
      t759 = t740*t28
      t761 = t740*t35
      t766 = t707*t611*s34r
      t768 = t76*t7
      t770 = -128*t766-64.D0/3.D0*t768
      t772 = t715*s3l2p
      t773 = t707*t772
      t775 = -t4
      t777 = 5*t775*t430
      t779 = t12*s4l2p*t7
      t793 = t177*s34r
      t796 = -t718+64.D0/3.D0*t268*l3*t1*t793
      t798 = t430*t143
      t799 = t798*t266
      t801 = t798*t271
      t805 = 5*z
      t808 = (-1+t805)*t4*l3
      t811 = t609*l3*t2
      t820 = t224*s23r
      t824 = 192*t766+128.D0/3.D0*t168
      t827 = t12*t430
      t828 = t827*t182
      t832 = 4-t263
      t842 = 1+t447
      t847 = z*t7
      t849 = 192*t717+64.D0/3.D0*t842*l3*t1*t793-64.D0/3.D0*t847
      t858 = t535*t1
      t864 = t430*t7
      t866 = t144*t864*t300
      t873 = 2*t566
      t878 = 128.D0/3.D0*t866+64.D0/3.D0*(t447-2)*t2*t5*t170+64.D0/3.D0*
     #(t263-t873-1)*t4*t16
      t880 = t6*t430
      t881 = t880*t311
      t883 = t880*t314
      t888 = t842*t5*l3
      t892 = (-1-t263)*t5*l3
      t898 = (t125-t873-1)*t4
      t901 = t531*z*t4
      t908 = t568*t7
      t910 = -128.D0/3.D0*t766+128.D0/3.D0*t908
      t915 = t161*t28
      t916 = 128.D0/3.D0*t915
      t917 = t161*t35
      t927 = -256.D0/3.D0*t717-128.D0/3.D0*t237*l3*t1*t793+128.D0/3.D0*t
     #847
      t932 = t238*l3
      t945 = t237*t2
      t952 = -256.D0/3.D0*t866-128.D0/3.D0*t945*t5*t170+128.D0/3.D0*t198
     #*t188*s34r
      t958 = t237*t5*l3
      t972 = t169**2
      t975 = l3*t12
      t976 = t8*t300
      t980 = -128.D0/3.D0*t430*t309*t299*t972-128.D0/3.D0*t975*t976+128.
     #D0/3.D0*t3*t733
      t982 = t14*t430
      t983 = t143*t2
      t984 = t983*t7
      t995 = z*t5
      s2 = (128.D0/3.D0*t708*t16*t79+(-256.D0/3.D0*t708*t166-t718-128.D0
     #/3.D0*t721)*t9+(128.D0/3.D0*t708*t16*t224+(128.D0/3.D0*t717+128.D0
     #/3.D0*t721)*s23r+128.D0/3.D0*t490*l3*t2*t733)*s1vr)*s1l2+64.D0/3.D
     #0*t740*t28*t433+(-256.D0/3.D0*t740*t28*s23r+64.D0/3.D0*t708*t41-32
     #0.D0/3.D0*t749*t45-64.D0/3.D0*t752)*t79
      s1 = s2+((-128.D0/3.D0*t757+320.D0/3.D0*t759+128.D0/3.D0*t761)*t22
     #4+(t770*s2l2+(1024.D0/3.D0*t773-64.D0/3.D0*t777*t779)*s34r+64*t568
     #*t28+64.D0/3.D0*t106*t207)*s23r+t796*s2l2+(512.D0/3.D0*t799+128.D0
     #/3.D0*t801)*t169+(64.D0/3.D0*t808*t612-64.D0/3.D0*t811*t182)*s34r)
     #*t9+((128.D0/3.D0*t757-128.D0/3.D0*t759-128.D0/3.D0*t761)*t820+(t8
     #24*s2l2+(-704.D0/3.D0*t773-448.D0/3.D0*t828)*s34r-64.D0/3.D0*t832*
     #t1*t203-64.D0/3.D0*t227*t1*t207)*t224+(t849*s2l2+(-320*t799-192*t8
     #01)*t169+(-448.D0/3.D0*t179-t222)*s34r-64.D0/3.D0*t858*t28-64.D0/3
     #.D0*t615)*s23r+t878*s2l2+(-128*t881-256.D0/3.D0*t883)*t300+(-64.D0
     #/3.D0*t888*t772+64.D0/3.D0*t892*t779)*t169+(-64.D0/3.D0*t898*t239-
     #64.D0/3.D0*t901*t243)*s34r)*s1vr+(t910*s2l2+(128.D0/3.D0*t773+128.
     #D0/3.D0*t828)*s34r-t916-128.D0/3.D0*t917)*t820
      t1001 = s1+(t927*s2l2+(256.D0/3.D0*t799+256.D0/3.D0*t801)*t169+(12
     #8.D0/3.D0*t932*t612+128.D0/3.D0*t932*t615)*s34r-128.D0/3.D0*t106*t
     #28-128.D0/3.D0*t106*t35)*t224+(t952*s2l2+(256.D0/3.D0*t881+256.D0/
     #3.D0*t883)*t300+(128.D0/3.D0*t958*t772+128.D0/3.D0*t958*t779)*t169
     #+(-128.D0/3.D0*t3*t178-128.D0/3.D0*t3*t182)*s34r)*s23r+t980*s2l2+(
     #128.D0/3.D0*t982*t984*s3l2p+128.D0/3.D0*t982*t983*s4l2p*t7)*t972-t
     #294*t300+(-128.D0/3.D0*t995*t772-128.D0/3.D0*t995*t779)*t169
      t1013 = t76*t365
      t1017 = t756*t52
      t1019 = t740*t54
      t1021 = t740*t61
      t1026 = t715*s3l1p
      t1027 = t707*t1026
      t1030 = t12*s4l1p*t7
      t1042 = t798*t384
      t1044 = t798*t387
      t1048 = t611*s3l1p
      t1086 = t2*s4l1p*t7
      t1097 = t880*t415
      t1099 = t880*t418
      t1121 = 128.D0/3.D0*t161*t54
      t1122 = t161*t61
      s2 = 64.D0/3.D0*t740*t54*t433+(-256.D0/3.D0*t740*t54*s23r+64.D0/3.
     #D0*t708*t66-320.D0/3.D0*t749*t69-64.D0/3.D0*t1013)*t79
      s3 = s2+((-128.D0/3.D0*t1017+320.D0/3.D0*t1019+128.D0/3.D0*t1021)*
     #t224+(t770*s2l1+(1024.D0/3.D0*t1027-64.D0/3.D0*t777*t1030)*s34r+64
     #*t568*t54+64.D0/3.D0*t76*t369)*s23r+t796*s2l1+(512.D0/3.D0*t1042+1
     #28.D0/3.D0*t1044)*t169+(64.D0/3.D0*t808*t1048-64.D0/3.D0*t811*t328
     #)*s34r)*t9
      s1 = s3+((128.D0/3.D0*t1017-128.D0/3.D0*t1019-128.D0/3.D0*t1021)*t
     #820+(t824*s2l1+(-704.D0/3.D0*t1027+448.D0/3.D0*t775*t12*t430*s4l1p
     #*t7)*s34r-64.D0/3.D0*t832*l3*t365-64.D0/3.D0*t227*l3*t369)*t224+(t
     #849*s2l1+(-320*t1042-192*t1044)*t169+(-448.D0/3.D0*t325-64*l3*t4*t
     #1086)*s34r-64.D0/3.D0*t858*t54-64.D0/3.D0*t1086)*s23r+t878*s2l1+(-
     #128*t1097-256.D0/3.D0*t1099)*t300+(-64.D0/3.D0*t888*t1026+64.D0/3.
     #D0*t892*t1030)*t169+(-64.D0/3.D0*t898*t365-64.D0/3.D0*t901*t369)*s
     #34r)*s1vr+(t910*s2l1+(128.D0/3.D0*t1027+128.D0/3.D0*t827*t328)*s34
     #r-t1121-128.D0/3.D0*t1122)*t820
      t1173 = s1+(t927*s2l1+(256.D0/3.D0*t1042+256.D0/3.D0*t1044)*t169+(
     #128.D0/3.D0*t932*t1048+128.D0/3.D0*t932*t1086)*s34r-128.D0/3.D0*t1
     #06*t54-128.D0/3.D0*t106*t61)*t224+(t952*s2l1+(256.D0/3.D0*t1097+25
     #6.D0/3.D0*t1099)*t300+(128.D0/3.D0*t958*t1026+128.D0/3.D0*t958*t10
     #30)*t169+(-128.D0/3.D0*t3*t324-128.D0/3.D0*t3*t328)*s34r)*s23r+t98
     #0*s2l1+(128.D0/3.D0*t982*t984*s3l1p+128.D0/3.D0*t982*t983*s4l1p*t7
     #)*t972-t405*t300+(-128.D0/3.D0*t995*t1026-128.D0/3.D0*t995*t1030)*
     #t169
      t1176 = t430*l3*t7
      t1188 = t1176*s34r
      t1190 = 128.D0/3.D0*t775*z*t12*t1188
      t1191 = t827*t28
      t1192 = 128.D0/3.D0*t1191
      t1194 = 64.D0/3.D0*t827*t35
      t1198 = 64.D0/3.D0*t827*t103
      t1206 = 128.D0/3.D0*t198*t12*t1188
      t1230 = t995*t143*t1176*t169
      t1231 = 128.D0/3.D0*t1230
      t1240 = t798*t4
      t1246 = t740*t7
      t1276 = t756*t7
      t1282 = (-1+t447)*t1
      t1301 = (3-z)*t2
      t1313 = 4*t566
      t1356 = -t673*t4*t12
      t1414 = t161*t4
      t1451 = (-2+t522-t873)*t1
      t1504 = t490*t4
      t1526 = t566*t7
      s2 = (-64.D0/3.D0*t3*t8*t9+64.D0/3.D0*z*t12*t14*t16*s1vr)*t21*s13r
     #+(((-64.D0/3.D0*t26+64.D0/3.D0*t29)*t9+((t33-t34-64.D0/3.D0*t36)*s
     #23r+64.D0/3.D0*t42-64.D0/3.D0*t44*t45)*s1vr)*s1l1+((-64.D0/3.D0*t5
     #3+64.D0/3.D0*t55)*t9+((128.D0/3.D0*t53-t60-64.D0/3.D0*t62)*s23r+64
     #.D0/3.D0*t40*t66-64.D0/3.D0*t44*t69)*s1vr)*s1l2+320.D0/3.D0*t77*t7
     #8*t79+(64.D0/3.D0*t77*t78*s23r+(t33-t34-128.D0/3.D0*t36)*s2l1+(-t6
     #0-128.D0/3.D0*t62)*s2l2-320.D0/3.D0*t94+(-128.D0/3.D0*t97-64.D0/3.
     #D0*t99)*s3l1p-64.D0/3.D0*t104-128.D0/3.D0*t107)*t9+(((-64.D0/3.D0*
     #t29-64.D0/3.D0*t36)*s2l1+(-64.D0/3.D0*t55-64.D0/3.D0*t62)*s2l2-128
     #.D0/3.D0*t94+t119*s3l1p+128.D0/3.D0*t104+(128.D0/3.D0*t96*t122-64.
     #D0/3.D0*t127*t24)*t7)*s23r+(-128.D0/3.D0*t42+64.D0/3.D0*t44*t135)*
     #s2l1+64.D0/3.D0*t44*s4l1p*t41+((128.D0/3.D0*t145+64.D0/3.D0*t147)*
     #s3l1p+64.D0/3.D0*t144*t103+64.D0/3.D0*t3*t8)*s34r)*s1vr)*t21
      s4 = s2
      s8 = ((128.D0/3.D0*t162*t16*t9+(-128.D0/3.D0*t162*t166-128.D0/3.D0
     #*t171)*s1vr)*s1l2+(t180-t184)*t79+((64*t190-320.D0/3.D0*t179-t184)
     #*s23r+t201*s2l2+(-512.D0/3.D0*t204-t209)*s34r-64.D0/3.D0*t212*t28+
     #64.D0/3.D0*t216)*t9+((-256.D0/3.D0*t190+t221+t222)*t224+(t231*s2l2
     #+(192*t204+320.D0/3.D0*t208)*s34r+64.D0/3.D0*t238*t239+64.D0/3.D0*
     #t198*t243)*s23r+t251*s2l2+(512.D0/3.D0*t255+320.D0/3.D0*t259)*t169
     #+(64.D0/3.D0*t265*t266+64.D0/3.D0*t269*t271)*s34r)*s1vr+(t280*s2l2
     #+128.D0/3.D0*t282*s34r+128.D0/3.D0*t215*t28+128.D0/3.D0*t216)*t224
     #+(t291*s2l2+t294*t169+t119*s34r)*s23r+t306*s2l2+(-128.D0/3.D0*t308
     #*t311-128.D0/3.D0*t308*t314)*t300+(128.D0/3.D0*t145+128.D0/3.D0*t1
     #47)*t169)*s1l1
      s9 = ((t326-t330)*t79+((64*t334-320.D0/3.D0*t325-t330)*s23r+t201*s
     #2l1+(-512.D0/3.D0*t341-t346)*s34r-64.D0/3.D0*t212*t54+64.D0/3.D0*t
     #351)*t9+((-256.D0/3.D0*t334+t356+64*t329)*t224+(t231*s2l1+(192*t34
     #1+320.D0/3.D0*t345)*s34r+64.D0/3.D0*t238*t365+64.D0/3.D0*t198*t369
     #)*s23r+t251*s2l1+(512.D0/3.D0*t376+320.D0/3.D0*t380)*t169+(64.D0/3
     #.D0*t265*t384+64.D0/3.D0*t269*t387)*s34r)*s1vr+(t280*s2l1+128.D0/3
     #.D0*t395*s34r+128.D0/3.D0*t215*t54+128.D0/3.D0*t351)*t224+(t291*s2
     #l1+t405*t169+(128.D0/3.D0*t96*t54+128.D0/3.D0*t96*t61)*s34r)*s23r+
     #t306*s2l1+(-128.D0/3.D0*t308*t415-128.D0/3.D0*t308*t418)*t300+(128
     #.D0/3.D0*t144*t54+128.D0/3.D0*t144*t61)*t169)*s1l2-64.D0/3.D0*t432
     #*t177*t433
      s7 = s8+s9
      s8 = s7+(-512.D0/3.D0*t432*t177*s23r+(-t180-t184)*s2l1+(-t326-t330
     #)*s2l2-448.D0/3.D0*t445-64.D0/3.D0*t448*z*l3*t278)*t79
      s9 = s8+(-64.D0/3.D0*t432*t177*t224+((-128.D0/3.D0*t190+256.D0/3.D
     #0*t179+256.D0/3.D0*t183)*s2l1+256.D0/3.D0*t463*s2l2+832.D0/3.D0*t4
     #45+128.D0/3.D0*t468*t469+(-t474+64.D0/3.D0*(9-7*z)*t4*t106*l3)*t7)
     #*s23r+(-256.D0/3.D0*t162*t41+(64.D0/3.D0*t204+t209)*s34r+64.D0/3.D
     #0*t491*t178+64.D0/3.D0*t495*t182)*s2l1+((64.D0/3.D0*t341+t346)*s34
     #r+64.D0/3.D0*t491*t324+64.D0/3.D0*t495*t328)*s2l2+640.D0/3.D0*t511
     #+((128.D0/3.D0*t513+64.D0/3.D0*t515)*s3l1p+64.D0/3.D0*t520+64.D0/3
     #.D0*(4+t522)*t5*z*t161*t7)*s34r+(-128.D0/3.D0*t531*t2*t178-64.D0/3
     #.D0*t536*t182)*s3l1p-64.D0/3.D0*t536*t4*t103+(256.D0/3.D0*t215*t12
     #2+64.D0/3.D0*t547)*t7)*t9
      s10 = s9
      s14 = ((64.D0/3.D0*t179+64.D0/3.D0*t183)*s2l1+64.D0/3.D0*t463*s2l2
     #+64.D0/3.D0*t445+(-128.D0/3.D0*t467*t203-128.D0/3.D0*t560)*s3l1p-t
     #565+(-t474-256.D0/3.D0*t567*t568)*t7)*t224+(((256.D0/3.D0*t196-128
     #.D0/3.D0*t278)*s2l2-128.D0/3.D0*t579*t135+64.D0/3.D0*t582*t178+64.
     #D0/3.D0*t582*t182)*s2l1+(-128.D0/3.D0*t579*t589+64.D0/3.D0*t582*t3
     #24+64.D0/3.D0*t582*t328)*s2l2-128.D0/3.D0*t511+((-256.D0/3.D0*t513
     #-128.D0/3.D0*t515)*s3l1p-128.D0/3.D0*t520-256.D0/3.D0*t76*t604)*s3
     #4r+(128.D0/3.D0*t610*t612+128.D0/3.D0*t610*t615)*s3l1p+128.D0/3.D0
     #*t610*t2*t103+(128.D0/3.D0*t610*t614*s4l1p+64.D0/3.D0*(-2*t566-2+2
     #*z)*t4*z)*t7)*s23r+(128.D0/3.D0*t491*t5*t41+64.D0/3.D0*t638*t28*t1
     #69+(-64.D0/3.D0*t3*t266-64.D0/3.D0*t643*t271)*s34r)*s2l1
      s13 = s14+(64.D0/3.D0*t638*t54*t169+(-64.D0/3.D0*t3*t384-64.D0/3.D
     #0*t643*t387)*s34r)*s2l2-128.D0/3.D0*t431*t309*t301+((-128.D0/3.D0*
     #t663*t254-64.D0/3.D0*t663*t258)*s3l1p-64.D0/3.D0*t663*t6*t103-128.
     #D0/3.D0*t673*z*l3*t44*t7)*t169+((128.D0/3.D0*t531*t12*t266+64.D0/3
     #.D0*t685*t271)*s3l1p+64.D0/3.D0*t685*t5*t103-64.D0/3.D0*t107)*s34r
      s14 = s1vr
      s12 = s13*s14
      s13 = (128.D0/3.D0*t698*t2*t195-128.D0/3.D0*t567*t188)*t224
      s11 = s12+s13
      s6 = s10+s11
      s7 = s13r
      s5 = s6*s7
      s3 = s4+s5
      s1 = s3+t1001*s1l1+t1173*s1l2
      s2 = s1+(64.D0/3.D0*t3*t1176*s23r+64.D0/3.D0*t740*t28*s2l1+64.D0/3
     #.D0*t740*t54*s2l2-t1190+(t1192-t1194)*s3l1p-t1198)*t433+(64*t3*t11
     #76*t224+(t1206+(-256.D0/3.D0*t1191+t1194)*s3l1p+t1198+(128.D0/3.D0
     #*t827*t122+64.D0/3.D0*(t805-4)*z*t756)*t7)*s23r+(64.D0/3.D0*t749*t
     #135+64.D0/3.D0*t752)*s2l1+(64.D0/3.D0*t749*t589+64.D0/3.D0*t1013)*
     #s2l2-t1231+((-256.D0/3.D0*t4*t143*t864*s3l2p+64.D0/3.D0*t798*t182)
     #*s3l1p+64.D0/3.D0*t1240*t103+64.D0/3.D0*(t263-7)*t4*z*t1246)*s34r+
     #(-256.D0/3.D0*t915+64.D0/3.D0*t536*t207)*s3l1p+64.D0/3.D0*t536*l3*
     #t103)*t79
      s4 = s2
      s7 = 64.D0/3.D0*t3*t1176*t820+((-128.D0/3.D0*t759-64.D0/3.D0*t761)
     #*s2l1+(-128.D0/3.D0*t1019-64.D0/3.D0*t1021)*s2l2-t1206+(t1192+t119
     #4)*s3l1p+t1198-320.D0/3.D0*t684*z*t1276)*t224+((-64.D0/3.D0*t1282*
     #t203-64.D0/3.D0*t491*t207)*s2l1+(-64.D0/3.D0*t1282*t340-64.D0/3.D0
     #*t491*t344)*s2l2-256.D0/3.D0*t1230+(256.D0/3.D0*t1240*t469-64.D0/3
     #.D0*t901*t1246)*s34r+(128.D0/3.D0*t1301*t203+64*t3*t207)*s3l1p+64*
     #t77*t103+(128.D0/3.D0*t975*t122-64.D0/3.D0*(-4+9*z-t1313)*z*l3)*t7
     #)*s23r+((128.D0/3.D0*t717-128.D0/3.D0*t161*t793)*s2l2+(-t221+64.D0
     #/3.D0*t560)*s34r+64.D0/3.D0*t239)*s2l1
      s6 = s7+((-t356+64.D0/3.D0*t467*t344)*s34r+64.D0/3.D0*t365)*s2l2+(
     #128.D0/3.D0*t5*t309*t430*t469+64.D0/3.D0*t832*t5*z*t827*t7)*t169+(
     #(128.D0/3.D0*t238*t12*t203-64.D0/3.D0*t1356*t207)*s3l1p-64.D0/3.D0
     #*t1356*t343*t28-64.D0/3.D0*(-5+t263)*t1*t4*t768)*s34r+(128.D0/3.D0
     #*(t263-t566)*t1*t28+64.D0/3.D0*t243)*s3l1p+64.D0/3.D0*t368*t28
      s7 = t9
      s5 = s6*s7
      s3 = s4+s5
      s5 = s3
      s8 = (t1190-64.D0/3.D0*t127*t1276)*t820+((-t916-64.D0/3.D0*t917)*s
     #2l1+(-t1121-64.D0/3.D0*t1122)*s2l2-t1231+64.D0/3.D0*t901*t740*t16+
     #(-128.D0/3.D0*t945*t203-64.D0/3.D0*t1301*t207)*s3l1p-64.D0/3.D0*t1
     #301*l3*t103+(-128.D0/3.D0*t161*t122-64.D0/3.D0*(t447-2-t1313)*z*l3
     #)*t7)*t224+((128.D0/3.D0*t1414*t45-64.D0/3.D0*t1282*t28-64.D0/3.D0
     #*t491*t35)*s2l1+(128.D0/3.D0*t1414*t69-64.D0/3.D0*t1282*t54-64.D0/
     #3.D0*t491*t61)*s2l2+256.D0/3.D0*t684*z*t5*t827*t303+((-128.D0/3.D0
     #*t610*l3*t772-128.D0/3.D0*t560)*s3l1p-t565-128.D0/3.D0*t547*t908)*
     #s34r+(-128.D0/3.D0*(t125-1-t566)*t1*t28-64.D0/3.D0*t1451*t35)*s3l1
     #p-64.D0/3.D0*t1451*t103+(-128.D0/3.D0*t491*t122-64.D0/3.D0*t546)*t
     #7)*s23r+((128.D0/3.D0*t5*l3*t716-128.D0/3.D0*t215*t16)*s2l2-64.D0/
     #3.D0*t282*t169+(64.D0/3.D0*t106*t178-64.D0/3.D0*t216)*s34r)*s2l1
      s7 = s8+(-64.D0/3.D0*t395*t169+(64.D0/3.D0*t106*t324-64.D0/3.D0*t3
     #51)*s34r)*s2l2+128.D0/3.D0*t509*t976+(128.D0/3.D0*t995*l3*t143*t7*
     #s3l2p*s3l1p-128.D0/3.D0*t698*t604)*t169+((-128.D0/3.D0*(-1+t263-t5
     #66)*t4*t612-64.D0/3.D0*t1504*t615)*s3l1p-64.D0/3.D0*t1504*t2*t103-
     #t200)*s34r
      s8 = s1vr
      s6 = s7*s8
      s4 = s5+s6
      taux1 = s4+(128.D0/3.D0*t775*t566*t2*t864*s34r+128.D0/3.D0*t566*t1
     #*t168)*t820+(-128.D0/3.D0*t714*t12*t1526*t169+128.D0/3.D0*t684*t4*
     #l3*t1526*s34r+128.D0/3.D0*t566*z*t7)*t224
      t1 = -1+z
      t3 = l3-1
      t4 = t3**2
      t5 = 7*t1*t4
      t6 = 1/s3vr
      t7 = t6*s2l2
      t10 = t1**2
      t11 = t10*t4
      t12 = t6*s3l2p
      t13 = t11*t12
      t14 = 1024.D0/3.D0*t13
      t16 = s1vr**2
      t18 = 4*t1
      t19 = t18*t4
      t22 = s4l2p*t6
      t23 = t11*t22
      t27 = t4*t3
      t28 = t10*t27
      t29 = t6*s34r
      t30 = t29*s2l2
      t33 = t10*t1
      t34 = t33*t27
      t35 = t12*s34r
      t42 = t6*s2l1
      t45 = t6*s3l1p
      t46 = t11*t45
      t47 = 1024.D0/3.D0*t46
      t52 = s4l1p*t6
      t53 = t11*t52
      t57 = t29*s2l1
      t60 = t45*s34r
      t73 = t33*t4
      t74 = t22*s3l1p
      t77 = t52*s3l2p
      t104 = t10**2
      t105 = t104*t27
      t114 = s13r**2
      t116 = l3*t3
      t117 = t1*t6
      t119 = t116*t117*s2l2
      t120 = l3*t10
      t123 = t120*t3*s4l2p*t6
      t126 = t16*s1vr
      t129 = t3*t6
      t131 = t120*t129*s3l2p
      t135 = t4*t6
      t137 = t120*t135*s34r
      t139 = z*t3
      t142 = 1024*t137+1024.D0/3.D0*t139*t6
      t144 = l3*t6
      t145 = t144*s3l2p
      t146 = t73*t145
      t149 = l3*s4l2p*t6
      t150 = t73*t149
      t154 = t1*t3
      t157 = t10*t3
      t158 = t157*t22
      t166 = s23r**2
      t173 = -5888.D0/3.D0*t137-256.D0/3.D0*(7+z)*t3*t6
      t179 = 4*z
      t180 = 8-t179
      t181 = t180*t3
      t182 = t117*s3l2p
      t186 = t1*s4l2p*t6
      t188 = 1024.D0/3.D0*t139*t186
      t191 = s34r**2
      t192 = t144*t191
      t193 = t34*t192
      t195 = t11*t29
      t197 = -2816.D0/3.D0*t193+256.D0/3.D0*t195
      t199 = l3*t104
      t200 = t27*t6
      t202 = t199*t200*s3l2p
      t206 = t199*t27*s4l2p*t6
      t210 = 2*z
      t211 = 3-t210
      t212 = t211*t10
      t213 = t135*s3l2p
      t215 = 3*z
      t217 = (2-t215)*t10
      t219 = t4*s4l2p*t6
      t227 = 4*t3
      t231 = 2048.D0/3.D0*t137-512.D0/3.D0*t227*t1*t6
      t242 = 512.D0/3.D0*t193-512.D0/3.D0*t195
      t245 = -512.D0/3.D0*t202-512.D0/3.D0*t206
      t254 = t4**2
      t255 = t254*t6
      t256 = t191*s34r
      t262 = 512.D0/3.D0*t199*t255*t256-512.D0/3.D0*t34*t6*t191
      t264 = t254*l3
      t265 = t104*t1
      t266 = t265*t6
      t267 = t266*s3l2p
      t270 = t265*s4l2p*t6
      t283 = t116*t117*s2l1
      t285 = t3*s4l1p*t6
      t286 = t120*t285
      t291 = t129*s3l1p
      t292 = t120*t291
      t298 = t144*s3l1p
      t299 = t73*t298
      t302 = l3*s4l1p*t6
      t303 = t73*t302
      t309 = t157*t52
      t324 = t117*s3l1p
      t328 = t1*s4l1p*t6
      t330 = 1024.D0/3.D0*t139*t328
      t336 = t199*t200*s3l1p
      t340 = t199*t27*s4l1p*t6
      t344 = t135*s3l1p
      t347 = t4*s4l1p*t6
      t367 = 512.D0/3.D0*t336+512.D0/3.D0*t340
      t378 = t266*s3l1p
      t381 = t265*s4l1p*t6
      t393 = 2*t3
      t394 = t393*t10
      t413 = t33*t3
      t414 = t413*l3
      t421 = 256.D0/3.D0*t146
      t422 = 2816.D0/3.D0*t150
      t425 = 6*z
      t426 = -t425+2
      t427 = t426*t3
      t432 = 256.D0/3.D0*t299
      t433 = 2816.D0/3.D0*t303
      t440 = t199*t4
      t443 = -t440*t74+t440*t77
      t446 = -1-z
      t448 = t446*t10*t3
      t467 = -t426*t3
      t471 = (5-z)*t3
      t485 = -t443
      t498 = -4+t215
      t499 = t498*t10
      t501 = -1+t210
      t502 = t501*t10
      t521 = l3*t265*t27
      t528 = t446*t33*t4
      t538 = l3**2
      t539 = t538*t10
      t540 = t16**2
      t544 = -t1
      t545 = t544*t538
      t548 = t539*t12
      t550 = t539*t22
      t551 = 512.D0/3.D0*t550
      t554 = -t3
      t557 = 6*t554*t10*t538
      t560 = t227*t33
      t561 = t560*t538
      t565 = -t498*t1
      t570 = t18*t538
      t571 = t570*t7
      t574 = 256.D0/3.D0*t550
      t577 = t3*t538
      t578 = t10*t6
      t581 = 5*z
      t586 = -256.D0/3.D0*t577*t578*s34r-256.D0/3.D0*(-1+t581)*l3*t6
      t588 = 5*t554
      t589 = t588*t33
      t590 = t538*t6
      t591 = t590*s3l2p
      t593 = t588*t538
      t594 = t33*s4l2p
      t595 = t594*t6
      t601 = 6*t1*l3
      t605 = (6-t581)*t1
      t611 = t33*t6
      t613 = t4*t538*t611*t191
      t618 = t144*s34r
      t621 = 256*t613-256.D0/3.D0*(-8+t581)*t1*t3*t618
      t623 = t538*t104
      t624 = t623*t213
      t626 = t623*t219
      t632 = (-4-z)*t3*t10
      t635 = z*t10
      t636 = t635*t3
      t641 = 3*t544
      t642 = t641*t6
      t651 = t166*s23r
      t655 = t590*s34r
      t657 = -t446
      t658 = 4*t657
      t662 = 4096.D0/3.D0*t10*t3*t655+256.D0/3.D0*t658*l3*t6
      t665 = 8*t554*t33
      t669 = 13*t554*t33
      t671 = t538*s4l2p*t6
      t677 = (t210+6)*t1
      t682 = (1+7*z)*t1
      t693 = z*t6
      t695 = 1024*t613+512.D0/3.D0*t657*t1*t3*t618-1024.D0/3.D0*t693
      t703 = (9-t210)*t3*t10
      t706 = 3*t3
      t713 = -t658*t1
      t716 = -4+z
      t717 = t716*t1
      t724 = 1024.D0/3.D0*t105*t590*t256
      t730 = z**2
      t731 = 2*t730
      t736 = t724+256.D0/3.D0*(-6+t210)*t10*t4*t192+256.D0/3.D0*(t210-t7
     #31-4)*t3*t29
      t738 = t27*t538
      t742 = -1024.D0/3.D0*t738*t267-1024.D0/3.D0*t738*t270
      t746 = (-5+t210)*t4*l3
      t747 = t611*s3l2p
      t751 = (-1-t210)*t4*l3
      t757 = (t215-t731-4)*t3
      t761 = -t501*z*t3
      t773 = -512.D0/3.D0*t227*t10*t655+512.D0/3.D0*t18*l3*t6
      t776 = t560*t671
      t780 = t120*t12
      t782 = t120*t22
      t791 = -2560.D0/3.D0*t613-512.D0/3.D0*t471*t1*t618+2048.D0/3.D0*t6
     #93
      t796 = t471*t10
      t802 = z*t1
      t809 = 2-z
      t817 = -t724-512.D0/3.D0*t809*t10*t4*t192+512.D0/3.D0*t139*t117*s3
     #4r
      t822 = t809*t4*l3
      t828 = t554*z
      t829 = t578*s3l2p
      t832 = t10*s4l2p*t6
      t840 = t191**2
      t843 = l3*t33
      t849 = -512.D0/3.D0*t538*t265*t255*t840-512.D0/3.D0*t843*t200*t256
     #+512.D0/3.D0*t635*t135*t191
      t851 = t254*t538
      t852 = t104*t10
      t853 = t852*t6
      t864 = z*t4
      s2 = 256.D0/3.D0*t539*t12*t540+((256.D0/3.D0*t545*t7-512.D0/3.D0*t
     #548-t551)*s23r+256.D0/3.D0*t557*t30+256.D0/3.D0*t561*t35-256.D0/3.
     #D0*t565*t145)*t126
      s3 = s2+((-256.D0/3.D0*t571+512*t548+t574)*t166+(t586*s2l2+(-256.D
     #0/3.D0*t589*t591-256.D0/3.D0*t593*t595)*s34r+256.D0/3.D0*t601*t12+
     #256.D0/3.D0*t605*t149)*s23r+t621*s2l2+(-256*t624+512.D0/3.D0*t626)
     #*t191+(256.D0/3.D0*t632*t145+512.D0/3.D0*t636*t149)*s34r+256.D0/3.
     #D0*t642*s3l2p)*t16
      s1 = s3+((512.D0/3.D0*t571-2048.D0/3.D0*t548-2048.D0/3.D0*t550)*t6
     #51+(t662*s2l2+(512.D0/3.D0*t665*t591+256.D0/3.D0*t669*t671)*s34r-2
     #56.D0/3.D0*t677*t145-256.D0/3.D0*t682*t149)*t166+(t695*s2l2+(-1024
     #*t624-768*t626)*t191+(-256.D0/3.D0*t703*t145-512.D0/3.D0*t706*t10*
     #t149)*s34r-256.D0/3.D0*t713*t12-256.D0/3.D0*t717*t22)*s23r+t736*s2
     #l2+t742*t256+(-256.D0/3.D0*t746*t747+256.D0/3.D0*t751*t595)*t191+(
     #-256.D0/3.D0*t757*t182-256.D0/3.D0*t761*t186)*s34r)*s1vr+(t773*s2l
     #2+(512.D0/3.D0*t560*t591+512.D0/3.D0*t776)*s34r-2048.D0/3.D0*t780-
     #2048.D0/3.D0*t782)*t651
      t870 = s1+(t791*s2l2+(2560.D0/3.D0*t624+2560.D0/3.D0*t626)*t191+(5
     #12.D0/3.D0*t796*t145+512.D0/3.D0*t796*t149)*s34r-2048.D0/3.D0*t802
     #*t12-2048.D0/3.D0*t802*t22)*t166+(t817*s2l2-t742*t256+(512.D0/3.D0
     #*t822*t747+512.D0/3.D0*t822*t595)*t191+(512.D0/3.D0*t828*t829+512.
     #D0/3.D0*t828*t832)*s34r)*s23r+t849*s2l2+(512.D0/3.D0*t851*t853*s3l
     #2p+512.D0/3.D0*t851*t852*s4l2p*t6)*t840-t245*t256+(-512.D0/3.D0*t8
     #64*t747-512.D0/3.D0*t864*t595)*t191
      t877 = t539*t45
      t879 = t539*t52
      t880 = 512.D0/3.D0*t879
      t891 = t570*t42
      t894 = 256.D0/3.D0*t879
      t899 = t590*s3l1p
      t901 = t33*s4l1p
      t902 = t901*t6
      t915 = t623*t344
      t917 = t623*t347
      t941 = t538*s4l1p*t6
      t962 = t10*s4l1p*t6
      t978 = 1024.D0/3.D0*t738*t378+1024.D0/3.D0*t738*t381
      t980 = t611*s3l1p
      t996 = t560*t941
      t1000 = t120*t45
      t1002 = t120*t52
      s2 = -256.D0/3.D0*t539*t45*t540+((-256.D0/3.D0*t545*t42+512.D0/3.D
     #0*t877+t880)*s23r-256.D0/3.D0*t557*t57-256.D0/3.D0*t561*t60+256.D0
     #/3.D0*t565*t298)*t126
      s3 = s2+((256.D0/3.D0*t891-512*t877-t894)*t166+(-t586*s2l1+(256.D0
     #/3.D0*t589*t899+256.D0/3.D0*t593*t902)*s34r-256.D0/3.D0*t601*t45-2
     #56.D0/3.D0*t605*t302)*s23r-t621*s2l1+(256*t915-512.D0/3.D0*t917)*t
     #191+(-256.D0/3.D0*t632*t298-512.D0/3.D0*t636*t302)*s34r-256.D0/3.D
     #0*t642*s3l1p)*t16
      s1 = s3+((-512.D0/3.D0*t891+2048.D0/3.D0*t877+2048.D0/3.D0*t879)*t
     #651+(-t662*s2l1+(-512.D0/3.D0*t665*t899-256.D0/3.D0*t669*t941)*s34
     #r+256.D0/3.D0*t677*t298+256.D0/3.D0*t682*t302)*t166+(-t695*s2l1+(1
     #024*t915+768*t917)*t191+(256.D0/3.D0*t703*t298+512.D0/3.D0*t706*l3
     #*t962)*s34r+256.D0/3.D0*t713*t45+256.D0/3.D0*t717*t52)*s23r-t736*s
     #2l1+t978*t256+(256.D0/3.D0*t746*t980-256.D0/3.D0*t751*t902)*t191+(
     #256.D0/3.D0*t757*t324+256.D0/3.D0*t761*t328)*s34r)*s1vr+(-t773*s2l
     #1+(-512.D0/3.D0*t560*t899-512.D0/3.D0*t996)*s34r+2048.D0/3.D0*t100
     #0+2048.D0/3.D0*t1002)*t651
      t1055 = s1+(-t791*s2l1+(-2560.D0/3.D0*t915-2560.D0/3.D0*t917)*t191
     #+(-512.D0/3.D0*t796*t298-512.D0/3.D0*t796*t302)*s34r+2048.D0/3.D0*
     #t802*t45+2048.D0/3.D0*t802*t52)*t166+(-t817*s2l1-t978*t256+(-512.D
     #0/3.D0*t822*t980-512.D0/3.D0*t822*t902)*t191+(512.D0/3.D0*t635*t29
     #1+512.D0/3.D0*t635*t285)*s34r)*s23r-t849*s2l1+(-512.D0/3.D0*t851*t
     #853*s3l1p-512.D0/3.D0*t851*t852*s4l1p*t6)*t840-t367*t256+(512.D0/3
     #.D0*t864*t980+512.D0/3.D0*t864*t902)*t191
      t1063 = t33*t538
      t1064 = t1063*t74
      t1065 = 1024.D0/3.D0*t1064
      t1066 = t1063*t77
      t1067 = 1024.D0/3.D0*t1066
      t1084 = -t716*t1
      t1100 = -t227*t104*t538
      t1107 = t180*t10*l3
      t1124 = t706*t33
      t1127 = t393*t33
      t1133 = (7-t179)*t1
      t1137 = (5-t425)*t1
      t1155 = t393*t104*t538
      t1167 = t211*t3
      t1168 = t1167*l3
      t1172 = (5-t179)*t3*l3
      t1178 = -t641*t6
      t1180 = 256.D0/3.D0*t1178*s3l2p
      t1183 = t578*s3l1p
      t1190 = 256.D0/3.D0*t1178*s3l1p
      t1193 = 3-t179
      t1195 = t1193*t3*l3
      t1196 = t594*t45
      t1198 = t901*t12
      t1203 = t210-4
      t1204 = t1203*t1
      t1227 = (-8+t425)*t3*l3
      t1230 = t1203*t3*t10
      t1235 = t1193*t1
      t1251 = -t211*t3*l3
      t1258 = (-1-t179)*t10
      t1269 = (1-t215)*t3
      t1272 = (-3+z)*t3
      t1291 = t1167*t10
      s3 = (((-256.D0/3.D0*t5*t7+t14)*t16+((512.D0/3.D0*t19*t7-t14-1024.
     #D0/3.D0*t23)*s23r+1024.D0/3.D0*t28*t30-1024.D0/3.D0*t34*t35)*s1vr)
     #*s1l1+((256.D0/3.D0*t5*t42-t47)*t16+((-512.D0/3.D0*t19*t42+t47+102
     #4.D0/3.D0*t53)*s23r-1024.D0/3.D0*t28*t57+1024.D0/3.D0*t34*t60)*s1v
     #r)*s1l2+((-t14-1792.D0/3.D0*t23)*s2l1+(t47+1792.D0/3.D0*t53)*s2l2+
     #256*t73*t74-256*t73*t77)*t16+(((1024.D0/3.D0*t13+1024.D0/3.D0*t23)
     #*s2l1+(-1024.D0/3.D0*t46-1024.D0/3.D0*t53)*s2l2)*s23r+(256.D0/3.D0
     #*t34*t12+256*t34*t22)*s34r*s2l1+(-256.D0/3.D0*t34*t45-256*t34*t52)
     #*s34r*s2l2+(-256*t105*t74+256*t105*t77)*s34r)*s1vr)*t114
      s7 = ((256.D0/3.D0*t119+256.D0/3.D0*t123)*t126+((2816.D0/3.D0*t119
     #-768*t131)*s23r+t142*s2l2+(-2560.D0/3.D0*t146-1024.D0/3.D0*t150)*s
     #34r-256.D0/3.D0*t154*t12+256.D0/3.D0*t158)*t16+((-4096.D0/3.D0*t11
     #9+1024*t131+1024*t123)*t166+(t173*s2l2+(1536*t146+2048.D0/3.D0*t15
     #0)*s34r+256.D0/3.D0*t181*t182+t188)*s23r+t197*s2l2+(1024*t202+1280
     #.D0/3.D0*t206)*t191+(256.D0/3.D0*t212*t213+256.D0/3.D0*t217*t219)*
     #s34r)*s1vr+(t231*s2l2+(-2048.D0/3.D0*t146-2048.D0/3.D0*t150)*s34r+
     #2048.D0/3.D0*t157*t12+2048.D0/3.D0*t158)*t166+(t242*s2l2+t245*t191
     #+(512.D0/3.D0*t73*t12+512.D0/3.D0*t73*t22)*s34r)*s23r+t262*s2l2+(-
     #512.D0/3.D0*t264*t267-512.D0/3.D0*t264*t270)*t256+(512.D0/3.D0*t10
     #5*t12+512.D0/3.D0*t105*t22)*t191)*s1l1
      s8 = ((-256.D0/3.D0*t283-256.D0/3.D0*t286)*t126+((-2816.D0/3.D0*t2
     #83+768*t292)*s23r-t142*s2l1+(2560.D0/3.D0*t299+1024.D0/3.D0*t303)*
     #s34r+256.D0/3.D0*t154*t45-256.D0/3.D0*t309)*t16+((4096.D0/3.D0*t28
     #3-1024*t292-1024*t286)*t166+(-t173*s2l1+(-1536*t299-2048.D0/3.D0*t
     #303)*s34r-256.D0/3.D0*t181*t324-t330)*s23r-t197*s2l1+(-1024*t336-1
     #280.D0/3.D0*t340)*t191+(-256.D0/3.D0*t212*t344-256.D0/3.D0*t217*t3
     #47)*s34r)*s1vr+(-t231*s2l1+(2048.D0/3.D0*t299+2048.D0/3.D0*t303)*s
     #34r-2048.D0/3.D0*t157*t45-2048.D0/3.D0*t309)*t166+(-t242*s2l1+t367
     #*t191+(-512.D0/3.D0*t73*t45-512.D0/3.D0*t73*t52)*s34r)*s23r-t262*s
     #2l1+(512.D0/3.D0*t264*t378+512.D0/3.D0*t264*t381)*t256+(-512.D0/3.
     #D0*t105*t45-512.D0/3.D0*t105*t52)*t191)*s1l2
      s6 = s7+s8
      s7 = s6+((256.D0/3.D0*t394*t145+256.D0/3.D0*t123)*s2l1+(-256.D0/3.
     #D0*t394*t298-256.D0/3.D0*t286)*s2l2)*t126
      s8 = s7
      s10 = (((512.D0/3.D0*t131+768*t123)*s2l1+(-512.D0/3.D0*t292-768*t2
     #86)*s2l2-512*t414*t74+512*t414*t77)*s23r+((t421+t422)*s34r-256.D0/
     #3.D0*t427*t182+t188)*s2l1+((-t432-t433)*s34r+256.D0/3.D0*t427*t324
     #-t330)*s2l2+1280.D0/3.D0*t443*s34r+256.D0/3.D0*t448*t74-256.D0/3.D
     #0*t448*t77)*t16
      s11 = (((-1024.D0/3.D0*t131-1024.D0/3.D0*t123)*s2l1+(1024.D0/3.D0*
     #t292+1024.D0/3.D0*t286)*s2l2)*t166+(((-512*t146-t422)*s34r-256.D0/
     #3.D0*t467*t182-256.D0/3.D0*t471*t186)*s2l1+((512*t299+t433)*s34r+2
     #56.D0/3.D0*t467*t324+256.D0/3.D0*t471*t328)*s2l2+512*t485*s34r-512
     #*t413*t74+512*t413*t77)*s23r+((256.D0/3.D0*t202-1024.D0/3.D0*t206)
     #*t191+(-256.D0/3.D0*t499*t213-256.D0/3.D0*t502*t219)*s34r)*s2l1+((
     #-256.D0/3.D0*t336+1024.D0/3.D0*t340)*t191+(256.D0/3.D0*t499*t344+2
     #56.D0/3.D0*t502*t347)*s34r)*s2l2+(1280.D0/3.D0*t521*t74-1280.D0/3.
     #D0*t521*t77)*t191+(-256.D0/3.D0*t528*t74+256.D0/3.D0*t528*t77)*s34
     #r)*s1vr
      s9 = s10+s11
      s5 = s8+s9
      s6 = s13r
      s4 = s5*s6
      s2 = s3+s4
      s1 = s2+t870*s1l1+t1055*s1l2
      s2 = s1+(256.D0/3.D0*t539*t12*s2l1-256.D0/3.D0*t539*t45*s2l2+t1065
     #-t1067)*t540
      s3 = s2+(((-1024.D0/3.D0*t548-t551)*s2l1+(1024.D0/3.D0*t877+t880)*
     #s2l2-t1065+t1067)*s23r+((-512.D0/3.D0*t577*t747-256.D0/3.D0*t776)*
     #s34r-256.D0/3.D0*t1084*t145)*s2l1+((512.D0/3.D0*t577*t980+256.D0/3
     #.D0*t996)*s34r+256.D0/3.D0*t1084*t298)*s2l2+(256.D0/3.D0*t1100*t74
     #-256.D0/3.D0*t1100*t77)*s34r-256.D0/3.D0*t1107*t74+256.D0/3.D0*t11
     #07*t77)*t126
      s4 = s3
      s6 = (((256*t548-t574)*s2l1+(-256*t877+t894)*s2l2+256*t1064-256*t1
     #066)*t166+(((512.D0/3.D0*t1124*t591+256.D0/3.D0*t1127*t671)*s34r+2
     #56.D0/3.D0*t1133*t145+256.D0/3.D0*t1137*t149)*s2l1+((-512.D0/3.D0*
     #t1124*t899-256.D0/3.D0*t1127*t941)*s34r-256.D0/3.D0*t1133*t298-256
     #.D0/3.D0*t1137*t302)*s2l2+(256.D0/3.D0*t1155*t74-256.D0/3.D0*t1155
     #*t77)*s34r+1280.D0/3.D0*t120*t74-1280.D0/3.D0*t120*t77)*s23r+((256
     #.D0/3.D0*t1168*t829+256.D0/3.D0*t1172*t832)*s34r-t1180)*s2l1+((-25
     #6.D0/3.D0*t1168*t1183-256.D0/3.D0*t1172*t962)*s34r+t1190)*s2l2+(25
     #6.D0/3.D0*t1195*t1196-256.D0/3.D0*t1195*t1198)*s34r-256.D0/3.D0*t1
     #204*t74+256.D0/3.D0*t1204*t77)*t16
      s7 = (((256*t780-256.D0/3.D0*t782)*s2l1+(-256*t1000+256.D0/3.D0*t1
     #002)*s2l2+256*t843*t74-256*t843*t77)*t166+(((256.D0/3.D0*t1227*t82
     #9+256.D0/3.D0*t1230*t149)*s34r+t1180+256.D0/3.D0*t1235*t22)*s2l1+(
     #(-256.D0/3.D0*t1227*t1183-256.D0/3.D0*t1230*t302)*s34r-t1190-256.D
     #0/3.D0*t1235*t52)*s2l2+(256.D0/3.D0*t1251*t1196-256.D0/3.D0*t1251*
     #t1198)*s34r-256.D0/3.D0*t1258*t74+256.D0/3.D0*t1258*t77)*s23r+((-t
     #421-1280.D0/3.D0*t150)*t191+(256.D0/3.D0*t1269*t182+256.D0/3.D0*t1
     #272*t186)*s34r)*s2l1+((t432+1280.D0/3.D0*t303)*t191+(-256.D0/3.D0*
     #t1269*t324-256.D0/3.D0*t1272*t328)*s34r)*s2l2+1024.D0/3.D0*t485*t1
     #91+(256.D0/3.D0*t1291*t74-256.D0/3.D0*t1291*t77)*s34r)*s1vr
      s5 = s6+s7
      taux2 = s4+s5

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = -taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet2 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet4 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      ACnum1e1 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcoff4
      RETURN
      END

      double precision function ACnum1e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = -1+z
      t2 = t1**2
      t3 = z*t2
      t4 = l3-1
      t5 = t4**2
      t6 = t5*t4
      t7 = 1/s3vr
      t8 = t6*t7
      t9 = s1vr**2
      t12 = t2*t1
      t14 = t5**2
      t16 = t7*s34r
      t21 = s13r**2
      t24 = l3*z
      t25 = t24*t2
      t26 = t5*t7
      t27 = t9*s1vr
      t34 = t2*t5
      t35 = t7*s3l2p
      t37 = s4l2p*t7
      t42 = t7*s3l1p
      t44 = s4l1p*t7
      t50 = t8*s34r
      t51 = t24*t12*t50
      t58 = 3*z
      t59 = -1+t58
      t60 = t59*z
      t61 = t5*t1
      t67 = t2**2
      t69 = t14*t7
      t70 = s34r**2
      t74 = z**2
      t75 = t74*t2
      t82 = t12*t5
      t83 = l3*t7
      t84 = t83*s3l2p
      t85 = t82*t84
      t87 = l3*s4l2p
      t88 = t87*t7
      t89 = t82*t88
      t93 = t2*t4
      t94 = t93*t35
      t95 = 64.D0/3.D0*t94
      t101 = t93*t37
      t105 = t12*t6
      t106 = t83*t70
      t109 = t105*t106-t34*t16
      t110 = 64.D0/3.D0*t109
      t112 = l3*t67
      t114 = t112*t8*s3l2p
      t118 = t112*t6*s4l2p*t7
      t123 = 3*t2*t1
      t124 = t26*s3l2p
      t126 = 2*t1
      t127 = t126*t2
      t129 = t5*s4l2p*t7
      t137 = -128.D0/3.D0*t109
      t138 = t137*s2l2
      t140 = 128.D0/3.D0*t114+128.D0/3.D0*t118
      t142 = t82*t35
      t149 = t70*s34r
      t150 = t69*t149
      t152 = t7*t70
      t155 = -128.D0/3.D0*t112*t150+128.D0/3.D0*t105*t152
      t157 = t14*l3
      t158 = t67*t1
      t159 = t158*t7
      t160 = t159*s3l2p
      t163 = t158*s4l2p*t7
      t168 = t67*t6
      t176 = t83*s3l1p
      t177 = t82*t176
      t179 = l3*s4l1p
      t180 = t179*t7
      t181 = t82*t180
      t185 = t93*t42
      t186 = 64.D0/3.D0*t185
      t192 = t93*t44
      t198 = t112*t8*s3l1p
      t202 = t112*t6*s4l1p*t7
      t206 = t26*s3l1p
      t209 = t5*s4l1p*t7
      t218 = 128.D0/3.D0*t198+128.D0/3.D0*t202
      t228 = t159*s3l1p
      t231 = t158*s4l1p*t7
      t243 = l3**2
      t244 = z*t243
      t245 = t244*t2
      t246 = t4*t7
      t247 = t9**2
      t255 = t26*s34r
      t256 = t244*t12*t255
      t258 = t12*t4
      t259 = t258*l3
      t260 = t37*s3l1p
      t263 = t44*s3l2p
      t264 = t259*t263
      t266 = t87*s4l1p
      t267 = t258*t266
      t271 = l3*t1
      t279 = s23r**2
      t283 = l3*t2
      t284 = t246*s3l2p
      t287 = t4*s4l2p*t7
      t288 = t283*t287
      t292 = t246*s3l1p
      t295 = t4*s4l1p*t7
      t296 = t283*t295
      t304 = t271*t7
      t309 = 2*z
      t310 = -1+t309
      t311 = t310*t1
      t323 = t8*t70
      t324 = t244*t67*t323
      t326 = t112*t5
      t331 = t67*t5
      t332 = t331*t266
      t343 = t3*t287
      t350 = s4l2p*s4l1p
      t354 = (-t58+t74+1)*z
      t368 = t94+t101
      t375 = -1-z
      t388 = 3*t74
      t401 = t37*s34r
      t410 = t44*s34r
      t419 = l3*t158*t6
      t424 = t158*t6
      t426 = -z-2
      t428 = l3*t12
      t438 = -t375*t12
      t446 = z*t5
      t447 = t12*s4l2p
      t461 = l3*t74
      t464 = t74*t4
      t465 = t1*t7
      t470 = t461*t12
      t484 = t4*t243
      t485 = t12*t7
      t486 = t485*s3l2p
      t487 = t484*t486
      t489 = t12*t243
      t490 = t489*t287
      t494 = t283*t35
      t495 = 64.D0/3.D0*t494
      t496 = (128.D0/3.D0*t487+64.D0/3.D0*t490)*s34r-t495
      t505 = t283*t37
      t506 = 64.D0/3.D0*t505
      t509 = t243*t67
      t510 = t509*t124
      t512 = t509*t129
      t517 = (t309-4)*t4
      t518 = t517*l3
      t519 = t2*t7
      t520 = t519*s3l2p
      t525 = z*t1
      t526 = t525*t35
      t527 = 64.D0/3.D0*t526
      t531 = 128.D0/3.D0*t487+128.D0/3.D0*t490
      t537 = t5*t243*t485*t70
      t539 = t126*l3
      t541 = t246*s34r
      t544 = -128.D0/3.D0*t537+64.D0/3.D0*t539*t1*t541
      t550 = 4*z
      t553 = (-6+t550)*t4*l3
      t555 = t517*t2
      t560 = t525*t37
      t561 = 64.D0/3.D0*t560
      t564 = t243*t7
      t566 = t168*t564*t149
      t568 = -2+z
      t569 = t568*t2
      t571 = t569*t5*t106
      t573 = -z+t74
      t574 = t573*t4
      t577 = -128.D0/3.D0*t566+64.D0/3.D0*t571+64.D0/3.D0*t574*t16
      t579 = t6*t243
      t580 = t579*t160
      t582 = t579*t163
      t588 = (z-5)*t5*l3
      t595 = 3*t573*t4
      t599 = t126*z*t4
      t610 = 128.D0/3.D0*t537-128.D0/3.D0*t283*t541
      t615 = t258*t84
      t617 = t615+t258*t88
      t624 = z*t4
      t628 = 256.D0/3.D0*t566-128.D0/3.D0*t571-128.D0/3.D0*t624*t465*s34
     #r
      t634 = t568*t5*l3
      t636 = t447*t7
      t641 = t624*t520
      t647 = t243*t158
      t648 = t70**2
      t649 = t69*t648
      t651 = t8*t149
      t653 = t26*t70
      t656 = 128.D0/3.D0*t647*t649+128.D0/3.D0*t428*t651-128.D0/3.D0*t3*
     #t653
      t658 = t14*t243
      t659 = t67*t2
      t660 = t659*t7
      t678 = t485*s3l1p
      t679 = t484*t678
      t681 = t489*t295
      t685 = t283*t42
      t686 = 64.D0/3.D0*t685
      t687 = (128.D0/3.D0*t679+64.D0/3.D0*t681)*s34r-t686
      t693 = t465*s3l1p
      t696 = t283*t44
      t697 = 64.D0/3.D0*t696
      t700 = t509*t206
      t702 = t509*t209
      t706 = t519*s3l1p
      t712 = 64.D0/3.D0*t525*t42
      t716 = 128.D0/3.D0*t679+128.D0/3.D0*t681
      t731 = 64.D0/3.D0*t525*t44
      t735 = t579*t228
      t737 = t579*t231
      t759 = t258*t176
      t772 = t12*s4l1p*t7
      t802 = t243*l3
      t803 = t802*t7
      t809 = t624*t12*t803*s34r
      t810 = 128.D0/3.D0*t809
      t816 = 448.D0/3.D0*t809
      t824 = t1*t243
      t835 = t446*t67*t803*t70
      t836 = 256.D0/3.D0*t835
      t837 = t509*t4
      t843 = t2*t243
      t859 = t279*s23r
      t875 = t824*t7
      t901 = t843*t16
      t906 = -t426*t2
      t929 = t126*t4
      t930 = t929*t2
      t950 = z*t7
      t953 = 256.D0/3.D0*t424*t802*t950*t149
      t954 = t647*t5
      t966 = t517*t12
      t974 = 4*t74
      t985 = (-z+1+t74)*t1
      t998 = -t494-t505
      t1025 = t929*l3
      t1027 = t2*s4l2p*t7
      t1077 = t310*t5*l3
      t1083 = t574*t1
      t1136 = (z+t74)*t4
      t1148 = t74*z
      t1169 = t74*t7
      t1173 = -t568
      t1179 = t1148*t7
      s3 = (64.D0/3.D0*t3*t8*t9-64.D0/3.D0*z*t12*t14*t16*s1vr)*t21*s13r
      s5 = (64*t25*t26*t27+(-64*t25*t26*s23r+(-64.D0/3.D0*t34*t35-64.D0/
     #3.D0*t34*t37)*s2l1+(-64.D0/3.D0*t34*t42-64.D0/3.D0*t34*t44)*s2l2-1
     #28*t51-64.D0/3.D0*t3*t26)*t9+((256.D0/3.D0*t51-64.D0/3.D0*t60*t61*
     #t7)*s23r+64*t24*t67*t69*t70+64.D0/3.D0*t75*t50)*s1vr)*t21
      s10 = (((128.D0/3.D0*t85+64.D0/3.D0*t89)*s34r-t95)*t9+(((-128.D0/3
     #.D0*t85-128.D0/3.D0*t89)*s34r+t95+64.D0/3.D0*t101)*s23r+t110*s2l2+
     #(-256.D0/3.D0*t114-64*t118)*t70+(64.D0/3.D0*t123*t124+64.D0/3.D0*t
     #127*t129)*s34r)*s1vr+(t138+t140*t70+(-128.D0/3.D0*t142-128.D0/3.D0
     #*t82*t37)*s34r)*s23r+t155*s2l2+(128.D0/3.D0*t157*t160+128.D0/3.D0*
     #t157*t163)*t149+(-128.D0/3.D0*t168*t35-128.D0/3.D0*t168*t37)*t70)*
     #s1l1
      s11 = (((128.D0/3.D0*t177+64.D0/3.D0*t181)*s34r-t186)*t9+(((-128.D
     #0/3.D0*t177-128.D0/3.D0*t181)*s34r+t186+64.D0/3.D0*t192)*s23r+t110
     #*s2l1+(-256.D0/3.D0*t198-64*t202)*t70+(64.D0/3.D0*t123*t206+64.D0/
     #3.D0*t127*t209)*s34r)*s1vr+(t137*s2l1+t218*t70+(-128.D0/3.D0*t82*t
     #42-128.D0/3.D0*t82*t44)*s34r)*s23r+t155*s2l1+(128.D0/3.D0*t157*t22
     #8+128.D0/3.D0*t157*t231)*t149+(-128.D0/3.D0*t168*t42-128.D0/3.D0*t
     #168*t44)*t70)*s1l2
      s9 = s10+s11
      s8 = s9+64.D0/3.D0*t245*t246*t247+(-128*t245*t246*s23r-128*t256-64
     #.D0/3.D0*t259*t260-64.D0/3.D0*t264+(-128.D0/3.D0*t267-64.D0/3.D0*(
     #-2+t58)*z*t271*t4)*t7)*t27+(64*t245*t246*t279+((128.D0/3.D0*t283*t
     #284+128.D0/3.D0*t288)*s2l1+(128.D0/3.D0*t283*t292+128.D0/3.D0*t296
     #)*s2l2+832.D0/3.D0*t256-64.D0/3.D0*t59*t4*z*t304)*s23r+(64.D0/3.D0
     #*t311*t284+64.D0/3.D0*t311*t287)*s2l1+(64.D0/3.D0*t311*t292+64.D0/
     #3.D0*t311*t295)*s2l2+128*t324+(128.D0/3.D0*t326*t260+128.D0/3.D0*t
     #326*t263+(256.D0/3.D0*t332+64.D0/3.D0*(-4+t58)*t5*t25)*t7)*s34r+(-
     #128.D0/3.D0*t94-64.D0/3.D0*t343)*s3l1p-64.D0/3.D0*t3*t4*t263+(-128
     #.D0/3.D0*t258*t350+64.D0/3.D0*t354*t4)*t7)*t9
      s9 = s8+((-320.D0/3.D0*t256+128.D0/3.D0*t59*t4*z*t304)*t279+(64.D0
     #/3.D0*t368*s2l1+(64.D0/3.D0*t185+64.D0/3.D0*t192)*s2l2-320.D0/3.D0
     #*t324-256.D0/3.D0*t375*z*t5*t283*t16+128.D0/3.D0*t368*s3l1p+128.D0
     #/3.D0*t93*t263+(128.D0/3.D0*t93*t350+64.D0/3.D0*(t388-t309+1)*t4*z
     #)*t7)*s23r+(t138+(64.D0/3.D0*t114+128.D0/3.D0*t118)*t70-64.D0/3.D0
     #*t82*t401)*s2l1+((64.D0/3.D0*t198+128.D0/3.D0*t202)*t70-64.D0/3.D0
     #*t82*t410)*s2l2-64.D0/3.D0*t244*t158*t150+(-64.D0/3.D0*t419*t260-6
     #4.D0/3.D0*t419*t263+(-128.D0/3.D0*t424*t266-128.D0/3.D0*t426*z*t42
     #8*t6)*t7)*t70+((128.D0/3.D0*t142+64.D0/3.D0*t438*t129)*s3l1p+64.D0
     #/3.D0*t438*t5*t263+(128.D0/3.D0*t446*t447*s4l1p+64.D0/3.D0*(t309-t
     #388)*z*t61)*t7)*s34r)*s1vr+(-128.D0/3.D0*t461*t2*t255+128.D0/3.D0*
     #t464*t465)*t279
      s7 = s9+(-128.D0/3.D0*t470*t323+128.D0/3.D0*t75*t255)*s23r-128.D0/
     #3.D0*t461*t67*t150+128.D0/3.D0*t74*t12*t323
      s8 = s13r
      s6 = s7*s8
      s4 = s5+s6
      s2 = s3+s4
      s4 = s2
      s7 = t496*t27+(((-256.D0/3.D0*t487-64*t490)*s34r+64.D0/3.D0*t126*t
     #1*t84+t506)*s23r+(-128*t510-64*t512)*t70+(64.D0/3.D0*t518*t520-64.
     #D0/3.D0*t288)*s34r+t527)*t9+((t531*s34r-t495-t506)*t279+(t544*s2l2
     #+(512.D0/3.D0*t510+128*t512)*t70+(-64.D0/3.D0*t553*t520-64.D0/3.D0
     #*t555*t88)*s34r-t527-t561)*s23r+t577*s2l2+(128*t580+256.D0/3.D0*t5
     #82)*t149+(-64.D0/3.D0*t588*t486+64*t89)*t70+(-64.D0/3.D0*t595*t465
     #*s3l2p-64.D0/3.D0*t599*t1*s4l2p*t7)*s34r)*s1vr+(t610*s2l2+(-128.D0
     #/3.D0*t510-128.D0/3.D0*t512)*t70+128.D0/3.D0*t617*s34r)*t279
      s6 = s7+(t628*s2l2+(-256.D0/3.D0*t580-256.D0/3.D0*t582)*t149+(128.
     #D0/3.D0*t634*t486+128.D0/3.D0*t634*t636)*t70+(128.D0/3.D0*t641+128
     #.D0/3.D0*t343)*s34r)*s23r+t656*s2l2+(-128.D0/3.D0*t658*t660*s3l2p-
     #128.D0/3.D0*t658*t659*s4l2p*t7)*t648-t140*t149+(128.D0/3.D0*t446*t
     #486+128.D0/3.D0*t446*t636)*t70
      s7 = s1l1
      s5 = s6*s7
      s3 = s4+s5
      s5 = s3
      s8 = t687*t27+(((-256.D0/3.D0*t679-64*t681)*s34r+64.D0/3.D0*t539*t
     #693+t697)*s23r+(-128*t700-64*t702)*t70+(64.D0/3.D0*t518*t706-64.D0
     #/3.D0*t296)*s34r+t712)*t9+((t716*s34r-t686-t697)*t279+(t544*s2l1+(
     #512.D0/3.D0*t700+128*t702)*t70+(-64.D0/3.D0*t553*t706-64.D0/3.D0*t
     #555*t180)*s34r-t712-t731)*s23r+t577*s2l1+(128*t735+256.D0/3.D0*t73
     #7)*t149+(-64.D0/3.D0*t588*t678+64*t181)*t70+(-64.D0/3.D0*t595*t693
     #-64.D0/3.D0*t599*t1*s4l1p*t7)*s34r)*s1vr+(t610*s2l1+(-128.D0/3.D0*
     #t700-128.D0/3.D0*t702)*t70+(128.D0/3.D0*t759+128.D0/3.D0*t258*t180
     #)*s34r)*t279
      s7 = s8+(t628*s2l1+(-256.D0/3.D0*t735-256.D0/3.D0*t737)*t149+(128.
     #D0/3.D0*t634*t678+128.D0/3.D0*t634*t772)*t70+(128.D0/3.D0*t3*t292+
     #128.D0/3.D0*t3*t295)*s34r)*s23r+t656*s2l1+(-128.D0/3.D0*t658*t660*
     #s3l1p-128.D0/3.D0*t658*t659*s4l1p*t7)*t648-t218*t149+(128.D0/3.D0*
     #t446*t678+128.D0/3.D0*t446*t772)*t70
      s8 = s1l2
      s6 = s7*s8
      s4 = s5+s6
      s1 = s4+(-64.D0/3.D0*t3*t803*s23r-t810)*t247+(64*t3*t803*t279+(t81
     #6+64.D0/3.D0*t489*t260+64.D0/3.D0*t489*t263+(128.D0/3.D0*t489*t350
     #+64.D0/3.D0*t310*z*t824)*t7)*s23r+t496*s2l1+t687*s2l2+t836+(-64.D0
     #/3.D0*t837*t260-64.D0/3.D0*t837*t263-64*z*t4*t843*t7)*s34r+(-128.D
     #0/3.D0*t494+64.D0/3.D0*t569*t88)*s3l1p+64.D0/3.D0*t569*l3*t263)*t2
     #7
      s4 = s1
      s7 = -64.D0/3.D0*t3*t803*t859+((-64.D0/3.D0*t843*t35-64.D0/3.D0*t8
     #43*t37)*s2l1+(-64.D0/3.D0*t843*t42-64.D0/3.D0*t843*t44)*s2l2-t816-
     #64.D0/3.D0*(-t550+2)*z*t875)*t279+((-t531*s34r-64.D0/3.D0*t525*t84
     #-64.D0/3.D0*t525*t88)*s2l1+(-t716*s34r-64.D0/3.D0*t525*t176-64.D0/
     #3.D0*t525*t180)*s2l2-192*t835-64.D0/3.D0*(-3-7*z)*t4*z*t901+(256.D
     #0/3.D0*t494+64.D0/3.D0*t906*t88)*s3l1p+64.D0/3.D0*t906*l3*t263+(12
     #8.D0/3.D0*t3*t266-64.D0/3.D0*(t309-1-2*t74)*z*l3)*t7)*s23r+((-128.
     #D0/3.D0*t510-64.D0/3.D0*t512)*t70+64.D0/3.D0*t930*t83*s3l2p*s34r-6
     #4.D0/3.D0*t520)*s2l1+((-128.D0/3.D0*t700-64.D0/3.D0*t702)*t70+64.D
     #0/3.D0*t930*t83*s3l1p*s34r-64.D0/3.D0*t706)*s2l2
      s6 = s7-t953+(64.D0/3.D0*t954*t260+64.D0/3.D0*t954*t263-64.D0/3.D0
     #*(-t309-3)*t5*z*t489*t7)*t70+((256.D0/3.D0*t615-64.D0/3.D0*t966*t8
     #8)*s3l1p-64.D0/3.D0*t966*t179*t35-64.D0/3.D0*(z-t974)*t1*t4*t24*t7
     #)*s34r+(128.D0/3.D0*t526+64.D0/3.D0*t985*t37)*s3l1p+64.D0/3.D0*t98
     #5*t263
      s7 = t9
      s5 = s6*s7
      s3 = s4+s5
      s4 = s3
      s8 = (t810-64.D0/3.D0*t60*t875)*t859+(64.D0/3.D0*t998*s2l1+(-64.D0
     #/3.D0*t685-64.D0/3.D0*t696)*s2l2+t836+64.D0/3.D0*(-2-9*z)*t4*z*t90
     #1+128.D0/3.D0*t998*s3l1p-128.D0/3.D0*t283*t263+(-128.D0/3.D0*t283*
     #t350-64.D0/3.D0*(1+t74)*z*l3)*t7)*t279+(((-128.D0/3.D0*t615-64.D0/
     #3.D0*t1025*t1027)*s34r-t527-t561)*s2l1+((-128.D0/3.D0*t759-64.D0/3
     #.D0*t1025*t2*s4l1p*t7)*s34r-t712-t731)*s2l2+t953+64.D0/3.D0*(-2-11
     #*z)*z*t5*t489*t152+(-256.D0/3.D0*t617*s3l1p-256.D0/3.D0*t264+(-256
     #.D0/3.D0*t267-128.D0/3.D0*(-1+t74+t550)*t4*t525*l3)*t7)*s34r+(-128
     #.D0/3.D0*t526-128.D0/3.D0*t560)*s3l1p-128.D0/3.D0*t525*t263+(-128.
     #D0/3.D0*t525*t350-64.D0/3.D0*t354)*t7)*s23r+((-64.D0/3.D0*t1077*t4
     #86-64.D0/3.D0*t112*t129)*t70-64.D0/3.D0*t1083*t401)*s2l1
      s7 = s8+((-64.D0/3.D0*t1077*t678-64.D0/3.D0*t331*t180)*t70-64.D0/3
     #.D0*t1083*t410)*s2l2+128.D0/3.D0*t659*t14*t802*t950*t648+64.D0/3.D
     #0*(1-t550)*z*t67*t579*t7*t149+((-128.D0/3.D0*t5*l3*t67*t7*s3l2p+64
     #.D0/3.D0*t634*t67*s4l2p*t7)*s3l1p+64.D0/3.D0*t634*t67*s4l1p*t35+(-
     #128.D0/3.D0*t332+64.D0/3.D0*(-t974-t550+3)*t2*t446*l3)*t7)*t70+((-
     #128.D0/3.D0*t641-64.D0/3.D0*t1136*t1027)*s3l1p-64.D0/3.D0*t1136*t2
     #*t263+(-128.D0/3.D0*t93*z*s4l2p*s4l1p-64.D0/3.D0*(t74-1-2*t1148+z)
     #*t4*z)*t7)*s34r
      s8 = s1vr
      s6 = s7*s8
      s7 = (128.D0/3.D0*t464*t2*t564*s34r-128.D0/3.D0*t74*t1*t83)*t859
      s5 = s6+s7
      s2 = s4+s5
      taux1 = s2+(256.D0/3.D0*t82*t243*t1169*t70+128.D0/3.D0*t1173*t1*t4
     #*t461*t16-128.D0/3.D0*t1179)*t279+(256.D0/3.D0*t168*t243*t1169*t14
     #9+128.D0/3.D0*t1173*t2*t5*t461*t152-128.D0/3.D0*t1*t4*t1179*s34r)*
     #s23r+128.D0/3.D0*t74*t243*t158*t649+128.D0/3.D0*t470*t651-128.D0/3
     #.D0*t1148*t2*t653
      t1 = 1-z
      t3 = l3-1
      t4 = t3**2
      t5 = 7*t1*t4
      t6 = 1/s3vr
      t7 = t6*s2l2
      t10 = -t1
      t11 = t10**2
      t12 = t11*t4
      t13 = t6*s3l2p
      t14 = t12*t13
      t15 = 1280.D0/3.D0*t14
      t17 = s1vr**2
      t19 = 5*t1
      t20 = t19*t4
      t23 = s4l2p*t6
      t24 = t12*t23
      t28 = t4*t3
      t29 = t11*t28
      t30 = t6*s34r
      t31 = t30*s2l2
      t34 = t11*t10
      t35 = t34*t28
      t36 = t13*s34r
      t43 = t6*s2l1
      t46 = t6*s3l1p
      t47 = t12*t46
      t48 = 1280.D0/3.D0*t47
      t53 = s4l1p*t6
      t54 = t12*t53
      t58 = t30*s2l1
      t61 = t46*s34r
      t76 = t34*t4
      t77 = t23*s3l1p
      t80 = t53*s3l2p
      t107 = t11**2
      t108 = t107*t28
      t117 = s13r**2
      t119 = l3*t10
      t120 = t3*t6
      t122 = t119*t120*s2l2
      t124 = -t3
      t125 = t124*t11
      t126 = l3*t6
      t127 = t126*s3l2p
      t130 = l3*t11
      t132 = t3*s4l2p*t6
      t133 = t130*t132
      t136 = t17*s1vr
      t140 = t130*t120*s3l2p
      t143 = l3*s4l2p*t6
      t148 = t4*t6
      t150 = t130*t148*s34r
      t152 = z*t3
      t155 = -3584.D0/3.D0*t150-1280.D0/3.D0*t152*t6
      t157 = t76*t127
      t159 = t76*t143
      t163 = -4+z
      t164 = t163*t3
      t165 = t10*t6
      t166 = t165*s3l2p
      t169 = t11*t3
      t170 = t169*t23
      t178 = s23r**2
      t181 = 3*z
      t186 = 8960.D0/3.D0*t150-256.D0/3.D0*(-7-t181)*t3*t6
      t192 = 6*z
      t194 = (-11+t192)*t3
      t197 = 4*z
      t199 = (-1-t197)*t3
      t201 = t10*s4l2p*t6
      t206 = s34r**2
      t207 = t126*t206
      t208 = t35*t207
      t210 = t12*t30
      t212 = 2048*t208-1024.D0/3.D0*t210
      t214 = l3*t107
      t215 = t28*t6
      t217 = t214*t215*s3l2p
      t221 = t214*t28*s4l2p*t6
      t225 = 9*z
      t227 = (-12+t225)*t11
      t228 = t148*s3l2p
      t230 = 11*z
      t232 = (-8+t230)*t11
      t234 = t4*s4l2p*t6
      t242 = 5*t124
      t246 = -2560.D0/3.D0*t150-512.D0/3.D0*t242*t10*t6
      t248 = t157+t159
      t257 = -2048.D0/3.D0*t208+2048.D0/3.D0*t210
      t260 = 2048.D0/3.D0*t217+2048.D0/3.D0*t221
      t269 = t4**2
      t270 = t269*t6
      t271 = t206*s34r
      t277 = -2048.D0/3.D0*t214*t270*t271+2048.D0/3.D0*t35*t6*t206
      t279 = t269*l3
      t280 = t107*t10
      t281 = t280*t6
      t282 = t281*s3l2p
      t285 = t280*s4l2p*t6
      t298 = t119*t120*s2l1
      t300 = t126*s3l1p
      t304 = t3*s4l1p*t6
      t305 = t130*t304
      t310 = t120*s3l1p
      t311 = t130*t310
      t314 = l3*s4l1p*t6
      t321 = t76*t300
      t323 = t76*t314
      t327 = t165*s3l1p
      t330 = t169*t53
      t348 = t10*s4l1p*t6
      t356 = t214*t215*s3l1p
      t360 = t214*t28*s4l1p*t6
      t364 = t148*s3l1p
      t367 = t4*s4l1p*t6
      t376 = -t321-t323
      t387 = -2048.D0/3.D0*t356-2048.D0/3.D0*t360
      t398 = t281*s3l1p
      t401 = t280*s4l1p*t6
      t414 = 6*t124*t11
      t417 = 3*t124*t11
      t427 = t34*t3
      t428 = t427*l3
      t429 = t428*t77
      t431 = t428*t80
      t445 = t76*l3
      t449 = (-6+t225)*t3
      t453 = (t197-2)*t3
      t466 = t214*t4
      t469 = t466*t77-t466*t80
      t472 = 1+z
      t474 = t472*t11*t3
      t492 = (6-t230)*t3
      t516 = t214*t28
      t521 = (-t230+12)*t11
      t523 = 3-t197
      t524 = t523*t11
      t542 = l3*t280*t28
      t550 = (3+z)*t34*t4
      t560 = l3**2
      t561 = t10*t560
      t564 = t560*t11
      t565 = t564*t13
      t567 = t564*t23
      t568 = 256*t567
      t573 = -t242*t11*t560
      t576 = 4*t124
      t578 = t576*t34*t560
      t581 = 2*z
      t583 = (-t581+1)*t10
      t589 = 6*t1*t560
      t598 = t560*t6
      t599 = t598*s34r
      t605 = -768*t124*t11*t599-256.D0/3.D0*(1-t192)*l3*t6
      t608 = 21*t34*t3
      t609 = t598*s3l2p
      t612 = 10*t34*t3
      t614 = t560*s4l2p*t6
      t621 = (-5*z-4)*t10
      t625 = (-5+t197)*t10
      t631 = t34*t6
      t633 = t4*t560*t631*t206
      t635 = 10*z
      t639 = t126*s34r
      t642 = 512.D0/3.D0*t633-256.D0/3.D0*(-t635+8)*t10*t3*t639
      t644 = t560*t107
      t645 = t644*t228
      t647 = t644*t234
      t654 = (10-14*z)*t3*t11
      t657 = z*t11
      t658 = t657*t3
      t664 = (z+2)*t10
      t669 = t19*t560
      t675 = t178*s23r
      t684 = 7424.D0/3.D0*t124*t11*t599+256.D0/3.D0*(-6-t197)*l3*t6
      t687 = 15*t34*t3
      t691 = 20*t34*t3
      t697 = (-9-z)*t10
      t700 = z*t10
      t706 = 7*z
      t712 = z*t6
      t714 = -8704.D0/3.D0*t633+256.D0/3.D0*(-t706-6)*t10*t3*t639+1280.D
     #0/3.D0*t712
      t722 = (-19-z)*t3*t11
      t725 = t242*t11
      t731 = (t192+5)*t10
      t735 = (-t581+5)*t10
      t741 = t108*t598*t271
      t743 = 12*z
      t749 = z**2
      t755 = -1280*t741+256.D0/3.D0*(5-t743)*t11*t4*t207+256.D0/3.D0*(-t
     #706+7*t749+5)*t3*t30
      t757 = t28*t560
      t758 = t757*t282
      t760 = t757*t285
      t764 = z*t4
      t765 = t764*l3
      t766 = t631*s3l2p
      t769 = 8*z
      t772 = (5+t769)*l3*t34
      t779 = (-t743+9*t749+5)*t3
      t783 = (-5+t769)*z*t10
      t794 = -512.D0/3.D0*t725*t599+512.D0/3.D0*t19*l3*t6
      t796 = t242*t34
      t797 = t796*t609
      t809 = -9+t197
      t815 = 1536*t633-512.D0/3.D0*t809*t10*t3*t639-2560.D0/3.D0*t712
      t821 = t809*t3*t11
      t827 = t700*t13
      t834 = t197-8
      t842 = 4096.D0/3.D0*t741-512.D0/3.D0*t834*t11*t4*t207-2048.D0/3.D0
     #*t152*t165*s34r
      t848 = t834*l3*t34
      t854 = -t576
      t855 = t854*z
      t856 = t11*t6
      t857 = t856*s3l2p
      t860 = t11*s4l2p*t6
      t868 = t206**2
      t871 = l3*t34
      t877 = 2048.D0/3.D0*t560*t280*t270*t868+2048.D0/3.D0*t871*t215*t27
     #1-2048.D0/3.D0*t657*t148*t206
      t879 = t269*t560
      t880 = t107*t11
      t881 = t880*t6
      t893 = t34*s4l2p
      t903 = t564*t46
      t905 = t564*t53
      t906 = 256*t905
      t925 = t598*s3l1p
      t928 = t560*s4l1p*t6
      t941 = t644*t364
      t943 = t644*t367
      t997 = t757*t398
      t999 = t757*t401
      t1003 = t631*s3l1p
      t1019 = t796*t925
      t1040 = t700*t46
      t1076 = t34*s4l1p
      t1084 = t34*t560
      t1085 = t1084*t77
      t1086 = t1084*t80
      t1089 = t17**2
      t1116 = t854*t107*t560
      t1124 = -t523*t11*l3
      t1131 = t13*s2l1
      t1134 = t46*s2l2
      t1142 = 2*t124
      t1143 = t1142*t34
      t1149 = (-7+t181)*t10
      t1153 = -t19*t10
      t1170 = t1142*t107*t560
      t1178 = -t163*l3*t11
      t1186 = t523*t3*l3
      t1190 = 4*t10*t3*l3
      t1198 = t856*s3l1p
      t1201 = t11*s4l1p*t6
      t1209 = t152*l3
      t1210 = t893*t46
      t1212 = t1076*t13
      t1217 = 2*t10
      t1238 = (-t635+13)*t3*l3
      t1242 = (3-t581)*t3*l3
      t1249 = -2*t472*t10
      t1252 = t1217*t10
      t1270 = (7-t581)*t3*l3
      t1277 = (3+t581)*t11
      t1288 = (-3+t230-4*t749)*t3
      t1291 = (2-z)*t10
      t1307 = t453*t11
      s3 = (((-256.D0/3.D0*t5*t7-t15)*t17+((512.D0/3.D0*t20*t7+t15+1280.
     #D0/3.D0*t24)*s23r-1280.D0/3.D0*t29*t31+1280.D0/3.D0*t35*t36)*s1vr)
     #*s1l1+((256.D0/3.D0*t5*t43+t48)*t17+((-512.D0/3.D0*t20*t43-t48-128
     #0.D0/3.D0*t54)*s23r+1280.D0/3.D0*t29*t58-1280.D0/3.D0*t35*t61)*s1v
     #r)*s1l2+((256*t14+1024.D0/3.D0*t24)*s2l1+(-256*t47-1024.D0/3.D0*t5
     #4)*s2l2-512.D0/3.D0*t76*t77+512.D0/3.D0*t76*t80)*t17+(((-1280.D0/3
     #.D0*t14-1280.D0/3.D0*t24)*s2l1+(1280.D0/3.D0*t47+1280.D0/3.D0*t54)
     #*s2l2)*s23r+(-256*t35*t13-512.D0/3.D0*t35*t23)*s34r*s2l1+(256*t35*
     #t46+512.D0/3.D0*t35*t53)*s34r*s2l2+(512.D0/3.D0*t108*t77-512.D0/3.
     #D0*t108*t80)*s34r)*s1vr)*t117
      s7 = ((-256.D0/3.D0*t122+1280.D0/3.D0*t125*t127-256*t133)*t136+((-
     #3328.D0/3.D0*t122+4352.D0/3.D0*t140-256*t125*t143)*s23r+t155*s2l2+
     #(6656.D0/3.D0*t157+3584.D0/3.D0*t159)*s34r-256.D0/3.D0*t164*t166-2
     #56*t170)*t17+((5120.D0/3.D0*t122-1280*t140-1280*t133)*t178+(t186*s
     #2l2+(-8192.D0/3.D0*t157-4096.D0/3.D0*t159)*s34r+256.D0/3.D0*t194*t
     #166+256.D0/3.D0*t199*t201)*s23r+t212*s2l2+(-7424.D0/3.D0*t217-4864
     #.D0/3.D0*t221)*t206+(256.D0/3.D0*t227*t228+256.D0/3.D0*t232*t234)*
     #s34r)*s1vr+(t246*s2l2+2560.D0/3.D0*t248*s34r-2560.D0/3.D0*t169*t13
     #-2560.D0/3.D0*t170)*t178+(t257*s2l2+t260*t206+(-2048.D0/3.D0*t76*t
     #13-2048.D0/3.D0*t76*t23)*s34r)*s23r+t277*s2l2+(2048.D0/3.D0*t279*t
     #282+2048.D0/3.D0*t279*t285)*t271+(-2048.D0/3.D0*t108*t13-2048.D0/3
     #.D0*t108*t23)*t206)*s1l1
      s8 = ((256.D0/3.D0*t298-1280.D0/3.D0*t125*t300+256*t305)*t136+((33
     #28.D0/3.D0*t298-4352.D0/3.D0*t311+256*t125*t314)*s23r-t155*s2l1+(-
     #6656.D0/3.D0*t321-3584.D0/3.D0*t323)*s34r+256.D0/3.D0*t164*t327+25
     #6*t330)*t17+((-5120.D0/3.D0*t298+1280*t311+1280*t305)*t178+(-t186*
     #s2l1+(8192.D0/3.D0*t321+4096.D0/3.D0*t323)*s34r-256.D0/3.D0*t194*t
     #327-256.D0/3.D0*t199*t348)*s23r-t212*s2l1+(7424.D0/3.D0*t356+4864.
     #D0/3.D0*t360)*t206+(-256.D0/3.D0*t227*t364-256.D0/3.D0*t232*t367)*
     #s34r)*s1vr+(-t246*s2l1+2560.D0/3.D0*t376*s34r+2560.D0/3.D0*t169*t4
     #6+2560.D0/3.D0*t330)*t178+(-t257*s2l1+t387*t206+(2048.D0/3.D0*t76*
     #t46+2048.D0/3.D0*t76*t53)*s34r)*s23r-t277*s2l1+(-2048.D0/3.D0*t279
     #*t398-2048.D0/3.D0*t279*t401)*t271+(2048.D0/3.D0*t108*t46+2048.D0/
     #3.D0*t108*t53)*t206)*s1l2
      s6 = s7+s8
      s7 = s6+((256.D0/3.D0*t414*t127+256.D0/3.D0*t417*t143)*s2l1+(-256.
     #D0/3.D0*t414*t300-256.D0/3.D0*t417*t314)*s2l2+256.D0/3.D0*t429-256
     #.D0/3.D0*t431)*t136
      s8 = s7
      s10 = (((256*t140-256*t133)*s2l1+(-256*t311+256*t305)*s2l2+1024.D0
     #/3.D0*t429-1024.D0/3.D0*t431)*s23r+(768*t445*t36-256.D0/3.D0*t449*
     #t166-256.D0/3.D0*t453*t201)*s2l1+(-768*t445*t61+256.D0/3.D0*t449*t
     #327+256.D0/3.D0*t453*t348)*s2l2+512.D0/3.D0*t469*s34r+256.D0/3.D0*
     #t474*t77-256.D0/3.D0*t474*t80)*t17
      s11 = (((1280.D0/3.D0*t140+1280.D0/3.D0*t133)*s2l1+(-1280.D0/3.D0*
     #t311-1280.D0/3.D0*t305)*s2l2)*t178+((1792.D0/3.D0*t248*s34r-256.D0
     #/3.D0*t492*t166+1280.D0/3.D0*t152*t201)*s2l1+(1792.D0/3.D0*t376*s3
     #4r+256.D0/3.D0*t492*t327-1280.D0/3.D0*t152*t348)*s2l2-256*t469*s34
     #r+256*t427*t77-256*t427*t80)*s23r+(-256*t516*t13*t206+(-256.D0/3.D
     #0*t521*t228-256.D0/3.D0*t524*t234)*s34r)*s2l1+(256*t516*t46*t206+(
     #256.D0/3.D0*t521*t364+256.D0/3.D0*t524*t367)*s34r)*s2l2+(-256*t542
     #*t77+256*t542*t80)*t206+(-256.D0/3.D0*t550*t77+256.D0/3.D0*t550*t8
     #0)*s34r)*s1vr
      s9 = s10+s11
      s5 = s8+s9
      s6 = s13r
      s4 = s5*s6
      s2 = s3+s4
      s3 = s2
      s8 = ((256.D0/3.D0*t561*t7+1024.D0/3.D0*t565+t568)*s23r+256.D0/3.D
     #0*t573*t31+256.D0/3.D0*t578*t36-256.D0/3.D0*t583*t127)*t136+((-256
     #.D0/3.D0*t589*t7-2816.D0/3.D0*t565-512.D0/3.D0*t567)*t178+(t605*s2
     #l2+(-256.D0/3.D0*t608*t609-256.D0/3.D0*t612*t614)*s34r+256.D0/3.D0
     #*t621*t127+256.D0/3.D0*t625*t143)*s23r+t642*s2l2+(-1280.D0/3.D0*t6
     #45-2048.D0/3.D0*t647)*t206+(256.D0/3.D0*t654*t127-2048.D0/3.D0*t65
     #8*t143)*s34r+256.D0/3.D0*t664*t13)*t17
      s7 = s8+((512.D0/3.D0*t669*t7+2560.D0/3.D0*t565+2560.D0/3.D0*t567)
     #*t675+(t684*s2l2+(512.D0/3.D0*t687*t609+256.D0/3.D0*t691*t614)*s34
     #r-256.D0/3.D0*t697*t127+2560.D0/3.D0*t700*t143)*t178+(t714*s2l2+(9
     #472.D0/3.D0*t645+6656.D0/3.D0*t647)*t206+(-256.D0/3.D0*t722*t127-5
     #12.D0/3.D0*t725*t143)*s34r-256.D0/3.D0*t731*t13-256.D0/3.D0*t735*t
     #23)*s23r+t755*s2l2+(4352.D0/3.D0*t758+4096.D0/3.D0*t760)*t271+(102
     #4*t765*t766+256.D0/3.D0*t772*t234)*t206+(-256.D0/3.D0*t779*t166-25
     #6.D0/3.D0*t783*t132)*s34r)*s1vr+(t794*s2l2+(512.D0/3.D0*t797+512.D
     #0/3.D0*t796*t614)*s34r+2560.D0/3.D0*t130*t13+2560.D0/3.D0*t130*t23
     #)*t675+(t815*s2l2+(-1536*t645-1536*t647)*t206+(512.D0/3.D0*t821*t1
     #27+512.D0/3.D0*t821*t143)*s34r+2560.D0/3.D0*t827+2560.D0/3.D0*t700
     #*t23)*t178
      s6 = s7+(t842*s2l2+(-4096.D0/3.D0*t758-4096.D0/3.D0*t760)*t271+(51
     #2.D0/3.D0*t848*t228+512.D0/3.D0*t848*t234)*t206+(512.D0/3.D0*t855*
     #t857+512.D0/3.D0*t855*t860)*s34r)*s23r+t877*s2l2+(-2048.D0/3.D0*t8
     #79*t881*s3l2p-2048.D0/3.D0*t879*t880*s4l2p*t6)*t868-t260*t271+(204
     #8.D0/3.D0*t764*t766+2048.D0/3.D0*t764*t893*t6)*t206
      s7 = s1l1
      s5 = s6*s7
      s9 = ((-256.D0/3.D0*t561*t43-1024.D0/3.D0*t903-t906)*s23r-256.D0/3
     #.D0*t573*t58-256.D0/3.D0*t578*t61+256.D0/3.D0*t583*t300)*t136+((25
     #6.D0/3.D0*t589*t43+2816.D0/3.D0*t903+512.D0/3.D0*t905)*t178+(-t605
     #*s2l1+(256.D0/3.D0*t608*t925+256.D0/3.D0*t612*t928)*s34r-256.D0/3.
     #D0*t621*t300-256.D0/3.D0*t625*t314)*s23r-t642*s2l1+(1280.D0/3.D0*t
     #941+2048.D0/3.D0*t943)*t206+(-256.D0/3.D0*t654*t300+2048.D0/3.D0*t
     #658*t314)*s34r-256.D0/3.D0*t664*t46)*t17
      s8 = s9+((-512.D0/3.D0*t669*t43-2560.D0/3.D0*t903-2560.D0/3.D0*t90
     #5)*t675+(-t684*s2l1+(-512.D0/3.D0*t687*t925-256.D0/3.D0*t691*t928)
     #*s34r+256.D0/3.D0*t697*t300-2560.D0/3.D0*t700*t314)*t178+(-t714*s2
     #l1+(-9472.D0/3.D0*t941-6656.D0/3.D0*t943)*t206+(256.D0/3.D0*t722*t
     #300+512.D0/3.D0*t725*t314)*s34r+256.D0/3.D0*t731*t46+256.D0/3.D0*t
     #735*t53)*s23r-t755*s2l1+(-4352.D0/3.D0*t997-4096.D0/3.D0*t999)*t27
     #1+(-1024*t765*t1003-256.D0/3.D0*t772*t367)*t206+(256.D0/3.D0*t779*
     #t327+256.D0/3.D0*t783*t304)*s34r)*s1vr+(-t794*s2l1+(-512.D0/3.D0*t
     #1019-512.D0/3.D0*t796*t928)*s34r-2560.D0/3.D0*t130*t46-2560.D0/3.D
     #0*t130*t53)*t675+(-t815*s2l1+(1536*t941+1536*t943)*t206+(-512.D0/3
     #.D0*t821*t300-512.D0/3.D0*t821*t314)*s34r-2560.D0/3.D0*t1040-2560.
     #D0/3.D0*t700*t53)*t178
      s7 = s8+(-t842*s2l1+(4096.D0/3.D0*t997+4096.D0/3.D0*t999)*t271+(-5
     #12.D0/3.D0*t848*t364-512.D0/3.D0*t848*t367)*t206+(-2048.D0/3.D0*t6
     #57*t310-2048.D0/3.D0*t657*t304)*s34r)*s23r-t877*s2l1+(2048.D0/3.D0
     #*t879*t881*s3l1p+2048.D0/3.D0*t879*t880*s4l1p*t6)*t868-t387*t271+(
     #-2048.D0/3.D0*t764*t1003-2048.D0/3.D0*t764*t1076*t6)*t206
      s8 = s1l2
      s6 = s7*s8
      s4 = s5+s6
      s1 = s3+s4
      s2 = s1+(-1024.D0/3.D0*t1085+1024.D0/3.D0*t1086)*t1089
      s3 = s2+(((1280.D0/3.D0*t565+t568)*s2l1+(-1280.D0/3.D0*t903-t906)*
     #s2l2+256*t1085-256*t1086)*s23r+(-256.D0/3.D0*t578*t23*s34r+512.D0/
     #3.D0*t700*t127)*s2l1+(256.D0/3.D0*t578*t53*s34r-512.D0/3.D0*t700*t
     #300)*s2l2+(256.D0/3.D0*t1116*t77-256.D0/3.D0*t1116*t80)*s34r-256.D
     #0/3.D0*t1124*t77+256.D0/3.D0*t1124*t80)*t136
      s4 = s3
      s6 = ((-1280.D0/3.D0*t564*t1131+1280.D0/3.D0*t564*t1134-512.D0/3.D
     #0*t1085+512.D0/3.D0*t1086)*t178+(((512.D0/3.D0*t797+256.D0/3.D0*t1
     #143*t614)*s34r+256.D0/3.D0*t1149*t127+256.D0/3.D0*t1153*t143)*s2l1
     #+((-512.D0/3.D0*t1019-256.D0/3.D0*t1143*t928)*s34r-256.D0/3.D0*t11
     #49*t300-256.D0/3.D0*t1153*t314)*s2l2+(256.D0/3.D0*t1170*t77-256.D0
     #/3.D0*t1170*t80)*s34r-256.D0/3.D0*t1178*t77+256.D0/3.D0*t1178*t80)
     #*s23r+((256.D0/3.D0*t1186*t857+256.D0/3.D0*t1190*t860)*s34r+512.D0
     #/3.D0*t827)*s2l1+((-256.D0/3.D0*t1186*t1198-256.D0/3.D0*t1190*t120
     #1)*s34r-512.D0/3.D0*t1040)*s2l2+(1024.D0/3.D0*t1209*t1210-1024.D0/
     #3.D0*t1209*t1212)*s34r-256.D0/3.D0*t1217*s4l2p*t46+256.D0/3.D0*t12
     #17*s4l1p*t13)*t17
      s7 = ((-1280.D0/3.D0*t130*t1131+1280.D0/3.D0*t130*t1134-512.D0/3.D
     #0*t871*t77+512.D0/3.D0*t871*t80)*t178+(((256.D0/3.D0*t1238*t857+25
     #6.D0/3.D0*t1242*t860)*s34r+256.D0/3.D0*t1249*t13+256.D0/3.D0*t1252
     #*t23)*s2l1+((-256.D0/3.D0*t1238*t1198-256.D0/3.D0*t1242*t1201)*s34
     #r-256.D0/3.D0*t1249*t46-256.D0/3.D0*t1252*t53)*s2l2+(256.D0/3.D0*t
     #1270*t1210-256.D0/3.D0*t1270*t1212)*s34r-256.D0/3.D0*t1277*t77+256
     #.D0/3.D0*t1277*t80)*s23r+(256*t248*t206+(256.D0/3.D0*t1288*t166+25
     #6.D0/3.D0*t1291*t132)*s34r)*s2l1+(256*t376*t206+(-256.D0/3.D0*t128
     #8*t327-256.D0/3.D0*t1291*t304)*s34r)*s2l2+(256.D0/3.D0*t1307*t77-2
     #56.D0/3.D0*t1307*t80)*s34r)*s1vr
      s5 = s6+s7
      taux2 = s4+s5

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = -taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet2 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet4 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      ACnum1e2 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcoff4
      RETURN
      END

      double precision function ACnum1e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3*z
      t2 = -1+z
      t3 = t2**2
      t4 = t3*t2
      t6 = l3-1
      t7 = t6**2
      t8 = t7*t6
      t9 = 1/s3vr
      t10 = t8*t9
      t11 = t10*s34r
      t13 = t3*z
      t14 = t7*t9
      t18 = s1vr**2
      t20 = t3**2
      t22 = t7**2
      t23 = t22*t9
      t24 = s34r**2
      t33 = s13r**2
      t35 = l3**2
      t36 = z*t35
      t38 = t14*s34r
      t39 = t36*t4*t38
      t45 = t18*s1vr
      t48 = 2*t2
      t50 = t48*t6*z
      t51 = t2*l3
      t58 = t10*t24
      t59 = t36*t20*t58
      t66 = t9*s34r
      t67 = t3*l3*t66
      t70 = z**2
      t72 = (-z+t70)*z
      t73 = t6*t9
      t79 = t48*z
      t83 = 2*z
      t84 = 1-t83+t70
      t85 = t84*t6
      t86 = z*t9
      t91 = t20*t2
      t93 = t24*s34r
      t94 = t23*t93
      t99 = t9*t24
      t103 = t84*z
      t111 = l3*t70
      t112 = t111*t4
      t129 = t35*l3
      t130 = t129*t9
      t136 = -64.D0/3.D0*t6*z*t4*t130*s34r+64.D0/3.D0*t13*t35*t9
      t141 = t7*z*t20*t130*t24
      t142 = 128.D0/3.D0*t141
      t144 = t3*t35*t66
      t150 = s23r**2
      t160 = l3*t9
      t169 = 256.D0/3.D0*t91*t8*t129*t86*t93
      t170 = 4*z
      t175 = t4*t35*t99
      t210 = t24**2
      t229 = t70*z
      t240 = t70*t9
      s2 = ((64.D0/3.D0*t1*t4*t11-64.D0/3.D0*t13*t14)*t18+(-64.D0/3.D0*t
     #1*t20*t23*t24+64.D0/3.D0*t4*z*t11)*s1vr)*t33+((64.D0/3.D0*t39-64.D
     #0/3.D0*t13*l3*t6*t9)*t45+((-128.D0/3.D0*t39+64.D0/3.D0*t50*t51*t9)
     #*s23r-256.D0/3.D0*t59+64.D0/3.D0*(-4+3*z)*t7*z*t67+64.D0/3.D0*t72*
     #t73)*t18+((64*t59-128.D0/3.D0*t79*t7*t67+64.D0/3.D0*t85*t86)*s23r+
     #64*t36*t91*t94-128.D0/3.D0*t79*l3*t4*t8*t99+64.D0/3.D0*t103*t7*t2*
     #t9*s34r)*s1vr+(128.D0/3.D0*t112*t58-128.D0/3.D0*t70*t3*t38)*s23r+1
     #28.D0/3.D0*t111*t20*t94-128.D0/3.D0*t70*t4*t58)*s13r
      s1 = s2+(t136*s23r-t142+64.D0/3.D0*t50*t144)*t45+(-t136*t150+(320.
     #D0/3.D0*t141-64.D0/3.D0*(-6+5*z)*t6*z*t144-64.D0/3.D0*t2*z*t160)*s
     #23r+t169-64.D0/3.D0*(-5+t170)*t7*z*t175-64.D0/3.D0*t13*l3*t73*s34r
     #)*t18+((-t142+64*t2*t6*z*t144-64.D0/3.D0*t103*t160)*t150+(-t169+64
     #.D0/3.D0*(-6+7*z)*z*t7*t175-128.D0/3.D0*t85*z*t51*t66-64.D0/3.D0*t
     #72*t9)*s23r-128.D0/3.D0*t20*t3*t22*t129*t86*t210+64.D0/3.D0*(-3+t1
     #70)*z*t20*t8*t35*t9*t93+64.D0/3.D0*(-1+t83)*t3*t7*t1*t99-64.D0/3.D
     #0*(z-3*t70+2*t229)*t6*t86*s34r)*s1vr
      taux1 = s1+(-128.D0/3.D0*t4*t7*t35*t240*t24+128.D0/3.D0*t3*t6*l3*t
     #240*s34r)*t150+(-256.D0/3.D0*t20*t8*t35*t240*t93+128.D0/3.D0*(-2+z
     #)*t3*t7*t111*t99+128.D0/3.D0*t2*t6*t229*t9*s34r)*s23r-128.D0/3.D0*
     #t70*t35*t91*t23*t210-128.D0/3.D0*t112*t10*t93+128.D0/3.D0*t229*t3*
     #t14*t24
      t1 = -1+z
      t2 = l3-1
      t3 = t2**2
      t4 = t1*t3
      t5 = 1/s3vr
      t6 = t5*s2l2
      t7 = t4*t6
      t8 = t1**2
      t9 = t8*t3
      t10 = t5*s3l2p
      t11 = t9*t10
      t14 = s1vr**2
      t18 = s4l2p*t5
      t19 = t9*t18
      t23 = t3*t2
      t24 = t8*t23
      t25 = t5*s34r
      t26 = t25*s2l2
      t29 = t8*t1
      t30 = t29*t23
      t38 = t5*s2l1
      t39 = t4*t38
      t40 = t5*s3l1p
      t41 = t9*t40
      t47 = s4l1p*t5
      t48 = t9*t47
      t52 = t25*s2l1
      t80 = t30*t5
      t92 = s13r**2
      t94 = l3*t1
      t95 = t2*t5
      t97 = t94*t95*s2l2
      t99 = t2*t8
      t100 = l3*t5
      t101 = t100*s3l2p
      t102 = t99*t101
      t104 = l3*t8
      t106 = t2*s4l2p*t5
      t107 = t104*t106
      t110 = t14*s1vr
      t114 = 512*t107
      t117 = t3*t5
      t119 = t104*t117*s34r
      t121 = z*t2
      t124 = 1024*t119+512.D0/3.D0*t121*t5
      t126 = t29*t3
      t127 = t126*t101
      t129 = l3*t29
      t130 = t3*s4l2p
      t131 = t130*t5
      t132 = t129*t131
      t138 = (5-3*z)*t2
      t139 = t1*t5
      t140 = t139*s3l2p
      t143 = t99*t18
      t150 = s23r**2
      t153 = z+1
      t157 = -6656.D0/3.D0*t119-512.D0/3.D0*t153*t2*t5
      t163 = 5*z
      t165 = (7-t163)*t2
      t169 = (3-z)*t2
      t171 = t1*s4l2p*t5
      t176 = t23*t5
      t177 = s34r**2
      t179 = t129*t176*t177
      t181 = t9*t25
      t183 = -1792*t179+1280.D0/3.D0*t181
      t185 = t8**2
      t186 = l3*t185
      t187 = t176*s3l2p
      t188 = t186*t187
      t191 = t23*s4l2p*t5
      t192 = t186*t191
      t198 = (15-13*z)*t8
      t199 = t117*s3l2p
      t201 = 12*z
      t203 = (10-t201)*t8
      t213 = 1024.D0/3.D0*t119-1024.D0/3.D0*t2*t1*t5
      t224 = 2560.D0/3.D0*t179-2560.D0/3.D0*t181
      t227 = -2560.D0/3.D0*t188-2560.D0/3.D0*t192
      t236 = t3**2
      t238 = t177*s34r
      t244 = 2560.D0/3.D0*t185*t236*t100*t238-2560.D0/3.D0*t30*t5*t177
      t246 = t185*t1
      t247 = t246*t236
      t250 = l3*s4l2p*t5
      t255 = t185*t23
      t264 = t94*t95*s2l1
      t266 = t100*s3l1p
      t267 = t99*t266
      t270 = t2*s4l1p*t5
      t271 = t104*t270
      t277 = 512*t271
      t282 = t126*t266
      t284 = t3*s4l1p
      t285 = t284*t5
      t286 = t129*t285
      t290 = t139*s3l1p
      t293 = t99*t47
      t310 = t1*s4l1p*t5
      t317 = t176*s3l1p
      t318 = t186*t317
      t321 = t23*s4l1p*t5
      t322 = t186*t321
      t326 = t117*s3l1p
      t347 = 2560.D0/3.D0*t318+2560.D0/3.D0*t322
      t360 = l3*s4l1p*t5
      t372 = 3*t2
      t373 = t372*t8
      t382 = t129*t2
      t383 = t18*s3l1p
      t386 = t47*s3l2p
      t391 = -t102-t107
      t394 = t267+t271
      t403 = 2*z
      t405 = (3-t403)*t2
      t408 = t372*t1
      t423 = t186*t3
      t426 = t423*t383-t423*t386
      t429 = z+2
      t431 = t429*t8*t2
      t449 = (-3+t163)*t2
      t469 = t29*t2
      t476 = t186*t23
      t480 = 8*z
      t482 = (-6+t480)*t8
      t484 = -t153
      t485 = t484*t8
      t503 = l3*t246*t23
      t509 = t185*t3
      t519 = l3**2
      t520 = t8*t519
      t521 = t14**2
      t525 = t1*t519
      t526 = t525*t6
      t528 = t520*t10
      t530 = t520*t18
      t534 = t520*t2
      t537 = -t2
      t539 = 18*t537*t29
      t540 = t519*t5
      t541 = t540*s3l2p
      t543 = t537*t29
      t545 = t519*s4l2p*t5
      t546 = t543*t545
      t550 = 7*z
      t552 = (-1+t550)*t1
      t563 = t99*t540*s34r
      t566 = -5632.D0/3.D0*t563-512.D0/3.D0*t100
      t569 = 50*t537*t29
      t572 = 19*t537*t29
      t578 = 10*l3*t1
      t582 = 3*t153*t1
      t588 = t126*t540*t177
      t590 = z*t1
      t592 = t100*s34r
      t595 = -4096.D0/3.D0*t588-2048.D0/3.D0*t590*t2*t592
      t597 = t519*t185
      t598 = t597*t199
      t600 = t597*t131
      t604 = t8*z
      t605 = t604*l3
      t611 = (-1-t480)*l3*t8
      t616 = t590*t10
      t617 = 256*t616
      t622 = t150*s23r
      t626 = 6656.D0/3.D0*t563+1024.D0/3.D0*t100
      t629 = 15*t537*t29
      t633 = 22*t537*t29
      t639 = (11-t550)*t1
      t643 = (-z+5)*t1
      t654 = z*t5
      t656 = 9728.D0/3.D0*t588+256.D0/3.D0*(6+t201)*t1*t2*t592-512.D0/3.
     #D0*t654
      t664 = (24-t403)*t2*t8
      t669 = (8-z)*t2*t8
      t675 = (-t163-2)*t1
      t679 = -t429*t1
      t685 = t255*t540*t238
      t688 = t100*t177
      t691 = z**2
      t697 = 4096.D0/3.D0*t685+1280*t604*t3*t688+256.D0/3.D0*(t550-7*t69
     #1-2)*t2*t25
      t699 = t519*t246
      t700 = t699*t187
      t702 = t699*t191
      t706 = 15*z
      t709 = (9+t706)*t3*l3
      t710 = t29*t5
      t711 = t710*s3l2p
      t715 = (-9-t480)*l3*t29
      t722 = (t706-13*t691-2)*t2
      t725 = 8-10*z
      t727 = t725*z*t1
      t736 = -1024.D0/3.D0*t563+1024.D0/3.D0*t94*t5
      t738 = t469*t541
      t743 = t104*t10
      t745 = t104*t18
      t754 = -3584.D0/3.D0*t588-512.D0/3.D0*t165*t1*t592+1024.D0/3.D0*t6
     #54
      t759 = t165*t8
      t766 = t590*t18
      t771 = 10-t163
      t779 = -5120.D0/3.D0*t685-512.D0/3.D0*t771*t8*t3*t688+2560.D0/3.D0
     #*t121*t139*s34r
      t785 = t771*l3*t29
      t791 = 5*t537
      t792 = t791*z
      t793 = t8*t5
      t794 = t793*s3l2p
      t804 = t177**2
      t812 = -2560.D0/3.D0*t247*t540*t804-2560.D0/3.D0*t129*t176*t238+25
     #60.D0/3.D0*t604*t117*t177
      t815 = t236*t185*t8
      t823 = z*t3
      t825 = t29*s4l2p
      t826 = t825*t5
      s2 = 1024.D0/3.D0*t520*t10*t521+((512.D0/3.D0*t526-4096.D0/3.D0*t5
     #28-512*t530)*s23r+512*t534*t26+(256.D0/3.D0*t539*t541+256.D0/3.D0*
     #t546)*s34r-256.D0/3.D0*t552*t101)*t110
      s3 = s2+((-1024.D0/3.D0*t526+3584.D0/3.D0*t528+2048.D0/3.D0*t530)*
     #t150+(t566*s2l2+(-256.D0/3.D0*t569*t541-256.D0/3.D0*t572*t545)*s34
     #r+256.D0/3.D0*t578*t10+256.D0/3.D0*t582*t250)*s23r+t595*s2l2+(7168
     #.D0/3.D0*t598+2816.D0/3.D0*t600)*t177+(5632.D0/3.D0*t605*t95*s3l2p
     #-256.D0/3.D0*t611*t106)*s34r-t617)*t14
      s1 = s3+((1024.D0/3.D0*t526-1024.D0/3.D0*t528-1024.D0/3.D0*t530)*t
     #622+(t626*s2l2+(512.D0/3.D0*t629*t541+256.D0/3.D0*t633*t545)*s34r-
     #256.D0/3.D0*t639*t101-256.D0/3.D0*t643*t250)*t150+(t656*s2l2+(-128
     #00.D0/3.D0*t598-9728.D0/3.D0*t600)*t177+(-256.D0/3.D0*t664*t101-51
     #2.D0/3.D0*t669*t250)*s34r-256.D0/3.D0*t675*t10-256.D0/3.D0*t679*t1
     #8)*s23r+t697*s2l2+(-2048*t700-5120.D0/3.D0*t702)*t238+(-256.D0/3.D
     #0*t709*t711+256.D0/3.D0*t715*t131)*t177+(-256.D0/3.D0*t722*t140-25
     #6.D0/3.D0*t727*t106)*s34r)*s1vr+(t736*s2l2+(1024.D0/3.D0*t738+1024
     #.D0/3.D0*t469*t545)*s34r-1024.D0/3.D0*t743-1024.D0/3.D0*t745)*t622
      t831 = s1+(t754*s2l2+(3584.D0/3.D0*t598+3584.D0/3.D0*t600)*t177+(5
     #12.D0/3.D0*t759*t101+512.D0/3.D0*t759*t250)*s34r-1024.D0/3.D0*t616
     #-1024.D0/3.D0*t766)*t150+(t779*s2l2+(5120.D0/3.D0*t700+5120.D0/3.D
     #0*t702)*t238+(512.D0/3.D0*t785*t199+512.D0/3.D0*t785*t131)*t177+(5
     #12.D0/3.D0*t792*t794+512.D0/3.D0*t792*t8*s4l2p*t5)*s34r)*s23r+t812
     #*s2l2+(2560.D0/3.D0*t815*t541+2560.D0/3.D0*t815*t545)*t804-t227*t2
     #38+(-2560.D0/3.D0*t823*t711-2560.D0/3.D0*t823*t826)*t177
      t836 = t525*t38
      t838 = t520*t40
      t840 = t520*t47
      t846 = t540*s3l1p
      t849 = t519*s4l1p*t5
      t850 = t543*t849
      t878 = t597*t326
      t880 = t597*t285
      t884 = t95*s3l1p
      t891 = t590*t40
      t892 = 256*t891
      t932 = t699*t317
      t934 = t699*t321
      t938 = t710*s3l1p
      t953 = t469*t846
      t958 = t104*t40
      t960 = t104*t47
      t975 = t590*t47
      t1006 = t29*s4l1p
      t1007 = t1006*t5
      s2 = -1024.D0/3.D0*t520*t40*t521+((-512.D0/3.D0*t836+4096.D0/3.D0*
     #t838+512*t840)*s23r-512*t534*t52+(-256.D0/3.D0*t539*t846-256.D0/3.
     #D0*t850)*s34r+256.D0/3.D0*t552*t266)*t110
      s3 = s2+((1024.D0/3.D0*t836-3584.D0/3.D0*t838-2048.D0/3.D0*t840)*t
     #150+(-t566*s2l1+(256.D0/3.D0*t569*t846+256.D0/3.D0*t572*t849)*s34r
     #-256.D0/3.D0*t578*t40-256.D0/3.D0*t582*t360)*s23r-t595*s2l1+(-7168
     #.D0/3.D0*t878-2816.D0/3.D0*t880)*t177+(-5632.D0/3.D0*t605*t884+256
     #.D0/3.D0*t611*t270)*s34r+t892)*t14
      s1 = s3+((-1024.D0/3.D0*t836+1024.D0/3.D0*t838+1024.D0/3.D0*t840)*
     #t622+(-t626*s2l1+(-512.D0/3.D0*t629*t846-256.D0/3.D0*t633*t849)*s3
     #4r+256.D0/3.D0*t639*t266+256.D0/3.D0*t643*t360)*t150+(-t656*s2l1+(
     #12800.D0/3.D0*t878+9728.D0/3.D0*t880)*t177+(256.D0/3.D0*t664*t266+
     #512.D0/3.D0*t669*t360)*s34r+256.D0/3.D0*t675*t40+256.D0/3.D0*t679*
     #t47)*s23r-t697*s2l1+(2048*t932+5120.D0/3.D0*t934)*t238+(256.D0/3.D
     #0*t709*t938-256.D0/3.D0*t715*t285)*t177+(256.D0/3.D0*t722*t290+256
     #.D0/3.D0*t727*t270)*s34r)*s1vr+(-t736*s2l1+(-1024.D0/3.D0*t953-102
     #4.D0/3.D0*t469*t849)*s34r+1024.D0/3.D0*t958+1024.D0/3.D0*t960)*t62
     #2
      t1012 = s1+(-t754*s2l1+(-3584.D0/3.D0*t878-3584.D0/3.D0*t880)*t177
     #+(-512.D0/3.D0*t759*t266-512.D0/3.D0*t759*t360)*s34r+1024.D0/3.D0*
     #t891+1024.D0/3.D0*t975)*t150+(-t779*s2l1+(-5120.D0/3.D0*t932-5120.
     #D0/3.D0*t934)*t238+(-512.D0/3.D0*t785*t326-512.D0/3.D0*t785*t285)*
     #t177+(2560.D0/3.D0*t604*t884+2560.D0/3.D0*t604*t270)*s34r)*s23r-t8
     #12*s2l1+(-2560.D0/3.D0*t815*t846-2560.D0/3.D0*t815*t849)*t804-t347
     #*t238+(2560.D0/3.D0*t823*t938+2560.D0/3.D0*t823*t1007)*t177
      t1029 = t29*t519
      t1041 = -t1**2
      t1055 = t537*t185*t519
      t1063 = (-8-z)*t8*l3
      t1081 = -t791*t29
      t1085 = 2*t29*t2
      t1092 = (9-6*z)*t1
      t1096 = (-t403+5)*t1
      t1113 = t597*t2
      t1121 = (3+t403)*l3*t8
      t1128 = t597*t3
      t1134 = (-1-t403)*t2*l3
      t1141 = 3*t1**2
      t1149 = t793*s3l1p
      t1160 = t3*t519*t246
      t1168 = (-9-t403)*t2*l3
      t1169 = t825*t40
      t1171 = t1006*t10
      t1177 = (z+3-t691)*t1
      t1196 = -t725*t2*l3
      t1200 = (-4+t403)*t2*t8
      t1216 = -1+t403
      t1218 = t1216*t2*l3
      t1224 = t1216*t8
      t1232 = t484*t3*l3
      t1239 = (-t480+6*t691+2)*t2
      t1242 = (-z-t691)*t2
      t1261 = l3*z*t185
      t1271 = (z-t691)*t2*t8
      s3 = (((-512.D0/3.D0*t7+512.D0/3.D0*t11)*t14+((1024.D0/3.D0*t7-512
     #.D0/3.D0*t11-512.D0/3.D0*t19)*s23r+512.D0/3.D0*t24*t26-512.D0/3.D0
     #*t30*t10*s34r)*s1vr)*s1l1+((512.D0/3.D0*t39-512.D0/3.D0*t41)*t14+(
     #(-1024.D0/3.D0*t39+512.D0/3.D0*t41+512.D0/3.D0*t48)*s23r-512.D0/3.
     #D0*t24*t52+512.D0/3.D0*t30*t40*s34r)*s1vr)*s1l2+((256.D0/3.D0*t11+
     #256*t19)*s2l1+(-256.D0/3.D0*t41-256*t48)*s2l2)*t14+(((512.D0/3.D0*
     #t11+512.D0/3.D0*t19)*s2l1+(-512.D0/3.D0*t41-512.D0/3.D0*t48)*s2l2)
     #*s23r+512.D0/3.D0*t80*s3l2p*s34r*s2l1-512.D0/3.D0*t80*s3l1p*s34r*s
     #2l2)*s1vr)*t92
      s7 = ((-512.D0/3.D0*t97+2560.D0/3.D0*t102+512.D0/3.D0*t107)*t110+(
     #(512*t97-3584.D0/3.D0*t102-t114)*s23r+t124*s2l2+(-2560*t127-3328.D
     #0/3.D0*t132)*s34r-256.D0/3.D0*t138*t140+512.D0/3.D0*t143)*t14+((-2
     #048.D0/3.D0*t97+512*t102+t114)*t150+(t157*s2l2+(6656.D0/3.D0*t127+
     #1536*t132)*s34r+256.D0/3.D0*t165*t140+256.D0/3.D0*t169*t171)*s23r+
     #t183*s2l2+(2560*t188+1792*t192)*t177+(256.D0/3.D0*t198*t199+256.D0
     #/3.D0*t203*t131)*s34r)*s1vr+(t213*s2l2+(-1024.D0/3.D0*t127-1024.D0
     #/3.D0*t132)*s34r+1024.D0/3.D0*t99*t10+1024.D0/3.D0*t143)*t150+(t22
     #4*s2l2+t227*t177+(2560.D0/3.D0*t126*t10+2560.D0/3.D0*t126*t18)*s34
     #r)*s23r+t244*s2l2+(-2560.D0/3.D0*t247*t101-2560.D0/3.D0*t247*t250)
     #*t238+(2560.D0/3.D0*t255*t10+2560.D0/3.D0*t255*t18)*t177)*s1l1
      s8 = ((512.D0/3.D0*t264-2560.D0/3.D0*t267-512.D0/3.D0*t271)*t110+(
     #(-512*t264+3584.D0/3.D0*t267+t277)*s23r-t124*s2l1+(2560*t282+3328.
     #D0/3.D0*t286)*s34r+256.D0/3.D0*t138*t290-512.D0/3.D0*t293)*t14+((2
     #048.D0/3.D0*t264-512*t267-t277)*t150+(-t157*s2l1+(-6656.D0/3.D0*t2
     #82-1536*t286)*s34r-256.D0/3.D0*t165*t290-256.D0/3.D0*t169*t310)*s2
     #3r-t183*s2l1+(-2560*t318-1792*t322)*t177+(-256.D0/3.D0*t198*t326-2
     #56.D0/3.D0*t203*t285)*s34r)*s1vr+(-t213*s2l1+(1024.D0/3.D0*t282+10
     #24.D0/3.D0*t286)*s34r-1024.D0/3.D0*t99*t40-1024.D0/3.D0*t293)*t150
     #+(-t224*s2l1+t347*t177+(-2560.D0/3.D0*t126*t40-2560.D0/3.D0*t126*t
     #47)*s34r)*s23r-t244*s2l1+(2560.D0/3.D0*t247*t266+2560.D0/3.D0*t247
     #*t360)*t238+(-2560.D0/3.D0*t255*t40-2560.D0/3.D0*t255*t47)*t177)*s
     #1l2
      s6 = s7+s8
      s7 = s6+((256.D0/3.D0*t373*t101+256.D0/3.D0*t107)*s2l1+(-256.D0/3.
     #D0*t373*t266-256.D0/3.D0*t271)*s2l2-512.D0/3.D0*t382*t383+512.D0/3
     #.D0*t382*t386)*t110
      s8 = s7
      s10 = ((1024.D0/3.D0*t391*s2l1+1024.D0/3.D0*t394*s2l2)*s23r+((-256
     #*t127-768*t132)*s34r-256.D0/3.D0*t405*t140-256.D0/3.D0*t408*t18)*s
     #2l1+((256*t282+768*t286)*s34r+256.D0/3.D0*t405*t290+256.D0/3.D0*t4
     #08*t47)*s2l2+256.D0/3.D0*t426*s34r+256.D0/3.D0*t431*t383-256.D0/3.
     #D0*t431*t386)*t14
      s11 = ((512.D0/3.D0*t391*s2l1+512.D0/3.D0*t394*s2l2)*t150+(((-512*
     #t127-512.D0/3.D0*t132)*s34r-256.D0/3.D0*t449*t140-256.D0/3.D0*t449
     #*t171)*s2l1+((512*t282+512.D0/3.D0*t286)*s34r+256.D0/3.D0*t449*t29
     #0+256.D0/3.D0*t449*t310)*s2l2-512.D0/3.D0*t426*s34r+512.D0/3.D0*t4
     #69*t383-512.D0/3.D0*t469*t386)*s23r+(256.D0/3.D0*t476*t10*t177+(-2
     #56.D0/3.D0*t482*t199-256.D0/3.D0*t485*t131)*s34r)*s2l1+(-256.D0/3.
     #D0*t476*t40*t177+(256.D0/3.D0*t482*t326+256.D0/3.D0*t485*t285)*s34
     #r)*s2l2+(256.D0/3.D0*t503*t383-256.D0/3.D0*t503*t386)*t177+(-256.D
     #0/3.D0*t509*t383+256.D0/3.D0*t509*t386)*s34r)*s1vr
      s9 = s10+s11
      s5 = s8+s9
      s6 = s13r
      s4 = s5*s6
      s2 = s3+s4
      s1 = s2+t831*s1l1+t1012*s1l2
      s2 = s1+(1024.D0/3.D0*t520*t10*s2l1-1024.D0/3.D0*t520*t40*s2l2)*t5
     #21
      s3 = s2+(((-768*t528-1280.D0/3.D0*t530)*s2l1+(768*t838+1280.D0/3.D
     #0*t840)*s2l2+512.D0/3.D0*t1029*t383-512.D0/3.D0*t1029*t386)*s23r+(
     #(-2048.D0/3.D0*t738-256.D0/3.D0*t546)*s34r-256.D0/3.D0*t1041*t101)
     #*s2l1+((2048.D0/3.D0*t953+256.D0/3.D0*t850)*s34r+256.D0/3.D0*t1041
     #*t266)*s2l2+(256.D0/3.D0*t1055*t383-256.D0/3.D0*t1055*t386)*s34r-2
     #56.D0/3.D0*t1063*t383+256.D0/3.D0*t1063*t386)*t110
      s4 = s3
      s6 = (((1280.D0/3.D0*t528+256*t530)*s2l1+(-1280.D0/3.D0*t838-256*t
     #840)*s2l2)*t150+(((512.D0/3.D0*t1081*t541+256.D0/3.D0*t1085*t545)*
     #s34r+256.D0/3.D0*t1092*t101+256.D0/3.D0*t1096*t250)*s2l1+((-512.D0
     #/3.D0*t1081*t846-256.D0/3.D0*t1085*t849)*s34r-256.D0/3.D0*t1092*t2
     #66-256.D0/3.D0*t1096*t360)*s2l2+(1024.D0/3.D0*t1113*t383-1024.D0/3
     #.D0*t1113*t386)*s34r-256.D0/3.D0*t1121*t383+256.D0/3.D0*t1121*t386
     #)*s23r+(-256.D0/3.D0*t1128*t18*t177+(256.D0/3.D0*t1134*t794+256.D0
     #/3.D0*t373*t250)*s34r-256.D0/3.D0*t1141*t10)*s2l1+(256.D0/3.D0*t11
     #28*t47*t177+(-256.D0/3.D0*t1134*t1149-256.D0/3.D0*t373*t360)*s34r+
     #256.D0/3.D0*t1141*t40)*s2l2+(256.D0/3.D0*t1160*t383-256.D0/3.D0*t1
     #160*t386)*t177+(256.D0/3.D0*t1168*t1169-256.D0/3.D0*t1168*t1171)*s
     #34r-256.D0/3.D0*t1177*t383+256.D0/3.D0*t1177*t386)*t14
      s7 = (((1280.D0/3.D0*t743+256*t745)*s2l1+(-1280.D0/3.D0*t958-256*t
     #960)*s2l2)*t150+(((256.D0/3.D0*t1196*t794+256.D0/3.D0*t1200*t250)*
     #s34r+t617+256*t766)*s2l1+((-256.D0/3.D0*t1196*t1149-256.D0/3.D0*t1
     #200*t360)*s34r-t892-256*t975)*s2l2+(512.D0/3.D0*t1218*t1169-512.D0
     #/3.D0*t1218*t1171)*s34r-512.D0/3.D0*t1224*t383+512.D0/3.D0*t1224*t
     #386)*s23r+((-256.D0/3.D0*t127+256.D0/3.D0*t1232*t826)*t177+(256.D0
     #/3.D0*t1239*t140+256.D0/3.D0*t1242*t171)*s34r)*s2l1+((256.D0/3.D0*
     #t282-256.D0/3.D0*t1232*t1007)*t177+(-256.D0/3.D0*t1239*t290-256.D0
     #/3.D0*t1242*t310)*s34r)*s2l2+(256.D0/3.D0*t1261*t130*t40-256.D0/3.
     #D0*t1261*t284*t10)*t177+(256.D0/3.D0*t1271*t383-256.D0/3.D0*t1271*
     #t386)*s34r)*s1vr
      s5 = s6+s7
      taux2 = s4+s5

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = -taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet2 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = 1-z
      t2 = l3*t1
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet4 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      ACnum1e3 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcoff4
      RETURN
      END

      double precision function ACnum1e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux1 = 0
      t1 = -1+z
      t2 = t1**2
      t3 = l3-1
      t4 = t3**2
      t5 = t2*t4
      t6 = 1/s3vr
      t7 = t6*s3l2p
      t9 = s4l2p*t6
      t14 = t6*s3l1p
      t16 = s4l1p*t6
      t22 = s1vr**2
      t24 = s13r**2
      t26 = t2*t1
      t27 = t26*t4
      t28 = l3*t6
      t29 = t28*s3l2p
      t30 = t27*t29
      t32 = l3*t26
      t33 = t4*s4l2p
      t34 = t33*t6
      t35 = t32*t34
      t39 = t2*t3
      t40 = t39*t7
      t41 = 512.D0/3.D0*t40
      t44 = -t30-t35
      t47 = t39*t9
      t51 = t4*t3
      t52 = t51*t6
      t53 = s34r**2
      t56 = t6*s34r
      t58 = t32*t52*t53-t5*t56
      t59 = 512.D0/3.D0*t58
      t61 = t2**2
      t62 = l3*t61
      t63 = t52*s3l2p
      t64 = t62*t63
      t67 = t51*s4l2p*t6
      t68 = t62*t67
      t73 = 3*t2*t1
      t74 = t4*t6
      t75 = t74*s3l2p
      t77 = 2*t1
      t78 = t77*t2
      t86 = -1024.D0/3.D0*t58
      t89 = 1024.D0/3.D0*t64+1024.D0/3.D0*t68
      t92 = t27*t9
      t98 = t4**2
      t100 = t53*s34r
      t107 = -1024.D0/3.D0*t61*t98*t28*t100+1024.D0/3.D0*t26*t51*t6*t53
      t109 = t61*t1
      t110 = t109*t98
      t113 = l3*s4l2p*t6
      t118 = t61*t51
      t126 = t28*s3l1p
      t127 = t27*t126
      t129 = t4*s4l1p
      t130 = t129*t6
      t131 = t32*t130
      t135 = t39*t14
      t136 = 512.D0/3.D0*t135
      t139 = t127+t131
      t142 = t39*t16
      t148 = t52*s3l1p
      t149 = t62*t148
      t152 = t51*s4l1p*t6
      t153 = t62*t152
      t157 = t74*s3l1p
      t168 = -1024.D0/3.D0*t149-1024.D0/3.D0*t153
      t171 = t27*t16
      t181 = l3*s4l1p*t6
      t194 = l3*t2
      t196 = t3*s4l2p*t6
      t197 = t194*t196
      t198 = t39*t29+t197
      t203 = t3*s4l1p*t6
      t204 = t194*t203
      t205 = -t39*t126-t204
      t209 = t22*s1vr
      t221 = t3*t1
      t236 = t62*t4
      t237 = t9*s3l1p
      t239 = t16*s3l2p
      t244 = z*t2
      t245 = t244*t3
      t260 = t62*t51
      t280 = l3*t109*t51
      t286 = t61*t4
      t296 = t3*t26
      t297 = l3**2
      t298 = t297*t6
      t299 = t298*s3l2p
      t300 = t296*t299
      t303 = t297*s4l2p*t6
      t304 = t296*t303
      t308 = t194*t7
      t309 = 512.D0/3.D0*t308
      t316 = t77*t1
      t319 = t194*t9
      t320 = 512.D0/3.D0*t319
      t323 = t297*t61
      t324 = t323*t75
      t326 = t323*t34
      t330 = 2*z
      t333 = (-4+t330)*t3*t2
      t338 = z*t1
      t340 = 512.D0/3.D0*t338*t7
      t345 = (1024.D0/3.D0*t300+1024.D0/3.D0*t304)*s34r
      t347 = s23r**2
      t350 = t27*t298*t53
      t353 = t28*s34r
      t356 = -1024.D0/3.D0*t350+512.D0/3.D0*t316*t3*t353
      t365 = (-6+4*z)*t3*t2
      t368 = -2+z
      t370 = t368*t3*t2
      t376 = 512.D0/3.D0*t338*t9
      t380 = t118*t298*t100
      t382 = t368*t2
      t385 = t382*t4*t28*t53
      t387 = z**2
      t388 = -z+t387
      t389 = t388*t3
      t392 = -1024.D0/3.D0*t380+512.D0/3.D0*t385+512.D0/3.D0*t389*t56
      t394 = t297*t109
      t395 = t394*t63
      t397 = t394*t67
      t403 = (-5+z)*t4*l3
      t404 = t26*t6
      t405 = t404*s3l2p
      t412 = 3*t388*t3
      t413 = t1*t6
      t414 = t413*s3l2p
      t416 = t77*z
      t426 = 1024.D0/3.D0*t350-1024.D0/3.D0*t39*t353
      t440 = z*t3
      t444 = 2048.D0/3.D0*t380-1024.D0/3.D0*t385-1024.D0/3.D0*t440*t413*
     #s34r
      t450 = t368*l3*t26
      t456 = t2*t6
      t457 = t456*s3l2p
      t460 = t2*s4l2p*t6
      t467 = t53**2
      t475 = 1024.D0/3.D0*t110*t298*t467+1024.D0/3.D0*t32*t52*t100-1024.
     #D0/3.D0*t244*t74*t53
      t478 = t98*t61*t2
      t486 = z*t4
      t488 = t26*s4l2p
      t496 = t298*s3l1p
      t497 = t296*t496
      t500 = t297*s4l1p*t6
      t501 = t296*t500
      t505 = t194*t14
      t506 = 512.D0/3.D0*t505
      t515 = t194*t16
      t516 = 512.D0/3.D0*t515
      t519 = t323*t157
      t521 = t323*t130
      t530 = 512.D0/3.D0*t338*t14
      t535 = (-1024.D0/3.D0*t497-1024.D0/3.D0*t501)*s34r
      t551 = 512.D0/3.D0*t338*t16
      t556 = t394*t148
      t558 = t394*t152
      t562 = t404*s3l1p
      t568 = t413*s3l1p
      t572 = t1*s4l1p*t6
      t597 = t368*t4*l3
      t599 = t26*s4l1p
      t600 = t599*t6
      t630 = t297*t2
      t634 = -512.D0/3.D0*t630*t7-512.D0/3.D0*t630*t9
      t639 = 512.D0/3.D0*t630*t14+512.D0/3.D0*t630*t16
      t643 = t296*t297
      t654 = t323*t3
      t660 = t382*l3
      t673 = t1*l3
      t692 = t323*t4
      t698 = (-1+t330)*t3*l3
      t709 = t456*s3l1p
      t718 = t4*t297*t109
      t726 = (-3+t330)*t3*l3
      t735 = (-z+1+t387)*t1
      t751 = t77*t3*l3
      t775 = 2*t388*t3
      t797 = l3*z*t61
      t805 = t389*t2
      s2 = ((512.D0/3.D0*t5*t7+512.D0/3.D0*t5*t9)*s2l1+(-512.D0/3.D0*t5*
     #t14-512.D0/3.D0*t5*t16)*s2l2)*t22*t24
      s7 = (((1024.D0/3.D0*t30+512.D0/3.D0*t35)*s34r-t41)*t22+((1024.D0/
     #3.D0*t44*s34r+t41+512.D0/3.D0*t47)*s23r+t59*s2l2+(-2048.D0/3.D0*t6
     #4-512*t68)*t53+(512.D0/3.D0*t73*t75+512.D0/3.D0*t78*t34)*s34r)*s1v
     #r+(t86*s2l2+t89*t53+(-1024.D0/3.D0*t27*t7-1024.D0/3.D0*t92)*s34r)*
     #s23r+t107*s2l2+(1024.D0/3.D0*t110*t29+1024.D0/3.D0*t110*t113)*t100
     #+(-1024.D0/3.D0*t118*t7-1024.D0/3.D0*t118*t9)*t53)*s1l1
      s8 = (((-1024.D0/3.D0*t127-512.D0/3.D0*t131)*s34r+t136)*t22+((1024
     #.D0/3.D0*t139*s34r-t136-512.D0/3.D0*t142)*s23r-t59*s2l1+(2048.D0/3
     #.D0*t149+512*t153)*t53+(-512.D0/3.D0*t73*t157-512.D0/3.D0*t78*t130
     #)*s34r)*s1vr+(-t86*s2l1+t168*t53+(1024.D0/3.D0*t27*t14+1024.D0/3.D
     #0*t171)*s34r)*s23r-t107*s2l1+(-1024.D0/3.D0*t110*t126-1024.D0/3.D0
     #*t110*t181)*t100+(1024.D0/3.D0*t118*t14+1024.D0/3.D0*t118*t16)*t53
     #)*s1l2
      s6 = s7+s8
      s5 = s6+(512.D0/3.D0*t198*s2l1+512.D0/3.D0*t205*s2l2)*t209+((-1024
     #.D0/3.D0*t198*s2l1-1024.D0/3.D0*t205*s2l2)*s23r+(512*t44*s34r-512.
     #D0/3.D0*t221*t7-512.D0/3.D0*t221*t9)*s2l1+(512*t139*s34r+512.D0/3.
     #D0*t221*t14+512.D0/3.D0*t221*t16)*s2l2+(-512.D0/3.D0*t236*t237+512
     #.D0/3.D0*t236*t239)*s34r+512.D0/3.D0*t245*t237-512.D0/3.D0*t245*t2
     #39)*t22+(((-512.D0/3.D0*t40-512.D0/3.D0*t47)*s2l1+(512.D0/3.D0*t13
     #5+512.D0/3.D0*t142)*s2l2)*s23r+(512.D0/3.D0*t260*t7*t53+(-512.D0/3
     #.D0*t78*t75-512.D0/3.D0*t92)*s34r)*s2l1+(-512.D0/3.D0*t260*t14*t53
     #+(512.D0/3.D0*t78*t157+512.D0/3.D0*t171)*s34r)*s2l2+(512.D0/3.D0*t
     #280*t237-512.D0/3.D0*t280*t239)*t53+(-512.D0/3.D0*t286*t237+512.D0
     #/3.D0*t286*t239)*s34r)*s1vr
      s6 = s13r
      s4 = s5*s6
      s7 = ((1024.D0/3.D0*t300+512.D0/3.D0*t304)*s34r-t309)*t209+(((-204
     #8.D0/3.D0*t300-512*t304)*s34r+512.D0/3.D0*t316*t29+t320)*s23r+(-10
     #24*t324-512*t326)*t53+(512.D0/3.D0*t333*t29-512.D0/3.D0*t197)*s34r
     #+t340)*t22+((t345-t309-t320)*t347+(t356*s2l2+(4096.D0/3.D0*t324+10
     #24*t326)*t53+(-512.D0/3.D0*t365*t29-1024.D0/3.D0*t370*t113)*s34r-t
     #340-t376)*s23r+t392*s2l2+(1024*t395+2048.D0/3.D0*t397)*t100+(-512.
     #D0/3.D0*t403*t405+512*t35)*t53+(-512.D0/3.D0*t412*t414-512.D0/3.D0
     #*t416*t1*t196)*s34r)*s1vr+(t426*s2l2+(-1024.D0/3.D0*t324-1024.D0/3
     #.D0*t326)*t53+(1024.D0/3.D0*t296*t29+1024.D0/3.D0*t296*t113)*s34r)
     #*t347
      s6 = s7+(t444*s2l2+(-2048.D0/3.D0*t395-2048.D0/3.D0*t397)*t100+(10
     #24.D0/3.D0*t450*t75+1024.D0/3.D0*t450*t34)*t53+(1024.D0/3.D0*t440*
     #t457+1024.D0/3.D0*t440*t460)*s34r)*s23r+t475*s2l2+(-1024.D0/3.D0*t
     #478*t299-1024.D0/3.D0*t478*t303)*t467-t89*t100+(1024.D0/3.D0*t486*
     #t405+1024.D0/3.D0*t486*t488*t6)*t53
      s7 = s1l1
      s5 = s6*s7
      s3 = s4+s5
      s1 = s2+s3
      s3 = s1
      s6 = ((-1024.D0/3.D0*t497-512.D0/3.D0*t501)*s34r+t506)*t209+(((204
     #8.D0/3.D0*t497+512*t501)*s34r-512.D0/3.D0*t316*t126-t516)*s23r+(10
     #24*t519+512*t521)*t53+(-512.D0/3.D0*t333*t126+512.D0/3.D0*t204)*s3
     #4r-t530)*t22+((t535+t506+t516)*t347+(-t356*s2l1+(-4096.D0/3.D0*t51
     #9-1024*t521)*t53+(512.D0/3.D0*t365*t126+1024.D0/3.D0*t370*t181)*s3
     #4r+t530+t551)*s23r-t392*s2l1+(-1024*t556-2048.D0/3.D0*t558)*t100+(
     #512.D0/3.D0*t403*t562-512*t131)*t53+(512.D0/3.D0*t412*t568+512.D0/
     #3.D0*t416*t3*t572)*s34r)*s1vr+(-t426*s2l1+(1024.D0/3.D0*t519+1024.
     #D0/3.D0*t521)*t53+(-1024.D0/3.D0*t296*t126-1024.D0/3.D0*t296*t181)
     #*s34r)*t347
      s5 = s6+(-t444*s2l1+(2048.D0/3.D0*t556+2048.D0/3.D0*t558)*t100+(-1
     #024.D0/3.D0*t597*t562-1024.D0/3.D0*t597*t600)*t53+(-1024.D0/3.D0*t
     #244*t3*t6*s3l1p-1024.D0/3.D0*t244*t203)*s34r)*s23r-t475*s2l1+(1024
     #.D0/3.D0*t478*t496+1024.D0/3.D0*t478*t500)*t467-t168*t100+(-1024.D
     #0/3.D0*t486*t562-1024.D0/3.D0*t486*t600)*t53
      s6 = s1l2
      s4 = s5*s6
      s2 = s3+s4
      s3 = s2+((t634*s2l1+t639*s2l2)*s23r+(-512.D0/3.D0*t643*t9*s34r-512
     #.D0/3.D0*t308)*s2l1+(512.D0/3.D0*t643*t16*s34r+512.D0/3.D0*t505)*s
     #2l2+(512.D0/3.D0*t654*t237-512.D0/3.D0*t654*t239)*s34r-512.D0/3.D0
     #*t660*t237+512.D0/3.D0*t660*t239)*t209
      s4 = s3
      s6 = ((-t634*s2l1-t639*s2l2)*t347+((t345+512.D0/3.D0*t673*t7+512.D
     #0/3.D0*t673*t9)*s2l1+(t535-512.D0/3.D0*t673*t14-512.D0/3.D0*t673*t
     #16)*s2l2-512.D0/3.D0*t194*t237+512.D0/3.D0*t194*t239)*s23r+(512.D0
     #/3.D0*t692*t9*t53+(512.D0/3.D0*t698*t457+512.D0/3.D0*t197)*s34r-51
     #2.D0/3.D0*t457)*s2l1+(-512.D0/3.D0*t692*t16*t53+(-512.D0/3.D0*t698
     #*t709-512.D0/3.D0*t204)*s34r+512.D0/3.D0*t709)*s2l2+(-512.D0/3.D0*
     #t718*t237+512.D0/3.D0*t718*t239)*t53+(512.D0/3.D0*t726*t488*t14-51
     #2.D0/3.D0*t726*t599*t7)*s34r-512.D0/3.D0*t735*t237+512.D0/3.D0*t73
     #5*t239)*t22
      s7 = (((512.D0/3.D0*t308+512.D0/3.D0*t319)*s2l1+(-512.D0/3.D0*t505
     #-512.D0/3.D0*t515)*s2l2)*t347+(((512.D0/3.D0*t751*t457+512.D0/3.D0
     #*t751*t460)*s34r+t340+t376)*s2l1+((-512.D0/3.D0*t751*t709-512.D0/3
     #.D0*t751*t2*s4l1p*t6)*s34r-t530-t551)*s2l2)*s23r+((-512.D0/3.D0*t3
     #0+512.D0/3.D0*t286*t113)*t53+(512.D0/3.D0*t775*t414+512.D0/3.D0*t3
     #89*t1*s4l2p*t6)*s34r)*s2l1+((512.D0/3.D0*t127-512.D0/3.D0*t286*t18
     #1)*t53+(-512.D0/3.D0*t775*t568-512.D0/3.D0*t389*t572)*s34r)*s2l2+(
     #-512.D0/3.D0*t797*t33*t14+512.D0/3.D0*t797*t129*t7)*t53+(512.D0/3.
     #D0*t805*t237-512.D0/3.D0*t805*t239)*s34r)*s1vr
      s5 = s6+s7
      taux2 = s4+s5

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = -taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet2 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t1 = 1-z
      t2 = t1*l3
      t3 = t2*s1vr
      t4 = t2*s23r
      t5 = -l3+1
      t7 = t1**2
      t9 = l3*t5*t7*s34r
      t12 = t5*t1*s13r
      tFjet4 = Fjet(var,ndim,z,ux,t3-t4-t9,-1-t12-t3+z,t4,t12,t9,-1+z-t3
     #+t9,t3,1+t12+t4,-t12-t4-t9+z,s2l1,s1l1,s4l1,s3l1,s2l2,s1l2,s4l2,s3
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      ACnum1e4 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcoff4
      RETURN
      END

