CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCC Numerator functions CCCCCCCCCCCCCCCCCCCCCCCCCC

      double precision function A2num1e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = -1+z
      t5 = t4**2
      t6 = t5**2
      t7 = t3*t6
      t8 = z*l3
      t10 = l1**2
      t11 = r**2
      t13 = 1+t11
      t14 = t13**2
      t15 = r+t
      t16 = t15**2
      t19 = r*t
      t20 = 1+t19
      t21 = t20**2
      t23 = t14/t16/t21
      t24 = t10*t11*t23
      t27 = t8*s34r
      t29 = t5*t4
      t30 = t29*z
      t31 = 2*l3
      t32 = t31-1
      t33 = t32*t2
      t39 = 1/t15
      t41 = 1/t20
      t42 = t13*t39*t41
      t47 = t5*z
      t51 = s13r**2
      t53 = l3*t29
      t58 = t1*t5
      t62 = t58*t8
      t77 = l3*t4
      t80 = t77*z
      t81 = 256*t80
      t85 = t58*l3*s34r
      t86 = t4*t1
      t92 = l3**2
      t93 = t92*z
      t94 = t6*t4
      t97 = t10*l1
      t98 = t11*r
      t106 = t14*t13/t16/t15/t21/t20
      t110 = s2l1**2
      t117 = z*t2
      t122 = t92*t94
      t123 = z*t3
      t128 = t53*t117*s3l1
      t130 = 3*t8
      t131 = 3*l3
      t140 = t58*l3
      t141 = z*s2l1
      t142 = t141*s23r
      t151 = 512*t62
      t155 = 2*t8
      t162 = 4*l3
      t168 = 3*t93
      t169 = 3*t92
      t182 = t77*s3l1
      t188 = 256*t58*t8*s3l1
      t189 = t8-l3+1
      t195 = t4*z
      t198 = 256*t195*t32*s3l1
      t204 = t92*t1
      t208 = t92*t2
      t210 = t208*t6*s34r
      t212 = 128*t62
      t217 = t92*t5
      t218 = s23r**2
      t222 = t204*t29*s34r
      t226 = s34r**2
      t230 = 3*z
      t237 = t32*t4*z
      t243 = t217*s34r
      t255 = t226*s34r
      t268 = s1l1**2
      t270 = t6*s3l1
      t271 = t208*t270
      t272 = 256*t271
      t273 = t2*t6
      t274 = t273*t93
      t276 = -t272+128*t274
      t284 = t204*t29*s3l1
      t286 = t1*z
      t287 = t92*t29
      t288 = t286*t287
      t293 = 384*t274
      t296 = -t131+t130+2-z
      t298 = t5*l3
      t299 = t298*s3l1
      t302 = 2*z
      t304 = (-t131+t130+1-t302)*t1
      t305 = t298*z
      t315 = t32*l3
      t330 = 4*t8
      t336 = 6*t8
      t337 = 6*l3
      t338 = 4*z
      t345 = -t169+t168-1+t162-t155
      t349 = -t169+t168+z-t330+t31
      t401 = t8-z-l3
      t402 = t401*z
      t406 = t6*t5
      t407 = t3*t406
      t408 = t92*l3
      t409 = t408*z
      t411 = t10**2
      t412 = t11**2
      t414 = t14**2
      t415 = t16**2
      t418 = t21**2
      t424 = t94*t408
      t430 = t409*s34r
      t434 = s3l1**2
      t436 = t92*t6*t2*t434
      t445 = t1*t6
      t476 = t408*t406
      t493 = 24*t8
      t494 = z**2
      t495 = t494*l3
      t497 = 12*t92
      t498 = 24*t93
      t499 = t92*t494
      t500 = 12*t499
      t521 = t286*t92
      t537 = l3*(t155-t31-z)
      t560 = t273*t92
      t586 = 4*t92
      t612 = 2*t92
      t618 = z*s3l1
      t620 = 256*t77*t618
      t667 = -z-12*t93-l3+8*t409-4*t408*t494-5*t495+8*t499+t586+t494-4*t
     #408+t330
      t690 = 1+u
      t691 = t690**2
      t692 = 1/t691
      t694 = t98*l2
      t695 = dsqrt(l1)
      t696 = t695*t10
      t697 = t**2
      t698 = t697*t
      t699 = t696*t698
      t701 = t412*r
      t702 = t701*l2
      t703 = t695*l1
      t704 = t703*t
      t708 = t695*l2
      t711 = t701*t698
      t712 = t703*l2
      t715 = t696*t
      t718 = t412*l2
      t719 = t703*t697
      t722 = t696*t697
      t725 = t98*t
      t728 = t98*t698
      t733 = t11*l2
      t739 = -t694*t699+3*t702*t704+2*t701*t*t708+2*t711*t712-2*t702*t71
     #5-2*t718*t719+3*t718*t722+5*t725*t708+2*t728*t712-3*t694*t715-2*t7
     #33*t719+2*t733*t722+t733*t696
      t746 = t11*l1
      t749 = l1*r
      t755 = dsqrt(-l2*(1-l1)*(l2-1)*t14*r*(t11*t+t746*t+r+r*t697-t749-t
     #749*t697+t+l1*t))
      t756 = r*t755
      t759 = t11*t695
      t764 = t412*t98
      t767 = t11*t703
      t769 = t412*t11
      t770 = t769*t695
      t773 = t412*t695
      t776 = t769*t703
      t782 = t412*t703
      t785 = t11*t755
      t791 = 2*t756*t+3*t759*l2-2*t746*t755-t764*t703*t-t767*l2+2*t770*l
     #2+5*t773*l2-t776*l2+t718*t696-2*t701*t703*t-3*t782*l2-4*t785*l4-2*
     #t98*t695*t
      t803 = l1*t755
      t808 = -r*t695*t-t701*t695*t-t98*t703*t-t759+t712-t770+t776+t767+2
     #*t782-2*t773+3*t19*t708+2*t725*t803+t764*l2*t704
      t823 = r*l2
      t832 = 4*t746*t755*l4-4*t756*l4*t-t769*t697*t708-t702*t699-t711*t7
     #08-t728*t708-t412*t697*t708+t694*t704-t823*t704-t823*t715+t769*l2*
     #t722+2*t785-4*t725*t803*l4
      t834 = t739+t791+t808+t832
      t835 = t834**2
      t837 = t11+t19+l1-t749*t
      t838 = t837**2
      t853 = 1-l1*l3*r*t4*t690*t39*t41
      t855 = s34spinc(z,l1,l2,l3,l4,l5,l6,l7,l8)
      t862 = t853**2
      t863 = t855**2
      t870 = (-128*t77*t401*s34r+128*z)*t110+((-256*t77*t401*s3l1+128*t8
     #0)*s34r-256*t401*s3l1+128*t189*z)*s2l1+64*t560*t402*t255+64*t8*t29
     #*t1*(t168-t169-5*t8+l3+t302)*t226+(-256*t77*t401*t434+t620-64*t195
     #*t667)*s34r+(-512*t8+512*l3+256*z)*t434+256*t618+64*(2*t499+t612-4
     #*t93-2*t495-t31+t330+t494+1)*z+128*(-t494-2*t141-2*t110)/r*t39*t41
     #*t692*t835/t838+256*(2*s2l1+z)*t853*t855*t692*t834/t837-256*t862*t
     #863*r*t15*t20*t692
      s3 = (128*t7*t8*t24+(-128*t7*t27-128*t30*t33)*l1*r*t42+128*t2*t29*
     #t27+128*t47*t2)*t51
      s4 = ((-256*t53*t2*s2l1*t24+((512*t58*l3*s2l1+256*t62)*s23r+(256*t
     #53*t2*s34r+256*t5*t32*t1)*s2l1)*l1*r*t42+(-512*t77*s2l1-t81)*s23r+
     #(-256*t85-256*t86)*s2l1)*s1l1-128*t93*t94*t3*t97*t98*t106+(256*t53
     #*t2*t110+(512*t53*t2*s3l1+256*t53*t117)*s2l1+128*t122*t123*s34r+51
     #2*t128-128*t53*t117*(-t130+t131-2))*t10*t11*t23+(256*t140*t142-512
     #*t58*l3*t110+(-1024*t58*l3*s3l1-t151)*s2l1+(-256*t128-128*t53*t117
     #*(t155-t31+1))*s34r-256*t47*(t162-1)*t1*s3l1+128*t47*t1*(-t168+t16
     #9-t162+1))*l1*r*t42-256*t77*t142+256*t77*t110+(512*t182+t81)*s2l1+
     #(t188+128*t58*t8*t189)*s34r+t198-128*t195*(-t93+1-t31+t92))*s13r
      s2 = s3+s4
      s3 = s2+((-256*t204*t29*s23r-128*t210+t212)*t10*t11*t23+(512*t217*
     #t218+(512*t222+512*t140)*s23r+256*t208*t6*t226+128*t58*l3*(t155-t3
     #1+2-t230)*s34r-128*t237)*l1*r*t42+(-256*t243-512*t77)*t218+(-256*t
     #204*t29*t226-512*t85-256*t86)*s23r-128*t208*t6*t255-256*t53*t2*t22
     #6-128*t4*(-t130+t93+z-t92-1+t31)*s34r+128*z)*t268
      s4 = s3
      s6 = (t276*t97*t98*t106+((256*t204*t29*s2l1+1024*t284-256*t288)*s2
     #3r+(512*t271-t293)*s34r+256*t296*t1*t299-128*t304*t305)*t10*t11*t2
     #3+(512*t93*t5*t218+((-256*t222-256*t315*t5)*s2l1+(-512*t284+512*t2
     #88)*s34r-1024*t315*t5*s3l1+t151)*s23r+(-t272+t293)*t226+(-256*t58*
     #l3*(t330-t162+2-z)*s3l1-128*t58*t8*(-t336+t337+t338-3))*s34r-256*t
     #345*t4*s3l1+128*t349*z*t4)*l1*r*t42+(-256*t93*t5*s34r-512*t80)*t21
     #8+((256*t243+256*t77)*s2l1-256*t204*t30*t226+(512*t217*s3l1-512*t6
     #2)*s34r+1024*t182-256*t195*t1)*s23r-128*t208*t6*z*t255+(256*t284+1
     #28*t8*t29*t1*(-t131+2))*t226+(256*t77*(t155-z-t31+2)*s3l1+128*t195
     #*(-t168+t330-z+t169-t131+1))*s34r+256*t189*s3l1-128*t402)*s1l1
      s7 = 128*t407*t409*t411*t412*t414/t415/t418
      s5 = s6+s7
      s1 = s4+s5
      s2 = s1+(-128*t117*t424*s23r-t276*s2l1-256*t407*t430+512*t436-256*
     #t33*t122*z)*t97*t98*t106+(128*t445*t409*t218+(256*t424*t117*s34r+2
     #56*t286*t287*s3l1+128*(-t230+1-t131+t130)*t1*t93*t29)*s23r+(-128*t
     #210+128*t62)*t110+(-256*t208*t270*s34r-256*t304*t299+128*t296*t1*t
     #305)*s2l1+192*t476*t123*t226+(-256*t436-128*t273*t93*(-t336+t337+t
     #338-2))*s34r-256*(-t337+t336-t230+2)*t1*t298*t434+t188+64*(-12*l3+
     #t493-12*t495+t497-t498+t500-t338+3*t494+3)*t1*t305)*t10*t11*t23
      s3 = s2+((-128*t445*t430-128*(-t31+t155+1-t230)*z*t217)*t218+(-128
     #*t2*t94*t409*t226+128*t521*t29*(-t330+t162+t338-1)*s34r-256*t32*z*
     #t299-128*(t230-t169+t168-t336+t31)*z*t298)*s23r+(128*t58*t537*s34r
     #-128*t237)*t110+((256*t58*t537*s3l1-t212)*s34r+256*t349*t4*s3l1-12
     #8*t345*z*t4)*s2l1-64*t476*t123*t255-64*t560*z*(t336-t337-5*z+1)*t2
     #26+(256*t58*t537*t434-t188+64*t58*t8*(-t497+t498-t500+16*t495-t493
     #+8*l3-5*t494+t338-1))*s34r+256*(-6*t92+6*t93+z-t336+t162)*t4*t434-
     #t198-64*t32*(4*t499+t586-8*t93-4*t495-t162+8*t8+t494+1)*t195)*l1*r
     #*t42
      taux1 = s3+(128*t93*t5*t401*s34r+128*(-l3+t8-t302)*l3*t195)*t218+(
     #128*t521*t29*t401*t226-128*t8*t5*(-2*t93+t612-l3+t330-t302)*s34r+t
     #620+128*(-t92+t93-t155+z)*z*t4)*s23r+t870
      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = -1+z
      t5 = t4**2
      t6 = t5**2
      t7 = t3*t6
      t8 = z*l3
      t10 = l1**2
      t11 = r**2
      t13 = 1+t11
      t14 = t13**2
      t15 = r+t
      t16 = t15**2
      t19 = r*t
      t20 = 1+t19
      t21 = t20**2
      t23 = t14/t16/t21
      t27 = t8*s34r
      t29 = t5*t4
      t30 = t29*z
      t31 = 2*l3
      t32 = t31-1
      t39 = 1/t15
      t41 = 1/t20
      t42 = t13*t39*t41
      t45 = t2*t29*t27
      t47 = t5*z
      t51 = s13r**2
      t53 = t1*t5
      t56 = l1*r
      t59 = l3*t4
      t65 = l3**2
      t66 = t65*z
      t67 = t6*t4
      t70 = t10*l1
      t71 = t11*r
      t79 = t14*t13/t16/t15/t21/t20
      t80 = t70*t71*t79
      t83 = l3*t29
      t84 = z*t2
      t89 = z*t3
      t94 = t83*t84*s3l1
      t96 = 3*t8
      t97 = 3*l3
      t108 = z*s2l1*s23r
      t112 = 8*t8
      t113 = 2*z
      t114 = -t112+t113
      t120 = 2*t8
      t131 = 3*t66
      t132 = 3*t65
      t133 = 4*l3
      t144 = t53*t27
      t146 = -t4
      t147 = 4*t8
      t148 = -t147+t113
      t166 = t4*z
      t172 = t2*t6
      t176 = t1*z
      t177 = t65*t29
      t181 = t66*s34r
      t184 = z**2
      t185 = t184*l3
      t186 = 6*t185
      t187 = 6*t8
      t191 = t5*l3
      t198 = s23r**2
      t203 = -t1*t29
      t206 = 6*z
      t213 = s34r**2
      t218 = 12*t8
      t225 = 6*t66
      t227 = 6*t65*t184
      t228 = 2*t184
      t229 = 8*t185
      t248 = 4*z
      t249 = t187-t248
      t258 = t6*z
      t259 = t213*s34r
      t275 = -512*t172*t66*t80+(2048*t176*t177*s23r+1536*t172*t181+256*(
     #t186-t187-4*t184+t113)*t1*t191)*t10*t11*t23+(-2048*t66*t5*t198+(30
     #72*t203*t181+512*(t206-t112)*l3*t5)*s23r-1536*t172*t66*t213+256*t5
     #3*l3*(-t206-12*t185+t218+8*t184)*s34r+256*(t225-t227-t228+t229-t14
     #7)*t4)*l1*r*t42+(1024*t66*t5*s34r+2048*t59*z)*t198+(1024*t65*t1*t3
     #0*t213+512*t191*t249*s34r-512*t148*t4)*s23r+512*t65*t2*t258*t259+2
     #56*t83*t1*t249*t213+256*t146*(t229-t227+t113+t225-t187-t228)*s34r-
     #512*t8+512*t185-512*t184
      t277 = t65*l3
      t278 = t67*t277
      t283 = t6*t5
      t285 = t277*z
      t286 = t285*s34r
      t288 = z+1
      t297 = t1*t6
      t307 = 3*z
      t320 = t277*t283
      t324 = t172*t65
      t325 = t8-z-l3
      t333 = t30*l3
      t375 = 6*l3
      t376 = 5*z
      t382 = 6*t65
      t435 = 5*t8
      t457 = 1+u
      t458 = t457**2
      t459 = 1/t458
      t461 = t11**2
      t462 = dsqrt(l1)
      t463 = t462*l1
      t464 = t461*t463
      t466 = t71*t
      t473 = t11*l1
      t475 = t**2
      t482 = dsqrt(-l2*(1-l1)*(l2-1)*t14*r*(t11*t+t473*t+r+r*t475-t56-t5
     #6*t475+t+l1*t))
      t483 = l1*t482
      t487 = t71*l2
      t488 = t462*t10
      t489 = t475*t
      t490 = t488*t489
      t492 = t461*r
      t493 = t492*l2
      t494 = t463*t
      t498 = t462*l2
      t501 = t492*t489
      t502 = t463*l2
      t505 = t488*t
      t508 = t461*l2
      t509 = t463*t475
      t512 = t488*t475
      t517 = t71*t489
      t524 = 2*t464-4*t466*t483*l4-t487*t490+3*t493*t494+2*t492*t*t498+2
     #*t501*t502-2*t493*t505-2*t508*t509+3*t508*t512+5*t466*t498+2*t517*
     #t502-3*t487*t505-r*t462*t
      t529 = t11*l2
      t531 = r*t482
      t534 = t11*t462
      t539 = t461*t71
      t542 = t11*t463
      t544 = t461*t11
      t545 = t544*t462
      t548 = t461*t462
      t551 = t544*t463
      t557 = -t492*t462*t-t71*t463*t+t529*t488+2*t531*t+3*t534*l2-2*t473
     #*t482-t539*t463*t-t542*l2+2*t545*l2+5*t548*l2-t551*l2+t508*t488-2*
     #t492*t463*t
      t561 = t11*t482
      t567 = r*l2
      t587 = -3*t464*l2-4*t561*l4-2*t71*t462*t-t567*t494-t567*t505+t544*
     #l2*t512+3*t19*t498+2*t466*t483+t539*l2*t494+4*t473*t482*l4-4*t531*
     #l4*t-t544*t475*t498-t493*t490
      t599 = -t501*t498-t517*t498-t461*t475*t498+t487*t494+2*t561-t534+t
     #502-t545+t551+t542-2*t529*t509+2*t529*t512-2*t548
      t601 = t524+t557+t587+t599
      t602 = t601**2
      t604 = t11+t19+l1-t56*t
      t605 = t604**2
      t620 = s34spinc(z,l1,l2,l3,l4,l5,l6,l7,l8)
      s2 = (512*t7*t8*t10*t11*t23+(-512*t7*t27-512*t30*t32*t2)*l1*r*t42+
     #512*t45+512*t47*t2)*t51+((1024*t53*t8*s23r*t56*t42-1024*t59*z*s23r
     #)*s1l1-512*t66*t67*t3*t80+(2048*t83*t84*s2l1+512*t65*t67*t89*s34r+
     #2048*t94-512*t83*t84*(-t96+t97-2))*t10*t11*t23+(-1024*t53*l3*t108+
     #(-1024*t45+512*t53*t114)*s2l1+(-1024*t94+512*t83*t84*(-1-t120+t31)
     #)*s34r+512*t53*t114*s3l1+512*t47*t1*(-t131+t132-t133+1))*l1*r*t42+
     #1024*t59*t108+(1024*t144+512*t146*t148)*s2l1+(1024*t53*t8*s3l1-512
     #*t53*t8*(l3-t8-1))*s34r+512*t146*t148*s3l1-512*t166*(-t66+1-t31+t6
     #5))*s13r+t275*s1l1
      s3 = s2+(512*t84*t278*s23r-512*t172*t66*s2l1+512*t3*t283*t286-512*
     #t2*t288*t258*t65)*t70*t71*t79
      s1 = s3+(-512*t297*t285*t198+(-1024*t278*t84*s34r-1024*t176*t177*s
     #3l1+512*(-1+t307+t97-t96)*t1*t30*t65)*s23r+256*(t248-t228-t187+t18
     #6)*t1*t191*s2l1-768*t320*t89*t213-1536*t324*z*t325*s34r+768*t32*t1
     #*t288*t333)*t10*t11*t23+((512*t297*t286+512*(-t31+t120+1-t307)*z*t
     #65*t5)*t198+(512*t2*t67*t285*t213+512*t203*t65*z*(-t147+t133+t248-
     #1)*s34r-512*t148*l3*t5*s3l1+512*(t307-t132+t131-t187+t31)*z*t191)*
     #s23r+(-512*t144+256*(t113-t112+4*t185+t225-t227)*t4)*s2l1+256*t320
     #*t89*t259+256*t324*z*(t187-t375-t376+1)*t213+256*t333*t1*(-t218+t3
     #76+1+t225-t382)*s34r-256*(1-t375+t382)*t288*t47)*l1*r*t42+(-512*t6
     #6*t5*t325*s34r+512*(l3-t8+t113)*l3*t166)*t198
      taux2 = s1+(-512*t176*t65*t29*t325*t213+512*t8*t5*(-2*t66+2*t65-l3
     #+t147-t113)*s34r-1024*t59*z*s3l1+512*(t65-t66+t120-z)*t4*z)*s23r+(
     #512*t59*z*s34r-512*t8+512*t185+512*z)*s2l1-256*t324*z*t325*t259-25
     #6*t333*t1*(t131-t132-t435+l3+t113)*t213-256*t47*(-z+2*t285-t225+t4
     #35-2*t277+l3)*s34r+256*t32*t4*z*t288-512*z*(2*s2l1+z)/r*t39*t41*t4
     #59*t602/t605+1024*z*t459*(1+l1*l3*r*t146*t457*t39*t41)*t620*t601/t
     #604

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet2 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff2)

CCC Sum

      A2num1e0 = tFjet1*tcoff1+tFjet2*tcoff2
      RETURN
      END

      double precision function A2num1e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = -1+z
      t5 = t4**2
      t6 = t5**2
      t7 = t3*t6
      t8 = z*l3
      t10 = l1**2
      t11 = r**2
      t13 = 1+t11
      t14 = t13**2
      t15 = r+t
      t16 = t15**2
      t19 = r*t
      t20 = 1+t19
      t21 = t20**2
      t23 = t14/t16/t21
      t27 = t8*s34r
      t29 = t5*t4
      t30 = t29*z
      t31 = 2*l3
      t32 = t31-1
      t33 = t32*t2
      t39 = 1/t15
      t41 = 1/t20
      t42 = t13*t39*t41
      t47 = t5*z
      t51 = s13r**2
      t53 = l3**2
      t54 = t53*z
      t55 = t6*t2
      t59 = t6*t4
      t60 = t53*t59
      t61 = z*t3
      t65 = l3*t29
      t66 = z*t2
      t67 = z+1
      t76 = t55*t54*s34r
      t77 = t5*t1
      t78 = 2*t8
      t79 = 2*z
      t80 = -t31+t78+1-t79
      t87 = s34r**2
      t91 = t65*z
      t92 = t78-t31-z
      t105 = t53*t1
      t108 = l3*t4
      t109 = -t79+t8+1-l3
      t116 = t55*t54*t87
      t118 = t77*l3
      t119 = t8-z-l3
      t120 = z*t119
      t124 = t4*z
      t130 = t53*t2
      t134 = t130*t6*s34r-t77*t8
      t135 = 128*t134
      t140 = t130*t6*t87
      t142 = 3*z
      t149 = t32*t4*z
      t155 = t87*s34r
      t162 = 3*t8
      t169 = s1l1**2
      t174 = t67*t1
      t175 = t5*l3
      t176 = t175*z
      t177 = t174*t176
      t191 = z*(-t31+t78+1-t142)
      t197 = (-z-1+t31+t78)*z*t4
      t223 = t67*z
      t227 = t6*t5
      t228 = t3*t227
      t229 = t53*l3
      t230 = t229*z
      t232 = t10**2
      t233 = t11**2
      t235 = t14**2
      t236 = t16**2
      t239 = t21**2
      t245 = t230*s34r
      t253 = t11*r
      t263 = t1*t6
      t264 = s23r**2
      t276 = s2l1**2
      t281 = t229*t227
      t285 = t55*t53
      t286 = 6*t8
      t296 = z**2
      t297 = t296*l3
      t299 = 12*t53
      t300 = 24*t54
      t301 = t53*t296
      t302 = 12*t301
      t303 = 4*z
      t323 = t1*z*t53
      t350 = 8*t8
      t351 = 8*l3
      t369 = 4*t53
      t372 = 2*t296
      t418 = 4*t54
      t431 = -t286+t31-8*t230+4*t229*t296-10*t301+4*t229-t372+8*t297+14*
     #t54-t369+t79
      t446 = (1+u)**2
      t449 = dsqrt(l1)
      t450 = t449*l1
      t451 = t233*t450
      t453 = t233*t449
      t461 = t11*l1
      t463 = t**2
      t465 = l1*r
      t471 = dsqrt(-l2*(1-l1)*(l2-1)*t14*r*(t11*t+t461*t+r+r*t463-t465-t
     #465*t463+t+l1*t))
      t472 = t11*t471
      t474 = t233*r
      t475 = t474*l2
      t476 = t449*t10
      t477 = t476*t
      t480 = t233*l2
      t481 = t450*t463
      t484 = t476*t463
      t487 = t253*t
      t488 = t449*l2
      t491 = t463*t
      t492 = t253*t491
      t493 = t450*l2
      t496 = t253*l2
      t499 = t11*l2
      t504 = t233*t11
      t505 = t504*t450
      t506 = t450*t
      t508 = 2*t451-2*t453+2*t472-2*t475*t477-2*t480*t481+3*t480*t484+5*
     #t487*t488+2*t492*t493-3*t496*t477-2*t499*t481+2*t499*t484+t505+t49
     #6*t506
      t509 = r*l2
      t514 = t504*t449
      t515 = l1*t471
      t519 = t449*t11
      t522 = t233*t253
      t525 = t11*t450
      t532 = -t509*t506-t509*t477+t504*l2*t484-t514-4*t487*t515*l4-t519+
     #t493-2*t461*t471-t522*t450*t-t525*l2+2*t514*l2+5*t453*l2-t505*l2
      t552 = r*t471
      t558 = t476*t491
      t560 = t474*t491
      t563 = t480*t476-2*t474*t450*t-3*t451*l2-4*t472*l4-2*t253*t449*t+2
     #*t487*t515+t522*l2*t506+4*t461*t471*l4-4*t552*l4*t-t504*t463*t488-
     #t475*t558-t560*t488-t492*t488
      t587 = -t233*t463*t488+3*t19*t488+t525-t496*t558+3*t475*t506+2*t47
     #4*t*t488+2*t560*t493-r*t449*t-t474*t449*t-t253*t450*t+t499*t476+2*
     #t552*t+3*t519*l2
      t590 = (t508+t532+t563+t587)**2
      t593 = (t11+t19+l1-t465*t)**2
      s3 = (-128*t7*t8*t10*t11*t23+(128*t7*t27+128*t30*t33)*l1*r*t42-128
     #*t2*t29*t27-128*t47*t2)*t51+((256*t54*t55*s23r+128*t60*t61*s34r-12
     #8*t65*t66*t67)*t10*t11*t23+((-256*t76-256*t8*t77*t80)*s23r-128*t54
     #*t59*t3*t87-128*t91*t2*t92*s34r+128*t47*t1*(t78+t31-1))*l1*r*t42+(
     #256*t105*t30*s34r+256*t108*z*t109)*s23r+128*t116+128*t118*t120*s34
     #r-128*t124*(t8-1+l3))*s13r
      s2 = s3+(t135*t10*t11*t23+(-256*t140-128*t77*l3*(t78-t31+2-t142)*s
     #34r+128*t149)*l1*r*t42+128*t130*t6*t155+256*t65*t2*t87+128*t4*(-t1
     #62+t54+z-t53-1+t31)*s34r-128*z)*t169+((256*t134*s2l1+128*t76-128*t
     #177)*t10*t11*t23+((-256*t140-256*t175*t1*t80*s34r+256*t149)*s2l1-2
     #56*t116-128*t118*t191*s34r+128*t197)*l1*r*t42+(256*t105*t29*t87+25
     #6*t108*t109*s34r-256*z)*s2l1+128*t130*t6*z*t155+256*t91*t1**2*t87+
     #128*t124*(t54-t162+z-t53+l3-1)*s34r-128*t223)*s1l1
      s3 = s2-128*t228*t230*t232*t233*t235/t236/t239
      s4 = s3+(256*t228*t245+256*t33*t60*z)*t10*l1*t253*t14*t13/t16/t15/
     #t21/t20
      s1 = s4+(-128*t263*t230*t264+(-128*t229*t59*t66*s34r+128*t174*t54*
     #t29)*s23r+t135*t276+(128*t76-128*t177)*s2l1-256*t281*t61*t87-128*t
     #285*z*(t286-6*l3-5*z+2)*s34r+64*(12*l3-24*t8+12*t297-t299+t300-t30
     #2+t303-4*t296-4)*t1*t176)*t10*t11*t23+((128*t263*t245+128*t191*t53
     #*t5)*t264+(128*t2*t59*t230*t87+128*t323*t29*(t78-t31-t142)*s34r-12
     #8*(-t79-1+t31+t78)*z*t175)*s23r+(-128*t77*l3*t92*s34r+128*t149)*t2
     #76+(-128*t118*z*(t78-t31-z-1)*s34r+128*t197)*s2l1+128*t281*t61*t15
     #5-64*t285*z*(-t350+t351+8*z-2)*t87+64*t118*z*(t299-t300+t302-20*t2
     #97+28*t8-t351+8*t296-6*z+2)*s34r-64*t32*(-4*t301+8*t54-t369+4*t297
     #-t350+4*l3-t372-2)*t124)*l1*r*t42
      taux1 = s1+(-128*t54*t5*t119*s34r-128*(-l3+t8-t79)*l3*t124)*t264+(
     #-128*t323*t29*t119*t87-128*t8*t5*(t54-t53-t162+t79)*s34r+128*(l3+t
     #8-z)*z*t4)*s23r+(128*t108*t119*s34r-128*z)*t276+(128*t108*z*(t8-z-
     #l3-1)*s34r-128*t223)*s2l1-128*t285*t120*t155+64*t91*t1*(-t418+t369
     #+t350-t31-t303)*t87-64*t124*t431*s34r+64*(-2*t301+t418-2*t53+2*t29
     #7-4*t8+t31-t372-2)*z+128*t296/r*t39*t41/t446*t590/t593
      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = -1+z
      t5 = t4**2
      t6 = t5**2
      t7 = t3*t6
      t8 = l1**2
      t11 = r**2
      t12 = 1+t11
      t13 = t12**2
      t15 = r+t
      t16 = t15**2
      t17 = 1/t16
      t18 = r*t
      t19 = 1+t18
      t20 = t19**2
      t21 = 1/t20
      t27 = t7*l3*s34r
      t28 = t5*t4
      t29 = 4*l3
      t37 = 1/t15
      t39 = 1/t19
      t40 = t12*t37*t39
      t42 = l3*t28
      t44 = t42*t2*s34r
      t46 = 2*l3
      t47 = t46-1
      t53 = z*l3
      t57 = t13*t17*t21
      t61 = t2*t28
      t65 = t53*s34r
      t68 = t2*z
      t69 = t42*t68
      t71 = t28*z
      t79 = t1*t5
      t83 = t61*t65
      t85 = t79*t53
      t87 = t5*z
      t91 = s13r**2
      t93 = l3**2
      t94 = t6*t4
      t95 = t93*t94
      t96 = t8*l1
      t99 = t11*r
      t100 = t13*t12
      t103 = 1/t16/t15
      t105 = 1/t20/t19
      t110 = t93*t6
      t114 = t3*s34r
      t117 = 3*l3
      t118 = 3*t53
      t127 = t93*t2
      t129 = t127*t6*s34r
      t131 = 5*l3
      t132 = 3*z
      t133 = 5*t53
      t138 = 2048*t85
      t141 = s34r**2
      t142 = t3*t141
      t144 = 512*t95*t142
      t145 = 4*t53
      t151 = 3*t93
      t152 = t93*z
      t153 = 3*t152
      t154 = 2*t53
      t162 = t93*t1
      t164 = t162*t28*s34r
      t166 = l3*t4
      t167 = 6*z
      t171 = t166*z
      t172 = 2048*t171
      t177 = 512*t127*t6*t141
      t183 = t4*t1
      t192 = t3*s3l1
      t193 = t95*t192
      t195 = z*t3
      t197 = 1536*t95*t195
      t202 = t100*t103*t105
      t207 = t2*t6
      t208 = t207*t152
      t215 = 8*t69
      t222 = t118-t132+1-t117
      t250 = t117-1
      t261 = 8*t53
      t262 = 2*z
      t263 = -t261+t262
      t278 = t53-l3
      t289 = 6*t53
      t319 = t117-2
      t327 = -t4
      t331 = 2*t4
      t332 = -t145+t262
      t337 = t6*s3l1
      t364 = t4*z
      s2 = (512*t95*t3*t96*t99*t100*t103*t105+(-2560*t110*t2*s23r-1024*t
     #95*t114-512*t61*l3*(-t117+t118-z))*t8*t11*t57+((1536*t129+1024*t79
     #*l3*(-t131-t132+2+t133)-t138)*s23r+t144+512*t61*l3*(-t29+t145-z)*s
     #34r+512*t79*(-t151+t153-t154+1))*l1*r*t40+(-1536*t164-512*t166*(-t
     #167+4-t131+t133)+t172)*s23r-t177-512*t79*l3*(t154-t46-z)*s34r-512*
     #t183*(-l3+t53-1))*s1l1+(512*t95*t3*s2l1-512*t193+t197)*t96*t99*t20
     #2
      s3 = s2+((-512*t110*t2*s2l1-1536*t208)*s23r+512*(-t61*l3*(t118+z+2
     #-t117)-t215)*s2l1+(1024*t193-t197)*s34r-512*(-t61*l3*t222+t215)*s3
     #l1-512*t42*t68*(1+t118-t117)+1024*t42*t68*(t117-2-t118))*t8*t11*t5
     #7
      s1 = s3+(((-512*t129+1024*t79*l3*(-l3+t53+z)+t138)*s2l1+512*t207*t
     #152*s34r+1024*t53*t28*t250*t1)*s23r+(-t144+2560*t83+512*t79*(t154-
     #t151+t29+t153-1)-1024*t79*t263)*s2l1-512*t95*t192*t141+(1024*(-t61
     #*l3*(-z-t46+1+t154)+2*t69)*s3l1+1024*t42*t68*t278-1024*t42*t68*(-1
     #-t154+t46))*s34r+512*(-t79*(t153-t289-t151+t46+z-1)-2*t79*t263)*s3
     #l1+512*t79*z*(-t151+t153+t46)-1024*t79*z*(1+t151-t29-t153))*l1*r*t
     #40+((512*t164-512*t166*(t262+t53-l3)-t172)*s2l1-512*t162*t71*s34r-
     #512*t53*t5*t319)*s23r
      t371 = s1+(t177-2560*t79*t65+512*t327*(t152-1+t46+t53-t93)+512*t33
     #1*t332)*s2l1+512*t127*t337*t141+(-1024*(-t79*l3*(t53+1-z-l3)+2*t85
     #)*s3l1-512*t79*t53*t278+1024*t79*t53*(-1-t53+l3))*s34r-512*(t327*(
     #t152-t118+z-t93+l3-1)-t331*t332)*s3l1-512*t364*(l3-t93+t152)+1024*
     #t364*(1-t46+t93-t152)
      t373 = t2*t94
      t374 = t93*l3
      t378 = t6*t5
      t379 = t374*t378
      t380 = t379*t114
      t386 = (8*t68+t2*t4)*t6*t93
      t392 = -t1
      t393 = t392*t6
      t394 = s23r**2
      t398 = t374*s34r
      t399 = t373*t398
      t401 = z*t1
      t403 = 4*z
      t412 = t379*t142
      t414 = 15*z
      t418 = 12*t208
      t422 = z**2
      t423 = 4*t422
      t424 = t422*l3
      t425 = 6*t424
      t428 = t5*l3
      t431 = 18*t53
      t432 = 15*t424
      t434 = 9*z
      t445 = 6*l3
      t455 = t392*t28
      t456 = 7*z
      t461 = 2*t28*t1
      t468 = 24*t53
      t475 = t141*s34r
      t486 = 34*t53
      t488 = t93*t422
      t489 = 3*t488
      t492 = 6*t152
      t497 = 12*t53
      t498 = 8*t422
      t506 = 30*t152
      t507 = 27*t488
      t517 = t93*t5
      t518 = t53-z-l3
      t532 = t28*t518
      t534 = t93*t28
      t535 = t401*t534
      t540 = 7*t53
      t543 = t289-t403
      t563 = 2*t93
      t564 = 2*t152
      t565 = 14*t53
      t576 = t374*z
      t577 = 2*t576
      t583 = -l3+t577-17*t152-t374+15*t488+t563-t374*t422+16*t53-17*t424
     #+t423-t403
      t587 = 2*t422
      t593 = 2560*t53
      t595 = 2304*t424
      t596 = 256*l3
      s3 = (-512*t373*t374*s23r-256*t380+256*t386)*t96*t99*t202
      s4 = (-1536*t393*t374*t394+(1536*t399-512*(8*t401-(-t117+t118-t403
     #+1)*t1)*t28*t93)*s23r+512*t412+256*(-t110*t2*(t117+t414-2-t118)-t4
     #18)*s34r-512*(-t289-t423+t425+t262)*t1*t428+256*(t431-t432-t117+9*
     #t422+2-t434)*t1*t428)*t8*t11*t57+((1024*t393*t398+512*(t414-3+t445
     #-t289)*t93*t5)*t394+(-1024*t373*t374*t141+512*(t455*t93*(t289-t456
     #+2-t445)+6*t461*t152)*s34r+512*(-17*z+t468+t151-t153-t46)*l3*t5)*s
     #23r-256*t379*t3*t475-256*(-t110*t2*(t29+14*z-1-t145)-t418)*t141-25
     #6*(-t79*l3*(-t486+16*z-1+t29-t151-t489+30*t424-17*t422+t492)+2*t79
     #*l3*(-t167-12*t424+t497+t498))*s34r+256*(-t506+t498+t507-34*t424+2
     #6*t53+t151-t132+1-t29)*t4)*l1*r*t40
      s2 = s3+s4
      s1 = s2+(-1024*(-t517*t518+2*t152*t5)*s34r-4096*t171+512*(-t117+t1
     #18-t403)*l3*t4)*t394+(-1024*(-t162*t532+2*t535)*t141-512*(-t428*(t
     #153-t151+t46-t540+t403)+2*t428*t543)*s34r-512*(11*t53-t167-t152+t9
     #3)*t4)*s23r+256*(-t110*t2*(t403+l3-t53)-4*t208)*t475+256*(-t42*t1*
     #(-l3-8*z+t563-t564+t565)-2*t42*t1*t543)*t141
      t598 = s1+256+256*(t327*t583+t331*(8*t424-6*t488+t262+t492-t289-t5
     #87))*s34r+t593+2048*t422-t595-t596-768*z
      t605 = 512*t373*t374*s3l1
      t607 = t68*t94*t374
      t615 = t576*s34r
      t618 = t127*t337
      t620 = z+1
      t623 = -t262-1
      t655 = t28*t1
      t693 = t152*(-1-t145+t29+t403)
      t696 = 2*t518
      t702 = t47*t1
      t725 = 8*l3
      t726 = 10*z
      t733 = t154-z-t46+2
      t795 = 5*z
      t806 = 12*t152
      t812 = 6*t93
      t819 = 1-t445+t812
      t849 = t53-z-l3+2
      t875 = 4*t171
      t915 = 10*t53
      t940 = t47*t4
      t952 = 1/r
      t955 = 1+u
      t956 = t955**2
      t957 = 1/t956
      t959 = t11**2
      t960 = dsqrt(l1)
      t961 = t959*t960
      t969 = t11*l1
      t971 = t**2
      t973 = l1*r
      t979 = dsqrt(-l2*(1-l1)*(l2-1)*t13*r*(t11*t+t969*t+r+r*t971-t973-t
     #973*t971+t+l1*t))
      t980 = r*t979
      t983 = t11*t960
      t988 = t959*t99
      t989 = t960*l1
      t992 = t11*t989
      t994 = r*l2
      t995 = t960*t8
      t996 = t995*t
      t998 = t959*t11
      t1000 = t995*t971
      t1002 = t959*t989
      t1004 = t959*r
      t1005 = t1004*l2
      t1008 = t959*l2
      t1009 = t989*t971
      t1014 = t99*t
      t1015 = t960*l2
      t1018 = -2*t961+2*t980*t+3*t983*l2-2*t969*t979-t988*t989*t-t992*l2
     #-t994*t996+t998*l2*t1000+2*t1002-2*t1005*t996-2*t1008*t1009+3*t100
     #8*t1000+5*t1014*t1015
      t1019 = t971*t
      t1020 = t99*t1019
      t1021 = t989*l2
      t1024 = t99*l2
      t1027 = t11*l2
      t1032 = t11*t979
      t1041 = t998*t960
      t1046 = t998*t989
      t1049 = 2*t1020*t1021-3*t1024*t996-2*t1027*t1009+2*t1027*t1000+2*t
     #1032-r*t960*t-t1004*t960*t-t99*t989*t+t1027*t995+2*t1041*l2+5*t961
     #*l2-t1046*l2+t1008*t995
      t1063 = l1*t979
      t1067 = t989*t
      t1072 = -2*t1004*t989*t-3*t1002*l2-4*t1032*l4-2*t99*t960*t-t983+t1
     #021-t1041+t1046+t992+3*t18*t1015+2*t1014*t1063+t988*l2*t1067+4*t96
     #9*t979*l4
      t1078 = t995*t1019
      t1080 = t1004*t1019
      t1098 = -4*t980*l4*t-t998*t971*t1015-t1005*t1078-t1080*t1015-t1020
     #*t1015-t959*t971*t1015+t1024*t1067-t994*t1067-4*t1014*t1063*l4-t10
     #24*t1078+3*t1005*t1067+2*t1004*t*t1015+2*t1080*t1021
      t1100 = t1018+t1049+t1072+t1098
      t1101 = t1100**2
      t1103 = t11+t18+l1-t973*t
      t1104 = t1103**2
      t1110 = l3*s1vr
      t1115 = t19*t957
      t1122 = 1+l1*l3*r*t327*t955*t37*t39
      t1123 = s34spinc(z,l1,l2,l3,l4,l5,l6,l7,l8)
      t1127 = s34spinc2(z,l1,l2,l3,l4,l5,l6,l7,l8)
      s2 = ((1024*t7*l3*t8*t11*t13*t17*t21+(-512*t27-512*t28*(t29-1)*t2)
     #*l1*r*t40+512*t44+512*t5*t47*t1)*s1l1-512*t7*t53*t8*t11*t57+((512*
     #t27-512*t61)*s2l1+1024*t7*t65-1024*t69+1024*t71*t47*t2)*l1*r*t40+(
     #-512*t44+512*t79)*s2l1-1024*t83+512*t85-1024*t87*t2)*t91+t371*s13r
     #+t598*s1l1+((-512*t373*t374*s2l1+t605-1536*t607)*s23r+(-256*t380+2
     #56*t386)*s2l1-2048*t3*t378*t615-1024*t618+512*(2*t2*t620-t2*t623)*
     #z*t110)*t96*t99*t202
      s3 = s2+((512*t374*t1*t6*s2l1-2048*t392*z*t6*t374)*t394+((512*t399
     #+512*(3-t262-t117+t118)*t1*t534)*s2l1+(-t605+3072*t607)*s34r+512*(
     #4*t535-(-t132-1-t117+t118)*t93*t655)*s3l1-512*(-2*t222*t1-(-t132+2
     #-t117+t118)*t1)*z*t534)*s23r+(256*t412-256*t110*t2*(-t118+t132+t11
     #7-4)*s34r-512*(-t289+t425-t587+t403)*t1*t428+256*(6*t422+1-t434+t4
     #31-t117-t432)*t1*t428)*s2l1+3072*t379*t195*t141+(1536*t618-768*t20
     #7*t693+1536*t207*t152*t696)*s34r+1536*t702*t42*s3l1-768*(2*t702*t6
     #20-t702*t623)*z*t42)*t8*t11*t57
      s5 = s3
      s9 = (-512*t47*t28*t93*s2l1-1536*t1*t6*t615+512*(t725-4-t261+t726)
     #*z*t517)*t394+((-512*t162*t28*t733*s34r+512*(2-z-t445+t145+t151-t1
     #53)*t5*l3)*s2l1-1536*t373*t576*t141+(512*t162*t28*(t154-t46-z-1)*s
     #3l1+512*t455*t152*(-t29+t145-t403+2)+512*t461*t693)*s34r-512*(t565
     #-t167-2+t151-t153+t46)*l3*t5*s3l1+512*(-9*t152-t434+9*t93-t725+t43
     #1+1)*z*t428)*s23r+(-256*t110*t2*t733*t141-256*(-t79*l3*(-t587+t167
     #-2+t725+t492-t151+t425-t489-t565)-4*t85)*s34r+256*(t507-t456-t506+
     #t486-20*t424+t422-t46+t151)*t4)*s2l1-1024*t379*t195*t475
      s8 = s9+(-512*t618+256*t207*t152*(-t497+12*l3+t726-3)-512*t207*t15
     #2*(t289-t795+1-t445))*t141+(-1024*t42*t250*t1*s3l1+256*t53*t655*(-
     #t445-t726-t806+t468+12*t93)-512*t53*t655*(-t497+t795+1+t492-t812))
     #*s34r-512*t819*t5*s3l1+256*(2*t819*t620-t819*t623)*z*t5
      s9 = l1
      s7 = s8*s9
      s8 = r*t40
      s6 = s7*s8
      s4 = s5+s6
      s1 = s4+(512*t517*s2l1+1536*t152*t5*t518*s34r-1024*(t262+l3-t53)*l
     #3*t364+512*t696*l3*t364)*t394+((512*t517*t849*s34r+512*t849*l3*t4)
     #*s2l1+1536*t401*t93*t532*t141+(-512*t517*(t53-z-l3-1)*s3l1+512*t53
     #*t5*(t564-t145+t46-t563+t262)-1024*t53*t5*(t563-t564-t262+t145-l3)
     #)*s34r+512*(t875-(-l3+t53-t262-2)*l3*t4)*s3l1-1024*(t93-t152-z+t15
     #4)*t4*z+512*(-t93+t152-t154+l3+z)*t4*z)*s23r
      taux2 = s1+(256*t162*t28*t849*t141+256*(-t166*(-t93-2+t29-t540+3*t
     #424-t587+t564-t488+t167)-t875)*s34r+t593-1792*z-t595-t596+256*t422
     #)*s2l1+1024*t207*t93*z*t518*t475+(512*t162*t28*s3l1-256*t53*t655*(
     #-t492+t812+t915-t117-t403)+512*t53*t655*(-t151+l3+t153+t262-t133))
     #*t141+(512*t428*t319*s3l1-256*t87*(-t915+t806-4*t576+t262+4*t374-t
     #151)+512*t87*(-z+t577-t492+t133-2*t374+l3))*s34r+512*t940*s3l1+256
     #*t940*z*t623-512*t940*z*t620+1536*z*(2*s2l1+z)*t952*t37*t39*t957*t
     #1101/t1104-(-512*(t1110-t1110*z-t167)*r*t15*t1115*t1122*t1123-512*
     #t183*s1vr*t1127*r*t15*t1115*t1122)*t1100*t39*t37/t1103*t952

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet2 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff2)

CCC Sum

      A2num1e1 = tFjet1*tcoff1+tFjet2*tcoff2
      RETURN
      END

      double precision function A2num1e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3**2
      t3 = -1+z
      t4 = t3**2
      t5 = t4**2
      t7 = t1*l3*t5*t4
      t8 = l3-1
      t9 = t8**2
      t11 = t9*t8*z
      t12 = s34r**2
      t18 = z*t1
      t22 = z**2
      t23 = 2*z
      t24 = t22-t23+1
      t31 = l1**2
      t33 = r**2
      t35 = 1+t33
      t36 = t35**2
      t37 = r+t
      t38 = t37**2
      t42 = 1+r*t
      t43 = t42**2
      t47 = t12*s34r
      t51 = t9*t5*t1
      t52 = z*l3
      t54 = 2*l3
      t62 = t22*l3
      t74 = z*t3
      t93 = 3*l3
      taux1 = (64*t7*t11*t12-128*t9*t5*t3*t18*s34r+64*t24*t8*t4*l3*z)*t3
     #1*t33*t36/t38/t43+(-64*t7*t11*t47-64*t51*z*(2*t52-t54-3*z+3)*t12+6
     #4*t8*t4*l3*z*(4*t62-8*t52+4*l3-3*t22+6*z-3)*s34r-64*(t54-1)*t24*t7
     #4)*l1*r*t35/t37/t42+64*t51*z*(t52-z-l3)*t47+64*t52*t4*t3*t8*(t18-t
     #1-3*t52+t93+t23)*t12-64*t74*(-z+2*t1*t22-4*t18+2*t1+t22-3*t62+6*t5
     #2-t93)*s34r+64*t24*z
      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = -1+z
      t5 = t4**2
      t6 = t5**2
      t7 = t3*t6
      t8 = l1**2
      t11 = r**2
      t12 = 1+t11
      t13 = t12**2
      t15 = r+t
      t16 = t15**2
      t17 = 1/t16
      t18 = r*t
      t19 = 1+t18
      t20 = t19**2
      t21 = 1/t20
      t27 = t7*l3*s34r
      t28 = t5*t4
      t29 = 4*l3
      t37 = 1/t15
      t39 = 1/t19
      t40 = t12*t37*t39
      t42 = l3*t28
      t43 = t2*s34r
      t44 = t42*t43
      t46 = 2*l3
      t47 = t46-1
      t48 = t5*t47
      t53 = z*l3
      t57 = t13*t17*t21
      t61 = t2*t28
      t65 = t2*z
      t72 = t1*t5
      t79 = s13r**2
      t81 = l3**2
      t82 = t6*t4
      t83 = t81*t82
      t84 = t8*l1
      t87 = t11*r
      t88 = t13*t12
      t91 = 1/t16/t15
      t93 = 1/t20/t19
      t98 = t81*t6
      t102 = t3*s34r
      t105 = 3*l3
      t106 = 3*t53
      t115 = t98*t43
      t117 = 5*t53
      t118 = 5*l3
      t119 = 3*z
      t126 = s34r**2
      t127 = t3*t126
      t128 = t83*t127
      t130 = 4*t53
      t136 = 3*t81
      t137 = t81*z
      t138 = 3*t137
      t139 = 2*t53
      t147 = t81*t1
      t149 = t147*t28*s34r
      t151 = l3*t4
      t152 = 6*z
      t158 = t81*t2
      t160 = t158*t6*t126
      t167 = t4*t1
      t175 = t3*s3l1
      t176 = t83*t175
      t177 = z*t3
      t178 = t83*t177
      t184 = t88*t91*t93
      t189 = t2*t6
      t226 = t105-1
      t234 = t28*z
      t235 = t234*s34r
      t250 = -l3+t53
      t257 = 6*t53
      t270 = 2*z
      t278 = t105-2
      t285 = t5*z
      t293 = t6*s3l1
      t297 = -l3+t53+1-z
      t311 = t4*z
      t317 = t2*t82
      t318 = t81*l3
      t323 = t318*t6*t5
      t325 = 1024*t323*t102
      t327 = t2*t4
      t332 = 256*(-8*t65-4*t327)*t6*t81
      t337 = t1*t6
      t338 = s23r**2
      t342 = t318*s34r
      t343 = t317*t342
      t345 = 4*z
      t348 = t28*t81
      t353 = t323*t127
      t355 = 8*z
      t356 = 6*l3
      t368 = 18*t53
      t369 = 9*z
      t370 = z**2
      t371 = t370*l3
      t372 = 15*t371
      t376 = t5*l3
      t379 = 12*t53
      t380 = 6*t371
      t381 = 4*t370
      t392 = 7*z
      t402 = t1*t28
      t408 = 5*z
      t409 = 8*t53
      t416 = t126*s34r
      t420 = 8*l3
      t424 = 14*z
      t432 = t81*t370
      t433 = 6*t432
      t434 = 12*t137
      t435 = 6*t81
      t438 = 16*l3
      t445 = 3*t432
      t448 = 6*t137
      t456 = 48*t137
      t457 = 36*t432
      t458 = 12*t81
      t461 = 10*z
      t470 = t81*t5
      t471 = t53-z-l3
      t482 = t1*t471*t126
      t485 = 7*t53
      t495 = 2*t471
      t505 = 4*t137
      t510 = 2*t81
      t511 = 2*t137
      t512 = 14*t53
      t520 = -t4
      t523 = t318*z
      t524 = 4*t523
      t525 = 2*t318
      t526 = t318*t370
      t528 = 2*t370
      t530 = 8*t371
      t531 = -8*t432+16*t137-t524+t525+2*t526-t512-t528-8*t81+t530+t270+
     #t356
      t534 = 2*t523
      t537 = 16*t53
      t539 = -l3+t534-17*t137-t318+15*t432+t510-t526+t537-17*t371+t381-t
     #345
      t544 = 4096*t53
      t546 = 3072*t371
      t547 = 1024*l3
      s3 = (1024*t317*t318*s23r+t325+t332)*t84*t87*t184
      s5 = (-3072*t337*t318*t338+(-3072*t343-1024*(-t105+t106-t345+1)*t1
     #*t348)*s23r-2048*t353+256*(-t158*t6*(t257+8-t355-t356)+2*t158*t6*(
     #t105+15*z-2-t106))*s34r-512*(t368-t369-t372-t105+2+9*t370)*t1*t376
     #+256*(-t379+t380+t356+t355-t381-4)*t1*t376)*t8*t11*t57
      s6 = ((2048*t337*t342+1024*(-t392+3-t356+t257)*t81*t5)*t338+(2048*
     #t317*t318*t126+1024*t402*t81*(-t356+t257-t392+2)*s34r+1024*(t408-t
     #136+t138-t409+t46)*l3*t5)*s23r+1024*t323*t3*t416-256*(-t158*t6*(-t
     #420-t355+6+t409)+2*t158*t6*(t29+t424-1-t130))*t126-256*(-t72*l3*(t
     #433-t434+t435-16*t371+32*t53-t438+8*t370-t424+6)+2*t72*l3*(-34*t53
     #+16*z-1+t29-t136-t445+30*t371-17*t370+t448))*s34r+256*(t456-t457-t
     #458-4+44*t371-10*t370+t461+t438-52*t53)*t4)*l1*r*t40
      s4 = s5+s6
      s2 = s3+s4
      s1 = s2+(-2048*t470*t471*s34r-1024*(-t105+t106-t345)*l3*t4)*t338+(
     #-2048*t348*t482-1024*t376*(t138-t485+t345-t136+t46)*s34r-1024*(-t8
     #1+t137-t106+t270)*t4)*s23r+256*(-t158*t6*t495+2*t158*t6*(t345+l3-t
     #53))*t416+256*(-t42*t1*(t505+t345-4*t81-t409+t356)+2*t42*t1*(-l3-t
     #355+t510-t511+t512))*t126
      t549 = s1-1024+256*(t520*t531+2*t4*t539)*s34r-t544+2560*z+t546+t54
     #7-2560*t370
      t554 = t317*t318*s3l1
      t555 = t82*t318
      t556 = t65*t555
      t565 = t158*t293
      t567 = -t270-1
      t582 = t1*z
      t583 = t6*t318
      t605 = t234*t81
      t646 = t47*t1
      t666 = -t29+t130-t345+2
      t672 = t139-z-t46+2
      t738 = 12*l3
      t760 = 1-t356+t435
      t784 = t53-z-l3+2
      t850 = 10*t53
      t869 = t47*t4
      t880 = 1/r
      t883 = 1+u
      t884 = t883**2
      t885 = 1/t884
      t887 = t11**2
      t888 = t887*t11
      t889 = dsqrt(l1)
      t890 = t888*t889
      t893 = t887*t889
      t896 = t889*l1
      t897 = t888*t896
      t899 = t887*l2
      t900 = t889*t8
      t904 = t887*r
      t915 = t11*l1
      t917 = t**2
      t919 = l1*r
      t925 = dsqrt(-l2*(1-l1)*(l2-1)*t13*r*(t11*t+t915*t+r+r*t917-t919-t
     #919*t917+t+l1*t))
      t926 = r*t925
      t931 = t889*l2
      t933 = t904*l2
      t934 = t917*t
      t935 = t900*t934
      t942 = t887*t896
      t945 = 2*t890*l2+5*t893*l2-t897*l2+t899*t900-r*t889*t-t904*t889*t-
     #t87*t896*t-4*t926*l4*t-t888*t917*t931-t933*t935+3*t18*t931-2*t904*
     #t896*t-3*t942*l2
      t946 = t11*t925
      t948 = t904*t934
      t950 = t87*t934
      t956 = t87*l2
      t957 = t896*t
      t959 = r*l2
      t961 = t900*t
      t971 = 2*t946-t948*t931-t950*t931-t887*t917*t931-2*t893+2*t942+t95
     #6*t957-t959*t957-t959*t961-4*t946*l4-2*t87*t889*t-t956*t935+3*t933
     #*t957
      t974 = t900*t917
      t979 = t896*l2
      t984 = t896*t917
      t987 = t87*t
      t988 = l1*t925
      t991 = t887*t87
      t994 = t11*l2
      t1007 = t888*l2*t974+2*t904*t*t931+2*t948*t979-2*t933*t961-2*t899*
     #t984+2*t987*t988+t991*l2*t957+t994*t900-4*t987*t988*l4+3*t899*t974
     #+5*t987*t931+2*t950*t979+2*t926*t
      t1008 = t11*t889
      t1020 = t11*t896
      t1026 = 3*t1008*l2-3*t956*t961-2*t994*t984+2*t994*t974+4*t915*t925
     #*l4+t897+t1020-t890-2*t915*t925-t991*t896*t+t979-t1008-t1020*l2
      t1028 = t945+t971+t1007+t1026
      t1029 = t1028**2
      t1031 = t11+t18+l1-t919*t
      t1032 = t1031**2
      t1038 = l3*s1vr
      t1043 = t19*t885
      t1050 = 1+l1*l3*r*t520*t883*t37*t39
      t1051 = s34spinc(z,l1,l2,l3,l4,l5,l6,l7,l8)
      t1055 = s34spinc2(z,l1,l2,l3,l4,l5,l6,l7,l8)
      s4 = ((-2048*t7*l3*t8*t11*t13*t17*t21+(1024*t27+1024*t28*(t29-1)*t
     #2)*l1*r*t40-1024*t44-1024*t48*t1)*s1l1-1024*t7*t53*t8*t11*t57+((-1
     #024*t27+1024*t61)*s2l1+2048*t42*t65)*l1*r*t40+(1024*t44-1024*t72)*
     #s2l1-1024*t72*t53)*t79
      s8 = (-1024*t83*t3*t84*t87*t88*t91*t93+(5120*t98*t2*s23r+2048*t83*
     #t102+1024*t42*t2*(-t105+t106-z))*t8*t11*t57+((-3072*t115-2048*t72*
     #l3*(t117-t118-t119+2))*s23r-1024*t128-1024*t42*t2*(-t29+t130-z)*s3
     #4r-1024*t72*(-t136+t138-t139+1))*l1*r*t40+(3072*t149+1024*t151*(t1
     #17-t152+4-t118))*s23r+1024*t160+1024*t72*l3*(t139-t46-z)*s34r+1024
     #*t167*(-l3+t53-1))*s1l1+(-1024*t83*t3*s2l1+1024*t176-1024*t178)*t8
     #4*t87*t184
      s7 = s8+((1024*t98*t2*s2l1+3072*t189*t137)*s23r+1024*t42*t2*(-t105
     #+t106+z+2)*s2l1+(-2048*t176+1024*t178)*s34r-1024*t42*t2*(-t105+t10
     #6-t119+1)*s3l1+1024*t61*t53*(t106-t105+1))*t8*t11*t57+(((1024*t115
     #-2048*t72*l3*(-l3+t53+z))*s2l1-1024*t98*t65*s34r-2048*t53*t28*t226
     #*t1)*s23r+(1024*t128-1024*l3*t2*t235-1024*t72*(t139+t138-1-t136+t2
     #9))*s2l1+1024*t83*t175*t126+(2048*t42*t2*(t139-z-t46+1)*s3l1-2048*
     #t61*t53*t250)*s34r+1024*t72*(t138-t257+z-1-t136+t46)*s3l1-1024*t72
     #*z*(-t136+t138+t46))*l1*r*t40+((-1024*t149+1024*t151*(t270+t53-l3)
     #)*s2l1+1024*t147*t235+1024*t53*t5*t278)*s23r
      s6 = s7+(-1024*t160+1024*l3*t1*t285*s34r+1024*t4*(t137+t53-t81-1+t
     #46))*s2l1-1024*t158*t293*t126+(-2048*t72*l3*t297*s3l1+1024*t72*t53
     #*t250)*s34r-1024*t4*(-t106+z+t137-1-t81+l3)*s3l1+1024*t311*(l3-t81
     #+t137)
      s7 = s13r
      s5 = s6*s7
      s3 = s4+s5
      s2 = s3+t549*s1l1+((1024*t317*t318*s2l1-1024*t554+1024*t556)*s23r+
     #(t325+t332)*s2l1+2560*t323*t177*s34r+2048*t565+512*(2*t2*t567-t327
     #)*z*t98)*t84*t87*t184
      s3 = s2+((-1024*t318*t1*t6*s2l1-2048*t582*t583)*t338+((-1024*t343-
     #1024*(3-t270-t105+t106)*t1*t348)*s2l1+(1024*t554-2048*t556)*s34r+1
     #024*(-t119-1-t105+t106)*t81*t402*s3l1-1024*(-t119+2-t105+t106)*t1*
     #t605)*s23r+(-1024*t353+256*(-t158*t6*(-t356+t257-t345+4)+2*t158*t6
     #*(-t106+t119+t105-4))*s34r-512*(-t372+1-t369+6*t370+t368-t105)*t1*
     #t376+256*(t345-2-t528+t356-t379+t380)*t1*t376)*s2l1-3840*t323*t177
     #*t126+(-3072*t565-1536*t189*t137*t297+1536*t189*t137*(-1-t130+t29+
     #t345))*s34r-3072*t646*t42*s3l1-768*(2*t646*t567-t646*t4)*z*t42)*t8
     #*t11*t57
      s5 = s3
      s9 = (1024*t47*t28*t81*s2l1+1024*t583*t582*s34r+1024*t666*z*t470)*
     #t338+((1024*t348*t1*t672*s34r+1024*(-2+z+t356-t130-t136+t138)*t5*l
     #3)*s2l1+1024*t65*t555*t126+(-1024*t348*t1*(t139-t46-z-1)*s3l1+1024
     #*t582*t348*t666)*s34r-1024*(t270+2-t136+t138-t257-t46)*l3*t5*s3l1+
     #1024*(-1+t119-t136+t138-t257+t29)*z*t376)*s23r+(-256*(-t158*t6*(t1
     #30-t270-t29)-2*t158*t6*t672)*t126-256*(-t72*l3*(-t270+t528+t433+t5
     #37-t434-t530+t435-t420)+2*t72*l3*(-t528+t152-2+t420+t448-t136+t380
     #-t445-t512))*s34r+256*(-t528-t457+t420-44*t53+t152+28*t371+t456-t4
     #58)*t4)*s2l1+1280*t323*t177*t416
      s8 = s9+(1024*t565+256*t189*t137*(t257-t356-t408+3)-512*t189*t137*
     #(-t379+t738+t461-3))*t126+(2048*t42*t226*t1*s3l1+256*t53*t402*(-3+
     #t738+t408+t448-t435-t379)-512*t53*t402*(-t356-t461-t434+24*t53+t45
     #8))*s34r+1024*t760*t5*s3l1+256*(2*t760*t567-t760*t4)*z*t5
      s9 = l1
      s7 = s8*s9
      s8 = r*t40
      s6 = s7*s8
      s4 = s5+s6
      s1 = s4+(-1024*t470*s2l1-1024*t137*t5*t471*s34r-1024*t495*l3*t311)
     #*t338+((-1024*t470*t784*s34r-1024*t784*l3*t4)*s2l1-1024*t605*t482+
     #(1024*t470*(t53-z-l3-1)*s3l1-1024*t53*t5*(t511+t270-t130+t46-t510)
     #)*s34r+1024*(-l3+t53-t270-2)*l3*t4*s3l1-1024*(-t81+t137-t139+l3+z)
     #*t4*z)*s23r
      taux2 = s1+(256*(-t348*t1*t495-2*t348*t1*t784)*t126+256*(-t151*(-t
     #270+t528+t409+2*t432-4*t371+t510-t505-t29)+2*t151*(-t81-2+t29-t485
     #+3*t371-t528+t511-t432+t152))*s34r+1536*z-512*t370-t544+t547+t546)
     #*s2l1-1280*t189*t81*z*t471*t416+(-1024*t147*t28*s3l1-256*t53*t402*
     #(-t117+t105+t270+t138-t136)+512*t53*t402*(-t448+t435+t850-t105-t34
     #5))*t126+(-1024*t376*t278*s3l1-256*t285*(-t525-z+t534+t117-t448+t4
     #35-t105)+512*t285*(-t850+t434-t524+t270+4*t318-t136))*s34r-1024*t8
     #69*s3l1+256*t48*z-512*t869*z*t567-1024*z*(2*s2l1+z)*t880*t37*t39*t
     #885*t1029/t1032-(-1024*(-t1038+t1038*z+t270)*r*t15*t1043*t1050*t10
     #51+1024*t167*s1vr*t1055*r*t15*t1043*t1050)*t1028*t39*t37/t1031*t88
     #0

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet2 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff2)

CCC Sum

      A2num1e2 = tFjet1*tcoff1+tFjet2*tcoff2
      RETURN
      END

      double precision function A2num1e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux1 = 0
      t1 = l3**2
      t2 = t1*l3
      t3 = -1+z
      t4 = t3**2
      t5 = t4**2
      t7 = t2*t5*t4
      t8 = l3-1
      t9 = t8**2
      t10 = t9*t8
      t14 = t9*t5*t3
      t17 = -1024*t7*t10*s34r+1024*t14*t1
      t18 = l1**2
      t19 = t18*l1
      t21 = r**2
      t22 = t21*r
      t24 = 1+t21
      t25 = t24**2
      t27 = r+t
      t28 = t27**2
      t33 = 1+r*t
      t34 = t33**2
      t37 = t25*t24/t28/t27/t34/t33
      t39 = s34r**2
      t41 = t7*t10*t39
      t44 = z*l3
      t45 = 6*t44
      t46 = 8*z
      t47 = 6*l3
      t53 = 12*t44
      t54 = z**2
      t55 = t54*l3
      t56 = 6*t55
      t60 = t4*l3
      t69 = t25/t28/t34
      t71 = t39*s34r
      t75 = t1*t5
      t76 = 8*l3
      t77 = 8*t44
      t83 = t8*t4
      t84 = t1*t54
      t85 = 6*t84
      t86 = t1*z
      t87 = 12*t86
      t88 = 6*t1
      t99 = 4*z
      t100 = 2*t54
      t101 = 16*t44
      t102 = 8*t55
      t112 = t24/t27/t33
      t114 = t44-z-l3
      t115 = 2*t114
      t120 = t4*t3
      t122 = 4*t86
      t131 = t2*z
      t133 = 2*t2
      t138 = 2*z
      t139 = -8*t84+16*t86-4*t131+t133+2*t2*t54-14*t44-t100-8*t1+t102+t1
     #38+t47
      t143 = 1024*l3
      t144 = 2048*t44
      t145 = 1024*t55
      t148 = t17*t19*t22*t37+(2048*t41+512*t1*t9*t5*(t45+8-t46-t47)*s34r
     #-512*(-t53+t56+t47+t46-4*t54-4)*t8*t60)*t18*t21*t69+(-1024*t7*t10*
     #t71-512*t75*t9*(-t76-t46+6+t77)*t39-512*t83*l3*(t85-t87+t88-16*t55
     #+32*t44-16*l3+8*t54-14*z+6)*s34r+512*(t88-t87+t85-t99+2+t100+t101-
     #t102-t76)*t3)*l1*r*t112+512*t75*t9*t115*t71+512*l3*t120*t8*(t122+t
     #99-4*t1-t77+t47)*t39+512*t3*t139*s34r-t143+t144-t145+1024-2048*z+1
     #024*t54
      t151 = z*t10
      t162 = t9*t5
      t177 = t162*t1
      t185 = 2*l3-1
      t196 = 4*l3
      t205 = 4*t55
      t214 = 5*z
      t220 = t44*t120
      t222 = 6*t86
      t254 = 5*t44
      t255 = 3*l3
      s1 = t148*s1l1+(t17*s2l1-1024*t7*t151*s34r+1024*t14*t86)*t19*t22*t
     #37+((1024*t41+512*t162*t1*(-t47+t45-t99+4)*s34r-512*(t99-2-t100+t4
     #7-t53+t56)*t8*t60)*s2l1+1536*t7*t151*t39+1536*t177*z*(-2*z-2*l3+2*
     #t44+2)*s34r-1536*t185*t8*t5*z*l3)*t18*t21*t69+((-512*t162*t1*(4*t4
     #4-t138-t196)*t39-512*t83*l3*(-t138+t100+t85+t101-t87-t102+t88-t76)
     #*s34r+512*(t77-t196-t205+t88-t87+t85)*t3)*s2l1-512*t7*t151*t71-512
     #*t177*z*(t45-t47-t214+3)*t39-512*t220*t8*(-3+12*l3+t214+t222-t88-t
     #53)*s34r+512*(1-t47+t88)*t120*z)*l1*r*t112
      taux2 = s1+(512*t1*t120*t8*t115*t39+512*l3*t3*(-t138+t100+t77+2*t8
     #4-t205+2*t1-t122-t196)*s34r-t143+t144-t145)*s2l1+512*t177*z*t114*t
     #71+512*t220*t8*(-t254+t255+t138+3*t86-3*t1)*t39+512*z*t4*(-t133-z+
     #2*t131+t254-t222+t88-t255)*s34r-512*t185*t4*z

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux2

CCC Jet functions

      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = -l3+1
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet2 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff2)

CCC Sum

      A2num1e3 = tFjet1*tcoff1+tFjet2*tcoff2
      RETURN
      END

      double precision function A2num1e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin,s34spinc,s34spinc2
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag,s34spinc,s34spinc2
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux1 = 0
      taux2 = 0

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux2

CCC Jet functions

      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,3.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t1 = 1-l3
      t2 = 1-z
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet2 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,6.D0,1.D0,1.D0,Tcoeff*tcoff2)

CCC Sum

      A2num1e4 = tFjet1*tcoff1+tFjet2*tcoff2
      RETURN
      END

