CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCC Numerator functions CCCCCCCCCCCCCCCCCCCCCCCCCC

      double precision function B2num1e0(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3-1
      t2 = t1**2
      t3 = t2**2
      t4 = -1+z
      t5 = t4**2
      t6 = t5**2
      t8 = s4vr**2
      t9 = 1/t8
      t11 = s3vr**2
      t12 = 1/t11
      t14 = s13r**2
      t15 = t14**2
      t20 = t2*t1
      t21 = t20*t6
      t22 = t21*l3
      t23 = t9*t12
      t32 = t6*t4
      t34 = t3*t32*l3
      t39 = t5*t4
      t40 = t20*t39
      t41 = t23*s3l2
      t42 = t40*t41
      t44 = t9*s4l2
      t45 = t44*t12
      t46 = t40*t45
      t62 = t23*s3l1
      t63 = t40*t62
      t65 = t9*s4l1
      t66 = t65*t12
      t67 = t40*t66
      t71 = t23*s2l2
      t74 = t22*t41
      t76 = t22*t45
      t85 = z*l3
      t86 = t85*t6
      t87 = t20*t9
      t88 = t87*t12
      t89 = t86*t88
      t94 = t23*s2l2*s2l1
      t100 = t23*s34r
      t126 = t3*t9
      t127 = t12*s34r
      t131 = t40*t9
      t132 = t12*s3l2
      t133 = t132*s3l1
      t137 = s4l2*s4l1*t12
      t143 = l3**2
      t144 = t143*t6
      t145 = t144*t2
      t149 = s23r**2
      t150 = t23*t149
      t152 = t143*t32
      t153 = t152*t20
      t160 = s1vr**2
      t165 = t145*t71
      t166 = t145*t41
      t167 = t145*t45
      t171 = t153*t100
      t172 = l3*t6
      t173 = t2*t9
      t174 = t173*t12
      t175 = t172*t174
      t176 = t171+t175
      t177 = 128*t176
      t180 = t23*s3l2*s34r
      t183 = l3*t39
      t184 = t183*t2
      t185 = t184*t41
      t195 = -512*t171-384*t175
      t197 = t153*t41
      t198 = t153*t45
      t200 = -128*t197+128*t198
      t207 = t6*t5
      t209 = t3*t207*t143
      t210 = s34r**2
      t211 = t23*t210
      t213 = -z+2
      t214 = t213*t9
      t215 = t214*t127
      t218 = -128*t209*t211+128*t22*t215
      t221 = t23*s3l2*t210
      t227 = t5*t2
      t228 = z-3
      t229 = t227*t228
      t232 = t227*z
      t241 = t23*s2l1
      t243 = t145*t62
      t244 = t145*t66
      t250 = t23*s3l1*s34r
      t253 = t184*t62
      t262 = t153*t62
      t263 = t153*t66
      t265 = -128*t262+128*t263
      t274 = t23*s3l1*t210
      t287 = t23*s3l2*s2l1
      t290 = t23*s3l1*s2l2
      t292 = t12*s3l1
      t293 = t44*t292
      t294 = t145*t293
      t295 = t65*t132
      t296 = t145*t295
      t308 = z*t143
      t309 = t308*t6
      t310 = t309*t174
      t311 = 128*t310
      t321 = l3*(z-4)*t39
      t322 = t173*t132
      t325 = t172*t2
      t326 = t325*t45
      t333 = t173*t292
      t342 = t153*t295
      t344 = t308*t32
      t346 = 128*t344*t88
      t368 = 2*z
      t371 = l3*(t368-5)*t39
      t374 = s4l2*t12
      t375 = t173*t374
      t384 = s4l1*t12
      t394 = t23*s3l2*s3l1
      t397 = t44*s4l1
      t398 = t184*t397
      t399 = t6*t2
      t409 = (t368-4)*t9*t127
      t412 = z**2
      t413 = 3*z
      t414 = t412-t413+1
      t420 = t12*t210
      t424 = 2*t4
      t425 = t424*t9
      t428 = -t368-1
      t429 = t428*t9
      t430 = t429*t374
      t435 = 5*z
      t437 = t227*(t435-7)
      t440 = 4*z
      t442 = t227*(-t440+2)
      t452 = t429*t384
      t478 = -t4
      t487 = t39*t2
      t490 = z+3
      t491 = t490*t5
      t492 = t491*t2
      t499 = t487*t9
      s2 = ((-256*t145*t23*s23r*s1vr+256*t145*t150+256*t153*t23*s34r*s23
     #r)*s1l2-128*t145*t23*s3l2*t160+((128*t165+128*t166-128*t167)*s23r+
     #t177*s2l2+256*t153*t180+128*t185)*s1vr-512*t145*t23*s2l2*t149+(t19
     #5*s2l2+t200*s34r+64*t185-64*t184*t45)*s23r+t218*s2l2-128*t209*t221
     #-64*t22*t44*t127+64*t229*t41-128*t232*t45)*s1l1+(-128*t145*t23*s3l
     #1*t160+((128*t145*t241+128*t243-128*t244)*s23r+t177*s2l1+256*t153*
     #t250+128*t253)*s1vr-512*t145*t23*s2l1*t149+(t195*s2l1+t265*s34r+64
     #*t253-64*t184*t66)*s23r+t218*s2l1-128*t209*t274-64*t22*t65*t127+64
     #*t229*t62-128*t232*t66)*s1l2+(-128*t145*t287-128*t145*t290-128*t29
     #4-128*t296)*t160
      s1 = s2+(((512*t165-256*t166+256*t167)*s2l1+(-256*t243+256*t244)*s
     #2l2-t311)*s23r+(256*t176*s2l2+(128*t197+128*t198)*s34r-128*t321*t3
     #22+128*t326)*s2l1+((128*t262+128*t263)*s34r-128*t321*t333+128*t325
     #*t66)*s2l2+(256*t153*t293+256*t342-t346)*s34r+256*t184*t293+256*t1
     #84*t295-128*t86*t174)*s1vr+(256*t145*t94+512*t310)*t149+(((256*t17
     #1+768*t175)*s2l2-t200*s34r-64*t371*t322+64*t371*t375)*s2l1+(-t265*
     #s34r-64*t371*t333+64*t371*t173*t384)*s2l2+512*t344*t87*t127+384*t1
     #84*t394+(-384*t398+384*t85*t399*t9)*t12)*s23r
      t502 = s1+((128*t22*t409+256*t414*t5*t174)*s2l2-128*t209*t44*t420+
     #(64*t22*t425*t132+64*t22*t430)*s34r+64*t437*t41+64*t442*t45)*s2l1+
     #(-128*t209*t65*t420+(64*t22*t425*t292+64*t22*t452)*s34r+64*t437*t6
     #2+64*t442*t66)*s2l2+(-128*t209*t293-128*t209*t295+128*t308*t207*t1
     #26*t12)*t210+((256*t74-192*t76)*s3l1-192*t22*t295+(-128*t22*t397-1
     #28*t86*t20*t478*t9)*t12)*s34r+(256*t487*t41-64*t492*t45)*s3l1-64*t
     #492*t295-128*t499*t137
      t504 = t143*l3
      t505 = t504*t6
      t506 = t505*t1
      t510 = t504*t32*t2
      t511 = t510*t100
      t512 = t1*t9
      t513 = t512*t12
      t514 = t144*t513
      t516 = 256*t511+256*t514
      t520 = t149*s23r
      t521 = t23*t520
      t529 = t504*t207*t20
      t530 = t529*t211
      t532 = t152*t2*t100
      t541 = t143*t39
      t542 = t541*t1
      t547 = t506*t71
      t549 = t506*t41
      t550 = 256*t549
      t551 = t506*t45
      t555 = t510*t41
      t557 = t510*t45
      t561 = z+1
      t562 = t143*t561
      t563 = t562*t39
      t564 = t512*t132
      t567 = t144*t1
      t568 = t567*t45
      t569 = 128*t568
      t574 = l3*t1*t5
      t575 = z*t9
      t576 = t575*t12
      t578 = t145*t100+t574*t576
      t579 = 128*t578
      t593 = 384*t511+512*t514
      t598 = -t428
      t599 = t143*t598
      t600 = t599*t39
      t603 = t512*t374
      t614 = t412-t440+1
      t619 = 128*t530+256*t145*t228*t9*t127+128*l3*t614*t5*t513
      t626 = t490*t9
      t629 = t575*t374
      t630 = t145*t629
      t634 = t183*t1
      t635 = t634*t41
      t641 = t368-1
      t646 = -256*t153*t211-128*t184*t641*t9*t127
      t650 = t561*t9
      t651 = t650*t132
      t654 = -t561*t9
      t655 = t654*t374
      t660 = t4*t1
      t661 = -t368+3
      t662 = t660*t661
      t665 = t412*t4
      t666 = t665*t1
      t669 = ((512*t506*t150+t516*s23r)*s1vr-512*t506*t521+(-768*t511-25
     #6*t514)*t149+(-256*t530-256*t532)*s23r)*s1l2+(256*t506*t23*s3l2*s2
     #3r-256*t542*t41)*t160+((128*t547-t550+256*t551)*t149+((-384*t555+1
     #28*t557)*s34r+128*t563*t564+t569)*s23r+t579*s2l2+512*t145*t180+256
     #*t574*t41)*s1vr+256*t506*t23*s2l2*t520+(t593*s2l2+(128*t555-128*t5
     #57)*s34r-64*t600*t564+64*t600*t603)*t149+(t619*s2l2+(128*t529*t41-
     #128*t529*t45)*t210+(-128*t145*t626*t132-128*t630)*s34r-128*t635)*s
     #23r+t646*s2l2-320*t153*t221+(-64*t184*t651-64*t184*t655)*s34r-64*t
     #662*t41+64*t666*t45
      t680 = t506*t62
      t682 = t506*t66
      t686 = t510*t62
      t688 = t510*t66
      t692 = t512*t292
      t695 = t567*t66
      t696 = 128*t695
      t716 = t512*t384
      t729 = t575*t384
      t730 = t145*t729
      t734 = t634*t62
      t741 = t650*t292
      t743 = t654*t384
      t756 = t506*t293
      t757 = t506*t295
      t765 = t542*t293
      t767 = t542*t295
      t772 = 128*t549
      t773 = 128*t551
      t779 = t504*z
      t780 = t779*t6
      t781 = t780*t513
      t792 = t143*(t413-5)*t39
      t805 = t510*t295
      t817 = t166+t167
      t818 = 128*t817
      t822 = l3*(t413-4)*t5
      t825 = t574*t629
      t829 = t243+t244
      t834 = t574*t729
      t843 = t5*t1
      t844 = l3*t228*t843
      t861 = -t661
      t863 = t143*t861*t39
      t864 = t863*t564
      t881 = t542*t397
      t900 = (-t412+t435-4)*t9
      t905 = (t412-t368+1)*t9
      t954 = t85*t5
      t980 = 2*t412
      t983 = t660*(t980-8*z+5)
      t986 = z*t4
      t987 = t986*t1
      t1026 = t412*l3
      t1037 = t491*t1
      s2 = t669*s1l1+((256*t506*t23*s3l1*s23r-256*t542*t62)*t160+((128*t
     #506*t241-256*t680+256*t682)*t149+((-384*t686+128*t688)*s34r+128*t5
     #63*t692+t696)*s23r+t579*s2l1+512*t145*t250+256*t574*t62)*s1vr+256*
     #t506*t23*s2l1*t520+(t593*s2l1+(128*t686-128*t688)*s34r-64*t600*t69
     #2+64*t600*t716)*t149+(t619*s2l1+(128*t529*t62-128*t529*t66)*t210+(
     #-128*t145*t626*t292-128*t730)*s34r-128*t734)*s23r+t646*s2l1-320*t1
     #53*t274+(-64*t184*t741-64*t184*t743)*s34r-64*t662*t62+64*t666*t66)
     #*s1l2+((256*t506*t287+256*t506*t290+256*t756+256*t757)*s23r-256*t5
     #42*t287-256*t542*t290-256*t765-256*t767)*t160
      s3 = s2+(((-256*t547+t772-t773)*s2l1+(128*t680-128*t682)*s2l2-128*
     #t781)*t149+((-t516*s2l2+(-128*t555-128*t557)*s34r+128*t792*t564-t5
     #69)*s2l1+((-128*t686-128*t688)*s34r+128*t792*t692-t696)*s2l2+(-256
     #*t510*t293-256*t805)*s34r+256*t567*t293+256*t567*t295)*s23r+(256*t
     #578*s2l2+t818*s34r-128*t822*t564+128*t825)*s2l1+(128*t829*s34r-128
     #*t822*t692+128*t834)*s2l2+(384*t294+384*t296-t311)*s34r-128*t844*t
     #293-128*t844*t295-128*t574*t412*t9*t12)*s1vr
      s1 = s3-256*t780*t512*t12*t520+((-256*t567*t71+64*t864-64*t863*t60
     #3)*s2l1+(64*t863*t692-64*t863*t716)*s2l2-384*t779*t32*t173*t127-38
     #4*t542*t394+(384*t881-512*t308*t6*t1*t9)*t12)*t149+(((-256*t532-25
     #6*t172*t513)*s2l2+(-128*t145*t651-128*t630)*s34r-128*t574*t900*t13
     #2-128*t574*t905*t374)*s2l1+((-128*t145*t741-128*t730)*s34r-128*t57
     #4*t900*t292-128*t574*t905*t384)*s2l2-128*t779*t207*t87*t420+((-512
     #*t166-128*t599*t6*t375)*s3l1-128*t599*t399*t295+(256*t145*t397+256
     #*t309*t2*t213*t9)*t12)*s34r+(-512*t635-128*t634*t45)*s3l1-128*t634
     #*t295+(256*t634*t397-128*t954*t614*t1*t9)*t12)*s23r
      t1047 = s1+((256*t325*t100+256*t843*t576)*s2l2+(-64*t197-128*t198)
     #*t210+(-64*t184*t654*t132-64*t184*t650*t374)*s34r-64*t983*t41-64*t
     #987*t214*t374)*s2l1+((-64*t262-128*t263)*t210+(-64*t184*t654*t292-
     #64*t184*t650*t384)*s34r-64*t983*t62-64*t987*t214*t384)*s2l2+((-128
     #*t197-192*t198)*s3l1-192*t342+t346)*t210+((-128*l3*t861*t39*t322+1
     #28*t326)*s3l1+128*t325*t295+(-128*t398+128*t1026*t499)*t12)*s34r+(
     #-128*t4*t414*t1*t41+64*t1037*t45)*s3l1+64*t1037*t295-128*t987*t44*
     #t384
      t1049 = t143**2
      t1050 = t1049*t6
      t1054 = t1049*t32*t1
      t1055 = t1054*t100
      t1056 = t505*t23
      t1057 = -t1055-t1056
      t1061 = t143*t5
      t1062 = t1061*t576
      t1063 = t506*t100+t1062
      t1068 = t149**2
      t1085 = t510*t211
      t1093 = t1050*t9
      t1097 = t504*t39
      t1098 = t1097*t9
      t1112 = 128*t1057
      t1121 = t504*(z+2)*t39
      t1128 = 128*t1063
      t1133 = t1061*z
      t1137 = 128*t1133*t45
      t1142 = t4*l3
      t1150 = t504*t598*t39
      t1160 = 128*t506*t215-128*t144*t23
      t1163 = (t368+4)*t9
      t1170 = t562*t5
      t1173 = t1061*t412
      t1181 = t5*l3
      t1184 = 128*t1085+256*t567*t100+128*t1181*t576
      t1186 = t510*t221
      t1189 = -t490*t9
      t1196 = -t1142*t641
      t1199 = t665*l3
      t1201 = 64*t1199*t45
      t1205 = t512*t127
      t1208 = -128*t145*t211-128*t954*t1205
      t1218 = t4*t9
      t1259 = 128*t1133*t66
      t1290 = t510*t274
      t1300 = 64*t1199*t66
      t1316 = t132*s2l1
      t1318 = t292*s2l2
      t1320 = t374*s3l1
      t1322 = t384*s3l2
      t1334 = t1061*t9
      t1345 = t1049*z
      t1350 = t504*t641*t39
      t1358 = t779*t39
      t1363 = t6*t9
      t1370 = t143*t641*t5
      t1380 = t143*(t413-1)*t5
      t1386 = t5*t9
      t1392 = l3*t641
      t1393 = t1392*t4
      t1401 = t1181*t9
      t1427 = 64*t551
      t1431 = t1061*(-t980+t413-3)
      t1460 = t143*(t980+z+1)*t5
      t1479 = t228*t9
      t1489 = t1142*(4*t412-6*z+3)
      t1554 = t4*t641
      t1588 = 64*t4*t9
      s2 = 256*t3*t6*t9*t12*s2l2*s2l1*t15+((-128*t22*t23*s2l2*s1vr+256*t
     #22*t23*s2l2*s23r+128*t34*t23*s34r*s2l2-64*t42+64*t46)*s1l1+(-128*t
     #22*t23*s2l1*s1vr+256*t22*t23*s2l1*s23r+128*t34*t23*s34r*s2l1-64*t6
     #3+64*t67)*s1l2+((-256*t22*t71+128*t74-128*t76)*s2l1+(128*t22*t62-1
     #28*t22*t66)*s2l2+128*t89)*s1vr+(-512*t22*t94-256*t89)*s23r+((-256*
     #t34*t100-512*t21*t23)*s2l2+(-128*t34*t41+128*t34*t45)*s34r-192*t42
     #+192*t46)*s2l1+((-128*t34*t62+128*t34*t66)*s34r-192*t63+192*t67)*s
     #2l2-128*t85*t32*t126*t127-128*t131*t133+128*t131*t137)*t14*s13r+t5
     #02*t14+t1047*s13r
      s4 = s2
      s7 = ((-256*t1050*t521+256*t1057*t149+256*t1063*s23r)*s1vr+256*t10
     #50*t23*t1068+(512*t1055+256*t1056)*t520+(256*t1049*t207*t2*t211+12
     #8*t506*t409-256*t1062)*t149+(-256*t1085-256*t542*t575*t127)*s23r)*
     #s1l2+(-128*t1093*t132*t149+256*t1098*t132*s23r-128*t1061*t41)*t160
     #+((-128*t1050*t71+128*t1050*t41-128*t1050*t45)*t520+(t1112*s2l2+(1
     #28*t1054*t41-128*t1054*t45)*s34r-128*t1121*t41-128*t505*t45)*t149+
     #(t1128*s2l2+(-384*t549+t773)*s34r+128*t1133*t41+t1137)*s23r+256*t5
     #42*t180+128*t1142*t41)*s1vr+(-128*t505*t71+64*t1150*t41-64*t1150*t
     #45)*t520+(t1160*s2l2+(64*t506*t1163*t132+64*t506*t430)*s34r-64*t11
     #70*t41-128*t1173*t45)*t149
      s6 = s7+(t1184*s2l2+192*t1186+(64*t542*t1189*t132+64*t568)*s34r+64
     #*t1196*t41+t1201)*s23r+t1208*s2l2+(-192*t166-64*t167)*t210+(-64*t5
     #74*t651-64*t825)*s34r+64*t1218*t132
      s7 = s1l1
      s5 = s6*s7
      s3 = s4+s5
      s4 = s3+((-128*t1093*t292*t149+256*t1098*t292*s23r-128*t1061*t62)*
     #t160+((-128*t1050*t241+128*t1050*t62-128*t1050*t66)*t520+(t1112*s2
     #l1+(128*t1054*t62-128*t1054*t66)*s34r-128*t1121*t62-128*t505*t66)*
     #t149+(t1128*s2l1+(-384*t680+128*t682)*s34r+128*t1133*t62+t1259)*s2
     #3r+256*t542*t250+128*t1142*t62)*s1vr+(-128*t505*t241+64*t1150*t62-
     #64*t1150*t66)*t520+(t1160*s2l1+(64*t506*t1163*t292+64*t506*t452)*s
     #34r-64*t1170*t62-128*t1173*t66)*t149+(t1184*s2l1+192*t1290+(64*t54
     #2*t1189*t292+64*t695)*s34r+64*t1196*t62+t1300)*s23r+t1208*s2l1+(-1
     #92*t243-64*t244)*t210+(-64*t574*t741-64*t834)*s34r+64*t1218*t292)*
     #s1l2
      s1 = s4+((-128*t1093*t1316-128*t1093*t1318-128*t1093*t1320-128*t10
     #93*t1322)*t149+(256*t1098*t1316+256*t1098*t1318+256*t1098*t1320+25
     #6*t1098*t1322)*s23r-128*t1334*t1316-128*t1334*t1318-128*t1334*t132
     #0-128*t1334*t1322)*t160+(128*t1345*t6*t521+(-128*t1350*t287-128*t1
     #350*t290+128*t1345*t32*t1205-256*t1358*t293-256*t1358*t295+128*t77
     #9*t1363*t12)*t149+(256*t1370*t287+256*t1370*t290+(-128*t756-128*t7
     #57-128*t781)*s34r+128*t1380*t293+128*t1380*t295-128*t143*t412*t138
     #6*t12)*s23r-128*t1393*t287-128*t1393*t290+(128*t765+128*t767)*s34r
     #-128*t1401*t1320-128*t1401*t1322)*s1vr
      s3 = s1+((64*t1097*t41-64*t1097*t45)*s2l1+(64*t1097*t62-64*t1097*t
     #66)*s2l2+128*t1098*t133+(-128*t1097*t397+128*t779*t1363)*t12)*t520
      s4 = s3+(((t772-t1427)*s34r+64*t1431*t41-t1137)*s2l1+((128*t680-64
     #*t682)*s34r+64*t1431*t62-t1259)*s2l2+((t550+t1427)*s3l1+64*t757+(-
     #128*t506*t397-128*t780*t478*t1*t9)*t12)*s34r+(256*t541*t41-64*t146
     #0*t45)*s3l1-64*t1460*t295+(-128*t541*t397-64*t308*t5*(-t980+t440-2
     #)*t9)*t12)*t149
      s2 = s4+((64*t1186+(64*t542*t1479*t132+64*t542*t655)*s34r+64*t1489
     #*t41-t1201)*s2l1+(64*t1290+(64*t542*t1479*t292+64*t542*t743)*s34r+
     #64*t1489*t62-t1300)*s2l2+((128*t555+64*t557)*s3l1+64*t805)*t210+((
     #128*t864-128*t563*t603)*s3l1-128*t562*t39*t1*t295+(128*t881-64*t30
     #8*t39*t424*t1*t9)*t12)*s34r+(128*t1142*t414*t41+64*t183*t45)*s3l1+
     #64*t183*t9*t1322+(128*t986*l3*t397-128*t1026*t1386)*t12)*s23r+(-64
     #*t817*t210+(-64*t635-64*t825)*s34r-64*t1554*t41)*s2l1
      taux1 = s2+(-64*t829*t210+(-64*t734-64*t834)*s34r-64*t1554*t62)*s2
     #l2+(-t818*s3l1-128*t296)*t210+((-128*t1392*t5*t564-64*t574*t45)*s3
     #l1-64*t574*t295)*s34r+(-128*t986*t41+t1588*t374)*s3l1+t1588*t1322
      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = -1+z
      t5 = t4**2
      t6 = t5**2
      t8 = t3*t6*l3
      t9 = s4vr**2
      t10 = 1/t9
      t11 = s3vr**2
      t12 = 1/t11
      t13 = t10*t12
      t18 = t2**2
      t19 = t6*t4
      t21 = t18*t19*l3
      t26 = t5*t4
      t27 = t3*t26
      t28 = t13*s3l2
      t30 = 256*t27*t28
      t31 = t10*s4l2
      t32 = t31*t12
      t34 = 256*t27*t32
      t45 = t13*s3l1
      t47 = 256*t27*t45
      t48 = t10*s4l1
      t49 = t48*t12
      t51 = 256*t27*t49
      t54 = t8*t28
      t55 = t8*t32
      t59 = t8*t45
      t60 = t8*t49
      t81 = s13r**2
      t84 = l3**2
      t85 = t84*t6
      t86 = t85*t2
      t87 = s1vr**2
      t92 = t13*s2l2
      t95 = t86*t28
      t97 = t86*t32
      t98 = 512*t97
      t102 = t84*t19*t3
      t103 = t13*s34r
      t104 = t102*t103
      t105 = l3*t6
      t106 = t2*t10
      t108 = t105*t106*t12
      t110 = 512*t104+512*t108
      t113 = t13*s3l2*s34r
      t116 = l3*t26
      t117 = t116*t2
      t118 = t117*t28
      t124 = -1024*t104+512*t108
      t126 = t102*t28
      t127 = t102*t32
      t129 = -512*t126-512*t127
      t136 = t6*t5
      t138 = t18*t136*t84
      t139 = s34r**2
      t140 = t13*t139
      t146 = -512*t138*t140-512*l3*t19*t3*t103
      t149 = t13*s3l2*t139
      t156 = t5*t2
      t157 = -z+3
      t158 = t156*t157
      t160 = 256*t158*t28
      t161 = t156*z
      t163 = 512*t161*t32
      t170 = t13*s2l1
      t173 = t86*t45
      t175 = t86*t49
      t176 = 512*t175
      t182 = t13*s3l1*s34r
      t185 = t117*t45
      t191 = t102*t45
      t192 = t102*t49
      t194 = 512*t191+512*t192
      t204 = t13*s3l1*t139
      t212 = 256*t158*t45
      t214 = 512*t161*t49
      t218 = t13*s3l2*s2l1
      t221 = t13*s3l1*s2l2
      t223 = t12*s3l1
      t224 = t31*t223
      t225 = t86*t224
      t226 = t12*s3l2
      t227 = t48*t226
      t228 = t86*t227
      t243 = t157*t10
      t247 = t105*t2
      t264 = -t102*t224+t102*t227
      t275 = 2*z
      t276 = -t275+1
      t277 = t276*t10
      t281 = s4l2*t12
      t292 = s4l1*t12
      t300 = t12*t139
      t305 = (4-t275)*t10
      t308 = -t276
      t309 = t308*t10
      t339 = -z-3
      t340 = t156*t339
      s2 = (-512*t86*t13*s3l2*t87+((1536*t86*t92+512*t95+t98)*s23r+t110*
     #s2l2+1024*t102*t113+1024*t118)*s1vr+(t124*s2l2+t129*s34r-256*t118-
     #256*t117*t32)*s23r+t146*s2l2-512*t138*t149+(-512*t54+256*t55)*s34r
     #-t160+t163)*s1l1+(512*t86*t13*s3l1*t87+((-1536*t86*t170-512*t173-t
     #176)*s23r-t110*s2l1-1024*t102*t182-1024*t185)*s1vr+(-t124*s2l1+t19
     #4*s34r+256*t185+256*t117*t49)*s23r-t146*s2l1+512*t138*t204+(512*t5
     #9-256*t60)*s34r+t212-t214)*s1l2
      s1 = s2+(-512*t86*t218+512*t86*t221+512*t225-512*t228)*t87+(((-102
     #4*t95-1024*t97)*s2l1+(1024*t173+1024*t175)*s2l2)*s23r+((512*t126-5
     #12*t127)*s34r+512*t117*t243*t226-512*t247*t32)*s2l1+((-512*t191+51
     #2*t192)*s34r-512*t117*t243*t223+512*t247*t49)*s2l2+1024*t264*s34r-
     #1024*t117*t224+1024*t117*t227)*s1vr+((-t129*s34r+256*t117*t277*t22
     #6+256*t117*t277*t281)*s2l1+(-t194*s34r-256*t117*t277*t223-256*t117
     #*t277*t292)*s2l2)*s23r
      t345 = s1+(512*t138*t31*t300+(-256*t8*t305*t226+256*t8*t309*t281)*
     #s34r-t160+t163)*s2l1+(-512*t138*t48*t300+(256*t8*t305*t223-256*t8*
     #t309*t292)*s34r+t212-t214)*s2l2+(512*t138*t224-512*t138*t227)*t139
     #+(768*t8*t224-768*t8*t227)*s34r-256*t340*t224+256*t340*t227
      t347 = t84*l3
      t348 = t347*t6
      t349 = t348*t1
      t353 = t84*t26
      t354 = t353*t1
      t361 = t349*t28
      t362 = 1024*t361
      t363 = t349*t32
      t366 = s23r**2
      t368 = t347*t19
      t369 = t368*t2
      t370 = t369*t103
      t371 = t1*t10
      t372 = t371*t12
      t373 = t85*t372
      t375 = -1024*t370-1024*t373
      t377 = t369*t28
      t379 = t369*t32
      t383 = -t4
      t384 = t353*t383
      t385 = t371*t226
      t388 = t85*t1
      t390 = 512*t388*t32
      t395 = l3*t1*t5
      t396 = z*t10
      t397 = t396*t12
      t400 = 512*t86*t103+512*t395*t397
      t404 = l3*t5
      t405 = -t157
      t406 = t404*t405
      t413 = 512*t370-1024*t373
      t418 = -t275+3
      t419 = t353*t418
      t422 = t371*t281
      t428 = t347*t136*t3
      t432 = 512*t428*t140-512*t105*t372
      t440 = z*t84*t6
      t443 = -z-1
      t444 = t443*t10
      t449 = (-512*t440*t106*t226-512*t86*t444*t281)*s34r
      t450 = t404*t383
      t456 = z*l3
      t462 = -512*t102*t140-512*t456*t26*t106*t12*s34r
      t466 = t405*t10
      t469 = -t443
      t470 = t469*t10
      t478 = -t383*t418*t1
      t480 = 256*t478*t28
      t481 = z**2
      t482 = t481*t4
      t483 = t482*t1
      t485 = 256*t483*t32
      t497 = t349*t45
      t498 = 1024*t497
      t499 = t349*t49
      t505 = t369*t45
      t507 = t369*t49
      t511 = t371*t223
      t515 = 512*t388*t49
      t533 = t371*t292
      t551 = (512*t440*t106*t223+512*t86*t444*t292)*s34r
      t568 = 256*t478*t45
      t570 = 256*t483*t49
      t575 = t349*t224
      t576 = t349*t227
      t584 = t354*t224
      t586 = t354*t227
      t601 = 3*t383
      t602 = t353*t601
      t616 = t369*t224-t369*t227
      t628 = t404*t418
      t632 = t395*t396*t281
      t642 = t395*t396*t292
      t646 = -t225+t228
      t651 = l3*t405*t5*t1
      t658 = t353*t276
      t672 = t404*(t481-t275+1)
      t676 = t404*(-t481+z)
      t690 = t84*(t275+1)*t6*t2
      t697 = t404*t383*t1
      t709 = -t601*t10
      t712 = t383*t10
      t737 = t116*t2*t383
      t744 = t5*t339*t1
      s3 = ((1024*t349*t13*s3l2*s23r-1024*t354*t28)*t87+((-1536*t349*t92
     #-t362-1024*t363)*t366+(t375*s2l2+(-1536*t377-512*t379)*s34r-512*t3
     #84*t385-t390)*s23r+t400*s2l2+1536*t86*t113-512*t406*t385)*s1vr+(t4
     #13*s2l2+(512*t377+512*t379)*s34r+256*t419*t385+256*t419*t422)*t366
     #+(t432*s2l2+(512*t428*t28+512*t428*t32)*t139+t449-512*t450*t422)*s
     #23r+t462*s2l2-768*t102*t149+(256*t117*t466*t226-256*t117*t470*t281
     #)*s34r-t480-t485)*s1l1
      s4 = ((-1024*t349*t13*s3l1*s23r+1024*t354*t45)*t87+((1536*t349*t17
     #0+t498+1024*t499)*t366+(-t375*s2l1+(1536*t505+512*t507)*s34r+512*t
     #384*t511+t515)*s23r-t400*s2l1-1536*t86*t182+512*t406*t511)*s1vr+(-
     #t413*s2l1+(-512*t505-512*t507)*s34r-256*t419*t511-256*t419*t533)*t
     #366+(-t432*s2l1+(-512*t428*t45-512*t428*t49)*t139+t551+512*t450*t5
     #33)*s23r-t462*s2l1+768*t102*t204+(-256*t117*t466*t223+256*t117*t47
     #0*t292)*s34r+t568+t570)*s1l2+((1024*t349*t218-1024*t349*t221-1024*
     #t575+1024*t576)*s23r-1024*t354*t218+1024*t354*t221+1024*t584-1024*
     #t586)*t87
      s2 = s3+s4
      s1 = s2+(((512*t361+512*t363)*s2l1+(-512*t497-512*t499)*s2l2)*t366
     #+(((-512*t377+512*t379)*s34r-512*t602*t385+t390)*s2l1+((512*t505-5
     #12*t507)*s34r+512*t602*t511-t515)*s2l2+1024*t616*s34r-1024*t388*t2
     #24+1024*t388*t227)*s23r+((1024*t95-t98)*s34r+512*t628*t385-512*t63
     #2)*s2l1+((-1024*t173+t176)*s34r-512*t628*t511+512*t642)*s2l2+1536*
     #t646*s34r+512*t651*t224-512*t651*t227)*s1vr+((-256*t658*t385-256*t
     #658*t422)*s2l1+(256*t658*t511+256*t658*t533)*s2l2)*t366+((t449+512
     #*t672*t385-512*t676*t422)*s2l1+(t551-512*t672*t511+512*t676*t533)*
     #s2l2+(512*t690*t224-512*t690*t227)*s34r-512*t697*t224+512*t697*t22
     #7)*s23r
      t749 = s1+((-256*t126+512*t127)*t139+(256*t117*t709*t226-256*t117*
     #t712*t281)*s34r-t480-t485)*s2l1+((256*t191-512*t192)*t139+(-256*t1
     #17*t709*t223+256*t117*t712*t292)*s34r+t568+t570)*s2l2-768*t264*t13
     #9+(512*t737*t224-512*t737*t227)*s34r+256*t744*t224-256*t744*t227
      t751 = t84**2
      t752 = t751*t6
      t753 = t752*t10
      t757 = t347*t26
      t758 = t757*t10
      t762 = t84*t5
      t772 = t366*s23r
      t775 = t751*t19*t1
      t779 = 512*t775*t103+512*t348*t13
      t786 = t757*t443
      t796 = -512*t349*t103-512*t762*t397
      t801 = t762*t276
      t804 = t762*z
      t806 = 512*t804*t32
      t809 = t354*t113
      t817 = t757*t276
      t828 = 512*t368*t1*t103+512*t85*t13
      t831 = t347*z*t6
      t834 = t348*t308
      t840 = 3*z-1
      t841 = t762*t840
      t846 = t762*(2*t481-2*z+2)
      t854 = -512*t388*t103-512*t404*t397
      t857 = 256*t369*t149
      t858 = t353*t840
      t860 = t353*t157
      t865 = t4*l3
      t868 = t456*t4
      t870 = (-z+2)*t10
      t878 = (-256*t95+256*t97)*t139
      t879 = t116*t1
      t883 = (256*t879*t28+256*t632)*s34r
      t885 = 256*t712*t226
      t925 = 512*t804*t49
      t928 = t354*t182
      t959 = 256*t369*t204
      t974 = (256*t173-256*t175)*t139
      t978 = (-256*t879*t45-256*t642)*s34r
      t980 = 256*t712*t223
      t983 = t226*s2l1
      t985 = t223*s2l2
      t987 = t281*s3l1
      t989 = t292*s3l2
      t1001 = t762*t10
      t1012 = t757*z
      t1022 = -t762*t840
      t1032 = t575-t576
      t1041 = t865*t383
      t1053 = t404*t10
      t1076 = 2*t481
      t1078 = t762*(t1076-z+1)
      t1095 = t762*(-z-1-t1076)
      t1103 = t84*t469*t26
      t1110 = t865*(-1-t1076+t275)
      t1113 = t482*l3
      t1133 = t353*t1*t443
      t1157 = t4*t10
      s3 = ((-512*t8*t13*s2l2*s1vr+512*t21*t13*s34r*s2l2-t30-t34)*s1l1+(
     #512*t8*t13*s2l1*s1vr-512*t21*t13*s34r*s2l1+t47+t51)*s1l2+((512*t54
     #+512*t55)*s2l1+(-512*t59-512*t60)*s2l2)*s1vr+((-512*t21*t28-512*t2
     #1*t32)*s34r-t30-t34)*s2l1+((512*t21*t45+512*t21*t49)*s34r+t47+t51)
     #*s2l2)*t81*s13r+t345*t81
      s2 = s3+t749*s13r+((-512*t753*t226*t366+1024*t758*t226*s23r-512*t7
     #62*t28)*t87+((512*t752*t92+512*t752*t28+512*t752*t32)*t772+(t779*s
     #2l2+(512*t775*t28+512*t775*t32)*s34r+512*t786*t28+512*t348*t32)*t3
     #66+(t796*s2l2+(-t362-512*t363)*s34r-512*t801*t28-t806)*s23r+512*t8
     #09-512*t404*t28)*s1vr+(512*t348*t92-256*t817*t28-256*t817*t32)*t77
     #2+(t828*s2l2+(512*t831*t385+256*t834*t422)*s34r-256*t841*t28+256*t
     #846*t32)*t366+(t854*s2l2+t857+(-256*t858*t385+256*t860*t422)*s34r+
     #256*t865*t28+256*t868*t870*t281)*s23r+t878+t883-t885)*s1l1
      s3 = s2+((512*t753*t223*t366-1024*t758*t223*s23r+512*t762*t45)*t87
     #+((-512*t752*t170-512*t752*t45-512*t752*t49)*t772+(-t779*s2l1+(-51
     #2*t775*t45-512*t775*t49)*s34r-512*t786*t45-512*t348*t49)*t366+(-t7
     #96*s2l1+(t498+512*t499)*s34r+512*t801*t45+t925)*s23r-512*t928+512*
     #t404*t45)*s1vr+(-512*t348*t170+256*t817*t45+256*t817*t49)*t772+(-t
     #828*s2l1+(-512*t831*t511-256*t834*t533)*s34r+256*t841*t45-256*t846
     #*t49)*t366+(-t854*s2l1-t959+(256*t858*t511-256*t860*t533)*s34r-256
     #*t865*t45-256*t868*t870*t292)*s23r+t974+t978+t980)*s1l2
      s1 = s3+((-512*t753*t983+512*t753*t985+512*t753*t987-512*t753*t989
     #)*t366+(1024*t758*t983-1024*t758*t985-1024*t758*t987+1024*t758*t98
     #9)*s23r-512*t1001*t983+512*t1001*t985+512*t1001*t987-512*t1001*t98
     #9)*t87+((-1024*t1012*t218+1024*t1012*t221+1024*t1012*t224-1024*t10
     #12*t227)*t366+((-512*t349*t113-512*t1022*t28)*s2l1+(512*t349*t182+
     #512*t1022*t45)*s2l2+512*t1032*s34r-512*t841*t224+512*t841*t227)*s2
     #3r+(512*t809+512*t1041*t28)*s2l1+(-512*t928-512*t1041*t45)*s2l2+(-
     #512*t584+512*t586)*s34r+512*t1053*t987-512*t1053*t989)*s1vr+((256*
     #t757*t28+256*t757*t32)*s2l1+(-256*t757*t45-256*t757*t49)*s2l2)*t77
     #2
      taux2 = s1+(((512*t361+256*t363)*s34r-256*t1078*t28+t806)*s2l1+((-
     #512*t497-256*t499)*s34r+256*t1078*t45-t925)*s2l2-256*t1032*s34r-25
     #6*t1095*t224+256*t1095*t227)*t366+((t857+(-256*t1103*t385+256*t110
     #3*t422)*s34r-256*t1110*t28+256*t1113*t32)*s2l1+(-t959+(256*t1103*t
     #511-256*t1103*t533)*s34r+256*t1110*t45-256*t1113*t49)*s2l2-256*t61
     #6*t139+(-512*t1133*t224+512*t1133*t227)*s34r+256*t450*t224-256*t45
     #0*t227)*s23r+(t878+t883-t885)*s2l1+(t974+t978+t980)*s2l2-512*t646*
     #t139+(256*t395*t224-256*t395*t227)*s34r-256*t1157*t987+256*t1157*t
     #989

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = taux2

CCC Jet functions

      t1 = 1-l3
      t2 = -z+1
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,27.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t2 = -z+1
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet2 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,27.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = 1-l3
      t2 = -z+1
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,28.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t2 = -z+1
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet4 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,28.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      B2num1e0 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcoff4
      RETURN
      END

      double precision function B2num1e1(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3-1
      t2 = t1**2
      t3 = t2**2
      t4 = -1+z
      t5 = t4**2
      t6 = t5**2
      t9 = s4vr**2
      t10 = 1/t9
      t11 = s3vr**2
      t12 = 1/t11
      t13 = t10*t12
      t14 = s13r**2
      t15 = t14**2
      t19 = z*l3
      t20 = t19*t6
      t21 = t2*t1
      t22 = t21*t10
      t23 = t12*s23r
      t27 = t6*t4
      t29 = t3*t10
      t30 = t12*s34r
      t41 = t21*t6
      t42 = t41*l3
      t48 = t13*s34r*s2l2
      t50 = 128*t42*t48
      t51 = t13*s3l2
      t53 = t10*s4l2
      t54 = t53*t12
      t58 = (64*t42*t51+64*t42*t54)*s34r
      t60 = z+1
      t61 = t5*t2*t60
      t63 = 64*t61*t51
      t65 = 64*t61*t54
      t69 = t13*s34r*s2l1
      t72 = t13*s3l1
      t74 = t10*s4l1
      t75 = t74*t12
      t79 = (64*t42*t72+64*t42*t75)*s34r
      t81 = 64*t61*t72
      t83 = 64*t61*t75
      t86 = l3**2
      t87 = z*t86
      t88 = t60*t6
      t90 = t2*t10
      t91 = s1vr**2
      t97 = t87*t27*t21
      t98 = 2*z
      t99 = t98+1
      t100 = t99*t10
      t103 = t5*t4
      t111 = t87*t6
      t112 = s23r**2
      t113 = t12*t112
      t129 = t6*t5
      t134 = s34r**2
      t135 = t12*t134
      t140 = 3*z
      t146 = z*t5
      t148 = z**2
      t149 = 3*t148
      t150 = 4*z
      t156 = (128*t42*t13*s34r*s1l2+t50+t58+t63+t65)*s1l1+(128*t42*t69+t
     #79+t81+t83)*s1l2+128*t87*t88*t90*t12*t91+(-128*t97*t100*t30-128*t1
     #9*t103*t2*t60*t13)*s1vr+768*t111*t90*t113+(768*t87*t27*t22*t30+768
     #*t20*t90*t12)*s23r+(t50+t58+t63+t65)*s2l1+(t79+t81+t83)*s2l2-64*t8
     #7*t129*t3*(-t98-3)*t10*t135-128*t19*t41*(-t140+4)*t10*t30-64*t146*
     #t2*(-t149+t150-3)*t10*t12
      t158 = t86*t6
      t159 = t158*t2
      t165 = t86*t27*t21
      t166 = t13*t134
      t167 = t165*t166
      t171 = t13*s34r
      t172 = l3*t6*t2*t171
      t183 = l3*t5
      t184 = t183*t1
      t185 = t60*t10
      t186 = t12*s3l2
      t191 = l3*t60*t5
      t192 = t1*t10
      t193 = s4l2*t12
      t194 = t192*t193
      t197 = -256*t159*t48+(-128*t159*t51-128*t159*t54)*s34r-128*t184*t1
     #85*t186-128*t191*t194
      t200 = -128*t167-128*t172
      t201 = t200*s2l2
      t206 = (-64*t165*t51-64*t165*t54)*t134
      t208 = l3*t103*t2
      t210 = (t98-1)*t10
      t211 = t210*t186
      t217 = (-64*t208*t211-64*t208*t100*t193)*s34r
      t219 = t148-z-2
      t220 = t4*t1*t219
      t222 = 64*t220*t51
      t223 = z*t4
      t224 = t223*t1
      t225 = t185*t193
      t227 = 64*t224*t225
      t236 = (-128*t159*t72-128*t159*t75)*s34r
      t237 = t12*s3l1
      t240 = 128*t184*t185*t237
      t241 = s4l1*t12
      t242 = t192*t241
      t244 = 128*t191*t242
      t252 = (-64*t165*t72-64*t165*t75)*t134
      t253 = t210*t237
      t259 = (-64*t208*t253-64*t208*t100*t241)*s34r
      t261 = 64*t220*t72
      t262 = t185*t241
      t264 = 64*t224*t262
      t267 = t86*l3
      t268 = t267*z
      t274 = t267*t27*t2
      t275 = z*t10
      t276 = t275*t30
      t277 = t274*t276
      t279 = t87*t60
      t288 = t90*t30
      t298 = t275*t135
      t299 = t267*t21*t129*t298
      t312 = t112*s23r
      t326 = t6*t2
      t333 = t19*t5
      t334 = 6*z
      t346 = t6*t103
      t349 = t12*t134*s34r
      s1 = ((-256*t159*t13*s34r*s23r-128*t167-128*t172)*s1l2+t197*s23r+t
     #201+t206+t217-t222-t227)*s1l1+((-256*t159*t69+t236-t240-t244)*s23r
     #+t200*s2l1+t252+t259-t261-t264)*s1l2+(-256*t268*t88*t192*t23-128*t
     #277+128*t279*t103*t1*t13)*t91+((256*t268*t60*t27*t288-256*t279*t6*
     #t1*t13)*s23r+128*t299-384*t86*t148*t6*t288-128*t184*z*t60*t13)*s1v
     #r-512*t268*t6*t192*t12*t312+(-768*t277-768*t111*t192*t12)*t112
      t372 = s1+(t197*s2l1+(t236-t240-t244)*s2l2-384*t299+256*t87*t326*(
     #t148-z+4)*t10*t30+128*t333*(-t148+t334-3)*t1*t13)*s23r+(t201+t206+
     #t217-t222-t227)*s2l1+(t252+t259-t261-t264)*s2l2-64*t268*t346*t29*t
     #349+64*t97*(t140+5)*t10*t135+64*t19*t103*t2*(-t148+8*z-5)*t10*t30+
     #64*t146*t1*(-t148-1)*t10*t12
      t375 = t267*t6*t1
      t384 = 128*t274*t166+128*t158*t1*t171
      t386 = t159*t166
      t388 = t184*t276
      t400 = t86*t60*t5
      t405 = 128*t375*t48+(64*t375*t51+64*t375*t54)*s34r+64*t400*t51+64*
     #t400*t54
      t414 = t86*t103*t1
      t417 = t86*t99*t103
      t423 = t4*l3*t219
      t426 = t223*l3
      t429 = t384*s2l2+(64*t274*t51+64*t274*t54)*t134+(64*t414*t211+64*t
     #417*t194)*s34r+64*t423*t51+64*t426*t225
      t432 = -128*t386-128*t388
      t433 = t432*s2l2
      t437 = 64*t159*t13*s3l2*t134
      t439 = t183*t1*z
      t443 = 128*t439*t13*s3l2*s34r
      t444 = t4*t60
      t446 = 64*t444*t51
      t455 = (64*t375*t72+64*t375*t75)*s34r
      t457 = 64*t400*t72
      t459 = 64*t400*t75
      t467 = (64*t274*t72+64*t274*t75)*t134
      t472 = (64*t414*t253+64*t417*t242)*s34r
      t474 = 64*t423*t72
      t476 = 64*t426*t262
      t483 = 64*t159*t13*s3l1*t134
      t487 = 128*t439*t13*s3l1*s34r
      t489 = 64*t444*t72
      t492 = t86**2
      t493 = t492*z
      t495 = t6*t10
      t501 = t192*t30
      t502 = t492*t27*z*t501
      t518 = (2*t148+z-1)*t10*t12
      t525 = t492*t129*t2*t298
      t529 = t87*t5
      t542 = t112**2
      t573 = t22*t349
      t602 = t53*t237
      t605 = t74*t186
      t615 = 2*t183*t1*t60
      t629 = (64+128*z+64*t148)*t10
      s1 = 128*t3*t6*z*t13*t15+(-512*t20*t22*t23-256*t19*t27*t29*t30-256
     #*z*t6*t22*t12)*t14*s13r+t156*t14+t372*s13r+((128*t375*t13*s34r*t11
     #2+t384*s23r-128*t386-128*t388)*s1l2+t405*t112+t429*s23r+t433-t437-
     #t443-t446)*s1l1+((128*t375*t69+t455+t457+t459)*t112+(t384*s2l1+t46
     #7+t472+t474+t476)*s23r+t432*s2l1-t483-t487-t489)*s1l2+(128*t493*t6
     #0*t495*t113+(128*t502-128*t268*t60*t103*t10*t12)*s23r-128*t375*t27
     #6)*t91+((-128*t502+128*t268*t103*t518)*t112+(-128*t525+128*t267*t1
     #48*t6*t501-128*t529*t518)*s23r+128*t274*t298-128*t111*t501)*s1vr+1
     #28*t492*t6*z*t13*t542
      taux1 = s1+(256*t502+256*t268*t495*t12)*t312+(t405*s2l1+(t455+t457
     #+t459)*s2l2+192*t525-128*t268*t6*(-z+4)*t501-64*t529*(-2*t148*z-t1
     #49+t334-3)*t10*t12)*t112+(t429*s2l1+(t467+t472+t474+t476)*s2l2+64*
     #t493*t346*t573-64*t268*t27*t2*(z+5)*t10*t135-64*t87*t103*(-t148+t1
     #50-5)*t501-64*t333*(t148+t98-1)*t10*t12)*s23r+(t433-t437-t443-t446
     #)*s2l1+(-t483-t487-t489)*s2l2-64*t268*t129*t573+(64*t159*t602+64*t
     #159*t605+128*t279*t326*t13)*t134+(64*t615*t602+64*t615*t605+64*t19
     #*t1*t5*(t148+t150-1)*t13)*s34r+t629*t193*s3l1+t629*t241*s3l2
      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = -1+z
      t5 = t4**2
      t6 = t5**2
      t8 = t3*t6*l3
      t9 = s4vr**2
      t10 = 1/t9
      t11 = s3vr**2
      t12 = 1/t11
      t13 = t10*t12
      t17 = t2**2
      t18 = t6*t4
      t20 = t17*t18*l3
      t24 = t5*t4
      t25 = t3*t24
      t26 = t13*s3l2
      t27 = t25*t26
      t28 = t10*s4l2
      t29 = t28*t12
      t30 = t25*t29
      t40 = t13*s3l1
      t41 = t25*t40
      t42 = t10*s4l1
      t43 = t42*t12
      t44 = t25*t43
      t48 = t8*t26
      t49 = t8*t29
      t53 = t8*t40
      t54 = t8*t43
      t79 = s13r**2
      t82 = l3**2
      t83 = t82*t6
      t84 = t83*t2
      t85 = s1vr**2
      t90 = t13*s2l2
      t93 = t84*t26
      t95 = t84*t29
      t96 = 1536*t95
      t100 = t82*t18*t3
      t101 = t13*s34r
      t102 = t100*t101
      t103 = l3*t6
      t104 = t2*t10
      t106 = t103*t104*t12
      t108 = -1024*t102-1024*t106
      t111 = t13*s3l2*s34r
      t114 = l3*t24
      t115 = t114*t2
      t116 = t115*t26
      t122 = 2048*t102-1024*t106
      t124 = t100*t26
      t125 = t100*t29
      t127 = 1536*t124+1536*t125
      t134 = t6*t5
      t136 = t17*t134*t82
      t137 = s34r**2
      t138 = t13*t137
      t144 = 1024*t136*t138+1024*l3*t18*t3*t101
      t154 = t5*t2
      t155 = 2*z
      t156 = t155-6
      t158 = -z+3
      t160 = 2*t154*t158
      t162 = (-t154*t156+t160)*t10
      t163 = t12*s3l2
      t166 = t154*z
      t175 = t13*s2l1
      t178 = t84*t40
      t180 = t84*t43
      t181 = 1536*t180
      t187 = t13*s3l1*s34r
      t190 = t115*t40
      t196 = t100*t40
      t197 = t100*t43
      t199 = -1536*t196-1536*t197
      t216 = t12*s3l1
      t224 = t13*s3l2*s2l1
      t227 = t13*s3l1*s2l2
      t229 = t28*t216
      t230 = t84*t229
      t231 = t42*t163
      t232 = t84*t231
      t254 = (-t114*t2*(z-4)+2*t114*t2*t158)*t10
      t257 = t103*t2
      t273 = t100*t229-t100*t231
      t287 = -t155+1
      t292 = (-t114*t2*(t155-8)+2*t114*t2*t287)*t10
      t295 = s4l2*t12
      t304 = s4l1*t12
      t311 = t12*t137
      t315 = -t287
      t317 = t103*t3*t315
      t318 = 4-t155
      t323 = (-t317+2*t103*t3*t318)*t10
      t325 = -t155-3
      t330 = (-t103*t3*t325+2*t317)*t10
      t335 = 6*z
      t339 = (-t154*(t335-10)+t160)*t10
      t346 = (-t154*(-t335+2)+4*t166)*t10
      t375 = z+7
      t377 = -z-3
      t381 = (-t154*t375+2*t154*t377)*t10
      t382 = t295*s3l1
      t385 = t304*s3l2
      s2 = (1536*t84*t13*s3l2*t85+((-3072*t84*t90-1536*t93-t96)*s23r+t10
     #8*s2l2-3072*t100*t111-2560*t116)*s1vr+(t122*s2l2+t127*s34r-512*t11
     #6-512*t115*t29)*s23r+t144*s2l2+1536*t136*t13*s3l2*t137+(768*t48-12
     #80*t49)*s34r+256*t162*t163-2048*t166*t29)*s1l1+(-1536*t84*t13*s3l1
     #*t85+((3072*t84*t175+1536*t178+t181)*s23r-t108*s2l1+3072*t100*t187
     #+2560*t190)*s1vr+(-t122*s2l1+t199*s34r+512*t190+512*t115*t43)*s23r
     #-t144*s2l1-1536*t136*t13*s3l1*t137+(-768*t53+1280*t54)*s34r-256*t1
     #62*t216+2048*t166*t43)*s1l2
      s1 = s2+(1536*t84*t224-1536*t84*t227-1536*t230+1536*t232)*t85+(((3
     #072*t93+3072*t95)*s2l1+(-3072*t178-3072*t180)*s2l2)*s23r+((-1536*t
     #124+1536*t125)*s34r-512*t254*t163+1536*t257*t29)*s2l1+((1536*t196-
     #1536*t197)*s34r+512*t254*t216-1536*t257*t43)*s2l2+3072*t273*s34r+3
     #072*t115*t229-3072*t115*t231)*s1vr+((-t127*s34r-256*t292*t163-256*
     #t292*t295)*s2l1+(-t199*s34r+256*t292*t216+256*t292*t304)*s2l2)*s23
     #r
      t388 = s1+(-1536*t136*t28*t311+(256*t323*t163-256*t330*t295)*s34r+
     #256*t339*t163-256*t346*t295)*s2l1+(1536*t136*t42*t311+(-256*t323*t
     #216+256*t330*t304)*s34r-256*t339*t216+256*t346*t304)*s2l2+(-1536*t
     #136*t229+1536*t136*t231)*t137+(-2304*t8*t229+2304*t8*t231)*s34r+25
     #6*t381*t382-256*t381*t385
      t390 = t82*l3
      t391 = t390*t6
      t392 = t391*t1
      t396 = t82*t24
      t397 = t396*t1
      t403 = t392*t26
      t404 = t392*t29
      t407 = s23r**2
      t409 = t390*t18
      t410 = t409*t2
      t411 = t410*t101
      t412 = t1*t10
      t413 = t412*t12
      t414 = t83*t413
      t416 = 2048*t411+2048*t414
      t418 = t410*t26
      t420 = t410*t29
      t424 = z+1
      t425 = t396*t424
      t426 = -t4
      t430 = (-t425+2*t396*t426)*t1
      t433 = t83*t1
      t435 = 1536*t433*t29
      t440 = l3*t1*t5
      t441 = z*t10
      t442 = t441*t12
      t445 = -1024*t84*t101-1024*t440*t442
      t449 = l3*t5
      t450 = -t158
      t454 = (-2*t449+2*t449*t450)*t1
      t461 = -1024*t411+2048*t414
      t468 = -t155+3
      t472 = (-t396*(t155+4)+2*t396*t468)*t1
      t480 = t390*t134*t3
      t484 = -1024*t480*t138+1024*t103*t413
      t496 = 2*t83*t2*z
      t498 = (-t83*t2*(z+4)-t496)*t10
      t500 = z-2
      t503 = -t424
      t508 = (-t83*t2*t500+2*t83*t2*t503)*t10
      t509 = t508*t295
      t514 = -t449*t318
      t518 = t449*z
      t519 = t449*t426
      t522 = (2*t518+2*t519)*t1
      t528 = z*l3
      t534 = 1024*t100*t138+1024*t528*t24*t104*t12*s34r
      t544 = (-t257+2*t114*t2*t450)*t10
      t546 = 3*z
      t547 = -t546-1
      t551 = t114*t2*t424
      t554 = (-t114*t2*t547+2*t551)*t10
      t559 = 4*z
      t562 = 2*t4
      t564 = -t562*t468
      t566 = (t426*(6-t559)+t564)*t1
      t569 = z**2
      t570 = t569*t4
      t571 = t570*t1
      t584 = t392*t40
      t585 = t392*t43
      t591 = t410*t40
      t593 = t410*t43
      t600 = 1536*t433*t43
      t630 = t508*t304
      t660 = t392*t229
      t661 = t392*t231
      t669 = t397*t229
      t671 = t397*t231
      t688 = 3*t426
      t692 = (-t396*(t546-5)+2*t396*t688)*t1
      t706 = -t410*t229+t410*t231
      t723 = (-t449*(t546-4)+2*t449*t468)*t1
      t727 = t440*t441*t295
      t737 = t440*t441*t304
      t741 = t230-t232
      t746 = l3*t450*t5*t1
      t757 = (-t396*t156+2*t396*t287)*t1
      t770 = z+2
      t774 = (-t83*t2*t770-t496)*t10
      t785 = (-t449*(-7-t569+t335)+2*t449*(1-t155+t569))*t1
      t794 = (-t449*(t569-t559+1)+2*t449*(-t569+z))*t1
      t812 = t82*(t155+1)*t6*t2
      t818 = z-5
      t821 = -t449*t818+2*t519
      t823 = t821*t1*t10
      t841 = (-t114*t2*t377-2*t114*t2*t688)*t10
      t843 = t426*t10
      t850 = 2*t569
      t854 = (t426*(-10*z+8+t850)+t564)*t1
      t862 = (z*t4*t562+2*t570)*t1
      t890 = (-t551+2*t114*t2*t426)*t10
      t901 = (-t5*t375+2*t5*t377)*t1*t10
      s3 = ((-3072*t392*t13*s3l2*s23r+3072*t397*t26)*t85+((3072*t392*t90
     #+3072*t403+3072*t404)*t407+(t416*s2l2+(4608*t418+1536*t420)*s34r+5
     #12*t430*t26+t435)*s23r+t445*s2l2-5120*t84*t111+512*t454*t26)*s1vr+
     #(t461*s2l2+(-1536*t418-1536*t420)*s34r-256*t472*t26-256*t472*t29)*
     #t407+(t484*s2l2+(-1536*t480*t26-1536*t480*t29)*t137+(-512*t498*t16
     #3+512*t509)*s34r+512*t514*t412*t163+512*t522*t29)*s23r+t534*s2l2+(
     #2816*t124+256*t125)*t137+(-256*t544*t163+256*t554*t295)*s34r-256*t
     #566*t26+1024*t571*t29)*s1l1
      s4 = ((3072*t392*t13*s3l1*s23r-3072*t397*t40)*t85+((-3072*t392*t17
     #5-3072*t584-3072*t585)*t407+(-t416*s2l1+(-4608*t591-1536*t593)*s34
     #r-512*t430*t40-t600)*s23r-t445*s2l1+5120*t84*t187-512*t454*t40)*s1
     #vr+(-t461*s2l1+(1536*t591+1536*t593)*s34r+256*t472*t40+256*t472*t4
     #3)*t407+(-t484*s2l1+(1536*t480*t40+1536*t480*t43)*t137+(512*t498*t
     #216-512*t630)*s34r-512*t514*t412*t216-512*t522*t43)*s23r-t534*s2l1
     #+(-2816*t196-256*t197)*t137+(256*t544*t216-256*t554*t304)*s34r+256
     #*t566*t40-1024*t571*t43)*s1l2+((-3072*t392*t224+3072*t392*t227+307
     #2*t660-3072*t661)*s23r+3072*t397*t224-3072*t397*t227-3072*t669+307
     #2*t671)*t85
      s2 = s3+s4
      s1 = s2+(((-1536*t403-1536*t404)*s2l1+(1536*t584+1536*t585)*s2l2)*
     #t407+(((1536*t418-1536*t420)*s34r+512*t692*t26-t435)*s2l1+((-1536*
     #t591+1536*t593)*s34r-512*t692*t40+t600)*s2l2+3072*t706*s34r+3072*t
     #433*t229-3072*t433*t231)*s23r+((-2560*t93+t96)*s34r-512*t723*t26+1
     #536*t727)*s2l1+((2560*t178-t181)*s34r+512*t723*t40-1536*t737)*s2l2
     #+4608*t741*s34r-1536*t746*t229+1536*t746*t231)*s1vr+((256*t757*t26
     #+256*t757*t29)*s2l1+(-256*t757*t40-256*t757*t43)*s2l2)*t407+(((-51
     #2*t774*t163+512*t509)*s34r-512*t785*t26+512*t794*t29)*s2l1+((512*t
     #774*t216-512*t630)*s34r+512*t785*t40-512*t794*t43)*s2l2+(-1536*t81
     #2*t229+1536*t812*t231)*s34r+512*t823*t382-512*t823*t385)*s23r
      t906 = s1+((768*t124-1280*t125)*t137+(-256*t841*t163+256*t115*t843
     #*t295)*s34r-256*t854*t26+256*t862*t29)*s2l1+((-768*t196+1280*t197)
     #*t137+(256*t841*t216-256*t115*t843*t304)*s34r+256*t854*t40-256*t86
     #2*t43)*s2l2-2304*t273*t137+(-512*t890*t382+512*t890*t385)*s34r-256
     #*t901*t382+256*t901*t385
      t908 = t82**2
      t909 = t908*t6
      t910 = t909*t10
      t914 = t390*t24
      t915 = t914*t10
      t919 = t82*t5
      t931 = t407*s23r
      t934 = t908*t18*t1
      t938 = -1024*t934*t101-1024*t391*t13
      t949 = (-t914*t770+2*t914*t503)*t10
      t959 = 1024*t392*t101+1024*t919*t442
      t965 = t919*z
      t969 = (-t965+2*t919*t287)*t10
      t972 = t965*t29
      t976 = t397*t111
      t978 = t4*l3
      t979 = 2*t449
      t981 = (-t978+t979)*t10
      t993 = (-2*t914*t424+2*t914*t287)*t10
      t1004 = -1024*t409*t1*t101-1024*t83*t13
      t1011 = (-t391*(t155+5)-4*t391*z)*t1
      t1017 = (-t391*t325+2*t391*t315)*t1
      t1023 = t546-1
      t1024 = t919*t1023
      t1027 = (4*t919+2*t1024)*t10
      t1038 = (-t919*(-2*z-2*t569)+2*t919*(2*t569-2*z+2))*t10
      t1046 = 1024*t433*t101+1024*t449*t442
      t1049 = 256*t420
      t1057 = (-t396*(-z-5)+2*t396*t1023)*t1
      t1059 = t396*t503
      t1063 = (-t1059+2*t396*t158)*t1
      t1068 = 4*t426
      t1072 = (-t978*t1068-2*t978)*t10
      t1075 = t528*t4
      t1077 = -t500*t10
      t1087 = 2*t114
      t1089 = (-t518+t1087)*t1
      t1092 = 768*t727
      t1096 = -t1068*t10
      t1140 = t965*t43
      t1144 = t397*t187
      t1174 = 256*t593
      t1195 = 768*t737
      t1202 = t163*s2l1
      t1204 = t216*s2l2
      t1218 = t919*t10
      t1230 = t914*z
      t1233 = (-t914*t315-4*t1230)*t10
      t1252 = (-t919*(-2+t559)-2*t919*t1023)*t10
      t1263 = -t660+t661
      t1277 = (-t978*t315+2*t978*t426)*t10
      t1290 = t449*t10
      t1319 = (-t919*(-6-t850+t559)+2*t919*(t850-z+1))*t10
      t1343 = (-t919*(5+t850+z)+2*t919*(-z-1-t850))*t10
      t1354 = 2*t425
      t1356 = (-t396*t818+t1354)*t1
      t1360 = (-t396*t547+t1354)*t1
      t1373 = (-t978*(6-8*z+4*t569)+2*t978*(-1-t850+t155))*t10
      t1377 = t569*l3*t4
      t1404 = (t396*t377+2*t1059)*t1*t10
      t1410 = t821*t10
      t1422 = (-t449*t500+t1087)*t1
      t1429 = (t426*t562-2+t155)*t10
      t1451 = (-t449*t287+t979)*t1*t10
      t1459 = (t569+4-5*z)*t10
      s3 = ((1024*t8*t13*s2l2*s1vr-1024*t20*t13*s34r*s2l2+1024*t27+1024*
     #t30)*s1l1+(-1024*t8*t13*s2l1*s1vr+1024*t20*t13*s34r*s2l1-1024*t41-
     #1024*t44)*s1l2+((-1536*t48-1536*t49)*s2l1+(1536*t53+1536*t54)*s2l2
     #)*s1vr+((1536*t20*t26+1536*t20*t29)*s34r+1536*t27+1536*t30)*s2l1+(
     #(-1536*t20*t40-1536*t20*t43)*s34r-1536*t41-1536*t44)*s2l2)*t79*s13
     #r+t388*t79
      s2 = s3+t906*s13r+((1536*t910*t163*t407-3072*t915*t163*s23r+1536*t
     #919*t26)*t85+((-1024*t909*t90-1536*t909*t26-1536*t909*t29)*t931+(t
     #938*s2l2+(-1536*t934*t26-1536*t934*t29)*s34r-512*t949*t163-1536*t3
     #91*t29)*t407+(t959*s2l2+(3584*t403+1536*t404)*s34r+512*t969*t163+1
     #536*t972)*s23r-2048*t976+512*t981*t163)*s1vr+(-1024*t391*t90+256*t
     #993*t163+256*t993*t295)*t931+(t1004*s2l2+(256*t1011*t26-256*t1017*
     #t29)*s34r+256*t1027*t163-256*t1038*t295)*t407+(t1046*s2l2+(-1280*t
     #418-t1049)*t137+(256*t1057*t26-256*t1063*t29)*s34r+256*t1072*t163-
     #512*t1075*t1077*t295)*s23r+(1280*t93-768*t95)*t137+(-256*t1089*t26
     #-t1092)*s34r-256*t1096*t163)*s1l1
      s3 = s2+((-1536*t910*t216*t407+3072*t915*t216*s23r-1536*t919*t40)*
     #t85+((1024*t909*t175+1536*t909*t40+1536*t909*t43)*t931+(-t938*s2l1
     #+(1536*t934*t40+1536*t934*t43)*s34r+512*t949*t216+1536*t391*t43)*t
     #407+(-t959*s2l1+(-3584*t584-1536*t585)*s34r-512*t969*t216-1536*t11
     #40)*s23r+2048*t1144-512*t981*t216)*s1vr+(1024*t391*t175-256*t993*t
     #216-256*t993*t304)*t931+(-t1004*s2l1+(-256*t1011*t40+256*t1017*t43
     #)*s34r-256*t1027*t216+256*t1038*t304)*t407+(-t1046*s2l1+(1280*t591
     #+t1174)*t137+(-256*t1057*t40+256*t1063*t43)*s34r-256*t1072*t216+51
     #2*t1075*t1077*t304)*s23r+(-1280*t178+768*t180)*t137+(256*t1089*t40
     #+t1195)*s34r+256*t1096*t216)*s1l2
      s1 = s3+((1536*t910*t1202-1536*t910*t1204-1536*t910*t382+1536*t910
     #*t385)*t407+(-3072*t915*t1202+3072*t915*t1204+3072*t915*t382-3072*
     #t915*t385)*s23r+1536*t1218*t1202-1536*t1218*t1204-1536*t1218*t382+
     #1536*t1218*t385)*t85+((-512*t1233*t1202+512*t1233*t1204-3072*t1230
     #*t229+3072*t1230*t231)*t407+((1024*t392*t111+512*t1252*t163)*s2l1+
     #(-1024*t392*t187-512*t1252*t216)*s2l2+1536*t1263*s34r+1536*t1024*t
     #229-1536*t1024*t231)*s23r+(-1024*t976-512*t1277*t163)*s2l1+(1024*t
     #1144+512*t1277*t216)*s2l2+(1536*t669-1536*t671)*s34r-1536*t1290*t3
     #82+1536*t1290*t385)*s1vr+((-1024*t914*t26-1024*t914*t29)*s2l1+(102
     #4*t914*t40+1024*t914*t43)*s2l2)*t931
      s2 = s1+(((-1792*t403-1280*t404)*s34r+256*t1319*t163-2048*t972)*s2
     #l1+((1792*t584+1280*t585)*s34r-256*t1319*t216+2048*t1140)*s2l2-768
     #*t1263*s34r+256*t1343*t382-256*t1343*t385)*t407+(((-768*t418-t1049
     #)*t137+(256*t1356*t26-256*t1360*t29)*s34r+256*t1373*t163-1024*t137
     #7*t29)*s2l1+((768*t591+t1174)*t137+(-256*t1356*t40+256*t1360*t43)*
     #s34r-256*t1373*t216+1024*t1377*t43)*s2l2-768*t706*t137+(512*t1404*
     #t382-512*t1404*t385)*s34r-256*t1410*t382+256*t1410*t385)*s23r+((76
     #8*t93-768*t95)*t137+(-256*t1422*t26-t1092)*s34r-256*t1429*t163)*s2
     #l1
      taux2 = s2+((-768*t178+768*t180)*t137+(256*t1422*t40+t1195)*s34r+2
     #56*t1429*t216)*s2l2-1792*t741*t137+(-256*t1451*t382+256*t1451*t385
     #)*s34r-256*t1459*t382+256*t1459*t385

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = taux2

CCC Jet functions

      t1 = 1-l3
      t2 = -z+1
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,27.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t2 = -z+1
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet2 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,27.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = 1-l3
      t2 = -z+1
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,28.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t2 = -z+1
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet4 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,28.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      B2num1e1 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcoff4
      RETURN
      END

      double precision function B2num1e2(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      t1 = l3**2
      t2 = z*t1
      t3 = -1+z
      t4 = t3**2
      t5 = t4**2
      t6 = t5*t4
      t8 = l3-1
      t9 = t8**2
      t10 = t9**2
      t11 = s4vr**2
      t12 = 1/t11
      t13 = t10*t12
      t14 = s3vr**2
      t15 = 1/t14
      t16 = s34r**2
      t17 = t15*t16
      t21 = z*l3
      t22 = t9*t8
      t25 = z+1
      t26 = t25*t12
      t27 = t15*s34r
      t28 = t26*t27
      t31 = z*t4
      t33 = z**2
      t34 = 2*z
      t35 = t33+t34+1
      t37 = t35*t12*t15
      t41 = s13r**2
      t44 = t1*l3*z
      t45 = t44*t6
      t46 = t22*t12
      t51 = t2*t5*t9
      t54 = t21*t4
      t62 = t4*t3
      t63 = t5*t62
      t66 = t15*t16*s34r
      t70 = t5*t3
      t76 = (3*z+1)*t12*t17
      t82 = 3*t33+t34-1
      t92 = t1**2
      t93 = t92*z
      t102 = t8*t12*t27
      t109 = s23r**2
      t112 = t46*t66
      taux1 = (-64*t2*t6*t13*t17-128*t21*t5*t22*t28-64*t31*t9*t37)*t41+(
     #(128*t45*t46*t17+256*t51*t28+128*t54*t35*t8*t12*t15)*s23r+64*t44*t
     #63*t13*t66+64*t2*t70*t22*t76+64*t21*t62*t9*t82*t12*t27+64*t31*t8*t
     #37)*s13r+(-64*t93*t6*t9*t12*t17-128*t44*t5*t25*t102-64*t2*t4*t37)*
     #t109+(-64*t93*t63*t112-64*t44*t70*t9*t76-64*t2*t62*t82*t102-64*t54
     #*t37)*s23r+64*t45*t112+128*t51*t26*t17+64*t21*t4*t35*t102
      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = -1+z
      t5 = t4**2
      t6 = t5*t4
      t7 = t3*t6
      t8 = s4vr**2
      t9 = 1/t8
      t10 = s3vr**2
      t11 = 1/t10
      t12 = t9*t11
      t13 = t12*s3l2
      t14 = t7*t13
      t15 = t9*s4l2
      t16 = t15*t11
      t17 = t7*t16
      t21 = t12*s3l1
      t22 = t7*t21
      t23 = t9*s4l1
      t24 = t23*t11
      t25 = t7*t24
      t29 = t5**2
      t30 = l3*t29
      t31 = t30*t3
      t32 = t31*t13
      t33 = t31*t16
      t37 = t31*t21
      t38 = t31*t24
      t44 = t2**2
      t45 = t29*t4
      t47 = t44*t45*l3
      t67 = s13r**2
      t70 = l3**2
      t71 = t70*t29
      t72 = t71*t2
      t73 = s1vr**2
      t78 = t72*t13
      t79 = t72*t16
      t80 = t78+t79
      t84 = t70*t45*t3
      t86 = t12*s3l2*s34r
      t89 = l3*t6
      t90 = t89*t2
      t91 = t90*t13
      t95 = t84*t13
      t96 = t84*t16
      t98 = -1024*t95-1024*t96
      t105 = t29*t5
      t107 = t44*t105*t70
      t108 = s34r**2
      t117 = t5*t2
      t118 = z+1
      t119 = t117*t118
      t120 = 2*z
      t121 = t120-6
      t125 = (-t119+2*t117*t121)*t9
      t126 = t11*s3l2
      t132 = (-t119-8*t117*z)*t9
      t133 = s4l2*t11
      t142 = t72*t21
      t143 = t72*t24
      t144 = -t142-t143
      t148 = t12*s3l1*s34r
      t151 = t90*t21
      t155 = t84*t21
      t156 = t84*t24
      t158 = 1024*t155+1024*t156
      t173 = t11*s3l1
      t176 = s4l1*t11
      t182 = t12*s3l2*s2l1
      t185 = t12*s3l1*s2l2
      t187 = t15*t173
      t188 = t72*t187
      t189 = t23*t126
      t190 = t72*t189
      t202 = t95-t96
      t207 = l3*(z-4)*t6
      t208 = t2*t9
      t212 = t30*t2
      t217 = -t155+t156
      t229 = -t84*t187+t84*t189
      t241 = (t120-8)*t9
      t262 = t11*t108
      t266 = t120-1
      t271 = (-t31+2*t30*t3*t266)*t9
      t273 = -t120-3
      t278 = (-t31+2*t30*t3*t273)*t9
      t283 = 6*z
      t288 = (-t119+2*t117*(t283-10))*t9
      t295 = (-t119+2*t117*(-t283+2))*t9
      t324 = z+7
      t325 = t117*t324
      s2 = (-1024*t72*t12*s3l2*t73+(1024*t80*s23r+2048*t84*t86+1024*t91)
     #*s1vr+(t98*s34r+2048*t91+2048*t90*t16)*s23r-1024*t107*t12*s3l2*t10
     #8+(256*t32+1792*t33)*s34r+256*t125*t126-256*t132*t133)*s1l1+(1024*
     #t72*t12*s3l1*t73+(1024*t144*s23r-2048*t84*t148-1024*t151)*s1vr+(t1
     #58*s34r-2048*t151-2048*t90*t24)*s23r+1024*t107*t12*s3l1*t108+(-256
     #*t37-1792*t38)*s34r-256*t125*t173+256*t132*t176)*s1l2
      s1 = s2+(-1024*t72*t182+1024*t72*t185+1024*t188-1024*t190)*t73+((-
     #2048*t80*s2l1-2048*t144*s2l2)*s23r+(1024*t202*s34r-1024*t207*t208*
     #t126-1024*t212*t16)*s2l1+(1024*t217*s34r+1024*t207*t208*t173+1024*
     #t212*t24)*s2l2+2048*t229*s34r-2048*t90*t187+2048*t90*t189)*s1vr+((
     #-t98*s34r-512*t90*t241*t126-512*t90*t241*t133)*s2l1+(-t158*s34r+51
     #2*t90*t241*t173+512*t90*t241*t176)*s2l2)*s23r
      t330 = s1+(1024*t107*t15*t262+(256*t271*t126-256*t278*t133)*s34r+2
     #56*t288*t126-256*t295*t133)*s2l1+(-1024*t107*t23*t262+(-256*t271*t
     #173+256*t278*t176)*s34r-256*t288*t173+256*t295*t176)*s2l2+(1024*t1
     #07*t187-1024*t107*t189)*t108+(1536*t31*t187-1536*t31*t189)*s34r+51
     #2*t325*t187-512*t325*t189
      t332 = t70*l3
      t333 = t332*t29
      t334 = t333*t1
      t338 = t70*t6
      t339 = t338*t1
      t344 = t334*t13
      t345 = t334*t16
      t346 = -t344-t345
      t348 = s23r**2
      t351 = t332*t45*t2
      t352 = t351*t13
      t354 = t351*t16
      t359 = t70*t118*t6
      t360 = t1*t9
      t361 = t360*t126
      t364 = t71*t1
      t366 = 1024*t364*t16
      t371 = l3*t5
      t372 = t371*t1
      t381 = t338*(t120+4)
      t384 = t360*t133
      t390 = t332*t105*t3
      t401 = (-t72+2*t71*t2*(z+4))*t9
      t403 = z-2
      t408 = (-t72+2*t71*t2*t403)*t9
      t409 = t408*t133
      t413 = t371*t118
      t418 = (-t413+2*t371*(t120-4))*t1
      t421 = t371*z
      t424 = (-t413-4*t421)*t1
      t434 = t89*t2*t266
      t437 = (-t434+2*t212)*t9
      t439 = t120+1
      t441 = t89*t2*t439
      t442 = 3*z
      t443 = -t442-1
      t448 = (-t441+2*t89*t2*t443)*t9
      t453 = -t4
      t454 = z**2
      t455 = t454-z-2
      t456 = t453*t455
      t457 = 2*t4
      t458 = 4*z
      t462 = (t456+t457*(6-t458))*t1
      t465 = z*t4
      t466 = t465*t118
      t470 = (-t466-4*t454*t4)*t1
      t482 = t334*t21
      t483 = t334*t24
      t484 = t482+t483
      t487 = t351*t21
      t489 = t351*t24
      t493 = t360*t173
      t497 = 1024*t364*t24
      t511 = t360*t176
      t522 = t408*t176
      t549 = t334*t187
      t550 = t334*t189
      t558 = t339*t187
      t560 = t339*t189
      t577 = t70*(t442-5)*t6
      t591 = t351*t187-t351*t189
      t605 = l3*(t442-4)*t5
      t608 = z*t9
      t610 = t372*t608*t133
      t620 = t372*t608*t176
      t624 = -t188+t190
      t630 = l3*(z-3)*t5*t1
      t637 = t338*t121
      t650 = z+2
      t655 = (-t72+2*t71*t2*t650)*t9
      t664 = (-t413+2*t371*(-7-t454+t283))*t1
      t671 = (-t413+2*t371*(t454-t458+1))*t1
      t688 = t70*t439*t29*t2
      t694 = z-5
      t696 = t371*t694*t1
      t706 = -z-3
      t711 = (-t434+2*t89*t2*t706)*t9
      t717 = (-t441+2*t89*t2*t453)*t9
      t723 = 2*t454
      t727 = (t456+t457*(-10*z+8+t723))*t1
      t734 = (-t466-2*t465*t457)*t1
      t757 = t89*t2*t118
      t764 = t5*t324*t1
      s3 = ((2048*t334*t12*s3l2*s23r-2048*t339*t13)*t73+(2048*t346*t348+
     #((-3072*t352-1024*t354)*s34r+1024*t359*t361-t366)*s23r+4096*t72*t8
     #6+2048*t372*t13)*s1vr+((1024*t352+1024*t354)*s34r-512*t381*t361-51
     #2*t381*t384)*t348+((1024*t390*t13+1024*t390*t16)*t108+(-512*t401*t
     #126+512*t409)*s34r-512*t418*t13+512*t424*t16)*s23r+(-2304*t95-768*
     #t96)*t108+(-256*t437*t126+256*t448*t133)*s34r-256*t462*t13+256*t47
     #0*t16)*s1l1
      s4 = ((-2048*t334*t12*s3l1*s23r+2048*t339*t21)*t73+(2048*t484*t348
     #+((3072*t487+1024*t489)*s34r-1024*t359*t493+t497)*s23r-4096*t72*t1
     #48-2048*t372*t21)*s1vr+((-1024*t487-1024*t489)*s34r+512*t381*t493+
     #512*t381*t511)*t348+((-1024*t390*t21-1024*t390*t24)*t108+(512*t401
     #*t173-512*t522)*s34r+512*t418*t21-512*t424*t24)*s23r+(2304*t155+76
     #8*t156)*t108+(256*t437*t173-256*t448*t176)*s34r+256*t462*t21-256*t
     #470*t24)*s1l2+((2048*t334*t182-2048*t334*t185-2048*t549+2048*t550)
     #*s23r-2048*t339*t182+2048*t339*t185+2048*t558-2048*t560)*t73
      s2 = s3+s4
      s1 = s2+((-1024*t346*s2l1-1024*t484*s2l2)*t348+(((-1024*t352+1024*
     #t354)*s34r+1024*t577*t361+t366)*s2l1+((1024*t487-1024*t489)*s34r-1
     #024*t577*t493-t497)*s2l2+2048*t591*s34r-2048*t364*t187+2048*t364*t
     #189)*s23r+((1024*t78-1024*t79)*s34r-1024*t605*t361-1024*t610)*s2l1
     #+((-1024*t142+1024*t143)*s34r+1024*t605*t493+1024*t620)*s2l2+3072*
     #t624*s34r+1024*t630*t187-1024*t630*t189)*s1vr+((512*t637*t361+512*
     #t637*t384)*s2l1+(-512*t637*t493-512*t637*t511)*s2l2)*t348+(((-512*
     #t655*t126+512*t409)*s34r-512*t664*t13+512*t671*t16)*s2l1+((512*t65
     #5*t173-512*t522)*s34r+512*t664*t21-512*t671*t24)*s2l2+(1024*t688*t
     #187-1024*t688*t189)*s34r+1024*t696*t187-1024*t696*t189)*s23r
      t769 = s1+(-256*t202*t108+(-256*t711*t126+256*t717*t133)*s34r-256*
     #t727*t13+256*t734*t16)*s2l1+(-256*t217*t108+(256*t711*t173-256*t71
     #7*t176)*s34r+256*t727*t21-256*t734*t24)*s2l2-1536*t229*t108+(-1024
     #*t757*t187+1024*t757*t189)*s34r-512*t764*t187+512*t764*t189
      t771 = t70**2
      t772 = t771*t29
      t773 = t772*t9
      t777 = t332*t6
      t778 = t777*t9
      t782 = t70*t5
      t791 = t348*s23r
      t794 = t771*t45*t1
      t801 = t332*t650*t6
      t812 = t782*z
      t821 = t4*l3
      t826 = 2*t118
      t827 = t777*t826
      t837 = (-t333+2*t333*(t120+5))*t1
      t842 = (-t333+2*t333*t273)*t1
      t847 = t782*t118
      t850 = (-t847-8*t782)*t9
      t858 = (-t847+2*t782*(-2*z-2*t454))*t9
      t864 = 768*t354
      t867 = t338*t266
      t872 = (-t867+2*t338*(-z-5))*t1
      t874 = t338*t439
      t879 = (-t874-2*t338*t118)*t1
      t884 = t821*t455
      t889 = (-t884+8*t821*t453)*t9
      t892 = z*l3
      t893 = t892*t4
      t894 = t118*t9
      t901 = 512*t79
      t906 = l3*t1*t5*z
      t907 = t11*s34r
      t911 = t453*t118
      t913 = (t911+4-t458)*t9
      t977 = 768*t489
      t993 = 512*t143
      t1003 = t126*s2l1
      t1005 = t173*s2l2
      t1007 = t133*s3l1
      t1009 = t176*s3l2
      t1021 = t782*t9
      t1033 = t332*t266*t6
      t1039 = t332*z*t6
      t1047 = t782*(-2+t458)
      t1052 = t549-t550
      t1057 = t70*(t442-1)*t5
      t1065 = l3*t266*t4
      t1073 = t371*t9
      t1100 = (-t847+2*t782*(-6-t723+t458))*t9
      t1105 = (-t847-8*t812)*t9
      t1124 = t782*(t723+z+5)
      t1137 = (-t867+2*t338*t694)*t1
      t1142 = (-t874+2*t338*t443)*t1
      t1153 = (-t884+2*t821*(6-8*z+4*t454))*t9
      t1162 = (-t892*t4*t118-4*t454*l3*t4)*t9
      t1186 = -t338*t706*t1
      t1192 = t371*t694
      t1205 = (-2*t421+2*t371*t403)*t1
      t1211 = t457**2
      t1213 = (t911+t1211)*t9
      t1239 = (-t371*t826-2*t371*t266)*t1*t9
      t1247 = (-3*t454+t458-5)*t9
      s3 = ((-1024*t14-1024*t17)*s1l1+(1024*t22+1024*t25)*s1l2+((1024*t3
     #2+1024*t33)*s2l1+(-1024*t37-1024*t38)*s2l2)*s1vr+((-1024*t47*t13-1
     #024*t47*t16)*s34r-2048*t14-2048*t17)*s2l1+((1024*t47*t21+1024*t47*
     #t24)*s34r+2048*t22+2048*t25)*s2l2)*t67*s13r+t330*t67
      s2 = s3+t769*s13r+((-1024*t773*t126*t348+2048*t778*t126*s23r-1024*
     #t782*t13)*t73+((1024*t772*t13+1024*t772*t16)*t791+((1024*t794*t13+
     #1024*t794*t16)*s34r-1024*t801*t13+1024*t333*t16)*t348+((-3072*t344
     #-1024*t345)*s34r+1024*t812*t13-1024*t812*t16)*s23r+2048*t339*t86+1
     #024*t821*t13)*s1vr+(512*t827*t13+512*t827*t16)*t791+((256*t837*t13
     #-256*t842*t16)*s34r+256*t850*t126-256*t858*t133)*t348+((1280*t352+
     #t864)*t108+(256*t872*t13-256*t879*t16)*s34r+256*t889*t126+256*t893
     #*t894*t133)*s23r+(-1280*t78+t901)*t108+512*t906*t15*t907-256*t913*
     #t126)*s1l1
      s3 = s2+((1024*t773*t173*t348-2048*t778*t173*s23r+1024*t782*t21)*t
     #73+((-1024*t772*t21-1024*t772*t24)*t791+((-1024*t794*t21-1024*t794
     #*t24)*s34r+1024*t801*t21-1024*t333*t24)*t348+((3072*t482+1024*t483
     #)*s34r-1024*t812*t21+1024*t812*t24)*s23r-2048*t339*t148-1024*t821*
     #t21)*s1vr+(-512*t827*t21-512*t827*t24)*t791+((-256*t837*t21+256*t8
     #42*t24)*s34r-256*t850*t173+256*t858*t176)*t348+((-1280*t487-t977)*
     #t108+(-256*t872*t21+256*t879*t24)*s34r-256*t889*t173-256*t893*t894
     #*t176)*s23r+(1280*t142-t993)*t108-512*t906*t23*t907+256*t913*t173)
     #*s1l2
      s1 = s3+((-1024*t773*t1003+1024*t773*t1005+1024*t773*t1007-1024*t7
     #73*t1009)*t348+(2048*t778*t1003-2048*t778*t1005-2048*t778*t1007+20
     #48*t778*t1009)*s23r-1024*t1021*t1003+1024*t1021*t1005+1024*t1021*t
     #1007-1024*t1021*t1009)*t73+((-1024*t1033*t182+1024*t1033*t185+2048
     #*t1039*t187-2048*t1039*t189)*t348+(1024*t1047*t182-1024*t1047*t185
     #+1024*t1052*s34r-1024*t1057*t187+1024*t1057*t189)*s23r-1024*t1065*
     #t182+1024*t1065*t185+(-1024*t558+1024*t560)*s34r+1024*t1073*t1007-
     #1024*t1073*t1009)*s1vr+((1024*t777*t13+1024*t777*t16)*s2l1+(-1024*
     #t777*t21-1024*t777*t24)*s2l2)*t791
      s2 = s1+(((1280*t344+1792*t345)*s34r+256*t1100*t126-256*t1105*t133
     #)*s2l1+((-1280*t482-1792*t483)*s34r-256*t1100*t173+256*t1105*t176)
     #*s2l2-512*t1052*s34r+512*t1124*t187-512*t1124*t189)*t348+(((256*t3
     #52+t864)*t108+(256*t1137*t13-256*t1142*t16)*s34r+256*t1153*t126-25
     #6*t1162*t133)*s2l1+((-256*t487-t977)*t108+(-256*t1137*t21+256*t114
     #2*t24)*s34r-256*t1153*t173+256*t1162*t176)*s2l2-512*t591*t108+(102
     #4*t1186*t187-1024*t1186*t189)*s34r-512*t1192*t187+512*t1192*t189)*
     #s23r+((-256*t78+t901)*t108+(-256*t1205*t13+512*t610)*s34r-256*t121
     #3*t126)*s2l1
      taux2 = s2+((256*t142-t993)*t108+(256*t1205*t21-512*t620)*s34r+256
     #*t1213*t173)*s2l2-1792*t624*t108+(-256*t1239*t1007+256*t1239*t1009
     #)*s34r-256*t1247*t1007+256*t1247*t1009

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = taux2

CCC Jet functions

      t1 = 1-l3
      t2 = -z+1
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,27.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t2 = -z+1
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet2 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,27.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = 1-l3
      t2 = -z+1
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,28.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t2 = -z+1
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet4 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,28.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      B2num1e2 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcoff4
      RETURN
      END

      double precision function B2num1e3(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux1 = 0
      t1 = l3-1
      t2 = t1**2
      t3 = t2*t1
      t4 = -1+z
      t5 = t4**2
      t6 = t5**2
      t8 = t3*t6*l3
      t9 = s4vr**2
      t10 = 1/t9
      t11 = s3vr**2
      t12 = 1/t11
      t13 = t10*t12
      t14 = t13*s3l2
      t16 = t10*s4l2
      t17 = t16*t12
      t23 = z+1
      t24 = t5*t2*t23
      t29 = (512*t8*t14-512*t8*t17)*s34r+512*t24*t14-512*t24*t17
      t31 = t13*s3l1
      t33 = t10*s4l1
      t34 = t33*t12
      t43 = (-512*t8*t31+512*t8*t34)*s34r-512*t24*t31+512*t24*t34
      t48 = s13r**2
      t50 = l3**2
      t52 = t50*t6*t2
      t58 = l3*t5
      t59 = t58*t23
      t60 = t1*t10
      t61 = t12*s3l2
      t62 = t60*t61
      t65 = s4l2*t12
      t66 = t60*t65
      t69 = (-1024*t52*t14+1024*t52*t17)*s34r-1024*t59*t62+1024*t59*t66
      t71 = t6*t4
      t73 = t50*t71*t3
      t78 = s34r**2
      t79 = (-512*t73*t14+512*t73*t17)*t78
      t80 = t5*t4
      t82 = l3*t80*t2
      t83 = 2*z
      t84 = t83-1
      t85 = t84*t10
      t88 = t83+1
      t89 = t88*t10
      t94 = (-512*t82*t85*t61+512*t82*t89*t65)*s34r
      t95 = z**2
      t96 = t95-z-2
      t98 = t4*t96*t1
      t100 = 512*t98*t14
      t102 = z*t4*t23
      t104 = 512*t102*t66
      t112 = t12*s3l1
      t113 = t60*t112
      t116 = s4l1*t12
      t117 = t60*t116
      t120 = (1024*t52*t31-1024*t52*t34)*s34r+1024*t59*t113-1024*t59*t11
     #7
      t126 = (512*t73*t31-512*t73*t34)*t78
      t133 = (512*t82*t85*t112-512*t82*t89*t116)*s34r
      t135 = 512*t98*t31
      t137 = 512*t102*t117
      t150 = t50*l3
      t152 = t150*t6*t1
      t159 = t50*t5*t23
      t164 = (512*t152*t14-512*t152*t17)*s34r+512*t159*t14-512*t159*t17
      t165 = s23r**2
      t168 = t150*t71*t2
      t175 = t50*t80*t84
      t178 = t50*t88*t80
      t184 = t4*l3*t96
      t188 = z*l3*t4
      t189 = t23*t10
      t193 = (512*t168*t14-512*t168*t17)*t78+(512*t175*t62-512*t178*t66)
     #*s34r+512*t184*t14-512*t188*t189*t65
      t198 = 512*t52*t13*s3l2*t78
      t200 = t58*z*t1
      t204 = 1024*t200*t13*s3l2*s34r
      t205 = t4*t23
      t207 = 512*t205*t14
      t219 = (-512*t152*t31+512*t152*t34)*s34r-512*t159*t31+512*t159*t34
      t236 = (-512*t168*t31+512*t168*t34)*t78+(-512*t175*t113+512*t178*t
     #117)*s34r-512*t184*t31+512*t188*t189*t116
      t241 = 512*t52*t13*s3l1*t78
      t245 = 1024*t200*t13*s3l1*s34r
      t247 = 512*t205*t31
      t262 = t16*t112
      t264 = t33*t61
      t271 = 2*t58*t23*t1
      t278 = (t83+t95+1)*t10
      taux2 = (t29*s1l1+t43*s1l2+t29*s2l1+t43*s2l2)*t48+((t69*s23r+t79+t
     #94-t100+t104)*s1l1+(t120*s23r+t126+t133+t135-t137)*s1l2+(t69*s2l1+
     #t120*s2l2)*s23r+(t79+t94-t100+t104)*s2l1+(t126+t133+t135-t137)*s2l
     #2)*s13r+(t164*t165+t193*s23r-t198-t204-t207)*s1l1+(t219*t165+t236*
     #s23r+t241+t245+t247)*s1l2+(t164*s2l1+t219*s2l2)*t165+(t193*s2l1+t2
     #36*s2l2)*s23r+(-t198-t204-t207)*s2l1+(t241+t245+t247)*s2l2+(-512*t
     #52*t262+512*t52*t264)*t78+(-512*t271*t262+512*t271*t264)*s34r-512*
     #t278*t65*s3l1+512*t278*t116*s3l2

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = taux2

CCC Jet functions

      t1 = 1-l3
      t2 = -z+1
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,27.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t2 = -z+1
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet2 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,27.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = 1-l3
      t2 = -z+1
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,28.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t2 = -z+1
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet4 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,28.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      B2num1e3 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcoff4
      RETURN
      END

      double precision function B2num1e4(var,ndim,z,ux,l1,
     & l2,l3,l4,l5,l6,l7,l8,flag1,flag2,qflag,Tcoeff)
      IMPLICIT double precision(s,t)
      double precision Tcoeff
      INTEGER ndim
      double precision var(ndim)
      double precision lum,Pi,z3,NF
      double precision l1,l2,l3,l4,l5,l6,l7,l8,z,u,r,t,ux,Fjet
      double precision k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,s34r2,
     & zs13f,zs14f,zs23f,zs24f
      external k1,s13f,s23f,s14f,s24f,s3vf,s4vf,f1,f2,f3,s34r2,
     & s23r2,s1vr2,s2vr2,s23rf,s34rf,s1vrf,s13rf,Fjet,
     & zs13f,zs14f,zs23f,zs24f
      double precision s34r,s13r,s23r,s1vr,s3vr,s4vr,s2vr,
     & s134r,s234r,flag1,flag2
      double precision s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,c3l1
      external fillspin,zfillspin
      double precision s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v
      double precision s34p,s13p,s23p,s1vp,s2vp,s14p,s24p,s3l1p,s4l1p,
     & s3l2p,s4l2p,qflag
      NF = 5.0d0
      Pi = 3.141592654d0
      z3 = 1.202056903d0
      u = (l3+z-l3*z)/(1-l3+l3*z)
      r = dsqrt(u)
      t = dsqrt(z)
      if (flag1.lt.(0.0d0)) then
         s34r=s34rf(z,l1,l2,l3,l4)
         s13r=s13rf(z,l1,l2,l3,l4)
         s23r=s23rf(z,l1,l2,l3,l4)
         s1vr=s1vrf(z,l1,l2,l3,l4)
         s2vr=s1vrf(z,l1,l2,1-l3,l4)
         s234r=-(1+l1*(1-r*t)/r/(r+t))
         s1=r*(r+t)*(1+r*t)*(1+l1*(1-r*t)/r/(r+t))
         s2=(r+t)*(1+r*t)
         s3=(r-t)*(1-r*t)
         s134r=-(l1*(1+u)**2+(1-l1)*s2*r*(1-l1*s3/s2))/s1
         s34=l3*(1.0d0-l3)*(1.0d0-z)**2*s34r
         s13=(1.0d0-l3)*(1.0d0-z)*s13r
         s23=l3*(1.0d0-z)*s23r
         s1v=l3*(1.0d0-z)*s1vr
         s2v=(1.0d0-l3)*(1.0d0-z)*s2vr
         s14=-1.0d0-s13-s1v+z
         s24=s1v-s23-s34
         s3v=z-s13-s23-s34
         s4v=1.0d0+s13+s23
         s34p=l3*(1.0d0-l3)*(1.0d0-z)*s34r
         s13p=(1.0d0-l3)*s13r
         s23p=l3*s23r
         s1vp=l3*s1vr
         s2vp=(1.0d0-l3)*s2vr
         s14p=-1.0d0-s13p-s1vp
         s24p=s1vp-s23p-(1.0d0-z)*s34p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      else
         s13=s13f(z,l1,l2,l3,l4)
         s14=s14f(z,l1,l2,l3,l4)
         s23=s23f(z,l1,l2,l3,l4)
         s24=s24f(z,l1,l2,l3,l4)
         s34=-1.0d0+z-s13-s14-s23-s24
         s1v=-1.0d0+z-s13-s14
         s2v=-1.0d0+z-s23-s24
         s3v=1.0d0+s14+s24
         s4v=1.0d0+s13+s23
         s13p=zs13f(z,l1,l2,l3,l4)
         s14p=zs14f(z,l1,l2,l3,l4)
         s23p=zs23f(z,l1,l2,l3,l4)
         s24p=zs24f(z,l1,l2,l3,l4)
         s34p=-1.0d0-s13p-s14p-s23p-s24p
         s1vp=-1.0d0-s13p-s14p
         s2vp=-1.0d0-s23p-s24p
      call zfillspin(z,s13p,s14p,s23p,s24p,s34p,s1vp,s2vp,s3v,s4v,
     & l1,l2,l3,l4,l5,l6,l7,l8,s1l1,s2l1,s3l1p,s4l1p,s1l2,s2l2,s3l2p,
     & s4l2p,c3l1,qflag)
      endif
      call fillspin(z,s13,s14,s23,s24,s34,s1v,s2v,s3v,s4v,l1,l2,l3,
     & l4,l5,l6,l7,l8,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4l2,
     & c3l1,qflag)
      s3vr=z-(1-l3)*(1-z)*s13r-l3*(1-z)*s23r
     & -l3*(1-l3)*(1-z)**2*s34r
      s4vr=1.0d0+(1-l3)*(1-z)*s13r+l3*(1-z)*s23r

CCC Auxiliary functions

      taux1 = 0
      taux2 = 0

CCC Coefficients

      tcoff1 = taux1
      tcoff2 = taux1
      tcoff3 = taux2
      tcoff4 = taux2

CCC Jet functions

      t1 = 1-l3
      t2 = -z+1
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet1 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,27.D0,1.D0,1.D0,Tcoeff*tcoff1)
      t2 = -z+1
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet2 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,27.D0,1.D0,1.D0,Tcoeff*tcoff2)
      t1 = 1-l3
      t2 = -z+1
      t4 = t1*t2*s13r
      t5 = l3*t2
      t6 = t5*s23r
      t7 = t5*s1vr
      t10 = t2**2
      t12 = l3*t1*t10*s34r
      tFjet3 = Fjet(var,ndim,z,ux,t4,t6,-1-t4-t7+z,t7-t6-t12,t12,t7,-1+z
     #-t7+t12,-t4-t6-t12+z,1+t4+t6,s1l1,s2l1,s3l1,s4l1,s1l2,s2l2,s3l2,s4
     #l2,28.D0,1.D0,1.D0,Tcoeff*tcoff3)
      t2 = -z+1
      t3 = l3*t2
      t4 = t3*s23r
      t5 = 1-l3
      t7 = t5*t2*s13r
      t8 = t3*s1vr
      t10 = t2**2
      t12 = l3*t5*t10*s34r
      tFjet4 = Fjet(var,ndim,z,1/ux,t4,t7,t8-t4-t12,-1-t7-t8+z,t12,-1+z-
     #t8+t12,t8,-t7-t4-t12+z,1+t7+t4,s2l1,s1l1,s3l1,s4l1,s2l2,s1l2,s3l2,
     #s4l2,28.D0,1.D0,1.D0,Tcoeff*tcoff4)

CCC Sum

      B2num1e4 = tFjet1*tcoff1+tFjet2*tcoff2+tFjet3*tcoff3+tFjet4*tcoff4
      RETURN
      END

